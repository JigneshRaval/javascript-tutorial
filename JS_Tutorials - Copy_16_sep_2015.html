<html>	<head>		<style>		@font-face {    font-family: 'pt_sansregular';    src: url('fonts/PTS55F-webfont.eot');    src: url('fonts/PTS55F-webfont.eot?#iefix') format('embedded-opentype'),         url('fonts/PTS55F-webfont.woff') format('woff'),         url('fonts/PTS55F-webfont.ttf') format('truetype'), url('fonts/PTS55F-webfont.svg#pt_sansregular') format('svg');    font-weight: normal;    font-style: normal;}body { font-family: 'pt_sansregular', Arial, Tahoma, Helvetica, FreeSans, sans-serif; line-height: 1.7; font-size: 14px; }pre {	border: 1px dashed #888;	padding: 15px;    word-break: normal;    word-break: break-all;    word-wrap: break-word; font-size: 13px;    line-height: 1.42857143;	white-space: pre-wrap;       /* css-3 */ white-space: -moz-pre-wrap;  /* Mozilla, since 1999 */ white-space: -pre-wrap;      /* Opera 4-6 */ white-space: -o-pre-wrap;    /* Opera 7 */ word-wrap: break-word;       /* Internet Explorer 5.5+ */ position: relative;}pre:after {content: "CODE";position: absolute;right: 0;top: 0;padding: 5px 10px;border-left: 1px dashed #888;border-bottom: 1px dashed #888;}h1{ border-top: 1px solid #666; border-bottom: 2px solid #888; padding: 10px 0; font-size: 25px; text-align: center; }h2, h3 { font-size: 16px; border-left: 6px solid #666; padding: 5px 15px; }code, kbd, pre, samp {    font-family: Menlo,Monaco,Consolas,"Courier New",monospace;}code {    padding: 2px 4px;    font-size: 90%;    background-color: #f9f2f4;    border-radius: 4px;}blockquote {    letter-spacing: .01rem;    font-weight: 400;    font-style: italic; border-left: 3px solid rgba(0,0,0,0.8);    padding-left: 20px;    margin-left: -0;    margin-bottom: 30px;    padding-bottom: 3px;}@media print {    img {        display: block; page-break-inside: avoid;		-webkit-column-break-inside : avoid;    }	pre, code, pre code, pre span, code span, pre code span {		page-break-inside: avoid; -webkit-column-break-inside : avoid;	}}		</style>	</head>	<body>			<div class="post-wrapper">			<h1 id="javascript-reducing-vs-looping">1. JavaScript Reducing vs Looping</h1>			<p>Everybody knows what <strong>looping</strong> over a collection is. But do you know what <strong>reducing</strong> a collection means?</p>			<p>No? Are you sure?</p>			<p>It sounds scary. But it is in fact pretty simple. You do it all the time.			Here. Let me show you an example:</p>			<!--code lang=javascript linenums=true--><pre class="line-numbers  language-javascript">var total = 0;
var numbers = [1, 5, 7, 3, 8, 9];
for (var i = 0; i < numbers.length; i++) {
	total + = numbers[i];
}</pre>
	<p>That's it. You just <strong>reduced the "numbers" collection into the "total" variable</strong>. </p>			<p>Pretty simple huh?</p>			<h2 id="javascript-reduce-example">JavaScript Reduce Example</h2>			<p>Let me show you another example:</p> <!--code lang=javascript linenums=true-->			
	<pre class="line-numbers  language-javascript">var message = "";
var words = ["reducing", "is", "simple"];
for (var i = 0; i < words.length; i++) {
	message += words[i];
}</pre>
	
	<footer>Like learning from posts like this? <a onclick="$('#postSubscribeEmail').focus()"><b> Subscribe for more!</b></a></footer><p>You just <strong>reduced the "words" collection into the "message" variable</strong>.</p>			<p>You see the pattern right?</p>			<p> You start with a <strong>collection</strong> ( words ) and a <strong>variable</strong> ( message ) with an <strong>initial value</strong> ( the empty string in this case ). You then iterate over the collection and append ( or add ) the values to the variable.</p>			<h2 id="javascript-array-prototype-reduce">JavaScript Array.prototype.reduce</h2>			<p> So what's the big deal, you ask? Well. Check this out:</p>			<!--code lang=javascript linenums=true-->			
	<pre class="line-numbers  language-javascript">var sum = [1, 2, 3].reduce(function(total, num) {
	return total + num
	}, 0);</pre>
	
	<footer>Like learning from posts like this? <a onclick="$('#postSubscribeEmail').focus()"><b>Subscribe for more! </b></a></footer><p>Whoa! So the Array object already knows how to reduce? </p>			<p>Indeed!</p>			<p>Every time you find yourself going from a list of values to one value ( reducing ) ask yourself if you could leverage the built-in <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/Reduce"><code> Array.prototype.reduce()</code></a> function. You can reduce with any sort of operation that combines two values. Not just addition. And not just arithmetic operations.</p>			<p> So you know what Array reduce means. Isn't that awesome? It only took you one minute.</p>			<p>You can now head on to the <a href=" https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/Reduce">Mozilla Docs for Array.prototype.reduce</a> for a more in depth overview.</p>			<h2 id= "map-reduce">Map Reduce</h2>			<p>When you hear people talking about "Map Reduce" they are just talking about a "pattern": Mapping over a collection and then reducing it.</p> <p>Yeah. Really. Now you know.</p>		</div>		<!--=========================			START : POST		=============================-->		<div class= "post-wrapper"> <div class="post">        <h1 class="post-title">2. Boiling Down Arrays with Array#reduce</h1>            <p><i>                Originally published in the                <a href ="/">A Drip of JavaScript newsletter</a>.				</i></p>        <p>We've talked before about the advantages of using <code>Array</code>'s higher order functions (like <code>map </code> and <code>sort</code>) rather than manually iterating over an array's contents. But unlike <code>map</code> and <code>sort</code>, which produce new arrays, <code>reduce</code> can boil an array down to a new value of any type.</p><p>Consider the case of a library system which needs to show potential donors its effectiveness at spreading knowledge. In order to do that, it must determine how many book-checkouts there were last year. (Not total of all checkouts, since a single checkout may be for more than one book.)</p><p>Their data is stored in an object like this:</p><div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">var</span> <span class="nx">books</span> <span class="o">= </span> <span class="p">[</span>    <span class="p">{</span>        <span class="nx">title</span><span class="o">:</span> <span class="s2">"Showings"</span><span class="p">,</span> <span class="nx">author</span><span class="o">:</span> <span class="s2">"Julian of Norwich"</span><span class="p">,</span>        <span class="nx">checkouts</span><span class="o">:</span> <span class="mi">45</span>    <span class="p">},</span>    <span class="p">{</span>        <span class="nx">title</span><span class="o">:</span> <span class="s2">"The Triads"</span><span class="p">,</span>        <span class="nx">author</span><span class="o">:</span> <span class="s2">"Gregory Palamas"</span><span class="p">,</span>        <span class="nx">checkouts </span><span class="o">:</span> <span class="mi">32</span>    <span class="p">},</span>    <span class="p">{</span>        <span class="nx">title</span><span class="o">:</span> <span class ="s2">"The Praktikos"</span><span class="p">,</span>        <span class="nx">author</span><span class="o">:</span> <span class="s2">"Evagrius Ponticus"</span><span class="p">,</span> <span class="nx">checkouts</span><span class="o">:</span> <span class="mi">29</span>    <span class="p">}</span><span class="p">];</span></code></pre></div><p>The traditional C-style way to get at that number would be something like this:</p><div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">var</span> <span class="nx">bookCheckouts</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span><span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">books </span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span> <span class="nx">bookCheckouts</span> <span class="o">=</span> <span class="nx">bookCheckouts</span> <span class="o">+</span> <span class="nx">books</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">checkouts</span><span class="p">;</span><span class="p">}</span></code></pre></div><p>But using <code>reduce</code>, we can think more directly about the problem itself:</p><div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="c1">// Get an array of checkout values only</span><span class="kd">var</span> <span class="nx">bookCheckouts</span> <span class="o">=</span> <span class="nx">books</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">item</span><span class="p">)</span> <span class="p">{</span>    <span class="k">return</span> <span class="nx">item</span><span class="p">.</span><span class="nx">checkouts</span><span class="p">;</span><span class="p">});</span><span class="c1">// Sum the array's values from left to right</span><span class="kd">var</span> <span class="nx">total</span> <span class="o">=</span> <span class="nx">bookCheckouts</span><span class="p">.</span><span class="nx">reduce </span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">prev</span><span class="p">,</span> <span class="nx">curr</span><span class="p">) </span> <span class="p">{</span>    <span class="k">return</span> <span class="nx">prev</span> <span class="o">+</span> <span class="nx">curr</span><span class="p">;</span><span class="p"> });</span></code></pre></div><p>While it may look a little foreign at first, this example is more explicit about the problem than the <code>for</code> version is. Namely, dealing only with the <code>checkouts</code> property, and totaling them. And if you are familiar with the idioms, you can make it almost as concise.</p><div class="highlight"><pre><code class= "language-javascript" data-lang="javascript"><span class="c1">// Get total of book checkouts</span><span class="kd">var</span> <span class="nx">total</span> <span class="o">=</span> <span class="nx">books</span>            <span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">b </span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="nx">b</span><span class="p">.</span><span class="nx">checkouts</span><span class="p">; </span> <span class="p">})</span>            <span class="p">.</span><span class="nx">reduce</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">p</span><span class="p">,</span> <span class="nx">c</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="nx">p</span> <span class= "o">+</span> <span class="nx">c</span><span class="p">;</span> <span class="p">});</span></code></pre></div><p>So how does that <code>reduce</code> method work? It takes an array of values and executes the function (almost!) once for each item in the array. The value of <code>prev</code> is the result of the calculations up to this point. Let's take a look:</p><div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">].</span><span class="nx">reduce</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">prev</span><span class="p">,</span> <span class="nx">curr</span><span class="p">,</span> <span class="nx">index</span><span class="p">)</span> <span class="p">{</span>    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">prev</span><span class="p">,</span> <span class="nx">curr</span><span class="p">,</span> <span class="nx">index</span><span class="p">);</span>    <span class="k">return</span> <span class="nx">prev</span> <span class="o">+</span> <span class="nx">curr </span><span class="p">;</span><span class="p">});</span><span class="c1">// Outputs:</span><span class="c1">// 1, 2, 1</span><span class="c1">// 3, 3, 2</span><span class="c1">// 6 </span></code></pre></div><p>As you can see, the callback actually didn't iterate over the first element of the array. Instead, <code>prev</code> was set to the value of the first element. It has to work that way because otherwise <code>reduce</code> wouldn't have a starting value for <code>prev</code>.</p><p>The function ran three times, but on the last call, it wasn't given a current element since there were no elements left in the array. That behavior is a little confusing to read through, but is quite easy to use.</p><p>Here is another example: </p><div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2 </span><span class="p">,</span> <span class="mi">3</span><span class="p">].</span><span class="nx">reduce</span><span class="p">(</span><span class="kd">function</span><span class="p">( </span><span class="nx">prev</span><span class="p">,</span> <span class="nx">curr</span><span class="p">,</span> <span class="nx">index</span><span class="p">)</span> <span class="p">{ </span>    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">prev</span><span class="p">,</span> <span class="nx"> curr</span><span class="p">,</span> <span class="nx">index</span><span class="p">);</span>    <span class="k">return</span> <span class="nx">prev</span> <span class="o">+</span> <span class="nx">curr</span><span class="p">;</span><span class="p">},</span> <span class="mi">100</span><span class="p">);</span><span class="c1">// Outputs:</span><span class="c1">// 100 1 0 </span><span class="c1">// 101 2 1</span><span class="c1">// 103 3 2</span><span class="c1">// 106</span></code></pre></div><p>In addition to the callback function, we also passed in an initial value for <code>prev</code>. You'll note that in this case, the callback <strong>did</strong> iterate over the first element in the array, since it had an initial value to work with.</p><p>It should be noted that your callback function also has access to the array itself as a parameter.</p><div class="highlight"><pre><code class="language-javascript" data-lang= "javascript"><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]. </span><span class="nx">reduce</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">prev</span><span class="p">,</span> <span class="nx"> curr</span><span class="p">,</span> <span class="nx">index</span><span class="p">,</span> <span class="nx">arr</span><span class="p">)</span> <span class="p">{</span>    <span class="c1"> // Do something here</span><span class="p">});</span></code></pre></div><p>Is reduce only good for working with numbers? By no means. Consider this:</p><div class="highlight">
	
	<pre>var relArray = [["Viola", "Orsino"], ["Orsino", "Olivia"], ["Olivia", "Cesario"]];
var relMap = relArray.reduce(function(memo, curr) {
	memo[curr[0]] = curr[1];
	return memo;
}, {}); 
// Outputs: {
//    "Viola": "Orsino",
//    "Orsino": "Olivia",
//    "Olivia": "Cesario"
// }
console.log(relMap);</pre>
	</div><p>This time we used <code>reduce</code> to transform the relationship data from an array of arrays into an object where each key value pair describes the relationship. You'll also see that instead of naming the parameter <code>prev</code> as I did before, I used the term <code>memo</code>. That's because in this case, <code>memo</code> is a more descriptive name for the actual value being passed in (an object collecting new properties.)</p><p>The <code>reduce</code> method is good for any sort of situation where we want to take an array and boil it down into a new value in steps that have access to one or two of the array elements at a time.</p><p>Want to use <code>reduce</code> in IE8 or IE7? Take a look at the <a href="http://underscorejs.org/#reduce">Underscore</a> and <a href=" http://lodash.com/docs#reduce">Lo-Dash</a> libraries.</p>    </div>			</div>		<!--=========================			END : POST		=============================--> <!--=========================			START : POST			=============================-->		<div class="post-wrapper">			<div class="post">        <h1 class="post-title" >The Problems with for...in and JavaScript Arrays</h1>            <p><i>                Originally published in the                <a href="/">A Drip of JavaScript newsletter</a> .            </i></p>        <p>We've talked in the past about different ways of iterating over arrays. But in this drip we'll take a look at one way <strong>not</strong> to do it.</p><p> JavaScript's <code>for</code>...<code>in</code> loop iterates over the enumerable properties of an object like so:</p><div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">var</span> <span class="nx">tMinus</span> <span class="o">=</span> <span class="p">{</span>    <span class="nx">two</span><span class="o">:</span> <span class="s2">"Two"</span><span class="p">,</span>    <span class="nx">one</span><span class="o">:</span> <span class="s2">"One"</span><span class="p">,</span>    <span class="nx">zero </span><span class="o">:</span> <span class="s2">"Blast off!"</span><span class="p">};</span><span class="kd">var</span> <span class="nx">countdown</span> <span class="o">=</span> <span class="s2">""</span><span class="p">;</span><span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">step</span> <span class="k">in</span> <span class="nx">tMinus</span><span class="p">)</span> <span class="p">{</span>    <span class="nx">countdown</span> <span class="o">+=</span> <span class="nx">tMinus</span><span class="p">[ </span><span class="nx">step</span><span class="p">]</span> <span class="o">+</span> <span class="s2">"\n"</span><span class="p">;</span><span class="p">}</span><span class="nx">console </span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">countdown</span><span class="p">);</span><span class="c1">// =&gt; "Two</span><span class ="c1">//    One</span><span class="c1">//    Blast Off!</span><span class="c1">//    "</span></code></pre></div><p>Because <code>for</code>...<code>in</code> operates on any JavaScript object, it is also possible to use it with arrays. For example:</p><div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">var</span> <span class="nx">tMinus</span> <span class="o">=</span> <span class="p">[</span>    <span class="s2">"Two"</span><span class="p">,</span>    <span class="s2">"One"</span><span class="p">,</span> <span class="s2">"Blast off!"</span><span class="p">];</span><span class="kd">var</span> <span class="nx">countdown</span> <span class="o">=</span> <span class="s2">""</span><span class="p">;</span><span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">step</span> <span class="k">in</span> <span class="nx">tMinus</span><span class="p">)</span> <span class="p">{</span>    <span class="nx">countdown</span> <span class="o">+=</span> <span class="nx">tMinus</span><span class="p">[</span><span class="nx">step </span><span class="p">]</span> <span class="o">+</span> <span class="s2">"\n"</span><span class="p">;</span><span class="p">}</span><span class="nx">console</span><span class="p">. </span><span class="nx">log</span><span class="p">(</span><span class="nx">countdown</span><span class="p">);</span><span class="c1">// =&gt; "Two</span><span class="c1">//    One </span><span class="c1">//    Blast Off!</span><span class="c1">//    "</span></code></pre></div><p>However, there are three problems with using this approach on arrays. First, the <code> for</code>...<code>in</code> also iterates over an object's prototype properties if those properties are enumerable. For example:</p><div class="highlight"><pre><code class= "language-javascript" data-lang="javascript"><span class="nb">Array</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">voice</span> <span class="o">=</span> <span class="s2">"James Earl Jones"</span><span class="p">;</span><span class="kd">var</span> <span class="nx">tMinus</span> <span class="o">=</span> <span class= "p">[</span>    <span class="s2">"Two"</span><span class="p">,</span>    <span class="s2">"One"</span><span class="p">,</span>    <span class="s2">"Blast off!"</span><span class="p">]; </span><span class="kd">var</span> <span class="nx">countdown</span> <span class="o">=</span> <span class="s2">""</span><span class="p">;</span><span class="k">for</span> <span class="p">( </span><span class="kd">var</span> <span class="nx">step</span> <span class="k">in</span> <span class="nx">tMinus</span><span class="p">)</span> <span class="p">{</span>    <span class= "nx">countdown</span> <span class="o">+=</span> <span class="nx">tMinus</span><span class="p">[</span><span class="nx">step</span><span class="p">]</span> <span class="o">+</span> <span class="s2">"\n"</span><span class="p">;</span><span class="p">}</span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class= "nx">countdown</span><span class="p">);</span><span class="c1">// =&gt; "Two</span><span class="c1">//    One</span><span class="c1">//    Blast Off!</span><span class="c1">//    James Earl Jones</span><span class="c1">//    "</span></code></pre></div><p>That can be solved by using <code>hasOwnProperty</code> to exclude prototype properties.</p><p>Array.prototype.voice = "James Earl Jones";</p><div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="nb">Array</span><span class="p">.</span><span class="nx"> prototype</span><span class="p">.</span><span class="nx">voice</span> <span class="o">=</span> <span class="s2">"James Earl Jones"</span><span class="p">;</span><span class="kd">var</span> <span class="nx">tMinus</span> <span class="o">=</span> <span class="p">[</span>    <span class="s2">"Two"</span><span class="p">,</span>    <span class="s2">"One"</span><span class="p">, </span>    <span class="s2">"Blast off!"</span><span class="p">];</span><span class="kd">var</span> <span class="nx">countdown</span> <span class="o">=</span> <span class="s2">"" </span><span class="p">;</span><span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">step</span> <span class="k">in</span> <span class="nx">tMinus </span><span class="p">)</span> <span class="p">{</span>    <span class="k">if</span> <span class="p">(</span><span class="nx">tMinus</span><span class="p">.</span><span class="nx"> hasOwnProperty</span><span class="p">(</span><span class="nx">step</span><span class="p">))</span> <span class="p">{</span>        <span class="nx">countdown</span> <span class="o">+= </span> <span class="nx">tMinus</span><span class="p">[</span><span class="nx">step</span><span class="p">]</span> <span class="o">+</span> <span class="s2">"\n"</span><span class="p">; </span>    <span class="p">}</span><span class="p">}</span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx"> countdown</span><span class="p">);</span><span class="c1">// =&gt; "Two</span><span class="c1">//    One</span><span class="c1">//    Blast Off!</span><span class="c1">//    " </span></code></pre></div><p>Second, according to the <a href="http://www.ecma-international.org/ecma-262/5.1/#sec-12.6.4">specification</a> <code>for</code>...<code>in</code> loops may iterate over an object's values in an <strong>arbitrary order</strong>.</p><p>That's not really a problem for an ordinary object whose values are inherently unordered anyway. But you probably don't want your JavaScript engine handing back array values in a random order, because you could get unexpected results like this:</p><div class="highlight"><pre><code class= "language-javascript" data-lang="javascript"><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">countdown </span><span class="p">);</span><span class="c1">// =&gt; "Blast Off!</span><span class="c1">//    One</span><span class="c1">//    Two</span><span class="c1">//    " </span></code></pre></div><p>The third problem is that <code>for</code>...<code>in</code> iterates over <strong>all enumerable properties</strong>, not just the array's elements. As we've <a href="http://designpepper.com/blog/drips/storing-metadata-on-arrays-in-javascript.html">discussed before</a>, it is possible to store additional properties on an array. This can also lead to unexpected results.</p><div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">var</span> <span class="nx">tMinus</span> <span class= "o">=</span> <span class="p">[</span>    <span class="s2">"Two"</span><span class="p">,</span>    <span class="s2">"One"</span><span class="p">,</span>    <span class="s2">"Blast off!" </span><span class="p">];</span><span class="nx">tMinus</span><span class="p">.</span><span class="nx">announcer</span> <span class="o">=</span> <span class="s2">"Morgan Freeman" </span><span class="p">;</span><span class="kd">var</span> <span class="nx">countdown</span> <span class="o">=</span> <span class="s2">""</span><span class="p">;</span><span class="k">for </span> <span class="p">(</span><span class="kd">var</span> <span class="nx">step</span> <span class="k">in</span> <span class="nx">tMinus</span><span class="p">)</span> <span class="p">{ </span>    <span class="k">if</span> <span class="p">(</span><span class="nx">tMinus</span><span class="p">.</span><span class="nx">hasOwnProperty</span><span class="p">(</span><span class ="nx">step</span><span class="p">))</span> <span class="p">{</span>        <span class="nx">countdown</span> <span class="o">+=</span> <span class="nx">tMinus</span><span class="p">[ </span><span class="nx">step</span><span class="p">]</span> <span class="o">+</span> <span class="s2">"\n"</span><span class="p">;</span>    <span class="p">}</span><span class="p">} </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">countdown</span><span class="p">);</span><span class="c1"> // =&gt; "Two</span><span class="c1">//    One</span><span class="c1">//    Blast Off!</span><span class="c1">//    Morgan Freeman</span><span class="c1">//    " </span></code></pre></div><p>Because of these problems you will almost never want iterate over arrays with <code>for</code>...<code>in</code> loops. Instead, use an ordinary <code>for </code> loop, or one of the built-in array iteration methods like <code>forEach</code> or <code>map</code>.</p><p>Now you know one more quirk to avoid as you write safe and clean JavaScript.</p><p>Thanks for reading!</p><p>Josh Clanton</p>    </div>			</div>		<!--=========================			END : POST		=============================--> <!--=========================			START : POST		=============================-->		<div class="post-wrapper">			<div class="post">        <h1 class="post-title"> Using ECMAScript 6 Maps</h1>            <p><i>                Originally published in the                <a href="/">A Drip of JavaScript newsletter</a>.            </i></p>        <p>In last week's drip I discussed using <code>Object.create(null)</code> in order to simplify creating key-value maps in JavaScript. But even with that approach, objects aren't a substitute for a full-fledged map data type. For example:</p><div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">var</span> <span class="nx"> heroesNemesis</span> <span class="o">=</span> <span class="nb">Object</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="kc">null</span><span class="p">);</span><span class="kd">var</span> <span class="nx">greenLantern</span> <span class="o">=</span> <span class="p">{</span> <span class="nx">name</span><span class="o">:</span> <span class="s2">"Green Lantern"</span> <span class="p">};</span><span class="kd">var</span> <span class="nx">sinestro</span> <span class="o">=</span> <span class="p">{</span> <span class= "nx">name</span><span class="o">:</span> <span class="s2">"Sinestro"</span> <span class="p">};</span><span class="nx">heroesNemesis</span><span class="p">[</span><span class="nx"> greenLantern</span><span class="p">]</span> <span class="o">=</span> <span class="nx">sinestro</span><span class="p">;</span><span class="c1">// Outputs: { name: "Sinestro" }</span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">heroesNemesis</span><span class="p">[</span><span class="nx"> greenLantern</span><span class="p">]);</span><span class="kd">var</span> <span class="nx">wonderWoman</span> <span class="o">=</span> <span class="p">{</span> <span class="nx">name </span><span class="o">:</span> <span class="s2">"Wonder Woman"</span> <span class="p">};</span><span class="c1">// Outputs: { name: "Sinestro" }</span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">heroesNemesis</span><span class="p">[</span><span class="nx">wonderWoman</span><span class="p">]); </span></code></pre></div><p>Why is our object reporting Wonder Woman's nemesis as Sinestro? In JavaScript, an object's keys can only be strings. If you try to supply something else, the JavaScript engine will try to coerce it into a string with <code>toString</code>.</p><p>And the default <code>toString</code> implementation for an object returns <code>"[object Object]" </code> regardless of what properties the object possesses. So unless we decide to start monkeying around with <code>Object.prototype</code> (generally a bad idea) our "map" object can't distinguish between different objects as keys.</p><p>Fortunately, ECMAScript 6 (the next version of JavaScript) includes a new <code>Map</code> data type which allows us to use any valid JavaScript value as a key.</p><div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">var</span> <span class="nx">heroesNemesis</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Map</span><span class="p">();</span><span class="kd">var</span> <span class="nx">greenLantern</span> <span class="o">=</span> <span class="p">{</span> <span class="nx">name</span><span class="o">:</span> <span class="s2">"Green Lantern"</span> <span class="p">};</span><span class="kd">var</span> <span class="nx" >sinestro</span> <span class="o">=</span> <span class="p">{</span> <span class="nx">name</span><span class="o">:</span> <span class="s2">"Sinestro"</span> <span class="p">};</span><span class="nx">heroesNemesis</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="nx">greenLantern</span><span class="p">,</span> <span class="nx"> sinestro</span><span class="p">);</span><span class="c1">// Outputs: { name: "Sinestro" }</span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">heroesNemesis</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">greenLantern</span><span class="p">)); </span><span class="kd">var</span> <span class="nx">wonderWoman</span> <span class="o">=</span> <span class="p">{</span> <span class="nx">name</span><span class="o">:</span> <span class= "s2">"Wonder Woman"</span> <span class="p">};</span><span class="c1">// Outputs: undefined</span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">heroesNemesis</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">wonderWoman</span><span class="p">)); </span></code></pre></div><p>As you can see, <code>Map</code> gives us the result we'd expect. To use <code>Map</code> our main interfaces are <code>set</code> which accepts a key and associated value to store, and <code>get</code> which accepts a key and returns the associated value.</p><p>When checking to see whether a given key matches, <code>Map</code> uses the "same value" algorithm. So even if two objects look identical, only the original can be used to retrieve it's associated value. For example:</p><div class="highlight"><pre><code class= "language-javascript" data-lang="javascript"><span class="kd">var</span> <span class="nx">clonedLantern</span> <span class="o">=</span> <span class="p">{</span> <span class="nx">name </span><span class="o">:</span> <span class="s2">"Green Lantern"</span> <span class="p">};</span><span class="c1">// Outputs: undefined</span><span class="nx">console</span><span class="p" >.</span><span class="nx">log</span><span class="p">(</span><span class="nx">heroesNemesis</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx" >clonedLantern</span><span class="p">));</span></code></pre></div><p>And you can determine how many elements have been stored in a <code>Map</code> by checking its <code>size</code> property.</p><div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="c1">// Outputs: 1</span><span class="nx">console</span><span class="p">. </span><span class="nx">log</span><span class="p">(</span><span class="nx">heroesNemesis</span><span class="p">.</span><span class="nx">size</span><span class="p">); </span></code></pre></div><p>This basic set of functionality for <code>Map</code> is supported in the latest versions of Chrome and FireFox, as well as IE11. In future drips we'll look into more advanced features of <code>Map</code>.</p><p>Thanks for reading!</p><p>Joshua Clanton</p>    </div>			</div>		<!--=========================			END : POST =============================-->		<!--=========================			START : POST		=============================-->		<div class="post-wrapper">			<div class= "post">        <h1 class="post-title">Basic Inheritance with Object.create</h1>            <p><i>                Originally published in the                <a href="/">A Drip of JavaScript newsletter</a>.            </i></p>        <p>A few issues back we looked at <a href="/blog/drips/basic-inheritance-with-javascript-constructors.html">how to implement basic inheritance with constructors</a>. In this issue, we'll look at how to do the same with the newer <code>Object.create</code>.</p><p>When using constructors for inheritance, we attach properties to the constructor's <code>prototype</code> property like so:</p><p>Here's a little refresher:</p><div class="highlight"><pre><code class="language-javascript" data-lang= "javascript"><span class="kd">function</span> <span class="nx">SuperHuman</span> <span class="p">(</span><span class="nx">name</span><span class="p">,</span> <span class="nx">superPower </span><span class="p">)</span> <span class="p">{</span>    <span class="k">this</span><span class="p">.</span><span class="nx">name</span> <span class="o">=</span> <span class="nx">name </span><span class="p">;</span>    <span class="k">this</span><span class="p">.</span><span class="nx">superPower</span> <span class="o">=</span> <span class="nx">superPower</span><span class="p">;</span><span class="p">}</span><span class="nx">SuperHuman</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">usePower </span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>    <span class="nx">console</span><span class="p">.</span><span class= "nx">log</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">superPower</span> <span class="o">+</span> <span class="s2">"!"</span><span class ="p">);</span><span class="p">};</span><span class="kd">var</span> <span class="nx">banshee</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">SuperHuman </span><span class="p">(</span><span class="s2">"Silver Banshee"</span><span class="p">,</span> <span class="s2">"sonic wail"</span><span class="p">);</span><span class="c1">// Outputs: "sonic wail!"</span><span class="nx">banshee</span><span class="p">.</span><span class="nx">usePower</span><span class="p">();</span></code></pre></div><p>The <code>SuperHuman</code> constructor contains our initialization logic, while <code>SuperHuman.prototype</code> contains the methods that are shared across all <code>SuperHuman</code> instances.</p><p>If we were to implement the same basic logic using <code>Object.create</code>, it would look a bit different:</p><div class="highlight"><pre><code class="language-javascript" data-lang="javascript" ><span class="kd">var</span> <span class="nx">superHuman</span> <span class="o">=</span> <span class="p">{</span>    <span class="nx">usePower</span><span class="o">:</span> <span class= "kd">function</span> <span class="p">()</span> <span class="p">{</span>        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">( </span><span class="k">this</span><span class="p">.</span><span class="nx">superPower</span> <span class="o">+</span> <span class="s2">"!"</span><span class="p">);</span>    <span class= "p">}</span><span class="p">};</span><span class="kd">var</span> <span class="nx">banshee</span> <span class="o">=</span> <span class="nb">Object</span><span class="p">.</span><span class= "nx">create</span><span class="p">(</span><span class="nx">superHuman</span><span class="p">,</span> <span class="p">{</span>    <span class="nx">name</span><span class="o">:</span> <span class="p">{</span> <span class="nx">value</span><span class="o">:</span> <span class="s2">"Silver Banshee"</span> <span class="p">},</span>    <span class="nx">superPower</span><span class ="o">:</span> <span class="p">{</span> <span class="nx">value</span><span class="o">:</span> <span class="s2">"sonic wail"</span> <span class="p">}</span><span class="p">});</span><span class="c1">// Outputs: "sonic wail!"</span><span class="nx">banshee</span><span class="p">.</span><span class="nx">usePower</span><span class="p">();</span></code></pre></div><p>In this case we first define the prototype object <code>superHuman</code>, and then we use <code>Object.create</code> to make a new object which inherits from <code>superHuman</code>. That second argument might look a little strange to you, but it's just a simple property descriptor object, like we use <a href="/blog/drips/creating-unwritable-properties-with-object-defineproperty"> with <code>Object.defineProperty</code> to fine-tune an object's properties</a>.</p><p>Now, what if we want to create a new type which inherits from <code>superHuman</code> while adding its own functionality? What would that look like?</p><div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">var</span> <span class="nx"> superHero</span> <span class="o">=</span> <span class="nb">Object</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="nx">superHuman </span><span class="p">,</span> <span class="p">{</span>    <span class="nx">allegiance</span><span class="o">:</span> <span class="p">{</span> <span class="nx">value</span><span class="o" >:</span> <span class="s2">"Good"</span> <span class="p">},</span>    <span class="nx">saveTheDay</span><span class="o">:</span> <span class="p">{</span>        <span class="nx">value </span><span class="o">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>            <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">name</span> <span class="o">+</span> <span class="s2">" saved the day!" </span><span class="p">);</span>        <span class="p">}</span>    <span class="p">}</span><span class="p">});</span><span class="kd">var</span> <span class="nx">marvel</span> <span class ="o">=</span> <span class="nb">Object</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="nx">superHero</span><span class="p">,</span> <span class="p">{</span>    <span class="nx">name</span><span class="o">:</span> <span class="p">{</span> <span class="nx">value</span><span class="o">:</span> <span class="s2">"Captain Marvel" </span> <span class="p">},</span>    <span class="nx">superPower</span><span class="o">:</span> <span class="p">{</span> <span class="nx">value</span><span class="o">:</span> <span class= "s2">"magic"</span> <span class="p">}</span><span class="p">});</span><span class="c1">// Outputs: "Captain Marvel saved the day!"</span><span class="nx">marvel</span><span class="p">. </span><span class="nx">saveTheDay</span><span class="p">();</span></code></pre></div><p>So far so good. But does Captain Marvel have access to the <code>superHuman</code> prototype methods?</p><div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="c1">// Outputs: "magic!"</span><span class="nx">marvel</span><span class="p">. </span><span class="nx">usePower</span><span class="p">();</span></code></pre></div><p>Yes, she does!</p><p>Using <code>Object.create</code> makes setting up inheritance chains simple because any object can be used as a prototype. However, inheritance managed by <code>Object.create</code> can't be detected by <code>instanceof</code>. Instead you'll need to use the <code>isPrototypeOf</code> method, like so:</p><div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="c1">// Outputs: true</span><span class="nx" >console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">superHero</span><span class="p">.</span><span class="nx">isPrototypeOf </span><span class="p">(</span><span class="nx">marvel</span><span class="p">));</span><span class="c1">// Outputs: true</span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">superHuman</span><span class="p">.</span><span class="nx">isPrototypeOf</span><span class="p">(</span><span class="nx">marvel </span><span class="p">));</span></code></pre></div><p>Because both <code>superHero</code> and <code>superHuman</code> are part of <code>marvel</code>'s prototype chain, their <code> isPrototypeOf</code> calls each return true.</p><p>As with other JavaScript features we've reviewed, <code>Object.create</code> is a feature of ECMAScript 5 and is not available in older browsers like IE8.</p><p>That's our brief introduction to using <code>Object.create</code>. Thanks for reading!</p><p>Joshua Clanton</p>    </div>			</div> <!--=========================			END : POST		=============================-->		<!--=========================			START : POST =============================-->		<div class="post-wrapper">			<div class="post">        <h1 class="post-title">Creating Objects Without Prototypes</h1>            <p><i> Originally published in the                <a href="/">A Drip of JavaScript newsletter</a>.            </i></p>        <p>Last drip we talked about inheritance using prototypes and Object.create. But one point that sometimes surprises new JavaScript developers is that even ordinary "empty" objects are already part of an inheritance chain. Consider the following:</p><div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">var</span> <span class="nx">empty</span> <span class="o">=</span> <span class="p">{};</span><span class="c1">// Outputs: Function Object()</span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">empty</span><span class="p">.</span><span class="nx">constructor</span><span class="p">);</span></code></pre></div><p>Every time you create a new object via an object literal (the <code>{}</code>), behind the scenes JavaScript invokes the <code>Object</code> constructor to create the object, just as if you'd used <code>new Object()</code>. This is what allows your new object to inherit properties from <code>Object.prototype</code>.</p><p>But sometimes it would be convenient to create an object that doesn't inherit from a prototype at all. For instance, if you'd like to use an object as a hash/map of arbitrary keys to values.</p><div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd" >var</span> <span class="nx">dictionary</span> <span class="o">=</span> <span class="p">{</span>    <span class="nx">destructor</span><span class="o">:</span> <span class="s2">"A destructive element"</span><span class="p">};</span><span class="kd">function</span> <span class="nx">getDefinition</span><span class="p">(</span><span class="nx">word</span><span class= "p">)</span> <span class="p">{</span>    <span class="k">return</span> <span class="nx">dictionary</span><span class="p">[</span><span class="nx">word</span><span class="p">];</span><span class="p">}</span><span class="c1">// Outputs: "A destructive element"</span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">getDefinition</span><span class="p">(</span><span class="s2">"destructor"</span><span class="p">));</span><span class="c1">// Outputs: function Object()</span><span class="nx"> console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">getDefinition</span><span class="p">(</span><span class="s2">"constructor" </span><span class="p">));</span></code></pre></div><p>As you can see, our <code>getDefinition</code> function works perfectly for words that we have explicitly defined. However, it also returns inherited properties like <code>constructor</code>.</p><p>One way of solving this would be to introduce a <code>hasOwnProperty</code> check to make sure that the properties aren't inherited. But another way is just to ensure that our <code>dictionary</code> never inherits any properties to begin with.</p><p>Fortunately, <code>Object.create</code> makes that rather easy.</p><div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">var</span> <span class="nx">dictionary</span> <span class="o">=</span> <span class="nb">Object</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="kc">null</span><span class="p">,</span> <span class="p">{</span>    <span class="nx">destructor</span><span class="o">:</span> <span class="p">{</span> <span class="nx">value</span><span class="o">:</span> <span class="s2">"A destructive element"</span> <span class="p">}</span><span class="p">});</span><span class="kd">function</span> <span class="nx">getDefinition</span><span class="p">(</span><span class="nx">word</span><span class="p">) </span> <span class="p">{</span>    <span class="k">return</span> <span class="nx">dictionary</span><span class="p">[</span><span class="nx">word</span><span class="p">];</span><span class ="p">}</span><span class="c1">// Outputs: "A destructive element"</span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">getDefinition</span><span class="p">(</span><span class="s2">"destructor"</span><span class="p">));</span><span class="c1">// Outputs: undefined</span><span class="nx">console </span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">getDefinition</span><span class="p">(</span><span class="s2">"constructor"</span><span class="p">));</span></code></pre></div><p>As you can see, in this case <code>getDefinition</code> returned our intended result.</p><p>The trick here is in our first argument to <code> Object.create</code>. Normally this is where we would pass in the object that we want to serve as the prototype. But if we pass in <code>null</code> instead, our new object doesn't inherit from a prototype at all.</p><p>Of course, <code>Object.create</code> isn't available in IE8 and older, so you should only use this technique in modern browsers.</p><p>I hope you found this week's drip informative!</p><p>Joshua Clanton</p>    </div>			</div>		<!--=========================			END : POST		=============================--> <!--=========================			START : POST		=============================-->		<div class="post-wrapper">			<div class="post">        <h1 class="post-title"> Retrieving Property Names with `Object.getOwnPropertyNames` and `Object.keys`</h1>            <p><i>                Originally published in the                <a href="/">A Drip of JavaScript newsletter</a>.            </i></p>        <p>In past versions of JavaScript it was fairly painful to figure out what properties an object possessed. Essentially you would need to manually iterate over the object and filter out inherited properties, like so:</p><div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd"> var</span> <span class="nx">charactersBooks</span> <span class="o">=</span> <span class="p">{</span>    <span class="nx">Frodo</span><span class="o">:</span> <span class="s2">"Lord of the Rings"</span><span class="p">,</span>    <span class="nx">Aslan</span><span class="o">:</span> <span class="s2">"Chronicles of Narnia"</span><span class="p">,</span><span class="p">}; </span><span class="kd">var</span> <span class="nx">characters</span> <span class="o">=</span> <span class="p">[</span> <span class="p">];</span><span class="k">for</span> <span class="p"> (</span><span class="kd">var</span> <span class="nx">prop</span> <span class="k">in</span> <span class="nx">charactersBooks</span><span class="p">)</span> <span class="p">{</span>    <span class="k">if</span> <span class="p">(</span><span class="nx">charactersBooks</span><span class="p">.</span><span class="nx">hasOwnProperty</span><span class="p">(</span><span class="nx"> prop</span><span class="p">))</span> <span class="p">{</span>        <span class="nx">characters</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">prop</span><span class="p">);</span>    <span class="p">}</span><span class="p">}</span><span class="c1">// Outputs: ["Frodo", "Aslan"]</span><span class="nx">console </span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">characters</span><span class="p">);</span></code></pre></div><p>But with ECMAScript 5 we get access to <code>Object.keys</code> which eliminates this tedious boilerplate.</p><div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd"> var</span> <span class="nx">charactersBooks</span> <span class="o">=</span> <span class="p">{</span>    <span class="nx">Frodo</span><span class="o">:</span> <span class="s2">"Lord of the Rings"</span><span class="p">,</span>    <span class="nx">Aslan</span><span class="o">:</span> <span class="s2">"Chronicles of Narnia"</span><span class="p">,</span><span class="p">}; </span><span class="kd">var</span> <span class="nx">characters</span> <span class="o">=</span> <span class="nb">Object</span><span class="p">.</span><span class="nx">keys</span><span class ="p">(</span><span class="nx">charactersBooks</span><span class="p">);</span><span class="c1">// Outputs: ["Frodo", "Aslan"]</span><span class="nx">console</span><span class="p">. </span><span class="nx">log</span><span class="p">(</span><span class="nx">characters</span><span class="p">);</span></code></pre></div><p>As might be expected, <code>Object.keys</code> only retrieves the names of properties that are declared directly on the object. It doesn't get the names of inherited properties. In addition, it only retrieves the names of enumerable properties. Non-enumerable property names are omitted.</p><p>But ES5 also gave us another method called <code>Object.getOwnPropertyNames</code> which is less strict about which property names it will retrieve. Like <code>keys</code>, <code>getOwnPropertyNames</code> will only retrieve "own" properties. However, it will retrieve the names of non-enumerable properties. </p><p>Not sure what enumerable means in this context? Non-enumerable properties are essentially properties that shouldn't be "counted" or iterated over for some reason. (More discussion to come in future drips.) The simplest example is probably an array's <code>length</code> property. Let's see how our functions treat it.</p><div class="highlight"><pre><code class= "language-javascript" data-lang="javascript"><span class="kd">var</span> <span class="nx">authors</span> <span class="o">=</span> <span class="p">[</span><span class="s2">"Tolkien" </span><span class="p">,</span> <span class="s2">"Lewis"</span><span class="p">];</span><span class="c1">// Outputs: ["0", "1"]</span><span class="nx">console</span><span class="p">. </span><span class="nx">log</span><span class="p">(</span><span class="nb">Object</span><span class="p">.</span><span class="nx">keys</span><span class="p">(</span><span class="nx">authors </span><span class="p">));</span><span class="c1">// Outputs: ["0", "1", "length"]</span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">( </span><span class="nb">Object</span><span class="p">.</span><span class="nx">getOwnPropertyNames</span><span class="p">(</span><span class="nx">authors</span><span class="p">)); </span></code></pre></div><p>As you can see, <code>Object.keys</code> skipped over the non-enumerable <code>length</code> property while <code>Object.getOwnPropertyNames</code> did not. </p><p>How do you know when to use one or the other? My personal rule is to always default to using <code>Object.keys</code> unless I specifically need the name of non-enumerable properties.</p><p>Because both of these functions are part of the ES5 spec, they are not available in older browsers like IE8. And unfortunately, it is impossible to backport <code> Object.getOwnPropertyNames</code>. However, <code>Object.keys</code> can be backported with something like the <a href="https://github.com/kriskowal/es5-shim">ES5 Shim library</a>.</p> </div>			</div>		<!--=========================			END : POST		=============================-->		<!--=========================			START : POST =============================-->		<div class="post-wrapper"><div class="post">        <h1 class="post-title">Basic Inheritance with JavaScript Constructors</h1>            <p><i> Originally published in the                <a href="/">A Drip of JavaScript newsletter</a>.				</i></p>        <p>We've looked before at using JavaScript's constructors to create our own custom object types. But what we didn't look at was how we can create an inheritance hierarchy.</p><p>It's important to note that even though constructors are often referred to as "classes," they really aren't the same thing as classes in other languages. In JavaScript, a constructor is just a function invoked by the <code>new</code> operator which builds a new object.</p><p>Here's a little refresher:</p><div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">function </span> <span class="nx">SuperHuman</span> <span class="p">(</span><span class="nx">name</span><span class="p">,</span> <span class="nx">superPower</span><span class="p">)</span> <span class="p">{</span>    <span class="k">this</span><span class="p">.</span><span class="nx">name</span> <span class="o">=</span> <span class="nx">name</span><span class="p">;</span>    <span class="k">this</span><span class="p">.</span><span class="nx">superPower</span> <span class="o">=</span> <span class="nx">superPower</span><span class="p">;</span><span class="p">} </span><span class="nx">SuperHuman</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">usePower</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">( </span><span class="k">this</span><span class="p">.</span><span class="nx">superPower</span> <span class="o">+</span> <span class="s2">"!"</span><span class="p">);</span><span class="p">}; </span><span class="kd">var</span> <span class="nx">banshee</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">SuperHuman</span><span class="p">(</span><span class ="s2">"Silver Banshee"</span><span class="p">,</span> <span class="s2">"sonic wail"</span><span class="p">);</span><span class="c1">// Outputs: "sonic wail!"</span><span class="nx">banshee </span><span class="p">.</span><span class="nx">usePower</span><span class="p">();</span></code></pre></div><p>The <code>SuperHuman</code> constructor contains our initialization logic, while <code>SuperHuman.prototype</code> contains the methods that are shared across all <code>SuperHuman</code> instances.</p><p>But suppose that we want to create a new type which inherits from <code>SuperHuman</code> while adding its own functionality? What would that look like?</p><div class="highlight"><pre><code class="language-javascript" data-lang="javascript" ><span class="kd">function</span> <span class="nx">SuperHero</span> <span class="p">(</span><span class="nx">name</span><span class="p">,</span> <span class="nx">superPower</span><span class="p">)</span> <span class="p">{</span>    <span class="k">this</span><span class="p">.</span><span class="nx">name</span> <span class="o">=</span> <span class="nx">name</span><span class="p">;</span>    <span class="k">this</span><span class="p">.</span><span class="nx">superPower</span> <span class="o">=</span> <span class="nx">superPower</span><span class="p">; </span>    <span class="k">this</span><span class="p">.</span><span class="nx">allegiance</span> <span class="o">=</span> <span class="s2">"Good"</span><span class="p">;</span><span class= "p">}</span><span class="nx">SuperHero</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">saveTheDay</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">( </span><span class="k">this</span><span class="p">.</span><span class="nx">name</span> <span class="o">+</span> <span class="s2">" saved the day!"</span><span class="p">);</span><span class="p">};</span><span class="kd">var</span> <span class="nx">marvel</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">SuperHero</span><span class="p">( </span><span class="s2">"Captain Marvel"</span><span class="p">,</span> <span class="s2">"magic"</span><span class="p">);</span><span class="c1">// Outputs: "Captain Marvel saved the day!" </span><span class="nx">marvel</span><span class="p">.</span><span class="nx">saveTheDay</span><span class="p">();</span></code></pre></div><p>While this gets us started, there are a couple of problems. First of all, the <code>SuperHero</code> constructor is repeating some of the logic of the <code>SuperHuman</code> constructor. And more importantly, at this point instances of <code>SuperHero</code> don't have access to <code>SuperHuman</code> methods. For example:</p><div class="highlight"><pre><code class="language-javascript" data-lang= "javascript"><span class="c1">// TypeError: Object &lt;#SuperHero&gt; has no method 'usePower'</span><span class="nx">marvel</span><span class="p">.</span><span class="nx">usePower </span><span class="p">();</span></code></pre></div><p>Let's fix those couple of issues.</p><div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class ="kd">function</span> <span class="nx">SuperHero</span> <span class="p">(</span><span class="nx">name</span><span class="p">,</span> <span class="nx">superPower</span><span class="p">) </span> <span class="p">{</span>    <span class="c1">// Reuse SuperHuman initialization</span>    <span class="nx">SuperHuman</span><span class="p">.</span><span class="nx">call </span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">name</span><span class="p">,</span> <span class="nx">superPower</span><span class="p">); </span>    <span class="k">this</span><span class="p">.</span><span class="nx">allegiance</span> <span class="o">=</span> <span class="s2">"Good"</span><span class="p">;</span><span class= "p">}</span><span class="nx">SuperHero</span><span class="p">.</span><span class="nx">prototype</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">SuperHuman </span><span class="p">();</span><span class="nx">SuperHero</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">saveTheDay</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>    <span class="nx">console</span><span class="p">.</span><span class="nx">log </span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">name</span> <span class="o">+</span> <span class="s2">" saved the day!"</span><span class ="p">);</span><span class="p">};</span><span class="kd">var</span> <span class="nx">marvel</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">SuperHero</span><span class="p">(</span><span class="s2">"Captain Marvel"</span><span class="p">,</span> <span class="s2">"magic"</span><span class="p">);</span><span class="c1">// Outputs: "Captain Marvel saved the day!"</span><span class="nx">marvel</span><span class="p">.</span><span class="nx">saveTheDay</span><span class="p">();</span><span class="c1">// Outputs: "magic!"</span><span class="nx">marvel</span><span class="p">.</span><span class="nx">usePower</span><span class="p">();</span></code></pre></div><p>We've managed to eliminate the repeated constructor logic by calling <code>SuperHuman</code> with <code>SuperHero</code>'s <code>this</code> object and passing along the necessary arguments. That ensures that <code>SuperHuman</code>'s initialization logic will act on the new <code>SuperHero</code> object. And then we tack on the additional logic that is specific to <code>SuperHero</code>.</p><p>But where the inheritance comes in is on <code>SuperHero.prototype</code>. In order to ensure that it inherits the methods from <code>SuperHuman.prototype</code>, we actually make it an instance of <code>SuperHuman</code> with <code>new SuperHuman()</code>.</p><p>This basic inheritance pattern won't always work, particularly if the parent constructor is complex, but it will handle simple situations quite well.</p><p>In future issues we'll take a look at more sophisticated ways of doing inheritance.</p>    </div>			</div> <!--=========================			END : POST		=============================-->		<!--=========================			START : POST =============================-->		<div class="post-wrapper"><div class="post">        <h1 class="post-title">Object Equality in JavaScript</h1>            <p><i> Originally published in the                <a href="/">A Drip of JavaScript newsletter</a>.            </i></p>        <p>Equality is one of the most initially confusing aspects of JavaScript. The behavior of <code>==</code> versus <code>===</code>, the order of type coercions, etc. all serve to complicate the subject. Today we'll be looking at another facet: how object equality works.</p><p>You might suppose that if two objects have the same properties and all of their properties have the same value, they would be considered equal. Let's take a look and see what happens.</p><div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">var</span> <span class="nx">jangoFett</span> <span class ="o">=</span> <span class="p">{</span>    <span class="nx">occupation</span><span class="o">:</span> <span class="s2">"Bounty Hunter"</span><span class="p">,</span>    <span class="nx"> genetics</span><span class="o">:</span> <span class="s2">"superb"</span><span class="p">};</span><span class="kd">var</span> <span class="nx">bobaFett</span> <span class="o">=</span> <span class="p">{</span>    <span class="nx">occupation</span><span class="o">:</span> <span class="s2">"Bounty Hunter"</span><span class="p">,</span>    <span class="nx">genetics</span><span class="o">:</span> <span class="s2">"superb"</span><span class="p">};</span><span class="c1">// Outputs: false</span><span class="nx">console</span><span class="p">.</span><span class="nx" >log</span><span class="p">(</span><span class="nx">bobaFett</span> <span class="o">===</span> <span class="nx">jangoFett</span><span class="p">);</span></code></pre></div><p>The properties of <code>bobaFett</code> and <code>jangoFett</code> are identical, yet the objects themselves aren't considered equal. Perhaps it's because we're using triple equals? Let's test that theory.</p><div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="c1">// Outputs: false</span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">bobaFett</span> <span class="o">==</span> <span class="nx">jangoFett</span><span class="p">); </span></code></pre></div><p>The reason for this is that internally JavaScript actually has two different approaches for testing equality. Primitives like strings and numbers are compared by their value, while objects like arrays, dates, and plain objects are compared by their reference. That comparison by reference basically checks to see if the objects given refer to the same location in memory. Here is an example of how that works.</p><div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">var</span> <span class="nx">jangoFett</span> <span class="o">=</span> <span class="p">{</span>    <span class="nx">occupation</span><span class="o">:</span> <span class="s2">"Bounty Hunter"</span><span class="p">,</span>    <span class="nx">genetics</span><span class="o">:</span> <span class="s2">"superb"</span><span class="p">};</span><span class="kd">var</span> <span class="nx"> bobaFett</span> <span class="o">=</span> <span class="p">{</span>    <span class="nx">occupation</span><span class="o">:</span> <span class="s2">"Bounty Hunter"</span><span class="p">, </span>    <span class="nx">genetics</span><span class="o">:</span> <span class="s2">"superb"</span><span class="p">};</span><span class="kd">var</span> <span class="nx">callMeJango</span> <span class="o">=</span> <span class="nx">jangoFett</span><span class="p">;</span><span class="c1">// Outputs: false</span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">bobaFett</span> <span class="o">===</span> <span class="nx">jangoFett</span><span class="p">);</span><span class="c1">// Outputs: true</span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">callMeJango</span> <span class="o">===</span> <span class="nx">jangoFett</span><span class="p">);</span></code></pre></div><p>On the one hand, the variables <code>jangoFett</code> and <code>bobaFett</code> refer to two objects with identical properties, but they are each distinct instances. On the other hand <code>jangoFett</code> and <code>callMeJango</code> both refer to the same instance.</p><p>Because of this, when you are trying to check for object equality you need to have a clear idea about what sort of equality you are interested in. Do you want to check that these two things are the exact same instance? Then you can use JavaScript's built-in equality operators. Or do you want to check that these two objects are the "same value?" If that's the case, then you'll need to do a bit more work.</p><p>Here is a very basic approach to checking an object's "value equality".</p><div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">function</span> <span class="nx">isEquivalent</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span> <span class="nx">b</span><span class="p">)</span> <span class="p">{</span>    <span class="c1">// Create arrays of property names</span>    <span class="kd">var</span> <span class="nx">aProps</span> <span class="o">=</span> <span class= "nb">Object</span><span class="p">.</span><span class="nx">getOwnPropertyNames</span><span class="p">(</span><span class="nx">a</span><span class="p">);</span>    <span class="kd">var </span> <span class="nx">bProps</span> <span class="o">=</span> <span class="nb">Object</span><span class="p">.</span><span class="nx">getOwnPropertyNames</span><span class="p">( </span><span class="nx">b</span><span class="p">);</span>    <span class="c1">// If number of properties is different,</span>    <span class="c1">// objects are not equivalent</span> <span class="k">if</span> <span class="p">(</span><span class="nx">aProps</span><span class="p">.</span><span class="nx">length</span> <span class="o">!=</span> <span class="nx">bProps </span><span class="p">.</span><span class="nx">length</span><span class="p">)</span> <span class="p">{</span>        <span class="k">return</span> <span class="kc">false</span><span class ="p">;</span>    <span class="p">}</span>    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class= "mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">aProps</span><span class="p">.</span><span class="nx">length</span><span class= "p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>        <span class="kd">var</span> <span class="nx">propName</span> <span class="o">=</span> <span class="nx">aProps</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>        <span class="c1">// If values of same property are not equal,</span>        <span class="c1">// objects are not equivalent</span>        <span class="k">if</span> <span class="p">(</span><span class="nx">a</span><span class="p">[</span><span class="nx">propName</span><span class="p">]</span> <span class="o">!==</span> <span class="nx">b</span><span class="p">[</span><span class="nx">propName</span><span class="p">])</span> <span class="p">{</span>            <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>        <span class="p">}</span>    <span class="p">}</span>    <span class="c1">// If we made it this far, objects</span>    <span class="c1">// are considered equivalent</span>    <span class="k">return</span> <span class="kc">true</span><span class="p">; </span><span class="p">}</span><span class="c1">// Outputs: true</span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class ="nx">isEquivalent</span><span class="p">(</span><span class="nx">bobaFett</span><span class="p">,</span> <span class="nx">jangoFett</span><span class="p">));</span></code></pre></div><p> As you can see, to check the objects' "value equality" we essentially have to iterate over every property in the objects to see whether they are equal. And while this simple implementation works for our example, there are a lot of cases that it doesn't handle. For instance:</p><ul><li>What if one of the property values is itself an object?</li><li>What if one of the property values is <code>NaN</code> (the only value in JavaScript that is not equal to itself?)</li><li>What if <code>a</code> has a property with value <code>undefined</code>, while <code>b</code> doesn't have this property (which thus evaluates to <code>undefined</code>?)</li></ul><p>For a robust method of checking objects' "value equality" it is better to rely on a well-tested library that covers the various edge cases. Both <a href="http://underscorejs.org/#isEqual">Underscore</a> and <a href="http://lodash.com/docs#isEqual">Lo-Dash</a> have implementations named <code>_.isEqual</code> which handle deep object comparisons well. You can use them like this:</p><div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="c1">// Outputs: true</span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">_ </span><span class="p">.</span><span class="nx">isEqual</span><span class="p">(</span><span class="nx">bobaFett</span><span class="p">,</span> <span class="nx">jangoFett</span><span class= "p">));</span></code></pre></div><p>I hope that this drip of JavaScript has helped you get a better grasp of how object equality works.</p>    </div>			</div> <!--=========================			END : POST		=============================-->		<!--=========================			START : POST =============================-->		<div class="post-wrapper"><div class="post">        <h1 class="post-title">Ditching jQuery with `querySelectorAll`</h1>            <p><i> Originally published in the                <a href="/">A Drip of JavaScript newsletter</a>.            </i></p>        <p>For many developers, jQuery serves as their first introduction to JavaScript. And jQuery does a great job of easing the learning curve by hiding away browser inconsistencies and using an intuitive chaining syntax. But probably the most distinctive feature of jQuery is its use of CSS selectors to choose which elements to manipulate.</p><p>For example, consider an HTML page that looks like this:</p><div class="highlight" ><pre><code class="language-html" data-lang="html"><span class="cp">&lt;!doctype html&gt;</span><span class="nt">&lt;html&gt;</span>    <span class="nt">&lt;head&gt;</span>        <span class="nt">&lt;title&gt;</span>Programming Languages<span class="nt">&lt;/title&gt;</span>		<span class="nt">&lt;/head&gt;</span>    <span class="nt">&lt;body&gt;</span>        <span class="nt">&lt;h1&gt;</span>Programming Languages<span class="nt">&lt;/h1&gt;</span>        <span class="nt">&lt;ul&gt;</span>            <span class="nt">&lt;li&gt;</span>JavaScript<span class="nt">&lt;/li&gt;</span>            <span class="nt">&lt;li&gt;</span>CoffeeScript<span class="nt">&lt;/li&gt;</span>            <span class="nt">&lt;li&gt;</span>Ruby<span class="nt" >&lt;/li&gt;</span>            <span class="nt">&lt;li&gt;</span>Python<span class="nt">&lt;/li&gt;</span>        <span class="nt">&lt;/ul&gt;</span>        <span class="nt">&lt;script </span><span class="na">src=</span><span class="s">"example.js"</span><span class="nt">&gt;&lt;/script&gt;</span>    <span class="nt">&lt;/body&gt;</span><span class="nt">&lt;/html&gt; </span></code></pre></div><p>If you want to use jQuery to add a class to the first and last <code>li</code>, that's as simple as:</p><div class="highlight"><pre><code class= "language-javascript" data-lang="javascript"><span class="nx">$</span><span class="p">(</span><span class="s2">"li:first-child, li:last-child"</span><span class="p">).</span><span class= "nx">addClass</span><span class="p">(</span><span class="s2">"list-end"</span><span class="p">);</span></code></pre></div><p>What many people don't realize is that modern web browsers actually support a native DOM method that can use CSS selectors in exactly the same way. Let's see how that works.</p><div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">var</span> <span class="nx">selector</span> <span class="o">=</span> <span class="s2">"li:first-child, li:last-child"</span><span class="p">; </span><span class="kd">var</span> <span class="nx">listEnds</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">querySelectorAll </span><span class="p">(</span><span class="nx">selector</span><span class="p">);</span><span class="kd">var</span> <span class="nx">listEndsArr</span> <span class="o">=</span> <span class ="p">[].</span><span class="nx">slice</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">listEnds</span><span class="p">);</span><span class ="nx">listEndsArr</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">el </span><span class="p">)</span> <span class="p">{</span>    <span class="nx">el</span><span class="p">.</span><span class="nx">className</span> <span class="o">+=</span> <span class="s2"> "list-end"</span><span class="p">;</span><span class="p">});</span></code></pre></div><p>As you can see, <code>querySelectorAll</code> will return a list of matching elements. However, the list that it returns is a <code>NodeList</code>, one of those "array-like" objects that isn't really an array. That means that we can't directly use some array methods like <code> forEach</code>.</p><p>To get around that problem, we use <code>slice.call</code> to create a real array of the matching elements. And once we have a real array we use <code>forEach</code> to add the class to each matching element.</p><p>There are some issues to keep in mind when using <code>querySelectorAll</code>. First, the CSS selectors you can use will be limited by the selectors that the browser supports. Second, while it enjoys good support among modern browsers, <code>querySelectorAll</code> is not available in IE7 and below.</p><p>Of course, <code>querySelectorAll</code> isn't a full replacement for jQuery, but it does get you one step closer to jQuery independence.</p>    </div>			</div> <!--=========================			END : POST		=============================-->		<!--=========================			START : POST =============================-->		<div class="post-wrapper"><div class="post">        <h1 class="post-title">Truthy and Falsy Values in JavaScript</h1>            <p><i> Originally published in the                <a href="/">A Drip of JavaScript newsletter</a>.            </i></p>        <p>Longtime JavaScript developers often toss around the terms "truthy" and "falsy", but for those who are newer to JavaScript these terms can be a bit mystifying.</p><p>When we say that a value is "truthy" in JavaScript, we don't just mean that the value is <code>true</code>. Rather, what we mean is that the value coerces to <code>true</code> when evaluated in a boolean context. Let's look at what that means.</p><div class= "highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">function</span> <span class="nx">logTruthiness</span> <span class="p">(</span><span class="nx"> val</span><span class="p">)</span> <span class="p">{</span>    <span class="k">if</span> <span class="p">(</span><span class="nx">val</span><span class="p">)</span> <span class="p">{ </span>        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">"Truthy!"</span><span class="p">);</span>    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">( </span><span class="s2">"Falsy."</span><span class="p">);</span>    <span class="p">}</span><span class="p">}</span></code></pre></div><p>This function takes the <code>val</code> parameter and evaluates it in a boolean context (the condition of the <code>if</code> statement.) So let's try it out on some values.</p><div class="highlight"><pre><code class= "language-javascript" data-lang="javascript"><span class="c1">// Outputs: "Truthy!"</span><span class="nx">logTruthiness</span><span class="p">(</span><span class="kc">true</span><span class="p">);</span><span class="c1">// Outputs: "Truthy!"</span><span class="nx">logTruthiness</span><span class="p">({});</span><span class="c1">// Outputs: "Truthy!"</span><span class= "nx">logTruthiness</span><span class="p">([]);</span><span class="c1">// Outputs: "Truthy!"</span><span class="nx">logTruthiness</span><span class="p">(</span><span class="s2">"some string"</span><span class="p">);</span><span class="c1">// Outputs: "Truthy!"</span><span class="nx">logTruthiness</span><span class="p">(</span><span class="mf">3.14</span><span class="p" >);</span><span class="c1">// Outputs: "Truthy!"</span><span class="nx">logTruthiness</span><span class="p">(</span><span class="k">new</span> <span class="nb">Date</span><span class="p"> ());</span></code></pre></div><p>As you can see, there are a lot of truthy values in JavaScript. And there are many more than could be listed here. On the other side, though, there are only six falsy values. In fact, because the list of falsy values is so short, memorizing that list is the easiest way to tell whether a value is truthy or falsy. Here is the list:</p><div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="c1">// Outputs: "Falsy."</span><span class="nx">logTruthiness</span><span class="p">( </span><span class="kc">false</span><span class="p">);</span><span class="c1">// Outputs: "Falsy."</span><span class="nx">logTruthiness</span><span class="p">(</span><span class="kc">null </span><span class="p">);</span><span class="c1">// Outputs: "Falsy."</span><span class="nx">logTruthiness</span><span class="p">(</span><span class="kc">undefined</span><span class="p">); </span><span class="c1">// Outputs: "Falsy."</span><span class="nx">logTruthiness</span><span class="p">(</span><span class="kc">NaN</span><span class="p">);</span><span class="c1">// Outputs: "Falsy."</span><span class="nx">logTruthiness</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span><span class="c1">// Outputs: "Falsy."</span><span class="nx">logTruthiness</span><span class="p">(</span><span class="s2">""</span><span class="p">);</span></code></pre></div><p>That's a pretty straightforward list. But how can we actually use truthiness? Let's look at an example.</p><div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">function</span> <span class="nx" >reportAttitude</span> <span class="p">(</span><span class="nx">person</span><span class="p">)</span> <span class="p">{</span>    <span class="k">if</span> <span class="p">(</span><span class="nx">person</span><span class="p">.</span><span class="nx">skepticism</span><span class="p">)</span> <span class="p">{</span>        <span class="nx">console</span><span class="p">. </span><span class="nx">log</span><span class="p">(</span><span class="nx">person</span><span class="p">.</span><span class="nx">name</span> <span class="o">+</span> <span class="s2">" is skeptical about "</span> <span class="o">+</span>                    <span class="nx">person</span><span class="p">.</span><span class="nx">skepticism</span><span class="p">);</span>    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>        <span class="nx">console</span><span class="p">.</span><span class="nx">log </span><span class="p">(</span><span class="nx">person</span><span class="p">.</span><span class="nx">name</span> <span class="o">+</span> <span class="s2">" wants to believe."</span><span class="p">);</span>    <span class="p">}</span><span class="p">}</span><span class="kd">var</span> <span class="nx">mulder</span> <span class="o">=</span> <span class="p">{</span> <span class="nx">name</span><span class="o">:</span> <span class="s2">"Fox Mulder"</span><span class="p">};</span><span class="kd">var</span> <span class="nx">scully</span> <span class="o" >=</span> <span class="p">{</span>    <span class="nx">name</span><span class="o">:</span> <span class="s2">"Dana Scully"</span><span class="p">,</span>    <span class="nx">skepticism </span><span class="o">:</span> <span class="s2">"UFOs &amp; conspiracy theories"</span><span class="p">};</span><span class="kd">var</span> <span class="nx">frohikey</span> <span class= "o">=</span> <span class="p">{</span>    <span class="nx">name</span><span class="o">:</span> <span class="s2">"Melvin Frohikey"</span><span class="p">,</span>    <span class="nx"> skepticism</span><span class="o">:</span> <span class="s2">""</span><span class="p">};</span><span class="c1">// Outputs: "Fox Mulder wants to believe."</span><span class="nx"> reportAttitude</span><span class="p">(</span><span class="nx">mulder</span><span class="p">);</span><span class="c1">// Outputs: "Dana Scully is skeptical about UFOs and conspiracy theories."</span><span class="nx">reportAttitude</span><span class="p">(</span><span class="nx">scully</span><span class="p">);</span><span class="c1">// Outputs: "Melvin Frohikey wants to believe."</span><span class="nx">reportAttitude</span><span class="p">(</span><span class="nx">frohikey</span><span class="p">);</span></code></pre></div><p>Taking advantage of truthiness can make your code a little bit more concise. We don't need to explicitly check for <code>undefined</code>, <code>""</code>, etc. Instead we can just check whether <code> person.skepticism</code> is truthy. However, there some caveats to keep in mind.</p><p>Firstly, this approach only works if <strong>all</strong> of the falsy values should be excluded (or included.) For instance, if a value of <code>0</code> or <code>""</code> was meaningful, then the <code>if</code> above would not function correctly.</p><p>Secondly, it is important to keep in mind that truthiness is not the same as <code>== true</code>. The algorithm for loose equality is much more complicated than for truthiness. We'll go into more detail about that in a future drip.</p><p>I hope this introduction to truthiness and falsiness helps you to write clearer, more concise JavaScript.</p><p>Thanks for reading!</p><p>Josh Clanton</p> </div>			</div>		<!--=========================			END : POST		=============================-->		<!--=========================			START : POST =============================-->		<div class="post-wrapper"><div class="post">	<h1 class="post-title">Emulating Block Scope in JavaScript</h1>            <p><i> Originally published in the                <a href="/">A Drip of JavaScript newsletter</a>.            </i></p>        <p>While there are many issues that trip up developers coming from other languages, variable scoping may be number one. The fundamental problem is that many expect variables to be scoped to a particular block (like a <code>for</code> loop), but in JavaScript variables declared with <code>var</code> are scoped to the nearest parent function.</p><p>First let's take a look at how this can go wrong.</p><div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">var</span> <span class="nx">avatar</span> <span class="o">=</span> <span class="s2">"Ang"</span><span class="p">; </span><span class="kd">var</span> <span class="nx">element</span> <span class="o">=</span> <span class="s2">"Air"</span><span class="p">;</span><span class="kd">var</span> <span class= "nx">elements</span> <span class="o">=</span> <span class="p">[</span>    <span class="s2">"Air"</span><span class="p">,</span>    <span class="s2">"Earth"</span><span class="p">,</span> <span class="s2">"Fire"</span><span class="p">,</span>    <span class="s2">"Water"</span><span class="p">];</span><span class="k">for</span> <span class="p">(</span><span class="kd"> var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx"> elements</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{ </span>    <span class="kd">var</span> <span class="nx">element</span> <span class="o">=</span> <span class="nx">elements</span><span class="p">[</span><span class="nx">i</span><span class ="p">];</span>    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">avatar</span> <span class="o">+</span> <span class="s2">" has mastered "</span> <span class="o">+</span> <span class="nx">element</span><span class="p">);</span><span class="p">}</span><span class="c1">// Outputs: "Ang's primary element is Water"</span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">avatar</span> <span class="o">+</span> <span class="s2">"'s primary element is "</span> <span class="o">+</span> <span class="nx">element</span><span class="p">);</span></code></pre></div><p>A developer used to a language with block scoping might not see anything wrong with the code above, and would expect <code>"Ang's primary element is Air"</code> instead of the actual result.</p><p>This issue is easily avoided once you become aware of it. Avoiding variable declarations within blocks tends to prevent any confusion.</p><p>But suppose that we really wanted to use block scoping in JavaScript. How would we go about it? We could do something like this.</p><div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">var</span> <span class="nx">avatar</span> <span class="o">=</span> <span class="s2">"Ang"</span><span class="p">;</span><span class="kd">var</span> <span class="nx">element</span> <span class="o">= </span> <span class="s2">"Air"</span><span class="p">;</span><span class="kd">var</span> <span class="nx">elements</span> <span class="o">=</span> <span class="p">[</span>    <span class= "s2">"Air"</span><span class="p">,</span>    <span class="s2">"Earth"</span><span class="p">,</span>    <span class="s2">"Fire"</span><span class="p">,</span>    <span class="s2">"Water" </span><span class="p">];</span><span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0 </span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">elements</span><span class="p">.</span><span class="nx">length</span><span class="p"> ;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>    <span class="p">(</span><span class="kd">function</span><span class="p">() </span> <span class="p">{</span>        <span class="kd">var</span> <span class="nx">element</span> <span class="o">=</span> <span class="nx">elements</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">avatar</span> <span class="o">+</span> <span class="s2">" has mastered "</span> <span class="o">+</span> <span class="nx">element</span><span class="p">);</span>    <span class="p">})();</span><span class="p">}</span><span class="c1">// Outputs: "Ang's primary element is Air"</span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">( </span><span class="nx">avatar</span> <span class="o">+</span> <span class="s2">"'s primary element is "</span> <span class="o">+</span> <span class="nx">element</span><span class="p">); </span></code></pre></div><p>This solution uses an <a href="http://designpepper.com/blog/drips/an-introduction-to-iifes-immediately-invoked-function-expressions">IIFE</a> to emulate block scoping. Since functions are JavaScript's scoping mechanism, we define and immediately invoke a new function on each pass through the loop, therefore approximating the behavior of a block scope.</p><p>While this isn't idiomatic JavaScript, it does help give you an idea of just how flexible JavaScript can be.</p><p>It is also worth noting that drafts of the ECMAScript 6 specification (the next version of JavaScript) include a <code>let</code> keyword which is used to define block-scoped variables. If you are interested in playing around with this proposed keyword, it is <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/let">available in FireFox</a>.</p><p>Thanks for reading!</p><p>Josh Clanton </p>    </div></div>		<!--=========================			END : POST		=============================-->		<!--=========================			START : POST =============================-->		<div class="post-wrapper"><div class="post">        <h1 class="post-title">Understanding the Module Pattern in JavaScript</h1>            <p><i> Originally published in the                <a href="/">A Drip of JavaScript newsletter</a>.            </i></p>        <p>Of all the design patterns you are likely to encounter in JavaScript, the module pattern is probably the most pervasive. But it can also look a little strange to developers coming from other languages.</p><p>Let's walk through an example to see how it works. Suppose that we have a library of utility functions that looks something like this:</p><div class="highlight"><pre><code class="language-javascript" data-lang= "javascript"><span class="kd">var</span> <span class="nx">batman</span> <span class="o">=</span> <span class="p">{</span>    <span class="nx">identity</span><span class="o">:</span> <span class="s2">"Bruce Wayne"</span><span class="p">,</span>    <span class="nx">fightCrime</span><span class="o">:</span> <span class="kd">function</span> <span class="p">()</span> <span class ="p">{</span>	<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">"Cleaning up Gotham."</span><span class="p">); </span>    <span class="p">},</span>    <span class="nx">goCivilian</span><span class="o">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">"Attend social events as "</span> <span class="o">+ </span> <span class="k">this</span><span class="p">.</span><span class="nx">identity</span><span class="p">);</span>    <span class="p">}</span><span class="p">}; </span></code></pre></div><p>This version of <code>batman</code> is perfectly serviceable. It can fight crime when you call upon it. However, it has a serious weakness. This <code>batman </code>'s <code>identity</code> property is publicly accessible.</p><p>Any code in your application could potentially overwrite it and cause <code>batman</code> to malfunction. For example:</p><div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="c1">// Some joker put this in your codebase</span><span class="nx">batman </span><span class="p">.</span><span class="nx">identity</span> <span class="o">=</span> <span class="s2">"a raving lunatic"</span><span class="p">;</span><span class="c1">// Outputs: "Attend social events as a raving lunatic"</span><span class="nx">batman</span><span class="p">.</span><span class="nx">goCivilian</span><span class="p">();</span></code></pre></div><p>To avoid these sorts of situations we need a way to keep certain pieces of data private. Fortunately, JavaScript gives us just such a tool. We've <a href=" http://designpepper.com/blog/drips/an-introduction-to-iifes-immediately-invoked-function-expressions">even talked about it before</a>: the immediately invoked function expression (IIFE). </p><p>A standard IIFE looks like this:</p><div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>    <span class="c1">// Code goes here</span><span class="p">})();</span></code></pre></div><p>The advantage of the IIFE is that any <code>var</code>s declared inside it are inaccessible to the outside world. So how does that help us? The key is that an IIFE can have a return value just like any other function.</p><div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">var</span> <span class="nx">batman</span> <span class="o">=</span> <span class="p">( </span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>    <span class="kd">var</span> <span class="nx">identity</span> <span class="o">=</span> <span class="s2">"Bruce Wayne"</span><span class="p">;</span>    <span class="k">return</span> <span class="p">{</span>        <span class="nx">fightCrime</span><span class="o">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>            <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">( </span><span class="s2">"Cleaning up Gotham."</span><span class="p">);</span>        <span class="p">},</span>        <span class="nx">goCivilian</span><span class="o">:</span> <span class ="kd">function</span> <span class="p">()</span> <span class="p">{</span>            <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">( </span><span class="s2">"Attend social events as "</span> <span class="o">+</span> <span class="nx">identity</span><span class="p">);</span>        <span class="p">}</span>    <span class= "p">};</span><span class="p">})();</span><span class="c1">// Outputs: undefined</span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">( </span><span class="nx">batman</span><span class="p">.</span><span class="nx">identity</span><span class="p">);</span><span class="c1">// Outputs: "Attend social events as Bruce Wayne" </span><span class="nx">batman</span><span class="p">.</span><span class="nx">goCivilian</span><span class="p">();</span></code></pre></div><p>As you can see, we were able to use the IFFE's return value to make <code>batman</code>'s utility functions publicly accessible. And at the same time we were able to ensure that <code>batman</code>'s <code>identity</code> remains a secret from any clowns who want to mess with it.</p><p>You might be wondering when using the module pattern is a good idea. The answer is that it works well for situations like the one illustrated here. If you need to both enforce privacy for some of your data and provide a public interface, then the module pattern is probably a good fit.</p><p>It is worth considering, though whether you really need to enforce data privacy, or whether using a naming convention to indicate private data is a better approach. The answer to that question will vary on a case by case basis. But now you're equipped to enforce data privacy if necessary.</p><p>Thanks for reading!</p><p>Josh Clanton</p>    </div>			</div> <!--=========================			END : POST		=============================-->		<!--=========================			START : POST =============================-->		<div class="post-wrapper"><div class="post">        <h1 class="post-title">Finding Array Elements with Array#indexOf</h1>            <p><i> Originally published in the                <a href="/">A Drip of JavaScript newsletter</a>.            </i></p>        <p>If you are a JavaScript developer you are probably quite familiar with the <code>indexOf</code> method available on strings. The basic functionality of <code>Array</code>'s <code>indexOf</code> is very similar. But we will also explore the complexities introduced due to arrays being composed of disparate types of values.</p><p>Suppose that you have an array which represents an ordered rank of elements and you need to find out just where a given element falls in the ranking. Without <code>indexOf</code> we would need to do something like this.</p><div class="highlight"><pre><code class= "language-javascript" data-lang="javascript"><span class="kd">var</span> <span class="nx">power</span> <span class="o">=</span> <span class="p">[</span>    <span class="s2">"Superman" </span><span class="p">,</span>    <span class="s2">"Wonder Woman"</span><span class="p">,</span>    <span class="s2">"Batman"</span><span class="p">];</span><span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">power</span><span class="p">.</span><span class="nx">length</span> <span class="o">&amp;&amp;</span> <span class="nx">power</span><span class="p">[ </span><span class="nx">i</span><span class="p">]</span> <span class="o">!==</span> <span class="s2">"Wonder Woman"</span><span class="p">;</span> <span class="nx">i</span><span class="o"> ++</span><span class="p">)</span> <span class="p">{</span>    <span class="c1">// No internal logic is necessary.</span><span class="p">}</span><span class="kd">var</span> <span class="nx" >rank</span> <span class="o">=</span> <span class="nx">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span><span class="c1">// Outputs: "Wonder Woman's rank is 2"</span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">"Wonder Woman's rank is "</span> <span class="o">+ </span> <span class="nx">rank</span><span class="p">);</span></code></pre></div><p>While the <code>for</code> loop isn't too complicated, with <code>indexOf</code> we no longer have to keep track of the state of our counters and array elements. Instead we can simply do this:</p><div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">var</span> <span class="nx">power</span> <span class="o">=</span> <span class="p">[</span>    <span class="s2">"Superman"</span><span class="p">,</span>    <span class="s2"> "Wonder Woman"</span><span class="p">,</span>    <span class="s2">"Batman"</span><span class="p">];</span><span class="kd">var</span> <span class="nx">index</span> <span class="o">=</span> <span class="nx">power</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="s2">"Wonder Woman"</span><span class="p">);</span><span class="kd" >var</span> <span class="nx">rank</span> <span class="o">=</span> <span class="nx">index</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span><span class="c1"> // Outputs: "Wonder Woman's rank is 2"</span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">"Wonder Woman's rank is "</span> <span class="o">+</span> <span class="nx">rank</span><span class="p">);</span></code></pre></div><p>The <code>indexOf</code> method will return the index of the first element which matches your search. Or if it does not find a match it will return <code>-1</code>.</p><p>It also gives you the ability to start your search at an index other than <code>0 </code>. This can help speed things up if you already know you can rule out some portion at the beginning of the array. You can use it like this:</p><div class="highlight"><pre><code class ="language-javascript" data-lang="javascript"><span class="kd">var</span> <span class="nx">power</span> <span class="o">=</span> <span class="p">[</span>    <span class="s2">"Superman" </span><span class="p">,</span>    <span class="s2">"Wonder Woman"</span><span class="p">,</span>    <span class="s2">"Batman"</span><span class="p">];</span><span class="kd">var</span> <span class="nx">index</span> <span class="o">=</span> <span class="nx">power</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="s2">"Wonder Woman"</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span><span class="kd">var</span> <span class="nx">rank</span> <span class="o">=</span> <span class="nx"> index</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span><span class="c1">// Outputs: "Wonder Woman's rank is 2"</span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">"Wonder Woman's rank is "</span> <span class="o">+</span> <span class="nx">rank</span><span class="p"> );</span></code></pre></div><p>While merely skipping one element is a trivial gain, if you are dealing with thousands of elements you may be able to obtain a significant boost in performance.</p><p>There is one final aspect to consider: equality. The <code>indexOf</code> method uses strict equality (<code>===</code>) to determine if an element matches your search. This works great for primitives like strings and numbers. But you may have difficulty using <code>indexOf</code> to search for a given object or array. For example:</p><div class= "highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">var</span> <span class="nx">basilicas</span> <span class="o">=</span> <span class="p">[</span> <span class="p">{</span>        <span class="nx">name</span><span class="o">:</span> <span class="s2">"St. Peter's"</span><span class="p">,</span>        <span class="nx">city </span><span class="o">:</span> <span class="s2">"Rome"</span>    <span class="p">},</span>    <span class="p">{</span>        <span class="nx">name</span><span class="o">:</span> <span class="s2">"St. John Lateran"</span><span class="p">,</span>        <span class="nx">city</span><span class="o">:</span> <span class="s2">"Rome"</span>    <span class="p">}</span><span class="p">];</span><span class="kd">var</span> <span class="nx">lateranIndex</span> <span class="o">=</span> <span class="nx">basilicas</span><span class="p">.</span><span class="nx"> indexOf</span><span class="p">({</span>    <span class="nx">name</span><span class="o">:</span> <span class="s2">"St. John Lateran"</span><span class="p">,</span>    <span class="nx">city </span><span class="o">:</span> <span class="s2">"Rome"</span><span class="p">});</span><span class="c1">// Outputs: -1</span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">lateranIndex</span><span class="p">);</span></code></pre></div><p>What's going on here? Why isn't <code>indexOf</code> finding the index of St. John Lateran? That's a consequence of how object equality works in JavaScript. Two objects can have exactly the same properties and values, but unless they are the exact same object instance they are not equal. If you need to match on an object or array with <code>indexOf</code>, you'll need to retain a reference to the original object instance, like so:</p><div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">var</span> <span class="nx">peters</span> <span class="o">=</span> <span class="p">{</span>    <span class="nx">name</span><span class="o">:</span> <span class="s2">"St. Peter's"</span><span class="p">,</span>    <span class="nx">city</span><span class="o">: </span> <span class="s2">"Rome"</span><span class="p">};</span><span class="kd">var</span> <span class="nx">lateran</span> <span class="o">=</span> <span class="p">{</span>    <span class= "nx">name</span><span class="o">:</span> <span class="s2">"St. John Lateran"</span><span class="p">,</span>    <span class="nx">city</span><span class="o">:</span> <span class="s2">"Rome" </span><span class="p">};</span><span class="kd">var</span> <span class="nx">basilicas</span> <span class="o">=</span> <span class="p">[</span><span class="nx">peters</span><span class="p" >,</span> <span class="nx">lateran</span><span class="p">];</span><span class="kd">var</span> <span class="nx">lateranIndex</span> <span class="o">=</span> <span class="nx">basilicas </span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="nx">lateran</span><span class="p">);</span><span class="c1">// Outputs: 1</span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">lateranIndex</span><span class="p">);</span></code></pre></div><p>If you need a more robust solution that allows you to match on complex objects without retaining a reference, look into combining the <a href="http://lodash.com/docs#findIndex">findIndex</a> and <a href="http://lodash.com/docs#isEqual">isEqual</a> methods from Lo-Dash.</p><p>It is worth pointing out that <code>Array</code>'s <code>indexOf</code> method is part of the ECMAScript 5 specification. As such it is not available in IE8 and below. If you need this functionality in older browsers, you can use <a href="https://github.com/kriskowal/es5-shim">ES5 Shim</a> to backport it, or the equivalent <code>indexOf</code> method in the <a href="http://underscorejs.org/#indexOf">Underscore</a> or <a href="http://lodash.com/docs#indexOf">Lo-Dash </a> libraries.</p><p>Thanks for reading!</p><p>Joshua Clanton</p>    </div>			</div>		<!--=========================			END : POST =============================-->		<!--=========================			START : POST		=============================-->		<div class="post-wrapper"><div class="post"> <h1 class="post-title">Using JavaScript's Array Methods on Strings</h1>            <p><i>                Originally published in the                <a href="/">A Drip of JavaScript newsletter</a>.            </i></p>        <p>We've talked before about using <code>apply</code> and <code>call</code> to let methods from one object operate on a different object. But this time we'll take a detailed look at how that works with strings and array methods specifically.</p><p>Because in many ways strings behave as if they were arrays of characters, many of JavaScript's standard array methods can operate on strings as well. Many, however, is not all. For example:</p><div class="highlight"><pre><code class= "language-javascript" data-lang="javascript"><span class="kd">var</span> <span class="nx">ontologist</span> <span class="o">=</span> <span class="s2">"Anselm"</span><span class="p">; </span><span class="p">[].</span><span class="nx">push</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">ontologist</span><span class="p">, </span> <span class="s2">" of Canterbury"</span><span class="p">);</span><span class="c1">// Outputs: "Anselm"</span><span class="nx">console</span><span class="p">.</span><span class="nx" >log</span><span class="p">(</span><span class="nx">ontologist</span><span class="p">);</span></code></pre></div><p>As you can see, the <code>ontologist</code> string was not modified, even though the whole point of <code>push</code> is to modify the array. This is because in JavaScript, strings are immutable.</p><p>Because strings are immutable (cannot be modified) any method which attempts to change the string will fail. That immediately rules out methods like <code>push</code>, <code>pop</code>, <code>shift</code>, and <code>splice</code>.</p><p> However, other methods which treat the string as read-only are fair game. Consider these:</p><div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">var</span> <span class="nx">ontologist</span> <span class="o">=</span> <span class="s2">"Anselm"</span><span class="p">;</span><span class="kd">var</span> <span class="nx"> hasSomeA</span> <span class="o">=</span> <span class="p">[].</span><span class="nx">some</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx"> ontologist</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">val</span><span class="p">)</span> <span class="p">{</span>    <span class="k">return</span> <span class="nx">val</span> <span class="o">===</span> <span class="s2">"A"</span><span class="p">;</span><span class="p">});</span><span class="c1">// Outputs: true</span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">hasSomeA</span><span class="p">);</span><span class= "kd">var</span> <span class="nx">everyCharIsE</span> <span class="o">=</span> <span class="p">[].</span><span class="nx">every</span><span class="p">.</span><span class="nx">call </span><span class="p">(</span><span class="nx">ontologist</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">val</span><span class="p" >)</span> <span class="p">{</span>    <span class="k">return</span> <span class="nx">val</span> <span class="o">===</span> <span class="s2">"E"</span><span class="p">;</span><span class= "p">});</span><span class="c1">// Outputs: false</span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx"> everyCharIsE</span><span class="p">);</span><span class="kd">var</span> <span class="nx">beforeM</span> <span class="o">=</span> <span class="p">[].</span><span class="nx">filter </span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">ontologist</span><span class="p">,</span> <span class="kd">function</span><span class= "p">(</span><span class="nx">val</span><span class="p">)</span> <span class="p">{</span>    <span class="k">return</span> <span class="nx">val</span> <span class="o">&lt;</span> <span class="s2">"m"</span><span class="p">;</span><span class="p">});</span><span class="c1">// Outputs: ["A", "e", "l"]</span><span class="nx">console</span><span class="p">.</span><span class ="nx">log</span><span class="p">(</span><span class="nx">beforeM</span><span class="p">);</span></code></pre></div><p>It's great that all of these methods can operate on strings, but you may have noticed that <code>filter</code> returns an array rather than a string. If you think about it, this makes sense. Using <code>call</code> or <code>apply</code> doesn't change the function's logic, just what value it operates on.</p><p>Any array method which returns an array will continue to do so even if called on a string value. If you need your final result to be a string again, then you will need to convert it back to a string with <code>join</code>, like so:</p><div class="highlight"><pre><code class="language-javascript" data-lang= "javascript"><span class="kd">var</span> <span class="nx">beforeM</span> <span class="o">=</span> <span class="p">[].</span><span class="nx">filter</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">ontologist</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">val </span><span class="p">)</span> <span class="p">{</span>    <span class="k">return</span> <span class="nx">val</span> <span class="o">&lt;</span> <span class="s2">"m"</span><span class="p" >;</span><span class="p">}).</span><span class="nx">join</span><span class="p">(</span><span class="s2">""</span><span class="p">);</span><span class="c1">// Outputs: "Ael"</span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">beforeM</span><span class="p">);</span></code></pre></div><p>Above, I mentioned that many array methods will fail to operate on strings because they are immutable. But there is a fairly simple way around this. We can first convert the string into an array and then convert it back again.</p><p>For example:</p><div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">var</span> <span class="nx"> reversed</span><span class="p">;</span><span class="nx">reversed</span> <span class="o">=</span> <span class="p">[].</span><span class="nx">reverse</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">ontologist</span><span class="p">);</span><span class="c1">// Outputs: "Anselm"</span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">reversed</span><span class="p">);</span><span class="nx">reversed</span> <span class="o">=</span> <span class="p">[].</span><span class="nx">slice</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">ontologist</span><span class="p">). </span><span class="nx">reverse</span><span class="p">().</span><span class="nx">join</span><span class="p">(</span><span class="s2">""</span><span class="p">);</span><span class="c1">// Outputs: "mlesnA"</span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">reversed</span><span class="p">); </span></code></pre></div><p>Our first attempt at reversing the string fails because the <code>reverse</code> method attempts to mutate the value it is called upon. But in our second attempt we first use the <code>slice</code> method to convert the string into an array, and only then attempt to reverse it, using join to convert it into a new string after the mutatation. This basic approach means that you can use the entire range of array methods to manipulate strings.</p><p>As you can see, using array methods on strings can be a little quirky at times, but can also be very powerful. Hopefully this brief introduction has helped you see some places where it can help you in your day to day work.</p><p>Thanks for reading!</p><p> Josh Clanton</p>    </div>			</div>		<!--=========================			END : POST		=============================-->		<!--========================= START : POST		=============================-->		<div class="post-wrapper"><div class="post">        <h1 class="post-title">JavaScript's void Operator</h1>            <p><i> Originally published in the                <a href="/">A Drip of JavaScript newsletter</a>.            </i></p>        <p>If you've been doing web development for any length of time, you've probably seen links that look something like this:</p><div class="highlight"><pre><code class="language-html" data-lang="html"><span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"javascript:void 0;"</span> <span class="na">onclick=</span><span class="s">"doSomething()"</span><span class="nt">&gt;</span>Do something<span class ="nt">&lt;/a&gt;</span></code></pre></div><p>While this is a rather terrible line of HTML, there is something interesting going on in it: namely, the <code>void 0</code> that is executed when a user clicks the link. What exactly does <code>void 0</code> do? Lets ask our trusty console.</p><div class="highlight"><pre><code class="language-javascript" data-lang="javascript" ><span class="c1">// Outputs: undefined</span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="k">void</span> <span class="mi">0</span><span class="p">);</span></code></pre></div><p>That's interesting. If <code>void 0</code> is equivalent to <code>undefined</code>, what about using <code>void</code> with other values?</p><div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="c1">// Outputs: undefined</span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="k">void</span> <span class="s2">"test"</span><span class="p">);</span><span class="c1">// Outputs: undefined</span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="k">void</span> <span class="p">{}); </span></code></pre></div><p>It turns out that <code>void</code>'s one and only purpose is to make an expression evaluate to <code>undefined</code>. While this isn't useful in most situations, it can come in handy occasionally.</p><p>As we've talked about <a href="http://designpepper.com/blog/drips/redefining-undefined">before</a>, <code>undefined</code> isn't a JavaScript keyword, but a property of the global object. That means that <code>undefined</code> can be "shadowed" within a function's scope. Here is an example:</p><div class="highlight" ><pre><code class="language-javascript" data-lang="javascript"><span class="kd">function</span> <span class="nx">shadowLog</span> <span class="p">()</span> <span class="p">{</span> <span class="kd">var</span> <span class="kc">undefined</span> <span class="o">=</span> <span class="s2">"shadowed"</span><span class="p">;</span>    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="kc">undefined</span><span class="p">);</span><span class="p">}</span><span class="c1">// Outputs: "shadowed"</span><span class="nx">shadowLog</span><span class="p">();</span></code></pre></div><p>Under ordinary circumstances one can expect the <code>undefined</code> variable to refer to the <code>undefined</code> primitive. However, if you are dealing with variable shadowing or <a href="http://designpepper.com/blog/drips/redefining-undefined">redefining undefined</a>, then it can be helpful to use <code>void</code> as a guarantee that you are working with the <code>undefined</code> primitive, like so:</p><div class="highlight"><pre><code class= "language-javascript" data-lang="javascript"><span class="p">(</span><span class="kd">function</span> <span class="nx">shadowFunc</span> <span class="p">()</span> <span class="p">{</span> <span class="kd">var</span> <span class="kc">undefined</span> <span class="o">=</span> <span class="s2">"shadowed"</span><span class="p">;</span>    <span class="kd">var</span> <span class="nx">undefinedVar</span><span class="p">;</span>    <span class="c1">// Outputs: false</span>    <span class="nx">console</span><span class="p">.</span><span class="nx">log </span><span class="p">(</span><span class="kc">undefined</span> <span class="o">===</span> <span class="k">void</span> <span class="mi">0</span><span class="p">);</span>    <span class= "c1">// Outputs: false</span>    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">undefinedVar</span> <span class= "o">===</span> <span class="kc">undefined</span><span class="p">);</span>    <span class="c1">// Outputs: true</span>    <span class="nx">console</span><span class="p">.</span><span class= "nx">log</span><span class="p">(</span><span class="nx">undefinedVar</span> <span class="o">===</span> <span class="k">void</span> <span class="mi">0</span><span class="p">);</span><span class="p">})();</span></code></pre></div><p>When using <code>void</code>, it is conventional to use <code>0</code> as the operand. Using <code>void 0</code> here allows us to easily check whether a variable is <code>undefined</code>, even though the name <code>undefined</code> was shadowed in the function's scope.</p><p>That's it for this week. Thanks for reading!</p><p> Josh Clanton</p>    </div>			</div>		<!--=========================			END : POST		=============================-->		<!--========================= START : POST		=============================-->		<div class="post-wrapper"><div class="post">        <h1 class="post-title">Creating Unwritable Properties with Object.defineProperty</h1>            <p><i>                Originally published in the                <a href="/">A Drip of JavaScript newsletter</a>.            </i></p>        <p> JavaScript has a reputation as a language where the developer can redefine just about anything. While that has been largely true in past versions of JavaScript, with ECMAScript 5 the situation has begun to change. For instance, thanks to <code>Object.defineProperty</code> it is now possible to create object properties that cannot be modified.</p><p>Why would you want to do that? Imagine that you are building a mathematics library.</p><div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">var</span> <span class="nx">principia</span> <span class="o">=</span> <span class="p">{</span>    <span class="nx">constants</span><span class="o">:</span> <span class="p">{</span>        <span class="c1"> // Pi is used here for convenience of illustration.</span>        <span class="c1">// For real applications, you'd want to use Math.PI</span>        <span class="nx">pi</span><span class= "o">:</span> <span class="mf">3.14</span>    <span class="p">},</span>    <span class="nx">areaOfCircle</span><span class="o">:</span> <span class="kd">function</span> <span class="p">( </span><span class="nx">radius</span><span class="p">)</span> <span class="p">{</span>        <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class= "nx">constants</span><span class="p">.</span><span class="nx">pi</span> <span class="o">*</span> <span class="nx">radius</span> <span class="o">*</span> <span class="nx">radius</span><span class="p">;</span>    <span class="p">}</span><span class="p">};</span></code></pre></div><p>Your library provides a collection of common equations, but for convenience also defines a set of mathematical constants. Of course, the thing about constants is that they should remain constant and shouldn't be redefined. But suppose a user of your library accidentally does something like this:</p><div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="c1">// Accidental assignment</span><span class="k">if</span> <span class="p">(</span><span class="nx">principia</span><span class="p">.</span><span class="nx">constants</span><span class="p">.</span><span class="nx">pi</span> <span class="o">=</span> <span class="nx">myval</span><span class="p">)</span> <span class="p">{</span>    <span class="c1">// do something</span><span class="p">}</span></code></pre></div><p>The user has accidentally assigned a value to <code>pi</code>. Suddenly every equation in your library that depends on <code>pi</code> will return incorrect results. This will likely lead the user to believe your library is defective rather than discovering the error in their code. While there are multiple ways to avoid this issue, the simplest solution is just to make <code>pi</code> unwritable. Let's take a look at how to do that.</p><div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">var</span> <span class="nx"> principia</span> <span class="o">=</span> <span class="p">{</span>    <span class="nx">constants</span><span class="o">:</span> <span class="p">{},</span>    <span class="nx">areaOfCircle </span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">radius</span><span class="p">)</span> <span class="p">{</span>        <span class= "k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">constants</span><span class="p">.</span><span class="nx">pi</span> <span class="o">*</span> <span class="nx">radius</span> <span class="o">*</span> <span class="nx">radius</span><span class="p">;</span>    <span class="p">}</span><span class="p">};</span><span class="nb">Object </span><span class="p">.</span><span class="nx">defineProperty</span><span class="p">(</span><span class="nx">principia</span><span class="p">.</span><span class="nx">constants</span><span class="p">,</span> <span class="s2">"pi"</span><span class="p">,</span> <span class="p">{</span>    <span class="nx">value</span><span class="o">:</span> <span class="mf">3.14</span><span class="p">,</span>    <span class="nx">writable</span><span class="o">:</span> <span class="kc">false</span><span class="p">});</span></code></pre></div><p>The <code>defineProperty</code> method takes three arguments: the object whose property you are creating or modifying, the name of the property, and an options object. The options object itself allows us to set several options, but for the moment we are only interested in <code>value</code> and <code>writable</code>.</p><p>The <code>value</code> option defines what the actual value of our property will be, while <code>writable</code> specifies whether we can assign a new value to it. So let's see how it works.</p><div class="highlight"><pre><code class="language-javascript" data-lang= "javascript"><span class="c1">// Try to assign a new value to pi</span><span class="nx">principia</span><span class="p">.</span><span class="nx">constants</span><span class="p">. </span><span class="nx">pi</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span><span class="c1">// Outputs: 3.14</span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">principia</span><span class="p">.</span><span class="nx">constants</span><span class="p">.</span><span class="nx">pi</span><span class="p">);</span></code></pre></div><p>As you can see, attempting to assign a new value to <code>pi</code> fails silently and <code>pi</code> retains its original value. So now a mistake by a careless library user won't cause problems with the library itself.</p><p>And if the user of your library is in strict mode, it gets better.</p><div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="c1">// Turn on strict mode</span><span class="s2">"use strict"</span><span class="p">; </span><span class="c1">// TypeError: Cannot assign to read only property 'pi' of principia.constants</span><span class="nx">principia</span><span class="p">.</span><span class="nx"> constants</span><span class="p">.</span><span class="nx">pi</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span></code></pre></div><p>Strict mode will throw an error if you attempt to assign a new value to unwritable properties, which means that errors like the one illustrated above would get flagged immediately.</p><p>There are two more aspects of <code>defineProperty</code> that you'll need to understand to use it effectively.</p><p>While in our example above, we explicity set <code>writable</code>, it turns out that <code>writable</code> defaults to false, so our earlier example can be rewritten like so.</p><div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="nb">Object</span><span class="p">.</span><span class="nx">defineProperty</span><span class="p">(</span><span class="nx">principia</span><span class="p">.</span><span class="nx"> constants</span><span class="p">,</span> <span class="s2">"pi"</span><span class="p">,</span> <span class="p">{</span>    <span class="nx">value</span><span class="o">:</span> <span class= "mf">3.14</span><span class="p">});</span></code></pre></div><p>In addition there is another option called <code>configurable</code> which specifies whether you can use <code> defineProperty</code> and similar methods to reconfigure things like <code>writable</code> to a different state. The <code>configurable</code> option defaults to <code>false</code>, so if you want to let users of your library override <code>pi</code> intentionally, but not through accidental assignment, you would need to explicitly set it to <code>true</code>, like so: </p><div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="nb">Object</span><span class="p">.</span><span class="nx">defineProperty</span><span class="p">(</span><span class="nx">principia</span><span class="p">.</span><span class="nx">constants</span><span class="p">,</span> <span class="s2">"pi"</span><span class="p">,</span> <span class="p">{</span>    <span class="nx">value</span><span class="o">:</span> <span class="mf">3.14</span><span class="p">,</span>    <span class="nx">configurable</span><span class= "o">:</span> <span class="kc">true</span><span class="p">});</span></code></pre></div><p>There is one rather large "gotcha" to be aware of when using <code>defineProperty</code>. While setting <code>writable</code> prevents assignment to the property, it does not make the property's value immutable. Consider the case of an array:</p><div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">var</span> <span class="nx">container</span> <span class="o">=</span> <span class="p">{};</span><span class="nb">Object </span><span class="p">.</span><span class="nx">defineProperty</span><span class="p">(</span><span class="nx">container</span><span class="p">,</span> <span class="s2">"arr"</span><span class="p">,</span> <span class="p">{</span>    <span class="nx">writable</span><span class="o">:</span> <span class="kc">false</span><span class="p">,</span>    <span class="nx">value </span><span class="o">:</span> <span class="p">[</span><span class="s2">"a"</span><span class="p">,</span> <span class="s2">"b"</span><span class="p">]</span><span class="p">}); </span><span class="nx">container</span><span class="p">.</span><span class="nx">arr</span> <span class="o">=</span> <span class="p">[</span><span class="s2">"new array"</span><span class= "p">];</span><span class="c1">// Outputs: ["a", "b"]</span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx"> container</span><span class="p">.</span><span class="nx">arr</span><span class="p">);</span><span class="nx">container</span><span class="p">.</span><span class="nx">arr</span><span class= "p">.</span><span class="nx">push</span><span class="p">(</span><span class="s2">"new value"</span><span class="p">);</span><span class="c1">// Outputs: ["a", "b", "new value"]</span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">container</span><span class="p">.</span><span class="nx">arr </span><span class="p">);</span></code></pre></div><p>The <code>arr</code> property is unwritable, so it will always point to the same array. But the array itself may be changed. Unless you use a value that is intrinsically immutable (like a string primitive), the property's value is still subject to change. We'll consider a way of locking down arrays and other objects in a future issue.</p><p>Unfortunately, because <code>Object.defineProperty</code> is part of ES5, it is only fully supported in IE9 and newer. IE8 has a partial implementation which only works on DOM objects, and would be useless for the examples considered above. Even more unfortunately, there is no compatibility shim for IE8. However, if you don't need to deal with older browsers, <code>defineProperty</code> might be just what you are looking for.</p><p>Thanks for reading!</p><p>Joshua Clanton</p>    </div>			</div> <!--=========================			END : POST		=============================-->		<!--=========================			START : POST =============================-->		<div class="post-wrapper"><div class="post">        <h1 class="post-title">Equals Equals Null in JavaScript</h1>            <p><i> Originally published in the                <a href="/">A Drip of JavaScript newsletter</a>.            </i></p>        <p>One of the strongest injunctions that new JavaScript developers receive is to always use strict equality (<code>===</code>) in comparisons. Douglas Crockford recommends this approach in <a href=" http://www.amazon.com/gp/product/0596517742/ref=as_li_ss_tl?ie=UTF8&amp;camp=1789&amp;creative=390957&amp;creativeASIN=0596517742&amp;linkCode=as2&amp;tag=joshuacc-20">JavaScript: The Good Parts</a>, and it is considered by some parts of the JavaScript community to be a best practice.</p><p>But even in code that follows this practice, you're likely to run across one exception: <code>== null</code>. Or possibly <code>!= null</code>. Here is an example from <a href=" https://github.com/jquery/jquery/blob/410cf4ee6bd454fa7e2bb5dc37a0b051f15d3e96/src/attributes.js#L203">jQuery's source</a>.</p><div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="k">if</span> <span class="p">(</span> <span class="nx">val</span> <span class="o">==</span> <span class="kc">null</span> <span class="p">)</span> <span class="p">{</span>    <span class="nx">val</span> <span class="o">=</span> <span class="s2">""</span><span class="p">;</span><span class="p">}</span></code></pre></div><p>What does this code do? And why is it a common exception to the triple equals rule? Let's take a look at an example where it might be useful.</p><div class="highlight"><pre><code class= "language-javascript" data-lang="javascript"><span class="kd">var</span> <span class="nx">ethos</span> <span class="o">=</span> <span class="p">{</span>    <span class="nx">achilles </span><span class="o">:</span> <span class="s2">"glory"</span><span class="p">,</span>    <span class="nx">aeneas</span><span class="o">:</span> <span class="s2">"duty"</span><span class= "p">,</span>    <span class="nx">hades</span><span class="o">:</span> <span class="kc">null</span> <span class="c1">// Beyond human understanding</span><span class="p">};</span><span class ="kd">function</span> <span class="nx">printEthos</span> <span class="p">(</span><span class="nx">name</span><span class="p">)</span> <span class="p">{</span>    <span class="nx">console </span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">ethos</span><span class="p">[</span><span class="nx">name</span><span class="p">]); </span><span class="p">}</span><span class="c1">// Outputs: "glory"</span><span class="nx">printEthos</span><span class="p">(</span><span class="s2">"achilles"</span><span class="p">); </span><span class="c1">// Outputs: "null"</span><span class="nx">printEthos</span><span class="p">(</span><span class="s2">"hades"</span><span class="p">);</span><span class="c1">// Outputs: "undefined"</span><span class="nx">printEthos</span><span class="p">(</span><span class="s2">"thor"</span><span class="p">);</span></code></pre></div><p>The <code>printEthos </code> function will be called in response to a user inputting a name. And while this works fine for <code>"achilles"</code> and <code>"aeneas"</code>, it doesn't really work for <code> "hades"</code> or <code>"thor"</code>. The problem here is that they give us two different types of nothing, and neither of them means anything to the end user. It would be much better to capture any "nothings" and display a user-friendly message. So let's do that.</p><div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd"> function</span> <span class="nx">printEthos</span> <span class="p">(</span><span class="nx">name</span><span class="p">)</span> <span class="p">{</span>    <span class="k">if</span> <span class="p">(</span><span class="nx">ethos</span><span class="p">[</span><span class="nx">name</span><span class="p">])</span> <span class="p">{</span>        <span class="nx">console </span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">ethos</span><span class="p">[</span><span class="nx">name</span><span class="p">]); </span>    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">name</span> <span class="o">+</span> <span class="s2">" has no recorded ethos."</span><span class="p">);</span>    <span class="p">}</span><span class= "p">}</span><span class="c1">// Outputs: "hades has no recorded ethos."</span><span class="nx">printEthos</span><span class="p">(</span><span class="s2">"hades"</span><span class="p">); </span><span class="c1">// Outputs: "thor has no recorded ethos."</span><span class="nx">printEthos</span><span class="p">(</span><span class="s2">"thor"</span><span class="p">); </span></code></pre></div><p>We've solved our problem. Or have we? By testing the truthiness of <code>ethos[name]</code>, we've opened ourselves up to a different sort of issue. Consider what happens in the case of Pythagoras.</p><div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="nx">ethos</span><span class="p">.</span><span class="nx">pythagoras</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="c1">// The sublimity of Number</span><span class="c1">// Outputs: "pythagoras has no recorded ethos"</span><span class="nx">printEthos</span><span class="p">(</span><span class="s2">"pythagoras"</span><span class="p">);</span></code></pre></div><p> Because <code>0</code> is a falsy value, <code>"pythagoras"</code> isn't recognized as having an ethos. So we need something that won't accidentally catch falsy values when we really just want to catch nothingness as opposed to somethingness. And that's what <code>== null</code> does.</p><div class="highlight"><pre><code class="language-javascript" data-lang="javascript" ><span class="kd">function</span> <span class="nx">printEthos</span> <span class="p">(</span><span class="nx">name</span><span class="p">)</span> <span class="p">{</span>    <span class= "k">if</span> <span class="p">(</span><span class="nx">ethos</span><span class="p">[</span><span class="nx">name</span><span class="p">]</span> <span class="o">!=</span> <span class="kc"> null</span><span class="p">)</span> <span class="p">{</span>        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class= "nx">ethos</span><span class="p">[</span><span class="nx">name</span><span class="p">]);</span>    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">name</span> <span class="o">+</span> <span class="s2">" has no recorded ethos."</span><span class="p">);</span>    <span class="p">}</span><span class="p">}</span><span class="c1">// Outputs: "hades has no recorded ethos."</span><span class="nx"> printEthos</span><span class="p">(</span><span class="s2">"hades"</span><span class="p">);</span><span class="c1">// Outputs: "thor has no recorded ethos."</span><span class="nx"> printEthos</span><span class="p">(</span><span class="s2">"thor"</span><span class="p">);</span><span class="c1">// Outputs: 0</span><span class="nx">printEthos</span><span class="p">( </span><span class="s2">"pythagoras"</span><span class="p">);</span></code></pre></div><p>Despite the fact that <code>null</code> is a falsy value (i.e. it evaluates to <code>false</code> if coerced to a boolean), it isn't considered loosely equal to any of the other falsy values in JavaScript. In fact, the only values that <code>null</code> is loosely equal to are <code> undefined</code> and itself.</p><p>Because of this interesting property, it has become somewhat conventional to use <code>== null</code> as a more concise way of checking whether a given value is "nothing" (<code>null</code>/<code>undefined</code>) or "something" (anything else). In addition to <a href=" https://github.com/jquery/jquery/blob/410cf4ee6bd454fa7e2bb5dc37a0b051f15d3e96/src/attributes.js#L203">jQuery</a>, you can find examples of this convention in <a href=" https://github.com/jashkenas/underscore/blob/71099af43d735444ff033fefe5264d0b0988eeef/underscore.js#L77">Underscore</a>.and <a href=" https://github.com/less/less.js/blob/49888fe6063d01e98011802ca926b54cdb7576b9/dist/less-1.4.2.js#L2422">Less</a>. Indeed, JSHint, one of the more popular JavaScript linting tools, provides <a href="http://www.jshint.com/docs/options/#eqnull">an option</a> to allow the use of loose equality only when comparing to null.</p><p>Of course, you can choose to be more explicit about the fact that you are checking for both <code>null</code> and <code>undefined</code>, but next time you run across <code>== null</code>, don't automatically think, "Bad practice!" Instead, take a look at the context and see if it is being used strategically.</p><p>Thanks for reading!</p><p>Josh Clanton</p>    </div>			</div> <!--=========================			END : POST		=============================-->		<!--=========================			START : POST =============================-->		<div class="post-wrapper"><div class="post">        <h1 class="post-title">Filtering Arrays with Array#filter</h1>            <p><i> Originally published in the                <a href="/">A Drip of JavaScript newsletter</a>.            </i></p>        <p>Working with arrays is a daily task for most developers. And one of the most common tasks is taking an array and filtering it down to a subset of the elements it contains.</p><p>A straightforward way of doing the filtering manually might look like this: </p><div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">var</span> <span class="nx">sidekicks</span> <span class="o">=</span> <span class= "p">[</span>    <span class="p">{</span> <span class="nx">name</span><span class="o">:</span> <span class="s2">"Robin"</span><span class="p">,</span>     <span class="nx">hero</span><span class="o">:</span> <span class="s2">"Batman"</span>   <span class="p">},</span>    <span class="p">{</span> <span class="nx">name</span><span class="o">:</span> <span class="s2"> "Supergirl"</span><span class="p">,</span> <span class="nx">hero</span><span class="o">:</span> <span class="s2">"Superman"</span> <span class="p">},</span>    <span class="p">{</span> <span class="nx">name</span><span class="o">:</span> <span class="s2">"Oracle"</span><span class="p">,</span>    <span class="nx">hero</span><span class="o">:</span> <span class="s2"> "Batman"</span>   <span class="p">},</span>    <span class="p">{</span> <span class="nx">name</span><span class="o">:</span> <span class="s2">"Krypto"</span><span class="p">,</span> <span class="nx">hero</span><span class="o">:</span> <span class="s2">"Superman"</span> <span class="p">}</span><span class="p">];</span><span class="kd">var</span> <span class="nx"> batKicks</span> <span class="o">=</span> <span class="p">[];</span><span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o"> =</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">sidekicks</span><span class="p">.</span><span class="nx"> length</span> <span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>    <span class="k">if</span> <span class="p">( </span><span class="nx">sidekicks</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">hero</span> <span class="o">===</span> <span class="s2"> "Batman"</span><span class="p">)</span> <span class="p">{</span>        <span class="nx">batKicks</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">sidekicks</span><span class="p">[</span><span class="nx">i</span><span class="p">]);</span>    <span class="p">}</span><span class="p">}</span><span class="c1">// Outputs: [ </span><span class="c1">//    { name: "Robin",  hero: "Batman"   },</span><span class="c1">//    { name: "Oracle", hero: "Batman"   }</span><span class="c1">// ]</span><span class="nx"> console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">batKicks</span><span class="p">);</span></code></pre></div><p>Fortunately, in JavaScript, arrays have the handy <code>filter</code> method which we can use to do the filtering for us instead of manually looping through the array ourselves.</p><div class="highlight" ><pre><code class="language-javascript" data-lang="javascript"><span class="kd">var</span> <span class="nx">sidekicks</span> <span class="o">=</span> <span class="p">[</span>    <span class="p">{</span> <span class="nx">name</span><span class="o">:</span> <span class="s2">"Robin"</span><span class="p">,</span>     <span class="nx">hero</span><span class="o">:</span> <span class="s2">"Batman"</span>   <span class="p">},</span>    <span class="p">{</span> <span class="nx">name</span><span class="o">:</span> <span class="s2">"Supergirl"</span><span class ="p">,</span> <span class="nx">hero</span><span class="o">:</span> <span class="s2">"Superman"</span> <span class="p">},</span>    <span class="p">{</span> <span class="nx">name </span><span class="o">:</span> <span class="s2">"Oracle"</span><span class="p">,</span>    <span class="nx">hero</span><span class="o">:</span> <span class="s2">"Batman"</span>   <span class="p">},</span>    <span class="p">{</span> <span class="nx">name</span><span class="o">:</span> <span class="s2">"Krypto"</span><span class="p">,</span>    <span class="nx">hero </span><span class="o">:</span> <span class="s2">"Superman"</span> <span class="p">}</span><span class="p">];</span><span class="kd">var</span> <span class="nx">batKicks</span> <span class ="o">=</span> <span class="nx">sidekicks</span><span class="p">.</span><span class="nx">filter</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">el</span><span class="p">)</span> <span class="p">{</span>    <span class="k">return</span> <span class="p">(</span><span class="nx">el</span><span class="p">.</span><span class ="nx">hero</span> <span class="o">===</span> <span class="s2">"Batman"</span><span class="p">);</span><span class="p">});</span><span class="c1">// Outputs: [</span><span class="c1">// { name: "Robin",  hero: "Batman"   },</span><span class="c1">//    { name: "Oracle", hero: "Batman"   }</span><span class="c1">// ]</span><span class="nx">console</span><span class="p">. </span><span class="nx">log</span><span class="p">(</span><span class="nx">batKicks</span><span class="p">);</span><span class="kd">var</span> <span class="nx">superKicks</span> <span class="o">=</span> <span class="nx">sidekicks</span><span class="p">.</span><span class="nx">filter</span><span class="p">(</span><span class="kd">function</span> <span class="p">( </span><span class="nx">el</span><span class="p">)</span> <span class="p">{</span>    <span class="k">return</span> <span class="p">(</span><span class="nx">el</span><span class="p">. </span><span class="nx">hero</span> <span class="o">===</span> <span class="s2">"Superman"</span><span class="p">);</span><span class="p">});</span><span class="c1">// Outputs: [ </span><span class="c1">//    { name: "Supergirl", hero: "Superman" },</span><span class="c1">//    { name: "Krypto",    hero: "Superman" }</span><span class="c1">// ]</span><span class= "nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">superKicks</span><span class="p">);</span></code></pre></div><p>The filter method accepts a callback function. In that callback function we examine each element of the array indidually, and return <code>true</code> if we want the element to pass the filter. </p><p>In addition to the individual array element, the callback also has access to the index of the current element and the full array, like so:</p><div class="highlight"><pre><code class ="language-javascript" data-lang="javascript"><span class="kd">var</span> <span class="nx">filtered</span> <span class="o">=</span> <span class="nx">sidekicks</span><span class="p">. </span><span class="nx">filter</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">el</span><span class="p">,</span> <span class="nx"> index</span><span class="p">,</span> <span class="nx">arr</span><span class="p">)</span> <span class="p">{</span>    <span class="c1">// Filtering here</span><span class="p">}); </span></code></pre></div><p>This allows you to create more complex filters that depend on the element's relationship with other elements, or the array as a whole.</p><p>Because the filter method returns an array, it can be chained together with other array methods like <code>sort</code> and <code>map</code> (see issues <a href=" http://designpepper.com/blog/drips/reordering-arrays-with-array-sort">#3</a> and <a href="http://designpepper.com/blog/drips/transforming-arrays-with-array-map">#6</a>.) For example: </p><div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">var</span> <span class="nx">sortedBatKickNames</span> <span class="o">=</span> <span class="nx">sidekicks</span><span class="p">.</span><span class="nx">filter</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">el </span><span class="p">)</span> <span class="p">{</span>    <span class="k">return</span> <span class="p">(</span><span class="nx">el</span><span class="p">.</span><span class="nx">hero </span> <span class="o">===</span> <span class="s2">"Batman"</span><span class="p">);</span><span class="p">}).</span><span class="nx">map</span><span class="p">(</span><span class="kd"> function</span><span class="p">(</span><span class="nx">el</span><span class="p">)</span> <span class="p">{</span>    <span class="k">return</span> <span class="nx">el</span><span class= "p">.</span><span class="nx">name</span><span class="p">;</span><span class="p">}).</span><span class="nx">sort</span><span class="p">();</span><span class="c1">// Outputs: ["Oracle", "Robin"];</span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">sortedBatKickNames</span><span class="p">); </span></code></pre></div><p>Because the <code>filter</code> method is part of the ECMAScript 5 specification, it isn't available in older browsers like IE8. If you need to use it in older browsers, then you will need to use a <a href="https://github.com/kriskowal/es5-shim">compatibility shim</a> or the equivalent filter method in a library like <a href=" http://underscorejs.org/#filter">Underscore</a> or <a href="http://lodash.com/docs#filter">Lo-Dash</a>.</p><p>Hopefully this has given you some idea of how you can use <code>filter</code> in your everyday work.</p><p>Thanks for reading!</p><p>Josh Clanton</p>    </div>			</div>		<!--=========================			END : POST =============================-->		<!--=========================			START : POST		=============================-->		<div class="post-wrapper"><div class="post"> <h1 class="post-title">Partial Application with Function#bind</h1>            <p><i>                Originally published in the                <a href="/">A Drip of JavaScript newsletter</a>.            </i></p>        <p>In <a href="/blog/drips/partial-application-with-function-bind.html">last week's drip</a>, we covered using <code>bind</code> to create bound functions. But <code>bind</code> is also a very convenient way of implementing partial application. First, let's take a look at exactly what partial application is.</p><p>According to <a href="https://en.wikipedia.org/wiki/Partial_application">Wikipedia</a>, partial application "refers to the process of fixing a number of arguments to a function, producing another function of smaller arity." Arity refers to the number of arguments that a function takes.</p><p>Here's an example:</p><div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">function</span> <span class="nx">multiply</span> <span class="p">(</span><span class="nx">x</span><span class="p">,</span> <span class="nx">y </span><span class="p">)</span> <span class="p">{</span>    <span class="k">return</span> <span class="nx">x</span> <span class="o">*</span> <span class="nx">y</span><span class="p">; </span><span class="p">}</span><span class="kd">function</span> <span class="kr">double</span> <span class="p">(</span><span class="nx">num</span><span class="p">)</span> <span class="p">{ </span>    <span class="k">return</span> <span class="nx">multiply</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="nx">num</span><span class= "p">);</span><span class="p">}</span></code></pre></div><p>That's a very rudimentary form of partial application, where inside <code>double</code> we permanently fix <code>multiply</code> 's first argument as <code>2</code>, producing a new function <code>double</code>.</p><p>But explicitly declaring the body of the new function isn't actually necessary if you use <code> bind</code>. Here's how we could rewrite that:</p><div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">function</span> <span class="nx"> multiply</span> <span class="p">(</span><span class="nx">x</span><span class="p">,</span> <span class="nx">y</span><span class="p">)</span> <span class="p">{</span>    <span class="k"> return</span> <span class="nx">x</span> <span class="o">*</span> <span class="nx">y</span><span class="p">;</span><span class="p">}</span><span class="kd">var</span> <span class="kr"> double</span> <span class="o">=</span> <span class="nx">multiply</span><span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="kc">null</span><span class= "p">,</span> <span class="mi">2</span><span class="p">);</span></code></pre></div><p>As we covered last time, the first argument to <code>bind</code> sets it's internal <code>this</code> value. Since our function doesn't depend on <code>this</code>, we just pass in <code>null</code>. But any subsequent arguments that we supply will be used to permanently fix the arguments of the function we are binding. In this case, we are only fixing one argument, but we can potentially fix as many as we want.</p><div class="highlight"><pre><code class= "language-javascript" data-lang="javascript"><span class="kd">function</span> <span class="nx">greet</span> <span class="p">(</span><span class="nx">salutation</span><span class="p">, </span> <span class="nx">person</span><span class="p">,</span> <span class="nx">delivery</span><span class="p">)</span> <span class="p">{</span>    <span class="kd">var</span> <span class= "nx">message</span> <span class="o">=</span> <span class="s1">'"'</span><span class="o">+</span> <span class="nx">salutation</span> <span class="o">+</span> <span class="s1">', '</span> <span class="o">+</span> <span class="nx">person</span> <span class="o">+</span> <span class="s1">'," '</span> <span class="o">+</span>                  <span class="nx">delivery</span> <span class="o">+</span> <span class="s1">' the greeter.'</span><span class="p">;</span>    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class= "p">(</span><span class="nx">message</span><span class="p">);</span><span class="p">}</span><span class="kd">var</span> <span class="nx">hail</span> <span class="o">=</span> <span class= "nx">greet</span><span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="kc">null</span><span class="p">,</span> <span class="s2">"Hail"</span><span class= "p">);</span><span class="c1">// Outputs: '"Hail, Lord Elrond," said the greeter.'</span><span class="nx">hail</span><span class="p">(</span><span class="s2">"Lord Elrond"</span><span class="p">,</span> <span class="s2">"said"</span><span class="p">);</span><span class="kd">var</span> <span class="nx">begone</span> <span class="o">=</span> <span class="nx">greet </span><span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="kc">null</span><span class="p">,</span> <span class="s2">"Begone"</span><span class="p">, </span> <span class="s2">"Wormtongue"</span><span class="p">,</span> <span class="s2">"commanded"</span><span class="p">);</span><span class="c1">// Outputs: '"Begone, Wormtongue," commanded the greeter.'</span><span class="nx">begone</span><span class="p">();</span></code></pre></div><p>One thing you may have noticed is that <code>bind</code> always fixes the arguments from left to right. This means that it isn't suitable for all forms of partial application, but it does cover the most common ones.</p><p>You may be wondering if partial application is actually all that useful in real code. To answer, let's revisit an example from our <a href=" http://designpepper.com/blog/drips/using-dispatch-tables-to-avoid-conditionals-in-javascript">discussion of dispatch tables</a>:</p><div class="highlight"><pre><code class= "language-javascript" data-lang="javascript"><span class="kd">var</span> <span class="nx">commandTable</span> <span class="o">=</span> <span class="p">{</span>    <span class="nx">north </span><span class="o">:</span>    <span class="kd">function</span><span class="p">()</span> <span class="p">{</span> <span class="nx">movePlayer</span><span class="p">(</span><span class= "s2">"north"</span><span class="p">);</span> <span class="p">},</span>    <span class="nx">east</span><span class="o">:</span>     <span class="kd">function</span><span class="p">()</span> <span class="p">{</span> <span class="nx">movePlayer</span><span class="p">(</span><span class="s2">"east"</span><span class="p">);</span>  <span class="p">},</span>    <span class="nx"> south</span><span class="o">:</span>    <span class="kd">function</span><span class="p">()</span> <span class="p">{</span> <span class="nx">movePlayer</span><span class="p">(</span><span class="s2">"south"</span><span class="p">);</span> <span class="p">},</span>    <span class="nx">west</span><span class="o">:</span>     <span class="kd">function</span><span class="p">() </span> <span class="p">{</span> <span class="nx">movePlayer</span><span class="p">(</span><span class="s2">"west"</span><span class="p">);</span>  <span class="p">},</span>    <span class ="nx">look</span><span class="o">:</span>     <span class="nx">describeLocation</span><span class="p">,</span>    <span class="nx">backpack</span><span class="o">:</span> <span class="nx"> showBackpack</span><span class="p">};</span><span class="kd">function</span> <span class="nx">processUserInput</span><span class="p">(</span><span class="nx">command</span><span class="p"> )</span> <span class="p">{</span>    <span class="nx">commandTable</span><span class="p">[</span><span class="nx">command</span><span class="p">]();</span><span class="p">} </span></code></pre></div><p>In this example we are taking user input from a text adventure game, and then calling the appropriate command from <code>commandTable</code>. As you can see, we're using the same rudimentary form of partial application that we saw in our first example.</p><p>Using <code>bind</code> we can clean this up a bit.</p><div class="highlight" ><pre><code class="language-javascript" data-lang="javascript"><span class="kd">var</span> <span class="nx">commandTable</span> <span class="o">=</span> <span class="p">{</span>    <span class="nx">north</span><span class="o">:</span>    <span class="nx">movePlayer</span><span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="kc">null </span><span class="p">,</span> <span class="s2">"north"</span><span class="p">),</span>    <span class="nx">east</span><span class="o">:</span>     <span class="nx">movePlayer</span><span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="kc">null</span><span class="p">,</span> <span class="s2">"east"</span><span class="p">),</span>    <span class="nx">south</span><span class="o">:</span>    <span class="nx">movePlayer</span><span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="kc">null </span><span class="p">,</span> <span class="s2">"south"</span><span class="p">),</span>    <span class="nx">west</span><span class="o">:</span>     <span class="nx">movePlayer</span><span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="kc">null</span><span class="p">,</span> <span class="s2">"west"</span><span class="p">),</span>    <span class="nx">look</span><span class="o">:</span>     <span class="nx">describeLocation</span><span class="p">,</span>    <span class="nx">backpack</span><span class="o">:</span> <span class ="nx">showBackpack</span><span class="p">};</span><span class="kd">function</span> <span class="nx">processUserInput</span><span class="p">(</span><span class="nx">command</span><span class="p">)</span> <span class="p">{</span>    <span class="nx">commandTable</span><span class="p">[</span><span class="nx">command</span><span class="p">]();</span><span class="p">} </span></code></pre></div><p>As I mentioned last time, <code>bind</code> isn't available in IE8 and older, so you may want to use a polyfill or library to achieve the same functionality. If you only want to implement partial application and don't need to create bound functions, you might want to consider the <code>partial</code> methods in <a href=" http://underscorejs.org/#partial">Underscore</a> and <a href="http://lodash.com/docs#partial">Lo-Dash</a>.</p><p>Thanks for reading!</p><p>Josh Clanton</p>    </div>			</div> <!--=========================			END : POST		=============================-->		<!--=========================			START : POST =============================-->		<div class="post-wrapper"><div class="post">        <h1 class="post-title">Creating Bound Functions with Function#bind</h1>            <p><i> Originally published in the                <a href="/">A Drip of JavaScript newsletter</a>.            </i></p>        <p>Continuing from some of our previous discussions of functions as first-class values, it's time to tackle <code>Function</code>'s <code>bind</code> method. As you might guess, the purpose of <code>bind</code> is to "bind" a function. But what does that mean, exactly?</p><div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">var</span> <span class="nx">hero</span> <span class= "o">=</span> <span class="p">{</span>    <span class="nx">name</span><span class="o">:</span> <span class="s2">"Batman"</span><span class="p">,</span>    <span class="nx">signal </span><span class="o">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">name</span> <span class="o">+</span> <span class="s2">" has been signaled." </span><span class="p">);</span>    <span class="p">}</span><span class="p">};</span><span class="c1">// Outputs: "Batman has been signaled."</span><span class="nx">hero</span><span class= "p">.</span><span class="nx">signal</span><span class="p">();</span></code></pre></div><p>Consider if we wanted to let another object signal Batman. We could do something like this: </p><div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">var</span> <span class="nx">commissioner</span> <span class="o">=</span> <span class="p">{</span>    <span class="nx">name</span><span class="o">:</span> <span class="s2">"Jim Gordon"</span><span class="p">,</span>    <span class="nx">signalBatman</span><span class= "o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>        <span class="nx">hero</span><span class="p">.</span><span class="nx">signal </span><span class="p">();</span>    <span class="p">}</span><span class="p">};</span><span class="c1">// Outputs: "Batman has been signaled."</span><span class="nx">commissioner </span><span class="p">.</span><span class="nx">signalBatman</span><span class="p">();</span></code></pre></div><p>But what if the <code>hero</code> variable gets redefined?</p><div class= "highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="nx">hero</span> <span class="o">=</span> <span class="p">{</span>    <span class="nx">name </span><span class="o">:</span> <span class="s2">"Superman"</span><span class="p">,</span>    <span class="nx">signal</span><span class="o">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="k">this </span><span class="p">.</span><span class="nx">name</span> <span class="o">+</span> <span class="s2">" has been signaled."</span><span class="p">);</span>    <span class="p">}</span><span class="p">};</span><span class="c1">// Outputs: "Superman has been signaled."</span><span class="nx">commissioner</span><span class="p">.</span><span class="nx">signalBatman</span><span class="p">();</span></code></pre></div><p>Commissioner Gordon is signaling Superman? That can't be right. Let's try using <code>bind</code> instead.</p><div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">var</span> <span class="nx">hero</span> <span class="o">=</span> <span class="p">{</span>    <span class="nx">name </span><span class="o">:</span> <span class="s2">"Batman"</span><span class="p">,</span>    <span class="nx">signal</span><span class="o">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="k">this </span><span class="p">.</span><span class="nx">name</span> <span class="o">+</span> <span class="s2">" has been signaled."</span><span class="p">);</span>    <span class="p">}</span><span class="p">};</span><span class="kd">var</span> <span class="nx">commissioner</span> <span class="o">=</span> <span class="p">{</span>    <span class="nx">name</span><span class="o">: </span> <span class="s2">"Jim Gordon"</span><span class="p">,</span>    <span class="nx">signalBatman</span><span class="o">:</span> <span class="nx">hero</span><span class="p">. </span><span class="nx">signal</span><span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="nx">hero</span><span class="p">)</span><span class="p">}; </span><span class="nx">hero</span> <span class="o">=</span> <span class="p">{</span>    <span class="nx">name</span><span class="o">:</span> <span class="s2">"Superman"</span><span class= "p">,</span>    <span class="nx">signal</span><span class="o">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>        <span class="nx">console </span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">name</span> <span class="o">+</span> <span class="s2">" has been signaled."</span><span class="p">);</span>    <span class="p">}</span><span class="p">};</span><span class="c1">// Outputs: "Batman has been signaled." </span><span class="nx">commissioner</span><span class="p">.</span><span class="nx">signalBatman</span><span class="p">();</span></code></pre></div><p>As you can see, the <code>bind</code> method allows us to create a new function which is permanently bound to a given value of <code>this</code>. You can't even override its <code>this</code> value using <code>call</code> or <code>apply</code>. This can be quite handy when you need to pass around a function that needs a certain <code>this</code> value in order to function correctly.</p><p>For instance, consider good old <code>console.log</code>:</p><div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="c1">// Outputs: "logging"</span><span class ="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">"console.logging"</span><span class="p">);</span><span class="kd">var</span> <span class="nx">justLog</span> <span class="o">=</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">;</span><span class="c1">// TypeError: Illegal invocation</span><span class="nx">justLog</span><span class="p">(</span><span class="s2">"just logging"</span><span class="p">);</span></code></pre></div><p>It turns out that <code>log</code> just won't work without <code>console</code>. But is there a way we can just pass around the function instead of the entire console object? With <code>bind</code> there is.</p><div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="c1">// Outputs: "logging"</span><span class="nx">console</span><span class= "p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">"console.logging"</span><span class="p">);</span><span class="kd">var</span> <span class="nx">justLog</span> <span class="o">=</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">.</span><span class="nx">bind</span><span class="p">( </span><span class="nx">console</span><span class="p">);</span><span class="c1">// Outputs: "just logging"</span><span class="nx">justLog</span><span class="p">(</span><span class="s2"> "just logging"</span><span class="p">);</span></code></pre></div><p>Unfortunately, <code>bind</code> is only supported in Internet Explore 9 or higher. If you need this functionality in older browsers, you can use <a href="http://underscorejs.org/#bind">Underscore</a>, <a href="http://lodash.com/docs#bind">Lo-Dash</a>, or the <a href="https://github.com/kriskowal/es5-shim ">ES5 shim</a> library.</p><p>That's a brief introduction to creating bound functions with <code>bind</code>. Next time we'll look at using <code>bind</code> for partial application. </p><p>Thanks for reading!</p><p>Joshua Clanton</p>    </div>			</div>		<!--=========================			END : POST		=============================--> <!--=========================			START : POST		=============================-->		<div class="post-wrapper"><div class="post">        <h1 class="post-title">Variable and Function Hoisting in JavaScript</h1>            <p><i>                Originally published in the                <a href="/">A Drip of JavaScript newsletter</a>.            </i></p> <p>One of the trickier aspects of JavaScript for new JavaScript developers is the fact that variables and functions are "hoisted." Rather than being available after their declaration, they might actually be available beforehand. How does that work? Let's take a look at variable hoisting first.</p><div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="c1">// ReferenceError: noSuchVariable is not defined</span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">noSuchVariable</span><span class="p">);</span></code></pre></div><p>This is more or less what one would expect. An error is thrown when you try to access the value of a variable that doesn't exist. But what about this case?</p><div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="c1">// Outputs: undefined</span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">declaredLater</span><span class="p">); </span><span class="kd">var</span> <span class="nx">declaredLater</span> <span class="o">=</span> <span class="s2">"Now it's defined!"</span><span class="p">;</span><span class="c1">// Outputs: "Now it's defined!"</span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">declaredLater</span><span class="p">);</span></code></pre></div><p>What is going on here? It turns out that JavaScript treats variables which will be declared later on in a function differently than variables that are not declared at all. Basically, the JavaScript interpreter "looks ahead" to find all the variable declarations and "hoists" them to the top of the function. Which means that the example above is equivalent to this:</p><div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">var</span> <span class="nx">declaredLater </span><span class="p">;</span><span class="c1">// Outputs: undefined</span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">declaredLater</span><span class="p">);</span><span class="nx">declaredLater</span> <span class="o">=</span> <span class="s2">"Now it's defined!"</span><span class="p">; </span><span class="c1">// Outputs: "Now it's defined!"</span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx"> declaredLater</span><span class="p">);</span></code></pre></div><p>One case where this is particularly likely to bite new JavaScript developers is when reusing variable names between an inner and outer scope. For example:</p><div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">var</span> <span class="nx">name</span> <span class="o">=</span> <span class="s2">"Baggins"</span><span class="p">;</span><span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span> <span class="c1">// Outputs: "Original name was undefined"</span>    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class= "s2">"Original name was "</span> <span class="o">+</span> <span class="nx">name</span><span class="p">);</span>    <span class="kd">var</span> <span class="nx">name</span> <span class="o"> =</span> <span class="s2">"Underhill"</span><span class="p">;</span>    <span class="c1">// Outputs: "New name is Underhill"</span>    <span class="nx">console</span><span class="p">. </span><span class="nx">log</span><span class="p">(</span><span class="s2">"New name is "</span> <span class="o">+</span> <span class="nx">name</span><span class="p">);</span><span class= "p">})();</span></code></pre></div><p>In cases like this, the developer probably expected <code>name</code> to retain its value from the outer scope until the point that <code>name</code> was declared in the inner scope. But due to hoisting, <code>name</code> is <code>undefined</code> instead.</p><p>Because of this behavior JavaScript linters and style guides often recommend putting all variable declarations at the top of the function so that you won't be caught by surprise.</p><p>So that covers variable hoisting, but what about function hoisting? Despite both being called "hoisting," the behavior is actually quite different. Unlike variables, a function declaration doesn't just hoist the function's name. It also hoists the actual function definition.</p><div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="c1">// Outputs: "Yes!"</span><span class="nx">isItHoisted </span><span class="p">();</span><span class="kd">function</span> <span class="nx">isItHoisted</span><span class="p">()</span> <span class="p">{</span>    <span class="nx">console </span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">"Yes!"</span><span class="p">);</span><span class="p">}</span></code></pre></div><p>As you can see, the JavaScript interpreter allows you to use the function before the point at which it was declared in the source code. This is useful because it allows you to express your high-level logic at the beginning of your source code rather than the end, communicating your intentions more clearly.</p><div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="nx">travelToMountDoom</span><span class="p">();</span><span class="nx">destroyTheRing</span><span class="p">();</span><span class="kd">function</span> <span class="nx">travelToMountDoom</span><span class="p">()</span> <span class="p">{</span> <span class="cm">/* Traveling */</span> <span class="p">}</span><span class="kd">function</span> <span class="nx">destroyTheRing</span><span class="p">()</span> <span class="p">{</span> <span class="cm">/* Destruction */</span> <span class="p">}</span></code></pre></div><p>However, <strong>function definition hoisting only occurs for function declarations</strong>, not function expressions. For example:</p><div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="c1">// Outputs: "Definition hoisted!"</span><span class="nx">definitionHoisted</span><span class="p">();</span><span class="c1">// TypeError: undefined is not a function</span><span class="nx">definitionNotHoisted</span><span class="p">();</span><span class="kd">function</span> <span class="nx">definitionHoisted</span><span class="p">()</span> <span class="p">{</span>    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">"Definition hoisted!"</span><span class="p">);</span><span class="p">}</span><span class="kd">var</span> <span class="nx">definitionNotHoisted</span> <span class="o">=</span> <span class="kd">function </span> <span class="p">()</span> <span class="p">{</span>    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2"> "Definition not hoisted!"</span><span class="p">);</span><span class="p">};</span></code></pre></div><p>Here we see the interaction of two different types of hoisting. Our variable <code> definitionNotHoisted</code> has its declaration hoisted (thus it is <code>undefined</code>), but not its function definition (thus the <code>TypeError</code>.)</p><p>You might be wondering what happens if you use a named function expression.</p><div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="c1">// ReferenceError: funcName is not defined</span><span class="nx">funcName</span><span class="p">();</span><span class="c1">// TypeError: undefined is not a function</span><span class="nx">varName </span><span class="p">();</span><span class="kd">var</span> <span class="nx">varName</span> <span class="o">=</span> <span class="kd">function</span> <span class="nx">funcName</span><span class="p">()</span> <span class="p">{</span>    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">"Definition not hoisted!"</span><span class="p">);</span><span class="p">};</span></code></pre></div><p>As you can see, the function's name doesn't get hoisted if it is part of a function expression. </p><p>And that is how variable and function hoisting works in JavaScript.</p><p>Thanks for reading!</p><p>Joshua Clanton</p>    </div>			</div> <!--=========================			END : POST		=============================-->		<!--=========================			START : POST =============================-->		<div class="post-wrapper"><div class="post">        <h1 class="post-title">An Introduction to IIFEs - Immediately Invoked Function Expressions</h1> <p><i>                Originally published in the                <a href="/">A Drip of JavaScript newsletter</a>.            </i></p>        <p>It doesn't take very long working with JavaScript before you come across this pattern:</p><div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="p">(</span><span class= "kd">function</span> <span class="p">()</span> <span class="p">{</span>    <span class="c1">// logic here</span><span class="p">})();</span></code></pre></div><p>Your first encounter is likely to be quite confusing. But fortunately the concept itself is simple. The pattern is called an immediately invoked function expression, or IIFE (pronounced "iffy").</p><p>In JavaScript functions can be created either through a function declaration or a function expression. A function declaration is the "normal" way of creating a named function.</p><div class= "highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="c1">// Named function declaration</span><span class="kd">function</span> <span class="nx">myFunction </span> <span class="p">()</span> <span class="p">{</span> <span class="cm">/* logic here */</span> <span class="p">}</span></code></pre></div><p>On the other hand, if you are assigning a function to a variable or property, you are dealing with a function expression.</p><div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="c1">// Assignment of a function expression to a variable</span><span class="kd">var</span> <span class="nx">myFunction</span> <span class="o">=</span> <span class="kd">function</span> <span class ="p">()</span> <span class="p">{</span> <span class="cm">/* logic here */</span> <span class="p">};</span><span class="c1">// Assignment of a function expression to a property</span><span class="kd">var</span> <span class="nx">myObj</span> <span class="o">=</span> <span class="p">{</span>    <span class="nx">myFunction</span><span class="o">:</span> <span class="kd"> function</span> <span class="p">()</span> <span class="p">{</span> <span class="cm">/* logic here */</span> <span class="p">}</span><span class="p">};</span></code></pre></div><p>A function created in the context of an expression is also a function expression. For example:</p><div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="c1">// Anything within the parentheses is part of an expression</span><span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span> <span class="cm">/* logic here */</span> <span class="p">});</span><span class="c1">// Anything after the not operator is part of an expression</span><span class="o">!</span><span class= "kd">function</span> <span class="p">()</span> <span class="p">{</span> <span class="cm">/* logic here */</span> <span class="p">};</span></code></pre></div><p>The key thing about JavaScript expressions is that they return values. In both cases above the return value of the expression is the function.</p><p>That means that if we want to invoke the function expression right away we just need to tackle a couple of parentheses on the end. Which brings us back to the first bit of code we looked at.</p><div class="highlight"><pre><code class= "language-javascript" data-lang="javascript"><span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>    <span class="c1">// logic here </span><span class="p">})();</span></code></pre></div><p>Now we know what the code is doing, but the question "Why?" still remains.</p><p>The primary reason to use an IIFE is to obtain data privacy. Because JavaScript's <code>var</code> scopes variables to their containing function, any variables declared within the IIFE cannot be accessed by the outside world.</p><div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span> <span class="kd">var</span> <span class="nx">foo</span> <span class="o">=</span> <span class="s2">"bar"</span><span class="p">;</span>    <span class="c1">// Outputs: "bar"</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">foo</span><span class="p">);</span><span class="p">})(); </span><span class="c1">// ReferenceError: foo is not defined</span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class= "nx">foo</span><span class="p">);</span></code></pre></div><p>Of course, you could explicitly name and then invoke a function to achieve the same ends.</p><div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">function</span> <span class="nx">myImmediateFunction</span> <span class="p">()</span> <span class="p">{</span>    <span class="kd">var</span> <span class="nx">foo</span> <span class="o">=</span> <span class="s2">"bar"</span><span class="p">;</span>    <span class="c1">// Outputs: "bar"</span>    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">foo</span><span class="p">);</span><span class="p">}</span><span class= "nx">myImmediateFunction</span><span class="p">();</span><span class="c1">// ReferenceError: foo is not defined</span><span class="nx">console</span><span class="p">.</span><span class= "nx">log</span><span class="p">(</span><span class="nx">foo</span><span class="p">);</span></code></pre></div><p>However, this approach has a few downsides. First, it unnecessarily takes up a name in the global namespace, increasing the possibility of name collisions. Second, the intentions of this code aren't as self-documenting as an IIFE. And third, because it is named and isn't self-documenting it might accidentally be invoked more than once.</p><p>It is worth pointing out that you can easily pass arguments into the IIFE as well.</p><div class= "highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">var</span> <span class="nx">foo</span> <span class="o">=</span> <span class="s2">"foo" </span><span class="p">;</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">innerFoo</span><span class="p">)</span> <span class="p">{ </span>    <span class="c1">// Outputs: "foo"</span>    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">innerFoo </span><span class="p">);</span><span class="p">})(</span><span class="nx">foo</span><span class="p">);</span></code></pre></div><p>And that's the story behind IIFEs. Soon we'll be building on this by taking a look at the module pattern in JavaScript.</p><p>Thanks for reading!</p><p>Joshua Clanton</p>    </div>			</div> <!--=========================			END : POST		=============================-->		<!--=========================			START : POST =============================-->		<div class="post-wrapper"><div class="post">        <h1 class="post-title">The Uses of 'in' vs 'hasOwnProperty'</h1>            <p><i> Originally published in the                <a href="/">A Drip of JavaScript newsletter</a>.            </i></p>        <p>Last issue I briefly mentioned JavaScript's <code> in</code> operator, but didn't go into much detail about its use. That's the subject we'll be tackling first today.</p><p>The <code>in</code> operator will tell you whether an object (or array) has a property name which matches a given string.</p><div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">var</span> <span class= "nx">fantasyLit</span> <span class="o">=</span> <span class="p">{</span>    <span class="nx">tolkien</span><span class="o">:</span> <span class="s2">"The Lord of the Rings"</span><span class="p">,</span>    <span class="nx">lewis</span><span class="o">:</span> <span class="s2">"The Chronicles of Narnia"</span><span class="p">};</span><span class="c1">// Outputs: true </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">"tolkien"</span> <span class="k">in</span> <span class= "nx">fantasyLit</span><span class="p">);</span><span class="c1">// Outputs: false</span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">( </span><span class="s2">"asimov"</span> <span class="k">in</span> <span class="nx">fantasyLit</span><span class="p">);</span></code></pre></div><p>Looks simple enough, right? But consider this:</p><div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="c1">// Outputs: true</span><span class="nx">console</span><span class="p">. </span><span class="nx">log</span><span class="p">(</span><span class="s2">"constructor"</span> <span class="k">in</span> <span class="nx">fantasyLit</span><span class="p">); </span></code></pre></div><p>What's going on here? It turns out that the <code>in</code> operator doesn't distinguish between properties created specifically on an object and properties that the object inherited from the prototype chain. In this case <code>in</code> is seeing the <code>constructor</code> property of <code>Object.prototype</code> which all objects inherit from.</p><p>It will also return <code>true</code> for user-defined prototype properties. For instance:</p><div class="highlight"><pre><code class="language-javascript" data-lang= "javascript"><span class="kd">function</span> <span class="nx">litList</span> <span class="p">()</span> <span class="p">{}</span><span class="nx">litList</span><span class="p">. </span><span class="nx">prototype</span><span class="p">.</span><span class="nx">addToList</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">author</span><span class="p">,</span> <span class="nx">work</span><span class="p">)</span> <span class="p">{</span>    <span class="k">this</span><span class="p">[</span><span class="nx">author</span><span class="p">]</span> <span class="o">=</span> <span class="nx">work</span><span class="p">;</span><span class="p">};</span><span class="kd">var</span> <span class="nx">fantasyLit</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">litList</span><span class="p">();</span><span class="nx">fantasyLit</span><span class="p"> .</span><span class="nx">addToList</span><span class="p">(</span><span class="s2">"tolkien"</span><span class="p">,</span> <span class="s2">"The Lord of the Rings"</span><span class="p">); </span><span class="c1">// Outputs: true</span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">"tolkien"</span> <span class="k">in</span> <span class="nx">fantasyLit</span><span class="p">);</span><span class="c1">// Outputs: false</span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">"asimov"</span> <span class="k">in</span> <span class="nx">fantasyLit</span><span class="p">);</span><span class="c1">// Outputs: true</span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">"addToList"</span> <span class="k">in</span> <span class="nx">fantasyLit</span><span class="p">);</span></code></pre></div><p>Because of this, using <code>in</code> to detect whether an object possesses a given property can be a bit deceptive. Usually we only want to check for properties that belong to the object itself, not its prototype chain. Fortunately, JavaScript has a solution for that. It is called <code> hasOwnProperty</code>.</p><p>It is a method on <code>Object.prototype</code>, which means it is available to all JavaScript objects.</p><p>Here is how you use it:</p><div class="highlight" ><pre><code class="language-javascript" data-lang="javascript"><span class="kd">function</span> <span class="nx">litList</span> <span class="p">()</span> <span class="p">{}</span><span class="nx">litList</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">addToList</span> <span class="o">=</span> <span class="kd"> function</span> <span class="p">(</span><span class="nx">author</span><span class="p">,</span> <span class="nx">work</span><span class="p">)</span> <span class="p">{</span>    <span class= "k">this</span><span class="p">[</span><span class="nx">author</span><span class="p">]</span> <span class="o">=</span> <span class="nx">work</span><span class="p">;</span><span class="p"> };</span><span class="kd">var</span> <span class="nx">fantasyLit</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">litList</span><span class="p">();</span><span class="nx">fantasyLit</span><span class="p">.</span><span class="nx">addToList</span><span class="p">(</span><span class="s2">"tolkien"</span><span class="p">,</span> <span class="s2"> "The Lord of the Rings"</span><span class="p">);</span><span class="c1">// Outputs: true</span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class ="p">(</span><span class="nx">fantasyLit</span><span class="p">.</span><span class="nx">hasOwnProperty</span><span class="p">(</span><span class="s2">"tolkien"</span><span class="p">)); </span><span class="c1">// Outputs: false</span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">fantasyLit </span><span class="p">.</span><span class="nx">hasOwnProperty</span><span class="p">(</span><span class="s2">"asimov"</span><span class="p">));</span><span class="c1">// Outputs: false </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">fantasyLit</span><span class="p">.</span><span class="nx"> hasOwnProperty</span><span class="p">(</span><span class="s2">"addToList"</span><span class="p">));</span></code></pre></div><p>Because in JavaScript arrays also inherit from <code>Object </code>, they can use <code>hasOwnProperty</code> as well, though it is often less useful.</p><div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">var</span> <span class="nx">summerMovies</span> <span class="o">=</span> <span class="p">[</span>    <span class="s2">"Iron Man 3"</span><span class="p">,</span>    <span class= "s2">"Star Trek: Into Darkness"</span><span class="p">,</span>    <span class="s2">"Man of Steel"</span><span class="p">];</span><span class="c1">// Outputs: true</span><span class="nx"> summerMovies</span><span class="p">.</span><span class="nx">hasOwnProperty</span><span class="p">(</span><span class="s2">"2"</span><span class="p">);</span></code></pre></div><p>It's important to keep in mind the limits of both <code>in</code> and <code>hasOwnProperty</code>. While they can tell you that a given property has been declared, they can't tell you whether the property has a "real value".</p><p>Consider these examples:</p><div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="c1">// Puts a "declared" property on the global object</span><span class="c1">// (window in browsers)</span><span class="kd">var</span> <span class="nx">declared</span><span class="p">;</span><span class="c1">// Outputs: true</span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">"declared"</span> <span class= "k">in</span> <span class="nb">window</span><span class="p">);</span><span class="c1">// Outputs: true</span><span class="nx">console</span><span class="p">.</span><span class="nx">log </span><span class="p">(</span><span class="nb">window</span><span class="p">.</span><span class="nx">hasOwnProperty</span><span class="p">(</span><span class="s2">"declared"</span><span class="p">));</span><span class="c1">// Outputs: undefined</span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx"> declared</span><span class="p">);</span><span class="kd">var</span> <span class="nx">obj</span> <span class="o">=</span> <span class="p">{</span> <span class="nx">myUndefined</span><span class="o">:</span> <span class="kc">undefined</span> <span class="p">};</span><span class="c1">// Outputs: true</span><span class="nx">console</span><span class="p">.</span><span class= "nx">log</span><span class="p">(</span><span class="s2">"myUndefined"</span> <span class="k">in</span> <span class="nx">obj</span><span class="p">);</span><span class="c1">// Outputs: true </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">obj</span><span class="p">.</span><span class="nx"> hasOwnProperty</span><span class="p">(</span><span class="s2">"myUndefined"</span><span class="p">));</span><span class="c1">// Outputs: undefined</span><span class="nx">console </span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">obj</span><span class="p">.</span><span class="nx">myUndefined</span><span class="p">); </span></code></pre></div><p>Another limit that you may encounter is that the <code>hasOwnProperty</code> method can be rendered useless if an object happens to define a property named <code>hasOwnProperty</code>. For instance:</p><div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">var</span> <span class="nx">voldemort </span> <span class="o">=</span> <span class="p">{</span>    <span class="nx">hasOwnProperty</span><span class="o">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span> <span class="k">return</span> <span class="kc">true</span><span class="p">;</span> <span class="p">}</span><span class="p">};</span><span class="c1">// Outputs: true </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">voldemort</span><span class="p">.</span><span class="nx"> hasOwnProperty</span><span class="p">(</span><span class="s2">"ridikulus"</span><span class="p">));</span></code></pre></div><p>Because <code>voldemort</code> defines its own <code> hasOwnProperty</code>, the call never makes it to <code>Object.prototype.hasOwnProperty</code>. It's unlikely that you'll run into an object as maliciously constructed as <code>voldemort </code>, but it's good to be aware of the possibility. Here is the workaround:</p><div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="c1">// Returns false</span><span class="nb">Object</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">hasOwnProperty</span><span class="p">. </span><span class="nx">call</span><span class="p">(</span><span class="nx">voldemort</span><span class="p">,</span> <span class="s2">"ridikulus"</span><span class="p">); </span></code></pre></div><p>Finally, depending on the JavaScript engine, you may have trouble detecting the special <code>__proto__</code> property with either of these methods.</p><p> That's a brief introduction to the use of <code>in</code> and <code>hasOwnProperty</code>.</p><p>As always, thanks for reading!</p><p>Joshua Clanton</p>    </div>			</div> <!--=========================			END : POST		=============================-->		<!--=========================			START : POST =============================-->		<div class="post-wrapper"><div class="post">        <h1 class="post-title">An Introduction to Writing Your Own JavaScript Compatibility Shims</h1> <p><i>                Originally published in the                <a href="/">A Drip of JavaScript newsletter</a>.            </i></p>        <p>We've talked in several past issues about the need to use compatibility shims to get newer features of JavaScript ported back into older browsers. Today we're going to talk about how those shims work and how you can write your own.</p><p>We are going to create a shim for the <a href="http://designpepper.com/blog/drips/transforming-arrays-with-array-map">previously discussed Array#map</a>, which is not available in IE8 and below. To recap, the <code>map</code> method returns a new array which is created by running a transformation function over each element of the original array, like so:</p><div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">var</span> <span class="nx">evens</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">8 </span><span class="p">,</span> <span class="mi">10</span><span class="p">];</span><span class="kd">var</span> <span class="nx">odds</span> <span class="o">=</span> <span class="nx">evens </span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">val</span><span class="p">) </span> <span class="p">{</span> <span class="k">return</span> <span class="nx">val</span> <span class="o">-</span> <span class="mi">1</span><span class="p">;</span> <span class="p">}); </span><span class="c1">// Outputs: [1, 3, 5, 7, 9]</span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">odds </span><span class="p">);</span></code></pre></div><p>Perhaps the most important part of writing a compatibility shim is using feature detection to ensure that we don't accidentally overwrite the <code>map</code> method in a modern browser.</p><div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="c1">// Only use the shim if map isn't defined</span><span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">Array</span><span class="p">.</span><span class="nx">prototype </span><span class="p">.</span><span class="nx">map</span><span class="p">)</span> <span class="p">{</span>    <span class="c1">// Create and attach shim here</span><span class="p">} </span></code></pre></div><p>Once we know that we are in a <code>map</code>less browser, we can actually create the shim itself.</p><div class="highlight"><pre><code class= "language-javascript" data-lang="javascript"><span class="c1">// Only use the shim if map isn't defined</span><span class="k">if</span> <span class="p">(</span><span class="o">! </span><span class="nb">Array</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">map</span><span class="p">)</span> <span class="p">{ </span>    <span class="c1">// Map will accept a single function as an argument</span>    <span class="nb">Array</span><span class="p">.</span><span class="nx">prototype</span><span class= "p">.</span><span class="nx">map</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">fn</span><span class="p">)</span> <span class="p"> {</span>        <span class="kd">var</span> <span class="nx">i</span><span class="p">,</span>            <span class="nx">newVal</span><span class="p">,</span>            <span class="nx"> mappedArr</span> <span class="o">=</span> <span class="p">[];</span>        <span class="k">for</span> <span class="p">(</span><span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="k">this</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>            <span class="c1">// Run the callback function over each element</span>            <span class="c1">// to get the updated value</span>            <span class="nx">newVal</span> <span class="o">=</span> <span class="nx">fn</span><span class="p">( </span><span class="k">this</span><span class="p">[</span><span class="nx">i</span><span class="p">]);</span>            <span class="c1">// Push the new value onto the new array</span> <span class="nx">mappedArr</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">newVal</span><span class="p">);</span> <span class="p">}</span>        <span class="c1">// Return our new array</span>        <span class="k">return</span> <span class="nx">mappedArr</span><span class="p">;</span>    <span class="p">};</span><span class="p">}</span></code></pre></div><p>Now if you load that code up in IE8 and below, you should have a functional (if incomplete) <code>map</code> method where it was completely missing before.</p><p>Of course, it's worth pointing out that this particular implementation of <code>map</code> isn't production-worthy. For one thing, it doesn't take into account the fact that <code>map</code> will pass in the index and array as arguments to the callback function. It also fails to account for the fact that <code>map</code> itself will accept a second argument to set its <code>this</code> value. For details, see our <a href="http://designpepper.com/blog/drips/transforming-arrays-with-array-map">previous discussion of map </a>, as well as the <a href="https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Array/map">detailed documentation on MDN</a>.</p><p>And that leads me to the second most important part of writing a compatibility shim. You need to make sure that you get the functionality right. A lot of the time it is really simple to code for the most common use cases, but much more difficult to ensure that you've covered all of the uncommon ones. If you'd like to see how much of a difference that makes, take a look at <a href=" https://github.com/kriskowal/es5-shim/blob/master/es5-shim.js#L349">ES5-shim's implementation of map</a>. It is significantly more complex.</p><p>Because of this complexity, it is generally best to rely on an established library with lots of unit tests to do the heavy lifting for you. However, if your goal is to learn about a new feature of JavaScript, building your own implementation will teach you more of the ins and outs than anything else.</p><p>Thanks for reading!</p><p>Josh Clanton</p>    </div>			</div> <!--=========================			END : POST		=============================-->		<!--=========================			START : POST =============================-->		<div class="post-wrapper"><div class="post">        <h1 class="post-title">The Difference Between Boolean Objects and Boolean Primitives in JavaScript</h1>            <p><i>                Originally published in the                <a href="/">A Drip of JavaScript newsletter</a>.            </i></p>        <p>One of the unintuitive things about JavaScript is the fact that there are constructors for each of the primitive value types (boolean, string, etc), but what they construct isn't actually the same thing as the primitive.</p><p>Take booleans, for example. In most code, the primitive values are used, like so:</p><div class="highlight"><pre><code class="language-javascript" data-lang= "javascript"><span class="kd">var</span> <span class="nx">primitiveTrue</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span><span class="kd">var</span> <span class="nx">primitiveFalse</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span></code></pre></div><p>There is also the <code>Boolean</code> function, which can be used as an ordinary function which returns a boolean primitive:</p><div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">var </span> <span class="nx">functionTrue</span> <span class="o">=</span> <span class="nb">Boolean</span><span class="p">(</span><span class="kc">true</span><span class="p">);</span><span class="kd">var</span> <span class="nx">functionFalse</span> <span class="o">=</span> <span class="nb">Boolean</span><span class="p">(</span><span class="kc">false</span><span class="p">); </span></code></pre></div><p>But the <code>Boolean</code> function can also be used as a constructor with the <code>new</code> keyword:</p><div class="highlight"><pre><code class= "language-javascript" data-lang="javascript"><span class="kd">var</span> <span class="nx">constructorTrue</span> <span class="o">=</span> <span class="k">new</span> <span class="nb"> Boolean</span><span class="p">(</span><span class="kc">true</span><span class="p">);</span><span class="kd">var</span> <span class="nx">constructorFalse</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Boolean</span><span class="p">(</span><span class="kc">false</span><span class="p">);</span></code></pre></div><p>The tricky thing here is that when <code>Boolean</code> is used as a constructor, it doesn't return a primitive. Instead it returns an object.</p><div class="highlight"><pre><code class="language-javascript" data-lang= "javascript"><span class="c1">// Outputs: true</span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx"> primitiveTrue</span><span class="p">);</span><span class="c1">// Outputs: true</span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">( </span><span class="nx">functionTrue</span><span class="p">);</span><span class="c1">// Outputs: Boolean {}</span><span class="nx">console</span><span class="p">.</span><span class="nx"> log</span><span class="p">(</span><span class="nx">constructorTrue</span><span class="p">);</span></code></pre></div><p>It turns out that using the <code>Boolean</code> constructor can be quite dangerous. Why? Well, JavaScript is pretty aggressive about type coercion. If you try adding a string and a number, the number will be coerced into a string.</p><div class= "highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="c1">// Outputs: "22"</span><span class="nx">console</span><span class="p">.</span><span class="nx"> log</span><span class="p">(</span><span class="s2">"2"</span> <span class="o">+</span> <span class="mi">2</span><span class="p">);</span></code></pre></div><p>Likewise, if you try to use an object in a context that expects a boolean value, the object will be coerced to <code>true</code>.</p><div class="highlight"><pre><code class="language-javascript" data-lang= "javascript"><span class="c1">// Outputs: "Objects coerce to true."</span><span class="k">if</span> <span class="p">({})</span> <span class="p">{</span> <span class="nx">console </span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">"Objects coerce to true."</span><span class="p">);</span> <span class="p">} </span></code></pre></div><p>And since the <code>Boolean</code> object is an object, it will also coerce to <code>true</code>, even if its internal value is <code>false</code>.</p><div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="c1">// Outputs: "My false Boolean object is truthy!"</span><span class="k">if</span> <span class="p">(</span><span class="nx">constructorFalse</span><span class="p">)</span> <span class="p">{</span>    <span class="nx">console</span><span class="p">.</span><span class="nx">log </span><span class="p">(</span><span class="s2">"My false Boolean object is truthy!"</span><span class="p">);</span><span class="p">}</span> <span class="k">else</span> <span class="p">{ </span>    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">"My false Boolean object is falsy!"</span><span class= "p">);</span><span class="p">}</span></code></pre></div><p>If you actually need to get at the internal value of a <code>Boolean</code> object, then you'll need to use the <code>valueOf </code> method.</p><div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="c1">// Outputs: "The value of my false Boolean object is falsy!" </span><span class="k">if</span> <span class="p">(</span><span class="nx">constructorFalse</span><span class="p">.</span><span class="nx">valueOf</span><span class="p">())</span> <span class="p">{</span>    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">"The value of my false Boolean object is truthy!"</span><span class="p">);</span><span class="p">}</span> <span class="k">else</span> <span class="p">{</span>    <span class="nx">console</span><span class="p">.</span><span class= "nx">log</span><span class="p">(</span><span class="s2">"The value of my false Boolean object is falsy!"</span><span class="p">);</span><span class="p">}</span></code></pre></div><p>But because of the quirks surrounding <code>Boolean</code> objects, you're probably best off avoiding them altogether. In fact, linting tools like JSHint and JSLint will flag the <code>Boolean </code> constructor as a potential error in your code.</p><p>In the event that you need to explicitly coerce another type of value into <code>true</code> or <code>false</code>, you're better off using <code>Boolean</code> as an ordinary function, or using the not operator twice.</p><div class="highlight"><pre><code class="language-javascript" data-lang="javascript" ><span class="c1">// Two approaches to coercing 0 into false</span><span class="kd">var</span> <span class="nx">byFunction</span> <span class="o">=</span> <span class="nb">Boolean </span><span class="p">(</span><span class="mi">0</span><span class="p">);</span><span class="kd">var</span> <span class="nx">byNotNot</span> <span class="o">=</span> <span class="o">!! </span><span class="mi">0</span><span class="p">;</span></code></pre></div><p>The double not above is pretty simple, though it can be confusing if you haven't seen it before. Using a single not operator coerces the value into a boolean primitive and then reverses it. (To <code>true</code> in this case). The second use of the not operator reverses the value again, so that it is flipped back to the correct boolean representation of the original value.</p><p>You're reasonably likely to see both of these approaches in JavaScript code, though in my experience the double not is more common.</p><p>Thanks for reading!</p><p>Josh Clanton</p>    </div>			</div>		<!--=========================			END : POST =============================-->		<!--=========================			START : POST		=============================-->		<div class="post-wrapper"><div class="post"> <h1 class="post-title">Function functions</h1>            <p><i>                Originally published in the                <a href="/">A Drip of JavaScript newsletter</a> .            </i></p>        <p>One of the features of JavaScript that sometimes trips up developers used to other languages is the fact that functions are first-class objects. This means that functions can be assigned to a variable and passed around.</p><div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">var</span> <span class="nx">one</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span> <span class="k">return</span> <span class="mi">1 </span><span class="p">;</span> <span class="p">};</span><span class="c1">// Outputs: "function() { return 1; }"</span><span class="nx">console</span><span class="p">.</span><span class= "nx">log</span><span class="p">(</span><span class="nx">one</span><span class="p">);</span><span class="c1">// Outputs: 1</span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">one</span><span class="p">());</span></code></pre></div><p>Why the difference between the results of these two logs? In the first instance, we are logging the value of <code>one</code>. And the value of <code>one</code> is the function itself. In the second case we are logging the value returned by invoking <code>one</code>.</p><p>So far, so good. But there is a further implication. Functions can return objects. And if functions are first-class objects, then that means it is possible for a function to return a function.</p><div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">function</span> <span class="nx">outerFunction </span> <span class="p">()</span> <span class="p">{</span>    <span class="k">return</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span> <span class= "k">return</span> <span class="s2">"inner"</span><span class="p">;</span> <span class="p">};</span><span class="p">}</span><span class="kd">var</span> <span class="nx">whatIsIt</span> <span class="o">=</span> <span class="nx">outerFunction</span><span class="p">();</span><span class="c1">// Outputs: function() { return "inner"; }</span><span class="nx">console </span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">whatIsIt</span><span class="p">);</span><span class="c1">// Outputs: "inner"</span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">whatIsIt</span><span class="p">());</span></code></pre></div><p>This can be a little confusing at first, but is actually pretty simple. When we invoke <code>outerFunction</code>, it will immediately return our anonymous inner function. And we can easily assign that to a variable for later use.</p><p>Okay. But do functions that return functions have any real use? It turns out that they do. You see, functions created inside another function have a handy property. They hold onto or "close over" the variables that their parent defined.</p><div class="highlight"><pre><code class="language-javascript" data-lang= "javascript"><span class="kd">function</span> <span class="nx">counterCreator</span> <span class="p">()</span> <span class="p">{</span>    <span class="kd">var</span> <span class="nx"> count</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>    <span class="k">return</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span> <span class="k">return</span> <span class="o">++</span><span class="nx">count</span><span class="p">;</span> <span class="p">};</span><span class="p">}</span><span class ="kd">var</span> <span class="nx">counter</span> <span class="o">=</span> <span class="nx">counterCreator</span><span class="p">();</span><span class="c1">// Outputs: function() { return ++count; }</span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">counter</span><span class="p">);</span><span class="c1">// Outputs: 1</span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">counter</span><span class="p">()); </span><span class="c1">// Outputs: 2</span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">counter</span><span class="p">());</span><span class="c1">// Outputs: ReferenceError: count is not defined</span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class= "p">(</span><span class="nx">count</span><span class="p">);</span></code></pre></div><p>Interesting! See how our <code>counter</code> function is holding onto the value of <code>count </code> even across multiple invocations? And that's despite the fact that the <code>count</code> variable isn't accessible in our top scope.</p><div class="highlight"><pre><code class= "language-javascript" data-lang="javascript"><span class="kd">function</span> <span class="nx">counterCreator</span> <span class="p">()</span> <span class="p">{</span>    <span class="kd"> var</span> <span class="nx">count</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>    <span class="k">return</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span> <span class="k">return</span> <span class="o">++</span><span class="nx">count</span><span class="p">;</span> <span class="p">};</span><span class="p">}</span><span class="kd">var</span> <span class="nx">originalCounter</span> <span class="o">=</span> <span class="nx">counterCreator</span><span class="p">();</span><span class= "kd">var</span> <span class="nx">anotherCounter</span> <span class="o">=</span> <span class="nx">counterCreator</span><span class="p">();</span><span class="c1">// Outputs: 1</span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">originalCounter</span><span class="p">());</span><span class="c1">// Outputs: 2</span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">originalCounter</span><span class="p">()); </span><span class="c1">// Outputs: 1</span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">anotherCounter </span><span class="p">());</span></code></pre></div><p>Well, look at that. Each new counter function that we create is able to maintain its own private <code>count</code> variable independent of the other counter functions. In fact, this aspect of JavaScript's functions is often used to emulate the sort of private properties found in languages like Java.</p><p> That's a little beyond the scope of this issue, but how else can "function functions" be useful? Here's one example:</p><div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">function</span> <span class="nx">multiply</span> <span class="p">(</span><span class="nx">a</span><span class="p">,</span> <span class="nx">b </span><span class="p">)</span> <span class="p">{</span>    <span class="k">return</span> <span class="nx">a</span> <span class="o">*</span> <span class="nx">b</span><span class="p">; </span><span class="p">}</span><span class="kd">function</span> <span class="nx">timesCreator</span> <span class="p">(</span><span class="nx">a</span><span class="p">)</span> <span class= "p">{</span>    <span class="k">return</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">b</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="nx">multiply</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span> <span class="nx">b</span><span class="p">);</span> <span class="p">}</span><span class="p">}</span><span class="nx">timesTwo</span> <span class="o">=</span> <span class="nx">timesCreator</span><span class="p">(</span><span class="mi">2 </span><span class="p">);</span><span class="nx">timesTwelve</span> <span class="o">=</span> <span class="nx">timesCreator</span><span class="p">(</span><span class="mi">12</span><span class="p">);</span><span class="c1">// Outputs: 4</span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">timesTwo </span><span class="p">(</span><span class="mi">2</span><span class="p">));</span><span class="c1">// Outputs: 24</span><span class="nx">console</span><span class="p">.</span><span class= "nx">log</span><span class="p">(</span><span class="nx">timesTwelve</span><span class="p">(</span><span class="mi">2</span><span class="p">));</span></code></pre></div><p>This particular approach is called <a href="http://en.wikipedia.org/wiki/Partial_application">partial application</a>, which is excellent at helping you ensure that there is one canonical location for your core algorithm. When you need more specific variants, you can just generate them automatically.</p><p>Or, going back to our example with the counters, perhaps you want to create a function that can be invoked many times, but will only execute it's main logic once.</p><div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class= "kd">function</span> <span class="nx">once</span> <span class="p">(</span><span class="nx">fn</span><span class="p">)</span> <span class="p">{</span>    <span class="kd">var</span> <span class="nx">used</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>    <span class="k">return</span> <span class="kd">function</span> <span class="p">( </span><span class="nx">something</span><span class="p">)</span> <span class="p">{</span>        <span class="c1">// End function execution if previously invoked</span>        <span class= "k">if</span> <span class="p">(</span><span class="nx">used</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span><span class="p">;</span> <span class="p">} </span>        <span class="c1">// Invoke the original function</span>        <span class="nx">fn</span><span class="p">(</span><span class="nx">something</span><span class="p">);</span> <span class="c1">// Mark the function as used</span>        <span class="nx">used</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>    <span class="p">}</span><span class="p">}</span><span class="kd">function</span> <span class="nx">logStuff</span> <span class="p">(</span><span class="nx">stuff</span><span class="p">)</span> <span class="p">{</span>    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">stuff</span><span class="p">); </span><span class="p">}</span><span class="nx">logOnce</span> <span class="o">=</span> <span class="nx">once</span><span class="p">(</span><span class="nx">logStuff</span><span class="p"> );</span><span class="c1">// Outputs: "One does not simply"</span><span class="nx">logOnce</span><span class="p">(</span><span class="s2">"One does not simply"</span><span class="p">); </span><span class="c1">// No output!</span><span class="nx">logOnce</span><span class="p">(</span><span class="s2">"use a function twice"</span><span class="p">); </span></code></pre></div><p>Hopefully, this has given you some ideas about how you might use "function functions". We'll be looking more at their practical use in the future. If you're interested in learning more about them, I suggest looking through Underscore's <a href="http://underscorejs.org/#functions">documentation</a> and <a href=" http://underscorejs.org/docs/underscore.html#section-57">source code</a>.</p>    </div>			</div>		<!--=========================			END : POST =============================-->		<!--=========================			START : POST		=============================-->		<div class="post-wrapper"><div class="post"> <h1 class="post-title">Using 'apply' to Emulate JavaScript's Upcoming Spread Operator</h1>            <p><i>                Originally published in the                <a href="/"> A Drip of JavaScript newsletter</a>.            </i></p>        <p>The next version of JavaScript, ECMAScript 6, is planned to introduce a handy <a href=" https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Spread_operator">spread operator</a> which makes using arrays to supply function arguments much simpler. Here's an example of how it will work:</p><div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">var</span> <span class="nx">someArgs</span> <span class="o">= </span> <span class="p">[</span><span class="s2">"a"</span><span class="p">,</span> <span class="s2">"b"</span><span class="p">,</span> <span class="s2">"c"</span><span class="p">]; </span><span class="c1">// Using the spread operator with someArgs</span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(...</span><span class="nx">someArgs</span><span class="p">);</span><span class="c1">// Is equivalent to this</span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">"a"</span><span class="p">,</span> <span class="s2">"b"</span><span class="p">,</span> <span class="s2">"c"</span><span class="p">); </span></code></pre></div><p>Now some of you might be thinking that <code>apply</code> gives us a nice easy way to emulate that, and you'd be right. This is also equivalent to the above: </p><div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">. </span><span class="nx">apply</span><span class="p">(</span><span class="nx">console</span><span class="p">,</span> <span class="nx">someArgs</span><span class="p">); </span></code></pre></div><p>The <code>apply</code> method is part of the prototype of all functions, so any time we have a function, we can invoke it using <code>apply.</code> It takes two arguments, a <code>this</code> parameter which sets the value of <code>this</code> within the function, and a single array which is converted into a list of arguments to the function that <code>apply</code> is called on.</p><p>So if <code>apply</code> gives us the same thing as the spread operator, why is the ES6 committee adding spread at all? Because the spread operator is much more flexible. See for example:</p><div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">var</span> <span class="nx"> someArgs</span> <span class="o">=</span> <span class="p">[</span><span class="s2">"a"</span><span class="p">,</span> <span class="s2">"b"</span><span class="p">,</span> <span class="s2"> "c"</span><span class="p">];</span><span class="kd">var</span> <span class="nx">moreArgs</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">, </span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">];</span><span class="c1">// Using the spread operator twice, with a non-spread argument </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(...</span><span class="nx">someArgs</span><span class="p">,</span> <span class= "s2">"between"</span><span class="p">,</span> <span class="p">...</span><span class="nx">moreArgs</span><span class="p">);</span><span class="c1">// Is equivalent to this</span><span class ="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">"a"</span><span class="p">,</span> <span class="s2">"b"</span><span class= "p">,</span> <span class="s2">"c"</span><span class="p">,</span> <span class="s2">"between"</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class= "mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">);</span></code></pre></div><p>In this case, there isn't a simple one to one mapping between using the spread operator and using <code>apply</code>. But we can still create a pretty decent emulation. Let's take a look at how.</p><div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">function</span> <span class="nx">spreadify</span> <span class="p">(</span><span class="nx">fn</span><span class="p">,</span> <span class="nx">fnThis </span><span class="p">)</span> <span class="p">{</span>    <span class="k">return</span> <span class="kd">function</span> <span class="p">(</span><span class="cm">/* accepts unlimited arguments */</span><span class="p">)</span> <span class="p">{</span>        <span class="c1">// Holds the processed arguments for use by `fn`</span>        <span class="kd">var</span> <span class="nx">spreadArgs</span> <span class="o">=</span> <span class="p">[</span> <span class="p">];</span>        <span class="c1">// Caching length</span>        <span class="kd">var </span> <span class="nx">length</span> <span class="o">=</span> <span class="nx">arguments</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>        <span class="kd">var</span> <span class="nx">currentArg</span><span class="p">;</span>        <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i </span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">length</span><span class="p">; </span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>            <span class="nx">currentArg</span> <span class="o">=</span> <span class="nx">arguments</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>            <span class="k">if</span> <span class="p">(</span><span class="nb">Array </span><span class="p">.</span><span class="nx">isArray</span><span class="p">(</span><span class="nx">currentArg</span><span class="p">))</span> <span class="p">{</span> <span class="nx">spreadArgs</span> <span class="o">=</span> <span class="nx">spreadArgs</span><span class="p">.</span><span class="nx">concat</span><span class="p">(</span><span class="nx" >currentArg</span><span class="p">);</span>            <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>                <span class="nx">spreadArgs</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">currentArg</span><span class="p">);</span>            <span class="p">}</span>        <span class="p" >}</span>        <span class="nx">fn</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="nx">fnThis</span><span class="p">,</span> <span class= "nx">spreadArgs</span><span class="p">);</span>    <span class="p">};</span><span class="p">}</span><span class="kd">var</span> <span class="nx">someArgs</span> <span class="o">=</span> <span class="p">[</span><span class="s2">"a"</span><span class="p">,</span> <span class="s2">"b"</span><span class="p">,</span> <span class="s2">"c"</span><span class="p">];</span><span class="kd">var</span> <span class="nx">moreArgs</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">];</span><span class="c1">// Outputs: ["a", "b", "c"] [1, 2, 3]</span><span class="nx">console</span><span class="p">. </span><span class="nx">log</span><span class="p">(</span><span class="nx">someArgs</span><span class="p">,</span> <span class="nx">moreArgs</span><span class="p">);</span><span class="c1" >// Outputs: a b c 1 2 3</span><span class="nx">spreadify</span><span class="p">(</span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">, </span> <span class="nx">console</span><span class="p">)(</span><span class="nx">someArgs</span><span class="p">,</span> <span class="nx">moreArgs</span><span class="p">); </span></code></pre></div><p>What on earth is going on here? It's actually pretty simple. Our <code>spreadify</code> function takes two arguments, a function, and an optional parameter specifying what the function's <code>this</code> should be. In the case of <code>console.log</code>, that is <code>console</code>.</p><p>When the <code>spreadify</code> function is invoked, it immediately returns another function. That's why we have the doubled parentheses at the end of the example. But you could also do something like this:</p><div class="highlight" ><pre><code class="language-javascript" data-lang="javascript"><span class="c1">// `spreadLog` is now the function that `spreadify` returns</span><span class="kd">var</span> <span class= "nx">spreadLog</span> <span class="o">=</span> <span class="nx">spreadify</span><span class="p">(</span><span class="nx">console</span><span class="p">.</span><span class="nx">log </span><span class="p">,</span> <span class="nx">console</span><span class="p">);</span><span class="c1">// Outputs: a b c 1 2 3</span><span class="nx">spreadLog</span><span class="p">( </span><span class="nx">someArgs</span><span class="p">,</span> <span class="nx">moreArgs</span><span class="p">);</span></code></pre></div><p>So we have our new function. That new function does two things.</p><ol><li>It does some preprocessing on whatever arguments we pass it. (Either immediately with that second set of parentheses in the first example, or later on as in the second example.)</li><li>It then invokes our original function (<code>log</code> in this case) with the processed arguments.</li></ol><p>In our preprocessing we use the <code> arguments</code> object to examine all the arguments which were passed in. If an argument is an array, then we add the array's contents to <code>spreadArgs</code>. If the argument is not an array, then we directly push the argument onto <code>spreadArgs</code>.</p><p>Finally, we invoke our original function by using <code>apply</code>, passing in the <code>this</code> value, as well the <code>spreadArgs</code> array.</p><p>In the event that you didn't pass a <code>this</code> value into <code>spreadify</code>, <code>fnThis</code> will be <code>undefined </code>, and <code>apply</code> will use the default value of <code>this</code> (usually the global object).</p><p>You may have noticed one problem with our emulation of the spread operator here. The <code>spreadify</code> function assumes that all arrays should be expanded into individual arguments. That may not always be the case. Fortunately there's a fairly simple workaround. Just wrap any array you want to preserve as an individual argument inside another array, like so:</p><div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">var</span> <span class="nx">someArgs</span> <span class="o">=</span> <span class="p">[</span><span class="s2">"a"</span><span class="p">,</span> <span class="s2">"b"</span><span class="p">,</span> <span class="s2">"c"</span><span class="p">];</span><span class="kd">var</span> <span class="nx">moreArgs</span> <span class="o">= </span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">];</span><span class="kd">var</span> <span class="nx">myArray</span> <span class="o">=</span> <span class="p">[</span><span class="s2">"my"</span><span class="p">,</span> <span class="s2">"array" </span><span class="p">];</span><span class="c1">// `spreadLog` is now the function that `spreadify` returns</span><span class="kd">var</span> <span class="nx">spreadLog</span> <span class ="o">=</span> <span class="nx">spreadify</span><span class="p">(</span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">,</span> <span class="nx">console</span><span class="p">);</span><span class="c1">// Outputs: a b c 1 2 3 ["my", "array"]</span><span class="nx">spreadLog</span><span class="p">(</span><span class="nx"> someArgs</span><span class="p">,</span> <span class="nx">moreArgs</span><span class="p">,</span> <span class="p">[</span><span class="nx">myArray</span><span class="p">]); </span></code></pre></div><p>Of course, <code>spreadify</code> doesn't completely replace the spread operator, since in ES6 you can also spread into an array literal:</p><div class= "highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">var</span> <span class="nx">alpha</span> <span class="o">=</span> <span class="p">[</span><span class="s2">"a"</span><span class="p">,</span> <span class="s2">"b"</span><span class="p">,</span> <span class="s2">"c"</span><span class="p">];</span><span class="kd">var</span> <span class="nx">num</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi"> 3</span><span class="p">];</span><span class="kd">var</span> <span class="nx">all</span> <span class="o">=</span> <span class="p">[</span><span class="s2">"all"</span><span class="p">, </span> <span class="p">...</span><span class="nx">alpha</span><span class="p">,</span> <span class="p">...</span><span class="nx">num</span><span class="p">];</span></code></pre></div><p> But <code>spreadify</code> can still be pretty useful. And hopefully walking through how it uses <code>apply</code> has helped give you a better grasp of how powerful JavaScript functions can be.</p>    </div>			</div>		<!--=========================			END : POST		=============================-->		<!--=========================			START : POST		=============================-->		<div class="post-wrapper"><div class="post">        <h1 class="post-title">Invoking JavaScript Functions With 'call' and 'apply'</h1> <p><i>                Originally published in the                <a href="/">A Drip of JavaScript newsletter</a>.            </i></p>        <p>A couple of issues ago, we talked about some of the implications of <a href="/blog/drips/function-functions">functions being first-class citizens</a> in JavaScript. Here is a further implication to consider: <strong>If functions are objects and objects can have methods, then functions can have methods.</strong></p><p>In fact, JavaScript functions come with several methods built into <code> Function.prototype</code>. First let's take a look at <code>call</code>.</p><div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">function </span> <span class="nx">add</span> <span class="p">(</span><span class="nx">a</span><span class="p">,</span> <span class="nx">b</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="nx">a</span> <span class="o">+</span> <span class="nx">b</span><span class="p">;</span><span class="p">}</span><span class="c1">// Outputs: 3 </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">add</span><span class="p">(</span><span class="mi">1 </span><span class="p">,</span> <span class="mi">2</span><span class="p">));</span><span class="c1">// Outputs: 3</span><span class="nx">console</span><span class="p">.</span><span class= "nx">log</span><span class="p">(</span><span class="nx">add</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">, </span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">));</span></code></pre></div><p>Assuming that you're not using <a href=" http://www.nczonline.net/blog/2012/03/13/its-time-to-start-using-javascript-strict-mode/">strict mode</a>, these invocations of <code>add</code> are exactly equivalent. The first parameter given to <code>call</code> has a special purpose, but any subsequent parameters are treated the same as if <code>add</code> had been invoked normally.</p><p>The first parameter that <code>call</code> expects, though, will be set to <code>add</code>'s internal <code>this</code> value. When a function is invoked ordinarily, the <code>this</code> value is set implicitly.</p><p>If you're not in strict mode and the function isn't attached to an object, then it will inherit its <code>this</code> from the global object. If the function is attached to an object, its default <code>this</code> is the receiver of the method call.</p><p>Let's look at how that works:</p><div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">var</span> <span class="nx">palestrina</span> <span class="o">=</span> <span class="p">{</span>    <span class="nx">work</span><span class="o">: </span> <span class="s2">"Missa Papae Marcelli"</span><span class="p">,</span>    <span class="nx">describe</span><span class="o">:</span> <span class="kd">function</span><span class="p"> ()</span> <span class="p">{</span>        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="k">this</span><span class= "p">.</span><span class="nx">work</span><span class="p">);</span>    <span class="p">}</span><span class="p">};</span><span class="c1">// Outputs: "Missa Papae Marcelli",</span><span class ="nx">palestrina</span><span class="p">.</span><span class="nx">describe</span><span class="p">();</span></code></pre></div><p>But <code>call</code> gives us a way to "borrow" a method from one object to use for another.</p><div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">var</span> <span class="nx">erasmus</span> <span class="o">=</span> <span class="p">{</span>    <span class="nx">work</span><span class="o">:</span> <span class="s2">"Freedom of the Will"</span><span class="p">};</span><span class= "c1">// Outputs: "Freedom of the Will"</span><span class="nx">palestrina</span><span class="p">.</span><span class="nx">describe</span><span class="p">.</span><span class="nx">call </span><span class="p">(</span><span class="nx">erasmus</span><span class="p">);</span></code></pre></div><p>You may be wondering how this is useful. But we've seen <a href= "/blog/drips/arbitrary-parameters-with-the-arguments-object">this approach</a> before. Last time, we used it to invoke <code>Array</code> methods on a non-array (though array-like) object. </p><div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">function</span> <span class="nx">myFunc</span> <span class="p">()</span> <span class="p">{</span>    <span class="c1">// Invoke `slice` with `arguments`</span>    <span class="c1">// as it's `this` value</span>    <span class="kd">var</span> <span class="nx">args </span> <span class="o">=</span> <span class="nb">Array</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">slice</span><span class="p"> .</span><span class="nx">call</span><span class="p">(</span><span class="nx">arguments</span><span class="p">);</span><span class="p">}</span></code></pre></div><p>It's use extends beyond the <code>arguments</code> object, though. For instance, you can invoke many array methods on strings:</p><div class="highlight"><pre><code class="language-javascript" data-lang= "javascript"><span class="kd">var</span> <span class="nx">original</span> <span class="o">=</span> <span class="s2">"There is 1 number."</span><span class="p">;</span><span class="kd">var </span> <span class="nx">updated</span> <span class="o">=</span> <span class="nb">Array</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class= "nx">filter</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">original</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">val</span><span class="p">)</span> <span class="p">{</span>    <span class="k">return</span> <span class="nx">val</span><span class="p">.</span><span class="nx">match</span><span class="p">(</span><span class="sr">/1/</span><span class="p">);</span><span class="p">});</span><span class="c1">// Outputs: ["1"]</span><span class="nx"> console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">updated</span><span class="p">);</span><span class="c1">// Outputs: "1" </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">updated</span><span class="p">.</span><span class="nx"> join</span><span class="p">(</span><span class="s1">''</span><span class="p">));</span></code></pre></div><p>Of course, the return values of those methods will be arrays, so you may need to convert them back to strings with <code>join</code>.</p><p>So far we've only talked about <code>call</code>. So what's the deal with <code>apply</code>? It turns out that <code>apply </code> works in almost exactly the same way as <code>call</code>. The difference is that instead of a series of arguments, <code>apply</code> takes an array of values to use in its invocation.</p><div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">function</span> <span class="nx">add</span> <span class="p">( </span><span class="nx">a</span><span class="p">,</span> <span class="nx">b</span><span class="p">)</span> <span class="p">{</span>    <span class="k">return</span> <span class="nx">a </span> <span class="o">+</span> <span class="nx">b</span><span class="p">;</span><span class="p">}</span><span class="c1">// Outputs: 3</span><span class="nx">console</span><span class= "p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">add</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this </span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">));</span><span class="c1">// Outputs: 3</span><span class="nx"> console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">add</span><span class="p">.</span><span class="nx">apply</span><span class="p">( </span><span class="k">this</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])); </span></code></pre></div><p>In the example above, <code>call</code> and <code>apply</code> are used in exactly equivalent ways. As you can see, the only real difference is that <code> apply</code> takes an array. </p><p>But that turns out to be a very important difference. Unlike a series of arguments, an array is very easy to manipulate in JavaScript. And that opens up much larger possibilities for working with functions.</p><p>In the next issue, we'll explore some of those possibilities.</p>    </div>			</div> <!--=========================			END : POST		=============================-->		<!--=========================			START : POST =============================-->		<div class="post-wrapper"><div class="post">        <h1 class="post-title">Testing Array Contents with Array#every</h1>            <p><i> Originally published in the                <a href="/">A Drip of JavaScript newsletter</a>.            </i></p>        <p>We've talked before about how common it is to test the contents of an array to figure out what to do next, and how <a href="/blog/drips/testing-array-contents-with-array-some/">Array's <code>some</code> method</a> will let us test whether some elements meet our criteria. But sometimes we need to make sure that <strong>every</strong> element in an array meets certain criteria.</p><p>Here is an example of the pattern at work:</p><div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">var</span> <span class="nx">heroes</span> <span class="o">=</span> <span class="p">[</span>    <span class="p">{</span> <span class="nx">name</span><span class="o">:</span> <span class="s2">"Superman"</span><span class="p">,</span>     <span class="nx">universe </span><span class="o">:</span> <span class="s2">"DC"</span>     <span class="p">},</span>    <span class="p">{</span> <span class="nx">name</span><span class="o">:</span> <span class="s2" >"Batman"</span><span class="p">,</span>       <span class="nx">universe</span><span class="o">:</span> <span class="s2">"DC"</span>     <span class="p">},</span>    <span class="p">{ </span> <span class="nx">name</span><span class="o">:</span> <span class="s2">"Spider-Man"</span><span class="p">,</span>   <span class="nx">universe</span><span class="o">:</span> <span class="s2">"Marvel"</span> <span class="p">},</span>    <span class="p">{</span> <span class="nx">name</span><span class="o">:</span> <span class="s2">"Wonder Woman"</span><span class="p"> ,</span> <span class="nx">universe</span><span class="o">:</span> <span class="s2">"DC"</span>     <span class="p">}</span><span class="p">];</span><span class="c1">// Default to true </span><span class="kd">var</span> <span class="nx">areAllDC</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span><span class="k">for</span> <span class="p"> (</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt; </span> <span class="nx">heroes</span><span class="p">.</span><span class="nx">length</span> <span class="o">&amp;&amp;</span> <span class="nx">areAllDC</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>    <span class="k">if</span> <span class="p">(</span><span class="nx">heroes</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">universe</span> <span class="o">!==</span> <span class="s2">"DC"</span><span class="p">)</span> <span class="p">{</span>        <span class="nx">areAllDC</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>    <span class="p">}</span><span class="p">} </span><span class="c1">// Outputs: false</span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">areAllDC </span><span class="p">);</span></code></pre></div><p>We iterate over the array with a for loop, but with an extra check on <code>areAllDC</code> to halt iteration as soon as we've determined that there is a non-matching element.</p><p>So, that's the "classical" looping approach. Fortunately, JavaScript also gives us a very nice built-in function to do this work for us. And we can do so without having to constantly write loops and keep track of extraneous variables and code.</p><p>The <code>every</code> function is available on all arrays, and we can use it like this:</p><div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">function</span> <span class="nx">isDC</span><span class="p">( </span><span class="nx">element</span><span class="p">)</span> <span class="p">{</span>    <span class="k">return</span> <span class="p">(</span><span class="nx">element</span><span class= "p">.</span><span class="nx">universe</span> <span class="o">===</span> <span class="s2">"DC"</span><span class="p">);</span><span class="p">}</span><span class="c1">// Outputs: false </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">heroes</span><span class="p">.</span><span class="nx"> every</span><span class="p">(</span><span class="nx">isDC</span><span class="p">));</span><span class="kd">var</span> <span class="nx">villains</span> <span class="o">=</span> <span class= "p">[</span>    <span class="p">{</span> <span class="nx">name</span><span class="o">:</span> <span class="s2">"Brainiac"</span><span class="p">,</span> <span class="nx">universe </span><span class="o">:</span> <span class="s2">"DC"</span> <span class="p">},</span>    <span class="p">{</span> <span class="nx">name</span><span class="o">:</span> <span class="s2"> "Sinestro"</span><span class="p">,</span> <span class="nx">universe</span><span class="o">:</span> <span class="s2">"DC"</span> <span class="p">},</span>    <span class="p">{</span> <span class="nx">name</span><span class="o">:</span> <span class="s2">"Darkseid"</span><span class="p">,</span> <span class="nx">universe</span><span class="o">:</span> <span class="s2">"DC" </span> <span class="p">},</span>    <span class="p">{</span> <span class="nx">name</span><span class="o">:</span> <span class="s2">"Joker"</span><span class="p">,</span>    <span class= "nx">universe</span><span class="o">:</span> <span class="s2">"DC"</span> <span class="p">}</span><span class="p">];</span><span class="c1">// Outputs: true</span><span class="nx">console </span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">villains</span><span class="p">.</span><span class="nx">every</span><span class="p">( </span><span class="nx">isDC</span><span class="p">));</span></code></pre></div><p>The callback will continue to be executed on each element until it returns a falsy value (<code>false </code>, <code>undefined</code>, etc.) or it reaches the end of the array. If it reaches the end without returning a falsy value, then <code>every</code> will return <code>true</code>. </p><p>The callback function also has access to two other parameters: the current index, and the array as a whole. You can use them to evaluate the current element in the context of the entire array.</p><p>For example:</p><div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">function</span> <span class="nx">isSameUniverse </span><span class="p">(</span><span class="nx">el</span><span class="p">,</span> <span class="nx">index</span><span class="p">,</span> <span class="nx">arr</span><span class="p">)</span> <span class="p">{</span>    <span class="c1">// The first element doesn't have a predecessor,</span>    <span class="c1">// so don't evaluate it.</span>    <span class="k">if</span> <span class="p">(</span><span class="nx">index</span> <span class="o">===</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>        <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>        <span class="c1">// Do the universe properties of</span>        <span class="c1">// current and previous elements match?</span>        <span class="k">return</span> <span class="p">(</span><span class="nx">el</span><span class="p">. </span><span class="nx">universe</span> <span class="o">===</span> <span class="nx">arr</span><span class="p">[</span><span class="nx">index</span> <span class="o">-</span> <span class= "mi">1</span><span class="p">].</span><span class="nx">universe</span><span class="p">);</span>    <span class="p">}</span><span class="p">}</span><span class="c1">// Outputs: false </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">heroes</span><span class="p">.</span><span class="nx"> every</span><span class="p">(</span><span class="nx">isSameUniverse</span><span class="p">));</span><span class="c1">// Outputs: true</span><span class="nx">console</span><span class="p">. </span><span class="nx">log</span><span class="p">(</span><span class="nx">villains</span><span class="p">.</span><span class="nx">every</span><span class="p">(</span><span class="nx"> isSameUniverse</span><span class="p">));</span></code></pre></div><p>Because <code>every</code> is part of the <a href="http://en.wikipedia.org/wiki/ECMAScript_5#ECMAScript.2C_5th_Edition" >ES5 specification</a>, it isn't available in IE8 and below. But if you want to use it in older browsers, you can use <a href="http://underscorejs.org/#every">Underscore</a>, <a href=" http://lodash.com/docs#every">Lo-Dash</a>, or an <a href="https://github.com/kriskowal/es5-shim">ES5 shim</a> to make it available.</p><p>Thanks for reading!</p><p>Josh Clanton</p> </div>			</div>		<!--=========================			END : POST		=============================-->		<!--=========================			START : POST =============================-->		<div class="post-wrapper"><div class="post">        <h1 class="post-title">Creating Chainable Interfaces in JavaScript</h1>            <p><i> Originally published in the                <a href="/">A Drip of JavaScript newsletter</a>.            </i></p>        <p>When first learning <a href="http://jquery.com/"> jQuery</a>, one of the things that most strikes developers is the ease of using its chainable interface to just keep stringing commands together.</p><div class="highlight"><pre><code class ="language-javascript" data-lang="javascript"><span class="nx">$</span><span class="p">(</span><span class="s2">"#myDiv"</span><span class="p">)</span>    <span class="p">.</span><span class="nx">addClass</span><span class="p">(</span><span class="s2">"myClass"</span><span class="p">)</span>    <span class="p">.</span><span class="nx">css</span><span class="p">( </span><span class="s2">"color"</span><span class="p">,</span> <span class="s2">"red"</span><span class="p">)</span>    <span class="p">.</span><span class="nx">append</span><span class= "p">(</span><span class="s2">"some text"</span><span class="p">);</span></code></pre></div><p>This approach is very powerful. But until you understand how it works, it can seem rather mysterious and complicated. Fortunately, it's very straightforward to implement, so that's what we'll be looking at.</p><p>That "jQuery style" chainability is also known as a <a href=" https://en.wikipedia.org/wiki/Fluent_interface">fluent interface</a>. The fundamental thing that makes a fluent interface possible is for each method to return an object so that you can then call methods upon it.</p><p>That's a little abstract, so here is a concrete example:</p><div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">function</span> <span class="nx">Book</span><span class="p">(</span><span class="nx">name</span><span class="p">,</span> <span class="nx">author</span><span class="p">)</span> <span class="p">{</span>    <span class="k">this</span><span class="p">.</span><span class="nx">name</span> <span class="o">=</span> <span class="nx">name</span><span class="p">;</span> <span class="k">this</span><span class="p">.</span><span class="nx">author</span> <span class="o">=</span> <span class="nx">author</span><span class="p">;</span><span class="p">} </span><span class="nx">Book</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">setName</span> <span class="o">=</span> <span class= "kd">function</span> <span class="p">(</span><span class="nx">name</span><span class="p">)</span> <span class="p">{</span>    <span class="k">this</span><span class="p">.</span><span class ="nx">name</span> <span class="o">=</span> <span class="nx">name</span><span class="p">;</span>    <span class="k">return</span> <span class="k">this</span><span class="p">;</span><span class="p">}</span><span class="nx">Book</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">setAuthor</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">author</span><span class="p">)</span> <span class="p">{</span>    <span class="k">this</span><span class="p">. </span><span class="nx">author</span> <span class="o">=</span> <span class="nx">author</span><span class="p">;</span>    <span class="k">return</span> <span class="k">this</span><span class="p">;</span><span class="p">}</span><span class="nx">lotr</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Book</span><span class="p">(</span><span class= "s2">"Lord of the Rings"</span><span class="p">,</span> <span class="s2">"Tolkien"</span><span class="p">);</span><span class="c1">// Outputs: {</span><span class="c1">//     name: "Lord of the Rings",</span><span class="c1">//     author: "Tolkien"</span><span class="c1">// }</span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">lotr</span><span class="p">);</span><span class="c1">// Whoops! Details were slightly wrong.</span><span class="c1">// Let's fix that.</span><span class= "nx">lotr</span><span class="p">.</span><span class="nx">setAuthor</span><span class="p">(</span><span class="s2">"JRR Tolkien"</span><span class="p">)</span> <span class="c1">// Returns `lotr`</span>    <span class="p">.</span><span class="nx">setName</span><span class="p">(</span><span class="s2">"The Lord of the Rings"</span><span class="p">);</span> <span class="c1"> // Returns `lotr`</span><span class="c1">// Outputs: {</span><span class="c1">//     name: "The Lord of the Rings",</span><span class="c1">//     author: "JRR Tolkien"</span><span class= "c1">// }</span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">lotr</span><span class="p">); </span></code></pre></div><p>The trick here is in our prototype methods. We created <code>setName</code> and <code>setAuthor</code> which can be called on any <code>Book</code> object. But then we made sure that when the methods had done their work, they returned the object they were originally called on.</p><p>Since that object was a <code>Book</code>, we could immediately call any <code>Book</code> method upon it. And that's all that chaining requires.</p><p>Thanks for reading!</p><p>Joshua Clanton</p>    </div>			</div> <!--=========================			END : POST		=============================-->		<!--=========================			START : POST =============================-->		<div class="post-wrapper"><div class="post">        <h1 class="post-title">Testing Array Contents with Array#some</h1>            <p><i> Originally published in the                <a href="/">A Drip of JavaScript newsletter</a>.            </i></p>        <p>When working with arrays, it is quite common to perform different actions based on whether or not the array contains a particular item. A fairly straightforward implementation of this pattern can be found below:</p><div class= "highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="nx">planets</span> <span class="o">=</span> <span class="p">[</span>    <span class="s2">"mercury" </span><span class="p">,</span>    <span class="s2">"venus"</span><span class="p">,</span>    <span class="s2">"earth"</span><span class="p">,</span>    <span class="s2">"mars"</span><span class="p">,</span>    <span class="s2">"jupiter"</span><span class="p">,</span>    <span class="s2">"saturn"</span><span class="p">,</span>    <span class="s2">"uranus"</span><span class= "p">,</span>    <span class="s2">"neptune"</span><span class="p">];</span><span class="c1">// Default to false</span><span class="kd">var</span> <span class="nx">containsPluto</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span><span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">planets</span><span class="p">.</span><span class="nx">length</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="nx">containsPluto</span><span class="p">;</span> <span class="nx">i</span><span class="o">++ </span><span class="p">)</span> <span class="p">{</span>    <span class="k">if</span> <span class="p">(</span><span class="nx">planets</span><span class="p">[</span><span class="nx">i </span><span class="p">]</span> <span class="o">===</span> <span class="s2">"pluto"</span><span class="p">)</span> <span class="p">{</span>        <span class="nx">containsPluto</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>    <span class="p">}</span><span class="p">}</span><span class="c1">// Outputs: false</span><span class="nx"> console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">containsPluto</span><span class="p">);</span></code></pre></div><p>Here our for loop is doing the work of iterating over the array, and a simple if statement checks to see if our condition is met yet. This for loop is a little more complicated than most because it is set up to stop iterating as soon as a matching element is found in the array.</p><p>While it is not that difficult to understand, manually keeping track of the iteration and the "short circuiting" logic just isn't the problem that we're trying to solve. The fewer such things we have to keep in our head, the better. We could fix this by moving the loop into it's own function (probably a good idea), but fortunately the latest version of the JavaScript standard includes such a function for us.</p><p>The function is called <code>some</code> and it is available on all arrays. Here is an example of how it would apply to our problem.</p><div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd"> function</span> <span class="nx">isPluto</span><span class="p">(</span><span class="nx">element</span><span class="p">)</span> <span class="p">{</span>    <span class="k">return</span> <span class="p">(</span><span class="nx">element</span> <span class="o">===</span> <span class="s2">"pluto"</span><span class="p">);</span><span class="p">}</span><span class="c1">// Outputs: false</span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">planets</span><span class="p">.</span><span class="nx">some</span><span class="p">(</span><span class="nx">isPluto</span><span class="p">));</span><span class="nx">dwarfPlanets</span> <span class="o">=</span> <span class="p">[ </span>    <span class="s2">"ceres"</span><span class="p">,</span>    <span class="s2">"pluto"</span><span class="p">,</span>    <span class="s2">"haumea"</span><span class="p">,</span> <span class="s2">"makemake"</span><span class="p">,</span>    <span class="s2">"eris"</span><span class="p">];</span><span class="c1">// Outputs: true</span><span class="nx">console </span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">dwarfPlanets</span><span class="p">.</span><span class="nx">some</span><span class="p">( </span><span class="nx">isPluto</span><span class="p">));</span></code></pre></div><p>All we have to do to use <code>some</code> is to pass it a callback function. The callback will be executed once for each element until the callback returns true. At that point the <code>some</code> method itself will return true. If the callback never returns true, then <code>some </code> will return false.</p><p>The great thing about <code>some</code>, though is that you don't have to think about that unless you want to. You just have to pass in your callback. </p><p>In addition to the array element itself, the callback function has access to two other parameters: the current index, and the entire array. This can be useful in situations where you are comparing the current element against other members of the array. Consider this example:</p><div class="highlight"><pre><code class="language-javascript" data-lang="javascript" ><span class="kd">function</span> <span class="nx">isLessThanPrev</span><span class="p">(</span><span class="nx">el</span><span class="p">,</span> <span class="nx">index</span><span class= "p">,</span> <span class="nx">arr</span><span class="p">)</span> <span class="p">{</span>    <span class="c1">// The first element doesn't have a predecessor,</span>    <span class="c1"> // so don't evaluate it.</span>    <span class="k">if</span> <span class="p">(</span><span class="nx">index</span> <span class="o">===</span> <span class="mi">0</span><span class="p">) </span> <span class="p">{</span>        <span class="k">return</span><span class="p">;</span>    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>        <span class="k">return</span> <span class="p">(</span><span class="nx">el</span> <span class="o">&lt;</span> <span class="nx">arr</span><span class="p">[</span><span class="nx">index</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]);</span>    <span class="p">}</span><span class="p">}</span><span class="nx">evens</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">8 </span><span class="p">];</span><span class="nx">randoms</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">9 </span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">];</span><span class="c1">// Outputs: false</span><span class= "nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">evens</span><span class="p">.</span><span class="nx">some</span><span class= "p">(</span><span class="nx">isLessThanPrev</span><span class="p">));</span><span class="c1">// Outputs: true</span><span class="nx">console</span><span class="p">.</span><span class="nx"> log</span><span class="p">(</span><span class="nx">randoms</span><span class="p">.</span><span class="nx">some</span><span class="p">(</span><span class="nx">isLessThanPrev</span><span class="p">));</span></code></pre></div><p>As with other features of <a href="http://en.wikipedia.org/wiki/ECMAScript_5#ECMAScript.2C_5th_Edition">ES5</a> that we've talked about, <code> some</code> is only supported in IE9 and higher. If you'd like to use it in older browsers, you will need to use a library like <a href="http://underscorejs.org/#some">Underscore</a> which has an equivalent method or a <a href="https://github.com/kriskowal/es5-shim">compatibility shim</a> which ports <code>Array#some</code> back into older browsers.</p><p>Soon we'll be taking a look at what it takes to write your own compatibility shims.</p><p>Josh Clanton</p>    </div>			</div>		<!--=========================			END : POST =============================-->		<!--=========================			START : POST		=============================-->		<div class="post-wrapper"><div class="post"> <h1 class="post-title">Making Deep Property Access Safe in JavaScript</h1>            <p><i>                Originally published in the                <a href="/">A Drip of JavaScript newsletter</a>.            </i></p>        <p>If you've been working with JavaScript for any length of time, you've probably run across the dreaded <code>TypeError: Cannot read property 'someprop' of undefined</code> and the similar error for <code>null</code>.</p><div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class= "kd">var</span> <span class="nx">rels</span> <span class="o">=</span> <span class="p">{</span>    <span class="nx">Viola</span><span class="o">:</span> <span class="p">{</span> <span class="nx">Orsino</span><span class="o">:</span> <span class="p">{</span>            <span class="nx">Olivia</span><span class="o">:</span> <span class="p">{</span> <span class="nx">Cesario</span><span class="o">:</span> <span class="kc">null</span>            <span class="p">}</span>        <span class="p">}</span>    <span class="p">}</span><span class="p">};</span><span class="c1">// Outputs: undefined</span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx"> rels</span><span class="p">.</span><span class="nx">Viola</span><span class="p">.</span><span class="nx">Harry</span><span class="p">);</span><span class="c1">// TypeError: Cannot read property 'Sally' of undefined</span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">rels</span><span class="p">. </span><span class="nx">Viola</span><span class="p">.</span><span class="nx">Harry</span><span class="p">.</span><span class="nx">Sally</span><span class="p">); </span></code></pre></div><p>The problem, of course, is that a <code>TypeError</code> immediately halts execution of your code. It's simple to deal with when you have predictable inputs, but when you need to access a deep object property that may or may not be there it can be quite problematic.</p><p>Sometimes you can solve this by <a href= "/blog/drips/default-parameters-in-javascript">merging with a default object</a>, but at other times that doesn't make sense.</p><p>Often, what we really want is to be able to ask for a deep property and just find out whether it has a proper value. If the deep property's parent or grandparent is <code>undefined</code>, then for our purposes the property can be considered <code>undefined</code> as well.</p><p>Let's take a look at a solution:</p><div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">function </span> <span class="nx">deepGet</span> <span class="p">(</span><span class="nx">obj</span><span class="p">,</span> <span class="nx">properties</span><span class="p">)</span> <span class= "p">{</span>    <span class="c1">// If we have reached an undefined/null property</span>    <span class="c1">// then stop executing and return undefined.</span>    <span class="k">if </span> <span class="p">(</span><span class="nx">obj</span> <span class="o">===</span> <span class="kc">undefined</span> <span class="o">||</span> <span class="nx">obj</span> <span class= "o">===</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>        <span class="k">return</span><span class="p">;</span>    <span class="p">}</span> <span class="c1">// If the path array has no more elements, we've reached</span>    <span class="c1">// the intended property and return its value.</span>    <span class="k">if</span> <span class="p">(</span><span class="nx">properties</span><span class="p">.</span><span class="nx">length</span> <span class="o">===</span> <span class="mi">0</span><span class="p">) </span> <span class="p">{</span>        <span class="k">return</span> <span class="nx">obj</span><span class="p">;</span>    <span class="p">}</span>    <span class="c1">// Prepare our found property and path array for recursion</span>    <span class="kd">var</span> <span class="nx">foundSoFar</span> <span class="o">=</span> <span class="nx">obj</span><span class="p">[ </span><span class="nx">properties</span><span class="p">[</span><span class="mi">0</span><span class="p">]];</span>    <span class="kd">var</span> <span class="nx">remainingProperties </span> <span class="o">=</span> <span class="nx">properties</span><span class="p">.</span><span class="nx">slice</span><span class="p">(</span><span class="mi">1</span><span class="p">); </span>    <span class="k">return</span> <span class="nx">deepGet</span><span class="p">(</span><span class="nx">foundSoFar</span><span class="p">,</span> <span class="nx"> remainingProperties</span><span class="p">);</span><span class="p">}</span></code></pre></div><p>The <code>deepGet</code> function will recursively search a given object until it reaches an <code>undefined</code> or <code>null</code> property, or until it reaches the final property specified in the <code>properties</code> array.</p><p>Let's try it out.</p><div class= "highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="c1">// Outputs: { Cesario: null }</span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">deepGet</span><span class="p">(</span><span class="nx">rels</span><span class="p">,</span> <span class="p">[</span><span class ="s2">"Viola"</span><span class="p">,</span> <span class="s2">"Orsino"</span><span class="p">,</span> <span class="s2">"Olivia"</span><span class="p">]));</span><span class="c1">// Outputs: undefined</span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">deepGet</span><span class="p">( </span><span class="nx">rels</span><span class="p">,</span> <span class="p">[</span><span class="s2">"Viola"</span><span class="p">,</span> <span class="s2">"Harry"</span><span class="p"> ]));</span><span class="c1">// Outputs: undefined</span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">deepGet </span><span class="p">(</span><span class="nx">rels</span><span class="p">,</span> <span class="p">[</span><span class="s2">"Viola"</span><span class="p">,</span> <span class="s2">"Harry" </span><span class="p">,</span> <span class="s2">"Sally"</span><span class="p">]));</span></code></pre></div><p>Excellent!</p><p>Of course, we probably want to use this value in some way. And it's unlikely that <code>undefined</code> in itself will be all that useful.</p><div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd"> var</span> <span class="nx">oliviaRel</span> <span class="o">=</span> <span class="nx">deepGet</span><span class="p">(</span><span class="nx">rels</span><span class="p">,</span> <span class="p">[</span><span class="s2">"Viola"</span><span class="p">,</span> <span class="s2">"Orsino"</span><span class="p">,</span> <span class="s2">"Olivia"</span><span class="p">]); </span><span class="kd">var</span> <span class="nx">sallyRel</span> <span class="o">=</span> <span class="nx">deepGet</span><span class="p">(</span><span class="nx">rels</span><span class= "p">,</span> <span class="p">[</span><span class="s2">"Viola"</span><span class="p">,</span> <span class="s2">"Harry"</span><span class="p">,</span> <span class="s2">"Sally"</span><span class="p">]);</span><span class="c1">// Produces a pretty graph of Olivia's love interest</span><span class="nx">graph</span><span class="p">(</span><span class="nx">oliviaRel</span><span class="p">);</span><span class="c1">// Tries to produce a graph of Sally's love interest</span><span class="nx">graph</span><span class="p">(</span><span class="nx">sallyRel</span><span class="p">);</span></code></pre></div><p>The problem here is that we have to explicitly handle <code>undefined</code> in our <code>graph</code> function. But what if we are using a third party library that doesn't check for <code>undefined</code>? We could use the "or" trick, like so:</p><div class="highlight"><pre><code class="language-javascript" data-lang="javascript" ><span class="nx">graph</span><span class="p">(</span><span class="nx">sallyRel</span> <span class="o">||</span> <span class="p">{});</span></code></pre></div><p>But that's not very explicit about our intentions, and will also fail if <code>sallyRel</code> happens to be <code>false</code> or another falsy value like <code>0</code> or <code>""</code>.</p><p> Alternately, we could explicitly check for <code>null</code> and <code>undefined</code>.</p><div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class ="k">if</span> <span class="p">(</span><span class="nx">sallyRel</span> <span class="o">===</span> <span class="kc">undefined</span> <span class="o">||</span> <span class="nx">sallyRel </span> <span class="o">===</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>    <span class="nx">sallyRel</span> <span class="o">=</span> <span class= "p">{};</span><span class="p">}</span><span class="nx">graph</span><span class="p">(</span><span class="nx">sallyRel</span><span class="p">);</span></code></pre></div><p>But that seems unnecessarily verbose.</p><p>It would be much nicer if we could just specify a default value to return instead of <code>undefined</code>. So how would we do that?</p><div class="highlight" ><pre><code class="language-javascript" data-lang="javascript"><span class="kd">function</span> <span class="nx">deepGet</span> <span class="p">(</span><span class="nx">obj</span><span class="p">,</span> <span class="nx">props</span><span class="p">,</span> <span class="nx">defaultValue</span><span class="p">)</span> <span class="p">{</span>    <span class="c1">// If we have reached an undefined/null property</span>    <span class="c1">// then stop executing and return the default value.</span>    <span class="c1">// If no default was provided it will be undefined.</span>    <span class="k">if</span> <span class="p">(</span><span class="nx">obj</span> <span class="o">===</span> <span class="kc">undefined</span> <span class="o">||</span> <span class="nx">obj</span> <span class="o">===</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>        <span class="k">return</span> <span class="nx"> defaultValue</span><span class="p">;</span>    <span class="p">}</span>    <span class="c1">// If the path array has no more elements, we've reached</span>    <span class="c1">// the intended property and return its value</span>    <span class="k">if</span> <span class="p">(</span><span class="nx">props</span><span class="p">.</span><span class="nx">length</span> <span class="o">===</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>        <span class="k">return</span> <span class="nx">obj</span><span class="p">;</span> <span class="p">}</span>    <span class="c1">// Prepare our found property and path array for recursion</span>    <span class="kd">var</span> <span class="nx">foundSoFar</span> <span class="o">=</span> <span class="nx">obj</span><span class="p">[</span><span class="nx">props</span><span class="p">[</span><span class="mi">0</span><span class="p">]];</span>    <span class="kd">var</span> <span class="nx">remainingProps</span> <span class="o">=</span> <span class="nx">props</span><span class="p">.</span><span class="nx">slice</span><span class="p">( </span><span class="mi">1</span><span class="p">);</span>    <span class="k">return</span> <span class="nx">deepGet</span><span class="p">(</span><span class="nx">foundSoFar</span><span class="p">,</span> <span class="nx">remainingProps</span><span class="p">,</span> <span class="nx">defaultValue</span><span class="p">);</span><span class="p">}</span><span class="nx"> sallyRel</span> <span class="o">=</span> <span class="nx">deepGet</span><span class="p">(</span><span class="nx">rels</span><span class="p">,</span> <span class="p">[</span><span class= "s2">"Viola"</span><span class="p">,</span> <span class="s2">"Harry"</span><span class="p">,</span> <span class="s2">"Sally"</span><span class="p">],</span> <span class="p">{}); </span><span class="c1">// Will output a graph based on the empty object</span><span class="nx">graph</span><span class="p">(</span><span class="nx">sallyRel</span><span class="p">); </span></code></pre></div><p>Now we have a nice safe way to do deep property access and even get back a useful value when the property doesn't have one.</p><p>If you find this utility useful or interesting, I have <a href="https://github.com/joshuacc/drabs">open-sourced it on GitHub</a>. I've even added some syntactic sugar so you can use a string-based property list, like <code>Viola.Harry.Sally</code>.</p><p>Have ideas for future drips? Is there some part of JavaScript that consistently gives you trouble? <a href=" http://designpepper.com/drip-suggestions">Drop me a topic suggestion.</a></p><p>Thanks for reading!</p><p>Joshua Clanton</p>    </div>			</div> <!--=========================			END : POST		=============================-->		<!--=========================			START : POST =============================-->		<div class="post-wrapper"><div class="post">        <h1 class="post-title">What are Prototype Properties and Methods?</h1>            <p><i> Originally published in the                <a href="/">A Drip of JavaScript newsletter</a>.            </i></p>        <p>A <a href="/blog/drips/constructors-in-javascript" >couple of weeks ago</a>, I mentioned prototype properties in passing. But what exactly are they? Let's take a look.</p><div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">function</span> <span class="nx">Book</span><span class="p">(</span><span class="nx">title</span><span class="p">,</span> <span class="nx">author </span><span class="p">)</span> <span class="p">{</span>    <span class="k">this</span><span class="p">.</span><span class="nx">title</span> <span class="o">=</span> <span class="nx">title </span><span class="p">;</span>    <span class="k">this</span><span class="p">.</span><span class="nx">author</span> <span class="o">=</span> <span class="nx">author</span><span class="p"> ;</span><span class="p">}</span><span class="nx">Book</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">getFormatted</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>    <span class="k">return</span> <span class="k">this</span><span class="p">. </span><span class="nx">title</span> <span class="o">+</span> <span class="s2">" - "</span> <span class="o">+</span> <span class="k">this</span><span class="p">.</span><span class="nx"> author</span><span class="p">;</span><span class="p">}</span><span class="kd">var</span> <span class="nx">hobbit</span> <span class="o">=</span> <span class="k">new</span> <span class="nx" >Book</span><span class="p">(</span><span class="s2">"The Hobbit"</span><span class="p">,</span> <span class="s2">"Tolkien"</span><span class="p">);</span><span class="c1">// Outputs: "The Hobbit - Tolkien"</span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">hobbit</span><span class="p">. </span><span class="nx">getFormatted</span><span class="p">());</span></code></pre></div><p>What is this magical <code>getFormatted</code>? And how did it get attached to my object? It's all through the power of prototypes.</p><p>Whenever you create an object using a constructor, that constructor has a property called <code>prototype</code> which points to an object. If you haven't done anything special, that prototype property is just an empty object. But it's an empty object with superpowers.</p><p>Let's see how that works.</p><div class="highlight" ><pre><code class="language-javascript" data-lang="javascript"><span class="kd">function</span> <span class="nx">Book</span><span class="p">(</span><span class="nx">title</span><span class ="p">,</span> <span class="nx">author</span><span class="p">)</span> <span class="p">{</span>    <span class="k">this</span><span class="p">.</span><span class="nx">title</span> <span class="o">=</span> <span class="nx">title</span><span class="p">;</span>    <span class="k">this</span><span class="p">.</span><span class="nx">author</span> <span class="o">=</span> <span class="nx">author</span><span class="p">;</span><span class="p">}</span><span class="nx">Book</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">pubYear</span> <span class="o">=</span> <span class="s2">"unknown"</span><span class="p">;</span><span class="kd">var</span> <span class="nx">hobbit</span> <span class="o">= </span> <span class="k">new</span> <span class="nx">Book</span><span class="p">(</span><span class="s2">"The Hobbit"</span><span class="p">,</span> <span class="s2">"Tolkien"</span><span class="p">);</span><span class="kd">var</span> <span class="nx">caspian</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Book</span><span class="p">(</span><span class="s2">"Prince Caspian"</span><span class="p">,</span> <span class="s2">"Lewis"</span><span class="p">);</span><span class="nx">caspian</span><span class="p">.</span><span class="nx"> pubYear</span> <span class="o">=</span> <span class="mi">1951</span><span class="p">;</span><span class="c1">// Outputs: "unknown"</span><span class="nx">console</span><span class="p">. </span><span class="nx">log</span><span class="p">(</span><span class="nx">hobbit</span><span class="p">.</span><span class="nx">pubYear</span><span class="p">);</span><span class="c1">// Outputs: 1951</span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">caspian</span><span class="p">.</span><span class="nx">pubYear</span><span class="p">);</span><span class="c1">// Outputs: "unknown"</span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class ="p">(</span><span class="nx">Book</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">pubYear</span><span class="p">); </span></code></pre></div><p>In the example above, we create a <code>Book</code> constructor, and then create a <code>pubYear</code> property "unknown" on it's prototype object.</p><p> When we try to access <code>hobbit.pubYear</code>, the JavaScript interpreter realizes that the <code>hobbit</code> object doesn't have a matching property, so it then checks to see if there is a matching property on the prototype object. Since there is, it will give us the value of <code>Book.prototype.pubYear</code>.</p><p>But because the <code>caspian</code> object has a <code>pubYear</code> property of it's own, the interpreter never has to go look at the prototype object.</p><p>While ordinary properties on a prototype can be useful, methods are more useful still. Let's go back to our original example.</p><div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">function</span> <span class="nx">Book</span><span class="p">(</span><span class="nx">title</span><span class="p">,</span> <span class="nx">author</span><span class="p">)</span> <span class="p">{</span>    <span class="k">this</span><span class="p">.</span><span class="nx">title</span> <span class="o">=</span> <span class="nx">title</span><span class="p">;</span>    <span class="k">this </span><span class="p">.</span><span class="nx">author</span> <span class="o">=</span> <span class="nx">author</span><span class="p">;</span><span class="p">}</span><span class="nx">Book </span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">getFormatted</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">title</span> <span class="o">+</span> <span class="s2">" - "</span> <span class="o">+</span> <span class="k">this</span><span class="p">.</span><span class="nx">author</span><span class="p">;</span><span class="p">} </span><span class="kd">var</span> <span class="nx">hobbit</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Book</span><span class="p">(</span><span class="s2"> "The Hobbit"</span><span class="p">,</span> <span class="s2">"Tolkien"</span><span class="p">);</span><span class="c1">// Outputs: "The Hobbit - Tolkien"</span><span class="nx">console </span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">hobbit</span><span class="p">.</span><span class="nx">getFormatted</span><span class="p"> ());</span></code></pre></div><p>Now you should know how the property lookup works. The interpreter realizes that there is no <code>getFormatted</code> property on <code>hobbit</code> itself, so looks for it on the prototype.</p><p>But you might notice something else special. The <code>getFormatted</code> method makes use of <code>this.title</code> and <code>this.author </code>. That works because when an object's method is invoked, the object itself becomes the <code>this</code> for the method. And that's even if the method itself belongs to the prototype rather than directly to the object.</p><p>Why bother with all of this, though? Why not define <code>getFormatted</code> directly on the object, like so?</p><div class="highlight" ><pre><code class="language-javascript" data-lang="javascript"><span class="kd">function</span> <span class="nx">Book</span><span class="p">(</span><span class="nx">title</span><span class ="p">,</span> <span class="nx">author</span><span class="p">)</span> <span class="p">{</span>    <span class="k">this</span><span class="p">.</span><span class="nx">title</span> <span class="o">=</span> <span class="nx">title</span><span class="p">;</span>    <span class="k">this</span><span class="p">.</span><span class="nx">author</span> <span class="o">=</span> <span class="nx">author</span><span class="p">;</span>    <span class="k">this</span><span class="p">.</span><span class="nx">getFormatted</span> <span class="o">=</span> <span class="kd"> function</span> <span class="p">()</span> <span class="p">{</span>        <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">title</span> <span class="o">+</span> <span class="s2">" - "</span> <span class="o">+</span> <span class="k">this</span><span class="p">.</span><span class="nx">author</span><span class="p">;</span> <span class="p">}</span><span class="p">}</span></code></pre></div><p>Because if you do it like that, rather than defining a single method which can be used by all <code>Book</code> objects, each object has its own copy of the method. Now imagine a scenario where you are producing lots of <code>Book</code> objects.</p><div class="highlight"><pre><code class= "language-javascript" data-lang="javascript"><span class="kd">var</span> <span class="nx">bookArray</span> <span class="o">=</span> <span class="p">[];</span><span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="mi">100</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>    <span class ="nx">bookArray</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Book</span><span class= "p">(</span><span class="s2">"Some Title"</span><span class="p">,</span> <span class="s2">"Some Author"</span><span class="p">);</span><span class="p">}</span></code></pre></div><p>Now you have have 100 copies of <code>getFormatted</code> taking up space in memory. In addition, if you need to change how <code>getFormatted</code> works, you'll need to manually update each instance of <code>Book</code>. Compare that to how simple it is to update the prototype method.</p><div class="highlight"><pre><code class="language-javascript" data-lang="javascript" ><span class="kd">function</span> <span class="nx">Book</span><span class="p">(</span><span class="nx">title</span><span class="p">,</span> <span class="nx">author</span><span class="p">) </span> <span class="p">{</span>    <span class="k">this</span><span class="p">.</span><span class="nx">title</span> <span class="o">=</span> <span class="nx">title</span><span class="p">; </span>    <span class="k">this</span><span class="p">.</span><span class="nx">author</span> <span class="o">=</span> <span class="nx">author</span><span class="p">;</span><span class="p"> }</span><span class="nx">Book</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">getFormatted</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">title </span> <span class="o">+</span> <span class="s2">" - "</span> <span class="o">+</span> <span class="k">this</span><span class="p">.</span><span class="nx">author</span><span class="p">; </span><span class="p">}</span><span class="kd">var</span> <span class="nx">hobbit</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Book</span><span class="p">( </span><span class="s2">"The Hobbit"</span><span class="p">,</span> <span class="s2">"Tolkien"</span><span class="p">);</span><span class="c1">// Outputs: "The Hobbit - Tolkien" </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">hobbit</span><span class="p">.</span><span class="nx"> getFormatted</span><span class="p">());</span><span class="c1">// Oops! We need to use commas, not hyphens</span><span class="nx">Book</span><span class="p">.</span><span class="nx"> prototype</span><span class="p">.</span><span class="nx">getFormatted</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span> <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">title</span> <span class="o">+</span> <span class="s2">", "</span> <span class="o">+ </span> <span class="k">this</span><span class="p">.</span><span class="nx">author</span><span class="p">;</span><span class="p">}</span><span class="c1">// Outputs: "The Hobbit, Tolkien" </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">hobbit</span><span class="p">.</span><span class="nx"> getFormatted</span><span class="p">());</span></code></pre></div><p>Updating the method on the prototype means that all instances of <code>Book</code> get the updated method immediately, and you don't have the possibility of some instances having the outdated method.</p><p>So those are the basics of how prototype properties and methods work.</p><p>Whew! That's a bit wordier than normal, but the newsletter should be back to a normal length next week.</p><p>Thanks for reading!</p><p>Josh Clanton</p>    </div>			</div> <!--=========================			END : POST		=============================-->		<!--=========================			START : POST =============================-->		<div class="post-wrapper"><div class="post hentry"><a name="2423990262157552006"></a><h1 class="post-title entry-title">JavaScript's "this": how it works, where it can trip you up</h1><div class="post-header"><div class="post-header-line-1"><span class="post-labels">Labels:<a href="http://www.2ality.com/search/label/dev" rel="tag">dev </a>,<a href="http://www.2ality.com/search/label/javascript" rel="tag">javascript</a>,<a href="http://www.2ality.com/search/label/jslang" rel="tag">jslang</a></span></div></div><div class= "post-body entry-content">In JavaScript, the special variable <tt>this</tt> is relatively complicated, because it is available everywhere, not just in object-oriented settings. This blog post explains how <tt>this</tt> works and where it can cause problems, concluding with best practices.<a name="more"></a><p>To understand <tt>this</tt>, it is best to partition the locations where it can be used into three categories:</p><ul>    <li><b>In functions:</b> <tt>this</tt> is an extra, often implicit, parameter.    </li>    <li><b>Outside functions (in the top-level scope):</b> <tt>this</tt> refers to the global object in browsers and to a module's exports in Node.js.    </li>    <li><b>In a string passed to <tt>eval()</tt>:</b> <tt> eval()</tt> either picks up the current value of <tt>this</tt> or sets it to the global object, depending on whether it is called directly or indirectly.    </li></ul>Let's examine each of these categories.<h3 class="countheads"><tt>this</tt> in functions</h3>That's the most common way of using <tt>this</tt>, because functions represent all callable constructs in JavaScript, by playing three different roles:<ul>    <li>Real functions (<tt>this</tt> is the global object in sloppy mode, <tt>undefined</tt> in strict mode)</li>    <li>Constructors ( <tt>this</tt> refers to the newly created instance)</li>    <li>Methods (<tt>this</tt> refers to the receiver of the method call)</li></ul>In functions, <tt>this</tt> can be thought of as an extra, often implicit, parameter.<h4><tt>this</tt> in real functions</h4>In real functions, the value of <tt>this</tt> depends on the <a href=" http://speakingjs.com/es5/ch07.html#strict_mode">mode</a> one is in:<ul>    <li>Sloppy mode: <tt>this</tt> refers to the <a href="http://speakingjs.com/es5/ch16.html#global_object">global object</a> (<tt>window</tt> in browsers).<pre class="javascript hljs ">    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">sloppyFunc </span><span class="hljs-params">()</span> {</span>        console.log(<span class="hljs-keyword">this</span> === window); <span class="hljs-comment">// true</span>    }    sloppyFunc(); </pre>    </li>    <li>Strict mode: <tt>this</tt> has the value <tt>undefined</tt>.<pre class="javascript hljs ">    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">strictFunc</span><span class="hljs-params">()</span> {</span><span class="hljs-pi">        'use strict'</span>;        console.log(<span class="hljs-keyword">this </span> === <span class="hljs-literal">undefined</span>); <span class="hljs-comment">// true</span>    }    strictFunc();</pre>    </li></ul>That is, <tt>this</tt> is an implicit parameter that is set to a default value (<tt>window</tt> or <tt>undefined</tt>). You can, however, make a function call via <tt>call()</tt> or <tt>apply()</tt> and specify the value of <tt>this</tt> explicitly:<pre class="javascript hljs ">    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">func</span><span class= "hljs-params">(arg1, arg2)</span> {</span>        console.log(<span class="hljs-keyword">this</span>); <span class="hljs-comment">// a</span>        console.log(arg1); <span class= "hljs-comment">// b</span>        console.log(arg2); <span class="hljs-comment">// c</span>    }    func.call(<span class="hljs-string">'a'</span>, <span class="hljs-string">'b'</span>, <span class="hljs-string">'c'</span>); <span class="hljs-comment">// (this, arg1, arg2)</span>    func.apply(<span class="hljs-string">'a'</span>, [<span class="hljs-string">'b'</span>, <span class="hljs-string">'c'</span>]); <span class="hljs-comment">// (this, arrayWithArgs)</span></pre><h4><tt>this</tt> in constructors</h4>Functions become constructors if you invoke them via the <tt>new</tt> operator. That operator creates a new object and passes it to the constructor via <tt>this</tt>:<pre class="javascript hljs ">    <span class="hljs-keyword">var </span> savedThis;    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Constr</span><span class="hljs-params">()</span> {</span> savedThis = <span class="hljs-keyword">this</span>;    }    <span class="hljs-keyword">var</span> inst = <span class="hljs-keyword">new</span> Constr();    console.log(savedThis === inst); <span class="hljs-comment">// true</span></pre>Implemented in JavaScript, the <tt>new</tt> operator looks roughly as follows (a more accurate implementation is <a href=" http://speakingjs.com/es5/ch17.html#_the_new_operator_implemented_in_javascript">slightly more complex</a>):<pre class="javascript hljs ">    <span class="hljs-function"><span class= "hljs-keyword">function</span> <span class="hljs-title">newOperator</span><span class="hljs-params">(Constr, arrayWithArgs)</span> {</span>        <span class="hljs-keyword">var</span> thisValue = <span class="hljs-built_in">Object</span>.create(Constr.prototype);        Constr.apply(thisValue, arrayWithArgs);        <span class="hljs-keyword">return</span> thisValue;    }</pre><h4><tt>this</tt> in methods</h4>In methods, things are similar to more traditional object-oriented languages: <tt>this</tt> refers to the <i>receiver</i>, the object on which the method has been invoked.<pre class="javascript hljs ">    <span class="hljs-keyword">var</span> obj = {        method: <span class="hljs-function"><span class="hljs-keyword"> function</span> <span class="hljs-params">()</span> {</span>            console.log(<span class="hljs-keyword">this</span> === obj); <span class="hljs-comment">// true</span>        } }    obj.method();</pre><h3><tt>this</tt> in the top-level scope</h3>In browsers, the top-level scope is the global scope and <tt>this</tt> refers to the <a href=" http://speakingjs.com/es5/ch16.html#global_object">global object</a> (like <tt>window</tt> does):<pre class="html hljs ">    <span class="hljs-tag">&lt;<span class="hljs-title">script </span>&gt;</span><span class="javascript">        console.log(<span class="hljs-keyword">this</span> === window); <span class="hljs-comment">// true</span>    </span><span class= "hljs-tag">&lt;/<span class="hljs-title">script</span>&gt;</span></pre>In Node.js, you normally execute code in modules. Therefore, the top-level scope is a special <i>module scope</i>: <pre class="javascript hljs ">    <span class="hljs-comment">// `global` (not `window`) refers to global object:</span>    console.log(<span class="hljs-built_in">Math</span> === global.Math); <span class="hljs-comment">// true</span>    <span class="hljs-comment">// `this` doesn't refer to the global object:</span>    console.log(<span class="hljs-keyword">this </span> !== global); <span class="hljs-comment">// true</span>    <span class="hljs-comment">// `this` refers to a module's exports:</span>    console.log(<span class="hljs-keyword">this </span> === module.exports); <span class="hljs-comment">// true</span></pre><h3><tt>this</tt> in <tt>eval()</tt></h3><tt>eval()</tt> can be called either <i>directly</i> (via a real function call) or <i>indirectly</i> (via some other means). The details are explained <a href="http://speakingjs.com/es5/ch23.html#_indirect_eval_evaluates_in_global_scope">here</a>.<p>If <tt>eval()</tt> is called indirectly, <tt>this</tt> refers to the <a href="http://speakingjs.com/es5/ch16.html#global_object">global object</a>:</p><pre class="repl hljs">    &gt; (0,eval)('this === window')<b>    true</b><b></b></pre>Otherwise, if <tt>eval()</tt> is called directly, <tt>this</tt> remains the same as in the surroundings of <tt>eval()</tt>. For example:<pre class="javascript hljs ">    <span class="hljs-comment">// Real functions</span>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class= "hljs-title">sloppyFunc</span><span class="hljs-params">()</span> {</span>        console.log(<span class="hljs-built_in">eval</span>(<span class="hljs-string">'this'</span>) === window); <span class="hljs-comment">// true</span>    }    sloppyFunc();    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">strictFunc</span><span class="hljs-params">()</span> {</span><span class="hljs-pi">        'use strict'</span>;        console.log(<span class="hljs-built_in">eval</span>(<span class="hljs-string">'this'</span> ) === <span class="hljs-literal">undefined</span>); <span class="hljs-comment">// true</span>    }    strictFunc();    <span class="hljs-comment">// Constructors</span>    <span class= "hljs-keyword">var</span> savedThis;    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Constr</span><span class="hljs-params">()</span> { </span>        savedThis = <span class="hljs-built_in">eval</span>(<span class="hljs-string">'this'</span>);    }    <span class="hljs-keyword">var</span> inst = <span class="hljs-keyword" >new</span> Constr();    console.log(savedThis === inst); <span class="hljs-comment">// true</span>    <span class="hljs-comment">// Methods</span>    <span class="hljs-keyword">var</span> obj = {        method: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> {</span>            console.log(<span class= "hljs-built_in">eval</span>(<span class="hljs-string">'this'</span>) === obj); <span class="hljs-comment">// true</span>        }    }    obj.method();</pre><h3><tt>this</tt>-related pitfalls</h3>There are three <tt>this</tt>-related pitfalls that you should be aware of. Note that in each case, <a href="http://speakingjs.com/es5/ch07.html#strict_mode">strict mode</a> makes things safer, because <tt>this</tt> is <tt>undefined</tt> in real functions and you get warnings when things go wrong.<h4>Pitfall: forgetting <tt>new</tt></h4>If you invoke a constructor and forget the <tt>new</tt> operator, you are accidently using it as a real function. Hence, <tt>this</tt> does not have the correct value. In sloppy mode, <tt>this</tt> is <tt>window</tt> and you'll create global variables:<pre class="javascript hljs ">    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Point </span><span class="hljs-params">(x, y)</span> {</span>        <span class="hljs-keyword">this</span>.x = x;        <span class="hljs-keyword">this</span>.y = y;    }    <span class= "hljs-keyword">var</span> p = Point(<span class="hljs-number">7</span>, <span class="hljs-number">5</span>); <span class="hljs-comment">// we forgot new!</span>    console.log(p === <span class="hljs-literal">undefined</span>); <span class="hljs-comment">// true</span>    <span class="hljs-comment">// Global variables have been created:</span>    console.log(x); <span class ="hljs-comment">// 7</span>    console.log(y); <span class="hljs-comment">// 5</span></pre>Thankfully, you get a warning in strict mode (<tt>this === undefined</tt>):<pre class= "javascript hljs ">    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Point</span><span class="hljs-params">(x, y)</span> {</span><span class="hljs-pi">        'use strict'</span>;        <span class="hljs-keyword">this</span>.x = x;        <span class="hljs-keyword">this</span>.y = y;    }    <span class="hljs-keyword"> var</span> p = Point(<span class="hljs-number">7</span>, <span class="hljs-number">5</span>);    <span class="hljs-comment">// TypeError: Cannot set property 'x' of undefined </span></pre><h4>Pitfall: extracting methods improperly</h4>If you retrieve the value of a method (instead of invoking it), you turn the method into a function. Calling the value results in a function call, not a method call. This kind of extraction can happen when you pass a method as an argument for a function or method call. Real-world examples include <tt>setTimeout() </tt> and registering event handlers. I'll use the function <tt>callIt()</tt> to simulate this use case synchronously:<pre class="javascript hljs ">    <span class="hljs-comment">/** Similar to setTimeout() and setImmediate() */</span>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">callIt</span><span class= "hljs-params">(func)</span> {</span>        func();    }</pre>If you call a sloppy-mode method as a function, <tt>this</tt> refers to the <a href=" http://speakingjs.com/es5/ch16.html#global_object">global object</a> and global variables will be created:<pre class="javascript hljs ">    <span class="hljs-keyword">var</span> counter = {        count: <span class="hljs-number">0</span>,        <span class="hljs-comment">// Sloppy-mode method</span>        inc: <span class="hljs-function"><span class="hljs-keyword"> function</span> <span class="hljs-params">()</span> {</span>            <span class="hljs-keyword">this</span>.count++;        }    }    callIt(counter.inc);    <span class="hljs-comment"> // Didn't work:</span>    console.log(counter.count); <span class="hljs-comment">// 0</span>    <span class="hljs-comment">// Instead, a global variable has been created</span>    <span class="hljs-comment">// (NaN is result of applying ++ to undefined):</span>    console.log(count);  <span class="hljs-comment">// NaN</span></pre>If you call a strict-mode method as a function, <tt>this</tt> is <tt>undefined</tt>. Things don't work, either. But at least you get a warning:<pre class="javascript hljs ">    <span class="hljs-keyword">var</span> counter = {        count: <span class="hljs-number">0</span>,        <span class="hljs-comment">// Strict-mode method</span>        inc: <span class="hljs-function"><span class="hljs-keyword"> function</span> <span class="hljs-params">()</span> {</span><span class="hljs-pi">            'use strict'</span>;            <span class="hljs-keyword">this</span>.count++;        } }    callIt(counter.inc);    <span class="hljs-comment">// TypeError: Cannot read property 'count' of undefined</span>    console.log(counter.count);</pre>The fix is to use <a href=" http://speakingjs.com/es5/ch17.html#Function.prototype.bind"><tt>bind()</tt></a>:<pre class="javascript hljs ">    <span class="hljs-keyword">var</span> counter = {        count: <span class="hljs-number">0</span>,        inc: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> {</span>            <span class= "hljs-keyword">this</span>.count++;        }    }    callIt(counter.inc.bind(counter));    <span class="hljs-comment">// It worked!</span>    console.log(counter.count); <span class= "hljs-comment">// 1</span></pre><tt>bind()</tt> created a new function that always receives a <tt>this</tt> whose value is <tt>counter</tt>.<h4>Pitfall: shadowing <tt>this</tt></h4>When you use a real function inside a method, it is easy to forget that the former has its own <tt>this</tt> (even though it has no need for it). Therefore, you can't refer from the former to the method's <tt>this</tt>, because it is shadowed. Let's look at an example where things go wrong:<pre class="javascript hljs ">    <span class="hljs-keyword">var</span> obj = { name: <span class="hljs-string">'Jane'</span>,        friends: [ <span class="hljs-string">'Tarzan'</span>, <span class="hljs-string">'Cheeta'</span> ],        loop: <span class= "hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> {</span><span class="hljs-pi">            'use strict'</span>;            <span class= "hljs-keyword">this</span>.friends.forEach(                <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(friend)</span> {</span> console.log(<span style="background:PaleGreen"><span class="hljs-keyword">this</span>.name</span>+<span class="hljs-string">' knows '</span>+friend); }            );        }    };    obj.loop();    <span class="hljs-comment">// TypeError: Cannot read property 'name' of undefined</span></pre>In the previous example, <tt>this.name</tt> fails, because the function's <tt>this</tt> is <tt>undefined</tt>, it is not the same as the <tt>this</tt> of the method <tt>loop()</tt>. There are three ways to fix ... this.<p><b>Fix 1: </b> <tt>that = this</tt>. Assign <tt>this</tt> to a variable that isn't shadowed (another popular name is <tt>self</tt>) and use that one.</p><pre class="javascript hljs ">    loop: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> {</span><span class="hljs-pi">        'use strict'</span>;        <span class= "hljs-keyword">var</span> <span style="background:PaleGreen">that</span> = <span class="hljs-keyword">this</span>;        <span class="hljs-keyword">this</span>.friends.forEach(<span class ="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(friend)</span> {</span>            console.log(<span style="background:PaleGreen">that</span>.name+ <span class="hljs-string">' knows '</span>+friend);        });    }</pre><p><b>Fix 2:</b> <tt>bind()</tt>. Use <tt>bind()</tt> to create a function whose <tt>this</tt> always has the correct value (the method's <tt>this</tt> in the following example).</p><pre class="javascript hljs ">    loop: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> {</span><span class="hljs-pi">        'use strict'</span>;        <span class="hljs-keyword">this</span>.friends.forEach(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(friend)</span> {</span>            console.log(<span class="hljs-keyword">this</span>.name+<span class="hljs-string">' knows '</span>+friend);        }<span style="background:PaleGreen">.bind(<span class="hljs-keyword">this</span>)</span>);    }</pre><p><b>Fix 3:</b> <tt>forEach</tt>'s second parameter. This method has a second parameter whose value is passed to the callback as <tt>this</tt>.</p><pre class="javascript hljs ">    loop: <span class="hljs-function"><span class="hljs-keyword" >function</span> <span class="hljs-params">()</span> {</span><span class="hljs-pi">        'use strict'</span>;        <span class="hljs-keyword">this</span>.friends.forEach(<span class= "hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(friend)</span> {</span>            console.log(<span class="hljs-keyword">this</span>.name+<span class ="hljs-string">' knows '</span>+friend);        }<span style="background:PaleGreen">, <span class="hljs-keyword">this</span></span>);    }</pre><h3>Best practices</h3>Conceptually, I think of real functions as not having their own <tt>this</tt> and think of the aforementioned fixes as keeping up that illusion. ECMAScript 6 supports this approach via <a href=" http://www.2ality.com/2012/04/arrow-functions.html"><i>arrow functions</i></a> – functions without their own <tt>this</tt>. Inside such functions, you can freely use <tt>this</tt>, because there is no shadowing:<pre class="javascript hljs ">    loop: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> { </span><span class="hljs-pi">        'use strict'</span>;        <span class="hljs-comment">// The parameter of forEach() is an arrow function</span>        <span class="hljs-keyword">this </span>.friends.forEach(friend =&gt; {            <span class="hljs-comment">// `this` is loop's `this`</span>            console.log(<span class="hljs-keyword">this</span>.name+<span class="hljs-string">' knows '</span>+friend);        });    }</pre>I don't like APIs that use <tt>this</tt> as an additional parameter of real functions:<pre class="javascript hljs "> beforeEach(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> {</span>        <span style="background:PaleGreen"><span class= "hljs-keyword">this</span></span>.addMatchers({            toBeInRange: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(start, end)</span> {</span>                ...            }        });    });</pre>Turning such an implicit parameter into an explicit one makes things more obvious and is compatible with arrow functions. <pre class="javascript hljs ">    beforeEach(<span style="background:PaleGreen">api</span> =&gt; {        <span style="background:PaleGreen">api</span>.addMatchers({ toBeInRange(start, end) {                ...            }        });    });</pre><div style="clear: both;"></div></div></div>			</div>		<!--========================= END : POST		=============================-->		<!--=========================			START : POST		=============================-->		<div class="post-wrapper"> <h1>The Vital Guide to JavaScript Interviewing</h1>			<div data-role="content"><style>.guideQuestion{  color: #2557a1;  font-style: italic;  font-weight: bold;}</style><h3 id="the-challenge">The Challenge</h3><p>In today's technology landscape, JavaScript has essentially become synonymous with client-side web development and now, with the advent of technologies like Node.js, JavaScript is becoming a dominant server side technology as well.</p><p>Accordingly, resumes that reference at least some degree of JavaScript experience have essentially become universal in the software development community.  This makes locating JavaScript developers fairly easy, but makes sifting through them to find "the elite few" that much more of a challenge.  Finding them requires a highly-effective recruiting process, as described in our post <em><a href=" http://www.toptal.com/freelance/in-search-of-the-elite-few-finding-and-hiring-the-best-developers-in-the-industry">In Search of the Elite Few – Finding and Hiring the Best Developers in the Industry</a></em>.  Such a process can then be augmented with questions – such as those presented herein – to identify those sparsely distributed candidates across the globe who are true JavaScript experts.</p><h3 id="yeah-i-know-javascript">Yeah, I know JavaScript...</h3><p>As with any technology, there's knowing JavaScript and then there's <em>really</em> knowing JavaScript.  In our search for true masters of the language, we require an interview process that can accurately quantify a candidate's position along the continuum of JavaScript expertise levels.</p><p>Toward that goal, this post offers a sampling of questions that are key to evaluating the breadth and depth of a candidate's mastery of JavaScript.  It is important to bear in mind, though, that these sample questions are intended merely as a guide.  Not every "A" candidate worth hiring will be able to properly answer them all, nor does answering them all guarantee an "A" candidate.  At the end of the day, hiring remains as much of an art as it does a science.</p><h3 id="assessing-the-foundation">Assessing the Foundation </h3><div class="pop_out_box is-full_width is-big" style="font-style:italic;">It's far too common to encounter 'experienced' JavaScript developers whose grasp of the fundamentals of the language is either weak or confused.</div><p>JavaScript is a prototype-based scripting language with dynamic typing.  JavaScript can, at first, be a bit confusing for developers experienced in class-based languages (such as Java or C++), as it is dynamic and does not provide a traditional class implementation.  It's therefore far too common to encounter 'experienced' JavaScript developers whose grasp of the fundamentals of the language is either weak or confused.</p><p>Questions that can help assess a developer's grasp of JavaScript fundamentals, including some of its more subtle nuances, are therefore an important component of the interview process.  Here are some examples...</p><p><span class="guideQuestion">Q: Describe inheritance and the prototype chain in JavaScript.  Give an example.</span></p><p>Although JavaScript is an object-oriented language, it is prototype-based and does not implement a traditional class-based inheritance system.</p><p>In JavaScript, each object internally references another object, called its <em>prototype</em>.  That prototype object, in turn, has a reference to its prototype object, and so on.  At the end of this prototype chain is an object with null as its prototype.  The prototype chain is the mechanism by which inheritance – <em> prototypal inheritance</em> to be precise – is achieved in JavaScript.  In particular, when a reference is made to a property that an object does not itself contain, the prototype chain is traversed until the referenced property is found (or until the end of the chain is reached, in which case the property is undefined).</p><p>Here's a simple example:</p><pre lang= "javascript"><code class="language-javascript hljs "><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Animal</span><span class="hljs-params"> ()</span> {</span> <span class="hljs-keyword">this</span>.eatsVeggies = <span class="hljs-literal">true</span>; <span class="hljs-keyword">this</span>.eatsMeat = <span class="hljs-literal" >false</span>; }<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Herbivore</span><span class="hljs-params">()</span> {</span> }Herbivore.prototype = <span class="hljs-keyword">new</span> Animal();<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Carnivore</span><span class="hljs-params">()</span> {</span> <span class="hljs-keyword">this</span>.eatsMeat = <span class="hljs-literal">true</span>; }Carnivore.prototype = <span class="hljs-keyword">new </span> Animal();<span class="hljs-keyword">var</span> rabbit = <span class="hljs-keyword">new</span> Herbivore();<span class="hljs-keyword">var</span> bear = <span class="hljs-keyword"> new</span> Carnivore();console.log(rabbit.eatsMeat);   <span class="hljs-comment">// logs "false"</span>console.log(bear.eatsMeat);     <span class="hljs-comment">// logs "true" </span></code></pre><p><span class="guideQuestion">Q: Compare and contrast objects and hashtables in JavaScript.<span class="guideQuestion"></span></span></p><p>This is somewhat of a trick question since, in JavaScript, objects essentially are hashtables; i.e., collections of name-value pairs.   In these name-value pairs, a crucial point to be aware of is that the names (a.k.a., keys) are always strings.  And that actually leads us to our next question...</p><p><span class="guideQuestion">Q: Consider the code snippet below (<a href=" http://bolinfest.com/javascript/misunderstood.html" target="_blank">source</a>).  What will the alert display?  Explain your answer.</span></p><pre lang="javascript"><code class= "language-javascript hljs "><span class="hljs-keyword">var</span> foo = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Object</span>();<span class="hljs-keyword">var </span> bar = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Object</span>();<span class="hljs-keyword">var</span> map = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Object</span>();map[foo] = <span class="hljs-string">"foo"</span>;map[bar] = <span class="hljs-string">"bar"</span>;alert(map[foo]);  <span class="hljs-comment">// what will this display??</span></code></pre><p><em>It is the rare candidate who will correctly answer that this alerts the string "bar".</em>  Most will mistakenly answer that it alerts the string "foo".  So let's understand why "bar" is indeed the correct, albeit surprising, answer...</p><p>As mentioned in the answer to the prior question, a JavaScript object is essentially a hashtable of name-value pairs where the names (i.e., keys) are strings.  And they are <em>always</em> strings.  In fact, when an object other than a string is used as a key in JavaScript, no error occurs; rather, JavaScript <em>silently</em> converts it to a string and uses that value as the key instead.  This can have surprising results, as the above code demonstrates.</p><p>To understand the above code snippet, one must first recognize that the <code>map</code> object shown does <em>not</em> map the object <code>foo</code> to the string "foo", nor does it map the object <code>bar</code> to the string "bar".  Since the objects <code>foo</code> and <code>bar</code> are not strings, when they are used as keys for <code>map </code>, JavaScript automatically converts the key values to strings using each object's <code>toString()</code> method.  And since neither <code>foo</code> nor <code>bar</code> defines its own custom <code>toString()</code> method, they both use the same default implementation.  That implementation simply generates the literal string "[object Object]" when it is invoked.  With this explanation in mind, let's re-examine the code snippet above, but this time with explanatory comments along the way:</p><pre lang="javascript"><code class= "language-javascript hljs "><span class="hljs-keyword">var</span> foo = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Object</span>();<span class="hljs-keyword">var </span> bar = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Object</span>();<span class="hljs-keyword">var</span> map = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Object</span>();map[foo] = <span class="hljs-string">"foo"</span>;    <span class="hljs-comment">// --&gt; map["[Object object]"] = "foo";</span>map[bar] = <span class="hljs-string">"bar"</span>;    <span class="hljs-comment">// --&gt; map["[Object object]"] = "bar";</span>                     <span class="hljs-comment">// NOTE: second mapping REPLACES first mapping!</span>alert(map[foo]);     <span class="hljs-comment">// --&gt; alert(map["[Object object]"]);</span>                     <span class="hljs-comment">// and since map["[Object object]"] = "bar",</span>                     <span class="hljs-comment">// this will alert "bar", not "foo"!!</span>                     <span class="hljs-comment">// SURPRISE! ;-)</span></code></pre><p><span class="guideQuestion">Q: Explain closures in JavaScript.  What are they?  What are some of their unique features?  How and why might you want to use them?  Provide an example.</span></p><p>A closure is a function, along with all variables or functions that were in-scope at the time that the closure was created.  In JavaScript, a closure is implemented as an "inner function"; i.e., a function defined within the body of another function.  Here is a simplistic example:</p><pre lang="javascript"><code class= "language-javascript hljs ">(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">outerFunc</span><span class="hljs-params">(outerArg)</span> { </span>  <span class="hljs-keyword">var</span> outerVar = <span class="hljs-number">3</span>;  (<span class="hljs-function"><span class="hljs-keyword">function</span> <span class= "hljs-title">middleFunc</span><span class="hljs-params">(middleArg)</span> {</span>    <span class="hljs-keyword">var</span> middleVar = <span class="hljs-number">4</span>;    (<span class ="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">innerFunc</span><span class="hljs-params">(innerArg)</span> {</span>      <span class="hljs-keyword"> var</span> innerVar = <span class="hljs-number">5</span>;      <span class="hljs-comment">// EXAMPLE OF SCOPE IN CLOSURE:</span>      <span class="hljs-comment">// Variables from innerFunc, middleFunc, and outerFunc,</span>      <span class="hljs-comment">// as well as the global namespace, are ALL in scope here.</span>      console.log(<span class="hljs-string"> "outerArg="</span>+outerArg+                  <span class="hljs-string">" middleArg="</span>+middleArg+                  <span class="hljs-string">" innerArg="</span>+innerArg+<span class= "hljs-string">"\n"</span>+                  <span class="hljs-string">" outerVar="</span>+outerVar+                  <span class="hljs-string">" middleVar="</span> +middleVar+                  <span class="hljs-string">" innerVar="</span>+innerVar);      <span class="hljs-comment">// --------------- THIS WILL LOG: ---------------</span>      <span class="hljs-comment">//    outerArg=123 middleArg=456 innerArg=789</span>      <span class="hljs-comment">//    outerVar=3 middleVar=4 innerVar=5</span>    })(<span class="hljs-number">789 </span>);  })(<span class="hljs-number">456</span>);})(<span class="hljs-number">123</span>);</code></pre><p>An important feature of closures is that an inner function still has access to the outer function's variables even <em>after</em> the outer function has returned.  This is because, when functions in JavaScript execute, they use the scope that was in effect <em>when they were created</em>.</p><p>A common point of confusion that this leads to, though, is based on the fact that the inner function accesses the values of the outer function's variables at the time it is <em>invoked</em> (rather than at the time that it was <em>created</em>).  To test the candidate's understanding of this nuance, present the following code snippet that dynamically creates five buttons and ask what will be displayed when the user clicks on the third button:</p><pre lang="javascript"><code class="language-javascript hljs "><span class= "hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">addButtons</span><span class="hljs-params">(numButtons)</span> {</span>  <span class="hljs-keyword">for </span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; numButtons; i++) {    <span class="hljs-keyword">var</span> button = document.createElement( <span class="hljs-string">'input'</span>);    button.type = <span class="hljs-string">'button'</span>;    button.value = <span class="hljs-string">'Button '</span> + (i + <span class= "hljs-number">1</span>);    button.onclick = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>      alert(<span class= "hljs-string">'Button '</span> + (i + <span class="hljs-number">1</span>) + <span class="hljs-string">' clicked'</span>);    };    document.body.appendChild(button); document.body.appendChild(document.createElement(<span class="hljs-string">'br'</span>));  }}window.onload = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span> addButtons(<span class="hljs-number">5</span>); };</code></pre><p>Many will mistakenly answer that "Button 3 clicked" will be displayed when the user clicks on the third button.  In fact, the above code contains a bug (based on a misunderstanding of the way closures work) and "Button 6 clicked" will be displayed when the user clicks on <em>any</em> of the five buttons.  This is because, at the point that the onclick method is <em>invoked</em> (for <em>any</em> of the buttons), the for loop has already completed and the variable <code>i</code> already has a value of 5.</p><p>An important follow-up question is to ask the candidate how to fix the bug in the above code, so as to produce the expected behavior (i.e., so that clicking on button n will display "Button n clicked").  The correct answer, which demonstrates proper use of closures, is as follows:</p><pre lang= "javascript"><code class="language-javascript hljs "><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">addButtons</span><span class= "hljs-params">(numButtons)</span> {</span>  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; numButtons; i++) {    <span class="hljs-keyword">var</span> button = document.createElement(<span class="hljs-string">'input'</span>);    button.type = <span class="hljs-string">'button'</span>; button.value = <span class="hljs-string">'Button '</span> + (i + <span class="hljs-number">1</span>);    <span class="hljs-comment">// HERE'S THE FIX:</span>    <span class="hljs-comment"> // Employ the Immediately-Invoked Function Expression (IIFE)</span>    <span class="hljs-comment">// pattern to achieve the desired behavior:</span>    button.onclick = <span class= "hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(buttonIndex)</span> {</span>      <span class="hljs-keyword">return</span> <span class="hljs-function" ><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>        alert(<span class="hljs-string">'Button '</span> + (buttonIndex + <span class="hljs-number">1 </span>) + <span class="hljs-string">' clicked'</span>);      };    }(i);    document.body.appendChild(button);    document.body.appendChild(document.createElement(<span class= "hljs-string">'br'</span>));  }}window.onload = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span> addButtons(<span class= "hljs-number">5</span>); };</code></pre><p>Although by no means exclusive to JavaScript, closures are a particularly useful construct for many modern day JavaScript programming paradigms.  They are used extensively by some of the most popular JavaScript libraries, such as jQuery and Node.js.</p><h3 id="embracing-diversity">Embracing Diversity</h3><div class= "pop_out_box is-full_width is-big" style="font-style:italic;">JavaScript accommodates an unusually wide array of programming techniques and design patterns.  A JavaScript master will be well aware of the significance and ramifications of choosing one approach vs. another.</div><p>A multi-paradigm language, JavaScript supports object-oriented, imperative, and functional programming styles.  As such, JavaScript accommodates an unusually wide array of programming techniques and design patterns.  A JavaScript master will be well aware of the existence of these alternatives and, more importantly, the significance and ramifications of choosing one approach over another.  Here are a couple of sample questions that can help gauge this dimension of a candidate's expertise:</p><p><span class="guideQuestion">Q: Describe the different ways of creating objects and the ramifications of each.  Provide examples.</span></p><p> The graphic below contrasts various ways in JavaScript to create objects and the differences in the prototype chains that result from each.</p><p><img src=" http://assets.toptal.io/uploads/blog/image/392/toptal-blog-image-1399822383211.png" alt=""></p><p><span class="guideQuestion">Q: Is there ever any practical difference between defining a function as a function expression (e.g., <code>var foo = function(){}</code>) or as a function statement (e.g., <code>function foo(){}</code>)?  Explain your answer.</span></p><p>Yes, there is a difference, based on how and when the value of the function is assigned.</p><p>When a function statement (e.g., <code>function foo(){}</code>) is used, the function <code>foo </code> may be referenced before it has been defined, through a technique known as "hoisting".  A ramification of hoisting is that the last definition of the function is the one that will be employed, regardless of when it is referenced (if that's not clear, the example code below should help clarify things).</p><p>In contrast, when a function expression (e.g., <code>var foo = function(){}</code>) is used, the function <code>foo</code> may not be referenced before it is defined, just like any other assignment statement.  Because of this, the most recent definition of the function is the one that will be employed (and accordingly, the definition must precede the reference, or the function will be undefined).</p><p>Here's a simple example that demonstrates the practical difference between the two.  Consider the following code snippet:</p><pre lang="javascript"><code class="language-javascript hljs "><span class= "hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">foo</span><span class="hljs-params">()</span> {</span> <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>; }alert(foo());   <span class="hljs-comment">// what will this alert?</span><span class="hljs-function"><span class="hljs-keyword">function</span> <span class= "hljs-title">foo</span><span class="hljs-params">()</span> {</span> <span class="hljs-keyword">return</span> <span class="hljs-number">2</span>; }</code></pre><p>Many JavaScript developers will mistakenly answer that the above alert will display "1" and will be surprised to learn that it will in fact display "2".  As described above, this is due to hoisting. Since a function statement was used to define the function, the last definition of the function is the one that is hoisted at the time it is invoked (even though it is subsequent to its invocation in the code!).</p><p>Now consider the following code snippet:</p><pre lang="javascript"><code class="language-javascript hljs "><span class="hljs-keyword">var</span> foo = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span> <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>; }alert(foo());   <span class="hljs-comment">// what will this alert?</span>foo = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> { </span> <span class="hljs-keyword">return</span> <span class="hljs-number">2</span>; }</code></pre><p>In this case, the answer is more intuitive and the alert will display "1" as expected.  Since a function expression was employed to define the function, the most recent definition of the function is the one that is employed at the time it is invoked.</p><h3 id= "the-devils-in-the-details">The Devil's in the Details</h3><p>In addition to the advanced JavaScript concepts discussed thus far, there are a number of lower-level syntactical details of the language that a true JavaScript guru will be intimately familiar with.  Here are a few examples...</p><p><span class="guideQuestion">Q: What is the significance of, and reason for, wrapping the entire content of a JavaScript source file in a function block?</span></p><p>This is an increasingly common practice, employed by many popular JavaScript libraries (jQuery, Node.js, etc.).  This technique creates a closure around the entire contents of the file which, perhaps most importantly, creates a private namespace and thereby helps avoid potential name clashes between different JavaScript modules and libraries.</p><p>Another feature of this technique is to allow for an easily referenceable (presumably shorter) alias for a global variable.  This is often used, for example, in jQuery plugins.  jQuery allows you to disable the <code>$</code> reference to the jQuery namespace, using <code>jQuery.noConflict()</code>. If this has been done, your code can still use $ employing this closure technique, as follows:</p><pre lang="javascript"><code class="language-javascript hljs ">(<span class= "hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">($)</span> {</span> <span class="hljs-comment">/* jQuery plugin code referencing $ */</span> } )(jQuery);</code></pre><p><span class="guideQuestion">Q: What is the difference between <code>==</code> and <code>===</code>?  Between <code>!=</code> and <code>!==</code>?  Give an example.</span></p><p>The difference between "triple" comparison operators (<code>===</code>, <code>!==</code>) and double comparison operators (<code>==</code>, <code>!=</code>) in JavaScript is that double comparison operators perform implicit type conversion on the operands before comparing them whereas, with the triple comparison operators, no type conversion is performed (i.e., the values must be equal and the types must be the same for the operands to be considered equal).</p><p>As a simple example, the expression <code>123 == '123'</code> will evaluate to true, whereas <code>123 === '123'</code> will evaluate to false.</p><p><span class="guideQuestion">Q: What is the significance of including <code>'use strict'</code> at the beginning of a JavaScript source file?</span></p><p>Though there is much more to be said on the topic, the short and most important answer here is that <code>use strict</code> is a way to voluntarily enforce stricter parsing and error handling on your JavaScript code at runtime.  Code errors that would otherwise have been ignored or would have failed silently will now generate errors or throw exceptions.  In general, it is a good practice.</p><h3 id="wrap-up">Wrap Up</h3><p>JavaScript is perhaps one of the most misunderstood and underestimated programming languages in existence today.  The more one peels the JavaScript onion, the more one realizes what is possible.  Accordingly, finding true masters of the language is a challenge.  We hope you find the questions presented in this post to be a useful foundation for "separating the wheat from the chaff" in your quest for the "elite few" among JavaScript developers.</p></div>			</div>		<!--=========================			END : POST		=============================-->		<!--=========================			START : POST		=============================-->		<div class="post-wrapper"><div class="post">        <h1 class="post-title">Dealing with the Dangers of `this` in Constructors</h1> <p><i>                Originally published in the                <a href="/">A Drip of JavaScript newsletter</a>.            </i></p>        <p>As I mentioned in the <a href= "/blog/drips/constructors-in-javascript">last issue</a>, invoking a constructor without <code>new</code> can be dangerous. Let's go over why.</p><div class="highlight"><pre><code class= "language-javascript" data-lang="javascript"><span class="kd">function</span> <span class="nx">Color</span><span class="p">(</span><span class="nx">r</span><span class="p">,</span> <span class="nx">g</span><span class="p">,</span> <span class="nx">b</span><span class="p">)</span> <span class="p">{</span>    <span class="k">this</span><span class="p">.</span><span class= "nx">r</span> <span class="o">=</span> <span class="nx">r</span><span class="p">;</span>    <span class="k">this</span><span class="p">.</span><span class="nx">g</span> <span class="o">= </span> <span class="nx">g</span><span class="p">;</span>    <span class="k">this</span><span class="p">.</span><span class="nx">b</span> <span class="o">=</span> <span class="nx">b </span><span class="p">;</span><span class="p">}</span><span class="c1">// Safe invocation</span><span class="kd">var</span> <span class="nx">red</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Color</span><span class="p">(</span><span class="mi">255</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class= "mi">0</span><span class="p">);</span><span class="c1">// Dangerous invocation</span><span class="kd">var</span> <span class="nx">blue</span> <span class="o">=</span> <span class="nx"> Color</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">); </span></code></pre></div><p>When a constructor is invoked with the <code>new</code> keyword, the <code>this</code> value of the constructor is set to the new object that you are creating. But when a constructor is invoked like a normal function, its <code>this</code> defaults to the same <code>this</code> variable that any other function gets. And normally that is the global object (<code>window</code> in the browser.)</p><p>Here is an illustration of the problem.</p><div class="highlight"><pre><code class="language-javascript" data-lang= "javascript"><span class="c1">// Global variable</span><span class="nx">r</span> <span class="o">=</span> <span class="s2">"Rodent Of Unusual Size"</span><span class="p">;</span><span class="kd">function</span> <span class="nx">Color</span><span class="p">(</span><span class="nx">r</span><span class="p">,</span> <span class="nx">g</span><span class="p">,</span> <span class="nx">b</span><span class="p">)</span> <span class="p">{</span>    <span class="k">this</span><span class="p">.</span><span class="nx">r</span> <span class="o">=</span> <span class= "nx">r</span><span class="p">;</span>    <span class="k">this</span><span class="p">.</span><span class="nx">g</span> <span class="o">=</span> <span class="nx">g</span><span class="p">; </span>    <span class="k">this</span><span class="p">.</span><span class="nx">b</span> <span class="o">=</span> <span class="nx">b</span><span class="p">;</span><span class="p">} </span><span class="c1">// Dangerous invocation</span><span class="c1">// Means `this` is the global object</span><span class="kd">var</span> <span class="nx">blue</span> <span class="o">= </span> <span class="nx">Color</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">255 </span><span class="p">);</span><span class="c1">// Outputs: 0</span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class= "nx">r</span><span class="p">);</span><span class="c1">// Outputs: undefined</span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">( </span><span class="nx">blue</span><span class="p">);</span></code></pre></div><p>In the example above, there is a global variable named <code>r</code>. Or to put it another way, the global object has a property named <code>r</code>. When the <code>Color</code> constructor is invoked without <code>new</code>, the constructor's <code>this</code> is set to the global object (in most cases). Which means that the constructor function has just overwritten the global <code>r</code> variable with something that was intended to be a property of the <code> blue</code> object.</p><p>Furthermore, because <code>Color</code> was invoked as an ordinary function, it didn't automatically return a new object, which means that <code>blue</code> is also undefined.</p><p>As you can imagine, debugging an issue like this can be time consuming and frustrating. So how do we prevent these sorts of problems? Fortunately the answer is pretty straightforward.</p><div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="c1">// Global variable</span><span class="nx">r</span> <span class="o">=</span> <span class="s2">"Rodent Of Unusual Size"</span><span class="p">;</span><span class="kd">function</span> <span class="nx">Color</span><span class="p">(</span><span class ="nx">r</span><span class="p">,</span> <span class="nx">g</span><span class="p">,</span> <span class="nx">b</span><span class="p">)</span> <span class="p">{</span>    <span class="c1">// Check whether `this` is a</span>    <span class="c1">// `Color` object.</span>    <span class="k">if</span> <span class="p">(</span><span class="k">this</span> <span class="k">instanceof </span> <span class="nx">Color</span><span class="p">)</span> <span class="p">{</span>        <span class="k">this</span><span class="p">.</span><span class="nx">r</span> <span class="o">= </span> <span class="nx">r</span><span class="p">;</span>        <span class="k">this</span><span class="p">.</span><span class="nx">g</span> <span class="o">=</span> <span class="nx">g </span><span class="p">;</span>        <span class="k">this</span><span class="p">.</span><span class="nx">b</span> <span class="o">=</span> <span class="nx">b</span><span class="p">; </span>    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>        <span class="c1">// If not, then we should invoke</span>        <span class="c1">// the constructor correctly.</span>        <span class="k">return</span> <span class="k">new</span> <span class="nx">Color</span><span class="p">(</span><span class="nx">r</span><span class="p"> ,</span> <span class="nx">g</span><span class="p">,</span> <span class="nx">b</span><span class="p">);</span>    <span class="p">}</span><span class="p">}</span><span class="c1">// Dangerous invocation</span><span class="c1">// Means `this` is the global object</span><span class="kd">var</span> <span class="nx">blue</span> <span class="o">=</span> <span class="nx"> Color</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">); </span><span class="c1">// Outputs: "Rodent Of Unusual Size"</span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class= "nx">r</span><span class="p">);</span><span class="c1">// Outputs: Color {r: 0, g: 0, b: 255}</span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">blue</span><span class="p">);</span></code></pre></div><p>In the updated <code>Color</code> constructor, the first thing we do is check whether <code> this</code> is an instance of <code>Color</code>. It works because the <code>new</code> keyword will have already created the new object as an instance of the constructor before the constructor function begins running.</p><p>If it isn't a <code>Color</code> object, then we know the constructor was invoked incorrectly, so we skip all the construction logic and have <code>Color</code> return the results of correctly invoking itself with <code>new</code>.</p><p>This means that the constructor is no longer in danger of clobbering the global object's properties.</p><p>Of course, using this approach also means that developers may get into the bad habit of invoking constructors without <code>new</code>. If you'd rather just force them to always use <code>new</code>, you could throw an error instead, like so:</p><div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">function </span> <span class="nx">Color</span><span class="p">(</span><span class="nx">r</span><span class="p">,</span> <span class="nx">g</span><span class="p">,</span> <span class="nx">b </span><span class="p">)</span> <span class="p">{</span>    <span class="c1">// Check whether `this` is a</span>    <span class="c1">// `Color` object.</span>    <span class="k">if</span> <span class="p">(</span><span class="k">this</span> <span class="k">instanceof</span> <span class="nx">Color</span><span class="p">)</span> <span class="p">{</span>        <span class="k"> this</span><span class="p">.</span><span class="nx">r</span> <span class="o">=</span> <span class="nx">r</span><span class="p">;</span>        <span class="k">this</span><span class="p">. </span><span class="nx">g</span> <span class="o">=</span> <span class="nx">g</span><span class="p">;</span>        <span class="k">this</span><span class="p">.</span><span class="nx">b </span> <span class="o">=</span> <span class="nx">b</span><span class="p">;</span>    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>        <span class="c1"> // If not, throw error.</span>        <span class="k">throw</span> <span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="s2">"`Color` invoked without `new`"</span><span class="p">);</span>    <span class="p">}</span><span class="p">}</span></code></pre></div><p>And that's how you can make your custom constructors safely deal with a missing <code>new</code> keyword.</p><p>Josh Clanton</p>    </div>			</div>		<!--=========================			END : POST		=============================--> <!--=========================			START : POST		=============================-->		<div class="post-wrapper"><div class="post">        <h1 class="post-title"> Constructors in JavaScript</h1>            <p><i>                Originally published in the                <a href="/">A Drip of JavaScript newsletter</a>.            </i></p>        <p> Despite the fact that they are very powerful, constructors are one of the most underused features of JavaScript. (Probably because they have a <a href="http://crockford.com/">very influential detractor</a>.) But if you want to really know JavaScript, you'll need to learn how they work.</p><p>What is a constructor? It's an ordinary function that is used with the <code>new</code> operator to produce a specialized type of object.</p><div class="highlight"><pre><code class="language-text" data-lang="text">```javascript// `Color` is a constructorvar red = new Color(255, 0, 0);</code></pre></div><p>In this example, red is a new "Color" object. But how does that work?</p><div class="highlight"><pre><code class="language-text" data-lang= "text">```javascriptfunction Color(r, g, b) {    this.r = r;    this.g = g;    this.b = b;}var red = new Color(255, 0, 0);</code></pre></div><p>As you can see, the Color constructor is merely taking the arguments given to it and attaching them to the <code>this</code> object. That's because when the constructor is invoked by <code>new</code>, the constructor's <code>this </code> is set to the object that <code>new</code> will return.</p><p>Which means that the code above is roughly equivalent to:</p><div class="highlight"><pre><code class= "language-javascript" data-lang="javascript"><span class="kd">var</span> <span class="nx">red</span> <span class="o">=</span> <span class="p">{</span>    <span class="nx">r</span><span class="o">:</span> <span class="mi">255</span><span class="p">,</span>    <span class="nx">g</span><span class="o">:</span> <span class="mi">0</span><span class="p">,</span>    <span class ="nx">b</span><span class="o">:</span> <span class="mi">0</span><span class="p">};</span></code></pre></div><p>So why would we use a constructor? There are a couple of important reasons. </p><p>First, using a constructor means that all of these objects will be created with the same basic structure, and we are less likely to accidentally make a mistake than if we were creating a whole bunch of generic objects by hand. (Especially if we make the constructor throw errors on invalid input.)</p><p>Second, using a constructor means that the object is explicitly marked as an instance of <code>Color</code>.</p><div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">var</span> <span class="nx" >red</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Color</span><span class="p">(</span><span class="mi">255</span><span class="p">,</span> <span class="mi">0 </span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span><span class="kd">var</span> <span class="nx">blue</span> <span class="o">=</span> <span class="p">{</span> <span class="nx">r</span><span class="o">:</span> <span class="mi">255</span><span class="p">,</span> <span class="nx">g</span><span class="o">:</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">b</span><span class="o">:</span> <span class="mi">0</span> <span class="p">};</span><span class="c1">// Outputs: true</span><span class="nx">console </span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">red</span> <span class="k">instanceof</span> <span class="nx">Color</span><span class="p" >);</span><span class="c1">// Outputs: false</span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">blue</span> <span class="k">instanceof</span> <span class="nx">Color</span><span class="p">);</span></code></pre></div><p>That gives us a means to ensure that we are receiving the correct type of data to process.</p><p>Third, using a constructor means that we can easily assign specialized methods to the constructor's prototype, and they will instantly be available to all objects created by the constructor.</p><div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">function</span> <span class="nx">Color</span><span class="p">(</span><span class="nx">r</span><span class="p">,</span> <span class="nx">g</span><span class="p">,</span> <span class="nx">b</span><span class="p">)</span> <span class="p">{ </span>    <span class="k">this</span><span class="p">.</span><span class="nx">r</span> <span class="o">=</span> <span class="nx">r</span><span class="p">;</span>    <span class="k">this </span><span class="p">.</span><span class="nx">g</span> <span class="o">=</span> <span class="nx">g</span><span class="p">;</span>    <span class="k">this</span><span class="p">. </span><span class="nx">b</span> <span class="o">=</span> <span class="nx">b</span><span class="p">;</span><span class="p">}</span><span class="nx">Color</span><span class="p">. </span><span class="nx">prototype</span><span class="p">.</span><span class="nx">getAverage</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>    <span class="kd">var</span> <span class="nx">total</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">r</span> <span class="o">+</span> <span class="k">this</span><span class="p">.</span><span class="nx">g</span> <span class="o">+</span> <span class="k">this</span><span class="p">.</span><span class= "nx">b</span><span class="p">;</span>    <span class="kd">var</span> <span class="nx">avg</span> <span class="o">=</span> <span class="nx">total</span> <span class="o">/</span> <span class ="mi">3</span><span class="p">;</span>    <span class="k">return</span> <span class="nb">parseInt</span><span class="p">(</span><span class="nx">avg</span><span class="p">,</span> <span class="mi">10</span><span class="p">);</span><span class="p">};</span><span class="kd">var</span> <span class="nx">red</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Color</span><span class="p">(</span><span class="mi">255</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class= "p">);</span><span class="kd">var</span> <span class="nx">white</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Color</span><span class="p">(</span><span class= "mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">);</span><span class="c1">// Outputs: 85</span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">red</span><span class="p">.</span><span class="nx">getAverage </span><span class="p">());</span><span class="c1">// Outputs: 255</span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">white</span><span class="p">.</span><span class="nx">getAverage</span><span class="p">());</span></code></pre></div><p>It is important to <strong>always</strong> use the new keyword when invoking the constructor. Otherwise the constructor may clobber the <code>this</code> which was accidentally passed to it. In most cases that is the global object (<code> window</code> in the browser or <code>global</code> in Node.)</p><p>Because of this danger, it is customary to capitalize a constructor's name so that others know to invoke it with <code> new</code>.</p><p>An upcoming article will deal with how to further mitigate the danger inherent in working with constructors.</p><p>Josh Clanton</p>    </div>			</div> <!--=========================			END : POST		=============================-->		<!--=========================			START : POST =============================-->		<div class="post-wrapper"><div class="post">        <h1 class="post-title">Transforming Arrays with Array#map</h1>            <p><i> Originally published in the                <a href="/">A Drip of JavaScript newsletter</a>.            </i></p>        <p>One of the most common tasks that developers perform in any language is taking an array of values and transforming those values. Up until recently, doing that in JavaScript took a fair bit of boilerplate code. For instance, here is some code for darkening RGB colors:</p><div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">var</span> <span class="nx">colors</span> <span class="o">= </span> <span class="p">[</span>    <span class="p">{</span><span class="nx">r</span><span class="o">:</span> <span class="mi">255</span><span class="p">,</span> <span class="nx">g </span><span class="o">:</span> <span class="mi">255</span><span class="p">,</span> <span class="nx">b</span><span class="o">:</span> <span class="mi">255</span> <span class="p">},</span> <span class="c1">// White</span>    <span class="p">{</span><span class="nx">r</span><span class="o">:</span> <span class="mi">128</span><span class="p">,</span> <span class="nx">g </span><span class="o">:</span> <span class="mi">128</span><span class="p">,</span> <span class="nx">b</span><span class="o">:</span> <span class="mi">128</span> <span class="p">},</span> <span class="c1">// Gray</span>    <span class="p">{</span><span class="nx">r</span><span class="o">:</span> <span class="mi">0</span><span class="p">,</span>   <span class="nx">g </span><span class="o">:</span> <span class="mi">0</span><span class="p">,</span>   <span class="nx">b</span><span class="o">:</span> <span class="mi">0</span>   <span class="p">}</span> <span class="c1">// Black</span><span class="p">];</span><span class="kd">var</span> <span class="nx">newColors</span> <span class="o">=</span> <span class="p">[];</span><span class="k"> for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i </span> <span class="o">&lt;</span> <span class="nx">colors</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++ </span><span class="p">)</span> <span class="p">{</span>    <span class="nx">transformed</span> <span class="o">=</span> <span class="p">{</span>        <span class="nx">r</span><span class="o">:</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">round</span><span class="p">(</span> <span class="nx">colors</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">r</span> <span class="o">/</span> <span class="mi">2</span> <span class="p">),</span>        <span class="nx">g</span><span class="o">:</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">round</span><span class="p">(</span> <span class="nx">colors</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">g</span> <span class="o">/</span> <span class="mi">2</span> <span class="p">),</span>        <span class="nx">b</span><span class="o">:</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">round</span><span class="p">(</span> <span class="nx">colors</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">b</span> <span class="o">/</span> <span class="mi">2</span> <span class="p">)</span>    <span class="p">};</span>    <span class="nx">newColors</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">transformed</span><span class="p">);</span><span class="p">} </span><span class="c1">// Outputs:</span><span class="c1">// [</span><span class="c1">//    {r: 128, g: 128, b: 128 },</span><span class="c1">//    {r: 64,  g: 64,  b: 64  },</span><span class="c1">//    {r: 0,   g: 0,   b: 0   }</span><span class="c1">// ];</span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">( </span><span class="nx">newColors</span><span class="p">);</span></code></pre></div><p>As you can see, there's quite a bit going on in that code that isn't really about what we want to accomplish, but is keeping track of trivial things like the current index and moving the values into the new array. What if we didn't have to do all of that?</p><p>Fortunately in ECMAScript 5 (the latest version of JavaScript), we don't. Here is the same example rewritten to take advantage of the <code>map</code> method:</p><div class="highlight"><pre><code class= "language-javascript" data-lang="javascript"><span class="kd">var</span> <span class="nx">newColors</span> <span class="o">=</span> <span class="nx">colors</span><span class="p">. </span><span class="nx">map</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">val</span><span class="p">)</span> <span class="p">{ </span>    <span class="k">return</span> <span class="p">{</span>        <span class="nx">r</span><span class="o">:</span> <span class="nb">Math</span><span class="p">.</span><span class= "nx">round</span><span class="p">(</span> <span class="nx">val</span><span class="p">.</span><span class="nx">r</span> <span class="o">/</span> <span class="mi">2</span> <span class="p">), </span>        <span class="nx">g</span><span class="o">:</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">round</span><span class="p">(</span> <span class="nx"> val</span><span class="p">.</span><span class="nx">g</span> <span class="o">/</span> <span class="mi">2</span> <span class="p">),</span>        <span class="nx">b</span><span class="o">: </span> <span class="nb">Math</span><span class="p">.</span><span class="nx">round</span><span class="p">(</span> <span class="nx">val</span><span class="p">.</span><span class="nx">b </span> <span class="o">/</span> <span class="mi">2</span> <span class="p">)</span>    <span class="p">};</span><span class="p">});</span></code></pre></div><p>Much nicer isn't it? Invoking <code>map</code> returns a new array created by running a transformation function over each element of the original array.</p><p>Now the only thing you need to keep track of is the logic of the transformation itself.</p><p>Of course, <code>map</code> isn't limited to simple transformations like this. Your function can also make use of two additional parameters, the current index and the array itself. Consider the following example:</p><div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">var</span> <span class="nx">starter</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">];</span><span class="kd">function</span> <span class="nx">multiplyByNext</span> <span class="p">(</span><span class="nx">val</span><span class="p">, </span> <span class="nx">index</span><span class="p">,</span> <span class="nx">arr</span><span class="p">)</span> <span class="p">{</span>    <span class="kd">var</span> <span class="nx"> next</span> <span class="o">=</span> <span class="nx">index</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>    <span class="c1">// If at the end of array </span>    <span class="c1">// use the first element</span>    <span class="k">if</span> <span class="p">(</span><span class="nx">next</span> <span class="o">===</span> <span class="nx"> arr</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span> <span class="p">{</span>        <span class="nx">next</span> <span class="o">=</span> <span class= "mi">0</span><span class="p">;</span>    <span class="p">}</span>    <span class="k">return</span> <span class="nx">val</span> <span class="o">*</span> <span class="nx">arr</span><span class="p">[</span><span class="nx">next</span><span class="p">];</span><span class="p">}</span><span class="kd">var</span> <span class="nx">transformed</span> <span class="o">=</span> <span class="nx">starter</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">multiplyByNext</span><span class="p">);</span><span class="c1"> // Outputs: [5, 25, 5]</span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">transformed</span><span class="p">); </span></code></pre></div><p>As you can see, the additional parameters make it easy to create transformation functions which use the array element's neighbors. This can be useful in implementing something like <a href="https://en.wikipedia.org/wiki/Conway's_Game_of_Life">Conway's Game of Life</a>.</p><p>Browser support for <code>map</code> is pretty good, but not universal. It isn't supported in IE 8 and below. You have a few options for dealing with this.</p><ol><li>Don't use <code>map</code>.</li><li>Use something like <a href=" https://github.com/kriskowal/es5-shim">es5-shim</a> to make older IE's support <code>map</code>.</li><li>Use the <code>_.map</code> method in <a href="http://underscorejs.org/#map"> Underscore</a> or <a href="http://lodash.com/docs#map">Lodash</a> for an equivalent utility function.</li></ol><p>One of the most powerful techniques for avoiding programming bugs is to reduce the number of things that you are keeping track of manually. Array's <code>map</code> method is one more tool to help you do exactly that.</p><p>Thanks for reading! If you enjoyed this article, consider sending it to a friend.</p><p>Josh Clanton</p>    </div>			</div>		<!--=========================			END : POST =============================-->		<!--=========================			START : POST		=============================-->		<div class="post-wrapper"><div class="post"> <h1 class="post-title">What is an Array?</h1>            <p><i>                Originally published in the                <a href="/">A Drip of JavaScript newsletter</a> .            </i></p>        <p>For an experienced developer, that question may seem simplistic, but in the case of JavaScript the answer is rather interesting.</p><p>Conceptually, an array is just a list of values which can be accessed by using an integer as the "key". The list starts at <code>0</code> and goes up from there. If we were to describe that with JavaScript's object notation, it would look like this:</p><div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="nx">fakeArray</span> <span class ="o">=</span> <span class="p">{</span>    <span class="mi">0</span><span class="o">:</span> <span class="s2">"value 1"</span><span class="p">,</span>    <span class="mi">1</span><span class="o">:</span> <span class="s2">"value 2"</span><span class="p">}</span></code></pre></div><p>I feel like we're missing something. Oh, I know. It's that pesky "length" property. </p><div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="nx">fakeArray</span> <span class="o">=</span> <span class="p">{</span>    <span class= "mi">0</span><span class="o">:</span> <span class="s2">"value 1"</span><span class="p">,</span>    <span class="mi">1</span><span class="o">:</span> <span class="s2">"value 2"</span><span class="p">,</span>    <span class="nx">length</span><span class="o">:</span> <span class="mi">2</span><span class="p">}</span></code></pre></div><p>That's looking suspiciously array-like. And, as <a href="/blog/drips/arbitrary-parameters-with-the-arguments-object">I've mentioned before</a>, this is precisely how the <code>arguments</code> object works. What I haven't mentioned yet is that this is also how real arrays work "under the hood".</p><p>That's right, in JavaScript arrays are just a specialized type of object built into the language. It's easy to tell this by looking at the behavior of objects and arrays.</p><div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="nx">fakeArray</span> <span class="o">=</span> <span class="p">{</span>    <span class="mi">0</span><span class="o">:</span> <span class="s2">"value 1"</span><span class="p">,</span>    <span class="mi">1 </span><span class="o">:</span> <span class="s2">"value 2"</span><span class="p">,</span>    <span class="nx">length</span><span class="o">:</span> <span class="mi">2</span><span class="p" >};</span><span class="c1">// Outputs "value 1"</span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">fakeArray </span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span><span class="nx">realArray</span> <span class="o">=</span> <span class="p">[</span><span class="s2"> "value 1"</span><span class="p">,</span> <span class="s2">"value 2"</span><span class="p">];</span><span class="nx">realArray</span><span class="p">.</span><span class="nx">text</span> <span class="o">=</span> <span class="s2">"some text"</span><span class="p">;</span><span class="c1">// Outputs "some text"</span><span class="nx">console</span><span class="p">. </span><span class="nx">log</span><span class="p">(</span><span class="nx">realArray</span><span class="p">.</span><span class="nx">text</span><span class="p">); </span></code></pre></div><p>As you can see, you can access an object's properties in exactly the same way as an array's. And you can give an array additional properties just like any other object.</p><p>What about all those special array methods like <code>indexOf</code>, <code>slice</code>, and <code>sort</code>? Turns out, they're just functions attached to the array object. (More specifically, they belong to the Array prototype, but that's getting ahead of ourselves.)</p><div class="highlight"><pre><code class="language-javascript" data-lang= "javascript"><span class="nx">realArray</span> <span class="o">=</span> <span class="p">[</span><span class="s2">"value 1"</span><span class="p">,</span> <span class="s2">"value 2" </span><span class="p">];</span><span class="c1">// Outputs "0"</span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class= "nx">realArray</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="s2">"value 1"</span><span class="p">));</span><span class="nx">realArray </span><span class="p">.</span><span class="nx">indexOf</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>    <span class= "k">return</span> <span class="s2">"I'll never tell."</span><span class="p">;</span><span class="p">};</span><span class="c1">// Outputs "I'll never tell."</span><span class="nx">console </span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">realArray</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">( </span><span class="s2">"value 1"</span><span class="p">));</span></code></pre></div><p>In fact, given enough time, it is possible to reimplement almost all of the native array functionality purely in terms of manipulating objects.</p><p>Here's an example of reimplementing the <code>push</code> method:</p><div class="highlight"><pre><code class= "language-javascript" data-lang="javascript"><span class="nx">fakeArray</span> <span class="o">=</span> <span class="p">{</span>    <span class="nx">length</span><span class="o">:</span> <span class="mi">0</span><span class="p">,</span>    <span class="nx">push</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">val </span><span class="p">)</span> <span class="p">{</span>        <span class="c1">// Place the new value into the</span>        <span class="c1">// next available integer key</span> <span class="k">this</span><span class="p">[</span><span class="k">this</span><span class="p">.</span><span class="nx">length</span><span class="p">]</span> <span class="o">=</span> <span class="nx">val</span><span class="p">;</span>        <span class="c1">// Update the length property</span>        <span class="k">this</span><span class="p">.</span><span class="nx">length </span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">length</span> <span class="o">+</span> <span class="mi">1</span><span class="p">; </span>        <span class="c1">// Return the updated length</span>        <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">length </span><span class="p">;</span>    <span class="p">}</span><span class="p">};</span><span class="nx">fakeArray</span><span class="p">.</span><span class="nx">push</span><span class="p">( </span><span class="s2">"first value"</span><span class="p">);</span><span class="nx">fakeArray</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="s2">"second value"</span><span class="p">);</span><span class="c1">// Outputs "first value"</span><span class="nx">console</span><span class="p">.</span><span class="nx">log </span><span class="p">(</span><span class="nx">fakeArray</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span><span class="c1">// Outputs "second value" </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">fakeArray</span><span class="p">[</span><span class="mi">1 </span><span class="p">]);</span></code></pre></div><p>The one important thing that can't be reimplemented is the convenient array literal syntax for creating arrays. (The square brackets.) But you can always use a constructor instead. In fact, the following two ways of creating an array are exactly equivalent.</p><div class="highlight"><pre><code class= "language-javascript" data-lang="javascript"><span class="nx">literalWay</span> <span class="o">=</span> <span class="p">[</span><span class="s2">"value 1"</span><span class="p">]; </span><span class="nx">constructorWay</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Array</span><span class="p">(</span><span class="s2">"value 1" </span><span class="p">);</span></code></pre></div><p>If you're willing to give up the literal syntax, you can rebuild the concept of arrays in JavaScript entirely from scratch to achieve something like this:</p><div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="nx">myCustomArray</span> <span class="o">=</span> <span class="k"> new</span> <span class="nx">CustomArray</span><span class="p">(</span><span class="s2">"value 1"</span><span class="p">);</span></code></pre></div><p>And now you know (if you didn't already) how arrays work in JavaScript.</p><p>If you have other subjects you'd like to see covered in the future, <a href="/drip-suggestions">drop me a suggestion</a>. Thanks for reading! </p><p>Josh Clanton</p>    </div>			</div>		<!--=========================			END : POST		=============================--> <!--=========================			START : POST		=============================-->		<div class="post-wrapper"><div class="post">        <h1 class="post-title">Reordering Arrays with Array#sort</h1>            <p><i>                Originally published in the                <a href="/">A Drip of JavaScript newsletter</a>.            </i></p>        <p>In <a href="/blog/drips/arbitrary-parameters-with-the-arguments-object">last week's issue</a> I briefly mentioned the standard <code>sort</code> method available on all JavaScript arrays. It does just what you'd expect.</p><div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="c1">// Produces [1, 2, 3]</span><span class="p">[ </span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">].</span><span class="nx">sort </span><span class="p">();</span><span class="c1">// Produces ["a", "b", "c"]</span><span class="p">[</span><span class="s2">"c"</span><span class="p">,</span> <span class="s2">"b" </span><span class="p">,</span> <span class="s2">"a"</span><span class="p">].</span><span class="nx">sort</span><span class="p">();</span><span class="c1">// Produces [1, 2, "a", "b"] </span><span class="p">[</span><span class="s2">"b"</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">"a"</span><span class="p">,</span> <span class="mi">1</span><span class="p">].</span><span class="nx">sort</span><span class="p">();</span></code></pre></div><p>As you can see, it sorts by dictionary order (numbers first, followed by letters). But what if you want to sort your array differently? For example, listing "better" cars first? How would you go about that? Fortunately, <code>sort</code> accepts a custom comparison function.</p><div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">var</span> <span class="nx">cars</span> <span class="o" >=</span> <span class="p">[</span>    <span class="s2">"Honda Civic"</span><span class="p">,</span>    <span class="s2">"Ford Taurus"</span><span class="p">,</span>    <span class="s2"> "Chevy Malibu"</span><span class="p">]</span><span class="nx">cars</span><span class="p">.</span><span class="nx">sort</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span> <span class="nx">b</span><span class="p">)</span> <span class="p">{</span>    <span class="c1">// Default to 0, which indicates</span>    <span class="c1">// no sorting is necessary</span>    <span class="kd">var</span> <span class="nx">returnVal</span> <span class="o">=</span> <span class="mi">0 </span><span class="p">;</span>    <span class="c1">// If `a` is a Chevy, subtract 1</span>    <span class="c1">// to move `a` "up" in the sort order</span>    <span class="c1">// because Chevys are awesome.</span>    <span class="k">if</span> <span class="p">(</span><span class="nx">a</span><span class="p">.</span><span class="nx">match</span><span class="p">(</span><span class="sr">/Chevy/</span><span class="p">))</span> <span class="p">{</span>        <span class="nx">returnVal</span> <span class="o">=</span> <span class="nx">returnVal</span> <span class= "o">-</span> <span class="mi">1</span><span class="p">;</span>    <span class="p">}</span>    <span class="c1">// If `b` is a Chevy, add 1</span>    <span class="c1">// to move `b` "up" in the sort order</span>    <span class="k">if</span> <span class="p">(</span><span class="nx">b</span><span class="p">.</span><span class="nx">match</span><span class="p">(</span><span class="sr">/Chevy/</span><span class="p">))</span> <span class="p">{</span>        <span class="nx">returnVal</span> <span class="o">=</span> <span class="nx">returnVal</span> <span class= "o">+</span> <span class="mi">1</span><span class="p">;</span>    <span class="p">}</span>    <span class="k">return</span> <span class="nx">returnVal</span><span class="p">;</span><span class="p">});</span><span class="c1">// Outputs:</span><span class="c1">// ["Chevy Malibu", "Honda Civic", "Ford Taurus"]</span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">cars</span><span class="p">);</span></code></pre></div><p>The comparison function compares two values and returns a number. </p><ul><li>If it returns a negative number, <code>a</code> will be sorted to a lower index in the array.</li><li>If it returns a positive number, <code>a</code> will be sorted to a higher index.</li><li>And if it returns <code>0</code> no sorting is necessary.</li></ul><p>When you pass <code>sort</code> a comparison function, that function will be called repeatedly and given different values from the array until the array has been completely sorted.</p><p>It is important to note that returning <code>0</code> does not guarantee that <code>a</code> and <code>b</code> will remain in the same order. It merely means that sorting is not necessary. JavaScript engines may choose to keep them in the same order, but that is not part of the language spec.</p><p>Thanks for reading! If you enjoyed this issue, why not subscribe to the newsletter?</p>    </div>			</div>		<!--=========================			END : POST		=============================-->		<!--=========================			START : POST		=============================-->		<div class="post-wrapper"> <h1>The Two Pillars of JavaScript - Pt 2: Functional Programming</h1><h2>How to Stop Micromanaging Everything</h2><main role="main" class="postArticle-content js-postField js-notesSource" data-scroll="native"><section name="ca84" class=" section--body"><div class="section-divider layoutSingleColumn"><hr class="section-divider"></div><div class="section-content"><div class= "section-inner layoutSingleColumn"><p name="3b42" id="3b42" class="graf--p graf--first"><a href="https://medium.com/javascript-scene/the-two-pillars-of-javascript-ee6f3281e7f3" data-href=" https://medium.com/javascript-scene/the-two-pillars-of-javascript-ee6f3281e7f3" class="markup--anchor markup--p-anchor">Two Pillars of JavaScript Part 1: "How to Escape the 7th Circle of Hell"</a>. From the introduction:</p><blockquote name="5298" id="5298" class="graf--blockquote">JavaScript is one of the most important programming languages of all time, not simply because of its popularity, but because it popularized <strong class="markup--strong markup--blockquote-strong">two features which are extremely important for the evolution of programming: </strong></blockquote><blockquote name="f254" id="f254" class="graf--blockquote"><strong class="markup--strong markup--blockquote-strong">Prototypal Inheritance </strong>(objects without classes, and prototype delegation, aka OLOO-Objects Linking to Other Objects), and</blockquote><blockquote name="ce84" id="ce84" class="graf--blockquote"><strong class="markup--strong markup--blockquote-strong">Functional Programming </strong>(enabled by lambdas with closure)</blockquote><blockquote name="f8a1" id="f8a1" class="graf--blockquote">Collectively, I like to call these paradigms <strong class="markup--strong markup--blockquote-strong">the two pillars of JavaScript, </strong>and I'm not ashamed to admit that they've spoiled me. I don't want to program in a language without them.</blockquote><h3 name="a71c" id="a71c" class="graf--h3 graf--last">We're building the future today</h3></div></div></section><section name="f5d0" class= " section--body"><div class="section-divider layoutSingleColumn"><hr class="section-divider"></div><div class="section-content"><div class="section-inner layoutSingleColumn"><blockquote name="e2f2" id="e2f2" class="graf--pullquote pullquote graf--startsWithDoubleQuote graf--first graf--last">"I skate to where the puck is going to be, not where it has been." ~ Wayne Gretzky</blockquote></div></div></section><section name="8593" class=" section--body"><div class="section-divider layoutSingleColumn"><hr class="section-divider"></div><div class= "section-content"><div class="section-inner layoutSingleColumn"><p name="6a79" id="6a79" class="graf--p graf--first">The high tech world is built on a culture of continuous innovation. We've built great things together because of a shared need to push technology past the bleeding edge. Each new breakthrough enables us to do things we never dreamed we'd be doing a few years ago. Welcome to the world of tech.</p><p name="a5fd" id="a5fd" class="graf--p">Not only are things changing quickly, the rate at which things are changing is changing quickly. We're several decades and many tech generations into an exponential tech explosion. The way we built typical applications five years ago is dramatically different from the way we build them today. You're probably using tools now that didn't exist 2 years ago. Go back 15 or 20 years, and even our processes were radically different (waterfall vs agile, etc...).</p><p name= "e947" id="e947" class="graf--p is-withNotes">Did you spend the last two years learning Angular? If so, I feel your pain. A lot of what you learned doesn't apply to Angular 2.0 or React. This rate of change is not sustainable if we continue to do things the way we've always done them.</p><p name="e576" id="e576" class="graf--p">If we're going to survive as engineers in the long run, the most important thing we must learn is how to adapt, and <strong class="markup--strong markup--p-strong">how to make our code more adaptable.</strong></p><p name="6677" id ="6677" class="graf--p">We must learn fast, because the technology we use next year will likely be twice as complex as the technology we're using now. As the internet of things and AI continue to explode, the loads on our applications will continue to grow exponentially. Tomorrow's apps will need to be more scalable, interoperable, concurrent, connected, performant, and intelligent than they are today.</p><p name="8477" id="8477" class="graf--p graf--last">The only way we'll be able to keep up with the exponentially increasing complexity will be to decrease the complexity of understanding programs. To maintain the goliath apps of tomorrow, we must learn to build more expressive code. We must learn to write programs that are easier to reason about, debug, create, analyze, and understand.</p></div></div></section><section name="9a6d" class=" section--body"><div class="section-divider layoutSingleColumn"><hr class= "section-divider"></div><div class="section-content"><div class="section-inner layoutSingleColumn"><blockquote name="0d2a" id="0d2a" class="graf--pullquote pullquote graf--first graf--last">Procedural programming and OOP are not going to get us where we need to go by themselves.</blockquote></div></div></section><section name="08d7" class=" section--body"><div class="section-divider layoutSingleColumn"><hr class="section-divider"></div><div class="section-content"><div class="section-inner layoutSingleColumn"><p name="9fb4" id="9fb4" class= "graf--p graf--first graf--last">Over the course of the next few years, <strong class="markup--strong markup--p-strong">the way we code is going to change in radical ways, </strong> pushing us in a fundamentally different direction than the one we've been sprinting for the past 30 years or so. These changes will lead to many important breakthroughs in programming techniques, processes, application scalability, and quality controls.</p></div></div></section><section name="710f" class=" section--body"><div class="section-divider layoutSingleColumn" ><hr class="section-divider"></div><div class="section-content"><div class="section-inner layoutSingleColumn"><blockquote name="d177" id="d177" class="graf--pullquote pullquote graf--first graf--last"><strong class="markup--strong markup--pullquote-strong">Developers proficient in functional programming are going to be in large demand in the very near future. </strong></blockquote></div></div></section><section name="0a28" class=" section--body"><div class="section-divider layoutSingleColumn"><hr class="section-divider"></div><div class= "section-content"><div class="section-inner layoutSingleColumn"><p name="3c32" id="3c32" class="graf--p graf--first">This change is already sweeping through organizations like Netflix, Facebook, and Microsoft, and there's very good reason for this <strong class="markup--strong markup--p-strong">tectonic shift in programming styles.</strong></p><p name="6209" id="6209" class="graf--p">In Buddhist philosophy, Zen kōans are often used to challenge a student's fundamental understanding of reality. Many feature two seemingly conflicting ideas or meanings, and when the student has realized the truth of both perspectives, mastery or enlightenment is attained. Here's a modern spin I included in my book, <a href=" http://learn-javascript.ericelliott.me/programming-javascript-applications/" data-href="http://learn-javascript.ericelliott.me/programming-javascript-applications/" class="markup--anchor markup--p-anchor" rel="nofollow">"Programming JavaScript Applications" (O'Reilly)</a>:</p><blockquote name="7528" id="7528" class="graf--blockquote">The venerable master Qc Na was walking with his student, Anton. Hoping to prompt the master into a discussion, Anton said "Master, I have heard that objects are a very good thing-is this true?" Qc Na looked pityingly at his student and replied, "Foolish pupil-objects are merely a poor man's closures."</blockquote><blockquote name="31c6" id="31c6" class="graf--blockquote">Chastised, Anton took his leave from his master and returned to his cell, intent on studying closures. He carefully read the entire "Lambda: The Ultimate..." series of papers and its cousins, and implemented a small Scheme interpreter with a closure-based object system. He learned much, and looked forward to informing his master of his progress.</blockquote><blockquote name="d075" id="d075" class= "graf--blockquote">On his next walk with Qc Na, Anton attempted to impress his master by saying "Master, I have diligently studied the matter, and now understand that objects are truly a poor man's closures." Qc Na responded by hitting Anton with his stick, saying "When will you learn? Closures are a poor man's object." At that moment, Anton became enlightened. </blockquote><blockquote name="726b" id="726b" class="graf--blockquote"><a href="http://people.csail.mit.edu/gregs/ll1-discuss-archive-html/msg03277.html" data-href=" http://people.csail.mit.edu/gregs/ll1-discuss-archive-html/msg03277.html" class="markup--anchor markup--blockquote-anchor" rel="nofollow"><em class="markup--em markup--blockquote-em">~ </em>Anton van Straaten</a></blockquote><p name="1fde" id="1fde" class="graf--p">Like objects, closures are a mechanism for containing state. In JavaScript, a closure is created whenever a function accesses a variable defined outside the immediate function scope. It's easy to create closures: Simply define a function inside another function, and expose the inner function, either by returning it, or passing it into another function. The variables used by the inner function will be available to it, even after the outer function has finished running.</p><p name="e586" id="e586" class="graf--p">You can use closures to create data privacy in JavaScript using a factory function:</p><pre name="c0e1" id="c0e1" class="graf--pre">var counter = function counter() {<br>  var count = 0;<br>  return {<br>    getCount: function getCount() {<br>      return count;<br>    },<br>    increment: function increment() {<br>      count += 1; <br>    }<br>  };<br>};</pre><p name="1101" id="1101" class="graf--p graf--empty"><br></p><p name="653e" id="653e" class="graf--p">In <a href=" https://medium.com/javascript-scene/the-two-pillars-of-javascript-ee6f3281e7f3" data-href="https://medium.com/javascript-scene/the-two-pillars-of-javascript-ee6f3281e7f3" class= "markup--anchor markup--p-anchor">The Two Pillars of JavaScript Part 1</a>, I described some of the major shortcomings of what most of us have come to know as object oriented programming, but also pointed out a glimmer of hope for a brighter future in object oriented design: <strong class="markup--strong markup--p-strong">prototypal OO</strong>-<em class="markup--em markup--p-em">not simply the concept of prototype delegation and chaining,</em> but also the concept of <strong class="markup--strong markup--p-strong">building new instances not from classes, but from a compilation of smaller object prototypes.</strong></p><p name="203a" id="203a" class="graf--p graf--last is-withNotes">In <strong class="markup--strong markup--p-strong">The Two Pillars of JavaScript Part 2</strong>, we're going to discuss a completely different programming paradigm that is going to play a much bigger role going forward as modern programming languages add more and more features that reduce boilerplate, repetition, and syntax noise: <strong class="markup--strong markup--p-strong">Functional Programming (FP).</strong></p></div></div></section><section name="67d4" class=" section--body"><div class="section-divider layoutSingleColumn"><hr class="section-divider"></div><div class= "section-content"><div class="section-inner layoutSingleColumn"><blockquote name="3110" id="3110" class="graf--pullquote pullquote graf--startsWithDoubleQuote graf--first graf--last"> "...the way forward is sometimes the way back." ~ The Wise Man, "Labyrinth"</blockquote></div></div></section><section name="d7c7" class=" section--body"><div class="section-divider layoutSingleColumn"><hr class="section-divider"></div><div class="section-content"><div class="section-inner layoutSingleColumn"><p name="0c25" id="0c25" class="graf--p graf--first">In the very beginnings of the computing revolution, decades before the invention of the microprocessor, a man named <strong class="markup--strong markup--p-strong">Alonzo Church</strong> did groundbreaking work in theoretical computer science. You may have heard of his student and collaborator, <strong class="markup--strong markup--p-strong">Alan Turing</strong>. Together, they created a theory of computable functions called the <strong class="markup--strong markup--p-strong">Church-Turing Thesis</strong>, which described the nature of computable functions. </p><p name="8024" id="8024" class="graf--p">Two foundational models of computation emerged from that work. The famous <strong class="markup--strong markup--p-strong">turing machine </strong>, and <strong class="markup--strong markup--p-strong">lambda calculus</strong>.</p><p name="d6ac" id="d6ac" class="graf--p">Today, the turing machine is frequently cited as the baseline of requirements for a modern programming language. A language or processor / VM instruction set is said to be <strong class="markup--strong markup--p-strong">turing complete </strong> if it can be used to simulate a universal turing machine. The first famous example of a turing-complete system was lambda calculus, described by Alonzo Church in 1936.</p><p name ="35bf" id="35bf" class="graf--p">Lambda calculus went on to inspire one of the first high-level programming languages, and the second-oldest high-level language in common use today: Lisp. </p><p name="4f4d" id="4f4d" class="graf--p">Lisp was (and remains) extremely influential and popular in academic circles, but it has also been very popular in productivity applications, particularly those that work on <strong class="markup--strong markup--p-strong">continuous data</strong> such as scalable vector graphics. Lisp was originally specified in 1958, and it's still often embedded in many complex applications. Notably, almost all popular CAD applications support AutoLISP, a dialect of Lisp used in AutoCAD, which (including its many specialized derivatives) is still the most widely used CAD application in the world.</p><blockquote name="44c4" id="44c4" class="graf--blockquote is-withNotes">Continuous data: Data that must be measured rather than counted, and could take any value within a range. Contrast with discrete data, which can be counted and accurately indexed. All values come from a specific set of valid values. For instance, the frequencies that can be produced by a violin must be represented by continuous data, because the string can be stopped at any point along the fingerboard. The frequencies that can be produced by a piano are discrete, because each string is tuned to a specific pitch and can't be stopped at different points depending on the performer's will. There are usually 88 notes on a piano keyboard. It's impossible to count the number of notes that could be produced by a violin player, and violin players frequently take advantage of that by sliding the pitch up or down between different notes.</blockquote><p name="18ed" id="18ed" class="graf--p">Lisp and its derivatives birthed an entire family of <strong class= "markup--strong markup--p-strong">functional programming languages</strong> which includes Curry, Haskell, Erlang, Clojure, ML, OCaml, etc...</p><p name="bacb" id="bacb" class="graf--p"> As popular as many of those languages are, JavaScript has exposed a whole new generation of programmers to functional programming concepts.</p><p name="c0cc" id="c0cc" class="graf--p"> Functional programming is a natural fit for JavaScript, because JavaScript offers a few important features: First-class functions, closures, and simple lambda syntax.</p><p name="f937" id= "f937" class="graf--p">JavaScript makes it easy to assign functions to variables, pass them into other functions, return functions from other functions, compose functions, and so on. JavaScript also offers immutable values for primitive types, and features that make it easy to return new objects and arrays rather than manipulate properties of those that are passed in as arguments.</p><p name="7c23" id="7c23" class="graf--p"><em class="markup--em markup--p-em">Why is all that important?</em></p><p name="a97b" id="a97b" class="graf--p">Functional programming glossaries contain a large number of large words, but at its core, the essence of FP is really very simple; programs are built mostly with a handful of very small, very reusable, very predictable <strong class="markup--strong markup--p-strong">pure functions.</strong></p><p name="3a35" id="3a35" class="graf--p">Pure functions have a few properties that make them extremely reusable and extremely useful for a variety of applications:</p><p name="d41a" id="d41a" class="graf--p"><strong class="markup--strong markup--p-strong">Idempotence: </strong> Given the same inputs, a pure function will always return the same output, regardless of the number of times the function is called. You may have heard this word used to describe HTTP GET requests. <strong class="markup--strong markup--p-strong">Idempotence is an important feature for building RESTful web services,</strong> but it also serves the very useful purpose of separating computation from dependency on both time and order of operations-<strong class="markup--strong markup--p-strong">extremely valuable for parallel &amp; distributed computation </strong>(think horizontal scaling).</p><p name="6aba" id="6aba" class="graf--p">Because of idempotence, pure functions are also a great fit when you need to operate on continuous data sets. For instance, automated fade-ins and fade-outs in video or audio. Typically they're designed as linear or logarithmic curves independent of framerates or sample rates, and only applied at the last possible moment to produce discrete data values. In graphics, this is analogous to scalable vector images like SVG, fonts, and Adobe Illustrator files. Key frames or control points are laid out relative to each other or to a timeline, rather than keyed to fixed pixels, frames, or samples.</p><p name="a412" id="a412" class="graf--p" >Because idempotent functions don't have any dependency on time or sample resolution, it's possible to treat continuous data as unbounded (virtually infinite) data streams, which allows free scaling of data across time, (sampling rates), pixel resolution, audio volume, and so on.</p><p name="4d99" id="4d99" class="graf--p"><strong class="markup--strong markup--p-strong"> Free from Side-effects:</strong> Pure functions can be safely applied with no side-effects, meaning that they do not mutate any shared state or mutable arguments, and other than their return value, they don't produce any observable output, including thrown exceptions, triggered events, I/O devices, network, console, display, logs, etc...</p><p name="5e95" id="5e95" class="graf--p is-withNotes">Because of the lack of shared state and side-effects, pure functions are much less likely to conflict with each other or cause bugs in unrelated parts of the program.</p><p name="5599" id="5599" class="graf--p is-withNotes">In other words, for the OOP coding audience, <strong class="markup--strong markup--p-strong">pure functions produce stronger guarantees of encapsulation than objects without function purity,</strong> and those guarantees provide many of the same benefits as encapsulation in OOP: The ability to change implementation without impacting the rest of the program, a self-documenting public interface (the function signature), independence from outside code, the ability to move code around freely between files, modules, projects, and so on.</p><p name="781a" id="781a" class="graf--p">Function purity is FP's answer to the gorilla/banana problem from OOP:</p><blockquote name= "5219" id="5219" class="graf--blockquote graf--startsWithDoubleQuote">"The problem with object-oriented languages is they've got all this implicit environment that they carry around with them. You wanted a banana but what you got was a gorilla holding the banana and the entire jungle." ~ Joe Armstrong</blockquote><p name="a100" id="a100" class="graf--p">Obviously, most programs need to produce output, so complex programs usually can't be composed using <strong class="markup--strong markup--p-strong">only </strong>pure functions, but wherever it's practical, it's a good idea to make your functions pure.</p><p name="f3ae" id="f3ae" class="graf--p graf--empty"><br></p><h4 name="a1a8" id="a1a8" class="graf--h4">Working in FP</h4><p name="05f8" id="05f8" class="graf--p">FP provides several kinds of functions that are extremely reusable. Various implementations will have a different set using different names. This list is mostly pulled from Haskell documentation. Haskell is one of the more popular functional languages, but you'll find functions similar to these in several popular JavaScript libraries:</p><p name="f43d" id="f43d" class="graf--p"><strong class="markup--strong markup--p-strong">List utilities:</strong></p><ul class="postList"><li name="e656" id="e656" class= "graf--li">head()-get first element</li><li name="dc8a" id="dc8a" class="graf--li">tail()-get all but first elements</li><li name="23be" id="23be" class="graf--li">last()-get last element </li><li name="3d8a" id="3d8a" class="graf--li">length()-count of elements</li></ul><p name="8663" id="8663" class="graf--p"><strong class="markup--strong markup--p-strong">Predicates / comparators (test an element, return boolean)</strong></p><ul class="postList"><li name="0347" id="0347" class="graf--li">equal()</li><li name="77d4" id="77d4" class="graf--li"> greaterThan()</li><li name="770e" id="770e" class="graf--li">lessThan()</li></ul><p name="0adc" id="0adc" class="graf--p"><strong class="markup--strong markup--p-strong">List transformations:</strong></p><ul class="postList"><li name="d849" id="d849" class="graf--li">map() ([x]) -&gt; [y] take list x and apply a transformation to each element in that list, return new list y</li><li name="9c6e" id="9c6e" class="graf--li">reverse() ([1, 2, 3]) -&gt; [3, 2, 1]</li></ul><p name="a195" id="a195" class="graf--p"><strong class="markup--strong markup--p-strong">List searches:</strong></p><ul class="postList"><li name="903d" id="903d" class="graf--li">find() ([x]) -&gt; x take list x and return first element that matches a predicate</li><li name="a674" id="a674" class="graf--li">filter() ([x]) -&gt; [y] take list x and return all items matching predicate</li></ul><p name="1c1b" id="1c1b" class="graf--p" ><strong class="markup--strong markup--p-strong">List Reducers / folds:</strong></p><ul class="postList"><li name="7922" id="7922" class="graf--li">reduce()-([x], function[, accumulator]) -&gt; apply function to each element and accumulate the results as a single value</li><li name="d780" id="d780" class="graf--li">any()-true if any values match predicate</li><li name= "331b" id="331b" class="graf--li">all()-true if all values match predicate</li><li name="b387" id="b387" class="graf--li">sum()-total of all values</li><li name="2ee0" id="2ee0" class= "graf--li">product()-product of all values</li><li name="9c64" id="9c64" class="graf--li">maximum()-highest value</li><li name="571a" id="571a" class="graf--li">minimum()-lowest value </li><li name="fc0f" id="fc0f" class="graf--li">concat()-take a list of lists and return a single, concatenated list in list order</li><li name="b475" id="b475" class="graf--li"> merge()-take a list of lists and return a single, merged list in element order</li></ul><p name="0441" id="0441" class="graf--p"><strong class="markup--strong markup--p-strong">Iterators / Generators / Collectors (infinite lists)</strong></p><ul class="postList"><li name="1528" id="1528" class="graf--li">sample()-return current value of continuous input source (temperature, form input, toggle switch state, etc...)</li><li name="302e" id="302e" class="graf--li">repeat()-(1) -&gt; [1, 1, 1, 1, 1, 1,...]</li><li name="dd71" id="dd71" class= "graf--li">cycle() / loop()-When the end of the list is reached, wrap around to the beginning again.</li></ul><p name="8646" id="8646" class="graf--p">Some of these common utility extras got added to JavaScript with the ECMAScript 5 Array extras. e.g.:</p><pre name="959d" id="959d" class="graf--pre is-withNotes">// Using ES6 syntax. () =&gt; means function () {}<br>var foo = [1, 2, 3, 4, 5];<br>var bar = foo.map( (n) =&gt; n + 1 ); // [2, 3, 4, 5, 6]<br>var baz = bar.filter( (n) =&gt; n &gt;=3 &amp;&amp; n &lt;=5); // [3,4,5]<br>var bif = baz.reduce( (n, el) =&gt; n += el); // 12</pre><h4 name="2ad2" id="2ad2" class="graf--h4">Lists as a Generic Interface</h4><p name="5615" id="5615" class="graf--p">You might notice that most of the functions above are utilities for managing or reasoning about <strong class="markup--strong markup--p-strong">lists</strong>. Once you start doing a lot of functional programming, you might start to see virtually everything as a <strong class="markup--strong markup--p-strong">list</strong>, an <strong class="markup--strong markup--p-strong">element</strong> of a list, a <strong class="markup--strong markup--p-strong">predicate</strong> used to test list values, or a <strong class="markup--strong markup--p-strong">transformation</strong> based on list values. That thinking lays the foundation for extremely reusable code.</p><p name="f4f1" id="f4f1" class="graf--p"><strong class="markup--strong markup--p-strong">Generics</strong> are functions that are capable of working on a range of different data types. In JavaScript, many functions that operate on collections are generic. For example, you can use the same function on both strings and arrays, because a string can be treated as an array of characters.</p><p name="be52" id="be52" class="graf--p">The process of changing a function that only works with a single type to one that works with many types is called <strong class="markup--strong markup--p-strong">lifting</strong>.</p><p name="9de2" id="9de2" class="graf--p">The key to all these functions working on every type of data you feed to them is that data is processed in lists which <strong class="markup--strong markup--p-strong">all share the same interface </strong>. I discussed lifting a bit towards the end of my Fluent 2014 talk, "Static Types are Overrated" (see below).</p><h4 name="686b" id="686b" class="graf--h4">How to Stop Micromanaging Everything</h4><p name="017f" id="017f" class="graf--p graf--empty"><br></p><p name="9900" id="9900" class="graf--p">In OO and imperative programming, we micromanage everything. We micromanage state, iteration counters, the timing of what happens when using things like event emitters and callbacks. What If I told you that all of that work is completely unnecessary-that you could literally delete entire categories of code from your programs?</p><p name="07d6" id="07d6" class="graf--p">You may have heard of <strong class= "markup--strong markup--p-strong">functional reactive programming</strong>. Here's the gist: FRP uses functional utilites like map, filter, and reduce to create and process data flows which propogate changes through the system: hence, <strong class="markup--strong markup--p-strong">reactive</strong>. When input <em class="markup--em markup--p-em">x</em> changes, output <em class="markup--em markup--p-em">y</em> updates <em class="markup--em markup--p-em">automatically</em> in response.</p><p name="3f3e" id="3f3e" class="graf--p">In OO, you might set up some object (say, a form input), and turn that object into an event emitter, and set up an event listener that jumps through some hoops and maybe produces some output whenever the event is triggered.</p><p name="2aad" id="2aad" class="graf--p">In FRP, you instead specify data dependencies in a more declarative fashion, and most of the heavy lifting is offloaded to standard functional utilities so you don't have to reinvent the wheel over and over again.</p><p name="f364" id="f364" class="graf--p">Imagine that <strong class="markup--strong markup--p-strong">every list is a stream</strong>: An array is a stream of values in element order. A form input can be a stream of values sampled with each change. A button is a stream of clicks.</p><blockquote name="5eb5" id="5eb5" class="graf--pullquote pullquote">A stream is just a list expressed over time.</blockquote><p name="b924" id="b924" class="graf--p">In Rx (reactive extensions) nomenclature, you create <strong class="markup--strong markup--p-strong">observable streams </strong>and then process those streams using a set of functional utilities like the ones described above.</p><p name="6b8b" id="6b8b" class="graf--p">Similar to Node streams, <strong class="markup--strong markup--p-strong">observables</strong> can feature optional shared <strong class="markup--strong markup--p-strong">backpressure</strong>. Like <strong class="markup--strong markup--p-strong">generators</strong>, your program can consume observable values at its own pace, as it becomes ready to handle them.</p><p name="27a6" id="27a6" class="graf--p">Imagine you want to watch all your social media feeds for a particular hash tag. You could collect a list of lists, merge them in the order they're received, and then use any combination of the utility functions above to process them.</p><p name= "be92" id="be92" class="graf--p">That might look something like this:</p><pre name="1634" id="1634" class="graf--pre">var messages = merge(twitter, fb, gplus, github)</pre><pre name="fe81" id="fe81" class="graf--pre">messages.map(normalize) // convert to single message format<br>  .filter(selectHashtag) // cherry pick messages that use the tag<br>  .pipe(process.stdout) // stream output to stdout</pre><p name="56bf" id="56bf" class="graf--p graf--empty"><br></p><h4 name="dc94" id="dc94" class="graf--h4">Better Async</h4><p name="1aed" id="1aed" class= "graf--p">You may have heard of promises. A <strong class="markup--strong markup--p-strong">promise </strong>is an object that provides a standard interface for dealing with values that may or may not be available at the time the promise is used. In other words, a promise wraps a potential value that may be resolved in the future. Typically, a function call will return a promise that may resolve with some future value:</p><pre name="56f2" id="56f2" class="graf--pre">fetchFutureStockPrices().then(becomeAMillionaire);</pre><p name="d85f" id="d85f" class= "graf--p">Well, it doesn't work exactly like that, because `.then()` will only be called when the stock prices become available, so when `becomeAMillionaire` finally gets run, the "future" stock prices will be the present stock prices.</p><p name="dd2e" id="dd2e" class="graf--p">A promise is basically a stream that only emits a single value (or rejection). Observables can replace promises in your code and provide all of the standard functional utilities you may have grown accustomed to with libraries like Underscore or Lo-Dash.</p><p name= "ed06" id="ed06" class="graf--p">Now would be a great time to learn more about functional programming, the benefits of function purity, lazy evaluation, and a lot more. I promise you're going to hear a lot more about these topics over the next few years.</p><p name="8bf3" id="8bf3" class="graf--p">Here we are, coming up on 2015, returning to computer science roots planted in the 1930's so that we can more easily manage the software of future.</p><h4 name="a48a" id="a48a" class="graf--h4">Higher Order Learning</h4><p name="0654" id="0654" class= "graf--p">I really loved this talk by Jafar Husain, Technical Lead at Netflix. It's called, "Asynchronous Programming at Netflix" and it was delivered at <a href=" http://atscaleconference.com/" data-href="http://atscaleconference.com/" class="markup--anchor markup--p-anchor" rel="nofollow">@Scale 2014</a>.</p><figure name="9583" id="9583" class= "graf--figure graf--iframe"><figcaption class="imageCaption"><a href="https://www.youtube.com/watch?v=gawmdhCNy-A" data-href="https://www.youtube.com/watch?v=gawmdhCNy-A" class= "markup--anchor markup--figure-anchor" rel="nofollow">https://www.youtube.com/watch?v=gawmdhCNy-A</a></figcaption></figure><p name="6f66" id="6f66" class="graf--p">James Coglan gave a good talk that touches on some key topics such as the roles of promises and laziness:</p><figure name="9107" id="9107" class="graf--figure graf--iframe graf--last" ></figure></div></div></section><section name="2181" class=" section--body"><div class="section-divider layoutSingleColumn"><hr class="section-divider"></div><div class="section-content" ><div class="section-inner layoutSingleColumn"><p name="1bd9" id="1bd9" class="graf--p graf--first">If you're ready to take FRP for a spin, check out the <a href=" https://github.com/Reactive-Extensions/RxJS" data-href="https://github.com/Reactive-Extensions/RxJS" class="markup--anchor markup--p-anchor" rel="nofollow">Reactive Extensions for JavaScript</a>, <a href="http://www.reactivemanifesto.org/" data-href="http://www.reactivemanifesto.org/" class="markup--anchor markup--p-anchor" rel="nofollow">The Reactive Manifesto</a> , and work through these <a href="http://jhusain.github.io/learnrx/" data-href="http://jhusain.github.io/learnrx/" class="markup--anchor markup--p-anchor" rel="nofollow">interactive lessons</a>.</p><p name="97ab" id="97ab" class="graf--p">For node-centric streams, check out <a href="http://caolanmcmahon.com/posts/how_i_want_to_write_node_stream_all_the_things_new/" data-href="http://caolanmcmahon.com/posts/how_i_want_to_write_node_stream_all_the_things_new/" class="markup--anchor markup--p-anchor" rel="nofollow">"How I Want to Write Node: Stream All the Things!"</a> and <a href="http://highlandjs.org/" data-href="http://highlandjs.org/" class="markup--anchor markup--p-anchor" rel="nofollow">Highland.js</a>.</p><p name="a4ba" id="a4ba" class="graf--p">For a much more detailed overview of concepts related to reactivity, see Kris Kowal's excellent <a href="https://github.com/kriskowal/gtor" data-href=" https://github.com/kriskowal/gtor" class="markup--anchor markup--p-anchor" rel="nofollow">"General Theory of Reactivity"</a> (aka gtor).</p><p name="026b" id="026b" class="graf--p">My talk from Fluent 2014 demonstrates lifting and discusses how dynamic or inferred types can actually be beneficial to functional programming because it makes it trivial to write generic functions.</p><figure name="8b0d" id="8b0d" class="graf--figure graf--iframe graf--last"></figure></div></div></section><section name="0218" class=" section--body"><div class= "section-divider layoutSingleColumn"><hr class="section-divider"></div><div class="section-content"><div class="section-inner layoutSingleColumn"><h2 name="800c" id="800c" data-align= "center" class="graf--h2 graf--first graf--last"><a href="https://ericelliottjs.com/" data-href="https://ericelliottjs.com/" class="markup--anchor markup--h2-anchor" rel="nofollow">Learn All About The Two Pillars With Our Online Course Series</a></h2></div></div></section><section name="1441" class=" section--body section--last"><div class="section-divider layoutSingleColumn"><hr class="section-divider"></div><div class="section-content"><div class="section-inner layoutSingleColumn"><h3 name="9e1d" id="9e1d" data-align="center" class= "graf--h3 graf--first graf--last"><a href=" https://twitter.com/intent/tweet?text=The+Two+Pillars+of+JavaScript+Pt+2%3A+Functional+Programming+by+%40_ericelliott+http%3A%2F%2Fbit.ly%2Fjspillars2+%23javascript" data-href=" https://twitter.com/intent/tweet?text=The+Two+Pillars+of+JavaScript+Pt+2%3A+Functional+Programming+by+%40_ericelliott+http%3A%2F%2Fbit.ly%2Fjspillars2+%23javascript" class="markup--anchor markup--h3-anchor" rel="nofollow">Tweet This</a></h3></div></div></section></main>			</div>		<!--=========================			END : POST =============================-->		<!--=========================			START : POST		=============================-->		<div class="post-wrapper"><div class= "section-inner layoutSingleColumn"><h1 name="3764" id="3764" class="graf--h3 graf--first">Currying in JavaScript</h1>	<p name="403b" id="403b" class="graf--p">I've been thinking a lot lately about functional programming, and I thought it might be kind of fun to walk through the process of writing a <strong class="markup--strong markup--p-strong">curry</strong> function. </p><p name="335b" id="335b" class="graf--p">For the uninitiated, currying refers to the process of taking a function with <strong class="markup--strong markup--p-strong">n</strong> arguments and transforming it into <strong class="markup--strong markup--p-strong">n</strong> functions that each take a single argument. It essentially creates a chain of partially applied functions that eventually resolves with a value.</p><p name="2812" id="2812" class="graf--p">Here's a basic example of how you'd use it:</p><pre name="eb6e" id="eb6e" class= "graf--pre">function volume( l, w, h ) {<br>  return l * w * h;<br>}</pre><pre name="8eb7" id="8eb7" class="graf--pre">var curried = curry( volume );</pre><pre name="9d67" id="9d67" class= "graf--pre">curried( 1 )( 2 )( 3 ); // 6</pre><h3 name="f385" id="f385" class="graf--h3">Disclaimer</h3><p name="2c73" id="2c73" class="graf--p">This post assumes basic familiarity with closures and higher-order functions, as well as stuff like <strong class="markup--strong markup--p-strong">Function#apply()</strong>. If you're not comfortable with those concepts, you might want to brush up before reading further.</p><h3 name="ce69" id="ce69" class="graf--h3">Writing our curry function</h3><p name="7358" id="7358" class="graf--p">The first thing you'll notice is that <strong class="markup--strong markup--p-strong">curry</strong> expects a function as its argument, so we'll start there.</p><pre name="d899" id="d899" class="graf--pre"> function curry( fn ) {</pre><pre name="077a" id="077a" class="graf--pre">}</pre><p name="8795" id="8795" class="graf--p">Next, we need to know how many arguments our function expects (called its "arity"). Otherwise, we won't know when to stop returning new functions and give back a value instead.</p><p name="0214" id="0214" class="graf--p">We can tell how many arguments a function expects by accessing its <strong class="markup--strong markup--p-strong">length</strong> property.</p><pre name="81e5" id="81e5" class="graf--pre">function curry( fn ) {<br>  var arity = fn.length;<br>}</pre><p name="6ef8" id="6ef8" class="graf--p">From there, things get a little bit trickier.</p><p name="a24c" id="a24c" class="graf--p">Essentially, every time a curried function is called, we add any new arguments to an array that's saved in a closure. If the number of arguments in that array is equal to the number of arguments that our original function expects, then we call it. Otherwise, we return a new function.</p><p name="a32f" id="a32f" class="graf--p">To do that, we need (1) a closure that can retain that list of arguments and (2) a function that can check the total number of arguments and either return another partially applied function <em class="markup--em markup--p-em">or</em> the return value of the original function with all of the arguments applied.</p><p name="24d9" id="24d9" class="graf--p">I usually do this with an immediately invoked function called `resolver`.</p><pre name="11b5" id="11b5" class="graf--pre is-withNotes">function curry( fn ) {<br>  var arity = fn.length;</pre><pre name="23ea" id="23ea" class="graf--pre">  return (function resolver() {<br> <br>   }());<br>}</pre><p name="28fd" id="28fd" class="graf--p">Now, the first thing we need to do in <strong class="markup--strong markup--p-strong">resolver </strong> is make a copy of any arguments it received. We'll do that by creating a variable called <strong class="markup--strong markup--p-strong">memory</strong> that uses <strong class= "markup--strong markup--p-strong">Array#slice</strong> to make a copy of the <strong class="markup--strong markup--p-strong">arguments</strong> object.</p><pre name="d496" id="d496" class= "graf--pre">function curry( fn ) {<br>  var arity = fn.length;</pre><pre name="ae28" id="ae28" class="graf--pre">  return (function resolver() {<br>    var memory = Array.prototype.slice.call( arguments );<br>  }());<br>}</pre><p name="ffac" id="ffac" class="graf--p">Next, <strong class="markup--strong markup--p-strong">resolver</strong> needs to return a function. This is what the outside world sees when it calls a curried function.</p><pre name="13d2" id="13d2" class="graf--pre is-withNotes">function curry( fn ) {<br>  var arity = fn.length;</pre><pre name="f024" id="f024" class="graf--pre">  return (function resolver() {<br>    var memory = Array.prototype.slice.call( arguments );<br>    return function() { </pre><pre name="5359" id="5359" class="graf--pre">    };<br>  }());<br>}</pre><p name="684f" id="684f" class="graf--p">Since this internal function is the one that ends up actually being called, it needs to accept arguments. But it also needs to <em class="markup--em markup--p-em">add</em> those to any arguments that might be stored in <strong class="markup--strong markup--p-strong">memory</strong>. So first, we'll make a copy of <strong class="markup--strong markup--p-strong">memory</strong> by calling <strong class="markup--strong markup--p-strong" >slice()</strong> on it.</p><pre name="82e0" id="82e0" class="graf--pre">function curry( fn ) {<br>  var arity = fn.length;</pre><pre name="98f2" id="98f2" class="graf--pre">  return (function resolver() {<br>    var memory = Array.prototype.slice.call( arguments );<br>    return function() {<br>      var local = memory.slice();<br>    };<br>  }());<br>}</pre><p name= "07fe" id="07fe" class="graf--p">Now, lets add our new arguments by using <strong class="markup--strong markup--p-strong">Array#push</strong>.</p><pre name="c6c9" id="c6c9" class= "graf--pre">function curry( fn ) {<br>  var arity = fn.length;</pre><pre name="a8fe" id="a8fe" class="graf--pre">  return (function resolver() {<br>    var memory = Array.prototype.slice.call( arguments );<br>    return function() {<br>      var local = memory.slice();<br>      Array.prototype.push.apply( local, arguments );<br>    };<br>  }());<br>} </pre><p name="47d5" id="47d5" class="graf--p">Good. Now we have a new array containing all the arguments we've received so far in this chain of partially applied functions.</p><p name= "0396" id="0396" class="graf--p">The last thing to do is to compare the length of arguments we've received with the arity of our curried function. If the lengths match, we'll call the original function. If not, we'll use <strong class="markup--strong markup--p-strong">resolver</strong> to return yet another function that has all of our current arguments stored in memory.</p><pre name="a237" id="a237" class="graf--pre">function curry( fn ) {<br>  var arity = fn.length;</pre><pre name="be9d" id="be9d" class="graf--pre is-withNotes">  return (function resolver() {<br>    var memory = Array.prototype.slice.call( arguments );<br>    return function() {<br>      var local = memory.slice(), next;<br> Array.prototype.push.apply( local, arguments );<br>      next = local.length &gt;= arity ? fn : resolver;<br>      return next.apply( null, local );<br>    };<br>  }());<br>}</pre><p name= "4884" id="4884" class="graf--p">This can be a little bit difficult to wrap your head around, so let's take it step by step in an example.</p><pre name="7529" id="7529" class="graf--pre"> function volume( l, w, h ) {<br>  return l * w * h;<br>}</pre><pre name="a191" id="a191" class="graf--pre">var curried = curry( volume );</pre><p name="3289" id="3289" class="graf--p"> Okay, so <strong class="markup--strong markup--p-strong">curried</strong> is the result of passing <strong class="markup--strong markup--p-strong">volume</strong> into our <strong class= "markup--strong markup--p-strong">curry</strong> function.</p><p name="5951" id="5951" class="graf--p">If you look back, what's happening here is:</p><p name="94b5" id="94b5" class= "graf--p">1. We store the arity of <strong class="markup--strong markup--p-strong">volume</strong>, which is <strong class="markup--strong markup--p-strong">3</strong>.<br>2. We immediately invoke <strong class="markup--strong markup--p-strong">resolver</strong> with no arguments, which means that its <strong class="markup--strong markup--p-strong">memory</strong> array is empty.<br>3. <strong class="markup--strong markup--p-strong">resolver</strong> returns an anonymous function.</p><p name="7c58" id="7c58" class="graf--p">Still with me? Now let's call our <strong class="markup--strong markup--p-strong">curried</strong> function and pass in a length.</p><pre name="a6b9" id="a6b9" class="graf--pre">function volume( l, w, h ) { <br>  return l * w * h;<br>}</pre><pre name="5bb4" id="5bb4" class="graf--pre">var curried = curry( volume );<br>var length = curried( 2 );</pre><p name="86c8" id="86c8" class="graf--p"> Again, here are the steps:</p><p name="b32a" id="b32a" class="graf--p">1. What we actually called here was the anonymous function being returned by <strong class="markup--strong markup--p-strong">resolver</strong>.<br>2. We made a copy of <strong class="markup--strong markup--p-strong">memory</strong> (which was empty) and called it <strong class="markup--strong markup--p-strong">local</strong>.<br>3. We added our argument (<strong class="markup--strong markup--p-strong">2</strong>) to the <strong class="markup--strong markup--p-strong">local </strong> array.<br>4. Since the length of <strong class="markup--strong markup--p-strong">local</strong> is less than the arity of <strong class="markup--strong markup--p-strong">volume </strong>, we call <strong class="markup--strong markup--p-strong">resolver</strong> again with the list of arguments we have so far. That creates a new closure with a new <strong class= "markup--strong markup--p-strong">memory</strong> array, which contains our first argument of <strong class="markup--strong markup--p-strong">2</strong>.<br>5. Finally, <strong class= "markup--strong markup--p-strong">resolver</strong> returns a new function that has access to an outer closure with our new <strong class="markup--strong markup--p-strong">memory</strong> array.</p><p name="9d20" id="9d20" class="graf--p">So what we get back is that inner anonymous function again. But this time, it has access to a <strong class="markup--strong markup--p-strong">memory</strong> array that isn't empty. It has our first argument (a <strong class="markup--strong markup--p-strong">2</strong>) inside of it.</p><p name="750a" id="750a" class="graf--p">If we call our <strong class="markup--strong markup--p-strong">length</strong> function, the process repeats.</p><pre name="3187" id="3187" class="graf--pre">function volume( l, w, h ) {<br>  return l * w * h;<br>}</pre><pre name="0bc7" id="0bc7" class="graf--pre">var curried = curry( volume );<br>var length = curried( 2 );<br>var lengthAndWidth = length( 3 );</pre><p name="8722" id="8722" class="graf--p">1. Again, what we actually called was the anonymous function being returned by <strong class="markup--strong markup--p-strong"> resolver</strong>.<br>2. This time, <strong class="markup--strong markup--p-strong">resolver</strong> had been primed with some previous arguments. So we make a copy of that array <strong class="markup--strong markup--p-strong">[ 2 ]</strong>.<br>3. We add our new argument, <strong class="markup--strong markup--p-strong">3</strong>, to the <strong class="markup--strong markup--p-strong">local</strong> array.<br>4. Since the length of <strong class="markup--strong markup--p-strong">local</strong> is still less than the arity of <strong class= "markup--strong markup--p-strong">volume</strong>, we call <strong class="markup--strong markup--p-strong">resolver</strong> again with the list of arguments we have so far - and that returns a new function.</p><p name="5fd9" id="5fd9" class="graf--p">Now it's time to call our <strong class="markup--strong markup--p-strong">lengthAndWidth</strong> function and get back a value.</p><pre name="aa6b" id="aa6b" class="graf--pre">function volume( l, w, h ) {<br>  return l * w * h;<br>}</pre><pre name="9658" id="9658" class="graf--pre">var curried = curry( volume );<br>var length = curried( 2 );<br>var lengthAndWidth = length( 3 );</pre><pre name="d8b2" id="d8b2" class="graf--pre">console.log( lengthAndWidth( 4 ) ); // 24</pre><p name="f1d8" id="f1d8" class="graf--p">This time, the steps are a little bit different at the end:</p><p name="366d" id="366d" class="graf--p">1. Once again, what we actually called was the anonymous function being returned by <strong class="markup--strong markup--p-strong">resolver</strong>.<br>2. This time, <strong class="markup--strong markup--p-strong">resolver</strong> had been primed with two previous arguments. So we make a copy of that array <strong class="markup--strong markup--p-strong">[ 2, 3 ] </strong>and assigned it to <strong class="markup--strong markup--p-strong">local</strong>.<br>3. We add our new argument, <strong class="markup--strong markup--p-strong">4</strong>, to the <strong class="markup--strong markup--p-strong">local </strong> array.<br>4. Now the length of <strong class="markup--strong markup--p-strong">local</strong> is <strong class="markup--strong markup--p-strong">3</strong>, which is the arity of <strong class="markup--strong markup--p-strong">volume</strong>. So instead of returning a new function, we return the result of calling <strong class="markup--strong markup--p-strong"> volume</strong> with all of the arguments we've been saving up, and that gives us a value of <strong class="markup--strong markup--p-strong">24</strong>.</p><h3 name="735f" id="735f" class ="graf--h3">Wrapping up</h3><p name="9bcb" id="9bcb" class="graf--p is-withNotes">Admittedly, I have yet to find a super compelling use-case for currying in my day-to-day work. But I still think that going through the process of writing functions like this is a great way to improve your understanding of functional programming, and it helps reinforce concepts like closures and first-class functions.</p><p name="92f7" id="92f7" class="graf--p">By the way, if you like nerdy JavaScript things and live in the Boston area, I'm hiring at <a href=" http://projectdecibel.com" data-href="http://projectdecibel.com" class="markup--anchor markup--p-anchor" rel="nofollow">Project Decibel</a>. Shoot me an <a href="mailto:kennis84@gmail.com" data-href="mailto:kennis84@gmail.com" class="markup--anchor markup--p-anchor">email</a>.</p><p name="713b" id="713b" class="graf--p graf--last">And if you liked this post, follow me here or on <a href="http://twitter.com/kevincennis" data-href="http://twitter.com/kevincennis" class="markup--anchor markup--p-anchor" rel="nofollow">Twitter</a>. I'm gonna try to write once a day for the next 30 days.</p></div>			</div>		<!--=========================			END : POST		=============================--> <!--=========================			START : POST		=============================-->		<div class="post-wrapper"><div class="section-inner layoutSingleColumn"><h1 name="83e5" id="83e5" class="graf--h2 graf--first">JavaScript - Just another introduction to ES6</h1><p name="6a32" id="6a32" class="graf--p">Some commented ES6 examples to get you started</p><p name= "ed29" id="ed29" class="graf--p">JavaScript is gathering a lot of attention since news of <a href="http://www.wired.com/2015/02/nodejs-foundation/" data-href=" http://www.wired.com/2015/02/nodejs-foundation/" class="markup--anchor markup--p-anchor" rel="nofollow">Microsoft, IBM and the Linux Foundation</a> announced their support to Node.js just few days ago. It is overdue to bring 2015 modern language features to JavaScript and ES6 is trying to do just that.</p><blockquote name="3d01" id="3d01" class="graf--pullquote pullquote"> Some frameworks <em class="markup--em markup--pullquote-em">like Angular 2.0 </em>are early adopters of ES6</blockquote><p name="c611" id="c611" class="graf--p">In this post I am going to introduce you to some of these features used in <a href="http://www.es6fiddle.net/" data-href="http://www.es6fiddle.net/" class="markup--anchor markup--p-anchor" rel="nofollow">ES6 Fiddle </a>. I recommend you to play with them and get a feeling of what's to come. These are the features that are being covered:</p><ul class="postList"><li name="b4b8" id="b4b8" class= "graf--li">Arrow functions and let keyword; Block scopes</li><li name="2170" id="2170" class="graf--li">Classes and inheritance; Default parameters</li><li name="5217" id="5217" class= "graf--li">Destructured assignment</li><li name="979e" id="979e" class="graf--li">Generators; Iterators; Maps</li><li name="ce49" id="ce49" class="graf--li">Promises; Rest parameters; Sets </li><li name="9fdf" id="9fdf" class="graf--li">Spread operator; Template Literals</li></ul><p name="899f" id="899f" class="graf--p">Let's get started! You can follow this post with ES6 Fiddle side by side.</p><h3 name="1850" id="1850" class="graf--h3">Arrow functions and let keyword</h3><p name="5bf6" id="5bf6" class="graf--p">I remember this feature introduced in C# 3.0 few years ago with another name, it was called <a href="https://msdn.microsoft.com/en-gb/library/bb397687.aspx" data-href="https://msdn.microsoft.com/en-gb/library/bb397687.aspx" class ="markup--anchor markup--p-anchor" rel="nofollow">lambda expressions</a>. In JavaScript this will replace anonymous functions. The best way to go about them is to put both implementations side by side.</p><figure name="d1f0" id="d1f0" class="graf--figure graf--iframe"><div class="iframeContainer"><pre>let square = x => x * x;let add = (a, b) => a + b;let pi = () => 3.1415;console.log(square(5)); // 25console.log(add(3, 4)); // 7console.log(pi()); // 3.1415</pre></div><figcaption class="imageCaption">Using arrow functions</figcaption></figure><figure name="1f9d" id="1f9d" class="graf--figure graf--iframe"><div class="iframeContainer"><pre>var square = function(x) { return x * x; };var add = function(a, b) { return a + b; };var pi = function() { return 3.1415; };</pre></div><figcaption class="imageCaption">Using anonymous functions</figcaption></figure><p name="9a95" id="9a95" class="graf--p">The code above should be self explanatory. Only note, <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/let" data-href=" https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/let" class="markup--anchor markup--p-anchor" rel="nofollow">let</a> is the new keyword applying to a block scope opposed to <em class="markup--em markup--p-em">var</em> that applies to the global scope or a local function. Let's see the difference with our next example.</p><h3 name="b824" id= "b824" class="graf--h3">Block scope</h3><p name="5500" id="5500" class="graf--p">The difference between <em class="markup--em markup--p-em">var </em>and <em class="markup--em markup--p-em" >let </em>is demonstrated in the code below.</p><figure name="2721" id="2721" class="graf--figure graf--iframe"><div class="iframeContainer"><pre>var x = 0;for (let i = 0; i < 10; i++) { x += 10;}try {  console.log(i);} catch(e) {  console.log(    'i does not exist here!'  );}</pre></div><figcaption class="imageCaption">Using block scope</figcaption></figure><p name="9520" id="9520" class="graf--p">In this case the <em class="markup--em markup--p-em">i </em>variable<em class="markup--em markup--p-em"> </em>only<em class="markup--em markup--p-em"> </em> exists within the for loop, the block scope. In this example, the <em class="markup--em markup--p-em">x </em>variable lives within the global object, but if it was inside a function it would be within the outer function.</p><h3 name="a4c2" id="a4c2" class="graf--h3">Classes and inheritance</h3><p name="85de" id="85de" class="graf--p">Some people argue that JavaScript don't belong to OO languages but other people still insists on applying OO concepts to it, probably most coming from Java or&nbsp;.NET. To keep <em class="markup--em markup--p-em"> diehard-OO-people</em> happy ES6 adds some OO keywords to the mix.</p><figure name="ba4e" id="ba4e" class="graf--figure graf--iframe"><div class="iframeContainer"><pre>class Polygon { constructor(height, width) { //class constructor    this.name = 'Polygon';    this.height = height;    this.width = width;  }  sayName() { //class method    console.log('Hi, I am a', this.name + '.');  }}class Square extends Polygon {  constructor(length) {    super(length, length); //call the parent method with super    this.name = 'Square';  }  get area() { //calculated attribute getter    return this.height * this.width;  }}let s = new Square(5);s.sayName(); // Hi, I am a Square.console.log(s.area); // 25</pre></div></figure><p name="2846" id="2846" class="graf--p">We can see the use of new keywords: <em class="markup--em markup--p-em">class, constructor, extends, super </em>and<em class="markup--em markup--p-em"> get</em>. Code is pretty straightforward. From the example we are only missing private/static methods and setters.</p><p name="4a39" id="4a39" class="graf--p">Unfortunately there are no keywords for private methods or properties so we have to resort to regular closures or IIFEs.</p><p name="3b44" id="3b44" class="graf--p">Besides some small differences the code would translate to: </p><figure name="340c" id="340c" class="graf--figure graf--iframe"><div class="iframeContainer"><pre>function Polygon(height, width) { //class constructor  this.name = 'Polygon'; this.height = height;  this.width = width;}Polygon.prototype = {  sayName: function () { //class method    console.log('Hi, I am a ' + this.name + '.');  }};function Square(length) { //class constructor  Polygon.call(this, length, length);  this.name = 'Square';}// Square inherits from PolygonSquare.prototype = Object.create(Polygon.prototype);// Set the "constructor" property to refer to SquareSquare.prototype.constructor = Square;// Add getterSquare.prototype.getArea = function() { //class method  return this.height * this.width;};var p = new Polygon(5,5);p.sayName(); // Hi, I am a Polygon.var s = new Square(5);s.sayName(); // Hi, I am a Square.console.log(s.getArea()); // 25</pre></div></figure><p name="cc11" id="cc11" class= "graf--p">ES6 is certainly less verbose than current ES5 implementation.</p><h3 name="9f64" id="9f64" class="graf--h3">Default parameters</h3><p name="9b8d" id="9b8d" class="graf--p">This feature is pretty neat. It allows you to set a default value if none is provided.</p><figure name="bf89" id="bf89" class="graf--figure graf--iframe"><div class="iframeContainer"><pre> function sayMsg(msg='This is a default message.') {  console.log(msg);}sayMsg(); // This is a default message.sayMsg('This is a different message!'); // This is a different message! </pre></div></figure><p name="d9c7" id="d9c7" class="graf--p">Before it was looking something similar to this</p><figure name="69ab" id="69ab" class="graf--figure graf--iframe"><div class= "iframeContainer"><pre>function sayMsg(msg){  var msg = msg || 'This is a default message.';  console.log(msg);}sayMsg();  // This is a default message.sayMsg('This is a different message!'); // This is a different message!</pre></div></figure><h3 name="4b3f" id="4b3f" class="graf--h3">Destructured assignment</h3><p name="b3ab" id="b3ab" class="graf--p">You might known this feature if you have some Python or PHP experience. There are two types: arrays and objects. For objects the key is used to match the values instead of the position.</p><figure name="0578" id="0578" class="graf--figure graf--iframe"><div class="iframeContainer"><pre>let [one, two] = [1, 2];let {three, four} = {three: 3, four:  4};console.log(one, two, three, four); // 1 2 3 4</pre></div></figure><p name="0e11" id="0e11" class="graf--p">This example could be slightly changed to a more common scenario where the object key is different from the target.</p><figure name="d6d8" id="d6d8" class="graf--figure graf--iframe"><div class="iframeContainer"><pre>let [one, two] = [1, 2];let {a:three, b:four} = {a: 3, b:  4};console.log(one, two, three, four); // 1 2 3 4</pre></div></figure><h3 name="50ef" id="50ef" class="graf--h3">Generators</h3><p name="2716" id="2716" class="graf--p">Generators are subtypes of Iterators and use <em class="markup--em markup--p-em">function*</em> and <em class="markup--em markup--p-em">yield</em> together to work their magic. The main idea to take home is that they allow custom iterators implementations. Let's look at the sample code below</p><figure name="a2d4" id="a2d4" class="graf--figure graf--iframe"><div class="iframeContainer"><pre>function* range(start, end, step) {  while (start < end) {    yield start;    start += step;  }}for (let i of range(0, 10, 2)) {  console.log(i);}</pre></div></figure><p name="fe85" id="fe85" class= "graf--p">This code creates a generator called <em class="markup--em markup--p-em">range </em>that returns <em class="markup--em markup--p-em">start</em> value as long as is strictly lower that <em class="markup--em markup--p-em">end. </em>After returning the <em class="markup--em markup--p-em">start </em>value to the iterator it increments <em class="markup--em markup--p-em">start</em> with the <em class="markup--em markup--p-em">step </em>value<em class="markup--em markup--p-em">. </em>The generator can only be used within an iterator and as we have seen it creates a block scope.</p><h3 name="d748" id="d748" class="graf--h3">Iterators for..of</h3><p name="cf5a" id="cf5a" class="graf--p">Iterators land to JavaScript land with a similar implementation to <em class="markup--em markup--p-em">IEnumerable </em>in&nbsp;.NET or Java <em class="markup--em markup--p-em">Iterable</em>. In the exemple below it loops through the values in <em class="markup--em markup--p-em">arr </em>Array.</p><figure name="bf6c" id="bf6c" class="graf--figure graf--iframe"><div class="iframeContainer"><pre>let arr = [1, 2, 3, 4, 5];let sum = 0;for (let v of arr) {  sum += v;}console.log('1 + 2 + 3 + 4 + 5 =', sum);</pre></div></figure><p name="3f17" id="3f17" class="graf--p">You can use <em class= "markup--em markup--p-em">for..of</em> with built-in iterables: <em class="markup--em markup--p-em">String</em>, <em class="markup--em markup--p-em">Array</em>, <em class="markup--em markup--p-em">TypedArray</em>, <em class="markup--em markup--p-em">Map </em>and <em class="markup--em markup--p-em">Set</em>.</p><blockquote name="40f6" id="40f6" class="graf--blockquote"> Notice how different is from <em class="markup--em markup--blockquote-em">for..in</em>, that loops through object properties.</blockquote><h3 name="94fe" id="94fe" class="graf--h3">Maps </h3><p name="de50" id="de50" class="graf--p">Maps substitute objects to store key/value pairs. Pairs are stored as 2-element arrays [key, value].</p><blockquote name="7b5c" id="7b5c" class="graf--blockquote"><em class="markup--em markup--blockquote-em">Maps can use any value as key besides strings but objects can't.</em></blockquote><p name="d151" id="d151" class= "graf--p">Some common methods:</p><pre name="66b1" id="66b1" class="graf--pre">map.size       returns its size<br>map.entries()  returns entries in insertion order [k,v]<br>map.keys() returns just values in insertion order [k]<br>map.values()   returns just values in insertion order [v]</pre><p name="a7fd" id="a7fd" class="graf--p">In order to manipulate its content </p><pre name="7bc7" id="7bc7" class="graf--pre">map.has(key)  // boolean<br>map.set(key, value)<br>map.get(key) // value<br>map.delete(key)</pre><p name="c28d" id="c28d" class="graf--p"> Map implements the in-built iterable so it can be used with <em class="markup--em markup--p-em">for..of</em>.</p><p name="604a" id="604a" class="graf--p">You should be able to follow the code below now.</p><figure name="ae17" id="ae17" class="graf--figure graf--iframe"><div class="iframeContainer"><pre>let x = new Map([[1, 'is a number key']]);let today = new Date()//anything can be a keyx.set(today.toString(), 111)x.set(today, 222);x.delete(today.toString());console.log('The map contains', x.size, 'elements.');console.log('The map has a today Date key:', x.has(today));console.log('The map has a today string key:', x.has(today.toString()));//values and keysx.forEach((value, key, map) => console.log(value, key, map));//iterablefor (let value of x) {  console.log(value);}//iterable valuesfor (let value of x.values()) {  console.log(value);}//iterable keysfor (let value of x.keys()) { console.log(value);}//iterable entries (key, value)for (let value of x.entries()) {  console.log(value);}</pre></div></figure><h3 name="598d" id="598d" class="graf--h3">Promises</h3><p name="7714" id="7714" class="graf--p">Support for promises is a very nice addition to the language. The example below creates a promise that will call <em class="markup--em markup--p-em"> res </em>(resolve) after a second. Then immediately, after that, it will call <em class="markup--em markup--p-em">coolFn </em>logging "cool" to the console.</p><figure name="dc72" id= "dc72" class="graf--figure graf--iframe"><div class="iframeContainer"><pre>var longFn = function() {  return new Promise(function(res, rej) {    setTimeout(res, 1000);  });};var coolFn = function() {  console.log('cool');};// logs cool after 1 secondlongFn().then(coolFn);</pre></div></figure><h3 name="ba4c" id="ba4c" class="graf--h3 is-withNotes">Rest parameters</h3><p name="ce59" id="ce59" class="graf--p">Rest parameters remove the need of dealing with the <em class="markup--em markup--p-em">arguments </em>object<em class="markup--em markup--p-em">. </em>The syntax is pretty sleek. It takes a list of parameters converting them to an array. This will be dynamically handled matching the function signature definition. In the example, as <em class="markup--em markup--p-em">format </em>takes two parameters, the first one is taken by <em class="markup--em markup--p-em">str </em>and the rest are put together into <em class= "markup--em markup--p-em">args </em>as an array. Very handy!</p><figure name="49bc" id="49bc" class="graf--figure graf--iframe"><div class="iframeContainer"><pre>function format(str, ...args) {  return str.replace(/\{\s*(\d+)\s*\}/g, function(m, n) {    return args[n];  });}let msg = format(  'The {0}st arg is a string, the {1} are {2}.',  1,  'rest', 'unknown');console.log(msg);</pre></div></figure><h3 name="afd5" id="afd5" class="graf--h3">Sets</h3><p name="0547" id="0547" class="graf--p">Sets are a useful data-type for scenarios where we have to avoid repetitions and use heterogeneous data-types elements (String, Array, Number, etc.). Some common methods are:</p><pre name="4f50" id="4f50" class="graf--pre"> set.size       returns its size<br>set.entries()  returns entries in insertion order [v]<br>set.keys()     returns just values in insertion order [v]<br>set.values()   returns just values in insertion order [v]</pre><p name="186e" id="186e" class="graf--p">In order to manipulate its content</p><pre name="62a9" id="62a9" class="graf--pre">set.has(value)  // boolean<br> set.add(value)<br>set.delete(value)</pre><p name="5ae8" id="5ae8" class="graf--p">See the code below</p><figure name="2fc4" id="2fc4" class="graf--figure graf--iframe"><div class= "iframeContainer"><pre>let x = new Set([1, 2, 3, 4, 4, 4, 5]);x.add(6);x.delete(2);console.log('The set contains', x.size, 'elements.');console.log('The set has 1:', x.has(1));console.log('The set has 8:', x.has(8));//values and keys are the same in a setx.forEach((value, key, set) => console.log(value, key, set));//iterablefor (let value of x) { console.log(value);}//iterable valuesfor (let value of x.values()) {  console.log(value);}//iterable keysfor (let value of x.keys()) {  console.log(value);}//iterable entries (key, value)for (let value of x.entries()) {  console.log(value);}</pre></div></figure><h3 name="eced" id="eced" class="graf--h3">Spread operator</h3><p name="3316" id="3316" class="graf--p"> The spread operator works together with rest parameters in the sense that it takes and array to convert it into a list of parameters. You could rewrite the code as "...[5, 4]" or "...nums", both equivalent.</p><figure name="eb08" id="eb08" class="graf--figure graf--iframe"><div class="iframeContainer"><pre>function add(a, b) {  return a + b;}let nums = [5, 4];console.log(add(...nums));</pre></div></figure><h3 name="76c5" id="76c5" class="graf--h3">Template literals</h3><p name="eb09" id="eb09" class="graf--p">The best for the end! This feature almost removes the need for a complex template system. It uses the special character `<em class="markup--em markup--p-em">template literal</em>` to delimit a template literal string. We can then inject values into it by using <em class="markup--em markup--p-em">${value} </em>syntax<em class="markup--em markup--p-em">.</em></p><figure name="18e7" id="18e7" class ="graf--figure graf--iframe"><div class="iframeContainer"><pre>let person = {name: 'John Smith'};let tpl = `My name is ${person.name}.`;console.log(tpl);</pre></div></figure><p name="e0ea" id="e0ea" class="graf--p">Hope you enjoyed these ES6 fiddle commented examples! ^_^</p><h3 name="08d8" id="08d8" class="graf--h3">Resources</h3><p name="8865" id="8865" class="graf--p graf--last"><a href="http://www.es6fiddle.net/" data-href="http://www.es6fiddle.net/" class="markup--anchor markup--p-anchor" rel="nofollow">ES6 Fiddle</a>, <a href=" https://babeljs.io/repl/#?experimental=true&amp;playground=true&amp;evaluate=true&amp;loose=false&amp;spec=false&amp;code=" data-href=" https://babeljs.io/repl/#?experimental=true&amp;playground=true&amp;evaluate=true&amp;loose=false&amp;spec=false&amp;code=" class="markup--anchor markup--p-anchor" rel="nofollow"> Translate ES6 to ES5 online</a> from Babel</p></div>			</div>		<!--=========================			END : POST		=============================--> <!--=========================			START : POST		=============================-->		<div class="post-wrapper"><article class="article-single content--narrow">  <header class="article-single__header">    <h1 class="article-single__title">Instantiation Patterns In JavaScript</h1>    <div class="article-single__meta article-meta">      <ul class= "article-meta__items">        <li class="article-meta__item date">          <a href="/post/instantiation-patterns-in-javascript" class="article-meta__link">09/07/2015</a>        </li> <li class="article-meta__item category">                      <a href="http://callmenick.com/categories/tutorials" class="article-meta__link">Tutorials</a> </li>                      </ul>    </div>    <p class="article-single__excerpt">In this tutorial, we're going to talk a bit about JavaScript objects and dive into the four different object instantiation patterns.</p>  </header>  <div class="article-single__body">    <p>In a lot of my demos, there are bits of JavaScript that pave the way for visual interactivity. The great thing about those scripts though is that they are reusable as "instances" that can exist around each other, without ever interfering with each other. In other words, if we can have many buttons that perform the same set of functionality, without ever having to repeat that functionality or worry about it conflicting. These are in fact JavaScript objects with added functionality, and each object instance is responsible for itself.</p><p>In JavaScript, there are 4 instantiation patterns available to us. We'll go through each of them here, and discuss the pros and cons of each. In the end, I'll give my opinion on my favourite one. Here are the 4 patterns:</p><ol><li>Functional Instantiation</li><li> Functional-shared instantiation</li><li>Prototypal instantiation</li><li>Pseudoclassical instantiation</li></ol><p>Let's look at each of them below.</p><h2>Functional Instantiation</h2><p> Functional instantiation is at the root of object instantiation in JavaScript. We create a function, and inside it, we can create an empty object, some scoped variables, some instance variables, and some instance methods. At the end of it all, we can return that instance, so that every time the function is called, we have access to those methods. Here it is in action: </p><pre class=" language-javascript"><code class=" language-javascript"><span class="token comment" spellcheck="true">// Set up</span><span class="token keyword">var</span> Func <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation"> {</span>  <span class="token keyword">var</span> someInstance <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>  <span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">; </span>  <span class="token keyword">var</span> b <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>  someInstance<span class ="token punctuation">.</span>method1 <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token comment" spellcheck="true">// code for method1 here</span>  <span class="token punctuation">}</span> someInstance<span class="token punctuation">.</span>method2 <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token comment" spellcheck="true">// code for method2 here</span>  <span class="token punctuation">}</span>  someInstance<span class="token punctuation">.</span>logA <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">return</span> a<span class="token punctuation">; </span>  <span class="token punctuation">}</span>  <span class="token keyword">return</span> someInstance<span class="token punctuation">;</span><span class="token punctuation">} </span><span class="token comment" spellcheck="true">// Usage</span><span class="token keyword">var</span> myFunc <span class="token operator">=</span> <span class="token function">Func </span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>myFunc<span class="token punctuation">.</span><span class= "token function">logA</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck= "true">// returns a</span></code></pre><p><strong>Pros:</strong> This pattern is the easiest to follow, as everything exists inside the function. It's instantly obvious that those methods and variables belong to that function.</p><p><strong>Cons:</strong> This pattern creates a new set of functions in memory for each instance of the function <code>Func</code>. If you're creating a big app, it's ultimately just not suitable in terms of memory.</p><h2>Functional Shared Instantiation</h2><p>Functional-shared instantiation is similar to functional instantiation, but the methods are an extension of the function instead. Like before, we create an empty object inside our function and return that object. Before we return it though, we extend it with some function methods. For that, we'll need an extender function. Here's the code:</p><pre class=" language-javascript"><code class=" language-javascript"><span class= "token comment" spellcheck="true">// Set up</span><span class="token keyword">var</span> Func <span class="token operator">=</span> <span class="token keyword">function</span><span class= "token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token keyword">var</span> someInstance <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>  someInstance<span class="token punctuation">. </span>a <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>  someInstance<span class="token punctuation">.</span>b <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>  <span class="token function">extend</span><span class="token punctuation">( </span>someInstance<span class="token punctuation">,</span> funcMethods<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">return </span> someInstance<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">var</span> extend <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>to<span class="token punctuation">,</span> from<span class="token punctuation">)</span> <span class= "token punctuation">{</span>  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> key <span class="token keyword">in </span> from<span class="token punctuation">)</span> <span class="token punctuation">{</span>    to<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> from<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">var</span> funcMethods <span class="token operator">=</span> <span class="token punctuation">{ </span><span class="token punctuation">}</span><span class="token punctuation">;</span>funcMethods<span class="token punctuation">.</span>method1 <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token comment" spellcheck="true">// code for method1 here...</span><span class="token punctuation">}</span>funcMethods<span class="token punctuation">.</span>method2 <span class="token operator" >=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class= "token comment" spellcheck="true">// code for method2 here...</span><span class="token punctuation">}</span>funcMethods<span class="token punctuation">.</span>logA <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>a<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token comment" spellcheck="true">// Usage</span><span class="token keyword">var</span> myFunc <span class="token operator">=</span> <span class="token function">Func</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>myFunc<span class="token punctuation">. </span><span class="token function">logA</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// returns a</span></code></pre><p><strong>Pros:</strong> In this instantiation pattern, the object methods are referenced in memory, so object instances refer to those references when being called. This allows for great memory management.</p><p><strong>Cons:</strong> If we choose to edit some of the <code>funcMethods</code> at some point and then create a new object instance, the old and new instances will refer to different references of the method in memory. This can get confusing for some, but is a minor caveat once you're aware of it.</p><h2>Prototypal Instantiation</h2><p>Prototypal instantiation (which doesn't actually use the keyword <code>prototype</code>) is done by attaching methods directly to the object's prototype using the <code>Object.create()</code> method. It's fairly similar to the previous pattern, except this time, the returned object has prototypal methods that directly reference the <code>funcMethods</code> object. Check it out:</p><pre class=" language-javascript"><code class=" language-javascript"><span class="token comment" spellcheck="true">// Set up </span><span class="token keyword">var</span> Func <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class= "token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token keyword">var</span> someInstance <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>funcMethods<span class="token punctuation">)</span><span class="token punctuation">; </span>  someInstance<span class="token punctuation">.</span>a <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> someInstance<span class="token punctuation">.</span>b <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>  <span class="token keyword">return</span> someInstance<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">var</span> funcMethods <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>funcMethods<span class="token punctuation">. </span>method1 <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class ="token punctuation">{</span>  <span class="token comment" spellcheck="true">// code for method1 here...</span><span class="token punctuation">}</span>funcMethods<span class="token punctuation">.</span>method2 <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">) </span> <span class="token punctuation">{</span>  <span class="token comment" spellcheck="true">// code for method2 here...</span><span class="token punctuation">}</span>funcMethods<span class="token punctuation">.</span>logA <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>a <span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token comment" spellcheck="true">// Usage</span><span class="token keyword">var</span> myFunc <span class="token operator">=</span> <span class="token function">Func</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>myFunc<span class="token punctuation">.</span><span class="token function">logA</span><span class="token punctuation">(</span><span class="token punctuation">) </span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// returns a</span></code></pre><p><strong>Pros:</strong> This pattern attaches methods directly to the object's prototype, rather than as attachments to the returned objects like before. </p><p><strong>Cons:</strong> In my opinion, there is room for improvement on this pattern. Even though the pros are great, it's still a bit of a long-winded implementation.</p><h2>Pseudoclassical Instantiation</h2><p>The last (but note least) pattern is the pseudoclassical pattern, which takes a bit of the long-windedness out of the prototypal pattern. It does, as before, attach methods directly to the object's prototype. Another point of interest is the fact that the object's constructor is automatically included. This means that we can create new instances using the <code>new</code> keyword. The reason for this is that some behind the scenes work goes down in this pattern. Before and after all code in the object's body, <code>this = Object.create(Object.prototype);</code> and <code>return this;</code> get run in the background. Here's the pseudoclassical style in action:</p><pre class=" language-javascript"><code class=" language-javascript"><span class="token comment" spellcheck="true" >// Set up</span><span class="token keyword">var</span> Func <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token keyword">this</span><span class="token punctuation">.</span>a <span class="token operator">= </span> <span class="token number">0</span><span class="token punctuation">;</span>  <span class="token keyword">this</span><span class="token punctuation">.</span>b <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span><span class="token punctuation">}</span>Func<span class="token punctuation">.</span>prototype <span class="token punctuation">.</span>method1 <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token comment" spellcheck="true">// code for method1 here...</span><span class="token punctuation">}</span>Func <span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>method2 <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token comment" spellcheck="true">// code for method2 here...</span><span class="token punctuation">}</span>Func<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>logA <span class="token operator">= </span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class= "token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>a<span class="token punctuation">;</span><span class="token punctuation">} </span><span class="token keyword">var</span> myFunc <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Func</span><span class= "token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>myFunc<span class="token punctuation">.</span><span class="token function">logA </span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// returns a </span></code></pre><p><strong>Pros:</strong> For me, this feels the most natural when building up an object and attaching methods to it. Methods are attached directly to the prototype, instances are created with the <code>new</code> keyword, and the <code>this</code> keyword has a distinct scope. Rumour has it that it's the fastest instantiation pattern too, though I'm yet to test it myself.</p><p><strong>Cons:</strong> Newcomers to JavaScript might find this pattern a bit difficult to understand, especially if their grasp on the <code>this</code> keyword is not up to scratch.</p><h2>Wrap Up</h2><p>And that's a wrap! In this tutorial, we looked at the four different instantiation patterns available to us in JavaScript. Of the four patterns mentioned above, my favourite is the pseudoclassical pattern, for reasons mentioned above. If you've seen the scripts in some of my demos, you'd have noticed that this was (and is) my pattern of choice! Thanks for reading, and remember, if you have and questions, comments, or feedback, you can also leave them below.</p>  </div></article>			</div> <!--=========================			END : POST		=============================-->		<!--=========================			START : POST =============================-->		<div class="post-wrapper"><article class="article-single content--narrow">  <header class="article-single__header">    <h1 class= "article-single__title">Building With Flexbox</h1>    <div class="article-single__meta article-meta">      <ul class="article-meta__items">        <li class="article-meta__item date"> <a href="/post/flexbox-examples" class="article-meta__link">01/04/2015</a>        </li>                <li class="article-meta__item category">                      <a href=" http://callmenick.com/categories/tutorials" class="article-meta__link">Tutorials</a>                  </li>                      </ul>    </div>    <p class="article-single__excerpt">In this tutorial, we tackle some real world previously tricky scenarios, and build them with ease using flexbox.</p>  </header>  <div class="article-single__body">    <p class= "text-align--center"><a href="https://github.com/callmenick/Flexbox-Examples" class="button button--inline-block button--medium">Get Source</a><a href=" http://callmenick.com/_development/flexbox-examples/" class="button button--inline-block button--medium">View Demo</a></p><h2>Introduction</h2><p>A while back, I wrote an <a href=" http://www.sitepoint.com/are-we-ready-to-use-flexbox/">article for SitePoint introducing flexbox.</a> In that article, I investigated and tried to answer the question:</p><blockquote>	<p> Are we ready to use flexbox?</p></blockquote><p>Back then, I said you'd have to choose wisely when to use it, but insisted that you should start getting familiar with the syntax and incorporating it into your modern projects. Today, I'm happy to assertively answer the question one more time:</p><blockquote><p>Yes, we are ready to use flexbox!</p></blockquote><p>If you're unfamiliar with flexbox, then here's a quick primer. The <a href="https://developer.mozilla.org/en-US/docs/Web/Guide/CSS/Flexible_boxes">CSS Flexible Layout Module</a> is a layout module that allows us to easily layout boxes on the screen, given the available space. It is a big improvement over the traditional box model, given that it doesn't use floats at all. Boxes can be arranged in rows or columns, specific orders can be set for flexbox items, and there are a host of alignment, spacing, and sizing options.</p><p>I probably won't cover every single aspect in this tutorial, so I suggest you read up on the MDN link referenced above if you want to sharpen up your overall knowledge on the topic. Rather, this tutorial will address some common layout problems, and show how quickly and easily we can build them. Every layout pattern I present will also be responsive, further showing the ease in which we can build with flexbox. Here's what we'll tackle:</p><ol><li>A simple grid system</li><li>The holy grail layout</li><li>A fluid navigation with transitioning width search bar</li><li>Two different vertical alignment scenarios</li></ol><p>Alright, let's dive in!</p><h2>1 - A Simple Grid System</h2><p>Grid systems govern a big part of layouts today, and the default CSS box-model behaviour has resulted in us resorting to floated layouts or inline-block hacks, both of which have their share of quirks. Flexbox allows us to really easily develop a powerful and scalable grid system with just a few lines of CSS. Let's dig in.</p><p>Imagine we had some simple markup like this:</p><pre class=" language-html"><code class=" language-html"><span class= "token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>grid<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>  <span class="token tag" ><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">= </span><span class="token punctuation">"</span>grid__row<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">= </span><span class="token punctuation">"</span>grid__item<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>    <span class="token tag"><span class="token tag"><span class= "token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">" </span>grid__item<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>2<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>    ...  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span> div</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span></code></pre><p>In a traditional grid set up, we'd have to somehow state how many items the grid row might contain, and then set the widths for each item in the row accordingly. With flexbox, we can add as many items to the row as we want, and the widths will adjust accordingly. In other words, we can have markup like this, without having to worry about stating how many items exist in each row in the CSS:</p><pre class=" language-html"><code class=" language-html"><span class="token tag"><span class="token tag"><span class= "token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">" </span>grid<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span> grid__row<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span> grid__item<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>1<span class="token tag"><span class="token tag"><span class="token punctuation"> &lt;/</span>div</span><span class="token punctuation">&gt;</span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>grid__item<span class="token punctuation" >"</span></span><span class="token punctuation">&gt;</span></span>2<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class= "token punctuation">=</span><span class="token punctuation">"</span>grid__row<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>grid__item<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>    <span class="token tag"><span class="token tag" ><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>grid__item<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>2<span class="token tag"><span class="token tag"><span class ="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span> div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>grid__item<span class= "token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>3<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div </span><span class="token punctuation">&gt;</span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class ="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>grid__row<span class="token punctuation">"</span></span><span class="token punctuation"> &gt;</span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>grid__item<span class="token punctuation">"</span></span><span class="token punctuation">&gt; </span></span>1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>    <span class= "token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>grid__item<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>2<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>    <span class="token tag"><span class="token tag" ><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>grid__item<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>3<span class="token tag"><span class="token tag"><span class ="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span> div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>grid__item<span class= "token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>4<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div </span><span class="token punctuation">&gt;</span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt; </span></span></code></pre><p>Let's now look at the CSS for this. I'll use some properties purely for aesthetics (like the border and padding), but other than that, it's so simple. Here it is:</p><pre class=" language-css"><code class=" language-css"><span class="token selector"><span class="token class">.grid</span> </span><span class="token punctuation">{</span>  <span class="token property">border</span><span class="token punctuation">:</span> solid <span class="token number">1</span>px <span class="token hexcode">#e7e7e7</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token selector"><span class="token class">.grid__row</span> </span><span class="token punctuation">{</span>  <span class="token property">display</span><span class="token punctuation">:</span> flex<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token selector"><span class="token class">.grid__item</span> </span><span class="token punctuation">{</span>  <span class="token property">flex</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">;</span>  <span class="token property">padding</span><span class="token punctuation">:</span> <span class="token number"> 12</span>px<span class="token punctuation">;</span>  <span class="token property">border</span><span class="token punctuation">:</span> solid <span class="token number">1</span>px <span class="token hexcode">#e7e7e7</span><span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><p>Just like that, we have a grid in action! Adding the <code>display: flex</code> to the <code>.grid__row</code> containers creates a flex container, and each sub-item is a flex item as a result. Applying <code>flex: 1</code> to the flex items makes them occupy an equal amount of space relative to the full width of the container. Now you can have as many grid rows as you want, each with their own arbitrary amount of grid items, and it'll conform to a simple responsive grid with no further CSS required.</p><p>What about breakpoints and column layout? If we want the grid items to be in a column layout instead of a row, we can simply declare <code>flex-direction: column</code> on the <code>.grid__row</code> containers. In that case, we can create a super simple responsive layout by including some modifiers. So our markup might look like this:</p><pre class=" language-html"><code class=" language-html"><span class="token tag"><span class="token tag"><span class= "token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">" </span>grid<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span> grid__row grid__row--sm<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>    <span class="token tag"><span class="token tag"><span class= "token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">" </span>grid__item<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>    ...  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span> div</span><span class="token punctuation">&gt;</span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>grid__row grid__row--md<span class="token punctuation" >"</span></span><span class="token punctuation">&gt;</span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class= "token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>grid__item<span class="token punctuation">" </span></span><span class="token punctuation">&gt;</span></span>1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>    ...  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt; </span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>grid__row grid__row--lg<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>grid__item<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span> ...  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span></code></pre><p>And our revised CSS like this:</p><pre class=" language-css"><code class=" language-css"><span class="token selector"><span class="token class">.grid</span> </span><span class="token punctuation">{</span>  <span class="token property"> border</span><span class="token punctuation">:</span> solid <span class="token number">1</span>px <span class="token hexcode">#e7e7e7</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token selector"><span class="token class">.grid__row</span> </span><span class="token punctuation">{</span>  <span class="token property"> display</span><span class="token punctuation">:</span> flex<span class="token punctuation">;</span>  <span class="token property">flex-direction</span><span class="token punctuation">: </span> column<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token selector"><span class="token class">.grid__item</span> </span><span class= "token punctuation">{</span>  <span class="token property">flex</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token property">padding</span><span class="token punctuation">:</span> <span class="token number">12</span>px<span class="token punctuation">;</span>  <span class="token property">border</span><span class="token punctuation">:</span> solid <span class="token number">1</span>px <span class="token hexcode">#e7e7e7</span><span class="token punctuation">; </span><span class="token punctuation">}</span><span class="token atrule">@media all and ( min-width<span class="token punctuation">:</span> 480px )</span> <span class="token punctuation"> {</span>  <span class="token selector"><span class="token class">.grid__row--sm</span> </span><span class="token punctuation">{</span>    <span class="token property">flex-direction </span><span class="token punctuation">:</span> row<span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">}</span><span class= "token atrule">@media all and ( min-width<span class="token punctuation">:</span> 720px )</span> <span class="token punctuation">{</span>  <span class="token selector"><span class="token class">.grid__row--md</span> </span><span class="token punctuation">{</span>    <span class="token property">flex-direction</span><span class="token punctuation">:</span> row<span class= "token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token atrule">@media all and ( min-width<span class="token punctuation">:</span> 960px )</span> <span class="token punctuation">{</span>  <span class="token selector"><span class="token class">.grid__row--lg</span> </span><span class="token punctuation">{</span>    <span class="token property">flex-direction</span><span class="token punctuation">:</span> row<span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">}</span></code></pre><p>And voila. A super simple responsive grid system with just a few lines of CSS. This system is so bullet-proof as it stands, that you can even nest grids without having to worry about a thing:</p><pre class=" language-html"><code class=" language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class= "token punctuation">"</span>grid<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>grid__row grid__row--sm<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class= "token punctuation">"</span>grid__item<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>      <span class="token tag"><span class="token tag" ><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>grid<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>grid__row grid__row--lg<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>          <span class="token tag"><span class= "token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>grid__item<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>Nested 1<span class="token tag"><span class= "token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>          ...        <span class="token tag"><span class="token tag" ><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div </span><span class="token punctuation">&gt;</span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>grid__item<span class="token punctuation">" </span></span><span class="token punctuation">&gt;</span></span>2<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class= "token punctuation">=</span><span class="token punctuation">"</span>grid__row grid__row--md<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>grid__item<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>    ...  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class= "token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span></code></pre><p>Check out the <a href=" http://callmenick.com/_development/flexbox-examples/index.html">demo in action here.</a></p><h2>2 - The Holy Grail Layout</h2><p>The holy grail layout is pretty famous in web design, and even in the age of web applications and all that jazz, this layout still plays a very important part on the web today - content-rich sites employ it heavily. Back in 2006, the holy grail layout was beautifully achieved and <a href="http://alistapart.com/article/holygrail">documented on A List Apart</a>. It utilised floats, negative margins, and minimum widths to ensure that combined sizes don't conflict and break the layout. All that, combined with the modern day necessity to employ a responsive layout, meant a lot of number crunching, float clearing, and other sorceries to get it right. And if you decided to change the width of your sidebar, well you'd have to cascade the math into all the other components.</p><p>Flexbox eases up the headache quite a bit, as we can specify column or row layouts, and also explicitly set the order of elements in the CSS, even if they appear in a different order in the markup. Here's a typical holy grail setup:</p><pre class=" language-html"><code class=" language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>holy-grail<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>header</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>holy-grail__header<span class= "token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>header </span><span class="token punctuation">&gt;</span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>main</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>holy-grail__body<span class="token punctuation">" </span></span><span class="token punctuation">&gt;</span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class= "token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>holy-grail__content<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class </span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>holy-grail__sidebar holy-grail__sidebar--first<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class </span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>holy-grail__sidebar holy-grail__sidebar--second<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt; </span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>footer</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>holy-grail__footer<span class="token punctuation">"</span></span><span class="token punctuation" >&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>footer</span><span class="token punctuation">&gt;</span></span><span class= "token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span></code></pre><p>In my demo, the holy grail layout is nested inside a document, so there's no <code>body</code> or <code>main</code> tags like shown above. Regardless, we're interested in the class names and the appearance of sections in the markup as opposed to the actual elements themselves. In particular, take note of the modifier classes used on the two sidebars, and the trivial order in which they appear in the markup. Let's break this down to paint a clear picture of what's happening:</p><ol><li>We have a parent container, <code>.holy-grail</code>, and in it we have three flex items. These items are <code>.holy-grail__header</code>, <code>holy-grail__body</code>, and <code>holy-grail__footer</code>.</li><li>The three of these items are stacked on top of each other, and occupy 100% width of the screen. Therefore, the flex container must have a columnar flex direction.</li><li>The body of the holy grail, governed by <code>.holy-grail__body</code>, is a sub flex container. It's child flex items should have a columnar layout on narrow screens, and a row layout on wider screens.</li></ol><p>Taking into consideration all of the above, let's build our holy grail layout:</p><pre class=" language-css"><code class=" language-css"><span class="token selector"><span class="token class">.holy-grail</span> </span><span class= "token punctuation">{</span>  <span class="token property">display</span><span class="token punctuation">:</span> flex<span class="token punctuation">;</span>  <span class="token property" >flex-direction</span><span class="token punctuation">:</span> column<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token selector"><span class="token class">.holy-grail__header</span>,<span class="token class">.holy-grail__footer</span> </span><span class="token punctuation">{</span>  <span class="token property">flex </span><span class="token punctuation">:</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">100%</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token selector"><span class="token class">.holy-grail__body</span> </span><span class="token punctuation">{</span> <span class="token property">display</span><span class="token punctuation">:</span> flex<span class="token punctuation">;</span><span class="token punctuation">}</span><span class= "token selector"><span class="token class">.holy-grail__sidebar</span> </span><span class="token punctuation">{</span>  <span class="token comment" spellcheck="true">/* nothing at narrow screens */</span><span class="token punctuation">}</span><span class="token selector"><span class="token class">.holy-grail__sidebar--first</span> </span><span class="token punctuation">{ </span>  <span class="token property">order</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token selector"><span class="token class">.holy-grail__sidebar--second</span> </span><span class="token punctuation">{</span>  <span class="token property">order</span><span class="token punctuation">:</span> <span class="token number">3</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token selector"><span class="token class">.holy-grail__content</span> </span><span class="token punctuation">{</span>  <span class="token property">order</span><span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token atrule">@media all and ( min-width<span class="token punctuation">:</span> 720px )</span> <span class="token punctuation">{</span>  <span class="token selector"><span class="token class">.holy-grail__body</span> </span><span class="token punctuation">{</span>    <span class="token property">flex-direction</span><span class="token punctuation">:</span> row<span class="token punctuation">;</span> <span class="token punctuation">}</span>  <span class="token selector"><span class="token class">.holy-grail__sidebar</span> </span><span class="token punctuation">{</span>    <span class= "token property">flex</span><span class="token punctuation">:</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">180</span>px<span class="token punctuation">;</span>  <span class="token punctuation">}</span>  <span class="token selector"><span class="token class">.holy-grail__content</span> </span><span class="token punctuation">{</span>    <span class="token property">flex</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token atrule">@media all and ( min-width<span class="token punctuation">:</span> 960px )</span> <span class="token punctuation">{</span>  <span class="token selector"><span class="token class">.holy-grail__sidebar</span> </span><span class="token punctuation">{</span>    <span class= "token property">flex</span><span class="token punctuation">:</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">240</span>px<span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">}</span></code></pre><p>It really doesn't get simpler than that! As I mentioned before in the breakdown, we're setting up two flex containers in the initial view (narrow screens). At our first breakpoint, we change the flex direction of the body to take on a row pattern, and give the sidebars a width of 180px using the shorthand <code>flex</code> property. This shorthand property allows us to restrict the <code>flex-grow</code> and <code> flex-shrink</code> properties up front, and explicitly declare the width. The content uses the <code>flex: 1</code> property to make it fill the available space. Ordering the flex items was also a breeze using the simple <code>order</code> property. There's not much more to it besides some aesthetic styles that you might want to include...it really is that simple and effective. Did I mention that by default, flexbox makes the columns equal height? <a href="http://callmenick.com/_development/flexbox-examples/index2.html">Check out the demo here. </a></p><h2>3 - Fluid Navigation With Animating Search Bar</h2><p>In our next example, we're going to create something a little fun that includes a neat transition. We'll build a full width fluid navigation, and in it, we'll include a search bar that transitions smoothly to a bigger width on focus. By leveraging the power of flexbox, we want to be able to add as many items to the navigation as we want without having to alter the CSS. I'll use some modifier classes to achieve what I want. As a little bonus, I'm going to make the navigation fully responsive with a toggle button included! Here's what the HTML looks like:</p><pre class=" language-html"><code class=" language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>nav</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>flexy-nav<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>  <span class="token tag"><span class="token tag"><span class ="token punctuation">&lt;</span>button</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation"> "</span>flexy-nav__toggle<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">= </span><span class="token punctuation">"</span>flexy-nav__toggle<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>Toggle Nav<span class= "token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ul</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>flexy-nav__items<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>flexy-nav__items<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>flexy-nav__item<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class= "token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>flexy-nav__link<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span> Item 1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>    <span class="token tag"><span class="token tag"><span class= "token punctuation">&lt;</span>li</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">" </span>flexy-nav__item<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span># <span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>flexy-nav__link<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>Item 2<span class="token tag"><span class="token tag" ><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/ </span>li</span><span class="token punctuation">&gt;</span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span> <span class= "token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>flexy-nav__item<span class="token punctuation"> "</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>flexy-nav__link<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>Item 3<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a </span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>flexy-nav__item<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class= "token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#<span class="token punctuation">"</span></span> <span class="token attr-name">class </span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>flexy-nav__link<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>Item 4<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt; </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ul</span><span class="token punctuation">&gt;</span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span> <span class="token attr-name">action</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span><span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>flexy-nav__form<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>    <span class="token tag"><span class= "token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>flexy-nav__search<span class="token punctuation">"</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class= "token punctuation">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token attr-name">placeholder</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>Type search terms and hit enter...<span class="token punctuation">"</span></span><span class= "token punctuation">&gt;</span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">&gt; </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>nav</span><span class="token punctuation">&gt;</span></span></code></pre><p>Let's break it down before diving into the CSS. We have our main flex container governed by the <code>.flexy-nav</code> class. The button acts as the toggle switch, the unordered list houses the main navigation items, and the form holds the search bar. In the narrow screen setup, we want all three items to be in columnar layout, and we also want the individual list items to be in a column also. On a wider screen, we want to hide the toggle switch, make the unordered list a flex container, distribute the list items in a row, and make the form a fixed width. The list items will be evenly distributed in the remaining space as a result. When we focus on the input text field, we want to see it transition smoothly to a wider width, while all the list items shrink smoothly. Here's the CSS:</p><pre class=" language-css"><code class=" language-css"><span class="token comment" spellcheck="true">/* resets */</span><span class="token selector">input,button </span><span class="token punctuation">{</span>  <span class="token property">font</span><span class="token punctuation">:</span> inherit<span class="token punctuation">;</span>  <span class="token property">border-radius</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span>  <span class="token property"> box-shadow</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span>  <span class="token property">appearance</span><span class="token punctuation">: </span> none<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token selector">button </span><span class="token punctuation">{</span>  <span class ="token property">cursor</span><span class="token punctuation">:</span> pointer<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token comment" spellcheck="true">/* nav container */</span><span class="token selector"><span class="token class">.flexy-nav</span> </span><span class="token punctuation">{</span>  <span class="token property">display</span><span class="token punctuation">:</span> flex<span class="token punctuation">;</span>  <span class="token property">flex-direction</span><span class="token punctuation">:</span> column<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token comment" spellcheck="true">/* nav links */</span><span class= "token selector"><span class="token class">.flexy-nav__items</span> </span><span class="token punctuation">{</span>  <span class="token property">display</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span>  <span class="token property">flex</span><span class="token punctuation">:</span> <span class="token number">1 </span><span class="token punctuation">;</span>  <span class="token property">flex-direction</span><span class="token punctuation">:</span> column<span class="token punctuation">;</span> <span class="token property">list-style</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span>  <span class="token property">margin</span><span class= "token punctuation">:</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">4</span>px <span class="token number">0</span><span class= "token punctuation">;</span>  <span class="token property">padding</span><span class="token punctuation">:</span> <span class="token number">4</span>px<span class="token punctuation">; </span>  <span class="token property">text-align</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token selector"><span class="token class">.flexy-nav__items--visible</span> </span><span class="token punctuation">{</span>  <span class="token property">display</span><span class= "token punctuation">:</span> flex<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token selector"><span class="token class">.flexy-nav__item </span> </span><span class="token punctuation">{</span>  <span class="token property">background-color</span><span class="token punctuation">:</span> <span class="token hexcode">#f1f1f1 </span><span class="token punctuation">;</span>  <span class="token property">border-bottom</span><span class="token punctuation">:</span> solid <span class="token number">1</span>px <span class="token hexcode">#e7e7e7</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token selector"><span class="token class">.flexy-nav__item </span><span class="token pseudo-class">:last-child</span> </span><span class="token punctuation">{</span>  <span class="token property">border-bottom</span><span class="token punctuation" >:</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token selector"><span class="token class"> .flexy-nav__link</span> </span><span class="token punctuation">{</span>  <span class="token property">padding</span><span class="token punctuation">:</span> <span class="token number">8 </span>px<span class="token punctuation">;</span>  <span class="token property">display</span><span class="token punctuation">:</span> block<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token comment" spellcheck="true">/* nav toggle */</span><span class="token selector"><span class="token class">.flexy-nav__toggle</span> </span><span class="token punctuation">{</span>  <span class="token property">margin</span><span class="token punctuation">:</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">4</span>px <span class="token number">0</span><span class="token punctuation">;</span>  <span class="token property">padding</span><span class= "token punctuation">:</span> <span class="token number">4</span>px<span class="token punctuation">;</span>  <span class="token property">color</span><span class="token punctuation">: </span> <span class="token hexcode">#fff</span><span class="token punctuation">;</span>  <span class="token property">background-color</span><span class="token punctuation">:</span> <span class="token hexcode">#f07850</span><span class="token punctuation">;</span>  <span class="token property">border</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token selector"><span class="token class">.flexy-nav__toggle</span><span class="token pseudo-class">:hover</span>, <span class="token class">.flexy-nav__toggle</span><span class="token pseudo-class">:focus</span> </span><span class="token punctuation">{</span>  <span class="token property">outline </span><span class="token punctuation">:</span> none<span class="token punctuation">;</span>  <span class="token property">background-color</span><span class="token punctuation">:</span> <span class="token hexcode">#c93f11</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token comment" spellcheck="true">/* nav form */ </span><span class="token selector"><span class="token class">.flexy-nav__form</span> </span><span class="token punctuation">{</span>  <span class="token property">height</span><span class ="token punctuation">:</span> <span class="token number">48</span>px<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token selector"><span class ="token class">.flexy-nav__search</span> </span><span class="token punctuation">{</span>  <span class="token property">display</span><span class="token punctuation">:</span> block<span class="token punctuation">;</span>  <span class="token property">margin</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">; </span>  <span class="token property">padding</span><span class="token punctuation">:</span> <span class="token number">0</span> <span class="token number">4</span>px<span class="token punctuation">;</span>  <span class="token property">width</span><span class="token punctuation">:</span> <span class="token number">100%</span><span class="token punctuation">;</span> <span class="token property">height</span><span class="token punctuation">:</span> <span class="token number">48</span>px<span class="token punctuation">;</span>  <span class="token property">color</span><span class="token punctuation">:</span> <span class="token hexcode">#6d6d6d</span><span class="token punctuation">;</span>  <span class="token property"> background-color</span><span class="token punctuation">:</span> <span class="token hexcode">#fff</span><span class="token punctuation">;</span>  <span class="token property">border </span><span class="token punctuation">:</span> solid <span class="token number">2</span>px <span class="token hexcode">#e7e7e7</span><span class="token punctuation">;</span><span class= "token punctuation">}</span><span class="token selector"><span class="token class">.flexy-nav__search</span><span class="token pseudo-class">:focus</span> </span><span class="token punctuation">{</span>  <span class="token property">outline</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span>  <span class="token property">border </span><span class="token punctuation">:</span> solid <span class="token number">2</span>px <span class="token hexcode">#6d6d6d</span><span class="token punctuation">;</span><span class= "token punctuation">}</span><span class="token comment" spellcheck="true">/* media queries */</span><span class="token atrule">@media all and (min-width<span class="token punctuation">: </span> 768px)</span> <span class="token punctuation">{</span>  <span class="token selector"><span class="token class">.flexy-nav</span> </span><span class="token punctuation">{</span> <span class="token property">flex-direction</span><span class="token punctuation">:</span> row<span class="token punctuation">;</span>  <span class="token punctuation">}</span>  <span class="token selector"><span class="token class">.flexy-nav__items</span> </span><span class="token punctuation">{</span>    <span class="token property">display</span><span class="token punctuation">:</span> flex<span class="token punctuation">;</span>    <span class="token property">flex-direction</span><span class="token punctuation">:</span> row<span class="token punctuation">;</span>    <span class="token property">margin</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token property">padding</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token property">height</span><span class="token punctuation">:</span> <span class="token number">48</span>px<span class="token punctuation">;</span>  <span class="token punctuation">}</span> <span class="token selector"><span class="token class">.flexy-nav__item</span> </span><span class="token punctuation">{</span>    <span class="token property">flex</span><span class= "token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">;</span>    <span class="token property">margin-right</span><span class="token punctuation"> :</span> <span class="token number">4</span>px<span class="token punctuation">;</span>    <span class="token property">border-bottom</span><span class="token punctuation">:</span> none <span class="token punctuation">;</span>  <span class="token punctuation">}</span>  <span class="token selector"><span class="token class">.flexy-nav__link</span> </span><span class= "token punctuation">{</span>    <span class="token property">padding</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">; </span>    <span class="token property">line-height</span><span class="token punctuation">:</span> <span class="token number">48</span>px<span class="token punctuation">;</span>  <span class="token punctuation">}</span>  <span class="token selector"><span class="token class">.flexy-nav__toggle</span> </span><span class="token punctuation">{</span>    <span class="token property">display</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span>  <span class="token punctuation">}</span>  <span class="token selector"><span class="token class">.flexy-nav__form</span> </span><span class="token punctuation">{</span>    <span class="token property">flex</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span>  <span class="token punctuation">}</span>  <span class="token selector"><span class="token class">.flexy-nav__search</span> </span><span class="token punctuation">{</span>    <span class="token property">width</span><span class="token punctuation">:</span> <span class="token number">240</span>px<span class="token punctuation">;</span> <span class="token property">transition</span><span class="token punctuation">:</span> width <span class="token number">0.3</span>s<span class="token punctuation">;</span>  <span class ="token punctuation">}</span>  <span class="token selector"><span class="token class">.flexy-nav__search</span><span class="token pseudo-class">:focus</span> </span><span class="token punctuation">{</span>    <span class="token property">width</span><span class="token punctuation">:</span> <span class="token number">360</span>px<span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">}</span></code></pre><p>As promised, here's a ridiculously simple JavaScript snippet to show and hide the navigation on narrow screens:</p><pre class=" language-javascript"><code class=" language-javascript"><span class="token punctuation">(</span><span class="token keyword">function </span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token keyword">var</span> toggle <span class= "token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">"#flexy-nav__toggle"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">var</span> nav <span class="token operator" >=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string"> "#flexy-nav__items"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  toggle<span class="token punctuation">.</span><span class="token function"> addEventListener</span><span class="token punctuation">(</span><span class="token string">"click"</span><span class="token punctuation">,</span> <span class="token keyword">function </span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>    e<span class="token punctuation">.</span><span class= "token function">preventDefault</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    nav<span class="token punctuation">.</span>classList<span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span><span class="token string"> "flexy-nav__items--visible"</span><span class="token punctuation">)</span> <span class="token operator">?</span> nav<span class="token punctuation">.</span>classList<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span><span class="token string">"flexy-nav__items--visible"</span><span class="token punctuation">)</span> <span class="token punctuation">:</span> nav<span class="token punctuation">.</span>classList<span class="token punctuation">.</span><span class="token function">add </span><span class="token punctuation">(</span><span class="token string">"flexy-nav__items--visible"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>Simple as that. We've just created a neat and scalable fluid navigation with flexbox, and incorporated a neat search-bar transition too. We can add and remove links as we please or change up the dimensions on the search bar on the fly without affecting the functionality one bit. Ah, the joys of flexbox. Don't forget to check out the <a href=" http://callmenick.com/_development/flexbox-examples/index3.html">demo for this one here.</a></p><h2>4 - Vertical Alignment</h2><p>Let's face it, vertical alignment with traditional CSS sucks. Inline-block elements can sometimes help out, there are some absolute position hacks, and there is the old-school table layouts (which don't semantically apply to many situations today). All of them have there big quirks though, and always require some kinds of extra sorcery to make them work.</p><p>Flexbox takes care of this so easily. We're going to look at two examples that involve vertical alignment:</p><ol><li>First, we'll look at a media object type setup, where we have a user's avatar to the left, and their name and some info to the right. We will use flexbox to make sure the image and the body are perfectly vertically aligned.</li><li>Next, we'll look at simply vertically (and horizontally) aligning an element of fixed width and variable height in a container. As the element grows in height, it remains perfectly centred.</li></ol><p>Let's start with the first one. As mentioned, we want a user avatar to the left, and a description to the right. No matter how long or short the description gets though, we want it to always remain perfectly vertically aligned with the avatar. Here's some typical markup:</p><pre class=" language-html"><code class=" language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>user<span class="token punctuation">" </span></span><span class="token punctuation">&gt;</span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>user__avatar<span class="token punctuation">" </span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class ="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>user__description<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h2</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>user__username<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>John Doe<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h2</span><span class="token punctuation">&gt; </span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>user__excerpt<span class="token punctuation">"</span></span><span class="token punctuation">&gt; </span></span>I'm John Doe...<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class= "token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span> user<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt; </span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>user__avatar<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div </span><span class="token punctuation">&gt;</span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>user__description<span class="token punctuation">" </span></span><span class="token punctuation">&gt;</span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h2</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>user__username<span class="token punctuation">" </span></span><span class="token punctuation">&gt;</span></span>Harry Potter<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h2</span><span class ="token punctuation">&gt;</span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span> <span class="token attr-name">class </span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>user__excerpt<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>I'm Harry Potter...with a really long description...<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span> p</span><span class="token punctuation">&gt;</span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt; </span></span></code></pre><p>Before digging into the CSS, take note that we'll use a property that we haven't seen before. It's the <code>align-items</code> property, and it allows us to align items along the current flex line in the perpendicular direction. In other words, if our flex line is running horizontally, we can align them based on the perpendicular line. In our case, we want to center-align them, so we can just use <code>align-items: center</code>. Here's the CSS:</p><pre class=" language-css"><code class=" language-css"><span class="token selector"><span class="token class">.user</span> </span><span class="token punctuation">{</span>  <span class="token property">display</span><span class="token punctuation">:</span> flex <span class="token punctuation">;</span>  <span class="token property">align-items</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span><span class= "token punctuation">}</span><span class="token selector"><span class="token class">.user</span><span class="token pseudo-class">:last-child</span> </span><span class="token punctuation">{ </span>  <span class="token property">margin-bottom</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">;</span><span class= "token punctuation">}</span><span class="token selector"><span class="token class">.user__avatar</span> </span><span class="token punctuation">{</span>  <span class="token property">flex </span><span class="token punctuation">:</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">96</span>px<span class="token punctuation">;</span>  <span class="token property">width</span><span class="token punctuation">:</span> <span class="token number">96</span>px<span class="token punctuation">;</span> <span class="token property">height</span><span class="token punctuation">:</span> <span class="token number">96</span>px<span class="token punctuation">;</span>  <span class="token property">background-color</span><span class="token punctuation">:</span> <span class="token hexcode">#e7e7e7</span><span class="token punctuation">;</span><span class="token punctuation"> }</span><span class="token selector"><span class="token class">.user__description</span> </span><span class="token punctuation">{</span>  <span class="token property">flex</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">;</span>  <span class="token property">margin-left</span><span class="token punctuation">:</span> <span class="token number">24</span>px<span class="token punctuation">;</span>  <span class="token property">padding</span><span class="token punctuation">:</span> <span class="token number">12</span>px<span class="token punctuation">;</span>  <span class="token property">border</span><span class="token punctuation">:</span> solid <span class="token number">1</span>px <span class="token hexcode">#e7e7e7</span><span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><p>Easy as that. You can style up the text as you please, make those descriptions as long as you want, or change up the avatar size. It doesn't matter, the functionality will remain the same. <a href=" http://callmenick.com/_development/flexbox-examples/index4.html">Check out the demo to see it in action.</a></p><p>Let's move on to the second part of our vertical alignment series. This time, let's imagine we have a banner image at the top of our markup, and inside the banner, we want some headline text. On small screens, the height of the banner will be 180px, and it'll break two more times up to a height of 480px. At all points in time, we want our headline text inside this banner to be perfectly centred, both horizontally and vertically. Here's the typical markup:</p><pre class=" language-html"><code class=" language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>banner<span class="token punctuation">" </span></span><span class="token punctuation">&gt;</span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>banner__content<span class="token punctuation">" </span></span><span class="token punctuation">&gt;</span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h2</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>banner__title<span class="token punctuation">" </span></span><span class="token punctuation">&gt;</span></span>Symmetrical Perfection<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h2 </span><span class="token punctuation">&gt;</span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>banner__sub<span class="token punctuation">" </span></span><span class="token punctuation">&gt;</span></span>A beautiful sight, achieved with flexbox.<span class="token tag"><span class="token tag"><span class="token punctuation"> &lt;/</span>span</span><span class="token punctuation">&gt;</span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class ="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt; </span></span></code></pre><p>This time, we'll also leverage the <code>justify-content</code> property which will allow us to distribute space around items along the flex line. Here's the CSS:</p><pre class=" language-css"><code class=" language-css"><span class="token selector"><span class="token class">.banner</span> </span><span class="token punctuation">{</span>  <span class="token property">display</span><span class="token punctuation">:</span> flex<span class="token punctuation">;</span>  <span class="token property">align-items</span><span class= "token punctuation">:</span> center<span class="token punctuation">;</span>  <span class="token property">justify-content</span><span class="token punctuation">:</span> space-around<span class="token punctuation">;</span>  <span class="token property">height</span><span class="token punctuation">:</span> <span class="token number">180</span>px<span class="token punctuation">;</span>  <span class="token property">background-color</span><span class="token punctuation">:</span> <span class="token hexcode">#e7e7e7</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token selector"><span class="token class">.banner__content</span> </span><span class="token punctuation">{</span> <span class="token property">text-align</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span><span class="token punctuation">}</span><span class= "token selector"><span class="token class">.banner__title</span>,<span class="token class">.banner__sub</span> </span><span class="token punctuation">{</span>  <span class="token property" >margin</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">;</span>  <span class="token property">padding</span><span class= "token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">;</span>  <span class="token property">line-height</span><span class="token punctuation">: </span> <span class="token number">1.5</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token atrule">@media all and ( min-width<span class="token punctuation">:</span> 480px )</span> <span class="token punctuation">{</span>  <span class="token selector"><span class="token class">.banner</span> </span><span class="token punctuation">{</span>    <span class="token property">height</span><span class="token punctuation">:</span> <span class="token number">240</span>px<span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token atrule">@media all and ( min-width<span class="token punctuation">:</span> 768px ) </span> <span class="token punctuation">{</span>  <span class="token selector"><span class="token class">.banner</span> </span><span class="token punctuation">{</span>    <span class= "token property">height</span><span class="token punctuation">:</span> <span class="token number">360</span>px<span class="token punctuation">;</span>  <span class="token punctuation">} </span><span class="token punctuation">}</span><span class="token atrule">@media all and ( min-width<span class="token punctuation">:</span> 960px )</span> <span class="token punctuation"> {</span>  <span class="token selector"><span class="token class">.banner</span> </span><span class="token punctuation">{</span>    <span class="token property">height</span><span class= "token punctuation">:</span> <span class="token number">480</span>px<span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">} </span></code></pre><p>No matter how tall we make the banner, the content will remain vertically and horizontally centred, and such is the power of flexbox. Don't forget to <a href=" http://callmenick.com/_development/flexbox-examples/index4.html">check out the demo.</a></p><h2>Support &amp; Vendor Prefixes</h2><p>Know your market...that is the key word. Flexbox is supported by all modern browsers, including IE10 and up. If you're building modern web applications, flexbox is a powerhouse of a tool, and I'd highly recommend it. If you're building or revamping a website, check your analytics for your target audience. Nowadays, it's highly likely that 99% and up of your audience is using a modern browser.</p><p>As far as vendor prefixes go, flexbox is full of them. It's straight up insane to even think about using flexbox seriously, and hardcoding all the vendor prefixes yourself. I personally use a task runner (Gulp) to auto-prefix my CSS. You should certainly look into implementing a task runner into your workflow, even if you're not using flexbox.</p><h2>Wrap Up</h2><p>And that's a wrap! I'll end off on this note. If you're looking for a production website that heavily employs flexbox, look no further. The new callmenick.com uses it for just about everything! Thanks for reading, and don't forget, you can view the demo and download the source by clicking the links below. If you have and questions, comments, or feedback, you can also leave them below.</p><p class="text-align--center"><a href="https://github.com/callmenick/Flexbox-Examples" class="button button--inline-block button--medium">Get Source</a><a href=" http://callmenick.com/_development/flexbox-examples/" class="button button--inline-block button--medium">View Demo</a></p>  </div></article>			</div> <!--=========================			END : POST		=============================-->		<!--=========================			START : POST =============================-->		<div class="post-wrapper"><article class="article-single content--narrow">  <header class="article-single__header">    <h1 class= "article-single__title">JavaScript Objects &amp; Building A JavaScript Component – Part 1</h1>    <div class="article-single__meta article-meta">      <ul class="article-meta__items"> <li class="article-meta__item date">          <a href="/post/javascript-objects-building-javascript-component-part-1" class="article-meta__link">28/07/2014</a>        </li> <li class="article-meta__item category">                      <a href="http://callmenick.com/categories/tutorials" class="article-meta__link">Tutorials</a> </li>                      </ul>    </div>    <p class="article-single__excerpt">Here's part 1 of a 2-part tutorial that dives into JavaScript objects, prototype programming, and building a simple reusable JavaScript component.</p>  </header>  <div class="article-single__body">    <h2>Introduction</h2><p>In this two-part tutorial, we're going to take a look at JavaScript objects, prototype programming, and building our very first JavaScript component that we can reuse and extend in various parts of our application. Let's get started!</p><h2>About Objects &amp; JavaScript</h2><p>Think of an object as a collection of <em>things</em>. For example, imagine you have a bicycle. That bike is you object, and has a collection of <em>things</em> called <strong>properties</strong>. An example of a property would be the bike's model, the year is was made, and its components. Its components might then have its own set of properties, like the brakes, seat, derailleur, wheels, etc. These are all properties of the "bike" object. Pretty straightforward, yes?</p><p>JavaScript by nature is an object-based language, where everything has its own set of properties that we can access. Here's a more formal definition from the MDN:</p><blockquote><p>JavaScript is designed on a simple object-based paradigm. An object is a collection of properties, and a property is an association between a name and a value. A property's value can be a function, in which case the property is known as a method. In addition to objects that are predefined in the browser, you can define your own objects.</p></blockquote><p>That's neat...not only are we provided a set of predefined objects in the browser, but we can create our own. In JavaScript, we access an object's properties via the dot notation. But first, let's take a quick look at the creation and instantiation of an object.</p><h2>Creation Of An Object</h2><p>You've probably created or used objects in JavaScript without even knowing it. That's because almost everything in JavaScript is an object. Here's a note from the MDN:</p><blockquote><p>All primitive types except <code>null</code> and <code>undefined</code> are treated as objects. They can be assigned properties (assigned properties of some types are not persistent), and they have all characteristics of objects.</p></blockquote><p>While there are a vast number of predefined objects at our disposal, I won't be going through any of that. From this point on, and throughout the rest of this tutorial, we're going to build a very simple JavaScript component called SimpleAlert. With that in mind, let's create our own object.</p><pre class=" language-javascript"><code class=" language-javascript"><span class="token keyword">var</span> simpleAlert <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Object</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>And that's it! Pretty easy, huh? This is clearly useless though, unless we add some properties to it. We can do this by using the dot notation. Let's add some.</p><pre class=" language-javascript"><code class=" language-javascript"><span class="token comment" spellcheck="true">// create new object</span><span class="token keyword">var</span> simpleAlert <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Object </span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// add some properties</span>simpleAlert<span class="token punctuation">.</span>sa_default <span class="token operator">=</span> <span class="token string">"Hello World!"</span><span class="token punctuation">;</span>simpleAlert<span class="token punctuation">.</span>sa_error <span class="token operator">=</span> <span class="token string">"Error..."</span><span class="token punctuation">;</span>simpleAlert<span class="token punctuation">.</span>sa_success <span class="token operator">=</span> <span class="token string">"Success!"</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// output object in the console</span>console<span class="token punctuation">.</span><span class="token function">log </span><span class="token punctuation">(</span>simpleAlert<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>From the console, we can see that our object now has three properties. Since we set these properties above, we can now access them anywhere in our script. For example, if we wanted to send an error alert to the user, we could do this:</p><pre class=" language-javascript"><code class=" language-javascript"><span class="token comment" spellcheck="true">// alert error message</span><span class="token function">alert</span><span class="token punctuation">(</span>simpleAlert<span class="token punctuation">.</span>sa_error<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>This is just one way to create an object and access its properties.</p><h2>Creating Objects With Object Initializers</h2><p>Another way is using what's called "object initialisers". According to the MDN:</p><blockquote><p>...you can create objects using an object initializer. Using object initializers is sometimes referred to as creating objects with literal notation. "Object initializer" is consistent with the terminology used by C++.</p></blockquote><p>Restructuring the creation of our SimpleAlert object would be as easy as this:</p><pre class=" language-javascript"><code class=" language-javascript"><span class="token comment" spellcheck="true">// create new object</span><span class="token keyword">var</span> simpleAlert <span class="token operator">=</span> <span class="token punctuation">{</span>  sa_default    <span class="token punctuation">:</span> <span class="token string">"Hello World!"</span><span class="token punctuation">,</span>  sa_error      <span class="token punctuation">:</span> <span class="token string">"Error..."</span><span class= "token punctuation">,</span>  sa_success    <span class="token punctuation">:</span> <span class="token string">"Success!"</span><span class="token punctuation">}</span><span class="token comment" spellcheck="true">// output object in the console</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">( </span>simpleAlert<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>Property values can also be functions. For example:</p><pre class=" language-javascript"><code class=" language-javascript"><span class="token comment" spellcheck="true">// create new object</span><span class="token keyword">var</span> simpleAlert <span class="token operator">=</span> <span class="token punctuation">{</span>  sa_default    <span class="token punctuation">:</span> <span class="token string">"Hello World!"</span><span class ="token punctuation">,</span>  sa_error      <span class="token punctuation">:</span> <span class="token string">"Error..."</span><span class="token punctuation">,</span>  sa_success <span class="token punctuation">:</span> <span class="token string">"Success!"</span><span class="token punctuation">,</span>  sa_fallback   <span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"Fallback"</span><span class="token punctuation">) </span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token comment" spellcheck="true">// run the fallback</span>simpleAlert<span class="token punctuation">.</span><span class="token function">sa_fallback</span><span class="token punctuation">(</span><span class="token punctuation">) </span><span class="token punctuation">;</span></code></pre><p>The above should output "Fallback" to the console. When a property's value is a function, it is known as a <strong>method </strong>.</p><h2>Using A Constructor Function</h2><p>Another great way to create objects in JavaScript is to use a "constructor function". From the MDN:</p><blockquote><p>Define the object type by writing a constructor function. There is a strong convention, with good reason, to use a capital initial letter. Create an instance of the object with <code>new</code>. </p></blockquote><p>You can read more about it <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Working_with_Objects#Using_a_constructor_function">here</a>. Using the constructor function, we can rewrite our object creation like this:</p><pre class=" language-javascript"><code class=" language-javascript"><span class="token comment" spellcheck= "true">// constructor function</span><span class="token keyword">function</span> <span class="token function">SimpleAlert</span><span class="token punctuation">(</span> sa_default<span class="token punctuation">,</span> sa_error<span class="token punctuation">,</span> sa_success <span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token keyword">this</span><span class="token punctuation">.</span>sa_default <span class="token operator">=</span> sa_default<span class="token punctuation">;</span>  <span class= "token keyword">this</span><span class="token punctuation">.</span>sa_error <span class="token operator">=</span> sa_error<span class="token punctuation">;</span>  <span class="token keyword">this</span><span class="token punctuation">.</span>sa_success <span class="token operator">=</span> sa_success<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token comment" spellcheck="true">// creation of new object</span><span class="token keyword">var</span> my_alert <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SimpleAlert</span><span class="token punctuation">(</span> <span class="token string">"Hello World!"</span><span class ="token punctuation">,</span> <span class="token string">"Error..."</span><span class="token punctuation">,</span> <span class="token string">"Success!"</span> <span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>Now if we output to the console, we can see our entire object. We can also now get the properties of our object via dot notation.</p><pre class=" language-javascript"><code class=" language-javascript">console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>my_alert<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// outputs object </span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>my_alert<span class="token punctuation">.</span> sa_error<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// outputs "Error..."</span></code></pre><p>The beauty of this technique is that you can now create multiple instances of the object, and pass in different values (which can be later accessed as properties). Properties can also be objects and even functions.</p><h2>A Whole Lot More About Objects</h2><p>In JavaScript, there's a whole lot more to objects than I mentioned above, although the methods mentioned above are a great start. The "initialiser" and "constructor function" methods in particular are useful, and we'll use these two methods below to create our very first SimpleAlert JavaScript component. I highly recommend reading through the MDN document <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Working_with_Objects">Working With Objects</a> to boost your knowledge even more. Also, take a read through the <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object">Object</a> document to see what properties/methods are readily available for us.</p><h2>Building Blocks For Our Component</h2><p>We're going to make a component called SimpleAlert, that posts an alert (or message) to the user's screen when they press a button. The message that gets displayed will Depend on which button the user presses. Here's a look at the HTML:</p><pre class=" language-html"><code class=" language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>component<span class="token punctuation">"</span></span><span class="token punctuation">&gt; </span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>default<span class="token punctuation">"</span></span><span class="token punctuation">&gt; </span></span>Show Default Message<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt; </span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>success<span class="token punctuation">"</span></span><span class="token punctuation">&gt; </span></span>Show Success Message<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt; </span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>error<span class="token punctuation">"</span></span><span class="token punctuation">&gt; </span></span>Show Error Message<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt; </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span></code></pre><p>For our component, we'll wrap all our code in a self executing function and then make it available in the global namespace. We'll start off like this:</p><pre class=" language-javascript" ><code class=" language-javascript"><span class="token punctuation">;</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span> window <span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token string">'use strict'</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span> window <span class="token punctuation">) </span><span class="token punctuation">;</span></code></pre><p>There are a couple points to note here:</p><ol><li>I'm using strict mode. You can read more about strict mode <a href=" https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Functions_and_function_scope/Strict_mode">here</a>.</li><li>We are passing <code>window</code> into our self-executing function so that we can later add our SimpleAlert component to the global namespace.</li></ol><p>Let's build a bit on our component. We want to first create our function <code>SimpleAlert </code>.  We also want to add it to the global namespace. Here's how we'll do this:</p><pre class=" language-javascript"><code class=" language-javascript"><span class="token punctuation"> ;</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span> window <span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token string">'use strict'</span><span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">/**   * SimpleAlert function   */</span>  <span class="token keyword">function</span> <span class="token function">SimpleAlert</span><span class="token punctuation">(</span> message <span class= "token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">this</span><span class="token punctuation">.</span>message <span class="token operator" >=</span> message<span class="token punctuation">;</span>  <span class="token punctuation">}</span>  <span class="token comment" spellcheck="true">// rest of code here...</span>  <span class="token comment" spellcheck="true">/**   * Add SimpleAlert to global namespace   */</span>  window<span class="token punctuation">.</span>SimpleAlert <span class="token operator">= </span> SimpleAlert<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span> window <span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>So far, if we create a new instance of our object, nothing happens. It just exists, and that's pretty sad. For example, if we do this:</p><pre class=" language-javascript"><code class=" language-javascript"><span class="token punctuation">(</span><span class="token keyword"> function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token comment" spellcheck="true"> /**   * Show default   */</span>  <span class="token keyword">var</span> default_btn <span class="token operator">=</span> document<span class="token punctuation">.</span><span class= "token function">getElementById</span><span class="token punctuation">(</span> <span class="token string">"default"</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>  default_btn<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span> <span class="token string">"click"</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">var</span> default_alert <span class="token operator">=</span> <span class="token keyword">new</span> <span class= "token class-name">SimpleAlert</span><span class="token punctuation">(</span><span class="token string">"Hello World!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    default_alert<span class="token punctuation">;</span>  <span class="token punctuation">}</span> <span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>Before I continue, I need to introduce to you briefly <code>Object.prototype</code>. This represents the Object prototype object. From the MDN:</p><blockquote><p>All objects in JavaScript are descended from <code>Object</code>; all objects inherit methods and properties from <code>Object.prototype</code>, although they may be overridden (except an <code>Object</code> with a <code>null</code> prototype, i.e. <code>Object.create(null)</code>).</p></blockquote><p>For more reading, go <a href=" https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/prototype">here</a>. We'll be utilising this in our component creation. Let's build onto our component a bit. Let's add an <code>init</code> function, and call that function as soon as our object is created. Inside this <code>init</code> function, let's send our message to the console. Now, our JavaScript looks like this:</p><pre class=" language-javascript"><code class=" language-javascript"><span class="token punctuation">;</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span> window <span class="token punctuation">)</span> <span class="token punctuation">{ </span>  <span class="token string">'use strict'</span><span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">/**   * SimpleAlert function   */</span> <span class="token keyword">function</span> <span class="token function">SimpleAlert</span><span class="token punctuation">(</span> message <span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">this</span><span class="token punctuation">.</span>message <span class="token operator">=</span> message<span class= "token punctuation">;</span>    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">_init</span><span class="token punctuation">( </span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span>  <span class="token comment" spellcheck="true">/**   * Initialise the message   */</span>  SimpleAlert<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>_init <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>message <span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span>  <span class="token comment" spellcheck="true">/**   * Add SimpleAlert to global namespace   */</span>  window<span class="token punctuation">.</span>SimpleAlert <span class="token operator">=</span> SimpleAlert<span class="token punctuation">; </span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span> window <span class="token punctuation">)</span><span class= "token punctuation">;</span></code></pre><p>And now, our new instance of our object created above should output "Hello World!" to the console. We're getting somewhere! Let's actually show the notice to the user on screen, and not in the console. Our <code>_init</code> function may now look like this:</p><pre class=" language-javascript"><code class=" language-javascript" ><span class="token punctuation">;</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span> window <span class= "token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token string">'use strict'</span><span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">/**   * SimpleAlert function   */</span>  <span class="token keyword">function</span> <span class="token function">SimpleAlert</span><span class="token punctuation">( </span> message <span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">this</span><span class="token punctuation">.</span>message <span class="token operator">=</span> message<span class="token punctuation">;</span>    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">_init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span> <span class="token comment" spellcheck="true">/**   * Initialise the message   */</span>  SimpleAlert<span class="token punctuation">.</span>prototype<span class="token punctuation">. </span>_init <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class= "token punctuation">{</span>    <span class="token keyword">this</span><span class="token punctuation">.</span>component <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">"component"</span><span class="token punctuation"> )</span><span class="token punctuation">;</span>    <span class="token keyword">this</span><span class="token punctuation">.</span>box <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">"div"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">this</span><span class="token punctuation">.</span>box<span class="token punctuation">.</span> className <span class="token operator">=</span> <span class="token string">"simple-alert"</span><span class="token punctuation">;</span>    <span class="token keyword">this</span><span class="token punctuation">.</span>box<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>message<span class="token punctuation">;</span>    <span class="token keyword">this</span><span class="token punctuation">.</span>component<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span> <span class="token keyword">this</span><span class="token punctuation">.</span> box <span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span>  <span class="token comment" spellcheck="true">/**   * Add SimpleAlert to global namespace   */</span>  window<span class="token punctuation">.</span>SimpleAlert <span class="token operator">=</span> SimpleAlert<span class="token punctuation">; </span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span> window <span class="token punctuation">)</span><span class= "token punctuation">;</span></code></pre><p>Let's go through the <code>_init</code> function step by step.</p><ol><li>Inside our constructor function, we are making the variable <code> message</code> accessible throughout by writing <code>this.message = message</code>. </li><li>We then call our <code>_init</code> function by writing <code>this._init()</code>. Every time we create a new instance of our SimpleAlert object, these two steps automatically run, so we automatically go to <code>_init()</code>. </li><li>Inside <code>_init()</code>, we are assigning our variables by using the <code>this</code> keyword and a variable name of our choice. We fetch the <code>#component</code> dive, and create our new <code>div</code> element where we would have our new SimpleAlert show up. Then we append the message to this new <code>div</code> that we created.</li></ol><p>Pretty neat, huh?</p><h2>The Code In Full</h2><p>Here is the code in full, including some CSS to tie it all together neatly. Firstly, the HTML:</p><pre class=" language-html"><code class=" language-html"><span class="token tag"><span class= "token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class= "token punctuation">"</span>component<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>  <span class="token tag"><span class="token tag" ><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>default<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>Show Default Message<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span> success<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>Show Success Message<span class="token tag"><span class="token tag"><span class= "token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span> button</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>error<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>Show Error Message<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span> button</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span></code></pre><p>Same as we've seen above. Here's some CSS to make our alerts look a bit nice on screen:</p><pre class=" language-css"><code class=" language-css"><span class="token selector"><span class="token class">.simple-alert</span> </span><span class="token punctuation">{</span>  <span class="token property">padding</span><span class="token punctuation">:</span> <span class="token number">20</span>px<span class="token punctuation">;</span>  <span class="token property">border</span><span class="token punctuation" >:</span> solid <span class="token number">1</span>px <span class="token hexcode">#ebebeb</span><span class="token punctuation">;</span><span class="token punctuation">} </span></code></pre><p>Simple. Edit at your will, of course! And finally, here's the JavaScript that covers our component, and the actual event listeners on all three buttons triggering new instances of our object and hence displaying alerts to the screen:</p><pre class=" language-javascript"><code class=" language-javascript"><span class="token comment" spellcheck="true" >// COMPONENT</span><span class="token comment" spellcheck="true">//</span><span class="token comment" spellcheck="true">// The building blocks for our SimpleAlert component.</span><span class="token comment" spellcheck="true">////////////////////////////////////////////////////////////</span><span class="token punctuation">;</span><span class="token punctuation">( </span><span class="token keyword">function</span><span class="token punctuation">(</span> window <span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token string">'use strict'</span><span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">/**   * SimpleAlert function   */</span>  <span class= "token keyword">function</span> <span class="token function">SimpleAlert</span><span class="token punctuation">(</span> message <span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">this</span><span class="token punctuation">.</span>message <span class="token operator">=</span> message<span class="token punctuation" >;</span>    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">_init</span><span class="token punctuation">(</span><span class= "token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span>  <span class="token comment" spellcheck="true">/**   * Initialise the message   */</span>  SimpleAlert<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>_init <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">this </span><span class="token punctuation">.</span>component <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById </span><span class="token punctuation">(</span><span class="token string">"component"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class= "token keyword">this</span><span class="token punctuation">.</span>box <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function"> createElement</span><span class="token punctuation">(</span><span class="token string">"div"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">this</span><span class="token punctuation">.</span>box<span class="token punctuation">.</span>className <span class="token operator">=</span> <span class="token string">"simple-alert"</span><span class="token punctuation">;</span>    <span class="token keyword">this</span><span class="token punctuation">.</span>box<span class="token punctuation">. </span>innerHTML <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>message<span class="token punctuation">;</span> <span class="token keyword">this</span><span class="token punctuation">.</span>component<span class="token punctuation">.</span><span class="token function">appendChild</span><span class= "token punctuation">(</span> <span class="token keyword">this</span><span class="token punctuation">.</span>box <span class="token punctuation">)</span><span class="token punctuation">; </span>    <span class="token keyword">this</span><span class="token punctuation">.</span>_initUIActions<span class="token punctuation">;</span>  <span class="token punctuation">}</span> SimpleAlert<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>_initUIActions <span class="token operator">=</span> <span class="token keyword"> function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token punctuation">}</span>  <span class="token comment" spellcheck="true">/**   * Add SimpleAlert to global namespace   */</span>  window<span class="token punctuation">.</span>SimpleAlert <span class="token operator">= </span> SimpleAlert<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span> window <span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// EVENTS</span><span class="token comment" spellcheck="true"> //</span><span class="token comment" spellcheck="true">// The code for the creation of new object instances,</span><span class="token comment" spellcheck="true">// depending on which button is pressed.</span><span class="token comment" spellcheck="true">////////////////////////////////////////////////////////////</span><span class="token punctuation">;</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token comment" spellcheck="true">/**   * Show default   */</span>  <span class="token keyword">var</span> default_btn <span class="token operator">= </span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span> <span class="token string">"default" </span> <span class="token punctuation">)</span><span class="token punctuation">;</span>  default_btn<span class="token punctuation">.</span><span class="token function">addEventListener </span><span class="token punctuation">(</span> <span class="token string">"click"</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class= "token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">var</span> default_alert <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SimpleAlert</span><span class="token punctuation">(</span><span class="token string">"Hello World!" </span><span class="token punctuation">)</span><span class="token punctuation">;</span>    default_alert<span class="token punctuation">;</span>  <span class="token punctuation">}</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">/**   * Show success   */</span>  <span class="token keyword">var</span> default_btn <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span> <span class="token string">"success"</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>  default_btn<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span> <span class="token string">"click"</span><span class="token punctuation">, </span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class= "token keyword">var</span> default_alert <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SimpleAlert</span><span class="token punctuation">(</span><span class="token string">"Success!!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    default_alert<span class="token punctuation">;</span>  <span class="token punctuation">}</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment" spellcheck= "true">/**   * Show error   */</span>  <span class="token keyword">var</span> default_btn <span class="token operator">=</span> document<span class="token punctuation">.</span><span class= "token function">getElementById</span><span class="token punctuation">(</span> <span class="token string">"error"</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>  default_btn<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span> <span class="token string">"click"</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">var</span> default_alert <span class="token operator">=</span> <span class="token keyword">new</span> <span class= "token class-name">SimpleAlert</span><span class="token punctuation">(</span><span class="token string">"Error..."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    default_alert<span class="token punctuation">;</span>  <span class="token punctuation">}</span> <span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><h2>Wrap Up</h2><p>Here, we looked into JavaScript objects and we've seen how to create a very basic JavaScript component using objects. This demonstration is simple, but provides us with some fundamental knowledge for creating reusable and extendable components. Think of how you might add a "dismiss" button to the alert, triggering a new function <code>hide()</code> when pressed.</p><p>Next time, we expand a bit more on our SimpleAlert component, and we learn how to set default options and pass in our own set of options. This is where we will see the beauty of this type of programming coming into play. I hope you enjoyed this tutorial, and if you have any questions, comments or feedback, leave it below. Stay tuned for part 2, and thanks for reading!</p>  </div></article>			</div>		<!--=========================			END : POST =============================-->		<!--=========================			START : POST		=============================-->		<div class="post-wrapper"><article class= "article-single content--narrow">  <header class="article-single__header">    <h1 class="article-single__title">JavaScript Objects &amp; Building A JavaScript Component – Part 2</h1> <div class="article-single__meta article-meta">      <ul class="article-meta__items">        <li class="article-meta__item date">          <a href= "/post/javascript-objects-building-javascript-component-part-2" class="article-meta__link">30/09/2014</a>        </li>                <li class="article-meta__item category"> <a href="http://callmenick.com/categories/tutorials" class="article-meta__link">Tutorials</a>                  </li>                      </ul>    </div>    <p class= "article-single__excerpt">Here's part 2 of a 2-part tutorial that dives into JavaScript objects, prototype programming, and building a simple reusable JavaScript component.</p>  </header> <div class="article-single__body">    <p class="text-align--center"><a href="http://callmenick.com/_development/simple-alert/simple-alert-source.zip" class="button button--inline-block button--medium">Get Source</a><a href="http://callmenick.com/_development/simple-alert" class="button button--inline-block button--medium">View Demo</a></p><h2>Introduction</h2><p>In <a href="http://callmenick.com/post/javascript-objects-building-javascript-component-part-1/">part one</a> of this two-part tutorial, we went into some detail about JavaScript objects, and created a very basic component. Our component, however, only took on one parameter, and isn't easily extendable. In part two (this tutorial), we're going to look into some interesting functions, and give our component some options. These options can be specified each time we create a new instance of our component, giving us more control over the output.</p><h2>Simple Alert Outline</h2><p>The outline for our component will be as follows:</p><ol><li>We want the user to wire up a Simple Alert to whatever element he/she desires. For this tutorial, I'll be wiring up Simple Alerts to buttons.</li><li>We want the user to specify what type of alert will be shown. The user will have 4 options - error, success, warning, and default.</li><li>We want to give different styles to each of these alerts, so that the user experience is a bit more in line with what users are accustomed to (i.e. red is error, green is success, etc). </li><li>We want users to be able to dismiss the alerts. This functionality will be written inside our Simple Alert component.</li></ol><p>So off the bat, we know we need some HTML and CSS structure. Because the JavaScript is actually creating the HTML for us on each instance of the alert, I like to style it in some test markup before so I know how it would look. With that in mind, let's take a look at what the markup should be like.</p><h2>Simple Alert Test Markup</h2><p>In general, our alerts would look something like this after the JS outputs it: </p><pre class=" language-html"><code class=" language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>simple-alert TYPE<span class="token punctuation">" </span></span><span class="token punctuation">&gt;</span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>simple-alert__content<span class="token punctuation">" </span></span><span class="token punctuation">&gt;</span></span>Message here<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href </span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>simple-alert__dismiss<span class="token punctuation">" </span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt; </span></span></code></pre><p>"TYPE" is the type of alert, and this class, as mentioned above, will be represented by either of 4 types:</p><ul><li><code>.error</code></li><li><code> .success</code></li><li><code>.warning</code></li><li><code>.default</code></li></ul><p>Knowing all this, we now have some classes to work with. So let's dig into the CSS.</p><h2>The CSS For Our JS Object Output</h2><p>As seen in the markup, we have some classes to work with that will give our alerts some style. I mentioned before that each of our four types of alerts will have different colour schemes to invoke some familiarity to users, so let's style with that in mind. Here's the CSS I came up with:</p><pre class=" language-css"><code class=" language-css"><span class="token selector"><span class="token class">.simple-alert</span> </span><span class="token punctuation">{</span>  <span class="token property">display</span><span class="token punctuation">:</span> inline-block<span class="token punctuation">;</span>  <span class="token property">position</span><span class="token punctuation">:</span> relative<span class="token punctuation">;</span>  <span class="token property">margin</span><span class="token punctuation">:</span> <span class="token number">0</span> <span class="token number">5 </span>px <span class="token number">5</span>px <span class="token number">0</span><span class="token punctuation">;</span>  <span class="token property">padding</span><span class="token punctuation">:</span> <span class="token number">5</span>px <span class="token number">45</span>px <span class="token number">5</span>px <span class="token number">5</span>px<span class= "token punctuation">;</span><span class="token punctuation">}</span><span class="token selector"><span class="token class">.simple-alert.error</span> </span><span class="token punctuation" >{</span>  <span class="token property">background-color</span><span class="token punctuation">:</span> <span class="token hexcode">#f06464</span><span class="token punctuation">;</span> <span class="token property">border</span><span class="token punctuation">:</span> solid <span class="token number">1</span>px <span class="token hexcode">#d91515</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token selector"><span class="token class">.simple-alert.success</span> </span><span class="token punctuation">{ </span>  <span class="token property">background-color</span><span class="token punctuation">:</span> lightgreen<span class="token punctuation">;</span>  <span class="token property"> border</span><span class="token punctuation">:</span> solid <span class="token number">1</span>px <span class="token hexcode">#38e038</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token selector"><span class="token class">.simple-alert.warning</span> </span><span class="token punctuation">{</span>  <span class="token property">background-color</span><span class="token punctuation">:</span> moccasin<span class="token punctuation">;</span>  <span class="token property">border</span><span class="token punctuation">:</span> solid <span class="token number">1</span>px <span class="token hexcode">#ffbf4f</span><span class="token punctuation">;</span><span class="token punctuation">} </span><span class="token selector"><span class="token class">.simple-alert.default</span> </span><span class="token punctuation">{</span>  <span class="token property">background-color </span><span class="token punctuation">:</span> lightblue<span class="token punctuation">;</span>  <span class="token property">border</span><span class="token punctuation">:</span> solid <span class="token number">1</span>px <span class="token hexcode">#5fb3ce</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token selector" ><span class="token class">.simple-alert__content</span> </span><span class="token punctuation">{</span>  <span class="token property">color</span><span class="token punctuation">:</span> <span class="token function">rgba</span>(<span class="token number">0</span>, <span class="token number">0</span>, <span class="token number">0</span>, <span class="token number">0.5 </span>)<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token selector"><span class="token class">.simple-alert__dismiss</span> </span><span class="token punctuation">{</span>  <span class="token property">display</span><span class="token punctuation">:</span> block<span class="token punctuation">;</span>  <span class="token property">position</span><span class="token punctuation">:</span> absolute<span class="token punctuation">;</span>  <span class="token property">top</span><span class="token punctuation">: </span> <span class="token number">0</span><span class="token punctuation">;</span>  <span class="token property">right</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">;</span>  <span class="token property">bottom</span><span class="token punctuation">:</span> <span class="token number">0</span><span class= "token punctuation">;</span>  <span class="token property">margin</span><span class="token punctuation">:</span> auto <span class="token number">0</span><span class="token punctuation">; </span>  <span class="token property">width</span><span class="token punctuation">:</span> <span class="token number">20</span>px<span class="token punctuation">;</span>  <span class= "token property">height</span><span class="token punctuation">:</span> <span class="token number">20</span>px<span class="token punctuation">;</span>  <span class="token property"> background-image</span><span class="token punctuation">:</span> <span class="token url">url("../img/close.png")</span><span class="token punctuation">;</span>  <span class="token property" >font-size</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">;</span>  <span class="token property">text-indent</span><span class="token punctuation">:</span> -<span class="token number">9999</span>px<span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><p>These styles should now give us a nice aesthetic that's pleasing to the user and representative of the various message types. Now, without further ado, let's get into some JavaScript!</p><h2>A Quick Re-Introduction</h2><p>As before, we'll wrap our component in a self-executing function. Note the ";" before our function, which is a precaution in case of auto-concatenated JavaScript files. Also note that we pass in <code>window</code> in order to add our Simple Alert component to the global namespace. Here's our function wrapper:</p><pre class=" language-javascript" ><code class=" language-javascript"><span class="token punctuation">;</span><span class="token punctuation">(</span> <span class="token keyword">function</span><span class="token punctuation">(</span> window <span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token string">'use strict'</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span> window <span class="token punctuation">) </span><span class="token punctuation">;</span></code></pre><p>If you remember part 1, you'll remember how we started out our component. If not, it was as easy as defining <code> SimpleAlert</code> as a new function, and adding it to the global namespace. Here's how our JS should look now:</p><pre class=" language-javascript"><code class=" language-javascript" ><span class="token punctuation">;</span><span class="token punctuation">(</span> <span class="token keyword">function</span><span class="token punctuation">(</span> window <span class= "token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token string">'use strict'</span><span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">/**   * SimpleAlert   */</span>  <span class="token keyword">function</span> <span class="token function">SimpleAlert</span><span class="token punctuation">(</span> options <span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token comment" spellcheck="true">// function body...</span>  <span class="token punctuation">}</span>  <span class="token comment" spellcheck="true">/**   * Add to global namespace   */</span>  window<span class="token punctuation">.</span>SimpleAlert <span class= "token operator">=</span> SimpleAlert<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation" >(</span> window <span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><h2>Component Building &amp; Extending</h2><p>Now, let's get our feet into some new stuff. As I mentioned before, we want to be able to pass in some options to our new instances of our object. In the demo, three options are available:</p><ol><li>wrapper - the wrapper to append alerts to</li><li>type - the type of alert</li><li>message - the alert message</li></ol><p>So we want to be able to accept an options object that looks like this:</p><pre class=" language-javascript"><code class=" language-javascript">options <span class="token operator">=</span> <span class="token punctuation">{</span>  wrapper <span class="token punctuation">:</span> document<span class="token punctuation">.</span>body<span class="token punctuation">,</span>  type <span class="token punctuation">:</span> <span class="token string" >"default"</span><span class="token punctuation">,</span>  message <span class="token punctuation">:</span> <span class="token string">"Default message."</span><span class="token punctuation">}</span></code></pre><p>Note that I've set some default options above. This is interesting though, because we actually want default options inside our object in case the user decides to keep some of the defaults and only set one or two options. This brings us to another issue, however. How do we see if the user has passed in no options, some options, or all options, and override them where necessary? For this, we have an "extend object" function. It looks like this:</p><pre class=" language-javascript"><code class=" language-javascript"><span class="token keyword">function</span> <span class="token function">extend</span><span class="token punctuation">(</span> a<span class="token punctuation">,</span> b <span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token keyword">for</span><span class="token punctuation">(</span> <span class="token keyword">var</span> key <span class="token keyword">in</span> b <span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">if</span><span class="token punctuation">(</span> b<span class="token punctuation">.</span><span class="token function">hasOwnProperty</span><span class="token punctuation">(</span> key <span class="token punctuation">)</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>      a<span class="token punctuation">[</span>key<span class="token punctuation">] </span> <span class="token operator">=</span> b<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class= "token punctuation">}</span>  <span class="token punctuation">}</span>  <span class="token keyword">return</span> a<span class="token punctuation">;</span><span class="token punctuation">} </span></code></pre><p>Don't get all confused! This function is simple, and performs three main things:</p><ol><li>Firstly, it accepts two objects as parameters.</li><li>Secondly, it loops through the second object, <code>b</code>, and looks at each <code>key</code> in it. It checks to see if <code>b</code> has that property by calling on the method <code> hasOwnProperty</code>, and you can view documentation on that method <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/hasOwnProperty">here </a>.</li><li>Finally, it updates and sets the corresponding <code>key</code> in the other object, <code>a</code>, and then when the loop is complete, it returns object <code>a</code>. </li></ol><p>This is all well and good, but what exactly do we pass into this <code>extend</code> function for our options object to be ready for use in our component? We want to follow a couple steps to get there. So here's what we need to do:</p><ol><li>We want <code>this.options</code> accessible in our entire component, so we first update it to be equal to our defaults. To do this, we pass in an empty object as <code>a</code> and the default options (initially represented by <code>this.options</code>) as <code>b</code> in our <code>extend</code> function.</li><li>We then extend <code>this.options</code> with our passed in object <code>options</code>, overriding the defaults where specified.</li></ol><p>Our component, from start to finish, now looks something like this:</p><pre class=" language-javascript"><code class=" language-javascript"><span class="token punctuation">;</span><span class="token punctuation">( </span> <span class="token keyword">function</span><span class="token punctuation">(</span> window <span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token string">'use strict'</span><span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">/**   * Extend obj function   *   * This is an object extender function. It allows us to extend an object   * by passing in additional variables and overwriting the defaults.   */</span>  <span class="token keyword">function</span> <span class="token function">extend</span><span class="token punctuation">(</span> a<span class="token punctuation">,</span> b <span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">for</span><span class="token punctuation">(</span> <span class="token keyword">var</span> key <span class="token keyword">in</span> b <span class="token punctuation">)</span> <span class="token punctuation">{</span>      <span class="token keyword">if</span><span class="token punctuation">(</span> b<span class="token punctuation">.</span><span class="token function">hasOwnProperty</span><span class="token punctuation">(</span> key <span class="token punctuation">)</span> <span class="token punctuation" >)</span> <span class="token punctuation">{</span>        a<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> b<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">;</span>      <span class="token punctuation">}</span>    <span class="token punctuation">}</span>    <span class="token keyword">return</span> a<span class="token punctuation">;</span>  <span class="token punctuation">}</span>  <span class="token comment" spellcheck="true">/**   * SimpleAlert   *   * @param {object} options - The options object   */</span>  <span class="token keyword">function</span> <span class="token function">SimpleAlert </span><span class="token punctuation">(</span> options <span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">this</span><span class="token punctuation">.</span>options <span class="token operator">=</span> <span class="token function">extend</span><span class="token punctuation">(</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span> options <span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">extend</span><span class="token punctuation">(</span> <span class= "token keyword">this</span><span class="token punctuation">.</span>options<span class="token punctuation">,</span> options <span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">// start the functionality...</span>  <span class="token punctuation">}</span>  <span class="token comment" spellcheck="true">/**   * SimpleAlert options Object   *   * @type {HTMLElement} wrapper - The wrapper to append alerts to.   * @param {string} type - The type of alert.   * @param {string} message - The alert message.   */</span>  SimpleAlert<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>options <span class="token operator"> =</span> <span class="token punctuation">{</span>    wrapper <span class="token punctuation">:</span> document<span class="token punctuation">.</span>body<span class="token punctuation">, </span>    type <span class="token punctuation">:</span> <span class="token string">"default"</span><span class="token punctuation">,</span>    message <span class="token punctuation">: </span> <span class="token string">"Default message."</span>  <span class="token punctuation">}</span>  <span class="token comment" spellcheck="true">/**   * Add to global namespace   */ </span>  window<span class="token punctuation">.</span>SimpleAlert <span class="token operator">=</span> SimpleAlert<span class="token punctuation">;</span><span class="token punctuation"> }</span><span class="token punctuation">)</span><span class="token punctuation">(</span> window <span class="token punctuation">)</span><span class="token punctuation">; </span></code></pre><h2>Adding The Actual Functionality</h2><p>Now that we're all set up, we need to add some actual functionality. Firstly, after a new instance of the object is instantiated, we want to run some code. I'll separate this first chunk of code into an <code>_init()</code> function. The reason for underscoring these functions is just a matter of taste. It doesn't actually do anything special, but lets other developers, or implementers of the component, know that this function should be reserved for private use inside the component. Here's what we want our <code>_init()</code> function to do for us:</p><ol><li>We want to create our actual alert. We do this by creating a <code>div</code> element, and adding the correct class names to it.</li><li>We want to then construct our inner HTML, i.e. the alert message and dismiss-alert button, and give that inner HTML to our newly created <code>div </code>.</li><li>We then want to listen for events on the dismiss button, and have some functions for showing and dismissing the alert</li></ol><h3>Initial Function</h3><p>Our <code> _init()</code> function now should look like this:</p><pre class=" language-javascript"><code class=" language-javascript"><span class="token comment" spellcheck="true">/** * SimpleAlert _init * * This is the initializer function. It builds the HTML and gets the alert * ready for showing. * * @type {HTMLElement} this.sa - The Simple Alert div * @param {string} strinner - The inner HTML for our alert */</span>SimpleAlert<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>_init <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token comment" spellcheck="true">// create element</span>  <span class="token keyword">this</span><span class="token punctuation">.</span>sa <span class="token operator">=</span> document<span class= "token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'div'</span><span class="token punctuation"> )</span><span class="token punctuation">;</span>  <span class="token keyword">this</span><span class="token punctuation">.</span>sa<span class="token punctuation">.</span>className <span class="token operator">=</span> <span class="token string">'simple-alert '</span> <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>options<span class="token punctuation">.</span>type<span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">// create html</span>  <span class="token keyword">var</span> strinner <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">;</span>  strinner <span class="token operator">+</span><span class="token operator">=</span> <span class="token string">'&lt;span class="simple-alert__content"&gt;'</span><span class="token punctuation">;</span>    strinner <span class="token operator">+</span><span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>options<span class="token punctuation">.</span>message<span class="token punctuation">;</span>  strinner <span class="token operator">+</span><span class="token operator">=</span> <span class="token string">'&lt; /span&gt;'</span><span class="token punctuation">;</span>  strinner <span class="token operator">+</span><span class="token operator">=</span> <span class="token string">'&lt;a href="#" class="simple-alert__dismiss"&gt;close&lt;/a&gt;'</span><span class="token punctuation">;</span>  <span class="token keyword">this</span><span class="token punctuation">.</span>sa<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> strinner<span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">// run the events</span>  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">_events</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre><p>Note the usage of <code>this.options.type</code> and <code>this.options.message</code> which are of course, inherited values from our <code>this.options</code> object that we set up before. Also note that at the end of this function, we're calling on a new function, <code>_events()</code>, which will handle our events.</p><h3>Events Function</h3><p>The <code>_events()</code> function takes care of dismissing our alert when a user clicks the dismiss button. It's a simple function, and here's what it looks like:</p><pre class=" language-javascript"><code class=" language-javascript"><span class="token comment" spellcheck="true">/** * SimpleAlert _events * * This is our events function, and its sole purpose is to listen for * any events inside our Simple Alert. * * @type {HTMLElement} btn_dismiss - The dismiss-alert button */</span>SimpleAlert<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span> _events <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class= "token punctuation">{</span>  <span class="token comment" spellcheck="true">// cache vars</span>  <span class="token keyword">var</span> btn_dismiss <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>sa<span class="token punctuation">.</span><span class="token function">querySelector</span><span class= "token punctuation">(</span><span class="token string">'.simple-alert__dismiss'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>      self <span class ="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">// listen for dismiss</span> btn_dismiss<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span> <span class="token string">"click" </span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class= "token punctuation">{</span>    e<span class="token punctuation">.</span><span class="token function">preventDefault</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    self<span class="token punctuation">.</span><span class="token function">dismiss</span><span class="token punctuation">( </span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><p>Notice that we set <code>var self = this</code> at the start of the function. This is because we want to access that instance of <code>this</code> inside the click event, but once inside the click event, <code>this</code> refers to the node that was clicked. Setting <code>this</code> to <code>self</code> before hand avoids any confusion. Note the call on the <code>dismiss()</code> function from before.</p><h3>The Show Function</h3><p>The <code>show()</code> function does at its name says - it shows the alert. This is a very basic function, and just appends our newly created <code>div</code> in the <code>_init()</code> function to the wrapper passed in to the <code>options</code> object. Here's what the function looks like:</p><pre class=" language-javascript"><code class=" language-javascript"><span class="token comment" spellcheck="true"> /** * SimpleAlert show * * This function simply shows our Simple Alert by appending it * to the wrapper in question. */</span>SimpleAlert<span class="token punctuation">.</span>prototype <span class="token punctuation">.</span>show <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token keyword">this</span><span class="token punctuation">.</span>options<span class="token punctuation">. </span>wrapper<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>sa<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><h3>The Dismiss Function</h3><p>The <code>dismiss()</code> function is equally as basic as the <code>show()</code> function, and simply removes the alert from the wrapper. Here's the function:</p><pre class=" language-javascript"><code class=" language-javascript"><span class="token comment" spellcheck="true">/** * SimpleAlert dismiss * * This function simply hides our Simple Alert by removing it * from the wrapper in question. */</span>SimpleAlert<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>dismiss <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">this</span><span class="token punctuation">.</span>options<span class="token punctuation">.</span>wrapper<span class="token punctuation">.</span><span class= "token function">removeChild</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>sa<span class="token punctuation"> )</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre><h3>Why Separate Two Simple Functions?</h3><p> Surely, the functionality of <code>show()</code> and <code>dismiss()</code> could have all happened inside the <code>_init()</code> function, but there's a reason we separate them. </p><ul><li>We want to instantiate our alert, and show the alert whenever we want. In a more complex component, adding a "public method" like <code>show()</code> will allow us to show the actual alert whenever we want, after it is created.</li><li>In the case of dismissing the alert, we added an event listener to the dismiss button which is default behaviour. What if an implementer of the component wanted to add his/her own functionality, and allow dismissing the alerts by clicking on a custom button? </li><li>Finally, by doing this, we can (if we wanted) add two callbacks as part of our options object, and run the callbacks on alert creation, and alert dismissal. We would run these callbacks inside each of the functions <code> show()</code> and <code>dismiss()</code> respectively.</li></ul><h2>The Final Component Code</h2><p>Here at last, a look at the final component code:</p><pre class=" language-javascript" ><code class=" language-javascript"><span class="token comment" spellcheck="true">/** * Simple Alert * * This little function allows us to display alerts to the user. The alerts * append to a wrapper of choice, and takes on two other variables. * * Licensed under the MIT license. * http://www.opensource.org/licenses/mit-license.php * * Copyright 2014, Call Me Nick * http://callmenick.com */</span><span class="token punctuation">;</span><span class="token punctuation">(</span> <span class="token keyword">function</span><span class="token punctuation">( </span> window <span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token string">'use strict'</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">/**   * Extend obj function   *   * This is an object extender function. It allows us to extend an object   * by passing in additional variables and overwriting the defaults.   */</span>  <span class="token keyword">function</span> <span class="token function">extend</span><span class="token punctuation">(</span> a<span class="token punctuation">,</span> b <span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">for</span><span class="token punctuation">(</span> <span class="token keyword">var</span> key <span class="token keyword">in</span> b <span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">if</span><span class="token punctuation">(</span> b<span class="token punctuation">.</span><span class="token function">hasOwnProperty</span><span class= "token punctuation">(</span> key <span class="token punctuation">)</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>        a<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> b<span class="token punctuation">[</span>key<span class="token punctuation">] </span><span class="token punctuation">;</span>      <span class="token punctuation">}</span>    <span class="token punctuation">}</span>    <span class="token keyword">return</span> a <span class="token punctuation">;</span>  <span class="token punctuation">}</span>  <span class="token comment" spellcheck="true">/**   * SimpleAlert   *   * @param {object} options - The options object   */</span>  <span class="token keyword">function</span> <span class="token function">SimpleAlert</span><span class="token punctuation">(</span> options <span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">this</span><span class="token punctuation">.</span>options <span class="token operator">= </span> <span class="token function">extend</span><span class="token punctuation">(</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class= "token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>options <span class="token punctuation">)</span><span class="token punctuation"> ;</span>    <span class="token function">extend</span><span class="token punctuation">(</span> <span class="token keyword">this</span><span class="token punctuation">.</span>options<span class="token punctuation">,</span> options <span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">_init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>  <span class="token comment" spellcheck="true">/**   * SimpleAlert options Object   *   * @type {HTMLElement} wrapper - The wrapper to append alerts to.   * @param {string} type - The type of alert.   * @param {string} message - The alert message.   */</span>  SimpleAlert<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>options <span class="token operator">=</span> <span class="token punctuation">{</span>    wrapper <span class="token punctuation">:</span> document<span class="token punctuation">.</span>body<span class="token punctuation">,</span>    type <span class="token punctuation">:</span> <span class="token string">"default"</span><span class= "token punctuation">,</span>    message <span class="token punctuation">:</span> <span class="token string">"Default message."</span>  <span class="token punctuation">}</span>  <span class ="token comment" spellcheck="true">/**   * SimpleAlert _init   *   * This is the initializer function. It builds the HTML and gets the alert   * ready for showing.   *   * @type {HTMLElement} this.sa - The Simple Alert div   * @param {string} strinner - The inner HTML for our alert   */</span>  SimpleAlert<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>_init <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token comment" spellcheck="true">// create element</span>    <span class="token keyword">this</span><span class="token punctuation">.</span>sa <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class= "token punctuation">(</span><span class="token string">'div'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">this </span><span class="token punctuation">.</span>sa<span class="token punctuation">.</span>className <span class="token operator">=</span> <span class="token string">'simple-alert '</span> <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>options<span class="token punctuation">.</span>type<span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">// create html</span>    <span class="token keyword">var</span> strinner <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">;</span>    strinner <span class="token operator">+</span><span class="token operator">=</span> <span class="token string">' &lt;span class="simple-alert__content"&gt;'</span><span class="token punctuation">;</span>      strinner <span class="token operator">+</span><span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>options<span class="token punctuation">.</span>message<span class="token punctuation">;</span>    strinner <span class="token operator">+</span><span class="token operator">=</span> <span class="token string">'&lt;/span&gt;'</span><span class="token punctuation">;</span>    strinner <span class= "token operator">+</span><span class="token operator">=</span> <span class="token string">'&lt;a href="#" class="simple-alert__dismiss"&gt;close&lt;/a&gt;'</span><span class="token punctuation">;</span>    <span class="token keyword">this</span><span class="token punctuation">.</span>sa<span class="token punctuation">.</span>innerHTML <span class="token operator">= </span> strinner<span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">// run the events</span>    <span class="token keyword">this</span><span class= "token punctuation">.</span><span class="token function">_events</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">; </span>  <span class="token punctuation">}</span><span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">/**   * SimpleAlert _events   *   * This is our events function, and its sole purpose is to listen for   * any events inside our Simple Alert.   *   * @type {HTMLElement} btn_dismiss - The dismiss-alert button   */</span>  SimpleAlert <span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>_events <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token comment" spellcheck="true">// cache vars</span> <span class="token keyword">var</span> btn_dismiss <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>sa<span class= "token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">'.simple-alert__dismiss'</span><span class= "token punctuation">)</span><span class="token punctuation">,</span>        self <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">// listen for dismiss</span>    btn_dismiss<span class="token punctuation">.</span><span class="token function"> addEventListener</span><span class="token punctuation">(</span> <span class="token string">"click"</span><span class="token punctuation">,</span> <span class="token keyword">function </span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>      e<span class="token punctuation">.</span><span class= "token function">preventDefault</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      self<span class="token punctuation">.</span><span class="token function">dismiss</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span>  <span class="token comment" spellcheck="true">/**   * SimpleAlert show   *   * This function simply shows our Simple Alert by appending it   * to the wrapper in question.   */</span>  SimpleAlert<span class= "token punctuation">.</span>prototype<span class="token punctuation">.</span>show <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">this</span><span class="token punctuation">.</span> options<span class="token punctuation">.</span>wrapper<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>sa<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation" >}</span>  <span class="token comment" spellcheck="true">/**   * SimpleAlert dismiss   *   * This function simply hides our Simple Alert by removing it   * from the wrapper in question. */</span>  SimpleAlert<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>dismiss <span class="token operator">=</span> <span class="token keyword"> function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">this</span><span class="token punctuation">.</span>options<span class="token punctuation">.</span>wrapper<span class="token punctuation">.</span><span class="token function">removeChild</span><span class= "token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>sa<span class="token punctuation">)</span><span class="token punctuation">; </span>  <span class="token punctuation">}</span><span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">/**   * Add to global namespace   */</span>  window <span class="token punctuation">.</span>SimpleAlert <span class="token operator">=</span> SimpleAlert<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span> window <span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><h2>An Example Of Execution</h2><p>Now that our component is complete, let's take a look at an example execution.</p><pre class=" language-html"><code class=" language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation"> =</span><span class="token punctuation">"</span>simple-alert__button--error<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>Show Me An Error Alert<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>section</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>demo-section<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>alerts<span class="token punctuation">"</span></span><span class="token punctuation">&gt; </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>section</span><span class="token punctuation">&gt;</span></span><span class= "token script language-javascript"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt; </span></span>  <span class="token punctuation">(</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token comment" spellcheck="true">// cache vars</span>    <span class="token keyword">var</span> btn_error <span class="token operator">= </span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string"> "simple-alert__button--error"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">// show error</span> btn_error<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span> <span class="token string">"click" </span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class= "token punctuation">{</span>      e<span class="token punctuation">.</span><span class="token function">preventDefault</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token keyword">var</span> sa <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SimpleAlert</span><span class="token punctuation">(</span><span class="token punctuation">{</span>        wrapper <span class="token punctuation">:</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">"alerts"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>        type <span class="token punctuation">:</span> <span class="token string">"error"</span><span class="token punctuation">,</span>        message <span class="token punctuation">:</span> <span class="token string">"Show me an error!"</span>      <span class="token punctuation">}</span><span class ="token punctuation">)</span><span class="token punctuation">;</span>      sa<span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation" >(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class= "token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">) </span><span class="token punctuation">;</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt; </span></span></span></code></pre><p>Simple and easy.</p><h2>Wrap Up</h2><p>And that's a wrap! In this tutorial, we dove deep into the creation of a JavaScript component, object extending, instantiating, and executing. The results may be simple, but it is a great insight into the wonderful world of JavaScript OOP, and a great starting point to building your own components. Don't forget, you can view the demo and download the source by clicking the links below, and if you have and questions, comments, or feedback, you can also leave them below. Also, you can <a href="https://github.com/callmenick/Simple-Alert">check out this project on GitHub</a> and fiddle as you see fit.</p><p class="text-align--center"><a href=" http://callmenick.com/_development/simple-alert/simple-alert-source.zip" class="button button--inline-block button--medium">Get Source</a><a href=" http://callmenick.com/_development/simple-alert" class="button button--inline-block button--medium">View Demo</a></p>  </div></article>			</div> <!--=========================			END : POST		=============================-->		<!--=========================			START : POST =============================-->		<div class="post-wrapper"><div class="inner">              <div id="header">        <h1>Mixins, Forwarding, and Delegation in JavaScript</h1> <h2><a href="/">via raganwald.com</a></h2>      </div><!-- end header -->        <hr>        <section id="main_content">          <h3 id="preface-where-did-the-prototypes-go"> preface: where did the prototypes go?</h3><p>This essay discusses how to separate JavaScript domain properties from object behaviour, <em>without prototypes</em>. This is deliberate. By examining four basic ways to have one object define the behaviour of other objects, we gain insight into what we're trying to accomplish at a very basic level.</p><p>We can then take this insight to working with prototypes and understand the conveniences that prototypes provide as well as the tradeoffs that they make. That does not mean, of course that just because prototypes (or classes, for that matter) are not mentioned here, that prototypes are considered inferior to any of these techniques.</p><p>This is an essay, not a style guide.</p><h2 id= "why-metaobjects">Why metaobjects?</h2><p>It is technically possible to write software using objects alone. When we need behaviour for an object, we can give it methods by binding functions to keys in the object:</p><div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">var</span> <span class="nx">sam</span> <span class ="o">=</span> <span class="p">{</span>  <span class="nx">firstName</span><span class="o">:</span> <span class="s1">'Sam'</span><span class="p">,</span>  <span class="nx">lastName </span><span class="o">:</span> <span class="s1">'Lowry'</span><span class="p">,</span>  <span class="nx">fullName</span><span class="o">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">firstName</span> <span class="o">+</span> <span class="s2">" "</span> <span class="o">+</span> <span class="k">this</span><span class="p">.</span><span class="nx">lastName</span><span class="p">;</span>  <span class="p">},</span> <span class="nx">rename</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">first</span><span class="p">,</span> <span class="nx"> last</span><span class="p">)</span> <span class="p">{</span>    <span class="k">this</span><span class="p">.</span><span class="nx">firstName</span> <span class="o">=</span> <span class= "nx">first</span><span class="p">;</span>    <span class="k">this</span><span class="p">.</span><span class="nx">lastName</span> <span class="o">=</span> <span class="nx">last</span><span class="p">;</span>    <span class="k">return</span> <span class="k">this</span><span class="p">;</span>  <span class="p">}</span><span class="p">}</span></code></pre></div><p>We call this a "naïve" object. It has state and behaviour, but it lacks division of responsibility between its state and its behaviour.</p><p>This lack of separation has two drawbacks. First, it intermingles properties that are part of the model domain (such as <code>firstName</code>), with methods (and possibly other properties, although none are shown here) that are part of the implementation domain. Second, when we needed to share common behaviour, we could have objects share common functions, but does it not scale: There's no sense of organization, no clustering of objects and functions that share a common responsibility.</p><p>Metaobjects solve the lack-of-separation problem by separating the domain-specific properties of objects from their behaviour and implementation-specific properties.</p><p>The basic principle of the metaobject is that we separate the mechanics of behaviour from the domain properties of the base object. This has immediate engineering benefits, and it's also the foundation for designing programs with higher-level constructs like formal classes, expectations, and delegation. </p><hr><h2 id="mixins-forwarding-and-delegation">Mixins, Forwarding, and Delegation</h2><p>The simplest possible metaobject in JavaScript is a <em>mixin</em>. Consider our naïve object: </p><div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">var</span> <span class="nx">sam</span> <span class="o">=</span> <span class="p">{ </span>  <span class="nx">firstName</span><span class="o">:</span> <span class="s1">'Sam'</span><span class="p">,</span>  <span class="nx">lastName</span><span class="o">:</span> <span class="s1">'Lowry'</span><span class="p">,</span>  <span class="nx">fullName</span><span class="o">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{ </span>    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">firstName</span> <span class="o">+</span> <span class="s2">" "</span> <span class="o">+</span> <span class="k">this</span><span class="p">.</span><span class="nx">lastName</span><span class="p">;</span>  <span class="p">},</span>  <span class="nx">rename </span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">first</span><span class="p">,</span> <span class="nx">last</span><span class="p">) </span> <span class="p">{</span>    <span class="k">this</span><span class="p">.</span><span class="nx">firstName</span> <span class="o">=</span> <span class="nx">first</span><span class= "p">;</span>    <span class="k">this</span><span class="p">.</span><span class="nx">lastName</span> <span class="o">=</span> <span class="nx">last</span><span class="p">;</span>    <span class="k">return</span> <span class="k">this</span><span class="p">;</span>  <span class="p">}</span><span class="p">}</span></code></pre></div><p>We can separate its domain properties from its behaviour:</p><div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">var</span> <span class="nx">sam</span> <span class="o">=</span> <span class="p">{</span>  <span class="nx">firstName</span><span class="o">:</span> <span class="s1">'Sam'</span><span class="p">,</span>  <span class="nx">lastName</span><span class="o"> :</span> <span class="s1">'Lowry'</span><span class="p">};</span><span class="kd">var</span> <span class="nx">person</span> <span class="o">=</span> <span class="p">{</span>  <span class= "nx">fullName</span><span class="o">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>    <span class="k">return</span> <span class="k">this </span><span class="p">.</span><span class="nx">firstName</span> <span class="o">+</span> <span class="s2">" "</span> <span class="o">+</span> <span class="k">this</span><span class="p">. </span><span class="nx">lastName</span><span class="p">;</span>  <span class="p">},</span>  <span class="nx">rename</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">first</span><span class="p">,</span> <span class="nx">last</span><span class="p">)</span> <span class="p">{</span>    <span class="k">this</span><span class="p">.</span><span class="nx">firstName</span> <span class="o">=</span> <span class="nx">first</span><span class="p">;</span>    <span class="k">this</span><span class="p">. </span><span class="nx">lastName</span> <span class="o">=</span> <span class="nx">last</span><span class="p">;</span>    <span class="k">return</span> <span class="k">this</span><span class="p">;</span>  <span class="p">}</span><span class="p">};</span></code></pre></div><p>And use <code>extend</code> to mix the behaviour in:</p><div class="highlight"><pre><code class= "language-javascript" data-lang="javascript"><span class="kd">var</span> <span class="nx">__slice</span> <span class="o">=</span> <span class="p">[].</span><span class="nx">slice </span><span class="p">;</span><span class="kd">function</span> <span class="nx">extend</span> <span class="p">()</span> <span class="p">{</span>  <span class="kd">var</span> <span class= "nx">consumer</span> <span class="o">=</span> <span class="nx">arguments</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>      <span class="nx">providers </span> <span class="o">=</span> <span class="nx">__slice</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">arguments</span><span class="p" >,</span> <span class="mi">1</span><span class="p">),</span>      <span class="nx">key</span><span class="p">,</span>      <span class="nx">i</span><span class="p">,</span>      <span class="nx">provider</span><span class="p">;</span>  <span class="k">for</span> <span class="p">(</span><span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">providers</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="o">++</span><span class="nx">i</span><span class="p">)</span> <span class="p">{</span>    <span class="nx">provider</span> <span class="o">=</span> <span class="nx">providers </span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>    <span class="k">for</span> <span class="p">(</span><span class="nx">key</span> <span class="k">in </span> <span class="nx">provider</span><span class="p">)</span> <span class="p">{</span>      <span class="k">if</span> <span class="p">(</span><span class="nx">provider</span><span class ="p">.</span><span class="nx">hasOwnProperty</span><span class="p">(</span><span class="nx">key</span><span class="p">))</span> <span class="p">{</span>        <span class="nx">consumer </span><span class="p">[</span><span class="nx">key</span><span class="p">]</span> <span class="o">=</span> <span class="nx">provider</span><span class="p">[</span><span class="nx">key </span><span class="p">];</span>      <span class="p">};</span>    <span class="p">};</span>  <span class="p">};</span>  <span class="k">return</span> <span class="nx">consumer</span><span class="p">;</span><span class="p">};</span><span class="nx">extend</span><span class="p">(</span><span class="nx">sam</span><span class="p">,</span> <span class="nx">person</span><span class="p">);</span><span class="nx">sam</span><span class="p">.</span><span class="nx">rename</span>  <span class="c1">//=&gt; [Function]</span></code></pre></div><p>This allows us to separate the behaviour from the properties in our code. If we want to use the same behaviour with another object, we can do that:</p><div class="highlight"><pre><code class= "language-javascript" data-lang="javascript"><span class="kd">var</span> <span class="nx">peck</span> <span class="o">=</span> <span class="p">{</span>  <span class="nx">firstName </span><span class="o">:</span> <span class="s1">'Sam'</span><span class="p">,</span>  <span class="nx">lastName</span><span class="o">:</span> <span class="s1">'Peckinpah'</span><span class="p">};</span><span class="nx">extend</span><span class="p">(</span><span class="nx">peck</span><span class="p">,</span> <span class="nx">person</span><span class="p">); </span></code></pre></div><p>Our <code>person</code> object is a <em>template</em>, it provides some functionality to be mixed into an object with a function like <code>extend</code>. Using templates does not require copying entire functions around, each object gets references to the functions in the template.</p><p>Things get even better: You can use more than one template with the same object:</p><div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">var</span> <span class="nx">hasCareer</span> <span class="o">=</span> <span class="p">{</span>  <span class="nx">career</span><span class="o">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span> <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">chosenCareer</span><span class="p">;</span>  <span class="p">},</span>  <span class="nx"> setCareer</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">career</span><span class="p">)</span> <span class="p">{</span>    <span class="k">this</span><span class="p">.</span><span class="nx">chosenCareer</span> <span class="o">=</span> <span class="nx">career</span><span class="p">;</span>    <span class="k">return </span> <span class="k">this</span><span class="p">;</span>  <span class="p">}</span><span class="p">};</span><span class="nx">extend</span><span class="p">(</span><span class="nx">peck </span><span class="p">,</span> <span class="nx">hasCareer</span><span class="p">);</span><span class="nx">peck</span><span class="p">.</span><span class="nx">setCareer</span><span class= "p">(</span><span class="s1">'Director'</span><span class="p">);</span></code></pre></div><p>We say that there is a <em>many-to-many</em> relationship between objects and templates.</p><h3 id="scope-and-coupling">scope and coupling</h3><p>Consider a design that has four kinds of templates, we'll call them <code>A</code>, <code>B</code>, <code>C</code>, and <code>D</code>. Objects in the system might mix in one, two, three, or all four templates. There are fifteen such "kinds" of objects, those that mix in <code>A</code>, <code>B</code>, <code>AB</code>, <code>C</code>, <code>AC</code>, <code>BC</code>, <code>ABC</code>, <code>D</code>, <code>AD</code>, <code>BD</code>, <code>ABD</code>, <code>CD</code>, <code>ACD</code>, <code>BCD</code> , and <code>ABCD</code>.</p><p>When you make a change to and one template, say <code>A</code>, you have to consider how that change will affect each of the eight kinds of objects that mixes <code>A</code> in. In only one of those, <code>A</code>, do you just consider <code>A</code>'s behaviour by itself. In <code>AB</code>, <code>ABC</code>, <code>ABD</code>, and <code> ABCD</code>, you have to consider how changes to <code>A</code> may interact with <code>B</code>, because they both share access to each object's private state. Same for <code>A</code> and <code>C</code>, and <code>A</code> and <code>D</code>, of course.</p><p>By itself this is not completely revelatory: When objects interact with each other in the code, there are going to be dependencies between them, and you have to manage those dependencies.</p><p>Encapsulation solves this problem by strictly limiting the scope of interaction between objects. If object <code>a</code> invokes a method <code>x()</code> on object <code>b</code>, we know that the scope of interaction between <code>a</code> and <code>b</code> is strictly limited to the method <code>x()</code>. We also know that any change in state it may create is strictly limited to the object <code>b</code>, because <code>x()</code> cannot reach back and touch <code>a</code>'s private state.</p><p>(There is some simplification going on here as we are ignoring parameters and/or the possibility that <code>a</code> is part of <code>b</code>'s private state)</p><p>However, two methods <code>x()</code> and <code>y()</code> on the same object are tightly coupled by default, because they both interact with all of the object's private state. When we write an object like this:</p><div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">var</span> <span class="nx"> counter</span> <span class="o">=</span> <span class="p">{</span>  <span class="nx">_value</span><span class="o">:</span> <span class="mi">0</span><span class="p">,</span>  <span class="nx" >value</span><span class="o">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">_value</span><span class="p">;</span>  <span class="p">},</span>  <span class="nx">increment</span><span class="o">:</span> <span class="kd">function </span> <span class="p">()</span> <span class="p">{</span>    <span class="o">++</span><span class="k">this</span><span class="p">.</span><span class="nx">_value</span><span class="p">; </span>    <span class="k">return</span> <span class="k">this</span><span class="p">;</span>  <span class="p">},</span>  <span class="nx">decrement</span><span class="o">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>    <span class="o">--</span><span class="k">this</span><span class="p">.</span><span class="nx">_value </span><span class="p">;</span>    <span class="k">return</span> <span class="k">this</span><span class="p">;</span>  <span class="p">}</span><span class="p">}</span></code></pre></div><p> We fully understand that <code>value()</code>, <code>increment()</code>, and <code>decrement()</code> are coupled, and they are all together in our code next to each other.</p><p>Whereas, if we write:</p><div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">function</span> <span class="nx">isanIncrementor</span> <span class= "p">(</span><span class="nx">object</span><span class="p">)</span> <span class="p">{</span>  <span class="nx">object</span><span class="p">.</span><span class="nx">increment</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>    <span class="o">++</span><span class="k">this</span><span class="p">.</span><span class="nx">_value</span><span class="p">;</span>    <span class="k">return</span> <span class="k">this</span><span class="p">;</span>  <span class="p">};</span>  <span class="k">return </span> <span class="nx">object</span><span class="p">;</span><span class="p">}</span><span class="c1">// ...hundreds of lines of code...</span><span class="kd">function</span> <span class ="nx">isaDecrementor</span> <span class="p">(</span><span class="nx">object</span><span class="p">)</span> <span class="p">{</span>  <span class="nx">object</span><span class="p">. </span><span class="nx">decrement</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>    <span class="o">--</span><span class="k">this</span><span class="p">.</span><span class="nx">_value</span><span class="p">;</span>    <span class="k">return</span> <span class="k">this</span><span class="p">;</span> <span class="p">};</span>  <span class="k">return</span> <span class="nx">object</span><span class="p">;</span><span class="p">}</span></code></pre></div><p>Our two templates are tightly coupled to each other, but not obviously so. They just 'happen' to use the same property. And they might never be both mixed into the same object. Or perhaps they might. Who knows?</p><p> The technical term for templates referring to an object's private properties is <a href="https://en.wikipedia.org/wiki/Open_recursion#Open_recursion">open recursion</a>. It is powerful and flexible, in exactly the same sense that having objects refer to each other's internal properties is powerful and flexible.</p><p>And just as objects can encapsulate their own private state, so can templates.</p><h3 id="templates-with-private-properties">templates with private properties</h3><p>Let's revisit our <code>hasCareer</code> template:</p><div class="highlight" ><pre><code class="language-javascript" data-lang="javascript"><span class="kd">var</span> <span class="nx">hasCareer</span> <span class="o">=</span> <span class="p">{</span>  <span class= "nx">career</span><span class="o">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>    <span class="k">return</span> <span class="k">this </span><span class="p">.</span><span class="nx">chosenCareer</span><span class="p">;</span>  <span class="p">},</span>  <span class="nx">setCareer</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">career</span><span class="p">)</span> <span class="p">{</span>    <span class="k">this</span><span class="p">. </span><span class="nx">chosenCareer</span> <span class="o">=</span> <span class="nx">career</span><span class="p">;</span>    <span class="k">return</span> <span class="k">this </span><span class="p">;</span>  <span class="p">}</span><span class="p">};</span></code></pre></div><p><code>hasCareer</code> stores its private state in the object's <code>chosenCareer </code> property. As we've seen, that introduces coupling if any other method touches <code>chosenCareer</code>. What we'd like to do is make <code>chosenCareer</code> private. Specifically:</p><ol>  <li>We wish to store a copy of <code>chosenCareer</code> for each object that uses the <code>hasCareer</code> template. Mark Twain is a writer, Sam Peckinpah is a director.</li>  <li><code>chosenCareer</code> must not be a property of each person object, because we don't want other methods accessing it and becoming coupled.</li></ol><p>We have a few options. The very simplest, and most "native" to JavaScript, is to use a closure.</p><h3 id="privacy-through-closures">privacy through closures</h3><p>We'll write our own <a href=" https://javascriptweblog.wordpress.com/2011/05/31/a-fresh-look-at-javascript-mixins/">functional mixin</a>:</p><div class="highlight"><pre><code class="language-javascript" data-lang= "javascript"><span class="kd">function</span> <span class="nx">HasPrivateCareer</span> <span class="p">(</span><span class="nx">obj</span><span class="p">)</span> <span class="p">{</span> <span class="kd">var</span> <span class="nx">chosenCareer</span><span class="p">;</span>  <span class="nx">obj</span><span class="p">.</span><span class="nx">career</span> <span class= "o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>    <span class="k">return</span> <span class="nx">chosenCareer</span><span class="p">; </span>  <span class="p">};</span>  <span class="nx">obj</span><span class="p">.</span><span class="nx">setCareer</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">career</span><span class="p">)</span> <span class="p">{</span>    <span class="nx">chosenCareer</span> <span class="o">=</span> <span class="nx">career </span><span class="p">;</span>    <span class="k">return</span> <span class="k">this</span><span class="p">;</span>  <span class="p">};</span>  <span class="k">return</span> <span class= "nx">obj</span><span class="p">;</span><span class="p">}</span><span class="nx">HasPrivateCareer</span><span class="p">(</span><span class="nx">peck</span><span class="p">); </span></code></pre></div><p><code>chosenCareer</code> is a variable within the scope of the <code>hasCareer</code>, so the <code>career</code> and <code>setCareer</code> methods can both access it through lexical scope, but no other method can or ever will.</p><p>This approach works well for simple cases. It only works for named variables. We can't, for example, write a function that iterates through all of the private properties of this kind of functional mixin, because they aren't properties, they're variables. In the end, we have privacy, but we achieve it by not using properties at all.</p><h3 id="privacy-through-objects">privacy through objects</h3><p>Another way to achieve privacy in templates is to write them as methods that operate on <code>this</code>, but sneakily make <code>this</code> refer to a different object. Let's revisit our <code>extend</code> function:</p><div class="highlight"><pre><code class= "language-javascript" data-lang="javascript"><span class="kd">function</span> <span class="nx">extendPrivately</span> <span class="p">(</span><span class="nx">receiver</span><span class= "p">,</span> <span class="nx">template</span><span class="p">)</span> <span class="p">{</span>  <span class="kd">var</span> <span class="nx">methodName</span><span class="p">,</span> <span class="nx">privateProperty</span> <span class="o">=</span> <span class="nb">Object</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class= "kc">null</span><span class="p">);</span>  <span class="k">for</span> <span class="p">(</span><span class="nx">methodName</span> <span class="k">in</span> <span class="nx">template </span><span class="p">)</span> <span class="p">{</span>    <span class="k">if</span> <span class="p">(</span><span class="nx">template</span><span class="p">.</span><span class="nx"> hasOwnProperty</span><span class="p">(</span><span class="nx">methodName</span><span class="p">))</span> <span class="p">{</span>      <span class="nx">receiver</span><span class="p">[ </span><span class="nx">methodName</span><span class="p">]</span> <span class="o">=</span> <span class="nx">template</span><span class="p">[</span><span class="nx">methodName</span><span class="p">].</span><span class="nx">bind</span><span class="p">(</span><span class="nx">privateProperty</span><span class="p">);</span>    <span class="p">};</span>  <span class="p">}; </span>  <span class="k">return</span> <span class="nx">receiver</span><span class="p">;</span><span class="p">};</span></code></pre></div><p>We don't need to embed variables and methods in our function, it creates one private variable (<code>privateProperty</code>), and then uses <code>.bind</code> to ensure that each method is bound to that variable instead of to the receiver object being extended with the template.</p><p>Now we can extend any object with any template, 'privately:'</p><div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="nx">extendPrivately</span><span class="p">(</span><span class="nx">twain</span><span class="p">,</span> <span class="nx">hasCareer</span><span class="p" >);</span><span class="nx">twain</span><span class="p">.</span><span class="nx">setCareer</span><span class="p">(</span><span class="s1">'Author'</span><span class="p">);</span><span class ="nx">twain</span><span class="p">.</span><span class="nx">career</span><span class="p">()</span>  <span class="c1">//=&gt; 'Author'</span></code></pre></div><p>Has it modified <code>twain </code>'s properties?</p><div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="nx">twain</span><span class="p">.</span><span class="nx"> chosenCareer</span>  <span class="c1">//=&gt; undefined</span></code></pre></div><p>No. <code>twain</code> has <code>.setCareer</code> and <code>.career</code> methods, but <code> .chosencareer</code> is a property of an object created when <code>twain</code> was privately extended, then bound to each method using <a href=" https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function/bind"><code>.bind</code></a>.</p><p>The advantage of this approach over closures is that the template and the mechanism for mixing it in are separate: You just write the template's methods, you don't have to carefully ensure that they access private state through variables in a closure.</p><h3 id="another-way-to-achieve-privacy-through-objects">another way to achieve privacy through objects</h3><p>In our scheme above, we used <code>.bind</code> to create methods bound to a private object before mixing references to them into our object. There is another way to do it:</p><div class="highlight"><pre><code class="language-javascript" data-lang= "javascript"><span class="kd">function</span> <span class="nx">forward</span> <span class="p">(</span><span class="nx">receiver</span><span class="p">,</span> <span class="nx">methods </span><span class="p">,</span> <span class="nx">toProvider</span><span class="p">)</span> <span class="p">{</span>  <span class="nx">methods</span><span class="p">.</span><span class="nx" >forEach</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">methodName</span><span class="p">)</span> <span class="p">{</span>    <span class="nx">receiver</span><span class="p">[</span><span class="nx">methodName</span><span class="p">]</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">() </span> <span class="p">{</span>      <span class="k">return</span> <span class="nx">toProvider</span><span class="p">[</span><span class="nx">methodName</span><span class="p">]. </span><span class="nx">apply</span><span class="p">(</span><span class="nx">toProvider</span><span class="p">,</span> <span class="nx">arguments</span><span class="p">);</span>    <span class="p">};</span>  <span class="p">});</span>  <span class="k">return</span> <span class="nx">receiver</span><span class="p">;</span><span class="p">};</span></code></pre></div><p>This function <em>forwards</em> methods to another object. Any other object, it could be a metaobject specifically designed to define behaviour, or it could be a domain object that has other responsibilities.</p><p>Dispensing with a lot of mixins, here is a very simple example. We start with some kind of investment portfolio object that has a <code>netWorth</code> method: </p><div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">var</span> <span class="nx">portfolio</span> <span class="o">=</span> <span class= "p">{</span>  <span class="nx">_investments</span><span class="o">:</span> <span class="p">[],</span>  <span class="nx">addInvestment</span><span class="o">:</span> <span class="kd"> function</span> <span class="p">(</span><span class="nx">investment</span><span class="p">)</span> <span class="p">{</span>    <span class="k">this</span><span class="p">.</span><span class="nx">_investments</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">investment</span><span class="p">);</span>    <span class="k"> return</span> <span class="k">this</span><span class="p">;</span>  <span class="p">},</span>  <span class="nx">netWorth</span><span class="o">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">_investments</span><span class="p">. </span><span class="nx">reduce</span><span class="p">(</span>      <span class="kd">function</span> <span class="p">(</span><span class="nx">acc</span><span class="p">,</span> <span class= "nx">investment</span><span class="p">)</span> <span class="p">{</span>        <span class="k">return</span> <span class="nx">acc</span> <span class="o">+</span> <span class="nx"> investment</span><span class="p">.</span><span class="nx">value</span><span class="p">;</span>      <span class="p">},</span>      <span class="mi">0</span>    <span class="p">);</span> <span class="p">}</span><span class="p">};</span></code></pre></div><p>And next we create an investor who has this portfolio of investments:</p><div class="highlight"><pre><code class= "language-javascript" data-lang="javascript"><span class="kd">var</span> <span class="nx">investor</span> <span class="o">=</span> <span class="p">{</span>  <span class="c1">//... </span><span class="p">}</span></code></pre></div><p>What if we want to make investments and to know an investor's net worth?</p><div class="highlight"><pre><code class= "language-javascript" data-lang="javascript"><span class="nx">forward</span><span class="p">(</span><span class="nx">investor</span><span class="p">,</span> <span class="p">[</span><span class="s1">'addInvestment'</span><span class="p">,</span> <span class="s1">'netWorth'</span><span class="p">],</span> <span class="nx">portfolio</span><span class="p">); </span></code></pre></div><p>We're saying "Forward all requests for <code>addInvestment</code> and <code>netWorth</code> to the portfolio object."</p><h3 id="forwarding">forwarding</h3><p> Forwarding is a relationship between an object that receives a method invocation receiver and a provider object. They may be peers. The provider may be contained by the consumer. Or perhaps the provider is a metaobject.</p><p>When forwarding, the provider object has its own state. There is no special binding of function contexts, instead the consumer object has its own methods that forward to the provider and return the result. Our <code>forward</code> function above handles all of that, iterating over the provider's properties and making forwarding methods in the consumer.</p><p>The key idea is that when forwarding, the provider object handles each method <em>in its own context</em>. This is very similar to the effect of our solution with <code>.bind</code> above, but not identical.</p><p>Because there is a forwarding method in the consumer object and a handling method in the provider, the two can be varied independently. Here's a snippet of our <code>forward</code> function from above:</p><div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="nx"> consumer</span><span class="p">[</span><span class="nx">methodName</span><span class="p">]</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>  <span class="k">return</span> <span class="nx">toProvider</span><span class="p">[</span><span class="nx">methodName</span><span class="p">].</span><span class="nx"> apply</span><span class="p">(</span><span class="nx">toProvider</span><span class="p">,</span> <span class="nx">arguments</span><span class="p">);</span><span class="p">} </span></code></pre></div><p>Each forwarding function invokes the method in the provider <em>by name</em>. So we can do this:</p><div class="highlight"><pre><code class= "language-javascript" data-lang="javascript"><span class="nx">portfolio</span><span class="p">.</span><span class="nx">netWorth</span> <span class="o">=</span> <span class="kd">function </span> <span class="p">()</span> <span class="p">{</span>  <span class="k">return</span> <span class="s2">"I'm actually bankrupt!"</span><span class="p">;</span><span class="p">} </span></code></pre></div><p>We're overwriting the method in the <code>portfolio</code> object, but not the forwarding function. So now, our <code>investor</code> object will forward invocations of <code>netWorth</code> to the new function, not the original. This is not how our <code>.bind</code> system worked above.</p><p>That makes sense from a "metaphor" perspective. With our <code>extendPrivately</code> function above, we are creating an object as a way of making private state, but we don't think of it as really being a first-class entity unto itself. We're mixing those specific methods into a consumer.</p><p>Another way to say this is that mixing in is "early bound," while forwarding is "late bound:" We'll look up the method when it's invoked.</p><h3 id="summarizing-what-we-know-so-far">summarizing what we know so far</h3><p>So now we have three things: Mixing in a template; mixing in a template with private state for its methods ("Private Mixin"); and forwarding to a first-class object. And we've talked all around two questions:</p><ol>  <li>Is the mixed-in method being early-bound? Or late-bound?</li>  <li>When a method is invoked on a receiving object, is it evaluated in the receiver's context? Or in the metaobject's state's context?</li></ol><p>If we make a little table, each of those three things gets its own spot:</p><table>  <thead>    <tr>      <th style="text-align: left">&nbsp;</th>      <th style="text-align: left"><em> Early-bound</em></th>      <th style="text-align: left"><em>Late-bound</em></th>    </tr>  </thead>  <tbody>    <tr>      <td style="text-align: left"><strong>Receiver's context </strong></td>      <td style="text-align: left">Mixin</td>      <td style="text-align: left">&nbsp;</td>    </tr>    <tr>      <td style="text-align: left"><strong>Metaobject's context </strong></td>      <td style="text-align: left">Private Mixin</td>      <td style="text-align: left">Forwarding</td>    </tr>  </tbody></table><p>So... What goes in the missing spot? What is late-bound, but evaluated in the receiver's context?</p><h3 id="delegation">delegation</h3><p>Let's build it. Here's our <code>forward</code> function, modified to evaluate method invocation in the receiver's context:</p><div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">function</span> <span class="nx">delegate </span> <span class="p">(</span><span class="nx">receiver</span><span class="p">,</span> <span class="nx">methods</span><span class="p">,</span> <span class="nx">toProvider</span><span class="p">)</span> <span class="p">{</span>  <span class="nx">methods</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">methodName</span><span class="p">)</span> <span class="p">{</span>    <span class="nx">receiver</span><span class="p">[</span><span class="nx"> methodName</span><span class="p">]</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>      <span class="k">return</span> <span class="nx">toProvider</span><span class="p">[</span><span class="nx">methodName</span><span class="p">].</span><span class="nx">apply</span><span class="p">(</span><span class="nx"> receiver</span><span class="p">,</span> <span class="nx">arguments</span><span class="p">);</span>    <span class="p">};</span>  <span class="p">});</span>  <span class="k">return</span> <span class="nx">receiver</span><span class="p">;</span><span class="p">};</span></code></pre></div><p>This new <code>delegate</code> function does exactly the same thing as the <code> forward</code> function, but the function that does the delegation looks like this:</p><div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd" >function</span> <span class="p">()</span> <span class="p">{</span>  <span class="k">return</span> <span class="nx">toProvider</span><span class="p">[</span><span class="nx">methodName </span><span class="p">].</span><span class="nx">apply</span><span class="p">(</span><span class="nx">receiver</span><span class="p">,</span> <span class="nx">arguments</span><span class= "p">);</span><span class="p">}</span></code></pre></div><p>It uses the receiver as the context instead of the provider. This has all the same coupling implications that our mixins have, of course. And it layers in additional indirection. The indirection gives us some late binding, allowing us to modify the metaobject's methods <em>after</em> we have delegated behaviour from a receiver to it.</p><h3 id="delegation-vs-forwarding">delegation vs. forwarding</h3><p>Delegation and forwarding are both very similar. One metaphor that might help distinguish them is to think of receiving an email asking you to donate some money to a worthy charity.</p><ul>  <li>If you <em>forward</em> the email to a friend, and the friend donates money, the friend is donating their own money and getting their own tax receipt.</li>  <li>If you <em>delegate</em> responding to your accountant, the accountant donates <em>your</em> money to the charity and you receive the tax receipt.</li></ul><p>In both cases, the other entity does the work when you receive the email.</p><hr><h2 id="later-binding">Later Binding</h2><p>When comparing Mixins to Delegation (and comparing Private Mixins to Forwarding), we noted that the primary difference is that Mixins are early bound and Delegation is late bound. Let's be specific. Given:</p><div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">var</span> <span class="nx">counter</span> <span class="o">=</span> <span class="p">{};</span><span class="kd">var</span> <span class="nx">Incrementor</span> <span class="o">=</span> <span class="p">{</span>  <span class="nx">increment</span><span class="o">: </span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>    <span class="o">++</span><span class="k">this</span><span class="p">.</span><span class="nx"> _value</span><span class="p">;</span>    <span class="k">return</span> <span class="k">this</span><span class="p">;</span>  <span class="p">},</span>  <span class="nx">value</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">optionalValue</span><span class="p">)</span> <span class="p">{</span>    <span class="k">if </span> <span class="p">(</span><span class="nx">optionalValue</span> <span class="o">!=</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>      <span class="k">this</span><span class="p">.</span><span class="nx">_value</span> <span class="o">=</span> <span class="nx">optionalValue</span><span class="p">;</span>    <span class="p">} </span>    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">_value</span><span class="p">;</span>  <span class="p">}</span><span class="p"> };</span><span class="nx">extend</span><span class="p">(</span><span class="nx">counter</span><span class="p">,</span> <span class="nx">Incrementor</span><span class="p">); </span></code></pre></div><p>We are mixing <code>Incrementor</code> into <code>counter</code>. At some point later, we encounter:</p><div class="highlight"><pre><code class= "language-javascript" data-lang="javascript"><span class="nx">counter</span><span class="p">.</span><span class="nx">value</span><span class="p">(</span><span class="mi">42</span><span class="p">);</span></code></pre></div><p>What function handles the invocation of <code>.value</code>? because we mixed <code>Incrementor</code> into <code>counter</code>, it's the same function as <code>Incrementor.value</code>. We don't look that up when <code>counter.value(42)</code> is evaluated, because that was bound to <code>counter.value</code> when we extended <code>counter</code>. This is early binding.</p><p>However, given:</p><div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">var</span> <span class="nx">counter</span> <span class="o">=</span> <span class="p">{};</span><span class="nx">delegate</span><span class="p">(</span><span class="nx">counter</span><span class="p">, </span> <span class="p">[</span><span class="s1">'increment'</span><span class="p">,</span> <span class="s1">'value'</span><span class="p">],</span> <span class="nx">Incrementor </span><span class="p">);</span><span class="c1">// ...time passes...</span><span class="nx">counter</span><span class="p">.</span><span class="nx">value</span><span class="p">( </span><span class="mi">42</span><span class="p">);</span></code></pre></div><p>We again are most likely invoking <code>Incrementor.value</code>, but now we are determining this <em>at the time <code>counter.value(42)</code> is evaluated</em>. We bound the target of the delegation, <code>Incrementor</code>, to <code>counter</code>, but we are going to look the actual property of <code>Incrementor.value</code> up when it is invoked. This is late binding, and it is useful in that we can make some changes to <code>Incrementor</code> after the delegation has been set up, perhaps to add some logging.</p><p>It is very nice not to have to do things like this in a very specific order: When things have to be done in a specific order, they are <em>coupled in time</em>. Late binding is a decoupling technique.</p><h3 id="but-wait-theres-more">but wait, there's more</h3><p>But we can get <em>even later than that</em>. Although the specific function is late bound, the target of the delegation, <code>Incrementor</code>, is early bound. We can late bind that too! Here's a variation on <code>delegate</code>:</p><div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">function</span> <span class="nx">delegateToOwn</span> <span class="p">(</span><span class= "nx">receiver</span><span class="p">,</span> <span class="nx">methods</span><span class="p">,</span> <span class="nx">propertyName</span><span class="p">)</span> <span class="p">{</span> <span class="nx">methods</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx"> methodName</span><span class="p">)</span> <span class="p">{</span>    <span class="nx">receiver</span><span class="p">[</span><span class="nx">methodName</span><span class="p">]</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>      <span class="kd">var</span> <span class="nx">toProvider</span> <span class ="o">=</span> <span class="nx">receiver</span><span class="p">[</span><span class="nx">propertyName</span><span class="p">];</span>      <span class="k">return</span> <span class="nx"> toProvider</span><span class="p">[</span><span class="nx">methodName</span><span class="p">].</span><span class="nx">apply</span><span class="p">(</span><span class="nx">receiver </span><span class="p">,</span> <span class="nx">arguments</span><span class="p">);</span>    <span class="p">};</span>  <span class="p">});</span>  <span class="k">return</span> <span class="nx">receiver</span><span class="p">;</span><span class="p">};</span></code></pre></div><p>This function sets things up so that an object can delegate to one of its own properties. Let's take another look at the investor example. First, we'll set up our portfolio to separate behaviour from properties with a standard mixin:</p><div class="highlight"><pre><code class= "language-javascript" data-lang="javascript"><span class="kd">var</span> <span class="nx">HasInvestments</span> <span class="o">=</span> <span class="p">{</span>  <span class="nx"> addInvestment</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">investment</span><span class="p">)</span> <span class="p">{</span> <span class="k">this</span><span class="p">.</span><span class="nx">_investments</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx"> investment</span><span class="p">);</span>    <span class="k">return</span> <span class="k">this</span><span class="p">;</span>  <span class="p">},</span>  <span class="nx">netWorth </span><span class="o">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>    <span class="k">return</span> <span class="k">this</span><span class= "p">.</span><span class="nx">_investments</span><span class="p">.</span><span class="nx">reduce</span><span class="p">(</span>      <span class="kd">function</span> <span class="p">( </span><span class="nx">acc</span><span class="p">,</span> <span class="nx">investment</span><span class="p">)</span> <span class="p">{</span>        <span class="k">return</span> <span class="nx">acc</span> <span class="o">+</span> <span class="nx">investment</span><span class="p">.</span><span class="nx">value</span><span class="p">;</span>      <span class="p">}, </span>      <span class="mi">0</span>    <span class="p">);</span>  <span class="p">}</span><span class="p">};</span><span class="kd">var</span> <span class="nx">portfolio</span> <span class="o">=</span> <span class="nx">extend</span><span class="p">({</span><span class="nx">_investments</span><span class="o">:</span> <span class="p">[]},</span> <span class="nx"> HasInvestments</span><span class="p">);</span></code></pre></div><p>Next we'll make that a property of our investor, and delegate to the property, not the object itself:</p><div class= "highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">var</span> <span class="nx">investor</span> <span class="o">=</span> <span class="p">{</span> <span class="c1">// ...</span>  <span class="nx">nestEgg</span><span class="o">:</span> <span class="nx">portfolio</span><span class="p">}</span><span class="nx">delegateToOwn</span><span class="p">(</span><span class="nx">investor</span><span class="p">,</span> <span class="p">[</span><span class="s1">'addInvestment'</span><span class="p">,</span> <span class="s1"> 'netWorth'</span><span class="p">],</span> <span class="s1">'nestEgg'</span><span class="p">);</span></code></pre></div><p>Our <code>investor</code> object delegates the <code> addInvestment</code> and <code>netWorth</code> methods to its own <code>nestEgg</code> property. So far, this is just like the <code>delegate</code> method above. But consider what happens if we decide to assign a new portfolio to our investor:</p><div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">var</span> <span class="nx">retirementPortfolio</span> <span class="o">=</span> <span class="p">{</span>  <span class="nx">_investments</span><span class="o">:</span> <span class="p">[</span>    <span class="p">{</span><span class="nx">name</span><span class="o">:</span> <span class="s1">'IRA fund'</span><span class="p">,</span> <span class="nx">worth</span><span class="o">:</span> <span class="s1">'872,000'</span><span class="p">}</span>  <span class="p">]</span><span class="p">}</span><span class="nx">investor</span><span class="p">.</span><span class="nx">nestEgg </span> <span class="o">=</span> <span class="nx">retirementPortfolio</span><span class="p">;</span></code></pre></div><p>The <code>delegateToOwn</code> delegation now delegates to the new portfolio, because it is bound to the property name, not to the original object. This seems questionable for portfolios–what happens to the old portfolio when you assign a new one?–but has tremendous application for modeling classes of behaviour that change dynamically.</p><h3 id="state-machines">state machines</h3><p>A very common use case for this delegation is when building <a href="https://en.wikipedia.org/wiki/Finite-state_machine">finite state machines</a>. As described in the book <a href="https://leanpub.com/4rulesofsimpledesign"> Understanding the Four Rules of Simple Design</a> by Corey Haines, you <em>could</em> implement <a href="https://en.wikipedia.org/wiki/Conway%27s_Game_of_Life">Conway's Game of Life</a> using if statements. Hand waving furiously over other parts of the system, you might get:</p><div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">var</span> <span class="nx">Universe</span> <span class="o">=</span> <span class="p">{</span>  <span class="c1">// ...</span>  <span class="nx">numberOfNeighbours</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">location</span><span class="p">)</span> <span class="p">{</span>    <span class="c1">// ... </span>  <span class="p">}</span><span class="p">};</span><span class="kd">var</span> <span class="nx">thisGame</span> <span class="o">=</span> <span class="nx">extend</span><span class= "p">({},</span> <span class="nx">Universe</span><span class="p">);</span><span class="kd">var</span> <span class="nx">Cell</span> <span class="o">=</span> <span class="p">{</span>  <span class="nx">alive</span><span class="o">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>    <span class="k">return</span> <span class="k">this </span><span class="p">.</span><span class="nx">_alive</span><span class="p">;</span>  <span class="p">},</span>  <span class="nx">numberOfNeighbours</span><span class="o">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>    <span class="k">return</span> <span class="nx">thisGame</span><span class="p">.</span><span class="nx"> numberOfNeighbours</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">_location</span><span class="p">);</span>  <span class="p">},</span> <span class="nx">aliveInNextGeneration</span><span class="o">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>    <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">alive</span><span class="p">())</span> <span class="p">{</span>      <span class="k">return</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">numberOfNeighbours</span><span class="p">()</span> <span class="o">===</span> <span class="mi">3 </span><span class="p">);</span>    <span class="p">}</span>    <span class="k">else</span> <span class="p">{</span>      <span class="k">return</span> <span class="p">(</span><span class= "k">this</span><span class="p">.</span><span class="nx">numberOfNeighbours</span><span class="p">()</span> <span class="o">===</span> <span class="mi">2</span> <span class="o">||</span> <span class="k">this</span><span class="p">.</span><span class="nx">numberOfNeighbours</span><span class="p">()</span> <span class="o">===</span> <span class="mi">3</span><span class="p"> );</span>    <span class="p">}</span>  <span class="p">}</span><span class="p">};</span><span class="kd">var</span> <span class="nx">someCell</span> <span class="o">=</span> <span class= "nx">extend</span><span class="p">({</span>  <span class="nx">_alive</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>  <span class="nx">_location </span><span class="o">:</span> <span class="p">{</span><span class="nx">x</span><span class="o">:</span> <span class="o">-</span><span class="mi">15</span><span class="p">,</span> <span class="nx">y</span><span class="o">:</span> <span class="mi">12</span><span class="p">}</span><span class="p">},</span> <span class="nx">Cell</span><span class="p">); </span></code></pre></div><p>One of the many insights from <a href="https://leanpub.com/4rulesofsimpledesign">Understanding the Four Rules of Simple Design</a> is that this business of having an <code>if (alive())</code> in the middle of a method is a hint that cells are stateful.</p><p>We can extract this into a state machine using delegation to a property:</p><div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">var</span> <span class="nx">Alive</span> <span class="o">=</span> <span class="p">{</span> <span class="nx">alive</span><span class="o">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>    <span class="k">return</span> <span class= "kc">true</span><span class="p">;</span>  <span class="p">},</span>  <span class="nx">aliveInNextGeneration</span><span class="o">:</span> <span class="kd">function</span> <span class="p"> ()</span> <span class="p">{</span>    <span class="k">return</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">numberOfNeighbours </span><span class="p">()</span> <span class="o">===</span> <span class="mi">3</span><span class="p">);</span>  <span class="p">}</span><span class="p">};</span><span class="kd">var</span> <span class="nx">Dead</span> <span class="o">=</span> <span class="p">{</span>  <span class="nx">alive</span><span class="o">:</span> <span class="kd">function</span> <span class="p">() </span> <span class="p">{</span>    <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>  <span class="p">},</span>  <span class="nx">aliveInNextGeneration </span><span class="o">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>    <span class="k">return</span> <span class="p">(</span><span class="k" >this</span><span class="p">.</span><span class="nx">numberOfNeighbours</span><span class="p">()</span> <span class="o">===</span> <span class="mi">2</span> <span class="o">||</span> <span class="k">this</span><span class="p">.</span><span class="nx">numberOfNeighbours</span><span class="p">()</span> <span class="o">===</span> <span class="mi">3</span><span class="p">); </span>  <span class="p">}</span><span class="p">};</span><span class="kd">var</span> <span class="nx">FsmCell</span> <span class="o">=</span> <span class="p">{</span>  <span class="nx"> numberOfNeighbours</span><span class="o">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>    <span class="k">return</span> <span class="nx"> thisGame</span><span class="p">.</span><span class="nx">numberOfNeighbours</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">_location </span><span class="p">);</span>  <span class="p">}</span><span class="p">}</span><span class="nx">delegateToOwn</span><span class="p">(</span><span class="nx">FsmCell</span><span class= "p">,</span> <span class="p">[</span><span class="s1">'alive'</span><span class="p">,</span> <span class="s1">'aliveInNextGeneration'</span><span class="p">],</span> <span class="s1"> '_state'</span><span class="p">);</span><span class="kd">var</span> <span class="nx">someFsmCell</span> <span class="o">=</span> <span class="nx">extend</span><span class="p">({</span> <span class="nx">_state</span><span class="o">:</span> <span class="nx">Alive</span><span class="p">,</span>  <span class="nx">_location</span><span class="o">:</span> <span class="p">{ </span><span class="nx">x</span><span class="o">:</span> <span class="o">-</span><span class="mi">15</span><span class="p">,</span> <span class="nx">y</span><span class="o">:</span> <span class="mi">12</span><span class="p">}</span><span class="p">},</span> <span class="nx">FsmCell</span><span class="p">);</span></code></pre></div><p><code>someFsmCell</code> delegates <code>alive</code> and <code>aliveInNextGeneration</code> to its <code>_state</code> property, and you can change its state with assignment:</p><div class="highlight"><pre><code class= "language-javascript" data-lang="javascript"><span class="nx">someFsmCell</span><span class="p">.</span><span class="nx">_state</span> <span class="o">=</span> <span class="nx">Dead </span><span class="p">;</span></code></pre></div><p>In practice, states would be assigned en masse, but this demonstrates one of the simplest possible state machines. In the wild, most business objects are state machines, sometimes with multiple, loosely coupled states. Employees can be:</p><ul>  <li>In or out of the office;</li>  <li>On probation, on contract, or permanent;</li>  <li>Part time or full time.</li></ul><p>Delegation to a property representing state takes advantage of late binding to break behaviour into smaller components that have cleanly defined responsibilities.</p><h3 id="late-bound-forwarding">late bound forwarding</h3><p>The exact same technique can be used for forwarding to a property, and forwarding to a property can also be used for some kinds of state machines. Forwarding to a property has lower coupling than delegation, and is preferred where appropriate.</p><hr><h2 id="summary">Summary </h2><p>We've seen four techniques for separating object behaviour from object properties:</p><ol>  <li>Mixins</li>  <li>Private Mixins</li>  <li>Forwarding</li>  <li>Delegation </li></ol><p>We've also seen how to implement "later binding" delegation by delegating or forwarding to an object property, and how this can be used for building a state machine. We've seen how these four techniques can be understood to implement two orthogonal ideas: Early versus late binding, and whether methods are evaluated in the receiver's context or the metaobject's context.</p><p>We deliberately haven't discussed prototypes or the things you can build with prototypes (like classes). Instead, we take our understanding gleaned from these prototype-less techniques to help us understand what prototypes offer and what tradeoffs they make.</p><p>(discuss on <a href="https://news.ycombinator.com/item?id=7566879">hacker news</a> )</p>        </section>      </div>			</div>		<!--=========================			END : POST		=============================--> <!--=========================			START : POST		=============================-->		<div class="post-wrapper"><h1>Prototypes are Objects (and why that matters)</h1><section id="main_content">          <p><em>Prerequisite: This post presumes that readers are familiar with JavaScript's objects, know how a prototype defines behaviour for an object, know what a constructor function is, and how a constructor's <code>.prototype</code> property is related to the objects it constructs. Passing familiarity with ECMAScript 2015 syntax will be  helpful. </em></p><p>We have always been able to create a JavaScript class like this:</p><div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd"> function</span> <span class="nx">Person</span> <span class="p">(</span><span class="nx">first</span><span class="p">,</span> <span class="nx">last</span><span class="p">)</span> <span class="p">{</span>  <span class="k">this</span><span class="p">.</span><span class="nx">rename</span><span class="p">(</span><span class="nx">first</span><span class="p">,</span> <span class="nx">last</span><span class="p">);</span><span class="p">}</span><span class="nx">Person</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">fullName</span> <span class="o">=</span> <span class="kd">function</span> <span class="nx">fullName</span> <span class="p">()</span> <span class="p">{</span>  <span class="k"> return</span> <span class="k">this</span><span class="p">.</span><span class="nx">firstName</span> <span class="o">+</span> <span class="s2">" "</span> <span class="o">+</span> <span class ="k">this</span><span class="p">.</span><span class="nx">lastName</span><span class="p">;</span><span class="p">};</span><span class="nx">Person</span><span class="p">.</span><span class= "nx">prototype</span><span class="p">.</span><span class="nx">rename</span> <span class="o">=</span> <span class="kd">function</span> <span class="nx">rename</span> <span class="p">( </span><span class="nx">first</span><span class="p">,</span> <span class="nx">last</span><span class="p">)</span> <span class="p">{</span>  <span class="k">this</span><span class="p">. </span><span class="nx">firstName</span> <span class="o">=</span> <span class="nx">first</span><span class="p">;</span>  <span class="k">this</span><span class="p">.</span><span class="nx" >lastName</span> <span class="o">=</span> <span class="nx">last</span><span class="p">;</span>  <span class="k">return</span> <span class="k">this</span><span class="p">;</span><span class ="p">}</span></code></pre></div><p><code>Person</code> is a constructor function, and it's also a class, in the JavaScript sense of the word "<a href=" http://raganwald.com/2015/05/11/javascript-classes.html">class</a>."</p><p>ECMAScript 2015 provides the <code>class</code> keyword and "compact method notation" as syntactic sugar for writing a function and assigning methods to its prototype (there is a little more involved, but that isn't relevant here). So we can now write our <code>Person</code> class like this: </p><div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kr">class</span> <span class="nx">Person</span> <span class="p">{</span>  <span class= "nx">constructor</span> <span class="p">(</span><span class="nx">first</span><span class="p">,</span> <span class="nx">last</span><span class="p">)</span> <span class="p">{</span>    <span class="k">this</span><span class="p">.</span><span class="nx">rename</span><span class="p">(</span><span class="nx">first</span><span class="p">,</span> <span class="nx">last</span><span class="p">);</span>  <span class="p">}</span>  <span class="nx">fullName</span> <span class="p">()</span> <span class="p">{</span>    <span class="k">return</span> <span class="k">this </span><span class="p">.</span><span class="nx">firstName</span> <span class="o">+</span> <span class="s2">" "</span> <span class="o">+</span> <span class="k">this</span><span class="p">. </span><span class="nx">lastName</span><span class="p">;</span>  <span class="p">}</span>  <span class="nx">rename</span> <span class="p">(</span><span class="nx">first</span><span class= "p">,</span> <span class="nx">last</span><span class="p">)</span> <span class="p">{</span>    <span class="k">this</span><span class="p">.</span><span class="nx">firstName</span> <span class="o">=</span> <span class="nx">first</span><span class="p">;</span>    <span class="k">this</span><span class="p">.</span><span class="nx">lastName</span> <span class="o">=</span> <span class="nx">last</span><span class="p">;</span>    <span class="k">return</span> <span class="k">this</span><span class="p">;</span>  <span class="p">}</span><span class="p">}; </span></code></pre></div><p>Nice. But behind the scenes, you still wind up with a constructor function bound to the name <code>Person</code>, and with <code>Person.prototype</code> being an object that looks like this:</p><div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="p">{</span>  <span class="nx">fullName</span><span class="o">:</span> <span class="kd">function</span> <span class="nx">fullName</span> <span class="p">()</span> <span class="p">{</span>    <span class="k">return</span> <span class="k"> this</span><span class="p">.</span><span class="nx">firstName</span> <span class="o">+</span> <span class="s2">" "</span> <span class="o">+</span> <span class="k">this</span><span class= "p">.</span><span class="nx">lastName</span><span class="p">;</span>  <span class="p">},</span>  <span class="nx">rename</span><span class="o">:</span> <span class="kd">function</span> <span class="nx">rename</span> <span class="p">(</span><span class="nx">first</span><span class="p">,</span> <span class="nx">last</span><span class="p">)</span> <span class="p">{</span> <span class="k">this</span><span class="p">.</span><span class="nx">firstName</span> <span class="o">=</span> <span class="nx">first</span><span class="p">;</span>    <span class="k"> this</span><span class="p">.</span><span class="nx">lastName</span> <span class="o">=</span> <span class="nx">last</span><span class="p">;</span>    <span class="k">return</span> <span class="k">this</span><span class="p">;</span>  <span class="p">}</span><span class="p">}</span></code></pre></div><h3 id="prototypes-are-objects">prototypes are objects</h3><p>If we want to change the behaviour of a JavaScript object, we can add, remove, or modify methods of the object by adding, removing, or modifying the functions bound to properties of the object. This differs from most classical languages, they have a special form (e.g. Ruby's <code>def</code>) for defining methods.</p><p>Prototypes in JavaScript are "just objects," and since they are "just objects," we can add, remove, or modify methods of the prototype by adding, removing, or modifying the functions bound to properties of the prototype.</p><p>That's exactly what the ECMAScript 5 code above does, and the ECMAScript 2015 <code>class</code> syntax "desugars" to equivalent code.</p><p>Prototypes being "just objects" means we can use any technique that works on objects on prototypes. For example, instead of binding functions to a prototype one-at-a-time, we can bind them <em>en masse</em> using <code>Object.assign</code>:</p><div class= "highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">function</span> <span class="nx">Person</span> <span class="p">(</span><span class="nx">first </span><span class="p">,</span> <span class="nx">last</span><span class="p">)</span> <span class="p">{</span>  <span class="k">this</span><span class="p">.</span><span class="nx">rename </span><span class="p">(</span><span class="nx">first</span><span class="p">,</span> <span class="nx">last</span><span class="p">);</span><span class="p">}</span><span class="nb">Object </span><span class="p">.</span><span class="nx">assign</span><span class="p">(</span><span class="nx">Person</span><span class="p">.</span><span class="nx">prototype</span><span class="p"> ,</span> <span class="p">{</span>  <span class="nx">fullName</span><span class="o">:</span> <span class="kd">function</span> <span class="nx">fullName</span> <span class="p">()</span> <span class="p">{</span>    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">firstName</span> <span class="o">+</span> <span class="s2">" " </span> <span class="o">+</span> <span class="k">this</span><span class="p">.</span><span class="nx">lastName</span><span class="p">;</span>  <span class="p">},</span>  <span class="nx"> rename</span><span class="o">:</span> <span class="kd">function</span> <span class="nx">rename</span> <span class="p">(</span><span class="nx">first</span><span class="p">,</span> <span class="nx">last</span><span class="p">)</span> <span class="p">{</span>    <span class="k">this</span><span class="p">.</span><span class="nx">firstName</span> <span class="o">=</span> <span class="nx">first</span><span class="p">;</span>    <span class="k">this</span><span class="p">.</span><span class="nx">lastName</span> <span class="o">=</span> <span class="nx">last </span><span class="p">;</span>    <span class="k">return</span> <span class="k">this</span><span class="p">;</span>  <span class="p">}</span><span class="p">}) </span></code></pre></div><p>And of course, we could use compact method syntax<sup id="fnref:super"><a href="#fn:super" class="footnote">1</a></sup> if we like:</p><div class="highlight" ><pre><code class="language-javascript" data-lang="javascript"><span class="kd">function</span> <span class="nx">Person</span> <span class="p">(</span><span class="nx">first</span><span class="p">,</span> <span class="nx">last</span><span class="p">)</span> <span class="p">{</span>  <span class="k">this</span><span class="p">.</span><span class="nx">rename</span><span class="p">(</span><span class="nx">first</span><span class="p">,</span> <span class="nx">last</span><span class="p">);</span><span class="p">}</span><span class="nb">Object</span><span class="p">.</span><span class="nx">assign</span><span class="p">(</span><span class="nx">Person</span><span class="p">.</span><span class="nx">prototype</span><span class="p">,</span> <span class="p">{</span>  <span class="nx">fullName</span> <span class="p">()</span> <span class="p">{</span>    <span class="k">return</span> <span class="k">this</span><span class="p">. </span><span class="nx">firstName</span> <span class="o">+</span> <span class="s2">" "</span> <span class="o">+</span> <span class="k">this</span><span class="p">.</span><span class="nx"> lastName</span><span class="p">;</span>  <span class="p">},</span>  <span class="nx">rename</span> <span class="p">(</span><span class="nx">first</span><span class="p">,</span> <span class ="nx">last</span><span class="p">)</span> <span class="p">{</span>    <span class="k">this</span><span class="p">.</span><span class="nx">firstName</span> <span class="o">=</span> <span class="nx">first</span><span class="p">;</span>    <span class="k">this</span><span class="p">.</span><span class="nx">lastName</span> <span class="o">=</span> <span class="nx">last </span><span class="p">;</span>    <span class="k">return</span> <span class="k">this</span><span class="p">;</span>  <span class="p">}</span><span class="p">}) </span></code></pre></div><h3 id="mixins">mixins</h3><p>Since <code>class</code> desugars to constructor functions and prototypes, we can mix and match techniques:</p><div class= "highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kr">class</span> <span class="nx">Person</span> <span class="p">{</span>  <span class="nx"> constructor</span> <span class="p">(</span><span class="nx">first</span><span class="p">,</span> <span class="nx">last</span><span class="p">)</span> <span class="p">{</span>    <span class="k">this</span><span class="p">.</span><span class="nx">rename</span><span class="p">(</span><span class="nx">first</span><span class="p">,</span> <span class="nx">last</span><span class="p">);</span>  <span class="p">}</span>  <span class="nx">fullName</span> <span class="p">()</span> <span class="p">{</span>    <span class="k">return</span> <span class="k">this </span><span class="p">.</span><span class="nx">firstName</span> <span class="o">+</span> <span class="s2">" "</span> <span class="o">+</span> <span class="k">this</span><span class="p">. </span><span class="nx">lastName</span><span class="p">;</span>  <span class="p">}</span>  <span class="nx">rename</span> <span class="p">(</span><span class="nx">first</span><span class= "p">,</span> <span class="nx">last</span><span class="p">)</span> <span class="p">{</span>    <span class="k">this</span><span class="p">.</span><span class="nx">firstName</span> <span class="o">=</span> <span class="nx">first</span><span class="p">;</span>    <span class="k">this</span><span class="p">.</span><span class="nx">lastName</span> <span class="o">=</span> <span class="nx">last</span><span class="p">;</span>    <span class="k">return</span> <span class="k">this</span><span class="p">;</span>  <span class="p">}</span><span class="p">}; </span><span class="nb">Object</span><span class="p">.</span><span class="nx">assign</span><span class="p">(</span><span class="nx">Person</span><span class="p">.</span><span class="nx"> prototype</span><span class="p">,</span> <span class="p">{</span>  <span class="nx">addToCollection</span> <span class="p">(</span><span class="nx">name</span><span class="p">)</span> <span class="p">{</span>    <span class="k">this</span><span class="p">.</span><span class="nx">collection</span><span class="p">().</span><span class="nx">push</span><span class="p">( </span><span class="nx">name</span><span class="p">);</span>    <span class="k">return</span> <span class="k">this</span><span class="p">;</span>  <span class="p">},</span>  <span class= "nx">collection</span> <span class="p">()</span> <span class="p">{</span>    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx"> _collected_books</span> <span class="o">||</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">_collected_books</span> <span class="o">= </span> <span class="p">[]);</span>  <span class="p">}</span><span class="p">})</span></code></pre></div><p>We have just "mixed" methods concerned with collecting books into our <code> Person</code> class. It's great that we can write code in a very "point-free" style, but naming things is also great:</p><div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kr">const</span> <span class="nx">BookCollector</span> <span class="o">=</span> <span class="p">{</span>  <span class="nx">addToCollection</span> <span class="p">(</span><span class="nx">name</span><span class="p">)</span> <span class="p">{</span>    <span class="k">this</span><span class="p">.</span><span class="nx">collection </span><span class="p">().</span><span class="nx">push</span><span class="p">(</span><span class="nx">name</span><span class="p">);</span>    <span class="k">return</span> <span class="k"> this</span><span class="p">;</span>  <span class="p">},</span>  <span class="nx">collection</span> <span class="p">()</span> <span class="p">{</span>    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">_collected_books</span> <span class="o">||</span> <span class="p">(</span><span class="k">this</span><span class="p">. </span><span class="nx">_collected_books</span> <span class="o">=</span> <span class="p">[]);</span>  <span class="p">}</span><span class="p">};</span><span class="kr">class</span> <span class="nx">Person</span> <span class="p">{</span>  <span class="nx">constructor</span> <span class="p">(</span><span class="nx">first</span><span class="p">,</span> <span class="nx">last </span><span class="p">)</span> <span class="p">{</span>    <span class="k">this</span><span class="p">.</span><span class="nx">rename</span><span class="p">(</span><span class="nx">first </span><span class="p">,</span> <span class="nx">last</span><span class="p">);</span>  <span class="p">}</span>  <span class="nx">fullName</span> <span class="p">()</span> <span class="p"> {</span>    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">firstName</span> <span class="o">+</span> <span class="s2">" "</span> <span class="o">+</span> <span class="k">this</span><span class="p">.</span><span class="nx">lastName</span><span class="p">;</span>  <span class="p">}</span>  <span class="nx">rename</span> <span class="p">(</span><span class="nx">first</span><span class="p">,</span> <span class="nx">last</span><span class="p">)</span> <span class="p">{</span>    <span class="k">this </span><span class="p">.</span><span class="nx">firstName</span> <span class="o">=</span> <span class="nx">first</span><span class="p">;</span>    <span class="k">this</span><span class= "p">.</span><span class="nx">lastName</span> <span class="o">=</span> <span class="nx">last</span><span class="p">;</span>    <span class="k">return</span> <span class="k">this</span><span class="p">;</span>  <span class="p">}</span><span class="p">};</span><span class="nb">Object</span><span class="p">.</span><span class="nx">assign</span><span class="p">(</span><span class="nx">Person</span><span class="p">.</span><span class="nx">prototype</span><span class="p">,</span> <span class="nx">BookCollector</span><span class="p">); </span></code></pre></div><p>We can do this as much as we like:</p><div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kr">const</span> <span class="nx">BookCollector</span> <span class="o">=</span> <span class="p">{</span>  <span class="nx">addToCollection</span> <span class="p">(</span><span class="nx">name</span><span class= "p">)</span> <span class="p">{</span>    <span class="k">this</span><span class="p">.</span><span class="nx">collection</span><span class="p">().</span><span class="nx">push</span><span class="p">(</span><span class="nx">name</span><span class="p">);</span>    <span class="k">return</span> <span class="k">this</span><span class="p">;</span>  <span class="p">},</span> <span class="nx">collection</span> <span class="p">()</span> <span class="p">{</span>    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx"> _collected_books</span> <span class="o">||</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">_collected_books</span> <span class="o">= </span> <span class="p">[]);</span>  <span class="p">}</span><span class="p">};</span><span class="kr">const</span> <span class="nx">Author</span> <span class="o">=</span> <span class="p"> {</span>  <span class="nx">writeBook</span> <span class="p">(</span><span class="nx">name</span><span class="p">)</span> <span class="p">{</span>    <span class="k">this</span><span class= "p">.</span><span class="nx">books</span><span class="p">().</span><span class="nx">push</span><span class="p">(</span><span class="nx">name</span><span class="p">);</span>    <span class= "k">return</span> <span class="k">this</span><span class="p">;</span>  <span class="p">},</span>  <span class="nx">books</span> <span class="p">()</span> <span class="p">{</span>    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">_books_written</span> <span class="o">||</span> <span class="p">(</span><span class="k">this </span><span class="p">.</span><span class="nx">_books_written</span> <span class="o">=</span> <span class="p">[]);</span>  <span class="p">}</span><span class="p">};</span><span class= "kr">class</span> <span class="nx">Person</span> <span class="p">{</span>  <span class="nx">constructor</span> <span class="p">(</span><span class="nx">first</span><span class="p">,</span> <span class="nx">last</span><span class="p">)</span> <span class="p">{</span>    <span class="k">this</span><span class="p">.</span><span class="nx">rename</span><span class="p">( </span><span class="nx">first</span><span class="p">,</span> <span class="nx">last</span><span class="p">);</span>  <span class="p">}</span>  <span class="nx">fullName</span> <span class= "p">()</span> <span class="p">{</span>    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">firstName</span> <span class="o">+</span> <span class="s2">" "</span> <span class="o">+</span> <span class="k">this</span><span class="p">.</span><span class="nx">lastName</span><span class="p">;</span>  <span class="p">}</span>  <span class="nx">rename</span> <span class="p">(</span><span class="nx">first</span><span class="p">,</span> <span class="nx">last</span><span class="p">)</span> <span class="p">{</span> <span class="k">this</span><span class="p">.</span><span class="nx">firstName</span> <span class="o">=</span> <span class="nx">first</span><span class="p">;</span>    <span class="k">this </span><span class="p">.</span><span class="nx">lastName</span> <span class="o">=</span> <span class="nx">last</span><span class="p">;</span>    <span class="k">return</span> <span class= "k">this</span><span class="p">;</span>  <span class="p">}</span><span class="p">};</span><span class="nb">Object</span><span class="p">.</span><span class="nx">assign</span><span class= "p">(</span><span class="nx">Person</span><span class="p">.</span><span class="nx">prototype</span><span class="p">,</span> <span class="nx">BookCollector</span><span class="p">,</span> <span class="nx">Author</span><span class="p">);</span></code></pre></div><h3 id="why-we-might-want-to-use-mixins">why we might want to use mixins</h3><p>Composing classes out of base functionality (<code>Person</code>) and mixins (<code>BookCollector</code> and <code>Author</code>) provides several benefits.</p><p>First, sometimes functionality does not neatly decompose in a tree-like form. Book authors are sometimes corporations, not persons. And antiquarian book stores collect books just like bibliophiles.</p><p>A "mixin" like <code> BookCollector</code> or <code>Author</code> can be mixed into more than one class. Trying to compose functionality using "inheritance" doesn't always work cleanly.</p><p>Another benefit is not obvious from a toy example, but in production systems classes can grow to be very large. Even if a mixin is not used in more than one class, decomposing a large class into mixins helps fulfil the <a href="https://en.wikipedia.org/wiki/Single_responsibility_principle">Single Responsibility Principle</a>. Each mixin can handle exactly one responsibility. That makes things easier to understand, and much easier to test.</p><h3 id="why-this-matters">why this matters</h3><p>There are other ways to decompose responsibilities for classes (such as delegation and composition), but the point here is that if we wish to use mixins, it is very simple and easy to do, because JavaScript does not have a large and complicated OOP mechanism that imposes a rigid model on programs.</p><p>In Ruby, for example, mixins are easy because a special feature, <em>modules</em> was baked into Ruby from the start. In other OO languages, mixins are difficult, because the class system does not support them and they are not particularly friendly to metaprogramming.</p><p>JavaScript's choice to build OOP out of simple parts–objects, functions, and properties–makes the development of new ideas possible.</p><p>(discuss on <a href="https://news.ycombinator.com/item?id=9713076">hacker news</a>)</p><hr><div class="footnotes">  <ol>    <li id="fn:super">      <p>There are subtleties involving the <code>super</code> keyword to consider, but that is not the point of this article. <a href= "#fnref:super" class="reversefootnote">↩</a></p>    </li>  </ol></div>        </section>			</div>		<!--=========================			END : POST =============================-->		<!--=========================			START : POST		=============================-->		<div class="post-wrapper"><h1 class= "entry-title post-title">45 Useful JavaScript Tips, Tricks and Best Practices													</h1> <article>													<div id="title-after"><!-- Either there are no banners, they are disabled or none qualified for this location! --></div><div class="clear"><!-- --></div>													<div id="article">														<p><em>By <a href= "/authors/saad-mousliki">Saad Mousliki</a></em></p><p>As you know, JavaScript is the number one programming language in the world, the language of the web, of mobile hybrid apps (like <a href="http://phonegap.com/">PhoneGap</a> or <a href="http://www.appcelerator.com/">Appcelerator</a>), of the server side (like <a href="http://nodejs.org">NodeJS</a> or <a href=" http://wakanda.org">Wakanda</a>) and has many other implementations. It's also the starting point for many new developers to the world of programming, as it can be used to display a simple alert in the web browser but also to control a robot (using <a href="http://nodebots.io/">nodebot</a>, or <a href="http://semu.github.io/noduino/">nodruino</a>). The developers who master JavaScript and write organized and performant code have become the most sought after in the job market.</p><p>In this article, I'll share a set of JavaScript tips, tricks and best practices that should be known by all JavaScript developers regardless of their browser/engine or the SSJS (Server Side JavaScript) interpreter.</p><p>Note that the code snippets in this article have been tested in the latest Google Chrome version 30, which uses the V8 JavaScript Engine (V8 3.20.17.15).</p><p><strong>1 – Don't forget <code>var</code> keyword when assigning a variable's value for the first time.</strong></p><p>Assignment to an undeclared variable automatically results in a global variable being created. Avoid global variables. </p><p><strong>2 – use <code>===</code> instead of <code>==</code></strong></p><p>The <code>==</code> (or <code>!=</code>) operator performs an automatic type conversion if needed. The <code>===</code> (or <code>!==</code>) operator will not perform any conversion. It compares the value and the type, which could be considered faster than <code>==</code>.</p><pre><code> [10] === 10    // is false[10]  == 10    // is true'10' == 10     // is true'10' === 10    // is false []   == 0     // is true [] ===  0     // is false '' == false   // is true but true == "a" is false '' ===   false // is false </code></pre><p><strong>3 – <code>undefined</code>, <code>null</code>, 0, <code>false</code>, <code>NaN</code>, <code>''</code> (empty string) are all falsy.</strong><br><strong>4 – Use Semicolons for line termination</strong></p><p>The use of semi-colons for line termination is a good practice. You won't be warned if you forget it, because in most cases it will be inserted by the JavaScript parser. For more details about why you should use semi-colons, take a look to this artice:&nbsp;<a href=" http://davidwalsh.name/javascript-semicolons">http://davidwalsh.name/javascript-semicolons</a>.</p><p><strong>5 – Create an object constructor</strong></p><pre><code>function Person(firstName, lastName){    this.firstName =  firstName;    this.lastName = lastName;}var Saad = new Person("Saad", "Mousliki");</code></pre><p><strong>6 – Be careful when using <code> typeof</code>, <code>instanceof</code> and <code>constructor</code>.</strong></p><ul><li><em>typeof</em> : a JavaScript unary operator used to &nbsp;return a string that represents the primitive type of a variable, &nbsp;don't forget that <code>typeof null</code> will return "object", and for the majority of object types (Array, Date, and others) will return also "object".</li><li><em>constructor</em> : is a property of the internal prototype property, which could be overridden by code.</li><li><em>instanceof</em> : is another JavaScript operator that check in all the prototypes chain the constructor it returns true if it's found and false if not.</li></ul><pre><code>var arr = ["a", "b", "c"];typeof arr;   // return "object"arr instanceof Array // truearr.constructor();  //[]</code></pre><p><strong>7 – Create a Self-calling Function</strong></p><p>This is often called a Self-Invoked Anonymous Function or Immediately Invoked Function Expression (IIFE). It is a function that executes automatically when you create it, and has the following form:</p><pre><code>(function(){    // some private code that will be executed automatically})();(function(a,b){    var result = a+b;    return result;})(10,20)</code></pre><p><strong>8 – Get a random item from an array </strong></p><pre><code>var items = [12, 548 , 'a' , 2 , 5478 , 'foo' , 8852, , 'Doe' , 2145 , 119];var  randomItem = items[Math.floor(Math.random() * items.length)]; </code></pre><p><strong>9 – Get a random number in a specific range</strong></p><p>This code snippet can be useful when trying to generate fake data for testing purposes, such as a salary between min and max.</p><pre><code>var x = Math.floor(Math.random() * (max - min + 1)) + min;</code></pre><p><strong>10 – Generate an array of numbers with numbers from 0 to max </strong></p><pre><code>var numbersArray = [] , max = 100;for( var i=1; numbersArray.push(i++) &lt; max;);  // numbers = [1,2,3 ... 100] </code></pre><p><strong>11 – Generate a random set of alphanumeric characters</strong></p><pre><code>function generateRandomAlphaNum(len) {    var rdmString = "";    for( ; rdmString.length &lt; len; rdmString  += Math.random().toString(36).substr(2));    return  rdmString.substr(0, len);}</code></pre><p><strong>12 – Shuffle an array of numbers</strong></p><pre><code>var numbers = [5, 458 , 120 , -215 , 228 , 400 , 122205, -85411];numbers = numbers.sort(function(){ return Math.random() - 0.5});/* the array numbers will be equal for example to [120, 5, 228, -215, 400, 458, -85411, 122205]  */</code></pre><p>A better option could be to implement a random sort order by code (e.g. : Fisher-Yates shuffle), than using the native sort JavaScript function. For more details take a look to <a href="http://stackoverflow.com/questions/962802/is-it-correct-to-use-javascript-array-sort-method-for-shuffling/962890#962890">this discussion</a>.</p><p><strong> 13 – A string trim function</strong></p><p>The classic trim function of Java, C#, PHP and many other language that remove whitespace from a string doesn't exist in JavaScript, so we could add it to the <code>String</code> object.</p><pre><code>String.prototype.trim = function(){return this.replace(/^s+|s+$/g, "");};  </code></pre><p>A native implementation of the trim() function is available in the recent JavaScript engines.</p><p><strong>14 – Append an array to another array</strong></p><pre><code>var array1 = [12 , "foo" , {name "Joe"} , -2458];var array2 = ["Doe" , 555 , 100];Array.prototype.push.apply(array1, array2);/* array1 will be equal to  [12 , "foo" , {name "Joe"} , -2458 , "Doe" , 555 , 100] */</code></pre><p><strong>15 – Transform the <code>arguments</code> object into an array</strong></p><pre><code>var argArray = Array.prototype.slice.call(arguments);</code></pre><p><strong>16 – Verify that a given argument is a number</strong></p><pre><code>function isNumber(n){    return !isNaN(parseFloat(n)) &amp;&amp; isFinite(n);}</code></pre><p><strong>17 – Verify that a given argument is an array</strong></p><pre><code>function isArray(obj){    return Object.prototype.toString.call(obj) === '[object Array]' ;}</code></pre><p>Note that if the toString() method is overridden, you will not get the expected result using this trick.</p><p>Or use...</p><pre><code>Array.isArray(obj); // its a new Array method</code></pre><p>You could also use <code>instanceof</code> if you are not working with multiple frames. However, if you have many contexts, you will get a wrong result.</p><pre><code>var myFrame = document.createElement('iframe');document.body.appendChild(myFrame);var myArray = window.frames[window.frames.length-1].Array;var arr = new myArray(a,b,10); // [a,b,10]// instanceof will not work correctly, myArray loses his constructor// constructor is not shared between framesarr instanceof Array; // false</code></pre><p><strong>18 – Get the max or the min in an array of numbers</strong></p><pre><code>var  numbers = [5, 458 , 120 , -215 , 228 , 400 , 122205, -85411];var maxInNumbers = Math.max.apply(Math, numbers);var minInNumbers = Math.min.apply(Math, numbers);</code></pre><p><strong>19 – Empty an array</strong></p><pre><code>var myArray = [12 , 222 , 1000 ];myArray.length = 0; // myArray will be equal to []. </code></pre><p><strong>20 – Don't use delete to remove an item from array</strong></p><p>Use <code>splice</code>&nbsp;instead of using <code>delete</code> to delete an item from an array. Using <code>delete</code> replaces the item with <code>undefined</code> instead of the removing it from the array.</p><p>Instead of...</p><pre><code>var items = [12, 548 ,'a' , 2 , 5478 , 'foo' , 8852, , 'Doe' ,2154 , 119 ];items.length; // return 11delete items[3]; // return trueitems.length; // return 11/* items will be equal to [12, 548, "a", undefined × 1, 5478, "foo", 8852, undefined × 1, "Doe", 2154,       119]   */</code></pre><p>Use...</p><pre><code>var items = [12, 548 ,'a' , 2 , 5478 , 'foo' , 8852, , 'Doe' ,2154 , 119 ];items.length; // return 11items.splice(3,1) ;items.length; // return 10/* items will be equal to [12, 548, "a", 5478, "foo", 8852, undefined × 1, "Doe", 2154,       119]   */</code></pre><p>The delete method should be used to delete an object property.</p><p><strong>21 – Truncate an array using length</strong></p><p>Like the previous example of emptying an array, we truncate it using the <code>length</code> property.</p><pre><code>var myArray = [12 , 222 , 1000 , 124 , 98 , 10 ];myArray.length = 4; // myArray will be equal to [12 , 222 , 1000 , 124].</code></pre><p>As a bonus, if you set the array length to a higher value, the length will be changed and new items will be added with <code>undefined</code> as a value. The array length is not a read only property.</p><pre><code>myArray.length = 10; // the new array length is 10myArray[myArray.length - 1] ; // undefined</code></pre><p><strong>22 – Use logical AND/ OR for conditions </strong></p><pre><code>var foo = 10;foo == 10 &amp;&amp; doSomething(); // is the same thing as if (foo == 10) doSomething();foo == 5 || doSomething(); // is the same thing as if (foo != 5) doSomething();</code></pre><p>The logical OR could also be used to set a default value for function argument.</p><pre><code>function doSomething(arg1){    arg1 = arg1 || 10; // arg1 will have 10 as a default value if it's not already set}</code></pre><p><strong>23 – Use the map() function method to loop through an array's items</strong></p><pre><code>var squares = [1,2,3,4].map(function (val) {    return val * val;});// squares will be equal to [1, 4, 9, 16] </code></pre><p><strong>24 – Rounding number to N decimal place</strong></p><pre><code>var num =2.443242342;num = num.toFixed(4);  // num will be equal to 2.4432</code></pre><p>NOTE : the <code>toFixed()</code> function returns a string and not a number.</p><p><strong>25 – Floating point problems</strong></p><pre><code>0.1 + 0.2 === 0.3 // is false9007199254740992 + 1 // is equal to 90071992547409929007199254740992 + 2 // is equal to 9007199254740994 </code></pre><p>Why does this happen? 0.1 +0.2 is equal to 0.30000000000000004. What you need to know is that all JavaScript numbers are floating points represented internally in 64 bit binary according to the IEEE 754 standard. For more explanation, take a look to <a href="http://www.2ality.com/2012/04/number-encoding.html">this blog post</a>.</p><p>You can use <code> toFixed()</code> and <code>toPrecision()</code> to resolve this problem.</p><p><strong>26 – Check the properties of an object when using a for-in loop</strong></p><p>This code snippet could be useful in order to avoid iterating through the properties from the object's prototype.</p><pre><code>for (var name in object) {    if (object.hasOwnProperty(name)) {        // do something with name    }}</code></pre><p><strong>27 – Comma operator</strong></p><pre><code>var a = 0;var b = ( a++, 99 );console.log(a);  // a will be equal to 1console.log(b);  // b is equal to 99</code></pre><p><strong>28 – Cache variables that need calculation or querying</strong></p><p>In the case of a jQuery selector, we could cache the DOM element.</p><pre><code> var navright = document.querySelector('#right');var navleft = document.querySelector('#left');var navup = document.querySelector('#up');var navdown = document.querySelector('#down'); </code></pre><p><strong>29 – Verify the argument before passing it to <code>isFinite()</code></strong></p><pre><code>isFinite(0/0) ; // falseisFinite("foo"); // falseisFinite("10"); // trueisFinite(10);   // trueisFinite(undefined);  // falseisFinite();   // falseisFinite(null);  // true  !!! </code></pre><p><strong>30 – Avoid negative indexes in arrays </strong></p><pre><code>var numbersArray = [1,2,3,4,5];var from = numbersArray.indexOf("foo") ;  // from is equal to -1numbersArray.splice(from,2);    // will return [5]</code></pre><p> Make sure that the arguments passed to <code>splice</code> are not negative.</p><p><strong>31 – Serialization and deserialization (working with JSON)</strong></p><pre><code>var person = {name :'Saad', age : 26, department : {ID : 15, name : "R&amp;D"} };var stringFromPerson = JSON.stringify(person);/* stringFromPerson is equal to "{"name":"Saad","age":26,"department":{"ID":15,"name":"R&amp;D"}}"   */var personFromString = JSON.parse(stringFromPerson);/* personFromString is equal to person object  */ </code></pre><p><strong>32 – Avoid the use of <code>eval()</code> or the <code>Function</code> constructor</strong></p><p>Use of <code>eval</code> or the <code>Function</code> constructor are expensive operations as each time they are called script engine must convert source code to executable code.</p><pre><code>var func1 = new Function(functionCode);var func2 = eval(functionCode);</code></pre><p><strong>33 – Avoid using <code>with()</code> (The good part)</strong></p><p>Using <code>with()</code> inserts a variable at the global scope. Thus, if another variable has the same name it could cause confusion and overwrite the value.</p><p><strong>34 – Avoid using for-in loop for arrays</strong></p><p>Instead of using...</p><pre><code> var sum = 0;for (var i in arrayNumbers) {    sum += arrayNumbers[i];}</code></pre><p>...it's better to use...</p><pre><code>var sum = 0;for (var i = 0, len = arrayNumbers.length; i &lt; len; i++) {    sum += arrayNumbers[i];}</code></pre><p>As a bonus, the instantiation of <code>i</code> and <code>len</code> is executed once because it's in the first statement of the for loop. Thsi is faster than using...</p><pre><code>for (var i = 0; i &lt; arrayNumbers.length; i++)</code></pre><p>Why? The length of the array <code>arrayNumbers</code> is recalculated every time the loop iterates.</p><p>NOTE : the issue of recalculating the length in each iteration was fixed in the latest JavaScript engines.</p><p><strong>35 – Pass functions, not strings, to <code>setTimeout()</code> and <code>setInterval()</code></strong></p><p>If you pass a string into <code>setTimeout()</code> or <code>setInterval()</code>, the string will be evaluated the same way as with <code>eval</code>, which is slow. Instead of using...</p><pre><code>setInterval('doSomethingPeriodically()', 1000);setTimeout('doSomethingAfterFiveSeconds()', 5000);</code></pre><p>...use...</p><pre><code>setInterval(doSomethingPeriodically, 1000);setTimeout(doSomethingAfterFiveSeconds, 5000); </code></pre><p><strong>36 – Use a switch/case statement instead of a series of if/else</strong></p><p>Using switch/case is faster when there are more than 2 cases, and it is more elegant (better organized code). Avoid using it when you have more than 10 cases.</p><p><strong>37 – Use switch/case statement with numeric ranges</strong></p><p>Using a switch/case statement with numeric ranges is possible with this trick.</p><pre><code>function getCategory(age) {    var category = "";    switch (true) {        case isNaN(age):            category = "not an age";            break;        case (age &gt;= 50):            category = "Old";            break;        case (age &lt;= 20):            category = "Baby";            break; default:            category = "Young";            break;    };    return category;}getCategory(5);  // will return "Baby"</code></pre><p><strong>38 – Create an object whose prototype is a given object</strong></p><p>It's possible to write a function that creates an object whose prototype is the given argument like this...</p><pre><code>function clone(object) { function OneShotConstructor(){};    OneShotConstructor.prototype= object;    return new OneShotConstructor();}clone(Array).prototype ;  // []</code></pre><p><strong>39 – An HTML escaper function</strong></p><pre><code>function escapeHTML(text) {    var replacements= {"&lt;": "&amp;lt;", "&gt;": "&amp;gt;","&amp;": "&amp;amp;", """: "&amp;quot;"};    return text.replace(/[ &lt;&gt;&amp;"]/g, function(character) {        return replacements[character];    });}</code></pre><p><strong>40 – Avoid using try-catch-finally inside a loop</strong></p><p>The try-catch-finally construct creates a new variable in the current scope at runtime each time the catch clause is executed where the caught exception object is assigned to a variable. </p><p>Instead of using...</p><pre><code>var object = ['foo', 'bar'], i;for (i = 0, len = object.length; i &lt;len; i++) {    try {        // do something that throws an exception    } catch (e) {        // handle exception    }}</code></pre><p>...use...</p><pre><code>var object = ['foo', 'bar'], i;try {    for (i = 0, len = object.length; i &lt;len; i++) {        // do something that throws an exception    }}catch (e) {    // handle exception} </code></pre><p><strong>41 – Set timeouts to <code>XMLHttpRequests</code></strong></p><p>You could abort the connection if an XHR takes a long time (for example, due to a network issue), by using <code>setTimeout()</code> with the XHR call.</p><pre><code>var xhr = new XMLHttpRequest ();xhr.onreadystatechange = function () {    if (this.readyState == 4) {        clearTimeout(timeout);        // do something with response data    }}var timeout = setTimeout( function () {    xhr.abort(); // call error callback}, 60*1000 /* timeout after a minute */ );xhr.open('GET', url, true);xhr.send();</code></pre><p>As a bonus, you should generally avoid synchronous XHR calls completely.</p><p><strong>42 – Deal with WebSocket timeout</strong></p><p>Generally when a WebSocket connection is established, a server could time out your connection after 30 seconds of inactivity. The firewall could also time out the connection after a period of inactivity.</p><p>To deal with the timeout issue you could send an empty message to the server periodically. To do this, add these two functions to your code: one to keep alive the connection and the other one to cancel the keep alive. Using this trick, you'll control the timeout. </p><p>Add a <code>timerID</code>...</p><pre><code>var timerID = 0;function keepAlive() {    var timeout = 15000;    if (webSocket.readyState == webSocket.OPEN) { webSocket.send('');    }    timerId = setTimeout(keepAlive, timeout);}function cancelKeepAlive() {    if (timerId) {        cancelTimeout(timerId);    }}</code></pre><p>The <code> keepAlive()</code> function should be added at the end of the <code>onOpen()</code> method of the webSocket connection and the <code>cancelKeepAlive()</code> at the end of the <code> onClose()</code> method.</p><p><strong>43 – Keep in mind that <a href="http://dev.opera.com/articles/view/efficient-javascript/?page=2#primitiveoperator">primitive operations can be faster than function calls</a>. Use <a href="http://vanilla-js.com/">VanillaJS</a>.</strong></p><p>For example, instead of using...</p><pre><code>var min = Math.min(a,b);A.push(v); </code></pre><p>...use...</p><pre><code>var min = a &lt; b ? a : b;A[A.length] = v;</code></pre><p><strong>44 – Don't forget to use a code beautifier when coding. Use JSLint and minification (JSMin, for example) before going live.</strong></p><p><strong>45 – JavaScript is awesome: <a href="http://stackoverflow.com/questions/11246/best-resources-to-learn-javascript ">Best Resources To Learn JavaScript</a></strong></p><ul><li>Code Academy JavaScript tracks:&nbsp;<a href="http://www.codecademy.com/tracks/javascript"> http://www.codecademy.com/tracks/javascript</a></li><li>Eloquent JavaScript by Marjin Haverbeke:&nbsp;<a href="http://eloquentjavascript.net/">http://eloquentjavascript.net/</a></li><li> Advanced JavaScript by John Resig:&nbsp;<a href="http://ejohn.org/apps/learn/">http://ejohn.org/apps/learn/</a></li></ul><h2>Conclusion</h2><p>I know that there are many other tips, tricks and best practices, so if you have any ones to add or if you have any feedback or corrections to the ones that I have shared, please adda comment.</p><h2>References</h2><p>In this article I have used my own code snippets. Some of the snippets are inspired from other articles and forums:</p><ul><li><a href=" http://developer.nokia.com/Community/Wiki/JavaScript_Performance_Best_Practices">JavaScript Performance Best Practices</a> (<a href="http://creativecommons.org/licenses/by-nc-sa/2.5/">CC </a>)</li><li><a href="https://code.google.com/p/jslibs/wiki/JavascriptTips">Google Code JavaScript tips</a></li><li><a href=" http://stackoverflow.com/questions/724826/javascript-tips-and-tricks-javascript-best-practices">StackOverFlow tips and tricks</a></li><li><a href=" http://stackoverflow.com/questions/6888409/settimeout-for-xhr-requests">TimeOut for XHR</a></li></ul><div class="none"><time class="date updated" datetime="2013-12-23" data-pubdate="">Dec 23, 2013</time><span class="author vcard"><span class="fn">saad.mousliki</span></span></div>														<div class="clear"><!-- --></div> </div><!-- #article -->												</article>			</div> <!--=========================			END : POST		=============================-->		<!--=========================			START : POST =============================-->		<div class="post-wrapper">		<h1 class="posttitle_purus">Understanding JavaScript Function Invocation and "this"</h1>		<div class= "wrapper_purus">                <div class="postcontent_purus">                    <p>Over the years, I've seen a lot of confusion about JavaScript function invocation. In particular, a lot of people have complained that the semantics of <code>this</code> in function invocations is confusing.</p><p>In my opinion, a lot of this confusion is cleared up by understanding the core function invocation primitive, and then looking at all other ways of invoking a function as sugar on top of that primitive. In fact, this is exactly how the ECMAScript spec thinks about it. In some areas, this post is a simplification of the spec, but the basic idea is the same.</p><h2>The Core Primitive</h2><p>First, let's look at the core function invocation primitive, a Function's <code>call</code> method[1]. The call method is relatively straight forward.</p><ol>  <li>Make an argument list (<code>argList</code>) out of parameters 1 through the end</li>  <li>The first parameter is <code>thisValue</code></li>  <li>Invoke the function with <code>this</code> set to <code>thisValue</code> and the <code>argList</code> as its argument list</li></ol><p>For example:</p><pre><code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">hello</span>( <span class="hljs-params">thing</span>) </span>{  <span class="hljs-built_in">console</span>.log(<span class="hljs-keyword">this</span> + <span class="hljs-string">" says hello "</span> + thing);}hello.call(<span class="hljs-string">"Yehuda"</span>, <span class="hljs-string">"world"</span>) <span class="hljs-comment">//=&gt; Yehuda says hello world  </span></code></pre><p> As you can see, we invoked the <code>hello</code> method with <code>this</code> set to <code>"Yehuda"</code> and a single argument <code>"world"</code>. This is the core primitive of JavaScript function invocation. You can think of all other function calls as desugaring to this primitive. (to "desugar" is to take a convenient syntax and describe it in terms of a more basic core primitive).</p><p><small><em>[1] In <a href="http://es5.github.com/#x15.3.4.4">the ES5 spec</a>, the <code>call</code> method is described in terms of another, more low level primitive, but it's a very thin wrapper on top of that primitive, so I'm simplifying a bit here. See the end of this post for more information.</em></small></p><h2>Simple Function Invocation</h2><p>Obviously, invoking functions with <code>call</code> all the time would be pretty annoying. JavaScript allows us to invoke functions directly using the parens syntax ( <code>hello("world")</code>. When we do that, the invocation desugars:</p><pre><code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">hello</span>(<span class="hljs-params">thing</span>) </span>{  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Hello "</span> + thing);}<span class="hljs-comment">// this:</span>hello(<span class="hljs-string">"world"</span>)<span class="hljs-comment">// desugars to:</span>hello.call(<span class="hljs-built_in">window</span>, <span class="hljs-string">"world"</span>);</code></pre><p>This behavior has changed in ECMAScript 5 <strong>only when using strict mode</strong>[2]:</p><pre><code class="javascript hljs" ><span class="hljs-comment">// this:</span>hello(<span class="hljs-string">"world"</span>)<span class="hljs-comment">// desugars to:</span>hello.call(<span class="hljs-literal">undefined </span>, <span class="hljs-string">"world"</span>);</code></pre><p>The short version is: <strong>a function invocation like <code>fn(...args)</code> is the same as <code>fn.call(window [ES5-strict: undefined], ...args)</code></strong>.</p><p>Note that this is also true about functions declared inline: <code>(function() {})()</code> is the same as <code>(function() {}).call(window [ES5-strict: undefined)</code>.</p><p><small><em>[2] Actually, I lied a bit. The ECMAScript 5 spec says that <code>undefined</code> is (almost) always passed, but that the function being called should change its <code>thisValue</code> to the global object when not in strict mode. This allows strict mode callers to avoid breaking existing non-strict-mode libraries.</em></small></p><h2>Member Functions</h2><p>The next very common way to invoke a method is as a member of an object (<code>person.hello()</code>). In this case, the invocation desugars:</p><pre><code class="javascript hljs"><span class="hljs-keyword">var</span> person = {  name: <span class="hljs-string">"Brendan Eich"</span>,  hello: <span class="hljs-function" ><span class="hljs-keyword">function</span>(<span class="hljs-params">thing</span>) </span>{    <span class="hljs-built_in">console</span>.log(<span class="hljs-keyword">this</span> + <span class="hljs-string">" says hello "</span> + thing);  }}<span class="hljs-comment">// this:</span>person.hello(<span class="hljs-string">"world"</span>)<span class="hljs-comment">// desugars to this:</span>person.hello.call(person, <span class="hljs-string">"world"</span>);</code></pre><p>Note that it doesn't matter how the <code>hello</code> method becomes attached to the object in this form. Remember that we previously defined <code>hello</code> as a standalone function. Let's see what happens if we attach is to the object dynamically:</p><pre><code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">hello</span>(<span class="hljs-params">thing</span>) </span>{ <span class="hljs-built_in">console</span>.log(<span class="hljs-keyword">this</span> + <span class="hljs-string">" says hello "</span> + thing);}person = { name: <span class="hljs-string" >"Brendan Eich"</span> }person.hello = hello;person.hello(<span class="hljs-string">"world"</span>) <span class="hljs-comment">// still desugars to person.hello.call(person, "world") </span>hello(<span class="hljs-string">"world"</span>) <span class="hljs-comment">// "[object DOMWindow]world"  </span></code></pre><p>Notice that the function doesn't have a persistent notion of its 'this'. It is always set at call time based upon the way it was invoked by its caller.</p><h2>Using <code>Function.prototype.bind</code></h2><p>Because it can sometimes be convenient to have a reference to a function with a persistent <code>this</code> value, people have historically used a simple closure trick to convert a function into one with an unchanging <code>this</code>:</p><pre><code class="javascript hljs"><span class="hljs-keyword">var</span> person = {  name: <span class="hljs-string">"Brendan Eich"</span>,  hello: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">thing</span>) </span>{    <span class="hljs-built_in">console</span>.log(<span class= "hljs-keyword">this</span>.name + <span class="hljs-string">" says hello "</span> + thing);  }}<span class="hljs-keyword">var</span> boundHello = <span class="hljs-function"><span class= "hljs-keyword">function</span>(<span class="hljs-params">thing</span>) </span>{ <span class="hljs-keyword">return</span> person.hello.call(person, thing); }boundHello(<span class= "hljs-string">"world"</span>);</code></pre><p>Even though our <code>boundHello</code> call still desugars to <code>boundHello.call(window, "world")</code>, we turn right around and use our primitive <code>call</code> method to change the <code>this</code> value back to what we want it to be.</p><p>We can make this trick general-purpose with a few tweaks:</p><pre><code class="javascript hljs"><span class="hljs-keyword">var</span> bind = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">func, thisValue</span> ) </span>{  <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{    <span class= "hljs-keyword">return</span> func.apply(thisValue, <span class="hljs-built_in">arguments</span>);  }}<span class="hljs-keyword">var</span> boundHello = bind(person.hello, person);boundHello(<span class="hljs-string">"world"</span>) <span class="hljs-comment">// "Brendan Eich says hello world"  </span></code></pre><p>In order to understand this, you just need two more pieces of information. First, <code>arguments</code> is an Array-like object that represents all of the arguments passed into a function. Second, the <code>apply</code> method works exactly like the <code>call</code> primitive, except that it takes an Array-like object instead of listing the arguments out one at a time.</p><p>Our <code>bind</code> method simply returns a new function. When it is invoked, our new function simply invokes the original function that was passed in, setting the original value as <code>this</code>. It also passes through the arguments.</p><p>Because this was a somewhat common idiom, ES5 introduced a new method <code>bind</code> on all <code>Function</code> objects that implements this behavior:</p><pre><code class="javascript hljs"><span class="hljs-keyword">var</span> boundHello = person.hello.bind(person);boundHello(<span class="hljs-string">"world"</span>) <span class="hljs-comment">// "Brendan Eich says hello world"  </span></code></pre><p>This is most useful when you need a raw function to pass as a callback:</p><pre><code class="javascript hljs"><span class="hljs-keyword">var</span> person = {  name: <span class="hljs-string">"Alex Russell"</span>,  hello: <span class="hljs-function"><span class="hljs-keyword">function </span>(<span class="hljs-params"></span>) </span>{ <span class="hljs-built_in">console</span>.log(<span class="hljs-keyword">this</span>.name + <span class="hljs-string">" says hello world"</span>); }}$(<span class="hljs-string">"#some-div"</span>).click(person.hello.bind(person));<span class="hljs-comment">// when the div is clicked, "Alex Russell says hello world" is printed</span></code></pre><p>This is, of course, somewhat clunky, and TC39 (the committee that works on the next version(s) of ECMAScript) continues to work on a more elegant, still-backwards-compatible solution.</p><h2>On jQuery</h2><p>Because jQuery makes such heavy use of anonymous callback functions, it uses the <code>call</code> method internally to set the <code>this</code> value of those callbacks to a more useful value. For instance, instead of receiving <code>window</code> as <code>this</code> in all event handlers (as you would without special intervention), jQuery invokes <code>call</code> on the callback with the element that set up the event handler as its first parameter.</p><p>This is extremely useful, because the default value of <code>this</code> in anonymous callbacks is not particularly useful, but it can give beginners to JavaScript the impression that <code>this</code> is, <strong> in general</strong> a strange, often mutated concept that is hard to reason about.</p><p>If you understand the basic rules for converting a sugary function call into a desugared <code> func.call(thisValue, ...args)</code>, you should be able to navigate the not so treacherous waters of the JavaScript <code>this</code> value.</p><p><img style="display:block; margin-left:auto; margin-right:auto;" src="http://yehudakatz.com/wp-content/uploads/2011/08/this-table2.png" alt="this-table.png" title="this-table.png" border="0" width="526" height="195" ></p><h2>PS: I Cheated</h2><p>In several places, I simplified the reality a bit from the exact wording of the specification. Probably the most important cheat is the way I called <code> func.call</code> a "primitive". In reality, the spec has a primitive (internally referred to as <code>[[Call]]</code>) that both <code>func.call</code> and <code>[obj.]func()</code> use. </p><p>However, take a look at the definition of <code>func.call</code>:</p><ol>  <li>If IsCallable(func) is false, then throw a TypeError exception.</li>  <li>Let argList be an empty List.</li>  <li>If this method was called with more than one argument then in left to right order starting with arg1 append each argument as the last element of argList</li>  <li>Return the result of calling the [[Call]] internal method of func, providing thisArg as the this value and argList as the list of arguments.</li></ol><p>As you can see, this definition is essentially a very simple JavaScript language binding to the primitive <code>[[Call]]</code> operation.</p><p>If you look at the definition of invoking a function, the first seven steps set up <code>thisValue</code> and <code>argList</code>, and the last step is: "Return the result of calling the [[Call]] internal method on func, providing thisValue as the this value and providing the list argList as the argument values."</p><p>It's essentially identical wording, once the <code>argList</code> and <code>thisValue</code> have been determined.</p><p>I cheated a bit in calling <code>call</code> a primitive, but the meaning is essentially the same as had I pulled out the spec at the beginning of this article and quoted chapter and verse. </p><p>There are also some additional cases (most notably involving <code>with</code>) that I didn't cover here.</p>                </div>             </div>			</div> <!--=========================			END : POST		=============================-->		<!--=========================			START : POST =============================-->		<div class="post-wrapper">		<h1 class="posttitle_purus">Understanding "Prototypes" in JavaScript</h1>		<div class="postcontent_purus"> <p>For the purposes of this post, I will be talking about JavaScript objects using syntax defined in ECMAScript 5.1. The basic semantics existed in Edition 3, but they were not well exposed.</p><h2>A Whole New Object</h2><p>In JavaScript, objects are pairs of keys and values (in Ruby, this structure is called a Hash; in Python, it's called a dictionary). For example, if I wanted to describe my name, I could have an object with two keys: <code>firstName</code> would point to "Yehuda" and <code>lastName</code> would point to "Katz". Keys in a JavaScript object are Strings.</p><p>To create the simplest new object in JavaScript, you can use <code>Object.create</code>:</p><pre><code class="javascript hljs"><span class="hljs-keyword">var</span> person = <span class="hljs-built_in">Object</span>.create(<span class="hljs-literal">null</span>); <span class="hljs-comment">// this creates an empty objects  </span></code></pre><p>Why didn't we just use <code>var person = {};</code>? Stick with me! To look up a value in the object by key, use bracket notation. If there is no value for the key in question, JavaScript will return <code>undefined</code>.</p><pre><code class="javascript hljs">person[<span class="hljs-string">'name'</span>] <span class="hljs-comment">// undefined  </span></code></pre><p>If the String is a valid identifier[1], you can use the dot form:</p><pre><code class="javascript hljs">person.name <span class="hljs-comment">// undefined  </span></code></pre><p><small><em>[1] in general, an <a href="http://es5.github.com/#x7.6">identifier</a> starts with a unicode letter, $, _, followed by any of the starting characters or numbers. A valid identifier must also not be a <a href="http://es5.github.com/#x7.6.1">reserved word</a>. There are other allowed characters, such as unicode combining marks, unicode connecting punctuation, and unicode escape sequences. Check out the spec for the full details</em></small></p><h2>Adding values</h2><p>So now you have an empty object. Not that useful, eh? Before we can add some properties, we need to understand what a property (what the spec calls a "named data property") looks like in JavaScript.</p><p>Obviously, a property has a name and a value. In addition, a property can be <strong>enumerable</strong>, <strong>configurable</strong> and <strong>writable</strong>. If a value is enumerable, it will show up when enumerating over an object using a <code>for(prop in obj)</code> loop. If a property is writable, you can replace it. If a property is configurable, you can delete it or change its other attributes.</p><p>In general, when we create a new property, we will want it to be enumerable, configurable, and writable. In fact, prior to ECMAScript 5, that was the only kind of property a user could create directly.</p><p>We can add a property to an object using <code>Object.defineProperty</code>. Let's add a first name and last name to our empty object:</p><pre><code class="javascript hljs"><span class="hljs-keyword">var</span> person = <span class="hljs-built_in">Object</span>.create(<span class="hljs-literal">null</span>);<span class="hljs-built_in">Object</span>.defineProperty(person, <span class="hljs-string">'firstName'</span>, {  value: <span class="hljs-string">"Yehuda"</span>,  writable: <span class= "hljs-literal">true</span>,  enumerable: <span class="hljs-literal">true</span>,  configurable: <span class="hljs-literal">true</span>});<span class="hljs-built_in">Object</span> .defineProperty(person, <span class="hljs-string">'lastName'</span>, {  value: <span class="hljs-string">"Katz"</span>,  writable: <span class="hljs-literal">true</span>,  enumerable: <span class="hljs-literal">true</span>,  configurable: <span class="hljs-literal">true</span>});</code></pre><p>Obviously, this is extremely verbose. We can make it a bit less verbose by eliminating the common defaults:</p><pre><code class="javascript hljs"><span class="hljs-keyword">var</span> config = {  writable: <span class="hljs-literal">true</span>,  enumerable: <span class="hljs-literal">true</span>,  configurable: <span class="hljs-literal">true</span>};<span class="hljs-keyword">var</span> defineProperty = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">obj, name, value</span>) </span>{  config.value = value;  <span class="hljs-built_in">Object</span>.defineProperty(obj, name, config);}<span class="hljs-keyword">var</span> person = <span class="hljs-built_in">Object</span>.create(<span class="hljs-literal">null</span>);defineProperty(person, <span class= "hljs-string">'firstName'</span>, <span class="hljs-string">"Yehuda"</span>);defineProperty(person, <span class="hljs-string">'lastName'</span>,   <span class="hljs-string">"Katz"</span>); </code></pre><p>Still, this is pretty ugly to create a simple property list. Before we can get to a prettier solution, we will need to add another weapon to our JavaScript object arsenal. </p><h2>Prototypes</h2><p>So far, we've talked about objects as simple pairs of keys and values. In fact, JavaScript objects also have one additional attribute: a pointer to <em>another </em> object. We call this pointer the object's <em>prototype</em>. If you try to look up a key on an object and it is not found, JavaScript will look for it in the prototype. It will follow the "prototype chain" until it sees a <code>null</code> value. In that case, it returns <code>undefined</code>.</p><p>You'll recall that we created a new object by invoking <code> Object.create(null)</code>. The parameter tells JavaScript what it should set as the Object's <em>prototype</em>. You can look up an object's prototype by using <code>Object.getPrototypeOf </code>:</p><pre><code class="javascript hljs"><span class="hljs-keyword">var</span> man = <span class="hljs-built_in">Object</span>.create(<span class="hljs-literal">null</span> );defineProperty(man, <span class="hljs-string">'sex'</span>, <span class="hljs-string">"male"</span>);<span class="hljs-keyword">var</span> yehuda = <span class="hljs-built_in">Object </span>.create(man);defineProperty(yehuda, <span class="hljs-string">'firstName'</span>, <span class="hljs-string">"Yehuda"</span>);defineProperty(yehuda, <span class="hljs-string"> 'lastName'</span>, <span class="hljs-string">"Katz"</span>);yehuda.sex       <span class="hljs-comment">// "male"  </span>yehuda.firstName <span class="hljs-comment">// "Yehuda"  </span> yehuda.lastName  <span class="hljs-comment">// "Katz"</span><span class="hljs-built_in">Object</span>.getPrototypeOf(yehuda) <span class="hljs-comment">// returns the man object </span></code></pre><p>We can also add functions that we share across many objects this way:</p><pre><code class="javascript hljs"><span class="hljs-keyword">var</span> person = <span class="hljs-built_in">Object</span>.create(<span class="hljs-literal">null</span>);defineProperty(person, <span class="hljs-string">'fullName'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{  <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.firstName + <span class= "hljs-string">' '</span> + <span class="hljs-keyword">this</span>.lastName;});<span class="hljs-comment">// this time, let's make man's prototype person, so all</span><span class= "hljs-comment">// men share the fullName function</span><span class="hljs-keyword">var</span> man = <span class="hljs-built_in">Object</span>.create(person);defineProperty(man, <span class ="hljs-string">'sex'</span>, <span class="hljs-string">"male"</span>);<span class="hljs-keyword">var</span> yehuda = <span class="hljs-built_in">Object</span> .create(man);defineProperty(yehuda, <span class="hljs-string">'firstName'</span>, <span class="hljs-string">"Yehuda"</span>);defineProperty(yehuda, <span class="hljs-string">'lastName' </span>, <span class="hljs-string">"Katz"</span>);yehuda.sex        <span class="hljs-comment">// "male"  </span>yehuda.fullName() <span class="hljs-comment">// "Yehuda Katz" </span></code></pre><h2>Setting Properties</h2><p>Since creating a new writable, configurable, enumerable property is pretty common, JavaScript makes it easy to do so using assignment syntax. Let's update the previous example using assignment instead of <code>defineProperty</code>:</p><pre><code class="javascript hljs"><span class="hljs-keyword">var</span> person = <span class="hljs-built_in">Object</span>.create(<span class="hljs-literal">null</span>);<span class="hljs-comment">// instead of using defineProperty and specifying writable,</span><span class="hljs-comment">// configurable, and enumerable, we can just assign the</span><span class="hljs-comment">// value directly and JavaScript will take care of the rest</span>person[<span class="hljs-string">'fullName'</span>] = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{  <span class="hljs-keyword"> return</span> <span class="hljs-keyword">this</span>.firstName + <span class="hljs-string">' '</span> + <span class="hljs-keyword">this</span>.lastName;};<span class="hljs-comment">// this time, let's make man's prototype person, so all</span><span class="hljs-comment">// men share the fullName function</span><span class="hljs-keyword">var</span> man = <span class= "hljs-built_in">Object</span>.create(person);man[<span class="hljs-string">'sex'</span>] = <span class="hljs-string">"male"</span>;<span class="hljs-keyword">var</span> yehuda = <span class="hljs-built_in">Object</span>.create(man);yehuda[<span class="hljs-string">'firstName'</span>] = <span class="hljs-string">"Yehuda"</span>;yehuda[<span class="hljs-string">'lastName' </span>] = <span class="hljs-string">"Katz"</span>;yehuda.sex        <span class="hljs-comment">// "male"  </span>yehuda.fullName() <span class="hljs-comment">// "Yehuda Katz" </span></code></pre><p>Just like when looking up properties, if the property you are defining is an <em>identifier</em>, you can use dot syntax instead of bracket syntax. For instance, you could say <code>man.sex = "male"</code> in the example above.</p><h2>Object Literals</h2><p>Still, having to set a number of properties every time can get annoying. JavaScript provides a literal syntax for creating an object and assigning properties to it at one time.</p><pre><code class="javascript hljs"><span class="hljs-keyword">var</span> person = { firstName: <span class="hljs-string">"Paul"</span>, lastName: <span class="hljs-string">"Irish"</span> }</code></pre><p>This syntax is approximately sugar for:</p><pre><code class= "javascript hljs"><span class="hljs-keyword">var</span> person = <span class="hljs-built_in">Object</span>.create(<span class="hljs-built_in">Object</span>.prototype);person.firstName = <span class="hljs-string">"Paul"</span>;person.lastName  = <span class="hljs-string">"Irish"</span>;</code></pre><p>The most important thing about the expanded form is that object literals <em>always</em> set the newly created object's prototype to an object located at <code>Object.prototype</code>. Internally, the object literal looks like this:</p><p><img style= "display:block; margin-left:auto; margin-right:auto;" src="http://yehudakatz.com/wp-content/uploads/2011/08/prototype-chain.png" alt="prototype-chain.png" title="prototype-chain.png" border="0" width="464" height="440"></p><p>The default <code>Object.prototype</code> dictionary comes with a number of the methods we have come to expect objects to contain, and through the magic of the prototype chain, all new objects created as object literal will contain these properties. Of course, objects can happily override them by defining the properties directly. Most commonly, developers will override the <code>toString</code> method:</p><pre><code class="javascript hljs"><span class="hljs-keyword">var</span> alex = { firstName: <span class="hljs-string">"Alex"</span>, lastName: <span class="hljs-string">"Russell"</span> };alex.toString() <span class="hljs-comment">// "[object Object]"</span><span class="hljs-keyword"> var</span> brendan = {  firstName: <span class="hljs-string">"Brendan"</span>,  lastName: <span class="hljs-string">"Eich"</span>,  toString: <span class="hljs-function"><span class= "hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{ <span class="hljs-keyword">return</span> <span class="hljs-string">"Brendan Eich"</span>; }};brendan.toString() <span class="hljs-comment">// "Brendan Eich"  </span></code></pre><p>This is especially useful because a number of internal coercion operations use a supplied <code>toString</code> method. </p><p>Unfortunately, this literal syntax only works if we are willing to make the new object's prototype <code>Object.prototype</code>. This eliminates the benefits we saw earlier of sharing properties using the prototype. In many cases, the convenience of the simple object literal outweighs this loss. In other cases, you will want a simple way to create a new object with a particular prototype. I'll explain it right afterward:</p><pre><code class="javascript hljs"><span class="hljs-keyword">var</span> fromPrototype = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">prototype, object</span>) </span>{  <span class="hljs-keyword">var</span> newObject = <span class="hljs-built_in">Object </span>.create(prototype);  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> prop <span class="hljs-keyword">in</span> object) {    <span class="hljs-keyword"> if</span> (object.hasOwnProperty(prop)) {      newObject[prop] = object[prop];    }  }  <span class="hljs-keyword">return</span> newObject;};<span class="hljs-keyword">var</span> person = {  toString: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{    <span class="hljs-keyword">return</span> <span class= "hljs-keyword">this</span>.firstName + <span class="hljs-string">' '</span> + <span class="hljs-keyword">this</span>.lastName;  }};<span class="hljs-keyword">var</span> man = fromPrototype(person, {  sex: <span class="hljs-string">"male"</span>});<span class="hljs-keyword">var</span> jeremy = fromPrototype(man, {  firstName: <span class="hljs-string">"Jeremy" </span>,  lastName:  <span class="hljs-string">"Ashkenas"</span>});jeremy.sex        <span class="hljs-comment">// "male"  </span>jeremy.toString() <span class="hljs-comment">// "Jeremy Ashkenas"  </span></code></pre><p>Let's deconstruct the <code>fromPrototype</code> method. The goal of this method is to create a new object with a set of properties, but with a particular prototype. First, we will use <code>Object.create()</code> to create a new empty object, and assign the prototype we specify. Next, we will enumerate all of the properties in the object that we supplied, and copy them over to the new object.</p><p>Remember that when you create an object literal, like the ones we are passing in to <code>fromPrototype</code>, it will always have <code>Object.prototype</code> as its prototype. By default, the properties that JavaScript includes on <code>Object.prototype</code> are <em>not enumerable</em>, so we don't have to worry about <code>valueOf</code> showing up in our loop. However, since <code>Object.prototype</code> is an object like any other object, anyone can define a new property on it, which may (and probably would) be marked enumerable.</p><p>As a result, while we are looping through the properties on the object we passed in, we want to restrict our copying to properties that were defined on the object itself, and not found on the prototype. JavaScript includes a method called <code>hasOwnProperty</code> on <code>Object.prototype</code> to check whether a property was defined on the object itself. Since object literals will always have <code>Object.prototype</code> as their prototype, you can use it in this manner.</p><p> The object we created in the example above looks like this:</p><p><img style="display:block; margin-left:auto; margin-right:auto;" src=" http://yehudakatz.com/wp-content/uploads/2011/08/prototype-chain-2.png" alt="prototype-chain-2.png" title="prototype-chain-2.png" border="0" width="464" height="588"></p><h2>Native Object Orientation</h2><p>At this point, it should be obvious that prototypes can be used to inherit functionality, much like traditional object oriented languages. To facilitate using it in this manner, JavaScript provides a <code>new</code> operator.</p><p>In order to facilitate object oriented programming, JavaScript allows you to use a Function object as a combination of a prototype to use for the new object and a constructor function to invoke:</p><pre><code class="javascript hljs"><span class="hljs-keyword">var</span> Person = <span class="hljs-function" ><span class="hljs-keyword">function</span>(<span class="hljs-params">firstName, lastName</span>) </span>{  <span class="hljs-keyword">this</span>.firstName = firstName;  <span class= "hljs-keyword">this</span>.lastName = lastName;}Person.prototype = {  toString: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{ <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.firstName + <span class="hljs-string">' '</span> + <span class="hljs-keyword">this</span> .lastName; }}</code></pre><p>Here, we have a single Function object that is both a constructor function and an object to use as the prototype of new objects. Let's implement a function that will create new instances from this <code>Person</code> object:</p><pre><code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">newObject</span>(<span class="hljs-params">func</span>) </span>{  <span class="hljs-comment">// get an Array of all the arguments except the first one</span>  <span class="hljs-keyword">var</span> args = <span class="hljs-built_in">Array</span>.prototype.slice.call(<span class="hljs-built_in">arguments</span>, <span class="hljs-number">1</span>); <span class="hljs-comment">// create a new object with its prototype assigned to func.prototype</span>  <span class="hljs-keyword">var</span> object = <span class="hljs-built_in">Object </span>.create(func.prototype);  <span class="hljs-comment">// invoke the constructor, passing the new object as 'this'</span>  <span class="hljs-comment">// and the rest of the arguments as the arguments</span>  func.apply(object, args);  <span class="hljs-comment">// return the new object</span>  <span class="hljs-keyword">return</span> object;}<span class="hljs-keyword"> var</span> brendan = newObject(Person, <span class="hljs-string">"Brendan"</span>, <span class="hljs-string">"Eich"</span>);brendan.toString() <span class="hljs-comment">// "Brendan Eich"  </span></code></pre><p>The <code>new</code> operator in JavaScript essentially does this work, providing a syntax familiar to those comfortable with traditional object oriented languages:</p><pre><code class="javascript hljs"><span class="hljs-keyword">var</span> mark = <span class="hljs-keyword">new</span> Person(<span class="hljs-string">"Mark"</span>, <span class="hljs-string">"Miller"</span>);mark.toString() <span class="hljs-comment">// "Mark Miller"  </span></code></pre><p>In essence, a JavaScript "class" is just a Function object that serves as a constructor plus an attached prototype object. I mentioned before that earlier versions of JavaScript did not have <code>Object.create</code>. Since it is so useful, people often created something like it using the <code>new</code> operator:</p><pre><code class="javascript hljs"><span class="hljs-keyword">var</span> createObject = <span class="hljs-function" ><span class="hljs-keyword">function</span> (<span class="hljs-params">o</span>) </span>{  <span class="hljs-comment">// we only want the prototype part of the `new`</span>  <span class= "hljs-comment">// behavior, so make an empty constructor</span>  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">F</span>(<span class= "hljs-params"></span>) </span>{}  <span class="hljs-comment">// set the function's `prototype` property to the</span>  <span class="hljs-comment">// object that we want the new object's prototype</span>  <span class="hljs-comment">// to be.</span>  F.prototype = o;  <span class="hljs-comment">// use the `new` operator. We will get a new</span>  <span class="hljs-comment"> // object whose prototype is o, and we will</span>  <span class="hljs-comment">// invoke the empty function, which does nothing.</span>  <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> F();};</code></pre><p>I really love that ECMAScript 5 and newer versions have begun to expose internal aspects of the implementation, like allowing you to directly define non-enumerable properties or define objects directly using the prototype chain.</p>                </div>			</div>		<!--=========================			END : POST		=============================-->		<!--=========================			START : POST		=============================-->		<div class="post-wrapper"> <article> <header> <aside class="text-muted"> <time datetime="2014-06-30" pubdate="">June 30, 2014</time> </aside> <h1 class="no-padding-top">Vanilla JavaScript version of jQuery.extend() </h1> </header> <p>When writing <a href="https://gist.github.com/cferdinandi/ece94569aefcffa5f7fa">vanilla JavaScript plugins</a>, I often need to merge a set of user options into the plugin defaults to create the settings that ultimately get applied.</p><p>jQuery makes this really easy via their <a href="http://api.jquery.com/jquery.extend/"><code>extend()</code> method</a>. Fortunately, there's an easy way to do this with native JS, too!</p><p><span id="more-5457"></span></p><h2>A native JS <code>extend()</code> function</h2><pre class=" language-javascript"><code class=" language-javascript"><span class="token comment" spellcheck="true">/** * Merge defaults with user options * @private * @param {Object} defaults Default settings * @param {Object} options User options * @returns {Object} Merged values of defaults and options */</span><span class="token keyword">var</span> extend <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span> defaults<span class="token punctuation">,</span> options <span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">var</span> extended <span class="token operator">=</span> <span class="token punctuation">{ </span><span class="token punctuation">}</span><span class="token punctuation">;</span>    <span class="token keyword">var</span> prop<span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span>prop <span class="token keyword">in</span> defaults<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>Object<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>hasOwnProperty<span class="token punctuation">.</span><span class="token function">call<span class="token punctuation">(</span></span>defaults<span class="token punctuation">,</span> prop<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            extended<span class="token punctuation">[</span>prop<span class="token punctuation">]</span> <span class="token operator">=</span> defaults<span class="token punctuation">[</span>prop<span class="token punctuation"> ]</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span>prop <span class="token keyword">in</span> options<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class= "token keyword">if</span> <span class="token punctuation">(</span>Object<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>hasOwnProperty<span class= "token punctuation">.</span><span class="token function">call<span class="token punctuation">(</span></span>options<span class="token punctuation">,</span> prop<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            extended<span class="token punctuation">[</span>prop<span class="token punctuation">]</span> <span class="token operator">=</span> options<span class="token punctuation">[</span>prop<span class="token punctuation">]</span><span class="token punctuation">; </span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span>    <span class="token keyword">return</span> extended<span class="token punctuation">; </span><span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre><h3 id="example">Example</h3><pre class=" language-javascript"><code class=" language-javascript"><span class="token keyword">var</span> defaults <span class="token operator">=</span> <span class="token punctuation">{</span>    number<span class="token punctuation" >:</span> <span class="token number">1</span><span class="token punctuation">,</span>    bool<span class="token punctuation">:</span> <span class="token boolean">true</span><span class= "token punctuation">,</span>    magic<span class="token punctuation">:</span> <span class="token string">'real'</span><span class="token punctuation">,</span>    animal<span class="token punctuation">:</span> <span class="token string">'whale'</span><span class="token punctuation">,</span>    croutons<span class="token punctuation">:</span> <span class="token string"> 'delicious'</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token keyword">var</span> options <span class="token operator">=</span> <span class="token punctuation">{</span>    number<span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">,</span>    magic<span class= "token punctuation">:</span> <span class="token string">'real'</span><span class="token punctuation">,</span>    animal<span class="token punctuation">:</span> <span class="token string"> 'porpoise'</span><span class="token punctuation">,</span>    bool<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span> random<span class="token punctuation">:</span> <span class="token number">42</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token keyword">var</span> settings <span class="token operator">=</span> <span class="token function">extend<span class="token punctuation">(</span></span>defaults<span class="token punctuation" >,</span> options<span class="token punctuation">)</span><span class="token punctuation">;</span>console<span class="token punctuation">.</span><span class="token function">log<span class= "token punctuation">(</span></span>settings<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// Returns: Object{animal: "porpoise", bool: false, croutons: "delicious", magic: "real", number: 2, random: 42}</span></code></pre><p>Unlike the jQuery version, this creates a new object, leaving the original <code>defaults</code> and <code>options</code> variables intact. You can get my full native <a href="https://gist.github.com/cferdinandi/ece94569aefcffa5f7fa">JS plugin boilerplate on GitHub</a>.</p><h3 id="update">Update</h3><p>If you're comfortable only supporting IE 9 and up (<a href="http://gomakethings.com/ditching-jquery-for-vanilla-js/">I am</a>), <a href="http://toddmotto.com/">Todd Motto</a> shared <a href="https://gist.github.com/toddmotto/49c16d931a7380a1e661">this shorter syntax</a> that achieves the same results:</p><pre class =" language-javascript"><code class=" language-javascript"><span class="token keyword">function</span> extend <span class="token punctuation">(</span>target<span class="token punctuation"> ,</span> source<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">var</span> a <span class="token operator">=</span> Object <span class="token punctuation">.</span><span class="token function">create<span class="token punctuation">(</span></span>target<span class="token punctuation">)</span><span class="token punctuation">;</span>    Object<span class="token punctuation">.</span><span class="token function">keys<span class="token punctuation">(</span></span>source<span class="token punctuation" >)</span><span class="token punctuation">.</span><span class="token function">map<span class="token punctuation">(</span></span><span class="token keyword">function</span> <span class= "token punctuation">(</span>prop<span class="token punctuation">)</span> <span class="token punctuation">{</span>        prop <span class="token keyword">in</span> a <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>a<span class="token punctuation">[</span>prop<span class="token punctuation">]</span> <span class="token operator">= </span> source<span class="token punctuation">[</span>prop<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> a<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre><p><strong><em>Note:</em></strong> <em>With this method, if an item is not present in object 1, it will not be merged from object 2. You can find my preferred version of <a href="http://gomakethings.com/ditching-jquery/">this and other native JS scripts here </a>.</em></p><p>MDN offers polyfills for <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/create#Polyfill">Object.create</a>, <a href=" https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/keys#Polyfill">Object.keys</a>, and <a href=" https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/map#Polyfill">Array.prototype.map</a>, but at that point, you might as well just use the original script. You can feature test for each of these like this:</p><pre class=" language-javascript"><code class=" language-javascript"><span class="token keyword">var</span> supports <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>supports<span class="token punctuation">.</span>objectCreate <span class="token operator">=</span> <span class="token keyword">typeof</span> Object<span class="token punctuation">.</span>create <span class="token operator">===</span> <span class="token string">'function'</span> <span class="token operator">?</span> <span class="token boolean">true</span> <span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">;</span>supports<span class="token punctuation">.</span>objectKeys <span class="token operator">=</span> <span class ="token operator">!</span><span class="token operator">!</span>Object<span class="token punctuation">.</span>keys<span class="token punctuation">;</span>supports<span class="token punctuation">.</span>arrayProtoMap <span class="token operator">=</span> <span class="token operator">!</span><span class="token operator">!</span>Array<span class="token punctuation">. </span>prototype<span class="token punctuation">.</span>map<span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span> supports <span class="token punctuation">.</span>objectCreate <span class="token operator">&amp;&amp;</span> supports<span class="token punctuation">.</span>objectKeys <span class="token operator"> &amp;&amp;</span> supports<span class="token punctuation">.</span>arrayProtoMap <span class="token punctuation">)</span> <span class="token punctuation">{</span>   <span class="token comment" spellcheck="true"> // Do stuff...</span><span class="token punctuation">}</span></code></pre> <div class="clearfix padding-top padding-bottom"> <em>Enjoy this post? You might also like my <strong><a href="http://gomakethings.com/newsletter/">free weekly newsletter</a></strong>, a short email with a handful of things that didn't make it onto my site. <a href=" http://gomakethings.com/newsletter/">Sign up&nbsp;here.</a></em></div> </article>			</div>		<!--=========================			END : POST =============================-->		<!--=========================			START : POST		=============================-->		<div class="post-wrapper"><div class= "section-inner layoutSingleColumn"><figure name="c634" id="c634" class="graf--figure graf--first"><div class="aspectRatioPlaceholder is-locked" ></div></figure><h2 name="7961" id="7961" data-align="center" class="graf--h2">The many ways to implement OOP in Javascript</h2><p name="7425" id="7425" class="graf--p">Javascript is a very flexible language. Implementing an OOP interface in JS can be done in many ways that should work in every browser.</p><p name="538e" id="538e" class="graf--p">The purpose of this article is to illustrate this by going through multiple ways to do one of the most basic things in OO programming: creating a function or object and adding properties to it.</p><h3 name="9975" id="9975" class="graf--h3">Adding properties to functions</h3><p name="8789" id="8789" class="graf--p">It's important to realise that standard function properties (arguments, name, caller &amp; length) cannot be overwritten. So, forget about adding a property with that name.</p><h4 name="f4b2" id="f4b2" class="graf--h4">Method 1&nbsp;: adding properties while running the function</h4><pre name= "4710" id="4710" class="graf--pre">var doSomething = function() {<br>    doSomething.name = 'Tom';<br>    doSomething.name2 = 'John';<br>    return 'Beep';<br>};</pre><pre name="2c32" id= "2c32" class="graf--pre"><em class="markup--em markup--pre-em">console.log('doSomething.name : ' + doSomething.name); console.log('doSomething.name2 : ' + doSomething.name2); console.log('doSomething() : ' + doSomething()); console.log('doSomething.name : ' + doSomething.name); console.log('doSomething.name2 : ' + doSomething.name2);</em></pre><p name="bd09" id ="bd09" class="graf--p"><strong class="markup--strong markup--p-strong">Output&nbsp;:</strong></p><pre name="bc05" id="bc05" class="graf--pre">doSomething.name : <br>doSomething.name2 : undefined<br>doSomething() : Beep<br>doSomething.name :<br>doSomething.name2 : John</pre><h4 name="a295" id="a295" class="graf--h4">Method 1 (alternate syntax)&nbsp;:</h4><pre name="cdc0" id="cdc0" class="graf--pre">function doSomething() {<br>    doSomething.name = 'Tom';<br>    doSomething.name2 = 'John';<br>    return 'Beep';<br>};</pre><pre name="153b" id="153b" class= "graf--pre"><em class="markup--em markup--pre-em">console.log('doSomething.name : ' + doSomething.name); console.log('doSomething.name2 : ' + doSomething.name2); console.log('doSomething() : ' + doSomething()); console.log('doSomething.name : ' + doSomething.name); console.log('doSomething.name2 : ' + doSomething.name2);</em></pre><p name="3387" id ="3387" class="graf--p"><strong class="markup--strong markup--p-strong">Output&nbsp;:</strong></p><pre name="13d9" id="13d9" class="graf--pre">doSomething.name : doSomething<br> doSomething.name2 : undefined<br>doSomething() : Beep<br>doSomething.name : doSomething<br>doSomething.name2 : John</pre><h4 name="eb6a" id="eb6a" class="graf--h4">Method 1 (second alternate syntax)&nbsp;:</h4><pre name="6f6f" id="6f6f" class="graf--pre">var doSomething = function f() {<br>    f.name = 'Tom';<br>    f.name2 = 'John';<br>    return 'Beep';<br>}; </pre><pre name="7c76" id="7c76" class="graf--pre"><em class="markup--em markup--pre-em">console.log('doSomething.name : ' + doSomething.name); console.log('doSomething.name2 : ' + doSomething.name2); console.log('doSomething() : ' + doSomething()); console.log('doSomething.name : ' + doSomething.name); console.log('doSomething.name2 : ' + doSomething.name2); </em></pre><p name="dd5c" id="dd5c" class="graf--p"><strong class="markup--strong markup--p-strong">Output&nbsp;:</strong></p><pre name="67c5" id="67c5" class="graf--pre"><em class= "markup--em markup--pre-em">doSomething.name : f<br>doSomething.name2 : undefined<br>doSomething() : Beep<br>doSomething.name : f<br>doSomething.name2 : John</em></pre><p name="b18b" id= "b18b" class="graf--p">A problem with this strategy is that you need to run your function at least once to assign the properties. In many cases, that's obviously not what you want. So let's consider the other options.</p><h4 name="aeb4" id="aeb4" class="graf--h4">Method 2&nbsp;: adding properties after defining the function</h4><p name="3900" id="3900" class="graf--p graf--empty"><br></p><pre name="7a30" id="7a30" class="graf--pre">function doSomething() {<br>    return 'Beep';<br>};<br>doSomething.name = 'Tom';<br>doSomething.name2 = 'John';</pre><pre name="d0b0" id="d0b0" class="graf--pre"><em class="markup--em markup--pre-em">console.log('doSomething.name : ' + doSomething.name); console.log('doSomething.name2 : ' + doSomething.name2); console.log('doSomething() : ' + doSomething()); console.log('doSomething.name : ' + doSomething.name); console.log('doSomething.name2 : ' + doSomething.name2); </em></pre><p name="ed3c" id="ed3c" class="graf--p"><strong class="markup--strong markup--p-strong">Output&nbsp;:</strong></p><pre name="d79f" id="d79f" class="graf--pre">doSomething.name : doSomething<br>doSomething.name2 : John<br>doSomething() : Beep<br>doSomething.name : doSomething<br>doSomething.name2 : John</pre><p name="6196" id="6196" class="graf--p">Now, you don't need to run your function first before you're able to access your properties. However, a disadvantage is that your properties feel disconnected from your function.</p><h4 name="2dc6" id="2dc6" class="graf--h4">Method 3&nbsp;: wrap your function in a self-executing anonymous function</h4><p name="72df" id="72df" class="graf--p graf--empty"><br></p><pre name="e9ed" id= "e9ed" class="graf--pre">var doSomething = (function(args) {<br>    var f = function() {<br>        return 'Beep';<br>    };<br>    for (i in args) {<br>        f[i] = args[i];<br>    } <br>    return f;<br>}({<br>    'name': 'Tom',<br>    'name2': 'John'<br>}));</pre><pre name="5e6d" id="5e6d" class="graf--pre"><em class="markup--em markup--pre-em"> console.log('doSomething.name : ' + doSomething.name); console.log('doSomething.name2 : ' + doSomething.name2); console.log('doSomething() : ' + doSomething()); console.log('doSomething.name : ' + doSomething.name); console.log('doSomething.name2 : ' + doSomething.name2);</em></pre><p name="a131" id="a131" class="graf--p"><strong class= "markup--strong markup--p-strong">Output&nbsp;:</strong></p><pre name="c308" id="c308" class="graf--pre">doSomething.name :<br>doSomething.name2 : John<br>doSomething() : Beep<br> doSomething.name :<br>doSomething.name2 : John</pre><p name="29c8" id="29c8" class="graf--p">Wrapping your function in a self-executing anonymous function, you can collect your attributes into an object and use a loop to add those attributes one-by-one within the anonymous function. That way, your attributes feel more connected to your function. This technique is also very useful for when your attributes need to be copied from an existing object. A disadvantage, however, is that you can only add multiple attributes at the same time when you define your function. Also, it doesn't exactly result in DRY code if adding properties to a function is something you want to do often.</p><h4 name="d998" id="d998" class="graf--h4">Method 4&nbsp;: add an 'extend' function to your function, that adds the properties of an object to itself one by one</h4><p name="8600" id="8600" class="graf--p graf--empty"><br></p><pre name="1ace" id= "1ace" class="graf--pre">var doSomething = function() {<br>    return 'Beep';<br>};<br>doSomething.extend = function(args) {<br>    for (i in args) {<br>        this[i] = args[i];<br>    } <br>    return this;<br>};<br>doSomething.extend({ 'name': 'Tom', 'name2': 'John' });</pre><pre name="4f0f" id="4f0f" class="graf--pre"><em class="markup--em markup--pre-em"> console.log('doSomething.name : ' + doSomething.name); console.log('doSomething.name2 : ' + doSomething.name2); console.log('doSomething() : ' + doSomething()); console.log('doSomething.name : ' + doSomething.name); console.log('doSomething.name2 : ' + doSomething.name2);</em></pre><p name="d19f" id="d19f" class="graf--p"><strong class= "markup--strong markup--p-strong">Output&nbsp;:</strong></p><pre name="a211" id="a211" class="graf--pre">doSomething.name :<br>doSomething.name2 : John<br>doSomething() : Beep<br> doSomething.name :<br>doSomething.name2 : John</pre><p name="82f9" id="82f9" class="graf--p">This way, you can extend multiple properties and/or copy properties from another project at any time. Again, however, your code isn't DRY if this is something you do more often.</p><h4 name="8994" id="8994" class="graf--h4">Method 5&nbsp;: Make a generic 'extend' function</h4><p name="b39a" id="b39a" class="graf--p graf--empty"><br></p><pre name="b99f" id="b99f" class="graf--pre">var extend = function(obj, args) {<br>    if (isArray(args) ||<br> (args !== null &amp;&amp; typeof args === 'object')) {<br>        for (i in args) {<br>            this[i] = args[i];<br>        }<br>    }<br>    return obj;<br>};<br>var doSomething = extend(<br>    function() { return 'Beep'; },<br>    { 'name': 'Tom', 'name2': 'John' }<br>);</pre><pre name="a899" id="a899" class="graf--pre"><em class="markup--em markup--pre-em"> console.log('doSomething.name : ' + doSomething.name); console.log('doSomething.name2 : ' + doSomething.name2); console.log('doSomething() : ' + doSomething()); console.log('doSomething.name : ' + doSomething.name); console.log('doSomething.name2 : ' + doSomething.name2);</em></pre><p name="7acf" id="7acf" class="graf--p"><strong class= "markup--strong markup--p-strong">Output&nbsp;:</strong></p><pre name="8d54" id="8d54" class="graf--pre">doSomething.name :<br>doSomething.name2 : John<br>doSomething() : Beep<br> doSomething.name :<br>doSomething.name2 : John</pre><p name="d3e1" id="d3e1" class="graf--p">A genetic extend function allows for a more dry approach, allowing you to add the object or any project to any other object.</p><h4 name="b78e" id="b78e" class="graf--h4">Method 6&nbsp;: Create an extendableFunction object and use it to attach an extend function to a function </h4><p name="6d09" id="6d09" class="graf--p graf--empty"><br></p><pre name="9927" id="9927" class="graf--pre">var extend = function(obj, args) {<br>    if (isArray(args) ||<br> (args !== null &amp;&amp; typeof args === 'object')) {<br>        for (i in args) {<br>            this[i] = args[i];<br>        }<br>    }<br>    return obj;<br>}</pre><pre name="2387" id ="2387" class="graf--pre">var doSomething = extend(<br>    function() {<br>        return 'Beep';<br>    }, {<br>        'name': 'Tom',<br>        'name2': 'John'<br>    }<br>);</pre><pre name="596f" id="596f" class="graf--pre"><em class="markup--em markup--pre-em">console.log('doSomething.name : ' + doSomething.name);<br>console.log('doSomething.name2 : ' + doSomething.name2);<br>console.log('doSomething() : ' + doSomething());<br>console.log('doSomething.name : ' + doSomething.name);<br>console.log('doSomething.name2 : ' + doSomething.name2);</em></pre><p name="940a" id="940a" class="graf--p"><strong class="markup--strong markup--p-strong">Output&nbsp;:</strong></p><pre name="826e" id="826e" class= "graf--pre">doSomething.name :<br>doSomething.name2 : John<br>doSomething() : Beep<br>doSomething.name :<br>doSomething.name2 : John</pre><p name="47fe" id="47fe" class="graf--p">Rather than using a generic 'extend' function, this technique allows you to generate functions that have an 'extend' method attached to it.</p><h4 name="8706" id="8706" class="graf--h4">Method 7 &nbsp;: Add an 'extend' function to the Function prototype</h4><p name="8147" id="8147" class="graf--p graf--empty"><br></p><pre name="e340" id="e340" class="graf--pre"> Function.prototype.extend = function(args) {<br>    if (isArray(args) ||<br>          (args !== null &amp;&amp; typeof args === 'object')) {<br>        for (i in args) {<br> this[i] = args[i];<br>        }<br>    }<br>    return this;<br>};</pre><pre name="d178" id="d178" class="graf--pre">var doSomething = function() {<br>    return 'Beep';<br>}.extend({<br> name : 'Tom',<br>    name2 : 'John'<br>});</pre><pre name="9fc0" id="9fc0" class="graf--pre"><em class="markup--em markup--pre-em">console.log('doSomething.name : ' + doSomething.name); console.log('doSomething.name2 : ' + doSomething.name2); console.log('doSomething() : ' + doSomething()); console.log('doSomething.name : ' + doSomething.name); console.log('doSomething.name2 : ' + doSomething.name2);</em></pre><p name="a973" id="a973" class="graf--p"><strong class="markup--strong markup--p-strong">Output&nbsp;:</strong></p><pre name="6d5e" id="6d5e" class="graf--pre">doSomething.name :<br>doSomething.name2 : John<br>doSomething() : Beep<br>doSomething.name :<br>doSomething.name2 : John</pre><p name="9a94" id= "9a94" class="graf--p">A great advantage to this technique is that it makes adding new properties to a function very easy and DRY as well as completely OO. Also, it's pretty memory friendly. A downside, however, is that it's not very future proof. In case future browsers ever add a native 'extend' function to the Function prototype, this could then break your code. </p><h4 name="01ae" id="01ae" class="graf--h4">Method 8&nbsp;: Run a function recursively once and then return it</h4><pre name="c4b0" id="c4b0" class="graf--pre">var doSomething = (function f(arg1) {<br>    if(f.name2 === undefined) {<br>        f.name = 'Tom';<br>        f.name2 = 'John';<br>        f.extend = function(obj, args) {<br>            if (isArray(args) ||<br>                  (args !== null &amp;&amp; typeof args === 'object')) {<br>                for (i in args) {<br>                    this[i] = args[i];<br>                }<br> }<br>            return obj;<br>        };<br>        return f;<br>    } else {<br>        return 'Beep';<br>    }<br>})();</pre><pre name="ea2a" id="ea2a" class="graf--pre" ><em class="markup--em markup--pre-em">console.log('doSomething.name : ' + doSomething.name);<br>console.log('doSomething.name2 : ' + doSomething.name2);<br>console.log('doSomething() : ' + doSomething());<br>console.log('doSomething.name : ' + doSomething.name);<br>console.log('doSomething.name2 : ' + doSomething.name2);</em></pre><p name="c471" id="c471" class="graf--p" ><strong class="markup--strong markup--p-strong">Output&nbsp;:</strong></p><pre name="84aa" id="84aa" class="graf--pre">doSomething.name : f<br>doSomething.name2 : John<br>doSomething() : Beep<br>doSomething.name : f<br>doSomething.name2 : John</pre><p name="b317" id="b317" class="graf--p">Run a function once and have it test whether one of its properties is set. If not set, set the properties and return itself. If set, execute the function. If you include an 'extend' function as one of the properties, you can later execute that function to add new properties.</p><h3 name="20e2" id="20e2" class="graf--h3">Adding properties to objects</h3><p name="fdf3" id="fdf3" class="graf--p graf--empty"><br></p><p name="fcf3" id="fcf3" class= "graf--p">In spite of all these options, I would nevertheless recommend against adding properties to a function. It's better to add properties to objects.</p><p name="ca6e" id="ca6e" class ="graf--p">If you're familiar with JSON, Javascript objects should look very familiar. The JSON syntax is actually a text only variation on JavaScript's object notation syntax.</p><pre name="0481" id="0481" class="graf--pre">var keyValueStore = {<br>    'data' : {},<br>    'get' : function(key) {<br>        return keyValueStore.data[key];<br>    },<br>    'set' : function(key, value) {<br>            keyValueStore.data[key] = value;<br>    },<br>    'delete' : function(key) {<br>       delete keyValueStore.data[key];<br>    },<br>    'getLength' : function() {<br>        var l = 0;<br>        for (p in keyValueStore.data) l++;<br>            return l;<br>        }<br>    }<br>};</pre><p name="ab0a" id="ab0a" class="graf--p">A key difference with JSON objects is that you can assign functions to an object. Such objects behave very similar to <a href="https://en.wikipedia.org/wiki/Singleton_pattern" data-href=" https://en.wikipedia.org/wiki/Singleton_pattern" class="markup--anchor markup--p-anchor" rel="nofollow">singleton instances</a> in other programmnig languages.</p><p name="82e8" id="82e8" class="graf--p">Often, objects are wrapped in a self-executing anonymous function:</p><pre name="0c03" id="0c03" class="graf--pre">var keyValueStore = (function() {<br>    return {<br> 'data' : {},<br>        'get' : function(key) {<br>            return keyValueStore.data[key];<br>        },<br>        'set' : function(key, value) {<br> keyValueStore.data[key] = value;<br>        },<br>        'delete' : function(key) {<br>            delete keyValueStore.data[key];<br>        },<br>        'getLength' : function() {<br> var l = 0;<br>            for (p in keyValueStore.data) l++;<br>            return l;<br>        }<br>    }<br>})();</pre><p name="0c35" id="0c35" class="graf--p">An advantage to this syntax is that it allows for both public and private variables. For example, this is how you make the 'data' variable private&nbsp;:</p><pre name="79a6" id="79a6" class="graf--pre" >var keyValueStore = (function() {<br>    var data = {};</pre><pre name="ae94" id="ae94" class="graf--pre">    return {<br>        'get' : function(key) {<br>            return data[key]; <br>        },<br>        'set' : function(key, value) {<br>            data[key] = value;<br>        },<br>        'delete' : function(key) {<br>            delete data[key];<br> },<br>        'getLength' : function() {<br>            var l = 0;<br>            for (p in data) l++;<br>            return l;<br>        }<br>    }<br>})();</pre><p name="acaf" id="acaf" class="graf--p">But you want multiple datastore instances, you say? No problem!</p><pre name="3c54" id="3c54" class="graf--pre">var keyValueStore = (function() {<br>    var count = -1; <br><br>    return (function kvs() {<br>        count++; <br>        return {<br>            'data' : {},<br>            'create' : function() {<br>                return new kvs();<br> },<br>            'count' : function() {<br>                return count;<br>            },<br>            'get' : function(key) {<br>                return this.data[key];<br> },<br>            'set' : function(key, value) {<br>                this.data[key] = value;<br>            },<br>            'delete' : function(key) {<br> delete this.data[key];<br>            },<br>            'getLength' : function() {<br>                var l = 0;<br>                for (p in this.data) l++;<br>                return l; <br>            }<br>        }<br>    })();<br>})();</pre><p name="7220" id="7220" class="graf--p">Finally, you can separate the instance and singleton properties and use a prototype for the instance's public properties. That results in the following syntax&nbsp;:</p><pre name="d696" id="d696" class="graf--pre">var keyValueStore = (function() {<br>    var count = 0; // Singleton private properties</pre><pre name="fb1d" id="fb1d" class="graf--pre">    var kvs = function() {<br>        count++; // Instance private properties<br>    };</pre><pre name="e50d" id="e50d" class="graf--pre">    kvs.prototype = { // Instance public properties<br>        'data' : {},<br>        'get' : function(key) {<br>            return this.data[key];<br> },<br>        'set' : function(key, value) {<br>            this.data[key] = value;<br>        },<br>        'delete' : function(key) {<br>            delete this.data[key];<br> },<br>        'getLength' : function() {<br>            var l = 0;<br>            for (p in this.data) l++;<br>            return l;<br>        }<br>    };</pre><pre name="8519" id ="8519" class="graf--pre">    return { // Singleton public properties<br>        'create' : function() { return new kvs(); },<br>        'count' : function() { return count; }<br>    }; <br>})();</pre><p name="57da" id="57da" class="graf--p">With this syntax, you can have&nbsp;:</p><ul class="postList"><li name="5047" id="5047" class="graf--li">multiple instances of an object</li><li name="789d" id="789d" class="graf--li">private variables</li><li name="cd02" id="cd02" class="graf--li">class variables</li></ul><p name="00ad" id="00ad" class="graf--p" ><strong class="markup--strong markup--p-strong">Usage&nbsp;:</strong></p><pre name="54f1" id="54f1" class="graf--pre graf--last">kvs = keyValueStore.create();<br>kvs.set('Tom', "Baker"); <br>kvs.set('Daisy', "Hostess");<br>var profession_of_daisy = kvs.get('Daisy');<br>kvs.delete('Daisy');<br>console.log(keyValueStore.count());</pre></div>			</div> <!--=========================			END : POST		=============================-->		<!--=========================			START : POST =============================-->		<div class="post-wrapper">		<article id="post-740" class="post-740 post type-post status-publish format-standard hentry category-technical tag-blaggregator tag-javascript">				<header class="entry-header">						<h1 class="entry-title">Making Tea With Javascript: OOP with the Prototype Chain</h1> <div class="comments-link">					<a href="http://organicdonut.com/?p=740#respond"><span class="leave-reply">Leave a reply</span></a> </div><!-- .comments-link -->					</header><!-- .entry-header -->				<div class="entry-content">			<p>Javascript is&nbsp;<em>weird</em>.</p><p> Prototypical inheritance is really powerful, but it's quite a bit to wrap your mind around if you're new to it.&nbsp;My first language was Java, and I'm comfortable with the "traditional" OOP paradigm. <strong>In this post, I'll build a traditional Superclass/Subclass relationship in Javascript in an attempt to untangle the weirdness that is Javascript's prototypical inheritance model.</strong></p><p>All of the source code is <a href="http://repl.it/eKO/16">available in a repl.it</a>.</p><h2>Part 1: Superclass Constructor</h2><p>Let's brew a cup of tea.</p><pre><code>//Superclass constructorvar Tea = function(options) {    this.color = options.color || "herbal";    this.caffeine = options.caffeine || 0;    this.tannins = options.tannins || 0;    this.minsSteeped = 0;}</code></pre><p>Here, we've created a constructor for some tea. This tea can't really do anything, but it holds some useful information on whatever tea object we create in the future. I can make a cup of herbal tea by calling this with the <code>new</code> keyword.</p><pre><code>var myHerbalTea = new Tea({}); </code></pre><aside><b>What happens if we don't use the "new" keyword?</b><p></p><pre><code>var myBrokenTea = Tea({});</code></pre><p>With <a href=" https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Strict_mode">Strict Mode</a>,&nbsp;this will fail – referring to <code>this</code> without explicitly declaring what <code>this</code> is throws an error.</p><p>Without Strict Mode, the <code>this</code> keyword inside <code>Tea</code> is bound to the global object (<code>window</code>). Thus, <code> color</code>, <code>caffeine</code>, etc., will be bound on the global object. Trying to access a member variable, e.g. <code>myBrokenTea.color</code>, will throw an error, since <code> color</code> is on <code>window</code> and not <code>myBrokenTea</code>.</p></aside><h2>&nbsp;Part 2: Superclass Prototype</h2><aside><strong>How does <code>prototype</code> work? </strong><br><a href="http://organicdonut.com/wp-content/uploads/2015/03/abc1.png"><img class="alignright wp-image-769 size-full" src=" http://organicdonut.com/wp-content/uploads/2015/03/abc1.png" alt="" width="194" height="487"></a><br>Every object in javascript inherits from a prototype. When we go to access a property of a variable, we first look in the variable for a property with that name, e.g. calling <code>myObject.hello</code> looks for a member called <code>hello</code> on <code>myObject</code>. If no member called hello is found, then we look in the prototype of myObject. If there's no member called hello there, we go to the prototype of that prototype, and so on until we run out of prototypes.I created <a href="http://repl.it/eMu/9">an example of this behavior</a>. A inherits from B inherits from C. Try it yourself – trace the execution of <code> me.showUpAndLeave()</code> and see how it touches all three objects. The prototype chain of the three functions is visualized on the right.But <a href="http://repl.it/eMu/4">something really weird happens in this version</a>. If you run the code, the proper output ("hello world", "goodbye world") appears, but when we go to print <code>me.prototype</code>, we get <code> undefined</code>. <a href="http://i0.kym-cdn.com/photos/images/newsfeed/000/173/576/Wat8.jpg?1315930535">Wat</a>.It turns out that there are three ways to interact with an object's prototype, and in a true WTF-worthy decision, getting <code>object.prototype</code> does not actually give you the object's prototype. Instead, <strong><code>myObj.prototype</code> sets what the <code>__proto__</code> of any instances created using this function will be</strong>. This is why we set <code>A.prototype</code> before calling <code>new A()</code>. <p></p><table><thead><tr><th>Name</th><th>Description</th></tr></thead><tbody><tr><th><code>MyClass.prototype</code></th><td>This sets up the object that will be assigned as the <code> __proto__</code> for instances of class <code>MyClass</code>.</td></tr><tr><th><code>Object.getPrototypeOf(myObj)</code></th><td>This returns the object that is the <code>__proto__</code> for the myObj instance. This is the proper way to figure out what prototype a given object has (since <code>myObj.prototype</code> is <code>undefined</code>).</td></tr><tr><th><code> myObj.__proto__</code></th><td>This is the actual object that is the prototype for the myObj instance. You can edit it directly, but this is generally a Bad Idea. </td></tr></tbody></table></aside><p>Now that we have an idea of how prototypes work, we can go ahead and construct a prototype that will be applied to instances of <code>Tea</code>. </p><pre><code>Tea.prototype = {  steep : function(cup) {      //caffeine      this.caffeine = Math.max(0, this.caffeine - 1);      if (this.caffeine) {        cup.caffeine ++; }      //tannins      cup.tannins += this.tannins * this.minsSteeped;      //color      cup.color = this.color;      //minsSteeped      this.minsSteeped ++;  }};</code></pre><p>Now we create an object with a single method, <code>steep</code>, and assign that to be the prototype of <code>Tea</code>. &nbsp;We usually want to put methods on the prototype, so that there's only one copy of the function shared among all instances (this saves&nbsp;us a lot of memory).</p><p>After calling <code>var myHerbalTea = <strong>new</strong> Tea({})</code>, we'll have the following inheritance structure:</p><p><a href="http://organicdonut.com/wp-content/uploads/2015/03/tea-proto1.png"><img class="size-full wp-image-745" src=" http://organicdonut.com/wp-content/uploads/2015/03/tea-proto1.png" alt="Prototype Inheritance of myHerbalTea" width="194" height="287"></a></p><p>&nbsp;</p><p>Notice that the <code>Tea </code> function is&nbsp;<strong>not part of the prototype chain.</strong> It is simply a constructor function used to add the member variables (<code>color</code>, etc) to <code> myHerbalTea</code>. However, because <code>Tea.prototype</code> exists, it is chained to our instance of the <code>Tea</code> class.</p><h2>Part 3: Subclass</h2><p>Herbal tea is boring. Let's make something to wake us up!</p><pre><code>//Subclass constructorvar BlackTea = function(){    //Put instance properties from the superclass constructor on the subclass instance Tea.call(this, {        color : "Black",        caffeine : 10,        tannins : 3    });    this.hasMilk = false;}</code></pre><p>Here's where the Javascript magic begins. And by magic I mean less of the Harry Potter and more of the Goat Sacrifice.</p><p>Let's make some black tea:</p><pre><code>var firstCup = new BlackTea();</code></pre><p>This is another constructor function, composed of two main parts. First, we&nbsp;<strong>call the <code>Tea()</code> function, binding to the current instance.</strong>&nbsp;The call to <code>Tea</code> will&nbsp; have <code>firstCup</code> bound to <code>this</code>, which will apply all of the instance variables (<code>color</code>, etc), to <code>firstCup</code>. This is kind of like calling <code>super()</code> in a constructor in Java.</p><p>Here's the relevant code. Everything that refers to firstCup when we create it is highlighted red.</p><pre><code>var Tea = function(options) {    <span style="color:red">this</span>.color = options.color || "herbal";    <span style="color:red">this</span>.caffeine = options.caffeine || 0;    <span style= "color:red">this</span>.tannins = options.tannins || 0;    <span style="color:red">this</span>.minsSteeped = 0;}// ...var BlackTea = function(){    Tea.call(<span style="color:red">this </span>, {        color : "Black",        caffeine : 10,        tannins : 3    });    this.hasMilk = false;}var <span style="color:red">firstCup</span> = new BlackTea();// ... </code></pre><p>Ok, pop quiz.&nbsp;<strong>what is currently the prototype of <code>firstCup</code>?</strong></p><p>Answer:&nbsp;<code>undefined</code>.</p><p>If you thought it was <code> Tea</code>, remember that <code>Tea</code> is just the constructor and is never really a "thing".</p><p>If you thought it was <code>Tea.prototype</code> (I totally did), know that even though we do <code>Tea.call(...)</code>, we haven't bound <code>BlackTea</code>'s prototype yet, so <code>firstCup.__proto__</code> is nothing.</p><p>Let's set up the prototype and make a second cup.</p><h2>Part 4: Subclass Prototype</h2><p>Remember that the prototype of a class is the object that will be assigned to the <code>__proto__</code> property of any instances created of that class. So in order to create a second cup of tea, we need to first change <code>BlackTea.prototype</code>.</p><pre><code>BlackTea.prototype = Object.create(Tea.prototype);var secondCup = new BlackTea();</code></pre><aside><strong>How does Object.create(c) work?</strong><br><code>Object.create(c)</code> makes a new object, using <code>c</code> as the prototype. This is a way to get around having to create an entire class function, since <code>Object.create(c)</code> just uses <code>Object</code> as the base class. </aside><p>It wasn't obvious to me at first why we don't&nbsp;bind <code>BlackTea.prototype</code> directly to <code>Tea.prototype</code>. Instead, we create an object whose prototype is <code>Tea.prototype</code>, and then set <code>BlackTea.prototype</code> to that new, empty object. Our <code>secondCup</code> object can still see the <code>steep(cup)</code> function, but it checks an empty object on its way up the prototype chain. Hmm...</p><p><a href="http://organicdonut.com/wp-content/uploads/2015/03/second-proto.png"> <img class=" aligncenter" src=" http://organicdonut.com/wp-content/uploads/2015/03/second-proto.png" alt=""></a></p><p>But say we want to be able to add milk to our black tea. (Adding milk to green or herbal tea is icky and we shouldn't allow our users to do that). If I modify <code>BlackTea.prototype</code> to be able to add milk:</p><pre><code>BlackTea.prototype.addMilk = function(cup) {    //adding milk makes the cup of tea less harsh!    cup.tannins = Math.floor(cup.tannins / 2);    this.hasMilk = true;}</code></pre><p>Remember that <code>BlackTea.prototype</code> is<strong> not </strong> <code>Tea.prototype</code>!&nbsp;It's an object whose prototype is <code>Tea.prototype</code>. This means that addMilk is&nbsp;<strong>only available to instances of BlackTea </strong>, not any kind of tea.</p><p>Our prototype chain now looks like</p><p><a href="http://organicdonut.com/wp-content/uploads/2015/03/withmilk.png"><img class="aligncenter size-full wp-image-758" src="http://organicdonut.com/wp-content/uploads/2015/03/withmilk.png" alt="withmilk" width="194" height="487"></a></p><p>Yay!</p><h2>Part 5: Actually Make Tea</h2><pre><code> //ok, let's make some teavar myTea = new BlackTea();var myCup = {    color : "clear",    caffeine : 0,    tannins : 0};//steep for three minutesmyTea.steep(myCup);myTea.steep(myCup);myTea.steep(myCup);//add some milkmyTea.addMilk(myCup);//drink upconsole.log(myCup, myTea);</code></pre><p>This produces:<br>myCup is <samp>{ color: 'Black', caffeine: 3, tannins: 4 }</samp><br>myTea is <samp>{ color: 'Black', caffeine: 7, tannins: 3, minsSteeped: 3, hasMilk: true }</samp></p><h2>Part 6: Recap</h2><ul><li> Javascript prototypal inheritance is super weird</li><li>Use the new keyword to treat a function as a constructor<ul><li>The prototype of that function will become the __proto__ of the object, which is where the object looks for methods that aren't declared locally.</li><li>Then you can call that constructor (like Java's <code>super()</code>) using <code> Class.call(object)</code></li></ul></li><li>Explicitly set prototypes&nbsp;to an object with the prototype you want to create<ul><li>e.g. myObject.prototype = Object.create(Constructor.prototype)</li></ul></li></ul><p>I hope this blog post cleared up some of the mystery around prototypes and inheritance!</p><p>From Manhattan,</p><p>–Erty Seidohl </p><p>P.S. Thanks to <a href="http://ryanmcverry.com/">Ryan McVerry</a> and <a href="http://jvns.ca/">Julia Evans</a> for proofreading! Also <a href="michaelmulley.com">Michael Mulley</a> for helping me understand the WTF-ness of <code>.prototype</code> not actually returning anything on an object.</p>					</div><!-- .entry-content -->		<footer class= "entry-meta">			This entry was posted in <a href="http://organicdonut.com/?cat=25" rel="category">Technical</a> and tagged <a href="http://organicdonut.com/?tag=blaggregator" rel= "tag">blaggregator</a>, <a href="http://organicdonut.com/?tag=javascript" rel="tag">javascript</a> on <a href="http://organicdonut.com/?p=740" title="1:54 pm" rel="bookmark"><time class= "entry-date" datetime="2015-03-16T13:54:11+00:00">March 16, 2015</time></a><span class="by-author"> by <span class="author vcard"><a class="url fn n" href=" http://organicdonut.com/?author=1" title="View all posts by erty" rel="author">erty</a></span></span>.								</footer><!-- .entry-meta -->	</article> </div>		<!--=========================			END : POST		=============================-->		<!--=========================			START : POST =============================-->		<div class="post-wrapper">		<h1>OOP, JavaScript, and so-called Classes</h1>		<section id="main_content">          <p>Programming with objects and classes began in Norway in the late 1960s with the <a href="https://en.wikipedia.org/wiki/Simula">Simula</a> programming language. Its creators, Ole-Johan Dahl and Kristen Nygaard, did not use those words to describe what would eventually become the dominant paradigm in computing.</p><p>A decade later, Dr. Alan Kay coined the phrase "Object-Oriented Programming" along with co-creating the <a href="https://en.wikipedia.org/wiki/Smalltalk">Smalltalk</a> programming language. He has famously said that to him, "OOP" was objects communicating with each other using messages, and that other languages copied the things that didn't matter from Smalltalk, and ignored the things he thought did matter.</p><p>Since that time, languages have either bolted object-ish ideas on top of their existing paradigms (like <a href="https://en.wikipedia.org/wiki/Object_Pascal">Object Pascal</a> and <a href=" https://en.wikipedia.org/wiki/OCaml">OCaml</a>), baked them in alongside other paradigms (like JavaScript), or embraced objects wholeheartedly.</p><p>That being said, there really is no one definition of "object-oriented." For one thing, there is no one definition of "object."</p><h3 id="objects">objects</h3><p>Some languages, like Smalltalk and <a href=" https://en.wikipedia.org/wiki/Ruby_(programming_language)">Ruby</a>, treat an object as a fully encapsulated entity. There is no access to an object's private state, all you can do is invoke one of its methods. Other languages, like Java, permit objects to access each other's  state.</p><p>Some languages (again, like Java) have very rigid objects and classes, it is impossible or awkward to add new methods or properties to objects at run time. Some are flexible about adding methods and properties at run time. And yet other languages treat objects as dictionaries, where properties and even methods can be added, modified, or removed with abandon.</p><p>So we can see that the concept of "object" is flexible across languages.</p><h3 id= "classes">classes</h3><p>The concept of "class" is also flexible across languages. Object-oriented languages do not uniformly agree on whether classes are necessary, much less how they work. For example, The Common Lisp Object System defines behaviour with classes, and it also defines behaviour with generic functions. The <a href=" https://en.wikipedia.org/wiki/Self_(programming_language)">Self</a> and <a href="https://en.wikipedia.org/wiki/NewtonScript">NewtonScript</a> languages have prototypes instead of classes. </p><p>So some "OO" languages have objects, but not classes.</p><p>C++ has classes, but they are not "first-class entities." You can't assign a class to a variable or pass it to a function. You can, however, manipulate the constructors for classes, the functions that make new objects. But you can't manipulate those constructors to change the behaviour of objects that have already been constructed, instance behaviour is early-bound by default.</p><p>Ruby has classes, and they're first-class entities. You can ask an object for its class, you can put a class in a variable, pass it to a method, or return it from a method, just like every other entity in the language. Classes in Ruby and Smalltalk even have their own class, they are instances of <code>Class</code>!<sup id="fnref:meta"><a href="#fn:meta" class="footnote">1</a></sup> Instance behaviour is late-bound and open for extension.<sup id="fnref:mp"><a href= "#fn:mp" class="footnote">2</a></sup></p><h3 id="constructors">constructors</h3><p>Some languages allow programs to construct objects independently, others (notably those that are heavily class-centric) require that objects always be constructed by their classes. Some languages allow any function or method to be used as a constructor, others require a special syntax or declaration for constructors.</p><h3 id="prototypes-are-not-classes">prototypes are not classes</h3><p>Prototypical languages like Self and NewtonScript eschew classes altogether, using <em>prototypes</em> to define common behaviour for a set of objects. The difference between a prototype and a class is similar to the difference between a model home and a blueprint for a home.</p><p>You can say to a builder, "make me a home just like that model home," and the builder makes you a home that has a lot in common with the model home. You then decorate your home with additional personalization. But the model home is, itself, a home. Although you may choose to keep it empty, you could in principle move a family into it. This is different than asking a builder to make you a home based on a blueprint. The blueprint may specify the features of the home, but it isn't a home. It could never be used as a home.</p><p>Prototypes are like model homes, and classes are like blueprints. Classes are not like the objects they describe.<sup id="fnref:wellactually"><a href="#fn:wellactually" class="footnote">3 </a></sup></p><h3 id="object-oriented-programming-can-mean-almost-anything">"object-oriented programming" can mean almost anything</h3><p>From this whirlwind tour of "object-oriented programming," we can see that the ideas behind "object-oriented programming" have some common roots in the history of programming languages, but each language implements its own particular flavour in its own particular way.</p><p>Thus, when we talk about "objects" and "prototypes" and "classes" in JavaScript, we're talking about objects, prototypes, and classes <em>as implemented in JavaScript</em>. And we must keep in mind that other languages can have a radically different take on these ideas.</p><h3 id="the-javascript-approach">the javascript approach</h3><p>JavaScript has objects, and by default, those objects are dictionaries. By default, objects directly manipulate each other's state. Methods can be added to, or removed from objects at run time. </p><p>JavaScript has optional prototypes. Prototypes are objects in the same sense that model homes are homes. </p><p>In JavaScript, object and array literals construct objects that delegate behaviour to the standard library's object prototype and array prototype, respectively. JavaScript also supports using <code>Object.create</code> to construct objects with or without a prototype, and <code>new</code> to construct objects using a constructor function.</p><p>Using prototypes and constructor functions, JavaScript programs can emulate many of the features of classes in other languages. JavaScript also has a <code>class</code> keyword that provides syntactic sugar for writing constructor functions and prototypes in a declarative fashion.</p><p>By default, a JavaScript class is a constructor composed with an object as its associated prototype. This can be denoted with the <code>class </code> keyword, by working with a function's default <code>.prototype</code> property, or by composing functions and objects independently.</p><p>JavaScript classes are constructors, but they are more than C++ constructors, in that manipulation of their prototype extends or modifies the behaviour of the instances they create. JavaScript classes take a minimalist approach to OO in the same sense that JavaScript objects take a minimal approach to OO. For example, behaviour can be mixed into an object, a prototype, or a class using the exact same mechanism, because objects, prototypes, and a constructor's prototype are all objects.</p><p>In sum, JavaScript is not exactly like any other object-oriented programming language, and its classes aren't like any other language that features classes, but then again, neither is any other object-oriented programming language, and neither are any other classes.</p><hr><hr><p>This post was extracted from a draft of the book, <a href="https://leanpub.com/javascriptallongesix">JavaScript Allongé, The "Six" Edition</a>. The extracts so far:</p><ul>  <li><a href=" http://raganwald.com/2015/05/11/javascript-classes.html">OOP, Javascript, and so-called Classes</a>,</li>  <li><a href="http://raganwald.com/2015/04/03/left-variadic.html">Left-Variadic Functions in JavaScript</a>,</li>  <li><a href="http://raganwald.com/2015/04/01/partial-application.html">Partial Application in ECMAScript 2015</a>,</li>  <li><a href=" http://raganwald.com/2015/03/12/symmetry.html">The Symmetry of JavaScript Functions</a>,</li>  <li><a href="http://raganwald.com/2015/02/17/lazy-iteratables-in-javascript.html">Lazy Iterables in JavaScript</a>,</li>  <li><a href="http://raganwald.com/2015/02/13/functional-quantum-electrodynamics.html">The Quantum Electrodynamics of Functional JavaScript</a>,</li> <li><a href="http://raganwald.com/2015/02/07/tail-calls-defult-arguments-recycling.html">Tail Calls, Default Arguments, and Excessive Recycling in ES-6</a>, and:</li>  <li><a href=" http://raganwald.com/2015/02/02/destructuring.html">Destructuring and Recursion in ES-6</a>.</li></ul><hr><div class="footnotes">  <ol>    <li id="fn:meta">      <p>If the class of a class is <code>Class</code>, what class is the class of <code>Class</code>? In Ruby, <code>Class.class == Class</code>. In Smalltalk, it is <code>MetaClass</code>, which opens up the possibility for changing the way classes behave in a deep way. <a href="#fnref:meta" class="reversefootnote">↩</a></p>    </li>    <li id="fn:mp">      <p>Abuse of this feature by extending the behaviour of built-in classes is a controversial topic. <a href="#fnref:mp" class="reversefootnote">↩</a></p>    </li>    <li id="fn:wellactually">      <p>Well, <em>actually </em>, the difference between prototypes and classes is like the difference between model homes and blueprints. But prototypes are not like model homes. In actual fact, the relationship between an object and its prototype is one of <em>delegation</em>. So if a model home had a kitchen, and you asked the builder to make you a home using the model as a prototype, you could customize your own kitchen. But if you didn't want to have your own custom kitchen, you would just use the model home's kitchen to do all your own cooking. The relationship between a model home and a house is sometimes described as <a href="https://medium.com/javascript-scene/common-misconceptions-about-inheritance-in-javascript-d5d9bab29b0a">concatenative inheritance </a>, and JavaScript lets you do that too. <a href="#fnref:wellactually" class="reversefootnote">↩</a></p>    </li>  </ol></div>        </section>			</div> <!--=========================			END : POST		=============================-->		<!--=========================			START : POST =============================-->		<div class="post-wrapper">		<article> <header> <aside class="text-muted"> <time datetime="2015-06-22" pubdate="">June 22, 2015</time> </aside> <h1 class="no-padding-top">The anatomy of a vanilla JavaScript plugin</h1> </header> <p>For those of you who are in the process of <a href="http://gomakethings.com/ditching-jquery/"> ditching jQuery</a>, I thought it might be helpful to talk through how I structure my <a href="http://gomakethings.com/free-stuff/#interactive-content">native JavaScript plugins</a>. </p><p><span id="more-6301"></span></p><h2 id="the-template">The Template</h2><p>Here's the template I start all of my projects from. We're going to walk through it step-by-step.</p><pre class=" language-javascript"><code class=" language-javascript"><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span> root<span class="token punctuation">,</span> factory<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">if</span> <span class= "token punctuation">(</span> <span class="token keyword">typeof</span> define <span class="token operator">===</span> <span class="token string">'function'</span> <span class="token operator">&amp;&amp;</span> define<span class="token punctuation">.</span>amd <span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token function">define<span class="token punctuation">(</span></span><span class="token punctuation">[</span><span class="token string">'buoy'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token function">factory<span class="token punctuation">(</span></span>root<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token keyword">typeof</span> exports <span class="token operator">===</span> <span class="token string">'object'</span> <span class= "token punctuation">)</span> <span class="token punctuation">{</span>        module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token function">factory<span class="token punctuation">(</span></span><span class="token function">require<span class="token punctuation">(</span></span><span class="token string">'buoy' </span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span> <span class= "token keyword">else</span> <span class="token punctuation">{</span>        root<span class="token punctuation">.</span>myPlugin <span class="token operator">=</span> <span class="token function">factory<span class="token punctuation">(</span></span>root<span class="token punctuation">,</span> root<span class="token punctuation">.</span>buoy<span class="token punctuation" >)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class= "token punctuation">(</span><span class="token keyword">typeof</span> global <span class="token operator">!</span><span class="token operator">==</span> <span class="token string"> "undefined"</span> <span class="token operator">?</span> global <span class="token punctuation">:</span> this<span class="token punctuation">.</span>window <span class="token operator">|| </span> this<span class="token punctuation">.</span>global<span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>root <span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token string">'use strict'</span><span class="token punctuation">;</span>   <span class= "token comment" spellcheck="true"> //</span>   <span class="token comment" spellcheck="true"> // Variables</span>   <span class="token comment" spellcheck="true"> //</span>    <span class= "token keyword">var</span> myPlugin <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">; </span><span class="token comment" spellcheck="true"> // Object for public APIs</span>    <span class="token keyword">var</span> supports <span class="token operator">=</span> <span class= "token operator">!</span><span class="token operator">!</span>document<span class="token punctuation">.</span>querySelector <span class="token operator">&amp;&amp;</span> <span class= "token operator">!</span><span class="token operator">!</span>root<span class="token punctuation">.</span>addEventListener<span class="token punctuation">;</span><span class="token comment" spellcheck="true"> // Feature test</span>    <span class="token keyword">var</span> settings<span class="token punctuation">;</span><span class="token comment" spellcheck="true"> // Placeholder variables</span>   <span class="token comment" spellcheck="true"> // Default settings</span>    <span class="token keyword">var</span> defaults <span class="token operator"> =</span> <span class="token punctuation">{</span>        someVar<span class="token punctuation">:</span> <span class="token number">123</span><span class="token punctuation">,</span> initClass<span class="token punctuation">:</span> <span class="token string">'js-myplugin'</span><span class="token punctuation">,</span>        callbackBefore<span class="token punctuation">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{ </span><span class="token punctuation">}</span><span class="token punctuation">,</span>        callbackAfter<span class="token punctuation">:</span> <span class="token keyword">function </span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>    <span class= "token punctuation">}</span><span class="token punctuation">;</span>   <span class="token comment" spellcheck="true"> //</span>   <span class="token comment" spellcheck="true"> // Methods </span>   <span class="token comment" spellcheck="true"> //</span>   <span class="token comment" spellcheck="true"> // @todo add plugin methods here</span>    <span class="token comment" spellcheck="true">/**     * Handle events     * @private     */</span>    <span class="token keyword">var</span> eventHandler <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>event<span class="token punctuation">)</span> <span class="token punctuation">{</span>       <span class="token comment" spellcheck="true"> // @todo Do something on event</span>    <span class="token punctuation">}</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck= "true">/**     * Destroy the current initialization.     * @public     */</span>    myPlugin<span class="token punctuation">.</span>destroy <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>       <span class="token comment" spellcheck="true"> // If plugin isn't already initialized, stop</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token operator">!</span>settings <span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span>       <span class="token comment" spellcheck="true"> // Remove init class for conditional CSS</span>        document<span class="token punctuation">.</span>documentElement<span class="token punctuation">.</span>classList <span class="token punctuation">.</span><span class="token function">remove<span class="token punctuation">(</span></span> settings<span class="token punctuation">.</span>initClass <span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token comment" spellcheck="true"> // @todo Undo any other init functions...</span>       <span class="token comment" spellcheck="true"> // Remove event listeners</span>        document<span class="token punctuation">.</span><span class="token function">removeEventListener<span class="token punctuation">(</span></span><span class="token string">'click'</span><span class="token punctuation">,</span> eventHandler<span class="token punctuation">,</span> <span class= "token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token comment" spellcheck="true"> // Reset variables</span> settings <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">/**     * Initialize Plugin     * @public     * @param {Object} options User settings     */</span> myPlugin<span class="token punctuation">.</span>init <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span> options <span class="token punctuation">)</span> <span class="token punctuation">{</span>       <span class="token comment" spellcheck="true"> // feature test</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token operator">!</span>supports <span class="token punctuation">)</span> <span class="token keyword">return </span><span class="token punctuation">;</span>       <span class="token comment" spellcheck="true"> // Destroy any existing initializations</span>        myPlugin<span class="token punctuation">.</span><span class="token function">destroy<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true"> // Merge user options with defaults</span>        settings <span class="token operator">=</span> buoy<span class="token punctuation">. </span><span class="token function">extend<span class="token punctuation">(</span></span> defaults<span class="token punctuation">,</span> options <span class="token operator">||</span> <span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token comment" spellcheck="true"> // Add class to HTML element to activate conditional CSS</span>        document<span class="token punctuation">.</span>documentElement<span class="token punctuation">.</span>classList<span class="token punctuation">.</span><span class="token function">add<span class="token punctuation">(</span></span> settings<span class="token punctuation">.</span>initClass <span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token comment" spellcheck="true"> // @todo Do stuff... </span>       <span class="token comment" spellcheck="true"> // Listen for click events</span>        document<span class="token punctuation">.</span><span class="token function"> addEventListener<span class="token punctuation">(</span></span><span class="token string">'click'</span><span class="token punctuation">,</span> eventHandler<span class="token punctuation" >,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class= "token punctuation">;</span>   <span class="token comment" spellcheck="true"> //</span>   <span class="token comment" spellcheck="true"> // Public APIs</span>   <span class="token comment" spellcheck="true"> //</span>    <span class="token keyword">return</span> myPlugin<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><h2 id="dependencies">Dependencies</h2><p>I include two addtional files with most of my projects. The <a href=" https://developer.mozilla.org/en-US/docs/Web/API/Element/classList#wrapper">classList.js polyfill</a> extends classList support back to IE8 (natively, it's IE10+). <a href=" https://github.com/cferdinandi/buoy">Buoy</a> is a tiny collection of helper methods taht I use in most of my scripts.</p><h2 id="umd-wrapper">UMD Wrapper</h2><p>I use a <a href=" https://github.com/umdjs/umd">Universal Module Definition (UMD) wrapper</a> for all of my plugins. This wrapper means that my scripts are compatibile with both AMD and CommonJS, and also work as a traditional module pattern.</p><p>It also creates scope around the plugin, preventing variables and functions from being added to the global scope or being overridden by similarly named variables in other scripts.</p><pre class=" language-javascript"><code class=" language-javascript"><span class="token punctuation">(</span><span class="token keyword"> function</span> <span class="token punctuation">(</span>root<span class="token punctuation">,</span> factory<span class="token punctuation">)</span> <span class="token punctuation">{ </span>    <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token keyword">typeof</span> define <span class="token operator">===</span> <span class="token string">'function'</span> <span class="token operator">&amp;&amp;</span> define<span class="token punctuation">.</span>amd <span class="token punctuation">)</span> <span class ="token punctuation">{</span>        <span class="token function">define<span class="token punctuation">(</span></span><span class="token punctuation">[</span><span class="token string"> 'buoy'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token function">factory<span class="token punctuation">(</span></span>root<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span> <span class="token keyword"> else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token keyword">typeof</span> exports <span class="token operator">===</span> <span class="token string">'object'</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>        module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token function">factory<span class="token punctuation">(</span></span><span class="token function">require<span class="token punctuation">( </span></span><span class="token string">'buoy'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>        root<span class="token punctuation">.</span>myPlugin <span class= "token operator">=</span> <span class="token function">factory<span class="token punctuation">(</span></span>root<span class="token punctuation">,</span> root<span class="token punctuation">.</span>buoy<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">} </span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token keyword">typeof</span> global <span class="token operator">!</span><span class= "token operator">==</span> <span class="token string">'undefined'</span> <span class="token operator">?</span> global <span class="token punctuation">:</span> this<span class="token punctuation">.</span>window <span class="token operator">||</span> this<span class="token punctuation">.</span>global<span class="token punctuation">,</span> <span class="token keyword"> function</span> <span class="token punctuation">(</span>root<span class="token punctuation">)</span> <span class="token punctuation">{</span>   <span class="token comment" spellcheck= "true"> // Plugin stuff...</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>This sets up the namespacing for your plugin. You should change <code>myPlugin</code> to the name of your plugin.</p><p>Any references to <code>buoy</code> pass in my helper library as a dependency. In a browser, <code>root</code> is the <code>window</code>. This line addresses a Browserify bug that doesn't pass in <code>root</code> as <code>window</code> like it's supposed to.</p><pre class=" language-javascript"><code class=" language-javascript"><span class="token keyword">typeof</span> global <span class="token operator">!</span><span class="token operator">==</span> <span class="token string">'undefined'</span> <span class="token operator">?</span> global <span class="token punctuation">:</span> this<span class="token punctuation">.</span>window </code></pre><h2><code>use strict</code></h2><p><code>use strict</code> tells the browser (and JS linting tools) to be more strict about the errors that they throw. This sounds like a bad thing, but if forces you to write better, more cross-compatibile code. Always use it.</p><h2 id="variables">Variables</h2><p>At the top of my plugin, I setup the variables I'm going to be using throughout. This keeps everything neatly organized and in one place, and makes it easier to access variables without having to specifically pass them in to methods later.</p><pre class=" language-javascript"><code class=" language-javascript"><span class="token comment" spellcheck="true">//</span><span class="token comment" spellcheck="true">// Variables </span><span class="token comment" spellcheck="true">//</span><span class="token keyword">var</span> myPlugin <span class="token operator">=</span> <span class="token punctuation">{ </span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true"> // Object for public APIs</span><span class="token keyword">var</span> supports <span class="token operator">=</span> <span class="token operator">!</span><span class="token operator">!</span>document<span class="token punctuation">. </span>querySelector <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span><span class="token operator">!</span>root<span class="token punctuation">.</span> addEventListener<span class="token punctuation">;</span><span class="token comment" spellcheck="true"> // Feature test</span><span class="token keyword">var</span> settings<span class= "token punctuation">;</span><span class="token comment" spellcheck="true"> // Placeholder variables</span><span class="token comment" spellcheck="true">// Default settings</span><span class="token keyword">var</span> defaults <span class="token operator">=</span> <span class="token punctuation">{</span>    someVar<span class="token punctuation">:</span> <span class= "token number">123</span><span class="token punctuation">,</span>    initClass<span class="token punctuation">:</span> <span class="token string">'js-myplugin'</span><span class="token punctuation">,</span>    callbackBefore<span class="token punctuation">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>    callbackAfter<span class="token punctuation">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{ </span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre><p><code>myPlugin</code> should be changed to the name of your plugin. Any public methods (ones that can be accessed and used outside of the module wrapper) are added to this object, which is returned at the end of the script. No variables or functions can be accessed or used outside of your plugin unless they're explicitly added to the <code>myPlugin</code> object.</p><p>For example, <code>myPlugin.init()</code> will be used to initialize the plugin, and is accessible from other scripts, where as the <code>supports</code> variable cannot be.</p><h2 id="event-handler">Event Handler</h2><p>I pass any event listeners-clicks, scrolls, window resizing-through my <code>eventHandler</code> method.</p><pre class=" language-javascript"><code class=" language-javascript"><span class= "token comment" spellcheck="true">/** * Handle events * @private */</span><span class="token keyword">var</span> eventHandler <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>event<span class="token punctuation">)</span> <span class="token punctuation">{</span>   <span class="token comment" spellcheck="true"> // @todo Do something on event</span><span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre><p>You can put all sorts of login in here. For example, I like to put my click event listeners on the <code>document</code> element, and then check to see if the element that was clicked is one of the ones I care about. </p><pre class=" language-javascript"><code class=" language-javascript"><span class="token keyword">var</span> eventHandler <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>event<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">var </span> toggle <span class="token operator">=</span> buoy<span class="token punctuation">.</span><span class="token function">getClosest<span class="token punctuation">(</span></span>event <span class="token punctuation">.</span>target<span class="token punctuation">,</span> <span class="token string">'[data-example]'</span><span class="token punctuation">)</span><span class ="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span> toggle <span class="token punctuation">)</span> <span class="token punctuation">{</span>       <span class="token comment" spellcheck="true"> // Prevent default click event</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span> toggle<span class="token punctuation">.</span>tagName<span class="token punctuation">.</span><span class="token function">toLowerCase<span class="token punctuation">( </span></span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token string">'a'</span><span class="token punctuation">)</span> <span class= "token punctuation">{</span>            event<span class="token punctuation">.</span><span class="token function">preventDefault<span class="token punctuation">(</span></span><span class= "token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>       <span class="token comment" spellcheck="true"> // Run your methods</span>        myPlugin<span class="token punctuation">.</span><span class="token function">someMethod<span class="token punctuation">(</span></span><span class="token punctuation"> )</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre><p> If you want can pass all event types into a single handler, and use some logic to determine the course of action based on the event type.</p><pre class=" language-javascript"><code class= " language-javascript"><span class="token keyword">var</span> eventHandler <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation" >(</span>event<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span> event<span class="token punctuation">.</span>type <span class="token operator">===</span> <span class="token string">'scroll'</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>        myPlugin<span class="token punctuation">.</span><span class="token function">scrollMethod<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span> event<span class="token punctuation">.</span>type <span class="token operator">===</span> <span class="token string">'click'</span> <span class="token punctuation">)</span> <span class= "token punctuation">{</span>        myPlugin<span class="token punctuation">.</span><span class="token function">clickMethod<span class="token punctuation">(</span></span><span class= "token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">; </span></code></pre><h2 id="destroy-method">Destroy Method</h2><p>I like to provide a way to destroy the current initialization of a plugin. This is useful if you need to reinitialize for some reason, or if another script simply needs to halt whatever you've got going. As always, change <code>myPlugin</code> to the name of your plugin.</p><pre class=" language-javascript" ><code class=" language-javascript"><span class="token comment" spellcheck="true">/** * Destroy the current initialization. * @public */</span>myPlugin<span class="token punctuation">. </span>destroy <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>   <span class="token comment" spellcheck="true"> // If plugin isn't already initialized, stop</span>    <span class="token keyword">if</span> <span class ="token punctuation">(</span> <span class="token operator">!</span>settings <span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span>   <span class="token comment" spellcheck="true"> // Remove init class for conditional CSS</span>    document<span class="token punctuation">.</span>documentElement <span class="token punctuation">.</span>classList<span class="token punctuation">.</span><span class="token function">remove<span class="token punctuation">(</span></span> settings<span class="token punctuation">.</span>initClass <span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment" spellcheck="true"> // @todo Undo any other init functions...</span>   <span class="token comment" spellcheck="true"> // Remove event listeners</span>    document<span class="token punctuation">.</span><span class="token function">removeEventListener<span class="token punctuation">(</span></span><span class="token string">'click'</span><span class="token punctuation">,</span> eventHandler<span class= "token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment" spellcheck="true"> // Reset variables</span>    settings <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span><span class= "token punctuation">}</span><span class="token punctuation">;</span></code></pre><h2 id="initialize">Initialize</h2><p>While I sometimes write scripts that run on page load, I generally prefer a deliberate initialization. This allows developers to pass in their own settings that can override plugin defaults. It also lets developers include the script on every page as part of a concatenate file without actually running it on every page.</p><pre class=" language-javascript"><code class=" language-javascript"><span class="token comment" spellcheck="true"> /** * Initialize Plugin * @public * @param {Object} options User settings */</span>myPlugin<span class="token punctuation">.</span>init <span class="token operator">=</span> <span class= "token keyword">function</span> <span class="token punctuation">(</span> options <span class="token punctuation">)</span> <span class="token punctuation">{</span>   <span class="token comment" spellcheck="true"> // feature test</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token operator">!</span>supports <span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span>   <span class="token comment" spellcheck="true"> // Destroy any existing initializations</span>    myPlugin<span class="token punctuation">.</span><span class="token function">destroy<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment" spellcheck="true"> // Merge user options with defaults</span>    settings <span class="token operator">=</span> buoy<span class="token punctuation">.</span><span class="token function">extend<span class="token punctuation">(</span></span> defaults<span class="token punctuation">, </span> options <span class="token operator">||</span> <span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token punctuation">)</span><span class= "token punctuation">;</span>   <span class="token comment" spellcheck="true"> // Add class to HTML element to activate conditional CSS</span>    document<span class="token punctuation">. </span>documentElement<span class="token punctuation">.</span>classList<span class="token punctuation">.</span><span class="token function">add<span class="token punctuation">( </span></span> settings<span class="token punctuation">.</span>initClass <span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment" spellcheck="true"> // @todo Do stuff...</span>   <span class="token comment" spellcheck="true"> // Listen for click events</span>    document<span class="token punctuation">.</span><span class="token function">addEventListener<span class="token punctuation">(</span></span><span class="token string">'click'</span><span class="token punctuation">,</span> eventHandler<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">} </span><span class="token punctuation">;</span></code></pre><p>First, I run a check to make sure the required web and JavaScript APIs are supported. In my case, <code> document.querySelector</code> and <code>window.addEventListener</code> are the big ones. These are defined in the <code>supports</code> variable at the beginning of the script.</p><pre class=" language-javascript"><code class=" language-javascript"><span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token operator">!</span> supports <span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span></code></pre><p>Then, I destroy any existing initializations of the script to avoid conflicts or duplicate event listeners.</p><pre class=" language-javascript"><code class=" language-javascript">myPlugin<span class="token punctuation">.</span><span class="token function">destroy<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">; </span></code></pre><p>Next, I merge any user settings with the defaults using the <code>extend</code> method in Buoy.</p><pre class=" language-javascript"><code class=" language-javascript">settings <span class="token operator">=</span> buoy<span class="token punctuation">.</span><span class="token function">extend<span class="token punctuation">( </span></span> defaults<span class="token punctuation">,</span> options <span class="token operator">||</span> <span class="token punctuation">{</span><span class="token punctuation">} </span> <span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>A user would pass settings in like so:</p><pre class=" language-javascript"><code class=" language-javascript">myPlugin<span class="token punctuation">.</span><span class="token function">init<span class="token punctuation">(</span></span><span class="token punctuation" >{</span>    someVar<span class="token punctuation">:</span> <span class="token number">456</span><span class="token punctuation">,</span>    initClass<span class="token punctuation">: </span> <span class="token string">'js-changeme'</span><span class="token punctuation">,</span><span class="token punctuation">}</span><span class="token punctuation">) </span></code></pre><p>I'm a huge advocate of progressive enhancement, and I wait until my JavaScript plugin is initialized before using CSS to hide any content. As a result, I add a class to the <code>html</code> element that I can hook onto with my CSS after the script initializes.</p><pre class=" language-javascript"><code class=" language-javascript">document<span class="token punctuation">.</span>documentElement<span class="token punctuation">.</span>classList<span class="token punctuation">.</span><span class="token function">add<span class= "token punctuation">(</span></span> settings<span class="token punctuation">.</span>initClass <span class="token punctuation">)</span><span class="token punctuation">; </span></code></pre><p>Lastly, I create my event listeners.</p><pre class=" language-javascript"><code class=" language-javascript">document<span class="token punctuation">.</span><span class="token function">addEventListener<span class="token punctuation">(</span></span><span class="token string">'click'</span><span class="token punctuation">,</span> eventHandler<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>Any methods that should run as soon as the plugin initializes should also be called in <code>myPlugin.init()</code>.</p><h2 id="return-your-public-methods">Return your public methods</h2><p>The last thing in my plugins is a return with the <code>myPlugin</code> object. This let's developers run any of the public methods in the plugin by prefixing them with <code>myPlugin.</code>.</p><pre class=" language-javascript"><code class=" language-javascript"><span class="token keyword">return</span> myPlugin<span class="token punctuation">;</span></code></pre><h2 id="an-example"> An example</h2><p>Let's look at a simple example to see how this all works together.</p><p>I want to create a plugin called <code>clickMe.js</code> that adds a class to a link when the link is clicked. The class will vary from link to link, and not all links will trigger this behavior. We're going to use the <code>[data-click-me]</code> data attribute to identify links that should trigger the class-adding behavior. We'll also use this attribute to pass in the class that should be added.</p><p>When the browser is resized, I want to print a message in the console log. It will be same message every time. Here's how I would write this plugin.</p><pre class=" language-javascript"><code class=" language-javascript"><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span>root<span class="token punctuation">,</span> factory<span class="token punctuation" >)</span> <span class="token punctuation">{</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token keyword">typeof</span> define <span class="token operator">===</span> <span class="token string">'function'</span> <span class="token operator">&amp;&amp;</span> define<span class="token punctuation">.</span>amd <span class= "token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token function">define<span class="token punctuation">(</span></span><span class="token punctuation">[</span><span class="token string">'buoy'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token function">factory<span class="token punctuation">(</span></span>root<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token keyword">typeof</span> exports <span class="token operator">===</span> <span class="token string">'object'</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>        module <span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token function">factory<span class="token punctuation">(</span></span><span class="token function">require<span class="token punctuation">(</span></span><span class="token string">'buoy'</span><span class="token punctuation">)</span><span class="token punctuation">) </span><span class="token punctuation">;</span>    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>        root <span class="token punctuation">.</span>clickMe <span class="token operator">=</span> <span class="token function">factory<span class="token punctuation">(</span></span>root<span class= "token punctuation">,</span> root<span class="token punctuation">.</span>buoy<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token keyword">typeof</span> global <span class="token operator">!</span><span class="token operator">==</span> <span class="token string">'undefined'</span> <span class="token operator">?</span> global <span class= "token punctuation">:</span> this<span class="token punctuation">.</span>window <span class="token operator">||</span> this<span class="token punctuation">.</span>global<span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>root<span class="token punctuation">)</span> <span class="token punctuation">{ </span>    <span class="token string">'use strict'</span><span class="token punctuation">;</span>   <span class="token comment" spellcheck="true"> //</span>   <span class="token comment" spellcheck="true"> // Variables</span>   <span class="token comment" spellcheck="true"> //</span>    <span class="token keyword">var</span> clickMe <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true"> // Object for public APIs</span>    <span class="token keyword">var</span> supports <span class="token operator">=</span> <span class="token operator">!</span><span class="token operator">!</span>document<span class="token punctuation">.</span>querySelector <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span><span class="token operator">!</span>root<span class= "token punctuation">.</span>addEventListener<span class="token punctuation">;</span><span class="token comment" spellcheck="true"> // Feature test</span>    <span class="token keyword">var </span> settings<span class="token punctuation">;</span><span class="token comment" spellcheck="true"> // Placeholder variables</span>   <span class="token comment" spellcheck="true"> // Default settings</span>    <span class="token keyword">var</span> defaults <span class="token operator">=</span> <span class="token punctuation">{</span>        resizeLog<span class= "token punctuation">:</span> <span class="token string">'The window was resized!'</span><span class="token punctuation">,</span>        callbackBefore<span class="token punctuation">: </span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class= "token punctuation">}</span><span class="token punctuation">,</span>        callbackAfter<span class="token punctuation">:</span> <span class="token keyword">function</span> <span class= "token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>    <span class="token punctuation">} </span><span class="token punctuation">;</span>   <span class="token comment" spellcheck="true"> //</span>   <span class="token comment" spellcheck="true"> // Methods</span>   <span class= "token comment" spellcheck="true"> //</span>    <span class="token comment" spellcheck="true">/**     * Add a class to a link when it's clicked     * @private     * @param {Event} event The click event     */</span>    <span class="token keyword">var</span> addClass <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span> event <span class="token punctuation">)</span> <span class="token punctuation">{</span>       <span class="token comment" spellcheck="true"> // Get the thing that was clicked</span>        <span class="token keyword">var</span> toggle <span class="token operator">=</span> event<span class="token punctuation">.</span>target<span class="token punctuation">;</span>       <span class="token comment" spellcheck="true"> // Check if the thing that was clicked has the [data-click-me] attribute</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span> toggle <span class="token operator">&amp;&amp;</span> toggle<span class="token punctuation">.</span><span class="token function" >hasAttribute<span class="token punctuation">(</span></span> <span class="token string">'data-click-me'</span> <span class="token punctuation">)</span> <span class="token punctuation">) </span> <span class="token punctuation">{</span>           <span class="token comment" spellcheck="true"> // Prevent default click event</span>            <span class="token keyword">if </span> <span class="token punctuation">(</span> toggle<span class="token punctuation">.</span>tagName<span class="token punctuation">.</span><span class="token function">toLowerCase<span class="token punctuation">(</span></span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token string">'a'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                event<span class="token punctuation">.</span><span class="token function">preventDefault<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>           <span class= "token comment" spellcheck="true"> // Set the [data-click-me] value as a class on the link</span>            toggle<span class="token punctuation">.</span>classList<span class="token punctuation">.</span><span class="token function">add<span class="token punctuation">(</span></span> toggle<span class="token punctuation">.</span><span class="token function">getAttribute <span class="token punctuation">(</span></span> <span class="token string">'data-click-me'</span> <span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span><span class="token punctuation">;</span>    <span class= "token comment" spellcheck="true">/**     * Handle events     * @private     */</span>    <span class="token keyword">var</span> eventHandler <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>event<span class="token punctuation">)</span> <span class="token punctuation">{</span>       <span class= "token comment" spellcheck="true"> // Callback before the event handler runs</span>        settings<span class="token punctuation">.</span>callbackBefore<span class="token punctuation">; </span>       <span class="token comment" spellcheck="true"> // On click</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span> event<span class= "token punctuation">.</span>type <span class="token operator">===</span> <span class="token string">'click'</span> <span class="token punctuation">)</span> <span class="token punctuation"> {</span>            <span class="token function">addClass<span class="token punctuation">(</span></span> event <span class="token punctuation">)</span><span class="token punctuation">; </span>        <span class="token punctuation">}</span>       <span class="token comment" spellcheck="true"> // On resize</span>        <span class="token keyword">if</span> <span class= "token punctuation">(</span> event<span class="token punctuation">.</span>type <span class="token operator">===</span> <span class="token string">'resize'</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>            console<span class="token punctuation">.</span><span class="token function">log<span class="token punctuation">( </span></span> settings<span class="token punctuation">.</span>resizeLog <span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>       <span class="token comment" spellcheck="true"> // Callback after the event handler runs</span>        settings<span class="token punctuation">.</span> callbackAfter<span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true"> /**     * Destroy the current initialization.     * @public     */</span>    clickMe<span class="token punctuation">.</span>destroy <span class="token operator">=</span> <span class= "token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>       <span class="token comment" spellcheck="true"> // If plugin isn't already initialized, stop</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token operator">! </span>settings <span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span>       <span class="token comment" spellcheck= "true"> // Remove all added classes</span>        <span class="token keyword">var</span> links <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelectorAll<span class="token punctuation">(</span></span> <span class="token string">'[data-click-me]'</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span> <span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> len <span class="token operator">=</span> links<span class="token punctuation">.</span>length <span class="token punctuation">;</span> i <span class="token operator">&lt;</span> len<span class="token punctuation">;</span> i<span class="token operator">++</span>  <span class="token punctuation">)</span> <span class="token punctuation">{</span>            links<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>classList<span class="token punctuation">.</span><span class="token function">remove<span class="token punctuation">(</span></span> links<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getAttribute<span class="token punctuation">( </span></span> <span class="token string">'data-click-me'</span> <span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>       <span class="token comment" spellcheck="true"> // Remove event listeners</span>        document<span class="token punctuation">. </span><span class="token function">removeEventListener<span class="token punctuation">(</span></span><span class="token string">'click'</span><span class="token punctuation">,</span> eventHandler<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        window <span class="token punctuation">.</span><span class="token function">removeEventListener<span class="token punctuation">(</span></span><span class="token string">'resize'</span><span class ="token punctuation">,</span> eventHandler<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token comment" spellcheck="true"> // Reset variables</span>        settings <span class="token operator">=</span> <span class="token keyword">null </span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true"> /**     * Initialize Plugin     * @public     * @param {Object} options User settings     */</span>    clickMe<span class="token punctuation">.</span>init <span class="token operator">= </span> <span class="token keyword">function</span> <span class="token punctuation">(</span> options <span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment" spellcheck="true"> // feature test</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token operator">!</span>supports <span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span>       <span class="token comment" spellcheck="true"> // Destroy any existing initializations</span>        clickMe<span class="token punctuation">.</span><span class="token function">destroy<span class="token punctuation"> (</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token comment" spellcheck="true"> // Merge user options with defaults </span>        settings <span class="token operator">=</span> buoy<span class="token punctuation">.</span><span class="token function">extend<span class="token punctuation">(</span></span> defaults<span class="token punctuation">,</span> options <span class="token operator">||</span> <span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token comment" spellcheck="true"> // Listen for click events</span>        document<span class ="token punctuation">.</span><span class="token function">addEventListener<span class="token punctuation">(</span></span><span class="token string">'click'</span><span class="token punctuation">,</span> eventHandler<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">; </span>        window<span class="token punctuation">.</span><span class="token function">addEventListener<span class="token punctuation">(</span></span><span class="token string">'resize' </span><span class="token punctuation">,</span> eventHandler<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">;</span>   <span class="token comment" spellcheck="true"> //</span>   <span class="token comment" spellcheck="true"> // Public APIs</span>   <span class="token comment" spellcheck="true"> //</span>    <span class="token keyword">return</span> clickMe<span class= "token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre> <div class="clearfix padding-top padding-bottom"> <em>Enjoy this post? You might also like my <strong><a href="http://gomakethings.com/newsletter/">free weekly newsletter</a></strong>, a short email with a handful of things that didn't make it onto my site. <a href="http://gomakethings.com/newsletter/">Sign up&nbsp;here.</a></em></div> <h2 id="comments"> 2 Comments </h2> <p><a href= "#respond">Leave a comment</a> or contact me on Twitter at <a href="http://twitter.com/ChrisFerdinandi">@ChrisFerdinandi</a>.</p> <div id="comment-20236"> <hr class="line-secondary"> <article> <header class="margin-bottom-small clearfix"> <figure> <img alt="" src="http://1.gravatar.com/avatar/78ace0c17fb8df6db0f94250185cb04a?s=120&amp;d=mm&amp;r=g" srcset=" http://1.gravatar.com/avatar/78ace0c17fb8df6db0f94250185cb04a?s=240&amp;d=mm&amp;r=g 2x" class="avatar avatar-120 photo" height="120" width="120"> </figure> <h3 class="no-margin no-padding"> Vijay rudraraju </h3> <aside class="text-muted"> <time datetime="2015-07-01" pubdate="">July 1st, 2015</time> </aside> </header> <p>Thanks for sharing your code and providing a simple example to illustrate – now I get it!</p> </article> </div> <div id="comment-21007"> <hr class="line-secondary"> <article> <header class="margin-bottom-small clearfix"> <figure> <img alt="" src="http://2.gravatar.com/avatar/eb099df4cbf22c68c30498143e33269f?s=120&amp;d=mm&amp;r=g" srcset=" http://2.gravatar.com/avatar/eb099df4cbf22c68c30498143e33269f?s=240&amp;d=mm&amp;r=g 2x" class="avatar avatar-120 photo" height="120" width="120"> </figure> <h3 class="no-margin no-padding"> Arjan </h3> <aside class="text-muted"> <time datetime="2015-08-27" pubdate="">August 27th, 2015</time> </aside> </header> <p>This is great. Really good explanation on why you do certain things. Also, Buoy seems really handy and lightweight.</p> </article> </div> <div id="respond" class="comment-respond"> <h3 id="reply-title" class="comment-reply-title">Leave a Comment <small><a rel="nofollow" id="cancel-comment-reply-link" href="/the-anatomy-of-a-vanilla-javascript-plugin/#respond" style="display:none;">[Cancel]</a></small></h3> <form action=" http://gomakethings.com/wp-comments-post.php" method="post" id="commentform" class="comment-form"> <div class="row"><div class="grid-two-thirds"><label for= "6f30f49f44f0ac9ff5a080f9aaae5628">Name</label><input type="text" name="6f30f49f44f0ac9ff5a080f9aaae5628" id="6f30f49f44f0ac9ff5a080f9aaae5628" required=""></div></div><div class="row" ><div class="grid-two-thirds"><label for="87a095d1c0e1c445bf833656d79b9c6f">Email</label><input type="email" name="87a095d1c0e1c445bf833656d79b9c6f" id="87a095d1c0e1c445bf833656d79b9c6f" required=""></div></div><div class="row"><div class="grid-two-thirds"><label for="3633d4c4696380177351cd92ba428db9">Website (optional)</label><input type="url" name= "3633d4c4696380177351cd92ba428db9" id="3633d4c4696380177351cd92ba428db9"></div></div> <div class="tarpit"><label for="name">Name</label> <input type="text" name="name" id="name" ></div><div><textarea name="8a2fa30c0481c193e080cb119a6c1934" id="8a2fa30c0481c193e080cb119a6c1934" required=""></textarea><p>Share links, code and more with <a href=" http://en.support.wordpress.com/markdown-quick-reference/">Markdown</a>.</p></div> <p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="Submit Comment"> <input type="hidden" name="comment_post_ID" value="6301" id="comment_post_ID"><input type="hidden" name="comment_parent" id="comment_parent" value="0"></p><p ><input type= "hidden" id="akismet_comment_nonce" name="akismet_comment_nonce" value="d2eb510dab"></p><input type="hidden" name="enc-type" value="ZGZiMjA2MA=="><p class="comment-subscription-form" ><input type="checkbox" name="subscribe_comments" id="subscribe_comments" value="subscribe" style="width: auto; -moz-appearance: checkbox; -webkit-appearance: checkbox;"> <label class= "subscribe-label" id="subscribe-label" for="subscribe_comments">Notify me of follow-up comments by email.</label></p><p ></p> <input type="hidden" id="ak_js" name="ak_js" value= "1441893965572"></form> </div> </article>			</div>		<!--=========================			END : POST		=============================--> <!--=========================			START : POST		=============================-->		<div class="post-wrapper">		<h1 class="entry-title">Dating JavaScript: Getting to Know Functions</h1>		<div class="entry-content"><p>I've been dabbling with JavaScript for a while now but still don't have a solid grasp of the language.  In an attempt to level up and start writing better JS I plan to write posts about fundamental JavaScript concepts starting with Functions.</p><p>The style of these posts will be more like detailed notes than blog posts. Thus they probably won't be helpful if you don't know anything about JavaScript.  If that's the case I recommend starting with <a href=" http://www.codecademy.com/en/tracks/javascript">Codecademy's JS Track</a>.</p><p>Finally, before I dive into the basics of functions I need to give credit where credit is due.  For these posts, I'll be perpending the title with "Dating JavaScript".  Recently my coworker and mentor, <a href="https://twitter.com/daemonsy">Damon Aw</a>, did a short JS <a href=" https://github.com/daemonsy/dating_javascript">training</a>, with the same name. I think it's a great way to describe learning a new language, especially one as quirky as JavaScript and so... I'm stealing it.</p><h2>Why Start With Functions</h2><p>Functions are an extremely important and powerful part of the language, or as Douglas Crawford puts it in his book, <em> JavaScript: The Good Parts</em>, "Functions are the fundamental modular unit in JavaScript. They are used for code reuse, information hiding, and composition."</p><p>Or in the words of Nicholas C. Zakas in his book, <em>The Principles of Object-Oriented JavaScript</em>, "You need a good grasp of functions to understand how object- oriented programming works in JavaScript. Because JavaScript has no concept of a class, functions and other objects are all you have to work with to achieve aggregation and inheritance."</p><h2>Functions are Objects </h2><p>The first thing you need to be aware of is that functions are objects in Javascript and thus can be used like any other object in the language.  Meaning you can:</p><ul><li>Assign them to variables</li><li>Add them to objects as properties</li><li>Pass them to functions</li><li>Return them from functions</li></ul><h2>Anatomy of JavaScript Functions</h2><p><img src= "/images/js_function_anatomy.png" alt="JS Function Anatomy"></p><ol><li><strong>Function Keyword</strong> - this simply let's you know the object is a function.</li><li><strong>Function Name</strong> - a function name is optional.  If a function does not have a name, as is the case when using function expressions (see below), it's called an anonymous function. Function names can also be used by the function to call itself recursively and are used by debuggers and dev tools to ID the function.</li><li><strong>Function Parameters</strong> - parameters appear in between parenthesis and are separated by commas.  Once inside the function the parameters are stored as variables.</li><li><strong>Function Statement</strong> - a set of statements that make up the body of the function.</li></ol><h2>Two Forms of JavaScript Functions</h2><p>There are two forms of function literals that are very similar but differ in small but important ways.</p><h3>1. Function Declarations - Function keyword followed by the name</h3><figure class="code"><figcaption><span></span></figcaption><div class="highlight" ><table><tbody><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span><span class="line-number">2</span><span class="line-number">3</span><span class= "line-number">4</span><span class="line-number">5</span></pre></td><td class="code"><pre><code class="javascript"><span class="line"><span class="kd">function</span> <span class="nx"> sayFullName</span><span class="p">(</span><span class="nx">firstName</span><span class="p">,</span> <span class="nx">lastName</span><span class="p">)</span> <span class="p">{ </span></span><span class="line">  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">fisrstName</span> <span class= "o">+</span> <span class="s2">" "</span> <span class="o">+</span> <span class="nx">lastName</span><span class="p">);</span></span><span class="line"><span class="p">}</span></span><span class="line"></span><span class="line"><span class="nx">sayFullName</span><span class="p">(</span><span class="s2">"Kyle"</span><span class="p">,</span> <span class="s2">"Doherty" </span><span class="p">);</span> <span class="c1">// Kyle Doherty</span></span></code></pre></td></tr></tbody></table></div></figure><p><strong>Note:</strong> function declarations are hoisted to the top of the context, meaning it doesn't matter when the function is defined because the program knows about it as soon as it's ran. Read more about <a href=" http://bit.ly/1Ec0d5R">hoisting here</a> or watch the video below.</p><div class="flash-video"></div><h3>2. Function Expressions - sets the function to a variable and are not hoisted. </h3><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tbody><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1 </span><span class="line-number">2</span><span class="line-number">3</span><span class="line-number">4</span><span class="line-number">5</span></pre></td><td class="code"><pre><code class= "javascript"><span class="line"><span class="kd">var</span> <span class="nx">multiplication</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="err">﻿</span><span class="nx">x</span><span class="p">,</span><span class="nx">y</span><span class="p">)</span> <span class="p">{</span></span><span class="line">    <span class="nx" >x</span> <span class="o">*</span> <span class="nx">y</span></span><span class="line"><span class="p">};</span></span><span class="line"></span><span class="line"><span class="nx"> multiplication</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">);</span> <span class="c1">// 50 </span></span></code></pre></td></tr></tbody></table></div></figure><h2>Parameters</h2><p>Functions don't care how many parameters are passed to them. This means they won't throw an error regardless of how many params are sent.  However, while they don't care they do know how many params they're "able" to take through their length property.</p><figure class="code" ><figcaption><span></span></figcaption><div class="highlight"><table><tbody><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span><span class="line-number">2 </span><span class="line-number">3</span><span class="line-number">4</span><span class="line-number">5</span><span class="line-number">6</span><span class="line-number">7 </span></pre></td><td class="code"><pre><code class="javascript"><span class="line"><span class="kd">function</span> <span class="nx">oneArg</span><span class="p">(</span><span class="nx"> x</span><span class="p">)</span> <span class="p">{</span></span><span class="line">  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">( </span><span class="nx">x</span><span class="p">);</span></span><span class="line"><span class="p">}</span></span><span class="line"></span><span class="line"><span class="nx">console </span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">oneArg</span><span class="p">.</span><span class="nx">length</span><span class="p">); </span> <span class="c1">// 1</span></span><span class="line"><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx"> oneArg</span><span class="p">(</span><span class="s2">"Hi"</span><span class="p">));</span> <span class="c1">// Hi</span></span><span class="line"><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">oneArg</span><span class="p">(</span><span class="s2">"Hola"</span><span class="p">,</span> <span class="s2">"a second params"</span><span class="p">,</span> <span class="s2">"and a third"</span><span class="p">));</span> <span class="c1">// Hola </span></span></code></pre></td></tr></tbody></table></div></figure><p>Above you can see length returns 1 because this function only takes a single param.  Yet, if you pass in additional params no error occurs and the function simply ignores the extras.</p><h3>How Params are Stored</h3><p>The names of the params are stored as variables inside the function.  In addition to the parameters passed into the function it has two bonus parameters: <code>this</code> and <code>arguments</code>. <code>This</code> is beyond the scope of this post so don't worry about it now.  <code>Arguments</code> is an array like structure that contains all the parameters passed into the function.  Just like an array it can store any number of values that are referenced by indices (0, 1, 2, etc.), and has a length property stating how many values are present.</p><figure class="code"><figcaption><span></span></figcaption><div class="highlight" ><table><tbody><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span><span class="line-number">2</span><span class="line-number">3</span><span class= "line-number">4</span><span class="line-number">5</span><span class="line-number">6</span></pre></td><td class="code"><pre><code class="javascript"><span class="line"><span class="kd"> function</span> <span class="nx">noArgs</span><span class="p">()</span> <span class="p">{</span></span><span class="line">   <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">arguments</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span></span><span class="line"><span class="p">}</span></span><span class="line"></span><span class="line"><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class= "nx">noArgs</span><span class="p">.</span><span class="nx">length</span><span class="p">);</span>  <span class="c1">// 0</span></span><span class="line"><span class="nx">noArgs</span><span class="p">(</span><span class="s2">"hi"</span><span class="p">);</span>  <span class="c1">// hi</span></span></code></pre></td></tr></tbody></table></div></figure><p>In this example the function takes no params, but can still access any parameters passed into it through its <code>arguments</code> object.  Here it's accessing the first parameter in the <code>arguments </code> object in the same way you'd get the first element in an array.</p><p>This is sort of weird/confusing and thus generally not done. Normally you'd have a set number of params the function expects and only use those.</p><h2>Sometimes It's a Good Thing</h2><p>However, the ability to take any number of arguments can prove useful at times.</p><figure class="code" ><figcaption><span></span></figcaption><div class="highlight"><table><tbody><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span><span class="line-number">2 </span><span class="line-number">3</span><span class="line-number">4</span><span class="line-number">5</span><span class="line-number">6</span><span class="line-number">7</span><span class ="line-number">8</span><span class="line-number">9</span><span class="line-number">10</span><span class="line-number">11</span><span class="line-number">12</span><span class="line-number"> 13</span><span class="line-number">14</span><span class="line-number">15</span><span class="line-number">16</span><span class="line-number">17</span><span class="line-number">18 </span><span class="line-number">19</span><span class="line-number">20</span></pre></td><td class="code"><pre><code class="javascript"><span class="line"><span class="kd">function</span> <span class="nx">sum</span><span class="p">()</span> <span class="p">{</span></span><span class="line"></span><span class="line">  <span class="kd">var</span> <span class="nx">result </span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span></span><span class="line">      <span class="nx">i</span> <span class="o">=</span> <span class="mi">0 </span><span class="p">,</span></span><span class="line">      <span class="nx">length</span> <span class="o">=</span> <span class="nx">arguments</span><span class="p">.</span><span class= "nx">length</span></span><span class="line">      <span class="c1">// number of parameters sent in to the function</span></span><span class="line"></span><span class="line">  <span class= "k">while</span> <span class="p">(</span><span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">length</span><span class="p">)</span> <span class="p">{</span></span><span class="line">    <span class="nx">result</span> <span class="o">+=</span> <span class="nx">arguments</span><span class="p">[</span><span class="nx">i</span><span class="p">]; </span></span><span class="line">    <span class="nx">i</span><span class="o">++</span><span class="p">;</span></span><span class="line">  <span class="p">}</span></span><span class="line" ></span><span class="line">  <span class="k">return</span> <span class="nx">result</span><span class="p">;</span></span><span class="line"><span class="p">}</span></span><span class="line" ></span><span class="line"></span><span class="line"><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span> <span class="nx">sum </span><span class="p">());</span> <span class="c1">// 0</span></span><span class="line"><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">( </span> <span class="nx">sum</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">));</span> <span class="c1">// 4 </span></span><span class="line"><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span> <span class="nx">sum</span><span class="p">( </span><span class="mi">3</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">2 </span><span class="p">));</span> <span class="c1">// 25</span></span><span class="line"><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">( </span> <span class="nx">sum</span><span class="p">(</span><span class="mi">50</span><span class="p">));</span> <span class="c1">// 50 </span></span></code></pre></td></tr></tbody></table></div></figure><p>Using the arguments object and a while loop the function is able to sum all the parameters given to it regardless of how many are sent it.</p><h2>Function Overloading</h2><p>Function overloading is a concept in some OO languages where you can create two functions with the same name but different implementations.  The program would then choose which one to use based on the number of params that were sent to the function.</p><p>Since functions can accept any number of params you can't do this.  If you define two methods with the same name the one that was defined last effectively overwrites the first one you defined.</p><figure class="code" ><figcaption><span></span></figcaption><div class="highlight"><table><tbody><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span><span class="line-number">2 </span><span class="line-number">3</span><span class="line-number">4</span><span class="line-number">5</span><span class="line-number">6</span><span class="line-number">7</span><span class ="line-number">8</span><span class="line-number">9</span></pre></td><td class="code"><pre><code class="javascript"><span class="line"><span class="kd">function</span> <span class="nx"> sayHi</span><span class="p">()</span> <span class="p">{</span></span><span class="line">  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p"> (</span><span class="s2">"Hi"</span><span class="p">);</span></span><span class="line"><span class="p">}</span></span><span class="line"></span><span class="line"><span class="kd">function </span> <span class="nx">sayHi</span><span class="p">()</span> <span class="p">{</span></span><span class="line">  <span class="nx">console</span><span class="p">.</span><span class="nx"> log</span><span class="p">(</span><span class="s2">"Hello!"</span><span class="p">);</span></span><span class="line"><span class="p">}</span></span><span class="line"></span><span class= "line"><span class="nx">sayHi</span><span class="p">();</span>  <span class="c1">// Hello!</span></span></code></pre></td></tr></tbody></table></div></figure><p>Here you can see the second sayHi function overwrote the first one.</p><p>The way to mimic function overloading is to use conditionals to react differently depending on what params are sent to the function. </p><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tbody><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span><span class="line-number">2</span><span class="line-number">3</span><span class="line-number">4</span><span class="line-number">5</span><span class="line-number">6</span><span class= "line-number">7</span><span class="line-number">8</span><span class="line-number">9</span></pre></td><td class="code"><pre><code class="javascript"><span class="line"><span class="kd"> function</span> <span class="nx">saySomething</span><span class="p">(</span><span class="nx">stuff</span><span class="p">)</span> <span class="p">{</span></span><span class="line">  <span class="k">if</span> <span class="p">(</span><span class="nx">stuff</span> <span class="o">===</span> <span class="kc">undefined</span><span class="p">)</span> <span class="p">{ </span></span><span class="line">    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">"You didn't say anything!" </span><span class="p">);</span></span><span class="line">  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span></span><span class="line">    <span class="nx"> console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">stuff</span><span class="p">);</span></span><span class="line">  <span class="p">} </span></span><span class="line"><span class="p">}</span></span><span class="line"></span><span class="line"><span class="nx">saySomething</span><span class="p">();</span> <span class="c1" >// You didn't say anything!</span></span></code></pre></td></tr></tbody></table></div></figure><h2>Recommended Resources</h2><ul><li><a href="http://www.codecademy.com/en/tracks/jquery"> jQuery track</a> - Codecademy</li><li><a href="http://www.codecademy.com/en/tracks/javascript">JavaScript track</a> - Codecademy</li><li><a href=" http://www.amazon.com/dp/1593275404/?tag=webstu-20">The Principles of Object-Oriented JavaScript</a> by Nicholas C. Zakas</li><li><a href=" http://www.amazon.com/dp/0596517742/?tag=webstu-20">Javascript: The Good Parts</a> by Douglas Crawford</li></ul></div>			</div>		<!--=========================			END : POST		=============================-->		<!--=========================			START : POST		=============================-->		<div class="post-wrapper"> <article><nav>  <a href="04_data.html" title="previous chapter">◀</a>  <a href="index.html" title="cover">◆</a>  <a href="06_object.html" title="next chapter">▶</a></nav><h1><div class= "chap_num">Chapter 5</div>Higher-Order Functions</h1><blockquote><p><a class="p_ident" id="p_18CYJsdOxo" href="#p_18CYJsdOxo"></a>Tzu-li and Tzu-ssu wereboasting about the size of their latest programs. 'Two-hundredthousand lines,' said Tzu-li, 'not counting comments!' Tzu-ssuresponded, 'Pssh, mine is almost a <strong>million</strong> lines already.' MasterYuan-Ma said, 'My best program has five hundred lines.' Hearing this,Tzu-li and Tzu-ssu were enlightened.</p> <footer>Master Yuan-Ma, <cite>The Book of Programming </cite></footer></blockquote><blockquote><p><a class="p_ident" id="p_MZD8y19lPz" href="#p_MZD8y19lPz"></a>There are two ways of constructing a softwaredesign: One way is to make it so simple that there are obviously nodeficiencies, and the other way is to make it so complicated thatthere are no obvious deficiencies.</p> <footer>C.A.R. Hoare, <cite>1980 ACM Turing Award Lecture</cite></footer></blockquote><p><a class="p_ident" id="p_1SpKr5NIrc" href="#p_1SpKr5NIrc"></a>A large program is a costly program, and not justbecause of the time it takes to build. Size almost always involvescomplexity, and complexity confuses programmers. Confusedprogrammers, in turn, tend to introduce mistakes (<em>bugs</em>) intoprograms. A large program also provides a lot of space for these bugsto hide, making them hard to find.</p><p><a class="p_ident" id="p_ethH+CXxsM" href="#p_ethH+CXxsM"></a>Let's briefly go back to the final two exampleprograms in the introduction. The first is self-contained and sixlines long.</p><pre data-language="javascript" class="snippet cm-s-default"><div class="sandboxhint">edit &amp; run code by clicking it</div><a class="c_ident" id="c_W93KRCwXP0" href="#c_W93KRCwXP0"></a><span class="cm-keyword">var</span> <span class="cm-variable">total</span> <span class="cm-operator"> =</span> <span class="cm-number">0</span>, <span class="cm-variable">count</span> <span class="cm-operator">=</span> <span class="cm-number">1</span>;<span class="cm-keyword">while</span> (<span class="cm-variable">count</span> <span class="cm-operator">&lt;=</span> <span class="cm-number">10</span>) {  <span class="cm-variable">total</span> <span class="cm-operator">+= </span> <span class="cm-variable">count</span>;  <span class="cm-variable">count</span> <span class="cm-operator">+=</span> <span class="cm-number">1</span>;}<span class="cm-variable"> console</span>.<span class="cm-property">log</span>(<span class="cm-variable">total</span>);</pre><p><a class="p_ident" id="p_Sy8N6Qcb09" href="#p_Sy8N6Qcb09"></a>The second relies on two external functions and is one line long.</p><pre data-language="javascript" class="snippet cm-s-default"><a class="c_ident" id="c_OULOwD7HOm" href="#c_OULOwD7HOm"></a><span class= "cm-variable">console</span>.<span class="cm-property">log</span>(<span class="cm-variable">sum</span>(<span class="cm-variable">range</span>(<span class="cm-number">1</span>, <span class= "cm-number">10</span>)));</pre><p><a class="p_ident" id="p_srOi7846QY" href="#p_srOi7846QY"></a>Which one is more likely to contain a bug?</p><p><a class="p_ident" id="p_G+ApGqjOk4" href= "#p_G+ApGqjOk4"></a>If we count the size of the definitions of <code>sum</code> and<code>range</code>, the second program is also big-even bigger than the first.But still, I'd argue that it is more likely to be correct.</p><p><a class="p_ident" id="p_pkQRvZqQ0u" href="#p_pkQRvZqQ0u"></a>It is more likely tobe correct because the solution is expressed in a vocabulary thatcorresponds to the problem being solved. Summing a range ofnumbers isn't about loops and counters. It is about ranges and sums.</p><p><a class="p_ident" id="p_VwxmDNivhe" href= "#p_VwxmDNivhe"></a>The definitions of this vocabulary (the functions <code>sum</code> and <code>range</code>)will still involve loops, counters, and other incidental details. Butbecause they are expressing simpler concepts than the program as awhole, they are easier to get right.</p><h2><a class="h_ident" id="h_j9ps8qrlyo" href="#h_j9ps8qrlyo"></a>Abstraction</h2><p><a class="p_ident" id="p_ZPK6t/LrMG" href="#p_ZPK6t/LrMG"></a>In the context of programming, these kinds of vocabularies are usuallycalled <em>abstractions</em>. Abstractions hide details and give us theability to talk about problems at a higher (or more abstract) level.</p><p><a class="p_ident" id="p_XMbJPaIiI4" href="#p_XMbJPaIiI4"></a>As an analogy, compare these tworecipes for pea soup:</p><blockquote><p><a class="p_ident" id="p_F+PunfZCXq" href="#p_F+PunfZCXq"></a>Put 1 cup of dried peas per person into a container. Add water untilthe peas are well covered. Leave the peas in water for at least 12 hours.Take the peas out of the water and put them in a cooking pan. Add 4cups of water per person. Cover the pan and keep the peassimmering for two hours. Take half an onion per person. Cut it intopieces with a knife. Add it to the peas. Take a stalk of celery perperson. Cut it into pieces with a knife. Add it to the peas. Take acarrot per person. Cut it into pieces. With a knife! Add it to thepeas. Cook for 10 more minutes.</p></blockquote><p><a class="p_ident" id="p_jOZH7oGiYb" href= "#p_jOZH7oGiYb"></a>And the second recipe:</p><blockquote><p><a class="p_ident" id="p_iNBZReprTd" href="#p_iNBZReprTd"></a>Per person: 1 cup dried split peas, half a chopped onion, a stalk ofcelery, and a carrot.</p><p><a class="p_ident" id="p_k5rI5P5p5u" href="#p_k5rI5P5p5u"></a>Soak peas for 12 hours. Simmer for 2 hours in 4 cups of water(per person). Chop and add vegetables. Cook for 10 more minutes.</p></blockquote><p><a class="p_ident" id="p_cSeY164LbX" href="#p_cSeY164LbX"></a>The second is shorter and easier to interpret. Butyou do need to understand a few more cooking-related words-<em>soak</em>,<em>simmer</em>, <em>chop</em>, and, I guess, <em>vegetable</em>.</p><p><a class="p_ident" id="p_g/g3l7uyEG" href="#p_g/g3l7uyEG" ></a>When programming, we can't rely on all the words we need to be waitingfor us in the dictionary. Thus, you might fall into the pattern of thefirst recipe-work out the precise steps the computer has to perform,one by one, blind to the higher-level concepts that they express.</p><p><a class="p_ident" id="p_SfvOkDsRNZ" href="#p_SfvOkDsRNZ"></a>It has to become second nature, for a programmer, tonotice when a concept is begging to be abstracted into a new word.</p><h2><a class="h_ident" id="h_inPZJ813r4" href="#h_inPZJ813r4"></a>Abstracting array traversal</h2><p><a class="p_ident" id="p_kYV0l7wLUe" href="#p_kYV0l7wLUe"></a>Plain functions, as we've seen them so far, are a goodway to build abstractions. But sometimes they fall short.</p><p><a class="p_ident" id="p_zubh2XbQ26" href="#p_zubh2XbQ26"></a>In the <a href="04_data.html#data">previous chapter</a>, thistype of <code>for</code> loop made several appearances:</p><pre data-language="javascript" class="snippet cm-s-default"><a class="c_ident" id="c_LwyYCeYiUF" href="#c_LwyYCeYiUF"></a><span class="cm-keyword">var</span> <span class= "cm-variable">array</span> <span class="cm-operator">=</span> [<span class="cm-number">1</span>, <span class="cm-number">2</span>, <span class="cm-number">3</span>];<span class= "cm-keyword">for</span> (<span class="cm-keyword">var</span> <span class="cm-variable">i</span> <span class="cm-operator">=</span> <span class="cm-number">0</span>; <span class= "cm-variable">i</span> <span class="cm-operator">&lt;</span> <span class="cm-variable">array</span>.<span class="cm-property">length</span>; <span class="cm-variable">i</span><span class= "cm-operator">++</span>) {  <span class="cm-keyword">var</span> <span class="cm-variable">current</span> <span class="cm-operator">=</span> <span class="cm-variable">array</span>[<span class="cm-variable">i</span>];  <span class="cm-variable">console</span>.<span class="cm-property">log</span>(<span class="cm-variable">current</span>);}</pre><p><a class="p_ident" id= "p_NFtmq7O3su" href="#p_NFtmq7O3su"></a>It's trying to say, "Foreach element in the array, log it to the console". But it uses aroundabout way that involves a counter variable <code>i </code>, a check againstthe array's length, and an extra variable declaration to pick out thecurrent element. Apart from being a bit of an eyesore, this provides alot of space for potential mistakes. We might accidentally reuse the<code>i</code> variable, misspell <code>length</code> as <code>lenght</code>, confuse the <code>i</code> and <code>current</code> variables, and so on.</p><p><a class="p_ident" id="p_Ij8hUSNURG" href="#p_Ij8hUSNURG"></a>So let's try to abstract this into a function. Can you think of a way?</p><p><a class="p_ident" id ="p_QZzSQpGUXs" href="#p_QZzSQpGUXs"></a>Well, it's easy to write a function that goes over an array and calls<code>console.log</code> on every element.</p><pre data-language="javascript" class="snippet cm-s-default"><a class="c_ident" id="c_zrjk1tE+gJ" href="#c_zrjk1tE+gJ"></a><span class="cm-keyword">function</span> <span class="cm-variable">logEach</span>(<span class= "cm-def">array</span>) {  <span class="cm-keyword">for</span> (<span class="cm-keyword">var</span> <span class="cm-def">i</span> <span class="cm-operator">=</span> <span class="cm-number"> 0</span>; <span class="cm-variable-2">i</span> <span class="cm-operator">&lt;</span> <span class="cm-variable-2">array</span>.<span class="cm-property">length</span>; <span class= "cm-variable-2">i</span><span class="cm-operator">++</span>)    <span class="cm-variable">console</span>.<span class="cm-property">log</span>(<span class="cm-variable-2">array</span>[<span class="cm-variable-2">i</span>]);}</pre><p id="forEach"><a class="p_ident" id="p_q8hNTrfIYb" href="#p_q8hNTrfIYb"></a>But whatif we want to do something other than logging the elements? Since"doing something" can be represented as a function and functions arejust values, we can pass our action as a function value.</p><pre data-language="javascript" class="snippet cm-s-default"><a class="c_ident" id="c_on8vSTDMIU" href="#c_on8vSTDMIU"></a><span class="cm-keyword">function</span> <span class="cm-variable">forEach</span>(<span class="cm-def">array </span>, <span class="cm-def">action</span>) {  <span class="cm-keyword">for</span> (<span class="cm-keyword">var</span> <span class="cm-def">i</span> <span class="cm-operator">=</span> <span class="cm-number">0</span>; <span class="cm-variable-2">i</span> <span class="cm-operator">&lt;</span> <span class="cm-variable-2">array</span>.<span class="cm-property">length </span>; <span class="cm-variable-2">i</span><span class="cm-operator">++</span>)    <span class="cm-variable-2">action</span>(<span class="cm-variable-2">array</span>[<span class= "cm-variable-2">i</span>]);}<span class="cm-variable">forEach</span>([<span class="cm-string">"Wampeter"</span>, <span class="cm-string">"Foma"</span>, <span class="cm-string"> "Granfalloon"</span>], <span class="cm-variable">console</span>.<span class="cm-property">log</span>);<span class="cm-comment">// → Wampeter</span><span class="cm-comment">// → Foma </span><span class="cm-comment">// → Granfalloon</span></pre><p><a class="p_ident" id="p_gLkhZ+aBcQ" href="#p_gLkhZ+aBcQ"></a>(In some browsers, calling <code>console.log</code> in this way does not work.You can use <code>alert</code> instead of <code>console.log</code> if this example fails towork.)</p><p><a class="p_ident" id="p_TXDEyQXjy/" href="#p_TXDEyQXjy/"></a> Often, you don't pass a predefined function to <code>forEach</code> but createa function value on the spot instead.</p><pre data-language="javascript" class="snippet cm-s-default"><a class ="c_ident" id="c_wRpVmSHeqP" href="#c_wRpVmSHeqP"></a><span class="cm-keyword">var</span> <span class="cm-variable">numbers</span> <span class="cm-operator">=</span> [<span class= "cm-number">1</span>, <span class="cm-number">2</span>, <span class="cm-number">3</span>, <span class="cm-number">4</span>, <span class="cm-number">5</span>], <span class="cm-variable">sum </span> <span class="cm-operator">=</span> <span class="cm-number">0</span>;<span class="cm-variable">forEach</span>(<span class="cm-variable">numbers</span>, <span class="cm-keyword"> function</span>(<span class="cm-def">number</span>) {  <span class="cm-variable">sum</span> <span class="cm-operator">+=</span> <span class="cm-variable-2">number</span>;});<span class= "cm-variable">console</span>.<span class="cm-property">log</span>(<span class="cm-variable">sum</span>);<span class="cm-comment">// → 15</span></pre><p><a class="p_ident" id="p_v2REJFVWCD" href="#p_v2REJFVWCD"></a>This looks quite a lot like theclassical <code>for</code> loop, with its body written as a block below it.However, now the body is inside the function value, as well asinside the parentheses of the call to <code>forEach</code>. This is why ithas to be closed with the closing brace <em>and</em> closing parenthesis.</p><p><a class="p_ident" id= "p_u1F6T5TuZI" href="#p_u1F6T5TuZI"></a>Using this pattern, we canspecify a variable name for the current element (<code>number</code>), ratherthan having to pick it out of the array manually.</p><p><a class="p_ident" id="p_w5leJJdYGK" href="#p_w5leJJdYGK"></a>In fact, we don't need to write <code>forEach</code>ourselves. It is available as a standard method on arrays. Since thearray is already provided as the thing the method acts on, <code>forEach</code>takes only one required argument: the function to be executed for eachelement.</p><p><a class="p_ident" id="p_BbxEeZ0Pmw" href="#p_BbxEeZ0Pmw"></a>To illustrate how helpful this is, let's look back at a functionfrom <a href="04_data.html#analysis">the previous chapter</a>. It contains twoarray-traversing loops.</p><pre data-language="javascript" class="snippet cm-s-default"><a class="c_ident" id="c_1CXbGUgiP6" href="#c_1CXbGUgiP6"></a><span class= "cm-keyword">function</span> <span class="cm-variable">gatherCorrelations</span>(<span class="cm-def">journal</span>) {  <span class="cm-keyword">var</span> <span class="cm-def">phis </span> <span class="cm-operator">=</span> {};  <span class="cm-keyword">for</span> (<span class="cm-keyword">var</span> <span class="cm-def">entry</span> <span class="cm-operator">= </span> <span class="cm-number">0</span>; <span class="cm-variable-2">entry</span> <span class="cm-operator">&lt;</span> <span class="cm-variable-2">journal</span>.<span class= "cm-property">length</span>; <span class="cm-variable-2">entry</span><span class="cm-operator">++</span>) {    <span class="cm-keyword">var</span> <span class="cm-def">events</span> <span class="cm-operator">=</span> <span class="cm-variable-2">journal</span>[<span class="cm-variable-2">entry</span>].<span class="cm-property">events</span>;    <span class="cm-keyword">for </span> (<span class="cm-keyword">var</span> <span class="cm-def">i</span> <span class="cm-operator">=</span> <span class="cm-number">0</span>; <span class="cm-variable-2">i</span> <span class="cm-operator">&lt;</span> <span class="cm-variable-2">events</span>.<span class="cm-property">length</span>; <span class="cm-variable-2">i</span><span class="cm-operator">++</span>) {      <span class="cm-keyword">var</span> <span class="cm-def">event</span> <span class="cm-operator">=</span> <span class="cm-variable-2">events</span>[<span class="cm-variable-2">i </span>];      <span class="cm-keyword">if</span> (<span class="cm-operator">!</span>(<span class="cm-variable-2">event</span> <span class="cm-keyword">in</span> <span class= "cm-variable-2">phis</span>))        <span class="cm-variable-2">phis</span>[<span class="cm-variable-2">event</span>] <span class="cm-operator">=</span> <span class="cm-variable">phi </span>(<span class="cm-variable">tableFor</span>(<span class="cm-variable-2">event</span>, <span class="cm-variable-2">journal</span>));    }  }  <span class="cm-keyword">return</span> <span class="cm-variable-2">phis</span>;}</pre><p><a class="p_ident" id="p_CGf69rc/Yq" href="#p_CGf69rc/Yq"></a>Working with <code>forEach</code> makes it slightly shorterand quite a bit cleaner.</p><pre data-language="javascript" class="snippet cm-s-default"><a class="c_ident" id="c_gIY8Dk2DPY" href="#c_gIY8Dk2DPY"></a><span class="cm-keyword">function</span> <span class= "cm-variable">gatherCorrelations</span>(<span class="cm-def">journal</span>) {  <span class="cm-keyword">var</span> <span class="cm-def">phis</span> <span class="cm-operator">=</span> {};  <span class="cm-variable-2">journal</span>.<span class="cm-property">forEach</span>(<span class="cm-keyword">function</span>(<span class="cm-def">entry</span>) {    <span class= "cm-variable-2">entry</span>.<span class="cm-property">events</span>.<span class="cm-property">forEach</span>(<span class="cm-keyword">function</span>(<span class="cm-def">event</span>) {      <span class="cm-keyword">if</span> (<span class="cm-operator">!</span>(<span class="cm-variable-2">event</span> <span class="cm-keyword">in</span> <span class="cm-variable-2">phis </span>))        <span class="cm-variable-2">phis</span>[<span class="cm-variable-2">event</span>] <span class="cm-operator">=</span> <span class="cm-variable">phi</span>(<span class= "cm-variable">tableFor</span>(<span class="cm-variable-2">event</span>, <span class="cm-variable-2">journal</span>));    });  });  <span class="cm-keyword">return</span> <span class= "cm-variable-2">phis</span>;}</pre><h2><a class="h_ident" id="h_xxCc98lOBK" href="#h_xxCc98lOBK"></a>Higher-order functions</h2><p><a class="p_ident" id="p_cao2fH68Tj" href="#p_cao2fH68Tj" ></a>Functions thatoperate on other functions, either by taking them as arguments or byreturning them, are called <em>higher-order functions</em>. If you havealready accepted the fact that functions are regular values, there isnothing particularly remarkable about the fact that such functionsexist. The term comes from mathematics, where the distinctionbetween functions and other values is taken more seriously.</p><p><a class="p_ident" id="p_+cgNTV2i2y" href="#p_+cgNTV2i2y"></a>Higher-order functions allow us to abstract over<em>actions</em>, not just values. They come in several forms. For example,you can have functions that create new functions.</p><pre data-language="javascript" class="snippet cm-s-default"><a class="c_ident" id= "c_9JAVbcWLFt" href="#c_9JAVbcWLFt"></a><span class="cm-keyword">function</span> <span class="cm-variable">greaterThan</span>(<span class="cm-def">n</span>) {  <span class="cm-keyword"> return</span> <span class="cm-keyword">function</span>(<span class="cm-def">m</span>) { <span class="cm-keyword">return</span> <span class="cm-variable-2">m</span> <span class= "cm-operator">&gt;</span> <span class="cm-variable-2">n</span>; };}<span class="cm-keyword">var</span> <span class="cm-variable">greaterThan10</span> <span class="cm-operator">=</span> <span class="cm-variable">greaterThan</span>(<span class="cm-number">10</span>);<span class="cm-variable">console</span>.<span class="cm-property">log</span>(<span class="cm-variable"> greaterThan10</span>(<span class="cm-number">11</span>));<span class="cm-comment">// → true</span></pre><p><a class="p_ident" id="p_MKDSIQ0X9D" href="#p_MKDSIQ0X9D"></a>And you can have functions that change other functions.</p><pre data-language="javascript" class="snippet cm-s-default"><a class="c_ident" id="c_JVArXJ1Pc1" href="#c_JVArXJ1Pc1"></a><span class= "cm-keyword">function</span> <span class="cm-variable">noisy</span>(<span class="cm-def">f</span>) {  <span class="cm-keyword">return</span> <span class="cm-keyword">function</span>(<span class="cm-def">arg</span>) {    <span class="cm-variable">console</span>.<span class="cm-property">log</span>(<span class="cm-string">"calling with"</span>, <span class="cm-variable-2">arg </span>);    <span class="cm-keyword">var</span> <span class="cm-def">val</span> <span class="cm-operator">=</span> <span class="cm-variable-2">f</span>(<span class="cm-variable-2">arg </span>);    <span class="cm-variable">console</span>.<span class="cm-property">log</span>(<span class="cm-string">"called with"</span>, <span class="cm-variable-2">arg</span>, <span class ="cm-string">"- got"</span>, <span class="cm-variable-2">val</span>);    <span class="cm-keyword">return</span> <span class="cm-variable-2">val</span>;  };}<span class="cm-variable">noisy </span>(<span class="cm-variable">Boolean</span>)(<span class="cm-number">0</span>);<span class="cm-comment">// → calling with 0</span><span class="cm-comment">// → called with 0 - got false</span></pre><p><a class="p_ident" id="p_2qBy/XBHVa" href="#p_2qBy/XBHVa"></a>You can even write functions that provide new types of control flow.</p><pre data-language="javascript" class="snippet cm-s-default"><a class="c_ident" id="c_IiJsXvslVu" href="#c_IiJsXvslVu"></a><span class="cm-keyword">function</span> <span class="cm-variable">unless</span>(<span class= "cm-def">test</span>, <span class="cm-def">then</span>) {  <span class="cm-keyword">if</span> (<span class="cm-operator">!</span><span class="cm-variable-2">test</span>) <span class= "cm-variable-2">then</span>();}<span class="cm-keyword">function</span> <span class="cm-variable">repeat</span>(<span class="cm-def">times</span>, <span class="cm-def">body</span>) { <span class="cm-keyword">for</span> (<span class="cm-keyword">var</span> <span class="cm-def">i</span> <span class="cm-operator">=</span> <span class="cm-number">0</span>; <span class= "cm-variable-2">i</span> <span class="cm-operator">&lt;</span> <span class="cm-variable-2">times</span>; <span class="cm-variable-2">i</span><span class="cm-operator">++</span>) <span class="cm-variable-2">body</span>(<span class="cm-variable-2">i</span>);}<span class="cm-variable">repeat</span>(<span class="cm-number">3</span>, <span class="cm-keyword">function</span>( <span class="cm-def">n</span>) {  <span class="cm-variable">unless</span>(<span class="cm-variable-2">n</span> <span class="cm-operator">%</span> <span class="cm-number">2</span>, <span class="cm-keyword">function</span>() {    <span class="cm-variable">console</span>.<span class="cm-property">log</span>(<span class="cm-variable-2">n</span>, <span class="cm-string">"is even"</span>);  });});<span class="cm-comment">// → 0 is even</span><span class="cm-comment">// → 2 is even</span></pre><p><a class="p_ident" id="p_i6rGSdWQvz" href="#p_i6rGSdWQvz"></a> The lexical scopingrules that we discussed in <a href="03_functions.html#scoping">Chapter 3</a>work to our advantage when using functions in this way. In the previous example, the <code>n </code> variable is a parameter to the outer function.Because the inner function lives inside the environment of the outerone, it can use <code>n</code>. The bodies of such inner functions can access thevariables around them. They can play a role similar to the <code>{}</code> blocksused in regular loops and conditional statements. An importantdifference is that variables declared inside inner functions do notend up in the environment of the outer function. And that is usually agood thing.</p><h2><a class="h_ident" id="h_7/X8BSjdvi" href= "#h_7/X8BSjdvi"></a>Passing along arguments</h2><p><a class="p_ident" id="p_IYAO9/PwTt" href="#p_IYAO9/PwTt"></a>The <code>noisy</code> functiondefined earlier, which wraps its argument in another function, has a ratherserious deficit.</p><pre data-language="javascript" class="snippet cm-s-default"><a class="c_ident" id="c_9Deoi4g6M/" href="#c_9Deoi4g6M/"></a><span class= "cm-keyword">function</span> <span class="cm-variable">noisy</span>(<span class="cm-def">f</span>) {  <span class="cm-keyword">return</span> <span class="cm-keyword">function</span>(<span class="cm-def">arg</span>) {    <span class="cm-variable">console</span>.<span class="cm-property">log</span>(<span class="cm-string">"calling with"</span>, <span class="cm-variable-2">arg </span>);    <span class="cm-keyword">var</span> <span class="cm-def">val</span> <span class="cm-operator">=</span> <span class="cm-variable-2">f</span>(<span class="cm-variable-2">arg </span>);    <span class="cm-variable">console</span>.<span class="cm-property">log</span>(<span class="cm-string">"called with"</span>, <span class="cm-variable-2">arg</span>, <span class ="cm-string">"- got"</span>, <span class="cm-variable-2">val</span>);    <span class="cm-keyword">return</span> <span class="cm-variable-2">val</span>;  };}</pre><p><a class="p_ident" id= "p_xa/8T14jAc" href="#p_xa/8T14jAc"></a>If <code>f</code> takes more than one parameter, it gets only the first one.We could add a bunch of arguments to the inner function (<code>arg1 </code>,<code>arg2</code>, and so on) and pass them all to <code>f</code>, but it is not clear how manywould be enough. This solution would also deprive <code>f</code> of theinformation in <code>arguments.length</code>. Since we'd always pass the samenumber of arguments, it wouldn't know how many arguments wereoriginally given.</p><p><a class="p_ident" id="p_d8oC4azbX1" href="#p_d8oC4azbX1"></a>Forthese kinds of situations, JavaScript functions have an <code>apply</code>method. You pass it an array (or array-like object) of arguments, andit will call the function with those arguments.</p><pre data-language="javascript" class="snippet cm-s-default"><a class="c_ident" id="c_OwePsf3FVa" href="#c_OwePsf3FVa"></a><span class="cm-keyword"> function</span> <span class="cm-variable">transparentWrapping</span>(<span class="cm-def">f</span>) {  <span class="cm-keyword">return</span> <span class="cm-keyword">function</span>() {    <span class="cm-keyword">return</span> <span class="cm-variable-2">f</span>.<span class="cm-property">apply</span>(<span class="cm-atom">null</span>, <span class="cm-variable-2"> arguments</span>);  };}</pre><p><a class="p_ident" id="p_DzgFx1ko9R" href="#p_DzgFx1ko9R"></a>That's a useless function, but it shows the pattern we areinterested in-the function it returns passes all of the givenarguments, and only those arguments, to <code>f</code>. It does this by passingits own <code>arguments</code> object to <code>apply</code>. The first argument to <code>apply</code>,for which we are passing <code>null</code> here, can be used to simulate amethod call. We will come back to that in the<a href="06_object.html#call_method"> next chapter</a>.</p><h2><a class="h_ident" id="h_AxpOdvCznQ" href="#h_AxpOdvCznQ"></a>JSON</h2><p><a class="p_ident" id="p_A2VaNOTR7R" href="#p_A2VaNOTR7R"></a>Higher-order functions that somehow apply a function to theelements of an array are widely used in JavaScript. The <code>forEach</code>method is the most primitive such function. There are a number ofother variants available as methods on arrays. To familiarizeourselves with them, let's play around with another data set.</p><p><a class="p_ident" id="p_U8cxfiInkI" href="#p_U8cxfiInkI"></a>A few years ago, someone crawled through a lotof archives and put together a book on the history of my family name(Haverbeke-meaning Oatbrook). I opened it hoping to findknights, pirates, and alchemists ... but the book turns out to bemostly full of Flemish farmers. For my amusement, I extracted theinformation on my direct ancestors and put it into acomputer-readable format.</p><p><a class="p_ident" id="p_kyOqr/Ovkw" href="#p_kyOqr/Ovkw"></a>The file I created looks something likethis:</p><pre data-language="application/json" class="snippet cm-s-default"><a class="c_ident" id="c_ndJ1dhsRpC" href="#c_ndJ1dhsRpC"></a>[  {<span class="cm-string cm-property">"name"</span>: <span class="cm-string">"Emma de Milliano"</span>, <span class="cm-string cm-property">"sex"</span>: <span class="cm-string">"f"</span>,   <span class="cm-string cm-property">"born"</span>: <span class="cm-number">1876</span>, <span class= "cm-string cm-property">"died"</span>: <span class="cm-number">1956</span>,   <span class="cm-string cm-property">"father"</span>: <span class="cm-string">"Petrus de Milliano"</span>, <span class="cm-string cm-property">"mother"</span>: <span class="cm-string">"Sophia van Damme"</span>},  {<span class="cm-string cm-property">"name"</span>: <span class="cm-string"> "Carolus Haverbeke"</span>, <span class="cm-string cm-property">"sex"</span>: <span class="cm-string">"m"</span>,   <span class="cm-string cm-property">"born"</span>: <span class= "cm-number">1832</span>, <span class="cm-string cm-property">"died"</span>: <span class="cm-number">1905</span>,   <span class="cm-string cm-property">"father"</span>: <span class= "cm-string">"Carel Haverbeke"</span>,   <span class="cm-string cm-property">"mother"</span>: <span class="cm-string">"Maria van Brussel"</span>},  <span class="cm-variable">...</span> <span class="cm-variable">and</span> <span class="cm-variable">so</span> <span class="cm-variable">on</span>]</pre><p><a class="p_ident" id="p_TtSCtpw/XN" href="#p_TtSCtpw/XN"></a>This format is called JSON (pronounced "Jason"),which stands for JavaScript Object Notation. It is widely used as adata storage and communication format on the Web.</p><p><a class="p_ident" id= "p_LkHACkXND1" href="#p_LkHACkXND1"></a>JSON is similar toJavaScript's way of writing arrays and objects, with a fewrestrictions. All property names have to be surrounded by double quotes, andonly simple data expressions are allowed-no function calls,variables, or anything that involves actual computation. Comments are notallowed in JSON.</p><p><a class="p_ident" id= "p_1IU60Zh2Af" href="#p_1IU60Zh2Af"></a>JavaScriptgives us functions, <code>JSON.stringify</code> and <code>JSON.parse</code>, that convertdata from and to this format. The first takes a JavaScript value andreturns a JSON-encoded string. The second takes such a string andconverts it to the value it encodes.</p><pre data-language="javascript" class="snippet cm-s-default"><a class="c_ident" id="c_mzHhvmUWat" href="#c_mzHhvmUWat"></a><span class="cm-keyword">var</span> <span class="cm-variable">string</span> <span class="cm-operator">=</span> <span class= "cm-variable">JSON</span>.<span class="cm-property">stringify</span>({<span class="cm-property">name</span>: <span class="cm-string">"X"</span>, <span class="cm-property">born</span>: <span class="cm-number">1980</span>});<span class="cm-variable">console</span>.<span class="cm-property">log</span>(<span class="cm-variable">string</span>);<span class="cm-comment">// → {"name":"X","born":1980}</span><span class="cm-variable">console</span>.<span class="cm-property">log</span>(<span class="cm-variable">JSON</span>.<span class="cm-property">parse</span>( <span class="cm-variable">string</span>).<span class="cm-property">born</span>);<span class="cm-comment">// → 1980</span></pre><p><a class="p_ident" id="p_NDrk0od6QR" href="#p_NDrk0od6QR" ></a>The variable <code>ANCESTRY_FILE</code>, available inthe sandbox for this chapter and in<a href="http://eloquentjavascript.net/code/ancestry.js">a downloadable file</a> onthe website, contains thecontent of my JSON file as a string. Let's decode it and see howmany people it contains.</p><pre data-language="javascript" class="snippet cm-s-default"><a class= "c_ident" id="c_iIU5d+0x1R" href="#c_iIU5d+0x1R"></a><span class="cm-keyword">var</span> <span class="cm-variable">ancestry</span> <span class="cm-operator">=</span> <span class= "cm-variable">JSON</span>.<span class="cm-property">parse</span>(<span class="cm-variable">ANCESTRY_FILE</span>);<span class="cm-variable">console</span>.<span class="cm-property">log </span>(<span class="cm-variable">ancestry</span>.<span class="cm-property">length</span>);<span class="cm-comment">// → 39</span></pre><h2><a class="h_ident" id="h_1BJbwiI0gI" href= "#h_1BJbwiI0gI"></a>Filtering an array</h2><p><a class="p_ident" id="p_Vpf83lHLbL" href="#p_Vpf83lHLbL"></a>To findthe people in the ancestry data set who were young in 1924, thefollowing function might be helpful. It filters out the elements in anarray that don't pass a test.</p><pre data-language="javascript" class="snippet cm-s-default"><a class="c_ident" id= "c_VcGTxSYgrf" href="#c_VcGTxSYgrf"></a><span class="cm-keyword">function</span> <span class="cm-variable">filter</span>(<span class="cm-def">array</span>, <span class="cm-def">test</span> ) {  <span class="cm-keyword">var</span> <span class="cm-def">passed</span> <span class="cm-operator">=</span> [];  <span class="cm-keyword">for</span> (<span class="cm-keyword">var</span> <span class="cm-def">i</span> <span class="cm-operator">=</span> <span class="cm-number">0</span>; <span class="cm-variable-2">i</span> <span class="cm-operator">&lt;</span> <span class= "cm-variable-2">array</span>.<span class="cm-property">length</span>; <span class="cm-variable-2">i</span><span class="cm-operator">++</span>) {    <span class="cm-keyword">if</span> ( <span class="cm-variable-2">test</span>(<span class="cm-variable-2">array</span>[<span class="cm-variable-2">i</span>]))      <span class="cm-variable-2">passed</span>.<span class= "cm-property">push</span>(<span class="cm-variable-2">array</span>[<span class="cm-variable-2">i</span>]);  }  <span class="cm-keyword">return</span> <span class="cm-variable-2">passed </span>;}<span class="cm-variable">console</span>.<span class="cm-property">log</span>(<span class="cm-variable">filter</span>(<span class="cm-variable">ancestry</span>, <span class= "cm-keyword">function</span>(<span class="cm-def">person</span>) {  <span class="cm-keyword">return</span> <span class="cm-variable-2">person</span>.<span class="cm-property">born</span> <span class="cm-operator">&gt;</span> <span class="cm-number">1900</span> <span class="cm-operator">&amp;&amp;</span> <span class="cm-variable-2">person</span>.<span class="cm-property"> born</span> <span class="cm-operator">&lt;</span> <span class="cm-number">1925</span>;}));<span class="cm-comment">// → [{name: "Philibert Haverbeke", ...}, ...]</span></pre><p><a class= "p_ident" id="p_F1sdIqvMdQ" href="#p_F1sdIqvMdQ"></a>This uses theargument named <code>test</code>, a function value, to fill in a "gap" in thecomputation. The <code>test</code> function is called for each element, and itsreturn value determines whether an element is included in the returnedarray.</p><p><a class="p_ident" id="p_l78Pj0p/pD" href="#p_l78Pj0p/pD"></a>Three people in the file were alive and young in1924: my grandfather, grandmother, and great-aunt.</p><p><a class="p_ident" id="p_vcnUQxte/7" href="#p_vcnUQxte/7"></a>Note how the<code>filter </code> function, rather than deleting elements from the existingarray, builds up a new array with only the elements that pass thetest. This function is <em>pure</em>. It does not modify the array it isgiven.</p><p><a class="p_ident" id="p_OduOippCCU" href="#p_OduOippCCU"></a>Like <code>forEach</code>, <code>filter</code> is also a standard method on arrays. Theexample defined the function only in order to show what it doesinternally. From now on, we'll use it like this instead:</p><pre data-language="javascript" class="snippet cm-s-default"><a class= "c_ident" id="c_V5IGmt9uTK" href="#c_V5IGmt9uTK"></a><span class="cm-variable">console</span>.<span class="cm-property">log</span>(<span class="cm-variable">ancestry</span>.<span class= "cm-property">filter</span>(<span class="cm-keyword">function</span>(<span class="cm-def">person</span>) {  <span class="cm-keyword">return</span> <span class="cm-variable-2">person</span> .<span class="cm-property">father</span> <span class="cm-operator">==</span> <span class="cm-string">"Carel Haverbeke"</span>;}));<span class="cm-comment">// → [{name: "Carolus Haverbeke", ...}]</span></pre><h2><a class="h_ident" id="h_lJEtQ+qjXz" href="#h_lJEtQ+qjXz"></a>Transforming with map</h2><p><a class="p_ident" id="p_iZsa8JAje9" href="#p_iZsa8JAje9"></a> Say wehave an array of objects representing people, produced by filteringthe <code>ancestry</code> array somehow. But we want an array of names, which iseasier to read.</p><p><a class= "p_ident" id="p_/HoP3C1P28" href="#p_/HoP3C1P28"></a>The <code>map</code> method transforms an array byapplying a function to all of its elements and building a new arrayfrom the returned values. The new array will have the same length asthe input array, but its content will have been "mapped" to a new formby the function.</p><pre data-language="javascript" class="snippet cm-s-default"><a class="c_ident" id="c_Oc5rRWigBO" href="#c_Oc5rRWigBO"></a><span class="cm-keyword">function</span> <span class="cm-variable">map</span>(<span class="cm-def">array</span> , <span class="cm-def">transform</span>) {  <span class="cm-keyword">var</span> <span class="cm-def">mapped</span> <span class="cm-operator">=</span> [];  <span class="cm-keyword">for </span> (<span class="cm-keyword">var</span> <span class="cm-def">i</span> <span class="cm-operator">=</span> <span class="cm-number">0</span>; <span class="cm-variable-2">i</span> <span class="cm-operator">&lt;</span> <span class="cm-variable-2">array</span>.<span class="cm-property">length</span>; <span class="cm-variable-2">i</span><span class="cm-operator">++</span> )    <span class="cm-variable-2">mapped</span>.<span class="cm-property">push</span>(<span class="cm-variable-2">transform</span>(<span class="cm-variable-2">array</span>[<span class= "cm-variable-2">i</span>]));  <span class="cm-keyword">return</span> <span class="cm-variable-2">mapped</span>;}<span class="cm-keyword">var</span> <span class="cm-variable">overNinety </span> <span class="cm-operator">=</span> <span class="cm-variable">ancestry</span>.<span class="cm-property">filter</span>(<span class="cm-keyword">function</span>(<span class="cm-def"> person</span>) {  <span class="cm-keyword">return</span> <span class="cm-variable-2">person</span>.<span class="cm-property">died</span> <span class="cm-operator">-</span> <span class= "cm-variable-2">person</span>.<span class="cm-property">born</span> <span class="cm-operator">&gt;</span> <span class="cm-number">90</span>;});<span class="cm-variable">console</span>. <span class="cm-property">log</span>(<span class="cm-variable">map</span>(<span class="cm-variable">overNinety</span>, <span class="cm-keyword">function</span>(<span class="cm-def">person </span>) {  <span class="cm-keyword">return</span> <span class="cm-variable-2">person</span>.<span class="cm-property">name</span>;}));<span class="cm-comment">// → ["Clara Aernoudts", "Emile Haverbeke",</span><span class="cm-comment">//    "Maria Haverbeke"]</span></pre><p><a class="p_ident" id="p_Jd3axE7OGU" href="#p_Jd3axE7OGU"></a>Interestingly, the people who lived to at least 90 years of age are thesame three people who we saw before-the people who were young in the1920s, which happens to be the most recent generation in my data set.I guess medicine has come a long way.</p><p><a class="p_ident" id="p_kz8fxQbtBm" href="#p_kz8fxQbtBm"></a>Like <code>forEach</code> and <code>filter</code>, <code>map</code> is also a standard method onarrays.</p><h2><a class="h_ident" id="h_fx3e34kT/k" href="#h_fx3e34kT/k"></a>Summarizing with reduce</h2><p><a class="p_ident" id="p_jc3nW2aN35" href="#p_jc3nW2aN35"></a>Another common pattern of computation on arrays is computinga single value from them. Our recurring example, summing a collectionof numbers, is an instance of this. Another example would be findingthe person with the earliest year of birth in the data set.</p><p><a class="p_ident" id="p_AR3Kp1oBC4" href="#p_AR3Kp1oBC4"></a>The higher-orderoperation that represents this pattern is called <em>reduce</em> (orsometimes <em>fold</em>). You can think of it as folding up the array, oneelement at a time. When summing numbers, you'd start with the numberzero and, for each element, combine it with the current sum by addingthe two.</p><p><a class="p_ident" id="p_2+GsHstzgE" href="#p_2+GsHstzgE"></a>The parameters to the <code>reduce</code> function are, apart from the array, acombining function and a start value. This function is a little lessstraightforward than <code>filter</code> and <code>map</code>, so pay careful attention.</p><pre data-language="javascript" class="snippet cm-s-default"><a class="c_ident" id="c_0Tuk2O6cyM" href="#c_0Tuk2O6cyM"></a><span class="cm-keyword">function</span> <span class="cm-variable">reduce</span>(<span class="cm-def">array</span>, <span class="cm-def">combine</span>, <span class="cm-def">start</span>) {  <span class="cm-keyword">var</span> <span class="cm-def">current</span> <span class="cm-operator">=</span> <span class="cm-variable-2">start</span>;  <span class="cm-keyword">for</span> (<span class="cm-keyword">var</span> <span class="cm-def">i</span> <span class="cm-operator">=</span> <span class="cm-number">0</span>; <span class="cm-variable-2">i</span> <span class="cm-operator">&lt;</span> <span class= "cm-variable-2">array</span>.<span class="cm-property">length</span>; <span class="cm-variable-2">i</span><span class="cm-operator">++</span>)    <span class="cm-variable-2">current</span> <span class="cm-operator">=</span> <span class="cm-variable-2">combine</span>(<span class="cm-variable-2">current</span>, <span class="cm-variable-2">array</span>[<span class= "cm-variable-2">i</span>]);  <span class="cm-keyword">return</span> <span class="cm-variable-2">current</span>;}<span class="cm-variable">console</span>.<span class="cm-property">log </span>(<span class="cm-variable">reduce</span>([<span class="cm-number">1</span>, <span class="cm-number">2</span>, <span class="cm-number">3</span>, <span class="cm-number">4</span>], <span class="cm-keyword">function</span>(<span class="cm-def">a</span>, <span class="cm-def">b</span>) {  <span class="cm-keyword">return</span> <span class="cm-variable-2">a</span> <span class="cm-operator">+</span> <span class="cm-variable-2">b</span>;}, <span class="cm-number">0</span>));<span class="cm-comment">// → 10</span></pre><p><a class="p_ident" id="p_r9cFmJJTar" href="#p_r9cFmJJTar"></a>The standard array method <code>reduce</code>, which of coursecorresponds to this function, has an added convenience. If your arraycontains at least one element, you are allowed to leave off the<code>start</code> argument. The method will take the first element of the arrayas its start value and start reducing at the second element.</p><p><a class= "p_ident" id="p_I1pmLx5OiJ" href="#p_I1pmLx5OiJ"></a>To use <code>reduce</code> to find my mostancient known ancestor, we can write something like this:</p><pre data-language="javascript" class="snippet cm-s-default"><a class="c_ident" id="c_yFx+CUT9gj" href="#c_yFx+CUT9gj"></a><span class="cm-variable">console</span>.<span class="cm-property">log</span>(<span class= "cm-variable">ancestry</span>.<span class="cm-property">reduce</span>(<span class="cm-keyword">function</span>(<span class="cm-def">min</span>, <span class="cm-def">cur</span>) {  <span class="cm-keyword">if</span> (<span class="cm-variable-2">cur</span>.<span class="cm-property">born</span> <span class="cm-operator">&lt;</span> <span class="cm-variable-2">min</span>. <span class="cm-property">born</span>) <span class="cm-keyword">return</span> <span class="cm-variable-2">cur</span>;  <span class="cm-keyword">else</span> <span class="cm-keyword">return </span> <span class="cm-variable-2">min</span>;}));<span class="cm-comment">// → {name: "Pauwels van Haverbeke", born: 1535, ...}</span></pre><h2><a class="h_ident" id="h_+NeFt8aXxf" href= "#h_+NeFt8aXxf"></a>Composability</h2><p><a class="p_ident" id="p_UHvCjnmGjM" href="#p_UHvCjnmGjM"></a>Consider how we wouldhave written the previous example (finding the person with theearliest year of birth) without higher-order functions. The code isnot that much worse.</p><pre data-language="javascript" class="snippet cm-s-default"><a class="c_ident" id= "c_ZzCa/ILXHh" href="#c_ZzCa/ILXHh"></a><span class="cm-keyword">var</span> <span class="cm-variable">min</span> <span class="cm-operator">=</span> <span class="cm-variable">ancestry </span>[<span class="cm-number">0</span>];<span class="cm-keyword">for</span> (<span class="cm-keyword">var</span> <span class="cm-variable">i</span> <span class="cm-operator">=</span> <span class="cm-number">1</span>; <span class="cm-variable">i</span> <span class="cm-operator">&lt;</span> <span class="cm-variable">ancestry</span>.<span class="cm-property">length</span> ; <span class="cm-variable">i</span><span class="cm-operator">++</span>) {  <span class="cm-keyword">var</span> <span class="cm-variable">cur</span> <span class="cm-operator">=</span> <span class="cm-variable">ancestry</span>[<span class="cm-variable">i</span>];  <span class="cm-keyword">if</span> (<span class="cm-variable">cur</span>.<span class="cm-property">born </span> <span class="cm-operator">&lt;</span> <span class="cm-variable">min</span>.<span class="cm-property">born</span>)    <span class="cm-variable">min</span> <span class="cm-operator"> =</span> <span class="cm-variable">cur</span>;}<span class="cm-variable">console</span>.<span class="cm-property">log</span>(<span class="cm-variable">min</span>);<span class="cm-comment"> // → {name: "Pauwels van Haverbeke", born: 1535, ...}</span></pre><p><a class="p_ident" id="p_EbeznYJOvD" href="#p_EbeznYJOvD"></a>There are a few more variables, and the program is two lineslonger but still quite easy to understand.</p><p id="average_function"><a class="p_ident" id="p_a0FspsuDHF" href="#p_a0FspsuDHF"></a>Higher-orderfunctions start to shine when you need to <em>compose</em> functions. As anexample, let's write code that finds the average age for men and forwomen in the data set.</p><pre data-language="javascript" class="snippet cm-s-default"><a class="c_ident" id="c_uqgWfWbd7m" href="#c_uqgWfWbd7m"></a><span class="cm-keyword">function</span> <span class="cm-variable">average</span>(<span class="cm-def">array </span>) {  <span class="cm-keyword">function</span> <span class="cm-def">plus</span>(<span class="cm-def">a</span>, <span class="cm-def">b</span>) { <span class="cm-keyword">return</span> <span class="cm-variable-2">a</span> <span class="cm-operator">+</span> <span class="cm-variable-2">b</span>; }  <span class="cm-keyword">return</span> <span class="cm-variable-2">array </span>.<span class="cm-property">reduce</span>(<span class="cm-variable-2">plus</span>) <span class="cm-operator">/</span> <span class="cm-variable-2">array</span>.<span class= "cm-property">length</span>;}<span class="cm-keyword">function</span> <span class="cm-variable">age</span>(<span class="cm-def">p</span>) { <span class="cm-keyword">return</span> <span class="cm-variable-2">p</span>.<span class="cm-property">died</span> <span class="cm-operator">-</span> <span class="cm-variable-2">p</span>.<span class="cm-property">born</span>; }<span class="cm-keyword">function</span> <span class="cm-variable">male</span>(<span class="cm-def">p</span>) { <span class="cm-keyword">return</span> <span class="cm-variable-2">p</span>.<span class="cm-property">sex</span> <span class="cm-operator">==</span> <span class="cm-string">"m"</span>; }<span class="cm-keyword">function</span> <span class="cm-variable">female</span>( <span class="cm-def">p</span>) { <span class="cm-keyword">return</span> <span class="cm-variable-2">p</span>.<span class="cm-property">sex</span> <span class="cm-operator">==</span> <span class="cm-string">"f"</span>; }<span class="cm-variable">console</span>.<span class="cm-property">log</span>(<span class="cm-variable">average</span>(<span class="cm-variable">ancestry </span>.<span class="cm-property">filter</span>(<span class="cm-variable">male</span>).<span class="cm-property">map</span>(<span class="cm-variable">age</span>)));<span class="cm-comment" >// → 61.67</span><span class="cm-variable">console</span>.<span class="cm-property">log</span>(<span class="cm-variable">average</span>(<span class="cm-variable">ancestry</span>.<span class="cm-property">filter</span>(<span class="cm-variable">female</span>).<span class="cm-property">map</span>(<span class="cm-variable">age</span>)));<span class="cm-comment">// → 54.56 </span></pre><p><a class="p_ident" id="p_Tnj4SDSgBt" href="#p_Tnj4SDSgBt"></a>(It's a bitsilly that we have to define <code>plus</code> as a function, but operators inJavaScript, unlike functions, are not values, so you can't pass themas arguments.)</p><p><a class="p_ident" id="p_vIaMNOYUL0" href="#p_vIaMNOYUL0"></a>Instead of tangling the logic into abig loop, it is neatly composed into the concepts we areinterested in-determining sex, computing age, and averaging numbers. Wecan apply these one by one to get the result we are looking for.</p><p><a class="p_ident" id="p_ZOp8f8zApw" href="#p_ZOp8f8zApw"></a>This is <em>fabulous</em> for writing clear code. Unfortunately, this claritycomes at a cost.</p><h2><a class="h_ident" id= "h_KTy9HpX3R4" href="#h_KTy9HpX3R4"></a>The cost</h2><p><a class="p_ident" id="p_ROxex88LkV" href="#p_ROxex88LkV"></a>In the happy land of elegant codeand pretty rainbows, there lives a spoil-sport monster called<em>inefficiency</em>.</p><p><a class="p_ident" id="p_KZv3u+lncm" href="#p_KZv3u+lncm"></a>A program that processes an array is mostelegantly expressed as a sequence of cleanly separated steps that eachdo something with the array and produce a new array. But building upall those intermediate arrays is somewhat expensive.</p><p><a class= "p_ident" id="p_fwEhp/GEHu" href="#p_fwEhp/GEHu"></a>Likewise, passing a function to<code>forEach</code> and letting that method handle the array iteration for us isconvenient and easy to read. But function calls in JavaScript arecostly compared to simple loop bodies.</p><p><a class="p_ident" id="p_QCCz0cq1ti" href="#p_QCCz0cq1ti"></a>And so it goes with a lot of techniques that helpimprove the clarity of a program. Abstractions add layers between theraw things the computer is doing and the concepts we are working withand thus cause the machine to perform more work. This is not an ironlaw-there are programming languages that have better support forbuilding abstractions without adding inefficiencies, and even inJavaScript, an experienced programmer can find ways to write abstractcode that is still fast. But it is a problem that comes up a lot.</p><p><a class="p_ident" id="p_8YtdVmu3Oc" href="#p_8YtdVmu3Oc"></a> Fortunately, most computers are insanely fast. If youare processing a modest set of data or doing something that hasto happen only on a human time scale (say, every time the user clicks abutton), then it <em>does not matter</em> whether you wrote a pretty solutionthat takes half a millisecond or a super-optimized solution that takesa tenth of a millisecond.</p><p><a class ="p_ident" id="p_s9R2GjExxl" href="#p_s9R2GjExxl"></a>It is helpful toroughly keep track of how often a piece of your program is going torun. If you have a loop inside a loop (either directly or throughthe outer loop calling a function that ends up performing the innerloop), the code inside the inner loop will end up running <em>N</em>×<em>M</em>times, where <em>N</em> is the number of times the outer loop repeats and<em>M</em> is the number of times the inner loop repeats within each iterationof the outer loop. If that inner loop contains another loop that makes<em>P</em> rounds, its body will run <em>M</em>×<em>N</em>×<em>P</em> times, and so on. Thiscan add up to large numbers, and when a program is slow, the problemcan often be traced to only a small part of the code, which sits inside an inner loop.</p><h2><a class="h_ident" id="h_XnMZS4zMW6" href="#h_XnMZS4zMW6"></a>Great-great-great-great-...</h2><p><a class= "p_ident" id="p_Typ91CWfYn" href="#p_Typ91CWfYn"></a>My grandfather, Philibert Haverbeke, isincluded in the data file. By starting with him, I can trace mylineage to find out whether the most ancient person in the data,Pauwels van Haverbeke, is my direct ancestor. And if he is, I wouldlike to know how much DNA I theoretically share with him.</p><p><a class="p_ident" id= "p_pwQeT587/V" href="#p_pwQeT587/V"></a>To be able to go from a parent's name to the actual object thatrepresents this person, we first build up an object that associatesnames with people. </p><pre data-language="javascript" class="snippet cm-s-default"><a class="c_ident" id="c_/p8Gq6iabK" href="#c_/p8Gq6iabK"></a><span class="cm-keyword">var</span> <span class="cm-variable" >byName</span> <span class="cm-operator">=</span> {};<span class="cm-variable">ancestry</span>.<span class="cm-property">forEach</span>(<span class="cm-keyword">function</span>(<span class ="cm-def">person</span>) {  <span class="cm-variable">byName</span>[<span class="cm-variable-2">person</span>.<span class="cm-property">name</span>] <span class="cm-operator">=</span> <span class="cm-variable-2">person</span>;});<span class="cm-variable">console</span>.<span class="cm-property">log</span>(<span class="cm-variable">byName</span>[<span class="cm-string"> "Philibert Haverbeke"</span>]);<span class="cm-comment">// → {name: "Philibert Haverbeke", ...}</span></pre><p><a class="p_ident" id="p_Yko1+UXeBG" href="#p_Yko1+UXeBG"></a>Now, the problem is not entirely as simple as following the <code>father</code>properties and counting how many we need to reach Pauwels. There areseveral cases in the family tree where people married their secondcousins (tiny villages and all that). This causes the branches of thefamily tree to rejoin in a few places, which means I share more than1/2<sup><em>G</em></sup> of my genes with this person, where <em>G</em> for the number ofgenerations between Pauwels and me. This formula comes from the ideathat each generation splits the gene pool in two.</p><p><a class="p_ident" id="p_qznNjPi9uB" href="#p_qznNjPi9uB"></a>A reasonable way to think aboutthis problem is to look at it as being analogous to <code>reduce</code>, whichcondenses an array to a single value by repeatedly combiningvalues, left to right. In this case, we also want to condense our datastructure to a single value but in a way that follows familylines. The <em> shape</em> of the data is that of a family tree, rather than aflat list.</p><p><a class="p_ident" id="p_1De08sAcOD" href="#p_1De08sAcOD"></a>The way we want to reduce this shape is by computing a value for agiven person by combining values from their ancestors. This can bedone recursively: if we are interested in person <em>A</em>, we have tocompute the values for <em>A </em>'s parents, which in turn requires us tocompute the value for <em>A</em>'s grandparents, and so on. In principle,that'd require us to look at an infinite number of people, but sinceour data set is finite, we have to stop somewhere. We'll allow adefault value to be given to our reduction function, which will beused for people who are not in the data. In our case, that value issimply zero, on the assumption that people not in the list don't shareDNA with the ancestor we are looking at.</p><p><a class="p_ident" id="p_B0sEhVOeSP" href= "#p_B0sEhVOeSP"></a>Given a person, afunction to combine values from the two parents of a given person, anda default value, <code>reduceAncestors</code> condenses a value from a familytree.</p><pre data-language="javascript" class="snippet cm-s-default"><a class="c_ident" id="c_FR1ZA75xXV" href="#c_FR1ZA75xXV"></a><span class="cm-keyword">function</span> <span class="cm-variable">reduceAncestors</span>(<span class="cm-def">person</span>, <span class="cm-def">f</span>, <span class="cm-def">defaultValue</span>) {  <span class="cm-keyword">function </span> <span class="cm-def">valueFor</span>(<span class="cm-def">person</span>) {    <span class="cm-keyword">if</span> (<span class="cm-variable-2">person</span> <span class= "cm-operator">==</span> <span class="cm-atom">null</span>)      <span class="cm-keyword">return</span> <span class="cm-variable-2">defaultValue</span>;    <span class="cm-keyword">else </span>      <span class="cm-keyword">return</span> <span class="cm-variable-2">f</span>(<span class="cm-variable-2">person</span>, <span class="cm-variable-2">valueFor</span>(<span class= "cm-variable">byName</span>[<span class="cm-variable-2">person</span>.<span class="cm-property">mother</span>]),                       <span class="cm-variable-2">valueFor</span>(<span class="cm-variable">byName</span>[<span class="cm-variable-2">person</span>.<span class="cm-property">father</span>]));  }  <span class="cm-keyword">return</span> <span class= "cm-variable-2">valueFor</span>(<span class="cm-variable-2">person</span>);}</pre><p><a class="p_ident" id="p_HK0Nr6MiCM" href="#p_HK0Nr6MiCM"></a>The inner function (<code>valueFor</code> ) handles asingle person. Through the magic of recursion, it can simply callitself to handle the father and the mother of this person. Theresults, along with the person object itself, are passed to <code>f</code>, whichreturns the actual value for this person.</p><p><a class="p_ident" id="p_2Q4JEt3Fiv" href="#p_2Q4JEt3Fiv"></a>We can then use this to compute the amount of DNA mygrandfather shared with Pauwels van Haverbeke and divide that byfour.</p><pre data-language="javascript" class="snippet cm-s-default"><a class="c_ident" id="c_DKCt/KZuIB" href= "#c_DKCt/KZuIB"></a><span class="cm-keyword">function</span> <span class="cm-variable">sharedDNA</span>(<span class="cm-def">person</span>, <span class="cm-def">fromMother</span>, <span class="cm-def">fromFather</span>) {  <span class="cm-keyword">if</span> (<span class="cm-variable-2">person</span>.<span class="cm-property">name</span> <span class="cm-operator">==</span> <span class="cm-string">"Pauwels van Haverbeke"</span>)    <span class="cm-keyword">return</span> <span class="cm-number">1</span>;  <span class="cm-keyword">else</span>    <span class= "cm-keyword">return</span> (<span class="cm-variable-2">fromMother</span> <span class="cm-operator">+</span> <span class="cm-variable-2">fromFather</span>) <span class="cm-operator">/ </span> <span class="cm-number">2</span>;}<span class="cm-keyword">var</span> <span class="cm-variable">ph</span> <span class="cm-operator">=</span> <span class="cm-variable">byName</span> [<span class="cm-string">"Philibert Haverbeke"</span>];<span class="cm-variable">console</span>.<span class="cm-property">log</span>(<span class="cm-variable">reduceAncestors</span>(<span class="cm-variable">ph</span>, <span class="cm-variable">sharedDNA</span>, <span class="cm-number">0</span>) <span class="cm-operator">/</span> <span class="cm-number">4</span>);<span class="cm-comment">// → 0.00049</span></pre><p><a class="p_ident" id="p_+kx1i84Abe" href="#p_+kx1i84Abe"></a>The person with the name Pauwels van Haverbeke obviously shared 100 percentof his DNA with Pauwels van Haverbeke (there are no people who sharenames in the data set), so the function returns 1 for him. All otherpeople share the average of the amounts that their parents share.</p><p><a class="p_ident" id="p_sxFDHiagLr" href="#p_sxFDHiagLr"></a>So, statistically speaking, I share about 0.05 percent of my DNA withthis 16th-century person. It should be noted that this is only astatistical approximation, not an exact amount. It is a rather smallnumber, but given how much genetic material we carry (about 3 billionbase pairs), there's still probably some aspect in the biologicalmachine that is me that originates with Pauwels.</p><p><a class="p_ident" id="p_9W8GK5HRM6" href="#p_9W8GK5HRM6"></a>We could also have computed this numberwithout relying on <code>reduceAncestors</code>. But separating the generalapproach (condensing a family tree) from the specific case (computingshared DNA) can improve the clarity of the code and allows us to reusethe abstract part of the program for other cases. For example, thefollowing code finds the percentage of a person's known ancestors wholived past 70 (by lineage, so people may be counted multiple times):</p><pre data-language="javascript" class="snippet cm-s-default"><a class="c_ident" id="c_8JFA4YEKi4" href="#c_8JFA4YEKi4" ></a><span class="cm-keyword">function</span> <span class="cm-variable">countAncestors</span>(<span class="cm-def">person</span>, <span class="cm-def">test</span>) {  <span class= "cm-keyword">function</span> <span class="cm-def">combine</span>(<span class="cm-def">current</span>, <span class="cm-def">fromMother</span>, <span class="cm-def">fromFather</span>) { <span class="cm-keyword">var</span> <span class="cm-def">thisOneCounts</span> <span class="cm-operator">=</span> <span class="cm-variable-2">current</span> <span class="cm-operator">!= </span> <span class="cm-variable-2">person</span> <span class="cm-operator">&amp;&amp;</span> <span class="cm-variable-2">test</span>(<span class="cm-variable-2">current</span>);    <span class="cm-keyword">return</span> <span class="cm-variable-2">fromMother</span> <span class="cm-operator">+</span> <span class="cm-variable-2">fromFather</span> <span class="cm-operator">+ </span> (<span class="cm-variable-2">thisOneCounts</span> <span class="cm-operator">?</span> <span class="cm-number">1</span> : <span class="cm-number">0</span>);  }  <span class= "cm-keyword">return</span> <span class="cm-variable">reduceAncestors</span>(<span class="cm-variable-2">person</span>, <span class="cm-variable-2">combine</span>, <span class="cm-number">0 </span>);}<span class="cm-keyword">function</span> <span class="cm-variable">longLivingPercentage</span>(<span class="cm-def">person</span>) {  <span class="cm-keyword">var</span> <span class="cm-def">all</span> <span class="cm-operator">=</span> <span class="cm-variable">countAncestors</span>(<span class="cm-variable-2">person</span>, <span class="cm-keyword">function </span>(<span class="cm-def">person</span>) {    <span class="cm-keyword">return</span> <span class="cm-atom">true</span>;  });  <span class="cm-keyword">var</span> <span class="cm-def"> longLiving</span> <span class="cm-operator">=</span> <span class="cm-variable">countAncestors</span>(<span class="cm-variable-2">person</span>, <span class="cm-keyword">function</span>( <span class="cm-def">person</span>) {    <span class="cm-keyword">return</span> (<span class="cm-variable-2">person</span>.<span class="cm-property">died</span> <span class="cm-operator">- </span> <span class="cm-variable-2">person</span>.<span class="cm-property">born</span>) <span class="cm-operator">&gt;=</span> <span class="cm-number">70</span>;  });  <span class= "cm-keyword">return</span> <span class="cm-variable-2">longLiving</span> <span class="cm-operator">/</span> <span class="cm-variable-2">all</span>;}<span class="cm-variable">console</span> .<span class="cm-property">log</span>(<span class="cm-variable">longLivingPercentage</span>(<span class="cm-variable">byName</span>[<span class="cm-string">"Emile Haverbeke"</span>])); <span class="cm-comment">// → 0.129</span></pre><p><a class="p_ident" id="p_yX3KPrQkep" href="#p_yX3KPrQkep"></a>Such numbers are not to be taken too seriously, given thatour data set contains a rather arbitrary collection of people. But thecode illustrates the fact that <code>reduceAncestors</code> gives us a usefulpiece of vocabulary for working with the family tree datastructure.</p><h2><a class="h_ident" id="h_fwBD5oTMLl" href="#h_fwBD5oTMLl"></a>Binding</h2><p><a class="p_ident" id="p_JR92h9ZvcR" href="#p_JR92h9ZvcR"></a>The <code>bind</code> method, which allfunctions have, creates a new function that will call the originalfunction but with some of the arguments already fixed.</p><p><a class="p_ident" id="p_RpFvD2j6a4" href= "#p_RpFvD2j6a4"></a>The following code shows anexample of <code>bind</code> in use. It defines a function <code>isInSet</code> thattells us whether a person is in a given set of strings. To call<code>filter</code> in order to collect those person objects whose names are in aspecific set, we can either write a function expression that makes acall to <code>isInSet</code> with our set as its first argument or <em>partiallyapply</em> the <code>isInSet</code> function.</p><pre data-language="javascript" class="snippet cm-s-default"><a class="c_ident" id= "c_P/KGz4FBMo" href="#c_P/KGz4FBMo"></a><span class="cm-keyword">var</span> <span class="cm-variable">theSet</span> <span class="cm-operator">=</span> [<span class="cm-string">"Carel Haverbeke"</span>, <span class="cm-string">"Maria van Brussel"</span>,              <span class="cm-string">"Donald Duck"</span>];<span class="cm-keyword">function</span> <span class= "cm-variable">isInSet</span>(<span class="cm-def">set</span>, <span class="cm-def">person</span>) {  <span class="cm-keyword">return</span> <span class="cm-variable-2">set</span>.<span class="cm-property">indexOf</span>(<span class="cm-variable-2">person</span>.<span class="cm-property">name</span>) <span class="cm-operator">&gt;</span> <span class="cm-operator">- </span><span class="cm-number">1</span>;}<span class="cm-variable">console</span>.<span class="cm-property">log</span>(<span class="cm-variable">ancestry</span>.<span class="cm-property"> filter</span>(<span class="cm-keyword">function</span>(<span class="cm-def">person</span>) {  <span class="cm-keyword">return</span> <span class="cm-variable">isInSet</span>(<span class= "cm-variable">theSet</span>, <span class="cm-variable-2">person</span>);}));<span class="cm-comment">// → [{name: "Maria van Brussel", ...},</span><span class="cm-comment">//    {name: "Carel Haverbeke", ...}]</span><span class="cm-variable">console</span>.<span class="cm-property">log</span>(<span class="cm-variable">ancestry</span>.<span class="cm-property">filter </span>(<span class="cm-variable">isInSet</span>.<span class="cm-property">bind</span>(<span class="cm-atom">null</span>, <span class="cm-variable">theSet</span>)));<span class= "cm-comment">// → ... same result</span></pre><p><a class="p_ident" id="p_P5qnPOIMMg" href="#p_P5qnPOIMMg"></a>The call to <code>bind</code> returns a function that will call <code>isInSet </code> with<code>theSet</code> as first argument, followed by any remaining arguments givento the bound function.</p><p><a class="p_ident" id="p_j9JPuWJlk7" href="#p_j9JPuWJlk7"></a>The first argument, where the example passes <code>null</code>, is usedfor method calls, similar to the first argument to <code>apply</code>. I'lldescribe this in more detail in the<a href= "06_object.html#call_method">next chapter</a>.</p><h2><a class="h_ident" id="h_ErccPg/l98" href="#h_ErccPg/l98"></a>Summary</h2><p><a class="p_ident" id="p_EmYdYeFPjo" href="#p_EmYdYeFPjo" ></a>Being able to pass function values to other functions is not just agimmick but a deeply useful aspect of JavaScript. It allows us towrite computations with "gaps" in them as functions and have the codethat calls these functions fill in those gaps by providing functionvalues that describe the missing computations.</p><p><a class="p_ident" id="p_YfXho6cgu+" href ="#p_YfXho6cgu+"></a>Arrays provide a number of useful higher-order methods-<code>forEach</code>to do something with each element in an array, <code>filter</code> to build a newarray with some elements filtered out, <code>map</code> to build a new arraywhere each element has been put through a function, and <code>reduce</code> tocombine all an array's elements into a single value.</p><p><a class="p_ident" id="p_3UBuCIfCEM" href="#p_3UBuCIfCEM"></a>Functions have an <code>apply</code> method that can be used to call them with anarray specifying their arguments. They also have a <code>bind</code> method,which is used to create a partially applied version of the function.</p><h2><a class="h_ident" id="h_TcUD2vzyMe" href="#h_TcUD2vzyMe" ></a>Exercises</h2><h3><a class="h_ident" id="h_aIOczlLyX1" href="#h_aIOczlLyX1"></a>Flattening</h3><p><a class="p_ident" id="p_RqAkArolEa" href="#p_RqAkArolEa"></a>Use the <code>reduce </code> method in combination withthe <code>concat</code> method to "flatten" an array of arrays into a singlearray that has all the elements of the input arrays.</p><pre data-language= "javascript" class="snippet cm-s-default"><a class="c_ident" id="c_HFu+EZSG8B" href="#c_HFu+EZSG8B"></a><span class="cm-keyword">var</span> <span class="cm-variable">arrays</span> <span class="cm-operator">=</span> [[<span class="cm-number">1</span>, <span class="cm-number">2</span>, <span class="cm-number">3</span>], [<span class="cm-number">4</span>, <span class= "cm-number">5</span>], [<span class="cm-number">6</span>]];<span class="cm-comment">// Your code here.</span><span class="cm-comment">// → [1, 2, 3, 4, 5, 6]</span></pre><h3><a class= "h_ident" id="h_I9XoVSLsTV" href="#h_I9XoVSLsTV"></a>Mother-child age difference</h3><p><a class="p_ident" id="p_a44KIXR4aT" href="#p_a44KIXR4aT"></a>Using the example data set from this chapter, compute theaverage age difference between mothers and children (the age of themother when the child is born). You can use the <code>average</code> functiondefined <a href= "05_higher_order.html#average_function">earlier</a> in thischapter.</p><p><a class="p_ident" id="p_/E+zqsb0UA" href="#p_/E+zqsb0UA"></a>Note that not all the mothers mentioned in the dataare themselves present in the array. The <code>byName</code> object, which makesit easy to find a person's object from their name, might be usefulhere.</p><pre data-language= "javascript" class="snippet cm-s-default"><a class="c_ident" id="c_+30TY+6MeW" href="#c_+30TY+6MeW"></a><span class="cm-keyword">function</span> <span class="cm-variable">average</span>( <span class="cm-def">array</span>) {  <span class="cm-keyword">function</span> <span class="cm-def">plus</span>(<span class="cm-def">a</span>, <span class="cm-def">b</span>) { <span class= "cm-keyword">return</span> <span class="cm-variable-2">a</span> <span class="cm-operator">+</span> <span class="cm-variable-2">b</span>; }  <span class="cm-keyword">return</span> <span class="cm-variable-2">array</span>.<span class="cm-property">reduce</span>(<span class="cm-variable-2">plus</span>) <span class="cm-operator">/</span> <span class="cm-variable-2">array </span>.<span class="cm-property">length</span>;}<span class="cm-keyword">var</span> <span class="cm-variable">byName</span> <span class="cm-operator">=</span> {};<span class="cm-variable" >ancestry</span>.<span class="cm-property">forEach</span>(<span class="cm-keyword">function</span>(<span class="cm-def">person</span>) {  <span class="cm-variable">byName</span>[<span class="cm-variable-2">person</span>.<span class="cm-property">name</span>] <span class="cm-operator">=</span> <span class="cm-variable-2">person</span>;});<span class="cm-comment">// Your code here.</span><span class="cm-comment">// → 31.2</span></pre><div class="solution"><div class="solution-text"><p><a class="p_ident" id="p_UL/8si2OX7" href="#p_UL/8si2OX7"></a>Because not all elements inthe <code>ancestry</code> array produce useful data (we can't compute the agedifference unless we know the birth date of the mother), we will haveto apply <code>filter </code> in some manner before calling <code>average</code>. You coulddo it as a first pass, by defining a <code>hasKnownMother</code> function andfiltering on that first. Alternatively, you could start by calling<code>map</code> and in your mapping function return either the age differenceor <code>null</code> if no mother is known. Then, you can call <code>filter</code> to removethe <code>null</code> elements before passing the array to <code>average</code>.</p></div></div><h3><a class="h_ident" id="h_FkNn96IrQe" href="#h_FkNn96IrQe"></a>Historical life expectancy</h3><p><a class="p_ident" id="p_ENbLeUYppS" href="#p_ENbLeUYppS"></a>When we looked up all the people inour data set that lived more than 90 years, only the latestgeneration in the data came out. Let's take a closer look at thatphenomenon.</p><p><a class="p_ident" id="p_0JOS/ablSJ" href="#p_0JOS/ablSJ"></a>Compute and output the average age of the peoplein the ancestry data set per century. A person is assigned to acentury by taking their year of death, dividing it by 100,and rounding it up, as in <code>Math.ceil(person.died / 100)</code>. </p><pre data-language="javascript" class="snippet cm-s-default"><a class="c_ident" id="c_Xi4vRpdLx1" href="#c_Xi4vRpdLx1"></a><span class="cm-keyword">function</span> <span class= "cm-variable">average</span>(<span class="cm-def">array</span>) {  <span class="cm-keyword">function</span> <span class="cm-def">plus</span>(<span class="cm-def">a</span>, <span class= "cm-def">b</span>) { <span class="cm-keyword">return</span> <span class="cm-variable-2">a</span> <span class="cm-operator">+</span> <span class="cm-variable-2">b</span>; }  <span class= "cm-keyword">return</span> <span class="cm-variable-2">array</span>.<span class="cm-property">reduce</span>(<span class="cm-variable-2">plus</span>) <span class="cm-operator">/</span> <span class="cm-variable-2">array</span>.<span class="cm-property">length</span>;}<span class="cm-comment">// Your code here.</span><span class="cm-comment">// → 16: 43.5</span><span class ="cm-comment">//   17: 51.2</span><span class="cm-comment">//   18: 52.8</span><span class="cm-comment">//   19: 54.8</span><span class="cm-comment">//   20: 84.7</span><span class= "cm-comment">//   21: 94</span></pre><div class="solution"><div class="solution-text"><p><a class="p_ident" id="p_fj5gLJr4+G" href="#p_fj5gLJr4+G"></a>The essence of this example lies ingrouping the elements of a collection by some aspect oftheirs-splitting the array of ancestors into smaller arrays with theancestors for each century.</p><p><a class="p_ident" id= "p_Jonw4Z0wbo" href="#p_Jonw4Z0wbo"></a>During the groupingprocess, keep an object that associates century names (numbers)with arrays of either person objects or ages. Since we do not know inadvance what categories we will find, we'll have to create them on thefly. For each person, after computing their century, we test whetherthat century was already known. If not, add an array for it. Then addthe person (or age) to the array for the proper century.</p><p><a class="p_ident" id="p_YoO/BHbTiQ" href="#p_YoO/BHbTiQ"></a>Finally, a <code>for</code>/<code> in</code> loop canbe used to print the average ages for the individual centuries.</p></div></div><p><a class="p_ident" id="p_yzI++go/yy" href="#p_yzI++go/yy"></a>Forbonus points, write a function <code>groupBy</code> that abstracts the groupingoperation. It should accept as arguments an array and a function thatcomputes the group for an element in the array and returns an objectthat maps group names to arrays of group members.</p><h3><a class="h_ident" id="h_jr7hZiuR7+" href="#h_jr7hZiuR7+"></a>Every and then some</h3><p><a class="p_ident" id="p_BZKBxgsPML" href="#p_BZKBxgsPML"></a>Arrays also come with the standard methods <code>every</code> and<code>some</code>. Both take a predicate function that, when called with an arrayelement as argument, returns true or false. Just like <code>&amp;&amp;</code>returns a true value only when the expressions on both sides are true,<code>every</code> returns true only when the predicate returns true for <em>all</em>elements of the array. Similarly, <code>some</code> returns true as soon as thepredicate returns true for <em>any</em> of the elements. They do not processmore elements than necessary-for example, if <code>some</code> finds that thepredicate holds for the first element of the array, it will not lookat the values after that.</p><p><a class="p_ident" id="p_aMPYznovUm" href="#p_aMPYznovUm"></a>Write two functions, <code>every</code> and <code>some</code>, that behave like thesemethods, except that they take the array as their first argumentrather than being a method.</p><pre data-language="javascript" class="snippet cm-s-default"><a class="c_ident" id="c_EK+njyIMWq" href="#c_EK+njyIMWq"></a><span class= "cm-comment">// Your code here.</span><span class="cm-variable">console</span>.<span class="cm-property">log</span>(<span class="cm-variable">every</span>([<span class="cm-atom">NaN</span> , <span class="cm-atom">NaN</span>, <span class="cm-atom">NaN</span>], <span class="cm-variable">isNaN</span>));<span class="cm-comment">// → true</span><span class="cm-variable">console </span>.<span class="cm-property">log</span>(<span class="cm-variable">every</span>([<span class="cm-atom">NaN</span>, <span class="cm-atom">NaN</span>, <span class="cm-number">4</span>], <span class="cm-variable">isNaN</span>));<span class="cm-comment">// → false</span><span class="cm-variable">console</span>.<span class="cm-property">log</span>(<span class="cm-variable"> some</span>([<span class="cm-atom">NaN</span>, <span class="cm-number">3</span>, <span class="cm-number">4</span>], <span class="cm-variable">isNaN</span>));<span class="cm-comment">// → true</span><span class="cm-variable">console</span>.<span class="cm-property">log</span>(<span class="cm-variable">some</span>([<span class="cm-number">2</span>, <span class="cm-number">3 </span>, <span class="cm-number">4</span>], <span class="cm-variable">isNaN</span>));<span class="cm-comment">// → false</span></pre><div class="solution"><div class="solution-text"><p><a class="p_ident" id="p_43tyHVRbBq" href="#p_43tyHVRbBq"></a>The functions can follow a similar pattern to the<a href="05_higher_order.html#forEach">definition</a> of <code>forEach</code> at thestart of the chapter, except that they must return immediately (withthe right value) when the predicate function returns false-or true.Don't forget to put another <code>return</code> statement after the loop so thatthe function also returns the correct value when it reaches the end ofthe array.</p></div></div><nav>  <a href="04_data.html" title="previous chapter">◀ </a>  <a href="index.html" title="cover">◆</a>  <a href="06_object.html" title="next chapter">▶</a></nav></article>			</div>		<!--=========================			END : POST		=============================-->		<!--=========================			START : POST		=============================-->		<div class="post-wrapper"><div class= "section-inner layoutSingleColumn"><h2 name="title" id="title" class="graf--h2 graf--first">Higher Order Functions</h2><h4 name="subtitle" id="subtitle" class="graf--h4">Closures, function factories, common factory pattern functions</h4><p class="graf--p graf--empty"><br></p><p name="e904" id="e904" class="graf--p is-withNotes">In the <a href=" https://medium.com/functional-javascript/45a9dca6c64a" data-href="https://medium.com/functional-javascript/45a9dca6c64a" class="markup--anchor markup--p-anchor">first chapter</a> we saw <strong class="markup--strong markup--p-strong">first class</strong> functions, ie. functions as first class citizens of the language. Higher order functions are functions that do one of the following</p><ul class="postList"><li name="8ffa" id="8ffa" class="graf--li">Take a function as one of its arguments</li><li name="24b2" id="24b2" class="graf--li">Returns a function </li></ul><p name="6d97" id="6d97" class="graf--p">A function is said to be <strong class="markup--strong markup--p-strong">functional </strong>if it takes a function as its argument. Higher order functions form the backbone of functional programming.</p><h4 name="7172" id="7172" class="graf--h4"><strong class="markup--strong markup--h4-strong">Creating Closures </strong></h4><p name="b8c0" id="b8c0" class="graf--p">Mastering closures is the key to mastering JavaScript, and functional JavaScript. Closures are every where in JavaScript, and you would not be able to do very much in a functional manner without closures. Let us look at an example.</p><pre name="6061" id="6061" class="graf--pre">var showName = function() {<br>  var name = "FP JavaScript"<br>  return function() {<br>    console.log(name)<br>  }<br>}()<br>showName() //==&gt;&gt; FP JavaScript<br>console.log(name) //==&gt;&gt; Reference Error</pre><p name="9f44" id="9f44" class="graf--p">We created an immediately executed anonymous function.</p><pre name="4fa4" id="4fa4" class="graf--pre">function() {</pre><pre name="6e53" id="6e53" class="graf--pre">}()</pre><p name="8e2b" id="8e2b" class="graf--p">And assigned its return value to <strong class="markup--strong markup--p-strong">showName</strong>. <strong class= "markup--strong markup--p-strong">showName</strong> is set to the function.</p><pre name="e17f" id="e17f" class="graf--pre">function() {<br>  console.log(name)<br>}</pre><p name="d1c2" id= "d1c2" class="graf--p">We also created a variable <strong class="markup--strong markup--p-strong">name</strong> in the same scope as the above function. The variable is visible inside the function, as the function prints its value.</p><p name="8761" id="8761" class="graf--p">Outside the immediately executed function, <strong class="markup--strong markup--p-strong">name </strong> is undefined. We get an error when we try to access it. However we can print the name calling <strong class="markup--strong markup--p-strong">showName</strong>. Even though the function which created <strong class="markup--strong markup--p-strong">name</strong> has run and returned, <strong class="markup--strong markup--p-strong">name</strong> continues to be accessible inside <strong class="markup--strong markup--p-strong">showName</strong>.</p><p name="6d3d" id="6d3d" class="graf--p">In effect we created a closure with a variable <strong class="markup--strong markup--p-strong">name</strong> for the function <strong class="markup--strong markup--p-strong">showName</strong>. You can do whatever you want with <strong class= "markup--strong markup--p-strong">showName</strong>. Pass it to another function, or where ever you want. You can bank on its closure to faithfully follow it.</p><p name="74dd" id="74dd" class="graf--p">A functions closure is a pointer, that the function carries with it. It points to a table of all the variables in the scope where the function was created.</p><p name= "69d1" id="69d1" class="graf--p">A closure is created every time a function returns another function defined within it.</p><p name="2fc6" id="2fc6" class="graf--p">Creating closures should come naturally to a JavaScript programmer. If not, keep practising closures. We will be making a lot of closures in this book. You should recognise them even if it is not always explicitly mentioned.</p><h4 name="2187" id="2187" class="graf--h4"><strong class="markup--strong markup--h4-strong">Function Factory</strong></h4><p name="3279" id="3279" class="graf--p"> Consider the code below.</p><pre name="b832" id="b832" class="graf--pre">function add(x) {<br>  return function(y) {<br>    return x + y<br>  }<br>}<br>var add2 = add(2)<br>var add3 = add(3)<br>add2(4) //==&gt;&gt; 6<br>add3(6) //==&gt;&gt; 9</pre><p name="b704" id="b704" class="graf--p">The function <strong class="markup--strong markup--p-strong">add</strong> takes a single variable x and returns a function, which in turn takes a single variable y and returns the sum of x and y.</p><p name="a7df" id="a7df" class="graf--p"><strong class="markup--strong markup--p-strong">add</strong> is a <strong class="markup--strong markup--p-strong">Function Factory. </strong>Given a value, it creates a function, that adds a given value to a value stored in its closure.</p><p name="a786" id="a786" class="graf--p">So why not just write add as <strong class="markup--strong markup--p-strong">add(x, y)</strong>? This is surely simpler. Writing functions as function factories allow you to compose other functions. We will see more of this below. And in the chapter on composition.</p><p name="d294" id="d294" class="graf--p" >We will look at some of the common functions that are written using the function factory pattern.</p><h4 name="04c9" id="04c9" class="graf--h4"><strong class="markup--strong markup--h4-strong">get</strong></h4><pre name="c9e0" id="c9e0" class="graf--pre">function get(prop) {<br>  return function(obj) {<br>    return obj[prop]<br>  }<br>}</pre><p name="9f35" id ="9f35" class="graf--p">What is interesting about this function is that it does no "getting" so to speak. It just returns another function.</p><pre name="3e5e" id="3e5e" class="graf--pre"> var getName = get("name")</pre><p name="e002" id="e002" class="graf--p"><strong class="markup--strong markup--p-strong">getName</strong> gets set to a function returned by <strong class= "markup--strong markup--p-strong">get</strong>. But before returning anything, <strong class="markup--strong markup--p-strong">get</strong> creates a closure with variable <strong class= "markup--strong markup--p-strong">prop</strong> (property) for <strong class="markup--strong markup--p-strong">getName</strong>. And the property is set to "name".</p><pre name="8025" id= "8025" class="graf--pre">var book = {<br>  name: "FP JavaScript"<br>}<br>getName(book) //==&gt;&gt; FP JavaScript</pre><p name="0f7a" id="0f7a" class="graf--p">get can be used with arrays too.</p><pre name="d6f5" id="d6f5" class="graf--pre">get(1)([1, 2, 3]) //==&gt;&gt; 2</pre><p name="6a25" id="6a25" class="graf--p">This is the way <strong class="markup--strong markup--p-strong">get</strong> works in functional languages. This is useful when you <strong class="markup--strong markup--p-strong">compose</strong> it with other functions. Also useful if you are accessing the same property of a set of objects. We will see all this in action next.</p><h4 name="b6f4" id="b6f4" class="graf--h4"><strong class="markup--strong markup--h4-strong">map</strong></h4><p name="1c0d" id="1c0d" class="graf--p">We will rewrite the JavaScript array map function in a functional manner.</p><pre name="278f" id="278f" class= "graf--pre">function map(fn) {<br>  return function(arr) {<br>    return Array.prototype.map.call(arr, fn)<br>  }<br>}</pre><pre name="d995" id="d995" class="graf--pre">map(function(x) {return x * x}) ([1, 2, 3]) //==&gt;&gt; [ 1, 4, 9 ]</pre><p name="ae01" id="ae01" class="graf--p">Notice that the arguments are flipped. The function comes first then the array. Also we used <strong class="markup--strong markup--p-strong">Array.prototype.map.call </strong>instead of just calling <strong class="markup--strong markup--p-strong">arr.map</strong>. This is so that we can use our map function with array like objects, <strong class="markup--strong markup--p-strong">arguments</strong> and <strong class="markup--strong markup--p-strong">DOMNodeList </strong>.</p><p name="4068" id="4068" class="graf--p">Say you wanted to get all the emails from a list like this in an array.</p><pre name="6fec" id="6fec" class="graf--pre">var people = [ {name:"John", email:"john@example.com"},<br> {name:"Bill", email:"bill@example.com"} ]</pre><pre name="e336" id="e336" class="graf--pre">map(get('email')) (people)<br> //===&gt;&gt; [ 'john@example.com', 'bill@example.com' ]</pre><p name="ee60" id="ee60" class="graf--p">You see the advantage of writing <strong class="markup--strong markup--p-strong">get</strong> this way. You can pass it as an argument to another function. We composed get with map. Next we will see the advantage of writing map this way.</p><h4 name="58f6" id="58f6" class="graf--h4" ><strong class="markup--strong markup--h4-strong">pluck</strong></h4><p name="ea4b" id="ea4b" class="graf--p">The pattern map(get()) we saw above is so common that we a have a function for it called <strong class="markup--strong markup--p-strong">pluck</strong>.</p><pre name="f398" id="f398" class="graf--pre">function pluck(prop) {<br>  return map(get(prop))<br>} </pre><pre name="9581" id="9581" class="graf--pre">pluck('email')(people)<br> //===&gt;&gt; [ 'john@example.com', 'bill@example.com' ]</pre><p name="fd4b" id="fd4b" class="graf--p"><strong class="markup--strong markup--p-strong">pluck</strong> is a function composition of <strong class="markup--strong markup--p-strong">map</strong> and <strong class="markup--strong markup--p-strong">get(prop)</strong>. Composition works from right to left.</p><p name="51b7" id="51b7" class="graf--p"><strong class="markup--strong markup--p-strong">map</strong> returns a function that requires an array. But has also set its required function <strong class="markup--strong markup--p-strong">get(prop)</strong> in its closure.</p><p name="fdf7" id= "fdf7" class="graf--p">So pluck('email') is a function returned by map. Now we need to call it with <strong class="markup--strong markup--p-strong">array</strong> to evaluate it. <strong class="markup--strong markup--p-strong">map</strong> then calls the arrays map function with the function in its closure.</p><h4 name="d25e" id="d25e" class="graf--h4"><strong class= "markup--strong markup--h4-strong">forEach</strong></h4><pre name="55cf" id="55cf" class="graf--pre">function forEach(fn) {<br>  return function(arr) {<br> Array.prototype.forEach.call(arr, fn)<br>  }<br>}</pre><p name="dfb5" id="dfb5" class="graf--p">This works just like our map function earlier, except that it just iterates over an array, and does not return anything. This will also work with a <strong class="markup--strong markup--p-strong">DOMNodeList</strong>.</p><p name="55e3" id="55e3" class="graf--p">A common pattern we encounter often while doing client side development is iteration over a <strong class="markup--strong markup--p-strong">NodeList</strong> returned by <strong class="markup--strong markup--p-strong">document.querySelectorAll</strong>. To accomplish this we can write a generic higher order function to iterate over a <strong class="markup--strong markup--p-strong"> NodeList</strong> given a selector.</p><pre name="7702" id="7702" class="graf--pre">&lt;!DOCTYPE html&gt;&lt;html&gt;&lt;body&gt;</pre><pre name="ac3b" id="ac3b" class="graf--pre">&lt;div &gt;Hide Me&lt;/div&gt;<br>&lt;div&gt;Hide Me Too&lt;/div&gt;</pre><pre name="c909" id="c909" class="graf--pre">&lt;script&gt;</pre><pre name="22cf" id="22cf" class="graf--pre">function forEach(fn) {<br>  return function(arr) {<br>    Array.prototype.forEach.call(arr, fn)<br>  }<br>}</pre><pre name="d17c" id="d17c" class="graf--pre">var displayNone = forEach(function(elem) {<br>  elem.style.display = "none"<br>})</pre><pre name="1511" id="1511" class="graf--pre">displayNone(document.querySelectorAll("div"))</pre><pre name="ecda" id= "ecda" class="graf--pre">&lt;/script&gt;</pre><pre name="3a79" id="3a79" class="graf--pre">&lt;/body&gt;&lt;/html&gt;</pre><h4 name="bdb4" id="bdb4" class="graf--h4"><strong class= "markup--strong markup--h4-strong">take</strong></h4><p name="ee61" id="ee61" class="graf--p"><strong class="markup--strong markup--p-strong">take</strong> takes a number <strong class= "markup--strong markup--p-strong">n</strong> and returns a function, to which you must pass an array, to get the first <strong class="markup--strong markup--p-strong">n</strong> elements of the array.</p><pre name="b606" id="b606" class="graf--pre">function take(n) {<br>  return function(arr) {<br>    return arr.slice(0, n)<br>  }<br>}</pre><h4 name="e4bd" id="e4bd" class= "graf--h4"><strong class="markup--strong markup--h4-strong">flip</strong></h4><p name="495d" id="495d" class="graf--p"><strong class="markup--strong markup--p-strong">flip</strong> takes a function of two or more arguments and returns a function with the first two arguments flipped.</p><pre name="d703" id="d703" class="graf--pre">function flip(fn) {<br>  return function(first, second) {<br>    var rest = [].slice.call(arguments, 2)<br>    return fn.apply(null, [second, first].concat(rest))<br>  }<br>}</pre><p name="a8f8" id="a8f8" class="graf--p" ><strong class="markup--strong markup--p-strong">flip</strong> is useful when you need to partially apply a given function in the order you want the arguments. We will learn more about partial application in the chapter on <strong class="markup--strong markup--p-strong">currying</strong>.</p><h4 name="09eb" id="09eb" class="graf--h4"><strong class="markup--strong markup--h4-strong">memoize</strong></h4><p name="1e28" id="1e28" class="graf--p">Memoization is the process in which a function caches its results, and returns results from the cache, if the function was called before with the same argument(s).</p><pre name="87ec" id="87ec" class="graf--pre">function memoize(fn) {<br>  var cache = {}<br>  return function(arg) {<br> return (arg in cache) ? cache[arg] : (cache[arg] = fn(arg))<br>  }<br>}</pre><p name="fcd3" id="fcd3" class="graf--p">This is memoize for a function that takes one argument. It returns a function with an object <strong class="markup--strong markup--p-strong">cache</strong> in its closure. Every time the function is called it checks the cache for the argument. If found it returns the corresponding value. Otherwise it sets the cache with the argument and result, and returns the result.</p><p name="be39" id="be39" class="graf--p">memoize is very useful to optimise lengthy calculations, or expensive recursive operations.</p><p name="2917" id="2917" class="graf--p">The fibonacci series calculation is the popular example used to demonstrate the <strong class="markup--strong markup--p-strong">memoize</strong> function. Because the computation involved grows exponentially the larger the number you want to calculate in the series.</p><p name="27c1" id="27c1" class="graf--p">Each number in the fibonacci series is the sum of the previous two numbers starting after the second number. eg. 1,1,2,3,5,8,13,21&nbsp; .. etc. And we can write this as</p><pre name="a296" id="a296" class="graf--pre">function fib(n) {<br>  return n &lt; 2 ? 1 : fib(n - 1) + fib(n - 2)<br>}</pre><p name="3feb" id="3feb" class="graf--p">And let us run some tests.</p><pre name="9260" id="9260" class="graf--pre">var fibmemo = memoize(fib)<br>var start = new Date()<br>fibmemo(20)<br>console.log(new Date() - start) //==&gt;&gt; 11 ms on my machine</pre><pre name="f8e3" id="f8e3" class="graf--pre">start = new Date()<br>fibmemo(20)<br>console.log(new Date() - start) //==&gt;&gt; 0 ms </pre><p name="2833" id="2833" class="graf--p">Notice that running <strong class="markup--strong markup--p-strong">fibmemo(20)</strong> the second time round took only 0 ms, because it just returned the cached value.</p><p name="41c2" id="41c2" class="graf--p">We need to modify memoize to handle functions with multiple arguments. Fortunately that is quite simple.</p><pre name="c3b7" id="c3b7" class="graf--pre">function memoize(fn) {<br>  var cache = {}<br>  return function() {<br>    var args = Array.prototype.slice.call(arguments)<br>    return (args in cache) ? cache[args] : <br>                     (cache[args] = fn.apply(null, args))<br>  }<br>}</pre><p name="fbac" id="fbac" class="graf--p">First we convert the arguments passed to an array in <strong class="markup--strong markup--p-strong">args</strong>. Since <strong class="markup--strong markup--p-strong">args</strong> is an array and is used in the context of a object key (hash), it will be coerced into a string. Second, we now apply the array to fn.</p><h4 name="46bd" id="46bd" class="graf--h4"><strong class="markup--strong markup--h4-strong"> once</strong></h4><p name="7ec9" id="7ec9" class="graf--p"><strong class="markup--strong markup--p-strong">once</strong> will create a function you can only run once. Subsequent invocations will return the first result.</p><pre name="dce2" id="dce2" class="graf--pre graf--last">function once(fn) {<br>  var cache = {}<br>  return function() {<br>    return ("once" in cache) ? cache["once"] :<br>                  (cache["once"] = fn.apply(null, arguments))<br>  }<br>}</pre></div>			</div>		<!--=========================			END : POST		=============================-->		<!--=========================			START : POST		=============================-->		<div class="post-wrapper"><div class= "section-inner layoutSingleColumn"><h2 name="title" id="title" class="graf--h2 graf--first">Functions</h2><h4 name="subtitle" id="subtitle" class="graf--h4">Basics, anonymous functions, constructor, predicates</h4><p class="graf--p graf--empty"><br></p><p name="4fa6" id="4fa6" class="graf--p">Functions are the basic unit of code reuse in JavaScript. Functions are also about much more than just code reuse as we will see in this chapter. This chapter will build the readers capabilities in order to understand the subsequent chapters. We will discuss the concepts and functions that will be used in subsequent chapters.</p><pre name="0201" id="0201" class="graf--pre">alert("Hello John")<br>alert("Hello Bill")</pre><p name="d550" id="d550" class="graf--p">You can type the two lines above into a browser console. The lines will alert "Hello John" and "Hello Bill". If you noticed the console also printed undefined on the console, because that is what the alert function returns. We are repeating the same code in each line. We can reuse this code by abstracting it away in a function.</p><pre name="03df" id= "03df" class="graf--pre">function greet(name) {<br> alert("Hello " + name)<br>}</pre><p name="4498" id="4498" class="graf--p">Now we can use the <strong class="markup--strong markup--p-strong">greet</strong> function without needing to know how it works. We just call it with a name. In other words we have abstracted away the code into a function.</p><p name= "26ac" id="26ac" class="graf--p">Function <strong class="markup--strong markup--p-strong">greet</strong> will return <strong class="markup--strong markup--p-strong">undefined</strong>. That is because we did not explicitly return anything. In JavaScript if a function does not explicitly call return with a value, the function returns <strong class="markup--strong markup--p-strong">undefined</strong>.</p><pre name="6e4c" id="6e4c" class="graf--pre">function greet(greeting, name) {<br> alert(greeting + " " + name)<br> return "Greeting sent to " + name<br>}<br>greet("Hello", "John")<br>greet("Welcome", "Jim")</pre><p name="e994" id="e994" class="graf--p">We now do some more abstraction. The function takes a greeting message also, and we return a value too.</p><h4 name="abd4" id="abd4" class="graf--h4"><strong class="markup--strong markup--h4-strong">Function arguments</strong></h4><p name="2874" id="2874" class= "graf--p">JavaScript allows you to define a function without specifying its arguments. And you can access the arguments within the function using the <strong class="markup--strong markup--p-strong">arguments</strong> value. <strong class="markup--strong markup--p-strong">arguments</strong> is an array like object, but not an array. It has the length property, but does not have access to other array methods like push, pop, slice etc.</p><p name="afdd" id="afdd" class="graf--p">Here we rewrite the greet function to take any number of names.</p><pre name="f904" id="f904" class="graf--pre">function greet() {<br> for (var i = 0; i &lt; arguments.length; i++) {<br> alert(arguments[i])<br> }<br>}<br>greet("John", "Jim", "James")</pre><p name="a78c" id="a78c" class="graf--p">In the function above we treated the <strong class="markup--strong markup--p-strong">arguments</strong> object as an array by accessing its <strong class="markup--strong markup--p-strong">length</strong> property, and each element using the array subscript.</p><h4 name="957a" id="957a" class="graf--h4"><strong class="markup--strong markup--h4-strong">Function length</strong></h4><p name="a7f1" id="a7f1" class="graf--p">Each function has a length property which is the number of arguments specified in its definition. </p><pre name="a2fe" id="a2fe" class="graf--pre">function add(x, y) {<br> return x + y<br>}<br>add.length //==&gt;&gt; 2</pre><pre name="83cd" id="83cd" class="graf--pre">function add() { <br> return arguments[0] + arguments[1]<br>}<br>add.length //==&gt;&gt; 0<br>add(2, 4) //==&gt;&gt; 6</pre><p name="6311" id="6311" class="graf--p">In the second example we did not specify arguments in the function definition, hence its length was <strong class="markup--strong markup--p-strong">0</strong>. But our <strong class="markup--strong markup--p-strong">add </strong> function worked just fine because we accessed the arguments by subscripting the arguments object.</p><h4 name="6de3" id="6de3" class="graf--h4 is-withNotes"><strong class= "markup--strong markup--h4-strong">Function call method</strong></h4><p name="b3a2" id="b3a2" class="graf--p">Each function has a <strong class="markup--strong markup--p-strong">call </strong> method attached to it. You can use the <strong class="markup--strong markup--p-strong">call</strong> method to change the context in which the method is called. eg. Arrays have a slice method.</p><pre name="1d05" id="1d05" class="graf--pre">[1, 2, 3].slice(1) //==&gt;&gt; [2, 3]</pre><p name="93fa" id="93fa" class="graf--p">What is interesting is that we can change the context in which <strong class="markup--strong markup--p-strong">slice</strong> is called and use it to convert an array like object to a proper array. In the example below we convert the arguments object into an array by calling</p><pre name="b731" id="b731" class="graf--pre">[].slice.call(arguments)</pre><p name="7134" id="7134" class="graf--p">The first argument to <strong class="markup--strong markup--p-strong">call</strong> is the context, and the rest of the arguments are the arguments you pass to <strong class="markup--strong markup--p-strong">slice</strong>. In this case we don't pass any arguments to <strong class="markup--strong markup--p-strong">slice</strong> because we want the whole array back. The above is same as calling</p><pre name="83c8" id="83c8" class="graf--pre">Array.prototype.slice.call(arguments)</pre><p name="8658" id="8658" class="graf--p">Converting arguments and other array like objects to arrays is a common pattern you will encounter in JavaScript. We can abstract that pattern away into a function.</p><pre name="7416" id="7416" class="graf--pre"> function toArray(args) {<br> return Array.prototype.slice.call(args)<br>}</pre><p name="3bcb" id="3bcb" class="graf--p">We use the <strong class="markup--strong markup--p-strong"> Array.slice</strong> method to convert the array like object into an array. The <strong class="markup--strong markup--p-strong">slice</strong> method returns a new array, and does not check if the passed object is actually an array. It just checks the length, and accesses the elements using the subscript, not unlike what we did in our example.</p><h4 name="1549" id= "1549" class="graf--h4"><strong class="markup--strong markup--h4-strong">Function apply method</strong></h4><p name="6056" id="6056" class="graf--p">The functions apply method works just like <strong class="markup--strong markup--p-strong">call</strong> above, with the difference being that it takes an array like object as its second argument, which will be used as the arguments to the function.</p><p name="1925" id="1925" class="graf--p">The function <strong class="markup--strong markup--p-strong">bind</strong> takes a <strong class="markup--strong markup--p-strong">function</strong> and a <strong class="markup--strong markup--p-strong">context</strong> as it arguments and returns a new function that binds the given function to the new function.</p><pre name="9d80" id="9d80" class="graf--pre">function bind(fn, context) {<br> return function() {<br>   return fn.apply(context, arguments)<br> }<br>}</pre><p name="3483" id="3483" class="graf--p">The bind operation returns a new function. When the new function is called with a set of arguments, the bound function's apply method is called with the <strong class="markup--strong markup--p-strong">context</strong> and arguments. In ecmascript 5 the <strong class="markup--strong markup--p-strong">bind</strong> method is available to all functions, so we don't need to use the bind function above.</p><h4 name="1f2d" id="1f2d" class="graf--h4"><strong class="markup--strong markup--h4-strong">Anonymous functions </strong></h4><p name="1251" id="1251" class="graf--p">In the bind function example above the new function returned was an anonymous function. Anonymous functions are function expressions, so they can not appear on the left hand side of a statement. They can be used on the right hand side of a statement (like in the return statement above) or passed as arguments to a function. You can assign them to variables.</p><pre name="2902" id="2902" class="graf--pre">var greet = function(name) {<br> alert("Hello " + name)<br>}</pre><p name="d57b" id="d57b" class="graf--p">In the example above we rewrite the <strong class="markup--strong markup--p-strong">greet</strong> function from earlier in this chapter. Here we assign an anonymous function to a variable named <strong class="markup--strong markup--p-strong">greet</strong>. The former function definition was a <strong class="markup--strong markup--p-strong"> function declaration</strong>, while the latter is a <strong class="markup--strong markup--p-strong">function expression</strong>.</p><p name="536b" id="536b" class="graf--p">Both forms of the function definition will work for you. However there is a difference of note. Function declarations are evaluated at compile time, and you can call the function even before the definition.</p><pre name="3cb0" id="3cb0" class="graf--pre">greet("John")<br>function greet(name) {<br> alert("Hello " + name)<br>}</pre><p name="e5f2" id="e5f2" class="graf--p">We call <strong class="markup--strong markup--p-strong">greet</strong> before it is defined in the example above. And this will work.</p><pre name="4f9d" id="4f9d" class="graf--pre">greet("John") <br>var greet = function(name) {<br> alert("Hello " + name)<br>}</pre><p name="f599" id="f599" class="graf--p">The example above will not work, and will throw an error. This is because the function expression is evaluated at runtime, because of the assignment statement.</p><h4 name="db8c" id="db8c" class="graf--h4"><strong class="markup--strong markup--h4-strong"> Function constructor</strong></h4><p name="4886" id="4886" class="graf--p">Another way to create a function is to create a new object of the Function class.</p><pre name="e1fc" id="e1fc" class="graf--pre">var greet = new Function("greeting", "name", 'alert(greeting + " " + name)')<br>greet("welcome", "John")</pre><p name="e015" id="e015" class="graf--p">The <strong class= "markup--strong markup--p-strong">Function</strong> constructor takes a set of argument name strings, which will be used as the argument names for the created function. The last argument is a string containing all the code within the new function. The new statement is not required. The following will also work.</p><pre name="f9f6" id="f9f6" class="graf--pre">var greet = Function(<br>             "greeting", "name", 'alert(greeting + " " + name)')<br>greet("welcome", "John")</pre><p name="7611" id="7611" class="graf--p">The function created by the function constructor will execute in the global scope. So the following code will not work. It will throw an error.</p><pre name="b923" id="b923" class="graf--pre">var a = 1<br>var add1 = new Function("b", "return a + b")<br>add1(2) //==&gt;&gt; ReferenceError: a is not defined</pre><p name="fc2e" id="fc2e" class="graf--p">So it is important to remember here that functions created using the function constructor are not closures, unlike the other two ways we created functions. More on closures later.</p><h4 name="830c" id="830c" class="graf--h4"><strong class ="markup--strong markup--h4-strong">Predicate Functions</strong></h4><p name="41dc" id="41dc" class="graf--p">A function that returns a boolean <strong class="markup--strong markup--p-strong">true</strong> or <strong class="markup--strong markup--p-strong">false</strong> is known as a predicate function. They are very useful in programming languages, for type checking, truth checking etc. It is always useful to have a set of predicate functions at hand and we will write some here.</p><pre name="1ce7" id="1ce7" class="graf--pre">function isNumber(obj) {<br> return Object.prototype.toString.call(obj) === <br>                                            "[object Number]"<br>}</pre><p name="cf82" id="cf82" class="graf--p"> Every object has a <strong class="markup--strong markup--p-strong">toString</strong> method which is inherited from the generic <strong class="markup--strong markup--p-strong">Object </strong>. The method may be overridden by subclasses of Object. However we can call the the generic objects <strong class="markup--strong markup--p-strong">toString</strong> method via its prototype, and change the context to our own object via the its call method, yielding a string like [object type].</p><p name="fdb0" id="fdb0" class="graf--p">That is what we do in the above function. However the call to <strong class="markup--strong markup--p-strong">Object.prototype.toString</strong> is so commonly used that we can write a function for it.</p><pre name="70ec" id="70ec" class="graf--pre">function getType(obj) {<br> var type_str = Object.prototype.toString.call(obj)<br> var type_arr = type_str.match(/.* (.*)\]/)<br> return type_arr[1] <br>}</pre><p name="8428" id="8428" class="graf--p">First we get the type string of the passed object. Next we match it with a regular expression to extract the type part so we get a string like <strong class="markup--strong markup--p-strong">Number</strong>, <strong class="markup--strong markup--p-strong">Array</strong> etc. The required part will be the second element of the matched array which we return. We can write the whole thing in one line like below.</p><pre name="4aa4" id="4aa4" class="graf--pre">function getType(obj) {<br> return Object.prototype.toString.call(obj)<br>                                    .match(/.* (.*)\]/)[1] <br>}<br>getType(10) //==&gt;&gt; Number<br>getType("") //==&gt;&gt; String<br> getType([]) //==&gt;&gt; Array<br>getType({}) //==&gt;&gt; Object<br>getType(null) //==&gt;&gt; Null<br>getType(undefined) //==&gt;&gt; Undefined<br>getType(true) //==&gt;&gt; Boolean<br> getType(getType) //==&gt;&gt; Function<br>getType(new Date()) //==&gt;&gt; Date</pre><p name="e8fc" id="e8fc" class="graf--p">So we can write isNumber as</p><pre name="87ac" id="87ac" class="graf--pre">function isNumber(obj) {<br> return getType(obj) === 'Number' &amp;&amp; !isNaN(obj)<br>}</pre><p name="5d22" id="5d22" class="graf--p">Note that we had to add one more condition. That is because in JavaScript <strong class="markup--strong markup--p-strong">NaN</strong> will also show type Number! And we need to guard against that. In some cases <strong class="markup--strong markup--p-strong">getType</strong> is not the most efficient operation. We can use typeof and <strong class="markup--strong markup--p-strong">Array.isArray</strong> in some cases.</p><p name="ddb6" id="ddb6" class="graf--p">So we now can write all the type predicates as below.</p><pre name="95ed" id="95ed" class="graf--pre is-withNotes">function isNumber(obj) {<br> return typeof obj === 'number' &amp;&amp; !isNaN(obj)<br>}</pre><pre name="0fcb" id="0fcb" class="graf--pre">function isString(obj) {<br> return typeof obj === 'string' <br>}</pre><pre name="6dab" id="6dab" class="graf--pre">function isArray(obj) {<br> return Array.isArray(obj)<br>}</pre><pre name="ff32" id="ff32" class="graf--pre">function isObject(obj) {<br> return getType(obj) === 'Object'<br>}</pre><pre name="ae85" id="ae85" class="graf--pre">function isNull(obj) {<br> return getType(obj) === 'Null'<br>}</pre><pre name="4a8c" id="4a8c" class="graf--pre">function isUndefined(obj) {<br> return getType(obj) === 'Undefined'<br>}</pre><pre name="43b5" id="43b5" class="graf--pre">function isFunction(obj) {<br> return getType(obj) === 'Function'<br>}</pre><pre name="ef5d" id="ef5d" class="graf--pre">function isDate(obj) {<br> return getType(obj) === 'Date'<br>}</pre><p name="c79e" id="c79e" class= "graf--p">Another useful predicate is isEmpty.</p><pre name="9eaa" id="9eaa" class="graf--pre graf--last">function isEmpty(obj) {<br> if (obj === null || obj === "") return true<br> if (isArray(obj) &amp;&amp; obj.length === 0) return true<br> if (isObject(obj) &amp;&amp; Object.keys(obj).length === 0) return true<br> return false<br>}</pre></div>			</div> <!--=========================			END : POST		=============================--><!--=========================			START : POST		=============================--> <div class="post-wrapper"><div class="section-inner layoutSingleColumn"><h2 name="title" id="title" class="graf--h2 graf--first is-withNotes">Introduction to Functional JavaScript</h2><h4 name="subtitle" id="subtitle" class="graf--h4">History, programming paradigms, abstractions, basics</h4><p class="graf--p graf--empty"><br></p><h4 name="14e5" id="14e5" class="graf--h4" ><strong class="markup--strong markup--h4-strong">History</strong></h4><p name="e14c" id="e14c" class="graf--p">JavaScript was a functional programming language even before it got its name! Back in 1995 Netscape Communications the makers of the Netscape Browser realized that their browser needed a scripting language embedded in HTML. They hired Brendan Eich to embed the Scheme programming language in HTML. Scheme was a full fledged functional programming language.</p><p name="7a26" id="7a26" class="graf--p">To his dismay "the powers that be" encouraged Brendan to come up with a more traditional programming language. His first cut was a language called "Mocha" in May 1995, and it retained that name till December 1995. It was first renamed "LiveScript" and soon after that Netscape and Sun did a license agreement and it was called "JavaScript". But by then Brendan Eich had sneaked in some "functional programming" features into JavaScript.</p><p name="1138" id="1138" class="graf--p">The story gets more complicated, and we will delve into it. Because this story will tell you why JavaScript is what it is today. Brendan Eich claims that hiring him to embed the Scheme language, might actually have been a "bait and switch operation". But at that point in time Netscape was also negotiating with Sun to embed Java in the browser. Note that JavaScript was for embedding in HTML while Java was for embedding in the Browser. The idea was that Java would be used for component development while JavaScript would be used for lightweight scripting within HTML.</p><p name="e8e5" id="e8e5" class="graf--p">We don't know what actually transpired, but the orders from above to Brendan where clear. The new scripting language must "look like Java" and must be "object based". Any hopes Brendan might have harboured for Scheme, where now out of the window. We will see why.</p><h4 name="0df2" id="0df2" class="graf--h4"><strong class="markup--strong markup--h4-strong">Curly brace language</strong></h4><p name="a7a2" id="a7a2" class="graf--p">We can only speculate on what "look like Java" meant. However we can be certain that it had to be a "curly brace" language. Curly brace languages define statement blocks using curly braces, the "{" and "}" characters. Indeed Java syntax was fashioned on another curly brace language "C++", which in turn was fashioned on "C". Here is how a for-loop looks in Java.</p><pre name="7645" id="7645" class="graf--pre">for (int i = 0; i &lt; 10; i++) { <br> System.out.println("Hello"); <br> System.out.println("World"); <br>} </pre><p name="21e3" id="21e3" class="graf--p">The same for-loop in C.</p><pre name="a59c" id="a59c" class="graf--pre">int i; <br>for (i = 0; i &lt; 10; i++) { <br> printf("Hello\n"); <br> printf("World\n"); <br>}</pre><p name="0d8e" id="0d8e" class="graf--p">And the for-loop in JavaScript.</p><pre name="b2fb" id="b2fb" class="graf--pre">for (var i = 0; i &lt; 10; i++) { <br> console.log("Hello") <br> console.log("World") <br>}</pre><h4 name="71e2" id="71e2" class="graf--h4"><strong class="markup--strong markup--h4-strong">Programming Paradigms </strong></h4><p name="0689" id="0689" class="graf--p">Indeed JavaScript does look like Java. And C too. However curly braces were not the only implications for a language to "look like Java". Java is an imperative/object oriented style programming language. JavaScript also had to be an imperative/object oriented style language.</p><p name="98aa" id="98aa" class="graf--p" >Programming languages are made up of operators, conditional statements, loop statements and functions. Having conditional statements and loop statements are hallmarks of an "imperative" style programming language. Functional style languages tend to support operators and functions only.</p><p name="003c" id="003c" class="graf--p">It is interesting that none of the three languages, Java, C++ and C, were functional programming languages. While C was an imperative programming language, C++ and Java were Imperative/Objected Oriented programming languages. By now you would have guessed that the three programming paradigms (styles) were imperative, object oriented and functional. There is one more, the declarative paradigm.</p><p name="e54d" id= "e54d" class="graf--p">The differences between these paradigms are because of the foundations on which they were based. Imperative and object oriented programming are based on the "turing machine". Functional programming is based on "lambda calculus" and declarative programming is based on "first order logic". In this chapter we will look at the differences between, imperative, object oriented and functional programming at a more practical level.</p><h4 name="3d3d" id="3d3d" class="graf--h4"><strong class="markup--strong markup--h4-strong">Imperative language</strong></h4><p name="5f0c" id="5f0c" class="graf--p">An imperative programming language is one in which program state change is achieved by executing a series of statements, and does flow control primarily using conditional statements, loop statements and function calls. The program given below is a simple implementation of the JavaScript Array.join method in an imperative manner.</p><pre name="689f" id="689f" class="graf--pre">function simpleJoin(stringArray) { <br> var accumulator = '' <br> for (var i=0, l=stringArray.length; i &lt; l; i++) { <br>   accumulator = accumulator + stringArray[i] <br> } <br> return accumulator <br>}</pre><h4 name="d7be" id="d7be" class="graf--h4"><strong class="markup--strong markup--h4-strong"> Object oriented language</strong></h4><p name="d589" id="d589" class="graf--p">The code above is straight forward. We iterate through an array and add each string element to the accumulator and return the accumulator. We will now rewrite this function in an object oriented manner. Since JavaScript has an Array class, we will add this method to the Array class, so that every instance of this class has access to this function. JavaScript use prototypal inheritance and so we add this function to the Array prototype.</p><pre name="6b71" id="6b71" class ="graf--pre">Array.prototype.simpleJoin = function() { <br> var accumulator = "" <br> for (var i=0, l=this.length; i &lt; l; i++) { <br>   accumulator = accumulator + this[i] <br> } <br> return accumulator <br>}</pre><p name="485b" id="485b" class="graf--p">As we can see, the object oriented version is quite like the imperative version, except that the function (method) is now a method of the class. Object oriented languages tend to be imperative languages also.</p><h4 name="c570" id="c570" class="graf--h4"><strong class="markup--strong markup--h4-strong" >Functional language</strong></h4><p name="f39b" id="f39b" class="graf--p">Now let us write the functional version of this function.</p><pre name="c928" id="c928" class="graf--pre"> function simpleJoin(stringArray, i, accumulator) { <br> if (i === stringArray.length) { <br>   return accumulator <br> } else { <br>   return simpleJoin(<br>            stringArray, i+1, accumulator+stringArray[i]) <br> } <br>}</pre><p name="9414" id="9414" class="graf--p">The first thing to note is that we are not using the for loop here for iteration. Instead we use recursion for iteration. Recursion happens when the function calls itself from within itself. Indeed this is one of the characteristics of a functional programming language. eg. Scheme does not have any loop statements. Instead it uses recursion for iteration. The function is called for the first time with the given array in stringArray, <strong class="markup--strong markup--p-strong">i</strong> set to <strong class="markup--strong markup--p-strong">0</strong>, and accumulator set to <strong class="markup--strong markup--p-strong">""</strong>. The second time around the function is called from within itself with the same stringArray, <strong class="markup--strong markup--p-strong">i</strong> set to <strong class="markup--strong markup--p-strong">i + 1</strong>, and accumulator set to <strong class="markup--strong markup--p-strong">accumulator + stringArray[i]</strong>. And we continue the same way until <strong class="markup--strong markup--p-strong">i === stringArray.length</strong> when we return the accumulator. We will discuss recursion in detail in a later chapter. Just remember we used recursion for doing iteration here.</p><p name="dfaa" id="dfaa" class="graf--p">There is still something imperative about this function. The if statement. Functional languages tend to use expressions that evaluate to some value, instead of statements that don't evaluate to anything. So let us rewrite the function, to make it as functional as possible in JavaScript.</p><pre name="0eb3" id="0eb3" class="graf--pre">function simpleJoin(stringArray, i, accumulator) { <br> return (i === stringArray.length) ? accumulator : <br>   simpleJoin(stringArray, i + 1, accumulator + stringArray[i]) <br>}</pre><p name="7530" id="7530" class="graf--p is-withNotes">Now this is as functional as you can get with JavaScript. Instead of the <strong class= "markup--strong markup--p-strong">if</strong> statement we return the value evaluated by the conditional operator&nbsp;<strong class="markup--strong markup--p-strong">?</strong>. The conditional operator&nbsp;<strong class="markup--strong markup--p-strong">?</strong> Takes a conditional expression and returns the value of one of the two expressions based the condition being true or false. The value of the first expression is returned if true and the second if false.</p><p name="bb48" id="bb48" class="graf--p">We can see that the functional version is concise. Indeed one of the advantages of functional programming is that it lends itself to lesser code to accomplish the same thing, leading to better readability and maintainability. </p><p name="5655" id="5655" class="graf--p">However in the case of JavaScript, as of now you need to use recursion with care. This is because JavaScript does not (yet) support "tail call optimisation". For doing proper recursion, tail call optimisation is required. We will discuss tail recursion, and tail call optimization, and how to get around this problem in the chapter on recursion. As of writing this book tail call optimization is expected in ecmascript 6.</p><h4 name="7d6d" id="7d6d" class="graf--h4"><strong class="markup--strong markup--h4-strong">Multi paradigm language</strong></h4><p name="d95f" id="d95f" class="graf--p">So is JavaScript an imperative language, or an object oriented language, or a functional language? It is a multi paradigm language. It does not have all the functional features implemented. But it is slowly getting there. This is also true of most other languages. Most languages (other than functional languages to begin with) have added functional features to various degrees over the years. A good example of the multi paradigm nature of JavaScript is the Array.forEach method. Here is a possible simple implementation. Note that all modern browsers have already implemented this.</p><pre name="d8f7" id="d8f7" class="graf--pre"> Array.prototype.forEach = function(callback) { <br> for (var i = 0, len = this.length; i &lt; len; ++i) { <br>   callback(this[i], i, this) <br> } <br>}</pre><p name="f331" id="f331" class ="graf--p">In the code above the for-loop part of the code is imperative. Adding to the array prototype and usage of <strong class="markup--strong markup--p-strong">this</strong> is object oriented. Passing a function as an argument to another function (callback) is functional and is a feature of functional programming known as "higher order function". In JavaScript, we take this for granted, passing functions as an argument. Surprisingly this was not a feature found in the most popular languages until recently. eg. You cannot pass functions as arguments in Java, though you can do it indirectly via Interfaces. Same is the case with C, though you can do it indirectly using pointers.</p><h4 name="4070" id="4070" class="graf--h4" ><strong class="markup--strong markup--h4-strong">Programming Abstractions</strong></h4><p name="be3f" id="be3f" class="graf--p">What if JavaScript did not have the "passing functions as arguments feature"? The answer to this question is crucial to understanding what functional programming brings to the table. For one, we would not be able to write the <strong class= "markup--strong markup--p-strong">Array.forEach</strong> function above. And even worse, every time we had to iterate over an array, we would have to write the same for-loop again and again. If we had <strong class="markup--strong markup--p-strong">Array.foreach</strong> we need to think only about writing the callback. We need to think only of what to do with each element of the array, and need not concern ourselves with iterating over the array. In other words we have "abstracted" away the iteration part of the problem, and freed ourselves to concentrate on each element of the array.</p><p name="a0d6" id="a0d6" class="graf--p">Abstractions are about hiding away implementation details, thereby reducing and factoring out details, so that programmers can focus on the problem at a higher level. Abstractions can be code abstractions, as we saw in the example above, and data abstractions. Objected oriented programming is about combining code and data abstractions into one abstraction called the class. In functional programming we use functional features like first class functions, nested functions, anonymous functions and closures to abstract away code and sometimes even data. Monads are an esoteric feature of functional programming that can even abstract away program structure!</p><p name="8021" id="8021" class="graf--p">Macro's are another feature that allows code abstraction. However macros are not a feature of functional programming. But they are found in all Lisp like functional languages like Lisp, Scheme, Clojure etc. There are attempts to bring Macro's to JavaScript and at the moment it is very much early days.</p><p name= "e059" id="e059" class="graf--p">A good example of the power of functional abstractions is <strong class="markup--strong markup--p-strong">jQuery</strong>. <strong class="markup--strong markup--p-strong">jQuery</strong> is the mother of all functional abstractions. It has abstracted away the JavaScript language itself! So much so that you wouldn't be surprised, if you found a jQuery programmer who knows very little or no JavaScript. As of Feb 2013 there was one publisher who had 32 jQuery books listed, and not a single JavaScript book! And jQuery has achieved so much mostly using only two functional features, functions as arguments and closures.</p><h4 name="d471" id="d471" class="graf--h4"><strong class="markup--strong markup--h4-strong">First Class Functions</strong></h4><p name="5bbf" id="5bbf" class="graf--p">The functional programming feature that Brendan Eich implemented in JavaScript was "first class functions". Functions are first class if they are treated as "first class citizens" of that language. Which implies functions are treated just like all other variables. ie. You can pass them as arguments to functions, you can return them as values from other functions, or you can assign them to variables or data structures. We have seen "passing functions are arguments" earlier. Here is an example of assigning a function to a variable.</p><pre name="f79a" id="f79a" class="graf--pre">function greet(name) { <br> console.log('Hello ' + name) <br>} </pre><pre name="41db" id="41db" class="graf--pre">greet("John") // "Hello John"</pre><pre name="b635" id="b635" class="graf--pre">var sayHello = greet <br>sayHello("Alex") // "Hello Alex" </pre><p name="e84f" id="e84f" class="graf--p">Some programming language theorists consider "anonymous functions" as first class functions. Not to be outdone, Brendan Eich threw anonymous functions into the mix. This is like letting the cat among the pigeons so to speak. But not for Brendan Eich, he knew the solution to the problem. Here is an anonymous function in JavaScript.</p><pre name="33f8" id="33f8" class="graf--pre">function(name) { <br> console.log("Hello " + name) <br>}</pre><p name="b9be" id="b9be" class="graf--p">If you noticed we did not give this function a name. After all, it is an anonymous function. If you try to run the code above, you will get an error. Something to the effect "you cannot run the code in this context". And rightly so. They can only be assigned to something, or passed as arguments to a function.</p><pre name="217b" id="217b" class="graf--pre">var sayHello = function(name) { <br> console.log("Hello " + name) <br>} <br>sayHello("Jane") // "Hello Jane"</pre><p name="0065" id="0065" class="graf--p">What if we wanted to change the greeting? Sometimes we would like to say "Hi" instead of "Hello". We could create a generic "createGreeting" function, which would in turn "compose" another function for you, and return the new composed function. So if we wanted to sat "Hi" it would return a function, and if we wanted to say "Hello" it would return another function that says "Hello". We can do all that because JavaScript supports first class functions, and we can return functions from other functions. Here is the code.</p><pre name="329c" id="329c" class="graf--pre">function createGreeting(greeting) { <br> return function(name) { <br>   console.log(greeting + " " + name) <br> } <br>} <br>var sayHi = createGreeting("Hi") <br>sayHi("Jack") // "Hi Jack" <br>var sayHello = createGreeting("Hello") <br> sayHello("Jack") // "Hello Jack"</pre><p name="29d7" id="29d7" class="graf--p">The <strong class="markup--strong markup--p-strong">createGreeting</strong> function takes a greeting as its argument. The function returns a newly created anonymous function. However the newly created anonymous function was created inside another function <strong class="markup--strong markup--p-strong">createGreeting</strong>. So it is also a nested function now. Now since our language supports anonymous functions it will also have to support nested functions. And when we return nested functions from our function we run into another problem. We will look at that in more detail.</p><h4 name="8993" id="8993" class="graf--h4"><strong class="markup--strong markup--h4-strong">Scope</strong></h4><p name="f15c" id="f15c" class="graf--p">The anonymous function takes a name argument and prints to the console <strong class="markup--strong markup--p-strong">greeting + name</strong>. The variable <strong class="markup--strong markup--p-strong">name</strong> is an argument to the anonymous function, and behaves just like any other variable defined within the function. In other words, <strong class="markup--strong markup--p-strong">name</strong> is "local" to the anonymous function. But this is not true of the variable <strong class="markup--strong markup--p-strong">greeting</strong>. It is defined in another function called createGreeting and hence is "non local" to the anonymous function. However the anonymous function can access the variable greeting due to something called lexical scoping.</p><p name="6598" id="6598" class="graf--p">The "scope" of a variable is its "visibility" within a program. "Lexical scope" means that visibility is limited to all the text (code). So when we say "local variables are lexically scoped" within a function, it means that the function's local variables are visible to all the text (code) in the function, even if the code is within another nested function. This also means that when you run the nested function outside the lexically scoped environment, the nested functions non local variable will not be visible. And there lies the problem of returning nested functions from another function. And indeed thats what we are doing here.</p><pre name="e9e3" id="e9e3" class="graf--pre">var sayHi = createGreeting("Hi")</pre><p name="f7b7" id="f7b7" class="graf--p">In the line above we assign the returned anonymous function to variable sayHi. And call the function in the next line.</p><pre name="de8c" id="de8c" class="graf--pre">sayHi("Jack")</pre><p name= "b37e" id="b37e" class="graf--p">We are calling sayHi outside of createGreeting. And the <strong class="markup--strong markup--p-strong">greeting</strong> variable is not available outside of createGreeting. The variables it may access in the scope where it was defined, may not be available in the scope where it was actually called. Thats why languages like C don't support nested functions. For this to work the language needs to support another functional programming feature called "closures". JavaScript supports closures. As matter of fact it has to support closures. Any language that supports first class functions and nested functions has to support closures.</p><h4 name="32cb" id="32cb" class="graf--h4"><strong class= "markup--strong markup--h4-strong">Closure</strong></h4><p name="bdf7" id="bdf7" class="graf--p">A function's closure is a reference to all its non local variables. In the previous example <strong class="markup--strong markup--p-strong">greeting</strong> was the non local variable and <strong class="markup--strong markup--p-strong">name</strong> was the local variable. A closure is a table of references to all of a functions non local variables. This allows the function to continue to refer to the non local variable even when the function is out of the scope of the variables.</p><p name="89c0" id="89c0" class="graf--p">Creating Closures is a very important pattern used in functional programming. It hides away parts of your program variables and methods, and create a higher level abstraction. The createGreeting function created a closure for the <strong class="markup--strong markup--p-strong">greeting </strong> variable. It is akin to using private variables and methods in object oriented programming.</p><p name="a6b6" id="a6b6" class="graf--p graf--last is-withNotes">When programming in a functional style, creating a closure is something you do by default. It should come to you naturally. You will see creation of closures in almost every chapter of this book. Recursion, currying, composition, memoization, modules all create closures.</p></div>			</div>		<!--=========================			END : POST =============================-->		<!--=========================			START : POST		=============================-->		<div class="post-wrapper"><div class= "section-inner layoutSingleColumn"><h2 name="title" id="title" class="graf--h2 graf--first">Recursion</h2><h4 name="subtitle" id="subtitle" class="graf--h4">Recursion, Tail Calls, Proper Tail Calls, Examples</h4><p class="graf--p graf--empty"><br></p><p name="4d88" id="4d88" class="graf--p">Recursion is the process in which a function is called by itself, either directly or indirectly. Recursion allows you to write some very elegant code. But when using recursion you need to be aware of the pitfals.</p><h4 name="5498" id="5498" class="graf--h4"><strong class="markup--strong markup--h4-strong">Recursion example</strong></h4><p name="4b36" id="4b36" class="graf--p">Here is a function that will call itself a given number of times.</p><pre name="910c" id="910c" class="graf--pre">function factorial(n, accumulator) {<br>  if (n === 0) {<br>    return accumulator<br>  }<br>  return factorial(n - 1, n * accumulator)<br>}<br> factorial(5, 1) //==&gt;&gt; 120</pre><p name="5e84" id="5e84" class="graf--p">The function above will recursively call the factorial function from 5 to 0 with an accumulator value. The condition n === 0 is the break condition for this function. Every recursive function must have a break condition. Otherwise calling the function will lead to an infinite loop.</p><h4 name= "9475" id="9475" class="graf--h4"><strong class="markup--strong markup--h4-strong">Tail Call</strong></h4><p name="cdae" id="cdae" class="graf--p">A tail call is a function call whose return value is used as the callers return value. In the function above <strong class="markup--strong markup--p-strong">return factorial(n - 1, n * accumulator)</strong> is a tail call. </p><p name="a1b3" id="a1b3" class="graf--p">In JavaScript every function call will add a call frame to the call stack. The frame is popped off the call stack when the call returns. However a recursive function does not return immediately. It will make a recursive call before it returns. This will add to the call stack every time. Recursively calling from the tail position sufficently deep, will cause the call stack to run out of space, throwing a RangeError.</p><h4 name="232c" id="232c" class="graf--h4"><strong class="markup--strong markup--h4-strong">Proper Tail Call</strong></h4><p name="b4c1" id="b4c1" class="graf--p">A "Proper Tail Call" is a mechanism by which the language compiler recognizes tail calls, and reuses the call frame, so that the call stack does not grow. The tail call does not need the call frame anyway, since its only job is to return the call. Proper tail calls are otherwise known as tail call optimization.</p><p name="5550" id="5550" class="graf--p">Tail call optimizations are important to functional programming languages as they are used for iteration and extreme recursion. The language Scheme uses recursion for all loop constructs, and does not have any other looping mechanism.</p><p name="b5b6" id="b5b6" class="graf--p is-withNotes">Does that mean we cannot use recursion in JavaScript? The answer is no. We can, but we need to use it carefully. For the call stack to throw a RangeError we need to recurse to a depth of more than 10000. We can safely use recursion when we know that we are in a situation that will never hit that limit. Examples are</p><ul class="postList"><li name="6bbf" id="6bbf" class= "graf--li">Iterating over nested Objects like the DOM.</li><li name="ff09" id="ff09" class="graf--li">Iterating over the arguments of a function.</li><li name="3f73" id="3f73" class= "graf--li">ES6 specifies proper tail calls. So you can use recursion safely in future, in ES6 compliant engines.</li></ul><h4 name="36b0" id="36b0" class="graf--h4"><strong class= "markup--strong markup--h4-strong">Iterating over an Object</strong></h4><p name="5300" id="5300" class="graf--p">We will write a simple JSON stringify function using recursion.</p><pre name="823f" id="823f" class="graf--pre">var test = {<br>  name: "John",<br>  age: 21,<br>  scores: [89, 72, 96, 55, 66]<br>}</pre><pre name="bc35" id="bc35" class="graf--pre">function type(obj) {<br>  return Object.prototype.toString.call(obj).match(/.* (.*)\]/)[  1]<br>}</pre><pre name="5a35" id="5a35" class="graf--pre">function stringify(obj) {</pre><pre name="1781" id="1781" class="graf--pre">  if (type(obj) === "Function") {<br>    return null<br>  }<br>  if (type(obj) === "Undefined") {<br>    return null<br>  }<br>  if (type(obj) === "Null") {<br> return "null"<br>  }<br>  if (type(obj) === "Number") {<br>    return obj<br>  }<br>  if (type(obj) === "String") {<br>    return '"' + obj + '"'<br>  }<br>  if (type(obj) === "Array") {<br>    return '[' +<br>      obj.map(function(o) {<br>        return stringify(o)<br>      }).join(",")<br>      + ']'<br>  }<br>  if (type(obj) === "Object") {<br>    var result = []<br>    Object.keys(obj).forEach(function(key) {<br>      var val = stringify(obj[key])<br>      if (val !== null) {<br>        result.push('"' + key + '": ' + val)<br>      } <br>    })<br>    return "{" + result.join(",") + "}"<br>  }<br>}</pre><pre name="ed55" id="ed55" class="graf--pre">stringify(test) //==&gt; {"name": "John","age": 21,"scores": [89,72,96,55,66]}</pre><p name="ea03" id="ea03" class="graf--p">The function type returns the type of the given object as a string. Function <strong class="markup--strong markup--p-strong" >stringify</strong> will return the corresponding stringified object based on the type. It is recursively called when the type is Array or Object. As you can see, recursion is a very elegant way to do a task.</p><h4 name="a473" id="a473" class="graf--h4"><strong class="markup--strong markup--h4-strong">Asynchronous calls using recursion</strong></h4><p name="75d2" id= "75d2" class="graf--p">You can write a series of asynchronous calls without nesting them, by using recursion. Here is a function asyncSerial which takes a set of asynchrous functions as its arguments. It calls each function with a function called <strong class="markup--strong markup--p-strong">next</strong>. Inside the callback of the asynchronous function you must call <strong class="markup--strong markup--p-strong">next</strong> to trigger the next function in the series.</p><pre name="106c" id="106c" class="graf--pre">function asyncSerial() {<br>  var args = Array.prototype.slice.call(arguments)<br>  function next() {<br>    var func = args.shift()<br>    if (func) {<br>      func(next)<br>    }<br>  }<br>  next()<br>}</pre><p name= "4dc6" id="4dc6" class="graf--p">The arguments to <strong class="markup--strong markup--p-strong">asyncSerial</strong> are coerced into an array called args. The function <strong class= "markup--strong markup--p-strong">next</strong> when called will shift out the first element of <strong class="markup--strong markup--p-strong">args</strong> which will be a function. Then it simply calls the function with itself as the argument. <strong class="markup--strong markup--p-strong">next</strong> will be called inside the callback defined inside the funtion. See this in action.</p><p name="669a" id="669a" class="graf--p">The example below is a nodejs program to asynchronously copy an input file to an output file. It makes three asynchronous calls. <strong class="markup--strong markup--p-strong">fs.exists</strong>, <strong class="markup--strong markup--p-strong">fs.readFile</strong>, <strong class="markup--strong markup--p-strong">fs.writeFile</strong>. Of cource we could write such a program in one line of code, but the purpose of this example is show you how you can use recursion, and how you can use it solve your own problem.</p><pre name="ac09" id="ac09" class="graf--pre">var fs = require("fs"),<br>  infile,<br>  outfile,<br>  data</pre><pre name="cd97" id="cd97" class= "graf--pre">function asyncSerial() {<br>  var args = Array.prototype.slice.call(arguments)<br>  function next() {<br>    var func = args.shift()<br>    if (func) {<br>      func(next)<br> }<br>  }<br>  next()<br>}</pre><pre name="50c4" id="50c4" class="graf--pre">asyncSerial(<br>  function(next) {<br>    infile = process.argv[2] || "";<br>    fs.exists(infile, function (exists) {<br>      if (exists) {<br>        next();<br>      } else {<br>        console.log("File does not exist: " + this.infile)<br>      }<br>    })<br>  },<br>  function(next) {<br> outfile = process.argv[3]<br>    if (outfile) {<br>      next();<br>    } else {<br>      console.log("Output File Name is Required")<br>    }<br>  },<br>  function(next) {<br> fs.readFile(infile, function (err, contents) {<br>      if (err) {<br>        console.log("Error reading File: " + infile)<br>      } else {<br>        data = contents<br>        next() <br>      }<br>    })<br>  },<br>  function() {<br>    fs.writeFile(outfile, data, function (err) {<br>      if (err) {<br>        console.log("Error writing File: " + outfile)<br>      } <br>    })<br>  }</pre><pre name="ffbc" id="ffbc" class="graf--pre">)</pre><p name="cb04" id="cb04" class="graf--p graf--last"><strong class="markup--strong markup--p-strong">asyncSerial </strong> is called with four functions as its arguments. Each function is called with <strong class="markup--strong markup--p-strong">next</strong>. The functions in turn call <strong class="markup--strong markup--p-strong">next</strong> from inside their callbacks. In case of error they simple don't call <strong class="markup--strong markup--p-strong">next</strong> at that point, and the program terminates.</p></div>			</div>		<!--=========================			END : POST =============================--><!--=========================			START : POST		=============================-->		<div class="post-wrapper">		<post no-compile=""><p> They are all around you, your code, your company, your community, your frameworks. You may not be aware of them or perhaps you never properly understood what is going on with them, but trust me: your life will never be the same without them. They are unique and pave the way for <strong>Functional programming</strong>. With you, <strong>Higher-order functions</strong>! </p><h2 id="higher-order-functions-101">Higher-order functions 101</h2><p>According to Wikipedia<sup>[<a href="#r1">1</a>]</sup>, a <strong>higher-order function</strong> is a function that does at least one of the following:</p><ol><li>Takes one or more functions as an input</li><li>Outputs a function</li></ol><p>All other functions are <strong>first-order functions </strong>.</p><h3 id="higher-order-functions-in-javascript">Higher-order functions in JavaScript</h3><p>In JavaScript, functions are first-class citizens, meaning they can be assigned and passed around like other data types (eg. integers, strings, arrays and objects). While this might not be big news for you (I bet you've written callbacks once or twice), it means that you can write optimized code for higher-order functions and take advantage of its properties.</p><p>Ok, but why should you bother with these fancy-pants functions?</p><p>In a glance: they are powerful, very expressive, easy to read, great to reuse, effective to maintain and will also tidy up your code.</p><p>Just to name a few use cases, you can:</p><ul><li>Abstract your work into small chunks (think work steps), and feed them to other functions.</li><li>Decorate functions in order to augment their behavior.</li><li>Write functions that create other functions dynamically.</li><li>Compose a serie of functions to generate other functions.</li></ul><h2 id="programming-paradigms">Programming paradigms</h2><p>Before we proceed, let's take a quick dive into some fundamental programming paradigms:</p><h3 id="imperative-programming">Imperative programming</h3><p><strong>Imperative programming</strong> is one of the most common programming paradigms around us, found in programs written in languages as C++, Python, Ruby, Java and C#. I would bet this paradigm was being used when you learned how to program.</p><p> This is about <em>telling your computer HOW to do its work and figuring out the details yourself</em>, so that the code:</p><ul><li>is based on a sequence of low-level/detailed steps that must happen in order</li><li>describes each operation in minimal details</li><li>makes changes to the data (mutable)</li><li>manipulates the application state (stateful)</li></ul><h3 id= "declarative-programming">Declarative programming</h3><p>On the other hand, <strong>Declarative programming</strong>, found in programs written in languages as SQL, Haskell, Clojure and Scala, is about <em>telling your computer WHAT you want and letting him figure out the details</em>. This way, the code:</p><ul><li>is based on a sequence of high-level/abstracted steps that might not require an order</li><li>relies on an engine, interpreter or API to fill in the minimal details of each operation</li><li>doesn't make changes to the data (immutable) </li><li>keeps the application state intact (stateless)</li></ul><h3 id="functional-prgogramming">Functional prgogramming</h3><p>Now, <strong>Functional programming</strong> is a powerful programming paradigm under Declarative programming, which stands on the shoulders of <em>higher-order functions</em>. It is based out on mathematical principles, striving to describe computation as the evaluation of mathematical functions.</p><p>There are some basic principles that must always be followed:</p><ol><li><strong>Functions as a flow</strong>: functions should be used to abstract operations, and your code should be described by a sequence of high-level functions instead of a sequence of low-level statements.</li><li><strong>Data immutability</strong>: data in functional programming should be immutable, which means any operation should be made over a new copy of the data, leaving  the original data untouched. </li><li><strong>Function purity</strong>: functions should be pure, which means they should be indefinitely repeatable (idempotent) and should not keep track of its past (stateless). This way, they should always return the same output for a particular input and won't generate any side-effect.</li></ol><p>Actually, Functional programming is way more than that! There are great concepts such as currying, composing, functors, point-free, monads... Anyhow, this article is really about Higher-order functions, so we won't be going any deeper in Functional programming for now.</p><p>JavaScript is considered a hybrid language, so that it is possible to write code either following an Imperative or a Declarative/Functional approach.</p><h2 id= "imperative-vs-functional-approach">Imperative vs Functional approach</h2><p>In order to illustrate the power of higher-order functions, there is nothing better than looking into different implementations of the same program. Suppose your requirement is:</p><blockquote><p>Write a <code>Number</code> function which takes a number and implements the operations <code> half()</code>, <code>third()</code> and <code>multiplyBy(anotherNumber)</code>.</p></blockquote><p>Let's first have a look at a typical object-oriented Imperative implementation in JavaScript:</p><pre class="  language-javascript"><code class="  language-javascript" data-language="javascript"><span class="token comment" spellcheck="true">// Number definition </span><span class="token keyword">var</span> Number <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>number<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">this</span><span class="token punctuation">.</span>number <span class="token operator">=</span> number<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">;</span>Number<span class="token punctuation">. </span>prototype<span class="token punctuation">.</span>half <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">this</span><span class="token punctuation">.</span>number <span class="token operator">/</span><span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class= "token punctuation">;</span>Number<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>third <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">this </span><span class="token punctuation">.</span>number <span class="token operator">/</span><span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">;</span>Number<span class="token punctuation">.</span>prototype<span class="token punctuation"> .</span>multiplyBy <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>anotherNumber<span class="token punctuation">) </span> <span class="token punctuation">{</span>    <span class="token keyword">this</span><span class="token punctuation">.</span>number <span class="token operator">*</span><span class= "token operator">=</span> anotherNumber<span class="token punctuation">.</span>number<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre><footer>Like learning from posts like this? <a onclick="$('#postSubscribeEmail').focus()"><b>Subscribe for more!</b></a></footer><pre class=" language-javascript"><code class="  language-javascript" data-language="javascript"><span class="token comment" spellcheck="true">// Calculate ( ( 270 / 3 / 2 / 3 ) * ( 270 / 3 / 3 / 3 ) ) / 2</span><span class="token keyword">var</span> n1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Number</span><span class= "token punctuation">(</span><span class="token number">270</span><span class="token punctuation">)</span><span class="token punctuation">;</span>n1<span class="token punctuation">. </span><span class="token function">third<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>n1<span class= "token punctuation">.</span><span class="token function">half<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span> n1<span class="token punctuation">.</span><span class="token function">third<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">var</span> n2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Number </span><span class="token punctuation">(</span><span class="token number">270</span><span class="token punctuation">)</span><span class="token punctuation">;</span>n2<span class="token punctuation">.</span><span class="token function">third<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>n2 <span class="token punctuation">.</span><span class="token function">third<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>n2<span class="token punctuation">.</span><span class="token function">third<span class="token punctuation">(</span></span><span class="token punctuation">) </span><span class="token punctuation">;</span>n1<span class="token punctuation">.</span><span class="token function">multiplyBy<span class="token punctuation">(</span></span>n2<span class ="token punctuation">)</span><span class="token punctuation">;</span>n1<span class="token punctuation">.</span><span class="token function">half<span class="token punctuation">( </span></span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// n1.number = 75, n2.number = 10 </span></code></pre><footer>Like learning from posts like this? <a onclick="$('#postSubscribeEmail').focus()"><b>Subscribe for more!</b></a></footer><p>Here are some observations about this implementation:</p><ul><li>Notice how each operation changes the state of the instances of <code>Number</code>. Thus, data is mutable.</li><li>The method <code>third</code> is called multiple times in a row to modify the internal state of the instances, which can be misleading. Just ask yourself: can you easily tell what is the current state of each instance after each operation?. </li><li>Two different instances of <code>Number(270)</code> need to be created so that the method <code>multiplyBy</code> can be called. </li><li>The operations' definitions only work with <code>Number</code>, which is not much reusable.</li></ul><p>Now, the same program in a more Functional approach, using the higher-order function <code>apply </code> behind the scenes:</p><pre class="  language-javascript"><code class="  language-javascript" data-language="javascript"><span class="token comment" spellcheck="true">// Number definition</span><span class="token keyword">var</span> Number <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span> number<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">var</span> apply <span class="token operator">=</span> <span class= "token keyword">function</span><span class="token punctuation">(</span>fn<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">return</span> <span class="token keyword">function</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Number</span><span class="token punctuation">(</span><span class ="token function">fn<span class="token punctuation">(</span></span>number<span class="token punctuation">,</span> n <span class="token operator">&amp;&amp;</span> n<span class="token punctuation">.</span>number<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">} </span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class ="token punctuation">{</span>        number<span class="token punctuation">:</span> number<span class="token punctuation">,</span>        half<span class="token punctuation">:</span> <span class="token function">apply<span class="token punctuation">(</span></span><span class="token keyword">function</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token keyword">return</span> a <span class="token operator">/</span> <span class="token number">2 </span><span class="token punctuation">;</span>        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>        third <span class="token punctuation">:</span> <span class="token function">apply<span class="token punctuation">(</span></span><span class="token keyword">function</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token keyword">return</span> a <span class="token operator"> /</span> <span class="token number">3</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class= "token punctuation">,</span>        multiplyBy<span class="token punctuation">:</span> <span class="token function">apply<span class="token punctuation">(</span></span><span class="token keyword">function</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> a <span class="token operator">*</span> b<span class="token punctuation">;</span>        <span class="token punctuation">}</span><span class="token punctuation">)</span>    <span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre><footer>Like learning from posts like this? <a onclick="$('#postSubscribeEmail').focus()"><b>Subscribe for more!</b></a></footer><pre class=" language-javascript"><code class="  language-javascript" data-language="javascript"><span class="token comment" spellcheck="true">// Calculate ( ( 270 / 3 / 2 / 3 ) * ( 270 / 3 / 3 / 3 ) ) / 2</span><span class="token keyword">var</span> n <span class="token operator">=</span> <span class="token function">Number<span class="token punctuation">(</span></span><span class= "token number">270</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">var</span> result <span class="token operator">=</span> n<span class="token punctuation">.</span><span class="token function">third<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">half<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">third<span class="token punctuation">(</span></span><span class="token punctuation">)</span>      <span class="token comment" spellcheck="true">// temp result = 15 </span>    <span class="token punctuation">.</span><span class="token function">multiplyBy<span class="token punctuation">(</span></span>        n<span class="token punctuation">. </span><span class="token function">third<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">third<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">third<span class= "token punctuation">(</span></span><span class="token punctuation">)</span>            <span class="token comment" spellcheck="true">// temp result = 10</span>    <span class="token punctuation">)</span>                                       <span class="token comment" spellcheck="true">// temp result = 150</span>    <span class="token punctuation">.</span><span class ="token function">half<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck= "true">// result.number = 75, n.number = 270</span></code></pre><footer>Like learning from posts like this? <a onclick="$('#postSubscribeEmail').focus()"><b>Subscribe for more! </b></a></footer><p>Follow the observations about this implementation:</p><ul><li>In this program, every operation returns a new instance of <code>Number</code>. Thus, data is immutable. </li><li>The operations can be chained in such a way the intermediate results need not to be stored. This chained API is easy to use and understand.</li><li><code>third</code>, <code>half </code> and <code>multiplyBy</code> can be called multiple times in a row with no consequence to the internal state of the instances. This way, we don't need to worry with side-effects. </li><li>Also, the operations' definitions are very generic, as the arguments are plain numbers as <code>a</code> and <code>b</code> instead of instances of <code>Number</code>. This way, they are way more reusable.</li><li>Because of that, only one instance of <code>Number(270)</code> is needed so that the method <code>multiplyBy</code> can be called.</li><li>We are using here the concept of <strong>partial application</strong> with the higher-order function <code>apply</code>, as this function is generating another function where we are partially applying the 1st argument as the internal value of <code>Number</code>.</li></ul><h2 id="to-be-continued-">To be continued...</h2><p>The intent of this article is to illustrate the power of higher-order functions and hopefully to motivate you, my fellow reader, to start using them in your everyday work.</p><p>Little by little, you will get so used to them in JavaScript that you may even feel a bit helpless if you go back to a language that doesn't support them. Besides, as a bonus, you will get your foot in the door of Functional programming!</p></post> </div>		<!--=========================			END : POST		=============================-->		<!--=========================			START : POST =============================-->		<div class="post-wrapper">		<h1 class="entry-title">JavaScript Jargon: 10 Terms You Should Know</h1>		<div class="entry-content-inner "> <p>From <em>currying</em> to <em>closures</em> there are quite a number of JavaScript jargons (special words used within the field) knowing which will not only help you increase your vocabulary but understand JavaScript better. <strong>Jargons are normally found in documentations and technical articles</strong>. But some of them like <em>closures</em> are pretty standard things to know about. Knowing what the word itself mean can help you know the concept it is named for better.</p><p>This post is the compilation of 10 such terms with <strong> their meaning </strong>and<strong> the context in which they are used</strong> in JavaScript. If you're a beginner then this list has got you covered with the basics like <em>hoisting</em> . At the same time less-known or less-understood terms are also included in there. </p><ol><li><a href="#1_Arity">Arity</a></li><li><a href="#2_Anonymous">Anonymous</a></li><li><a href= "#3_Closure">Closure</a></li><li><a href="#4_Currying">Currying</a></li><li><a href="#5_Hoisting">Hoisting</a></li><li><a href="#6_Mutation">Mutation</a></li><li><a href="#7_Pragma">Pragma </a></li><li><a href="#8_Sentinel">Sentinel</a></li><li><a href="#9_Vanilla">Vanilla</a></li><li><a href="#10_Variadic">Variadic</a></li></ol><h4><a name="1_Arity"></a>1. Arity</h4><p><em> Arity</em> (from Latin) is the term used to refer to the number of arguments or operands in a function or operation respectively. You're most likely to come across this word in the realm of JavaScript when it is used to mention the <strong>number of arguments expected by a JavaScript function</strong>.</p><p>There  is even a property named <a href=" https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function/arity">arity</a>, of the <code>Function</code> object that returns the number of expected arguments in a function. It is now obsolete though and replaced by <code>length</code>.</p><p>The following function has an arity of 3.</p><div><div id="highlighter_251178" class= "syntaxhighlighter  javascript"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class= "javascript keyword">function</code> <code class="javascript plain">getName(first, middle, last){</code></div><div class="line number2 index1 alt1"><code class="javascript spaces"> &nbsp;&nbsp;&nbsp;&nbsp;</code><code class="javascript keyword">return</code> <code class="javascript plain">first+</code><code class="javascript string">' '</code><code class="javascript plain">+ middle +</code><code class="javascript string">' '</code><code class="javascript plain">+last;</code></div><div class="line number3 index2 alt2"><code class="javascript plain">} </code></div></div></td></tr></tbody></table></div></div><h4><a name="2_Anonymous"></a>2. Anonymous</h4><p><em>Anonymous</em> is an adjective. When something or someone is referred to as anonymous it means that thing's or person's name is unidentified. Likewise in JavaScript an anonymous function is the one that is not identified by a name.</p><div><div id= "highlighter_752839" class="syntaxhighlighter  javascript"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="javascript plain">(</code><code class="javascript keyword">function</code> <code class="javascript plain">(){</code></div><div class="line number2 index1 alt1" ><code class="javascript spaces">&nbsp;&nbsp;</code><code class="javascript comments">//body</code></div><div class="line number3 index2 alt2"><code class="javascript plain">})(); </code></div></div></td></tr></tbody></table></div></div><p>Above is an <a href="http://www.hongkiat.com/blog/javascript-functions/">IIFE</a> (Immediately Invoked Function Expression). The function in it is anonymous since it doesn't have a name. Now, take a look at the one below.</p><div><div id="highlighter_740662" class="syntaxhighlighter  javascript"><table border= "0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="javascript keyword">var</code> <code class= "javascript plain">foo = </code><code class="javascript keyword">function</code><code class="javascript plain">() {</code></div><div class="line number2 index1 alt1">&nbsp;</div><div class ="line number3 index2 alt2"><code class="javascript plain">};</code></div></div></td></tr></tbody></table></div></div><p>That is also said to be an anonymous function since there is no name after the key word <code>function</code>.</p><p>A little bit of doubt  rises in the correctness of the use of the word "anonymous". With IIFE, the function gets called right away, no name involved whereas, to call the latter function the syntax <code>foo()</code> is used.</p><p>It's like we christened a nameless function with the name 'foo' and called it using that. Does that count as anonymous? I don't know, I'll leave that to the English experts. But, my confusion aside, they both are indeed referred to as anonymous function.</p><h4><a name= "3_Closure"></a>3. Closure</h4><p>Here's one of the definitions from oxford dictionary for <em>closure</em>: "<em>A thing that closes or seals something, such as a cap or tie</em>."</p><p> In JavaScript, closure is an inner function, that is accessible outside of its outer function's scope, with its connection to the outer function's variables still intact.</p><p>To explain things (maybe not accurately but simply enough), consider <em>closure</em> as a waiter in a restaurant. A lot of things happen inside a restaurant kitchen, where we are not allowed to enter or see. But how are we supposed to get our food then?</p><p>That is where waiters come in. We call them, order the food, and then they'll go to the kitchen, inform the chefs of the orders, and bring it to us when the order is ready. This way we've not broken any "rules" and can still manage to grab a meal.</p><p>The waiter is someone who is able to take our order into the kitchen and return with the food. JavaScript <em>closures</em> are similar to that, they are able to <strong>take our parameters </strong>and<strong> bring back us variables </strong> (references to those variables, to be precise) from inside a function that we aren't allowed in.</p><div><div id="highlighter_336147" class="syntaxhighlighter  javascript"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="javascript keyword">function</code> <code class="javascript plain">order() {</code></div><div class="line number2 index1 alt1"><code class="javascript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="javascript keyword">var </code> <code class="javascript plain">food;&nbsp;&nbsp; </code></div><div class="line number3 index2 alt2"><code class="javascript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class= "javascript keyword">function</code> <code class="javascript plain">waiter(order) {</code></div><div class="line number4 index3 alt1"><code class="javascript spaces"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="javascript plain">chef(order);</code></div><div class="line number5 index4 alt2"><code class="javascript spaces"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="javascript keyword">return</code> <code class="javascript plain">food;</code></div><div class="line number6 index5 alt1" ><code class="javascript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="javascript plain">}</code></div><div class="line number7 index6 alt2"><code class="javascript spaces"> &nbsp;&nbsp;&nbsp;&nbsp;</code><code class="javascript keyword">function</code> <code class="javascript plain">chef(order) {</code></div><div class="line number8 index7 alt1"><code class= "javascript spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="javascript keyword">if</code> <code class="javascript plain">(order === </code><code class= "javascript string">'pasta'</code><code class="javascript plain">) {</code></div><div class="line number9 index8 alt2"><code class="javascript spaces"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="javascript plain">food = [</code><code class="javascript string">'pasta'</code><code class= "javascript plain">, </code><code class="javascript string">'gravy'</code><code class="javascript plain">, </code><code class="javascript string">'seasoning'</code><code class="javascript plain">];</code></div><div class="line number10 index9 alt1"><code class="javascript spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class= "javascript plain">cook();</code></div><div class="line number11 index10 alt2"><code class="javascript spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class= "javascript plain">}</code></div><div class="line number12 index11 alt1"><code class="javascript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="javascript plain">}</code></div><div class="line number13 index12 alt2"><code class="javascript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="javascript keyword">function</code> <code class="javascript plain">cook() { food.push(</code><code class="javascript string">'cooked'</code><code class="javascript plain">); }</code></div><div class="line number14 index13 alt1"><code class="javascript spaces"> &nbsp;&nbsp;&nbsp;&nbsp;</code><code class="javascript keyword">return</code> <code class="javascript plain">waiter;</code></div><div class="line number15 index14 alt2"><code class= "javascript plain">}</code></div><div class="line number16 index15 alt1"><code class="javascript keyword">var</code> <code class="javascript plain">myOrder = order();</code></div><div class="line number17 index16 alt2"><code class="javascript plain">console.log(myOrder(</code><code class="javascript string">'pasta'</code><code class="javascript plain">)); </code></div><div class="line number18 index17 alt1"><code class="javascript comments">// Array [ "pasta", "gravy", "seasoning", "cooked" ] </code></div></div></td></tr></tbody></table></div></div><p>As you can see from the above code, everything apart from <code>waiter</code> and its return value from inside the order function isn't exposed to the outside world.</p><h4><a name="4_Currying"></a>4. Currying</h4><p>The effect, named after <a href="https://en.wikipedia.org/wiki/Haskell_Curry">Haskell Curry </a>, refers to <strong>using multiple functions with single arguments</strong>, in place of a single function with multiple arguments. Let's see the <code>add</code> functions below for example.</p><div><div id="highlighter_733408" class="syntaxhighlighter  javascript"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container" ><div class="line number1 index0 alt2"><code class="javascript keyword">function</code> <code class="javascript plain">addx(x){</code></div><div class="line number2 index1 alt1"><code class="javascript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="javascript keyword">function</code> <code class="javascript plain">addy(y){</code></div><div class="line number3 index2 alt2"><code class="javascript spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="javascript keyword">return</code> <code class="javascript plain">x+y; </code></div><div class="line number4 index3 alt1"><code class="javascript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="javascript plain">}</code></div><div class="line number5 index4 alt2"><code class="javascript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="javascript keyword">return</code> <code class="javascript plain">addy</code></div><div class="line number6 index5 alt1"><code class="javascript plain">}</code></div><div class="line number7 index6 alt2">&nbsp;</div><div class="line number8 index7 alt1"><code class="javascript keyword"> function</code> <code class="javascript plain">add(x,y){</code></div><div class="line number9 index8 alt2"><code class="javascript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class= "javascript keyword">return</code><code class="javascript plain">(x+y);</code></div><div class="line number10 index9 alt1"><code class="javascript plain">}</code></div><div class="line number11 index10 alt2">&nbsp;</div><div class="line number12 index11 alt1"><code class="javascript plain">console.log(addx(3)(4)); \\7</code></div><div class="line number13 index12 alt2" ><code class="javascript plain">console.log(add(3,4)); \\7</code></div></div></td></tr></tbody></table></div></div><p>Both of the functions return the same result. The function <code>addx </code> accepts a parameter <code>x</code> while returning <code>addy</code> which in turn accepts the <code>y</code> value, performs the addition with <code>x</code> and returns the sum. </p><p>The function <code>add</code> simply takes both <code>x</code> and <code>y</code> at the same time, performs the addition and returns the sum. So far the first function might not seem very useful, until...</p><div><div id="highlighter_266304" class="syntaxhighlighter  javascript"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="javascript keyword">var</code> <code class="javascript plain">add4 = addx(4);</code></div><div class="line number2 index1 alt1"><code class="javascript plain">console.log(add4(8)); </code><code class="javascript comments">//12</code></div><div class="line number3 index2 alt2"><code class="javascript plain">console.log(add4(6)); </code><code class="javascript comments">//10</code></div><div class="line number4 index3 alt1"><code class="javascript plain">console.log(add4(-74)); </code><code class="javascript comments">//-70</code></div></div></td></tr></tbody></table></div></div><p>Now, the former function suddenly gets interesting. In currying, you can always fix a step in a sequence of operations like the addition of 4 from the above code, which is helpful when one of the variables used in the operation is always the same.</p><h4><a name= "5_Hoisting"></a>5. Hoisting</h4><p>Hoist means to raise something. <em>Hoisting</em> in JavaScript also means the same and what gets raised is the declaration (variable &amp; function declarations).</p><p>Declarations are where variables and functions are created with keywords <code>var</code>(not for global) and <code>function</code>.</p><p>It doesn't matter where you type the code to declare a function or variable, during evaluation all the declarations are moved up inside the scope where they reside (except for in strict mode). Hence, it is possible to write a working code with the code for function call placed before function declaration.</p><div><div id="highlighter_525621" class="syntaxhighlighter  javascript"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="javascript keyword">var</code> <code class= "javascript plain">name = </code><code class="javascript string">'Velma'</code><code class="javascript plain">;</code></div><div class="line number2 index1 alt1"><code class="javascript plain">console.log(sayCatchPhrase(name)); </code><code class="javascript comments">//"Jinkies!"</code></div><div class="line number3 index2 alt2">&nbsp;</div><div class="line number4 index3 alt1"><code class="javascript keyword">function</code> <code class="javascript plain">sayCatchPhrase(name) {</code></div><div class="line number5 index4 alt2"><code class= "javascript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="javascript plain">phrases = {</code></div><div class="line number6 index5 alt1"><code class="javascript spaces"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="javascript string">'Fred Flintstone'</code><code class="javascript plain">: </code><code class="javascript string"> 'Yabba dabba doo!'</code><code class="javascript plain">,</code></div><div class="line number7 index6 alt2"><code class="javascript spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="javascript string">'Velma'</code><code class="javascript plain">: </code><code class="javascript string">'Jinkies!'</code><code class="javascript plain">, </code></div><div class="line number8 index7 alt1"><code class="javascript spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="javascript string">'Razor' </code><code class="javascript plain">: </code><code class="javascript string">'Bingo!'</code><code class="javascript plain">,</code></div><div class="line number9 index8 alt2"><code class ="javascript spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="javascript string">'He-Man'</code><code class="javascript plain">: </code><code class="javascript string">'I Have the Power'</code></div><div class="line number10 index9 alt1"><code class="javascript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="javascript plain">}; </code></div><div class="line number11 index10 alt2"><code class="javascript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="javascript keyword">return</code> <code class="javascript plain">phrases[name];</code></div><div class="line number12 index11 alt1"><code class="javascript plain">}</code></div></div></td></tr></tbody></table></div></div><h4><a name="6_Mutation" ></a>6. Mutation</h4><p>Mutation means change or modification. If you ever come across the word mutation in JavaScript it is probably referring to the changes that DOM elements went through.</p><p>There is even an API called MutationObserver to keep an eye out for the DOM mutations like <strong>addition of child elements</strong> or <strong>changes to the element's attributes</strong>. (You can read more about <a href="http://www.hongkiat.com/blog/mutationobserver-api/http://www.hongkiat.com/blog/mutationobserver-api/">MutationObserver</a> in my post.)</p><h4><a name="7_Pragma_151"></a>7. Pragma</h4><p><em>Pragma</em> is short for pragmatic information. In plain English, pragmatic is an adjective that means sensible and practical. In programming, <em>pragma</em> refers to the code that consist of useful information on <strong>how a compiler or interpreter or assembler should process the program</strong>. </p><p>It does not contribute anything to the programming language itself and its syntax may vary. They only affect the compiler behavior. JavaScript also has <a href=" http://www-archive.mozilla.org/js/language/js20-2002-04/core/pragmas.html">few pragmas</a>, one of them is <code>strict</code>.</p><div><div id="highlighter_992972" class= "syntaxhighlighter  javascript"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class= "javascript string">"use strict"</code><code class="javascript plain">;</code></div></div></td></tr></tbody></table></div></div><p>By the above pragma, the JavaScript code will be executed in strict mode. In strict mode, bad syntax is not allowed, <em>hoisting</em> is not done, silent errors are shown, etc. It helps in <strong>writing a more secure and optimized JavaScript code</strong>.</p><h4><a name="8_Sentinel"></a>8. Sentinel</h4><p><em>Sentinels</em> are soldiers who stand guard (Remember the ones from X-Men?). In programming, <em>sentinels </em> are values that are used to indicate the end of a loop or process. They can also be called "flags".</p><p>You can use any reasonable value as a <em>sentinel</em>. Here's an example of <em>sentinels</em> used in JavaScript; the <code>indexOf</code> method which returns -1 (the sentinel value) when the search value is not found in the targeted string. Below is a function that returns the position of an array value and if value is not found, returns -1.</p><div><div id="highlighter_316142" class="syntaxhighlighter  javascript"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="javascript keyword">function</code> <code class= "javascript plain">getPos(ary, val) {</code></div><div class="line number2 index1 alt1"><code class="javascript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="javascript keyword">var </code> <code class="javascript plain">i=0, len=ary.length;&nbsp;&nbsp;&nbsp; </code></div><div class="line number3 index2 alt2"><code class="javascript spaces">&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="javascript keyword">for</code><code class="javascript plain">(;i&lt;len;i++){</code></div><div class="line number4 index3 alt1"><code class="javascript spaces"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="javascript keyword">if</code><code class="javascript plain">(ary[i]===val) </code><code class="javascript keyword"> return</code> <code class="javascript plain">i+1;</code></div><div class="line number5 index4 alt2"><code class="javascript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="javascript plain">}&nbsp;&nbsp;&nbsp; </code></div><div class="line number6 index5 alt1"><code class="javascript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="javascript keyword">return</code> <code class="javascript plain">-1;</code></div><div class="line number7 index6 alt2"><code class="javascript plain">}</code></div><div class="line number8 index7 alt1"><code class= "javascript plain">console.log(getPos([</code><code class="javascript string">'r'</code><code class="javascript plain">,</code><code class="javascript string">'y'</code><code class= "javascript plain">,</code><code class="javascript string">'w'</code><code class="javascript plain">],</code><code class="javascript string">'y'</code><code class="javascript plain">)); </code><code class="javascript comments">//2</code></div><div class="line number9 index8 alt2"><code class="javascript plain">console.log(getPos([</code><code class="javascript string">'r' </code><code class="javascript plain">,</code><code class="javascript string">'y'</code><code class="javascript plain">,</code><code class="javascript string">'w'</code><code class= "javascript plain">],</code><code class="javascript string">'g'</code><code class="javascript plain">)); </code><code class="javascript comments">//-1 </code></div></div></td></tr></tbody></table></div></div><h4><a name="9_Vanilla"></a>9. Vanilla</h4><p>I think everyone's first ice cream flavor must've been vanilla. I also think that not only in ice cream, but in pretty much every sweet dish vanilla kind of became <em>the</em> standard flavor. I've seen quite a few cake recipes where they add at least one drop of it into the mix – just to increase the flavor.</p><p>And that's what <em>vanilla</em> is, a <strong>traditional standard flavor</strong>. <em>Vanilla</em> JavaScript is referred to the standard JavaScript – no framework. Vanilla in fact is not only used to describe the standard version of JavaScript but also other languages like CSS.</p><h4><a name="10_Variadic"></a>10. Variadic</h4><p><em>Variadic</em> is an adjective created by joining "variable" and "adicity". "Adicity" is from ancient Greek, with a meaning that is the same as the Latin word "arity" (Item 1 in this list). Thus, the term <em>variadic</em> is used to <strong>express something that has variable number of arguments</strong>.</p><p>In JavaScript, a <em>variadic</em> function takes in any number of arguments. It can be created using <code>arguments</code> property, <code>apply</code> method and since ES6, the spread operator. Below is an example using a spread operator.</p><div><div id="highlighter_125779" class="syntaxhighlighter  javascript"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class= "container"><div class="line number1 index0 alt2"><code class="javascript keyword">function</code> <code class="javascript plain">test(...a){</code></div><div class="line number2 index1 alt1"><code class="javascript spaces">&nbsp;&nbsp;</code><code class="javascript plain">console.log(a);</code></div><div class="line number3 index2 alt2"><code class="javascript plain">} </code></div><div class="line number4 index3 alt1"><code class="javascript plain">test(</code><code class="javascript string">'a'</code><code class="javascript plain">,</code><code class= "javascript string">'b'</code><code class="javascript plain">,</code><code class="javascript string">'c'</code><code class="javascript plain">,8,[56,-89]);</code></div><div class="line number5 index4 alt2"><code class="javascript comments">//output is Array [ "a", "b", "c", 8, Array[2] ]</code></div></div></td></tr></tbody></table></div></div>		</div> </div>		<!--=========================			END : POST		=============================-->		<!--=========================			START : POST =============================-->		<div class="post-wrapper">		<h1>JavaScript Functions</h1>		<div class="entry-content">				<!-- ads --> <!--channel:generalg(general)--><!-- After Title (general) -->				<!-- /ads -->				<p>JavaScript functions are capable of more than just merely enclosing a bunch of codes while waiting for the call to execute. Functions have evolved over time leading to new definitions, execution methods and syntaxes. This post will cover some of the present roles JavaScript functions have played so far.</p><p>Knowing the different ways of expressing and defining functions opens up the possibility of <strong>implementing a logic in a more optimal way</strong> in JavaScript. Also, you may be able to answer the interview questions more easily.</p><h4>Function Expressions</h4><p>When you simply state a function with <code>function </code> keyword , optional parameters and body of code, it's a <strong>function <em>declaration</em></strong>.</p><p>Put that declaration in a JavaScript expression (like in an assignment or arithmetic expression), it becomes a <strong>function <em>expression</em></strong>.</p><div><div id="highlighter_337641" class="syntaxhighlighter  javascript"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="javascript comments">// Function declaration </code></div><div class="line number2 index1 alt1"><code class="javascript keyword">function</code> <code class="javascript plain">function_name() {};</code></div><div class="line number3 index2 alt2"><code class="javascript comments">// Function expression</code></div><div class="line number4 index3 alt1"><code class="javascript keyword">var</code> <code class="javascript plain">function_name = </code><code class="javascript keyword">function</code><code class="javascript plain">() {};</code></div></div></td></tr></tbody></table></div></div><p>All JavaScript declarations are hoisted (moved up in the scope) during evaluation. Hence writing a function call before the function declaration is okay (since the declaration will be moved up anyway).</p><div><div id="highlighter_679472" class="syntaxhighlighter  javascript"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container" ><div class="line number1 index0 alt2"><code class="javascript plain">function_name();</code><code class="javascript comments">//function call[WORKS]</code></div><div class="line number2 index1 alt1"><code class="javascript keyword">function</code> <code class="javascript plain">function_name(){};</code></div></div></td></tr></tbody></table></div></div><p>Function expressions however aren't hoisted since the functions become part of the expressions and are not stand-alone declarations.</p><div><div id="highlighter_731767" class="syntaxhighlighter javascript"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="javascript plain"> function_name();</code><code class="javascript comments">//function call[WON'T WORK]</code></div><div class="line number2 index1 alt1"><code class="javascript keyword">var</code> <code class="javascript plain">function_name = </code><code class="javascript keyword">function</code><code class="javascript plain">(){}; </code></div></div></td></tr></tbody></table></div></div><h4>Immediately Invoked Function Expression (IIFE)</h4><p>It's a function expression, the code of which gets executed immediately (only once when it's evaluated). You can create one by simply adding <code>()</code> (syntax used for calling a function) right after a function expression. They can be anonymous (no name to call it with).</p><p>Below are the two most common syntaxes to create IIFE:</p><div><div id="highlighter_923355" class="syntaxhighlighter  javascript"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="javascript plain">(</code><code class="javascript keyword">function </code> <code class="javascript plain">optional_function_name() {</code></div><div class="line number2 index1 alt1"><code class="javascript spaces">&nbsp;&nbsp;</code><code class= "javascript comments">//body</code></div><div class="line number3 index2 alt2"><code class="javascript plain">}());</code></div></div></td></tr></tbody></table></div></div><p>and </p><div><div id="highlighter_18705" class="syntaxhighlighter  javascript"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class= "line number1 index0 alt2"><code class="javascript plain">(</code><code class="javascript keyword">function</code> <code class="javascript plain">optional_function_name() { </code></div><div class="line number2 index1 alt1"><code class="javascript spaces">&nbsp;&nbsp;</code><code class="javascript comments">//body</code></div><div class="line number3 index2 alt2"><code class="javascript plain">})();</code></div></div></td></tr></tbody></table></div></div><p>The parenthesis around the function declaration converts it to an expression and then adding <code>()</code> after it calls the function. You can use other ways to create IIFE for as long as you add <code>()</code> after a function expression (like below), but the preferred methods are the above two.</p><div><div id="highlighter_271102" class="syntaxhighlighter  javascript"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class= "code"><div class="container"><div class="line number1 index0 alt2"><code class="javascript comments">// Some of the ways to create IIFEs</code></div><div class="line number2 index1 alt1" ><code class="javascript plain">!</code><code class="javascript keyword">function</code><code class="javascript plain">() { </code><code class="javascript comments">/* ... */</code> <code class="javascript plain">}();</code></div><div class="line number3 index2 alt2"><code class="javascript plain">+</code><code class="javascript keyword">function</code><code class= "javascript plain">() { </code><code class="javascript comments">/* ... */</code> <code class="javascript plain">}();</code></div><div class="line number4 index3 alt1"><code class= "javascript keyword">new</code> <code class="javascript keyword">function</code><code class="javascript plain">() { </code><code class="javascript comments">/* ... */</code> <code class= "javascript plain">};</code></div></div></td></tr></tbody></table></div></div><p>IIFE is ideal for writing code that needs to execute only once, namespacing, creating closures, creating private variables and more. Below is an example of IIFE use.</p><div><div id="highlighter_715419" class="syntaxhighlighter  javascript"><table border="0" cellpadding="0" cellspacing="0" ><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="javascript keyword">var</code> <code class="javascript plain">page_language = ( </code><code class="javascript keyword">function</code> <code class="javascript plain">() {</code></div><div class="line number2 index1 alt1"><code class="javascript spaces">&nbsp;&nbsp; </code><code class="javascript keyword">var</code> <code class="javascript plain">lang;</code></div><div class="line number3 index2 alt2"><code class="javascript spaces">&nbsp;&nbsp; </code><code class="javascript comments">// Code to get the language of the page</code></div><div class="line number4 index3 alt1"><code class="javascript spaces">&nbsp;&nbsp;</code><code class="javascript keyword">return</code> <code class="javascript plain">lang;</code></div><div class="line number5 index4 alt2"><code class="javascript plain">})(); </code></div></div></td></tr></tbody></table></div></div><p>The code to get the page's language executes only once (preferably after the page loads). The result is stored in <code> page_language</code> for later use.</p><h4>Methods</h4><p>When a function is an object's property, it is called method. Since a function is also an object, a function inside another function is also a method. Below is an example for a method inside object.</p><div><div id="highlighter_886679" class="syntaxhighlighter  javascript"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="javascript keyword">var</code> <code class="javascript plain">calc = { </code></div><div class="line number2 index1 alt1"><code class="javascript spaces">&nbsp;&nbsp;</code><code class="javascript plain">add : </code><code class="javascript keyword">function </code><code class="javascript plain">(a,b){</code><code class="javascript keyword">return</code> <code class="javascript plain">a+b},</code></div><div class="line number3 index2 alt2" ><code class="javascript spaces">&nbsp;&nbsp;</code><code class="javascript plain">sub : </code><code class="javascript keyword">function</code><code class="javascript plain">(a,b){ </code><code class="javascript keyword">return</code> <code class="javascript plain">a-b}&nbsp; </code></div><div class="line number4 index3 alt1"><code class="javascript plain">} </code></div><div class="line number5 index4 alt2"><code class="javascript plain">console.log(calc.add(1,2)); </code><code class="javascript comments">//3</code></div><div class="line number6 index5 alt1"><code class="javascript plain">console.log(calc.sub(80,2)); </code><code class="javascript comments">//78</code></div></div></td></tr></tbody></table></div></div><p> The <code>add</code> and <code>sub</code> functions are methods of <code>calc</code> object.</p><p>Now for a function within function example:</p><div><div id="highlighter_910525" class= "syntaxhighlighter  javascript"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class= "javascript keyword">function</code> <code class="javascript plain">add(a){</code></div><div class="line number2 index1 alt1"><code class="javascript spaces">&nbsp;&nbsp;</code><code class ="javascript keyword">return</code> <code class="javascript keyword">function</code><code class="javascript plain">(b){</code><code class="javascript keyword">return</code> <code class= "javascript plain">a+b;}</code></div><div class="line number3 index2 alt2"><code class="javascript plain">}</code></div><div class="line number4 index3 alt1"><code class="javascript plain" >console.log(add(1)(2)); </code><code class="javascript comments">// Output is 3</code></div></div></td></tr></tbody></table></div></div><p>The returned anonymous function is a method of function <code>add</code>.</p><p>Note: Since parameter (<code>a</code>) of function <code>add</code> in the above example is available for the following function invoke, this type of process is called <strong>currying</strong>.</p><h4>Constructors</h4><p>When you add <code>new</code> keyword before a function and call it, it becomes a constructor that creates instances. Below is an example where constructors are used to create instances of <code>Fruit</code> and values are added to each <code>Fruit</code>'s properties.</p><div><div id= "highlighter_963902" class="syntaxhighlighter  javascript"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="javascript keyword">function</code> <code class="javascript plain">Fruit(){&nbsp;&nbsp; </code></div><div class="line number2 index1 alt1"><code class= "javascript spaces">&nbsp;&nbsp;</code><code class="javascript keyword">var</code> <code class="javascript plain">name, family; </code><code class="javascript comments">// Scientific name &amp; family</code></div><div class="line number3 index2 alt2"><code class="javascript spaces">&nbsp;&nbsp;</code><code class="javascript keyword">this</code><code class="javascript plain" >.getName = </code><code class="javascript keyword">function</code><code class="javascript plain">(){</code><code class="javascript keyword">return</code> <code class="javascript plain"> name;};</code></div><div class="line number4 index3 alt1"><code class="javascript spaces">&nbsp;&nbsp;</code><code class="javascript keyword">this</code><code class="javascript plain"> .setName = </code><code class="javascript keyword">function</code><code class="javascript plain">(value){name=value};&nbsp;&nbsp; </code></div><div class="line number5 index4 alt2"><code class="javascript spaces">&nbsp;&nbsp;</code><code class="javascript keyword">this</code><code class="javascript plain">.getFamily = </code><code class="javascript keyword">function </code><code class="javascript plain">(){</code><code class="javascript keyword">return</code> <code class="javascript plain">family;};</code></div><div class="line number6 index5 alt1" ><code class="javascript spaces">&nbsp;&nbsp;</code><code class="javascript keyword">this</code><code class="javascript plain">.setFamily = </code><code class="javascript keyword">function </code><code class="javascript plain">(value){family=value}; </code></div><div class="line number7 index6 alt2"><code class="javascript plain">}</code></div><div class="line number8 index7 alt1">&nbsp;</div><div class="line number9 index8 alt2"><code class="javascript keyword">var</code> <code class="javascript plain">apple = </code><code class="javascript keyword"> new</code> <code class="javascript plain">Fruit();</code></div><div class="line number10 index9 alt1"><code class="javascript plain">apple.setName(</code><code class="javascript string"> "Malus domestica"</code><code class="javascript plain">);</code></div><div class="line number11 index10 alt2"><code class="javascript plain">apple.setFamily(</code><code class="javascript string">"Rosaceae"</code><code class="javascript plain">);</code></div><div class="line number12 index11 alt1">&nbsp;</div><div class="line number13 index12 alt2"><code class="javascript keyword">var</code> <code class="javascript plain">orange = </code><code class="javascript keyword">new</code> <code class="javascript plain">Fruit();</code></div><div class="line number14 index13 alt1"><code class="javascript plain">orange.setName (</code><code class="javascript string">"Citrus × sinensis"</code><code class="javascript plain">);</code></div><div class="line number15 index14 alt2"><code class="javascript plain">orange.setFamily (</code><code class="javascript string">"Rutaceae"</code><code class="javascript plain">); </code></div><div class="line number16 index15 alt1">&nbsp;</div><div class="line number17 index16 alt2"><code class="javascript plain">console.log(orange.getName()); </code><code class= "javascript comments">// "Citrus × sinensis"</code></div><div class="line number18 index17 alt1"><code class="javascript plain">console.log(apple.getName()); </code><code class= "javascript comments">// "Malus domestica"</code></div><div class="line number19 index18 alt2"><code class="javascript plain">console.log(orange.getFamily()); </code><code class= "javascript comments">// "Rutaceae"</code></div></div></td></tr></tbody></table></div></div><h4>Arrow Functions (ES6 Standard) [Only in Firefox]</h4><p>A new function definition from ES6 Standard provides a shorter syntax for function expression. The syntax is</p><div><div id="highlighter_326116" class="syntaxhighlighter  javascript"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="javascript plain">() =&gt; { </code><code class="javascript comments"> /* body */</code> <code class="javascript plain">}</code></div></div></td></tr></tbody></table></div></div><p>This sample function:</p><div><div id="highlighter_43631" class= "syntaxhighlighter  javascript"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class= "javascript keyword">var</code> <code class="javascript plain">sing = </code><code class="javascript keyword">function</code><code class="javascript plain">(){</code></div><div class= "line number2 index1 alt1"><code class="javascript spaces">&nbsp;&nbsp;</code><code class="javascript plain">console.log(</code><code class="javascript string">'singing...'</code><code class="javascript plain">)</code></div><div class="line number3 index2 alt2"><code class="javascript plain">};</code></div></div></td></tr></tbody></table></div></div><p>is the same as: </p><div><div id="highlighter_646272" class="syntaxhighlighter  javascript"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2" ><code class="javascript keyword">var</code> <code class="javascript plain">sing = () =&gt; {</code></div><div class="line number2 index1 alt1"><code class="javascript spaces">&nbsp;&nbsp; </code><code class="javascript plain">console.log(</code><code class="javascript string">'singing...'</code><code class="javascript plain">)</code></div><div class="line number3 index2 alt2"><code class="javascript plain">};</code></div></div></td></tr></tbody></table></div></div><p>Arrow functions are anonymous and does not have its own <code>this</code> value, <code> this</code> inside it will be same as <code>this</code> in the enclosing code. Also, you cannot change it to a constructor with <code>new</code> keyword.</p><p>They are useful for when you want <code>this</code> inside a function to be the same as outside and its shorter syntax makes code for writing function within function concise (like below)</p><div><div id= "highlighter_273666" class="syntaxhighlighter  javascript"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class= "javascript plain">setInterval(</code><code class="javascript keyword">function</code> <code class="javascript plain">() {</code></div><div class="line number2 index1 alt1"><code class= "javascript spaces">&nbsp;&nbsp;</code><code class="javascript plain">console.log(</code><code class="javascript string">'message'</code><code class="javascript plain">)</code></div><div class="line number3 index2 alt2"><code class="javascript plain">}, 1000);</code></div></div></td></tr></tbody></table></div></div><p>into</p><div><div id="highlighter_107558" class= "syntaxhighlighter  javascript"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="javascript plain">setInterval(() =&gt; console.log(</code><code class="javascript string">'message'</code><code class= "javascript plain">), 1000);</code></div></div></td></tr></tbody></table></div></div><h4>Generator Functions (ES6 Standard) [Only in Firefox]</h4><p>Another new function definition from ES6 Standard is Generator Function. Generator functions are capable of halting and continuing its execution. Its syntax is:</p><div><div id="highlighter_92633" class="syntaxhighlighter javascript"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="javascript keyword">function</code><code class="javascript plain">* function_name(){} </code></div></div></td></tr></tbody></table></div></div><p>or</p><div><div id="highlighter_983510" class="syntaxhighlighter  javascript"><table border="0" cellpadding="0" cellspacing="0" ><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="javascript keyword">function</code> <code class="javascript plain">*function_name(){}</code></div></div></td></tr></tbody></table></div></div><p>Generator functions create iterators. The iterator's <code>next </code>method is then used to execute the code inside the generator function until the <code>yield</code> keyword is reached. After that, the iterated value identified by the <code>yield</code> keyword is returned by the generator function and the execution is halted.</p><p>The generator function again executes when the <code>next</code> method is called until the next <code>yield</code> keyword is reached. Once all of the <code>yield</code> expressions are executed, the yielded value returns <code>undefined</code>.</p><p>Below is a simple example:</p><div><div id="highlighter_625121" class="syntaxhighlighter  javascript"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="javascript keyword">function</code> <code class="javascript plain"> *generator_func(count) {</code></div><div class="line number2 index1 alt1"><code class="javascript spaces">&nbsp;&nbsp;</code><code class="javascript keyword">for</code><code class= "javascript plain">(</code><code class="javascript keyword">var</code> <code class="javascript plain">i=0;i&lt;count;i++){</code></div><div class="line number3 index2 alt2"><code class= "javascript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="javascript plain">yield i+1;</code></div><div class="line number4 index3 alt1"><code class="javascript spaces">&nbsp;&nbsp; </code><code class="javascript plain">}</code></div><div class="line number5 index4 alt2"><code class="javascript plain">}</code></div><div class="line number6 index5 alt1">&nbsp; </div><div class="line number7 index6 alt2"><code class="javascript keyword">var</code> <code class="javascript plain">itr = generator_func(4); </code></div><div class="line number8 index7 alt1"><code class="javascript plain">console.log(itr.next()); </code><code class="javascript comments">//Object { value: 1, done: false }</code></div><div class="line number9 index8 alt2"><code class="javascript plain">console.log(itr.next()); </code><code class="javascript comments">//Object { value: 2, done: false }</code></div><div class="line number10 index9 alt1"><code class="javascript plain">console.log(itr.next()); </code><code class="javascript comments">//Object { value: 3, done: false }</code></div><div class="line number11 index10 alt2"><code class="javascript plain">console.log(itr.next()); </code><code class="javascript comments">//Object { value: 4, done: false }</code></div><div class="line number12 index11 alt1"><code class="javascript plain">console.log(itr.next()); </code><code class="javascript comments">//Object { value: undefined, done: true }</code></div><div class="line number13 index12 alt2"><code class="javascript plain">console.log(itr.next()); </code><code class="javascript comments">//Object { value: undefined, done: true } </code></div></div></td></tr></tbody></table></div></div><p>Here's another example:</p><div><div id="highlighter_946388" class="syntaxhighlighter  javascript"><table border="0" cellpadding ="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3 </div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7 </div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div></td><td class="code"><div class="container" ><div class="line number1 index0 alt2"><code class="javascript keyword">function</code> <code class="javascript plain">*randomIncrement(i) {</code></div><div class="line number2 index1 alt1"><code class="javascript spaces">&nbsp;</code><code class="javascript plain">yield i + 3;</code></div><div class="line number3 index2 alt2"><code class="javascript spaces">&nbsp; </code><code class="javascript plain">yield i + 5;</code></div><div class="line number4 index3 alt1"><code class="javascript spaces">&nbsp;</code><code class="javascript plain">yield i + 10;</code></div><div class="line number5 index4 alt2"><code class="javascript spaces">&nbsp;</code><code class="javascript plain">yield i + 6;</code></div><div class="line number6 index5 alt1"><code class="javascript plain">}</code></div><div class="line number7 index6 alt2"><code class="javascript keyword">var</code> <code class="javascript plain">itr = randomIncrement(4);</code></div><div class="line number8 index7 alt1"><code class="javascript plain">console.log(itr.next().value); </code><code class="javascript comments">//7 </code></div><div class="line number9 index8 alt2"><code class="javascript plain">console.log(itr.next().value); </code><code class="javascript comments">//9</code></div><div class="line number10 index9 alt1"><code class="javascript plain">console.log(itr.next().value); </code><code class="javascript comments">//14 </code></div></div></td></tr></tbody></table></div></div><p>There's also a <code>yield*</code> expression which passes the value to another generator function</p><div><div id= "highlighter_414466" class="syntaxhighlighter  javascript"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class= "line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class= "line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17 </div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="javascript keyword">function</code> <code class="javascript plain">*fruits(fruit) { </code></div><div class="line number2 index1 alt1"><code class="javascript spaces">&nbsp;</code><code class="javascript plain">yield* veggies(fruit); </code></div><div class="line number3 index2 alt2"><code class="javascript spaces">&nbsp;</code><code class="javascript plain">yield </code><code class="javascript string">"Grapes"</code><code class="javascript plain">; </code></div><div class="line number4 index3 alt1"><code class="javascript plain">}</code></div><div class="line number5 index4 alt2">&nbsp;</div><div class="line number6 index5 alt1" ><code class="javascript keyword">function</code> <code class="javascript plain">*veggies(fruit){</code></div><div class="line number7 index6 alt2"><code class="javascript spaces">&nbsp; </code><code class="javascript plain">yield fruit + </code><code class="javascript string">" and Spinach"</code><code class="javascript plain">;</code></div><div class="line number8 index7 alt1"><code class="javascript spaces">&nbsp;</code><code class="javascript plain">yield fruit + </code><code class="javascript string">" and Broccoli"</code><code class="javascript plain">;</code></div><div class="line number9 index8 alt2"><code class="javascript spaces">&nbsp;</code><code class="javascript plain">yield fruit + </code><code class="javascript string"> " and Cucumber"</code><code class="javascript plain">;</code></div><div class="line number10 index9 alt1"><code class="javascript plain">}</code></div><div class="line number11 index10 alt2">&nbsp;</div><div class="line number12 index11 alt1"><code class="javascript keyword">var</code> <code class="javascript plain">itr = fruits(</code><code class="javascript string"> "Apple"</code><code class="javascript plain">);</code></div><div class="line number13 index12 alt2"><code class="javascript plain">console.log(itr.next().value); </code><code class= "javascript comments">//"Apple and Spinach"</code></div><div class="line number14 index13 alt1"><code class="javascript plain">console.log(itr.next().value); </code><code class= "javascript comments">//"Apple and Broccoli"</code></div><div class="line number15 index14 alt2"><code class="javascript plain">console.log(itr.next().value); </code><code class= "javascript comments">//"Apple and Cucumber"</code></div><div class="line number16 index15 alt1"><code class="javascript plain">console.log(itr.next().value); </code><code class= "javascript comments">//"Grapes"</code></div><div class="line number17 index16 alt2"><code class="javascript plain">console.log(itr.next().value); </code><code class="javascript comments"> //undefined</code></div></div></td></tr></tbody></table></div></div><p>Generator functions are useful if you want to go through values one by one at your preferred point in the code by pausing it, rather than in one go like in looping through an array.</p><h4>Conclusion</h4><p>I've included a list of references below, where you will find links to references and articles that go in-depth on different topics separately. <strong>Both the ES6 standard functions will work only in Firefox at the moment</strong>.</p><h4>References</h4><ul><li><a href=" http://www.ecma-international.org/ecma-262/6.0/#sec-ecmascript-language-functions-and-classes">ECMAScript Language: Functions and Classes</a></li><li><a href=" http://benalman.com/news/2010/11/immediately-invoked-function-expression/">Immediately-Invoked Function Expression (IIFE)</a></li><li><a href="http://davidwalsh.name/es6-generators">The Basics Of ES6 Generators</a></li><li><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Functions/Arrow_functions">Arrow Functions</a></li><li><a href=" https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/function*">Function</a><em> – </em>Mozilla Developer Network <a href=" https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/function*"></a> </li></ul>        <!-- ads -->				<!--dfp: g--><!-- /1022251/desktop-post-general-content_down-custom -->				<!-- /ads -->							</div>			</div>		<!--=========================			END : POST		=============================-->		<!--=========================			START : POST		=============================-->		<div class="post-wrapper">		<h1> Immediately-Invoked Function Expression (IIFE)</h1>		<div id="entry-400" class="asset-entry asset">    <div class="asset-inner">  <div class="meta asset-meta">    <span class="byline"> By <span class="vcard author"><a class="fn url" href="http://benalman.com/">"Cowboy" Ben Alman</a></span> on <abbr class="published" title="2010-11-15T16:33:27-04:00">November 15, 2010  4:33 PM</abbr>    </span>        <span class="divider">|</span>  <a class="icon icon-right icon-comments" href=" http://benalman.com/news/2010/11/immediately-invoked-function-expression/#disqus_thread"></a>  </div>        <div class="asset-body">          <p>In case you hadn't noticed, I'm a bit of a stickler for terminology. So, after hearing the popular, yet misleading, JavaScript term "self-executing anonymous function" (or self-invoked anonymous function) one too many times, I've finally decided to organize my thoughts into an article.</p><p>In addition to providing some very thorough information about how this pattern actually works, I've actually made a recommendation on what we should call it, moving forward. Also, If you want to skip ahead, you can just check out some actual <a href=" http://benalman.com/news/2010/11/immediately-invoked-function-expression/#iife">Immediately-Invoked Function Expressions</a>, but I recommend reading the entire article.</p> <script>var disqus_url = 'http://benalman.com/news/2010/11/self-executing-anonymous-function/';</script><p>Please understand that this article isn't intended to be an "I'm right, you're wrong" kind of thing. I'm genuinely interested in helping people understand potentially complex concepts, and feel that using consistent and accurate terminology is one of the easiest things that people can do to facilitate understanding.</p><h2>So, what's this all about, anyways?</h2><p>In JavaScript, every <a href=" https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Function">function</a>, when invoked, creates a new execution context. Because variables and functions defined within a function may only be accessed inside, but not outside, that context, invoking a function provides a very easy way to create privacy.</p><pre class="brush:js">  // Because this function returns another function that has access to the  // "private" var i, the returned function is, effectively, "privileged."  function makeCounter() {    // `i` is only accessible inside `makeCounter`.    var i = 0;    return function() {      console.log( ++i );    };  }  // Note that `counter` and `counter2` each have their own scoped `i`.  var counter = makeCounter(); counter(); // logs: 1  counter(); // logs: 2  var counter2 = makeCounter();  counter2(); // logs: 1  counter2(); // logs: 2  i; // ReferenceError: i is not defined (it only exists inside makeCounter)</pre><p>In many cases, you won't need multiple "instances" of whatever your <code>makeWhatever</code> function returns, and can make do with just a single instance, and in other cases, you're not even explicitly returning a value.</p><h3>The heart of the matter</h3><p>Now, whether you define a function like <code>function foo(){}</code> or <code>var foo = function(){}</code>, what you end up with is an identifier for a function, that you can invoke by putting parens (parentheses, <code>()</code>) after it, like <code>foo()</code>.</p><pre class="brush:js">  // Because a function defined like so can be invoked by putting () after  // the function name, like foo(), and because foo is just a reference to  // the function expression `function() { /* code */ }`...  var foo = function(){ /* code */ }  // ...doesn't it stand to reason that the function expression itself can  // be invoked, just by putting () after it?  function(){ /* code */ }(); // SyntaxError: Unexpected token (</pre><p>As you can see, there's a catch. When the parser encounters the <code>function</code> keyword in the global scope or inside a function, it treats it as a <a href="https://developer.mozilla.org/en/JavaScript/Reference/Statements/function">function declaration</a> (statement), and not as a <a href="https://developer.mozilla.org/en/JavaScript/Reference/Operators/Special/function">function expression</a>, by default. If you don't explicitly tell the parser to expect an expression, it sees what it thinks to be a <em>function declaration without a name</em> and throws a <a href=" https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/SyntaxError">SyntaxError</a> exception because function declarations require a name.</p><h3>An aside: functions, parens, and SyntaxErrors</h3><p>Interestingly enough, if you were to specify a name for that function and put parens immediately after it, the parser would also throw a SyntaxError, but for a different reason. While parens placed after an expression indicate that the expression is a function to be invoked, parens placed after a statement are totally separate from the preceding statment, and are simply a grouping operator (used as a means to control precedence of evaluation).</p><pre class="brush:js">  // While this function declaration is now syntactically valid, it's still  // a statement, and the following set of parens is invalid because the  // grouping operator needs to contain an expression.  function foo(){ /* code */ }(); // SyntaxError: Unexpected token )  // Now, if you put an expression in the parens, no exception is thrown...  // but the function isn't executed either, because this:  function foo(){ /* code */ }( 1 );  // Is really just equivalent to this, a function declaration followed by a  // completely unrelated expression:  function foo(){ /* code */ }  ( 1 ); </pre><p><em>You can read more about this in Dmitry A. Soshnikov's highly informative article, <a href=" http://dmitrysoshnikov.com/ecmascript/chapter-5-functions/#question-about-surrounding-parentheses">ECMA-262-3 in detail. Chapter 5. Functions</a>.</em></p><p><a name="iife"></a></p><h2> Immediately-Invoked Function Expression (IIFE)</h2><p>Fortunately, the SyntaxError "fix" is simple. The most widely accepted way to tell the parser to expect a function expression is just to wrap it in parens, because in JavaScript, parens can't contain statements. At this point, when the parser encounters the <code>function</code> keyword, it knows to parse it as a function expression and not a function declaration.</p><pre class="brush:js">  // Either of the following two patterns can be used to immediately invoke  // a function expression, utilizing the function's execution context to  // create "privacy."  (function(){ /* code */ }()); // Crockford recommends this one  (function(){ /* code */ })(); // But this one works just as well  // Because the point of the parens or coercing operators is to disambiguate  // between function expressions and function declarations, they can be  // omitted when the parser already expects an expression (but please see the  // "important note" below).  var i = function(){ return 10; }();  true &amp;&amp; function(){ /* code */ }();  0, function(){ /* code */ }();  // If you don't care about the return value, or the possibility of making  // your code slightly harder to read, you can save a byte by just prefixing  // the function with a unary operator.  !function(){ /* code */ }();  ~function(){ /* code */ }();  -function(){ /* code */ }();  +function(){ /* code */ }();  // Here's another variation, from @kuvos - I'm not sure of the performance  // implications, if any, of using the `new` keyword, but it works.  // http://twitter.com/kuvos/status/18209252090847232  new function(){ /* code */ }  new function(){ /* code */ }() // Only need parens if passing arguments</pre><h3>An important note about those parens</h3><p>In cases where the extra "disambiguation" parens surrounding the function expression are unnecessary (because the parser already expects an expression), it's still a good idea to use them when making an assignment, <em>as a matter of convention</em>. </p><p>Such parens typically indicate that the function expression will be immediately invoked, and the variable will contain the <em>result</em> of the function, not the function itself. This can save someone reading your code the trouble of having to scroll down to the bottom of what might be a very long function expression to see if it has been invoked or not.</p><p><em> As a rule of thumb, while writing unambiguous code might be technically necessary to keep the JavaScript parser from throwing SyntaxError exceptions, writing unambiguous code is also fairly necessary to keep other developers from throwing "WTFError" exceptions at you!</em></p><p><a name="closures"></a></p><h3>Saving state with closures</h3><p>Just like when arguments may be passed when functions are invoked by their named identifier, they may also be passed when immediately invoking a function expression. And because any function defined inside another function can access the outer function's passed-in arguments and variables (this relationship is known as a closure), an <strong>Immediately-Invoked Function Expression</strong> can be used to "lock in" values and effectively save state.</p><p><em>If you want to learn more about closures, read <a href=" http://skilldrick.co.uk/2011/04/closures-explained-with-javascript/">Closures explained with JavaScript</a>.</em></p><pre class="brush:js">  // This doesn't work like you might think, because the value of `i` never  // gets locked in. Instead, every link, when clicked (well after the loop  // has finished executing), alerts the total number of elements, because  // that's what the value of `i` actually is at that point.  var elems = document.getElementsByTagName( 'a' );  for ( var i = 0; i &lt; elems.length; i++ ) {    elems[ i ].addEventListener( 'click', function(e){      e.preventDefault();      alert( 'I am link #' + i );    }, 'false' );  }  // This works, because inside the IIFE, the value of `i` is locked in as  // `lockedInIndex`. After the loop has finished executing, even though the  // value of `i` is the total number of elements, inside the IIFE the value  // of `lockedInIndex` is whatever the value passed into it (`i`) was when  // the function expression was invoked, so when a link is clicked, the  // correct value is alerted.  var elems = document.getElementsByTagName( 'a' );  for ( var i = 0; i &lt; elems.length; i++ ) {    (function( lockedInIndex ){      elems[ i ].addEventListener( 'click', function(e){        e.preventDefault();        alert( 'I am link #' + lockedInIndex );      }, 'false' );    })( i );  }  // You could also use an IIFE like this, encompassing (and returning) only  // the click handler function, and not the entire `addEventListener`  // assignment. Either way, while both examples lock in the value using an  // IIFE, I find the previous example to be more readable.  var elems = document.getElementsByTagName( 'a' );  for ( var i = 0; i &lt; elems.length; i++ ) {    elems[ i ].addEventListener( 'click', (function( lockedInIndex ){      return function(e){ e.preventDefault();        alert( 'I am link #' + lockedInIndex );      };    })( i ), 'false' );  }</pre><p><em>Note that in the last two examples, <code>lockedInIndex</code> could have just been called <code>i</code> without any issue, but using a differently named identifier as a function argument makes the concept significantly easier to explain.</em></p><p>One of the most advantageous side effects of Immediately-Invoked Function Expressions is that, because this unnamed, or anonymous, function expression is invoked immediately, without using an identifier, a closure can be used without polluting the current scope.</p><p><a name="self-executing"></a></p><h3>What's wrong with "Self-executing anonymous function?"</h3><p>You've already seen it mentioned a few times, but in case it wasn't clear, I'm proposing the term "<strong>Immediately-Invoked Function Expression</strong>", and "<strong>IIFE</strong>" if you like acronyms. The pronunciation <a href="http://www.forvo.com/word/iffy/">"iffy"</a> was suggested to me, and I like it, so let's go with that.</p><p>What is an <strong> Immediately-Invoked Function Expression</strong>? It's a <a href="https://developer.mozilla.org/en/JavaScript/Reference/Operators/Special/function">function expression</a> that gets invoked immediately. Just like the name would lead you to believe.</p><p>I'd like to see JavaScript community members adopt the term <strong>"Immediately-Invoked Function Expression" </strong> and <strong>"IIFE"</strong> in their articles and presentations, because I feel it makes understanding this concept a little easier, and because the term "self-executing anonymous function" isn't really even accurate:</p><pre class="brush:js">  // This is a self-executing function. It's a function that executes (or  // invokes) itself, recursively: function foo() { foo(); }  // This is a self-executing anonymous function. Because it has no  // identifier, it must use the  the `arguments.callee` property (which  // specifies the currently executing function) to execute itself.  var foo = function() { arguments.callee(); };  // This *might* be a self-executing anonymous function, but only while the  // `foo` identifier actually references it. If you were to change `foo` to  // something else, you'd have a "used-to-self-execute" anonymous function.  var foo = function() { foo(); };  // Some people call this a "self-executing anonymous function" even though  // it's not self-executing, because it doesn't invoke itself. It is  // immediately invoked, however.  (function(){ /* code */ }());  // Adding an identifier to a function expression (thus creating a named  // function expression) can be extremely helpful when debugging. Once named,  // however, the function is no longer anonymous.  (function foo(){ /* code */ }());  // IIFEs can also be self-executing, although this is, perhaps, not the most  // useful pattern.  (function(){ arguments.callee(); }());  (function foo(){ foo(); }());  // One last thing to note: this will cause an error in BlackBerry 5, because  // inside a named function expression, that name is undefined. Awesome, huh?  (function foo(){ foo(); }());</pre><p>Hopefully these examples have made it clear that the term "self-executing" is somewhat misleading, because it's not the function that's executing <em>itself</em>, even though the function is being executed. Also, "anonymous" is unnecessarily specific, since an <strong>Immediately Invoked Function Expression </strong> can be either anonymous or named. And as for my preferring "invoked" over "executed," it's a simple matter of <a href="http://en.wikipedia.org/wiki/Alliteration">alliteration</a> ; I think "<strong>IIFE</strong>" looks and sounds nicer than "IEFE."</p><p>So, that's it. That's my big idea.</p><p><em>Fun fact: because <code>arguments.callee</code> is <a href=" https://developer.mozilla.org/en/JavaScript/Strict_mode#Differences_in_functions">deprecated in ECMAScript 5 strict mode</a> it's actually technically impossible to create a "self-executing anonymous function" in ECMAScript 5 strict mode.</em></p><h3>A final aside: The Module Pattern</h3><p>While I'm invoking function expressions, I'd be remiss if I didn't at least <em>mention</em> the Module Pattern. If you're not familiar with the Module Pattern in JavaScript, it's similar to my first example, but with an Object being returned instead of a Function (and is generally implemented as a singleton, as in this example).</p><pre class="brush:js">  // Create an anonymous function expression that gets invoked immediately,  // and assign its *return value* to a variable. This approach "cuts out the  // middleman" of the named `makeWhatever` function reference.  //  // As explained in the above "important note," even though parens are not  // required around this function expression, they should still be used as a  // matter of convention to help clarify that the variable is being set to  // the function's *result* and not the function itself.  var counter = (function(){    var i = 0;    return {      get: function(){        return i;      },      set: function( val ){        i = val;      },      increment: function() {        return ++i;      }    };  }());  // `counter` is an object with properties, which in this case happen to be  // methods.  counter.get(); // 0  counter.set( 3 );  counter.increment(); // 4  counter.increment(); // 5  counter.i; // undefined (`i` is not a property of the returned object)  i; // ReferenceError: i is not defined (it only exists inside the closure)</pre><p>The Module Pattern approach is not only incredibly powerful, but incredibly simple. With very little code, you can effectively namespace related methods and properties, organizing entire <em>modules</em> of code in a way that both minimizes global scope pollution and creates privacy.</p><h2>Further reading</h2><p> Hopefully this article was informative and has answered some of your questions. Of course, if you now have even more questions than when you started, you can learn even more about functions and the module pattern by reading the following articles.</p><ul><li><a href="http://dmitrysoshnikov.com/ecmascript/chapter-5-functions/#question-about-surrounding-parentheses"> ECMA-262-3 in detail. Chapter 5. Functions.</a> - Dmitry A. Soshnikov</li><li><a href="https://developer.mozilla.org/en/JavaScript/Reference/Functions_and_function_scope">Functions and function scope</a> - Mozilla Developer Network</li><li><a href="http://kangax.github.com/nfe/">Named function expressions</a> - Juriy "kangax" Zaytsev</li><li><a href=" http://www.adequatelygood.com/2010/3/JavaScript-Module-Pattern-In-Depth">JavaScript Module Pattern: In-Depth</a> - Ben Cherry</li><li><a href=" http://skilldrick.co.uk/2011/04/closures-explained-with-javascript/">Closures explained with JavaScript</a> - Nick Morgan</li></ul><p><em>I'd like to thank <a href=" http://asenbozhilov.com/">Asen Bozhilov</a> and <a href="http://allyoucanleet.com/">John David Dalton</a> for contributing technical advice, as well as <a href="http://skilldrick.co.uk/"> Nick Morgan</a> for his insights. If you'd also like to contribute, please post any suggestions or feedback in the comments, thanks!</em></p>        </div>        <div class="asset-footer" >            <div class="asset-share">  <!-- AddThis Button BEGIN -->  <a href="http://www.addthis.com/bookmark.php?v=250" onmouseover="return addthis_open(this, &quot;&quot;, &quot; http://benalman.com/news/2010/11/immediately-invoked-function-expression/&quot;, &quot;Immediately-Invoked Function Expression (IIFE)&quot;)" onmouseout="addthis_close()" onclick="return addthis_sendto()"><img src="http://s7.addthis.com/static/btn/lg-share-en.gif" width="125" height="16" alt="Bookmark and Share" style="border:0"></a>  <!-- AddThis Button END --> </div>              <div class="asset-tags">                <dl class="inline">                  <dt>Tags<span class="divider">:</span></dt>                  <dd>    <ul class= "nav nav-inline inline">      <li class="first">            <a href="/tag/anonymous/" rel="nofollow">anonymous</a>            <span class="divider">|</span>      </li>      <li> <a href="/tag/expression/" rel="nofollow">expression</a>            <span class="divider">|</span>      </li>      <li>            <a href="/tag/function/" rel="nofollow"> function</a>            <span class="divider">|</span>      </li>      <li>            <a href="/tag/iife/" rel="nofollow">iife</a>            <span class="divider">|</span>      </li> <li>            <a href="/tag/invoked/" rel="nofollow">invoked</a>            <span class="divider">|</span>      </li>      <li>            <a href="/tag/javascript/" rel="nofollow" >javascript</a>            <span class="divider">|</span>      </li>      <li class="last">            <a href="/tag/modulepattern/" rel="nofollow">module pattern</a>      </li>    </ul> </dd>                </dl>              </div>              <div class="asset-categories">                <dl class="inline">                  <dt>Categories<span class= "divider">:</span></dt>                  <dd>    <ul class="nav nav-inline inline">      <li class="first">            <a href="http://benalman.com/news/code/">Code</a>            <span class="divider">|</span>      </li>      <li class="last">            <a href="http://benalman.com/news/">News</a>      </li>    </ul>                  </dd>                </dl> </div>        </div>    </div>    <div class="shim"></div>  </div>			</div>		<!--=========================			END : POST =============================-->		<!--=========================			START : POST		=============================-->		<div class="post-wrapper">		<h1>JavaScript Functions</h1>		<div>		<article id="wikiArticle">                                                      <div><section id="Quick_Links" class="Quick_links"><!-- --> </section></div><p>Generally speaking, a function is a "subprogram" that can be <em>called</em> by code external (or internal in the case of recursion) to the function. Like the program itself, a function is composed of a sequence of statements called the <em>function body</em>. Values can be <em>passed</em> to a function, and the function can <em>return</em> a value. </p><p>In JavaScript, functions are first-class objects, i.e. they are objects and can be manipulated and passed around just like any other object. Specifically, they are <code><a href= "/en-US/docs/JavaScript/Reference/Global_Objects/Function">Function</a></code> objects.</p><p>For more examples and explanations, see also the <a href= "/en-US/docs/Web/JavaScript/Guide/Functions">JavaScript guide about functions</a>.</p><h2 id="Description">Description</h2><p>Every function in JavaScript is a <code>Function</code> object. See <a href="/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function" title="The Function constructor creates a new Function object. In JavaScript every function is actually a Function object."><code>Function</code></a> for information on properties and methods of <code>Function</code> objects.</p><p>Functions are not the same as procedures. A function always returns a value, but a procedure may or may not return any value.</p><p>To return a specific&nbsp;value other than the default,&nbsp;a function must have a <code><a href= "/en-US/docs/Web/JavaScript/Reference/Statements/return">return</a></code> statement that specifies the value to return. A function without a return statement will return a default value. In the case of&nbsp;a&nbsp;<a href="/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/constructor">constructor</a> called with the <code><a href= "/en-US/docs/Web/JavaScript/Reference/Operators/new">new</a></code> keyword, the default value is the value of its&nbsp;<code>this</code> parameter. For all other functions, the default return value is <code>undefined</code>.</p><p>The parameters of a function call are the function's <em>arguments</em>. Arguments are passed to functions <em>by value</em>. If the function changes the value of an argument, this change is not reflected globally or in the calling function. However, object references are values, too, and they are special: if the function changes the referred object's properties, that change is visible outside the function, as shown in the following example:</p><pre class="brush: js  language-js" data-number=""><code class= " language-js"><span class="token comment" spellcheck="true">/* Declare the function 'myFunc' */</span><span class="token keyword">function</span> <span class="token function">myFunc<span class="token punctuation">(</span></span>theObject<span class="token punctuation">)</span> <span class="token punctuation">{</span>   theObject<span class="token punctuation">.</span> brand <span class="token operator">=</span> <span class="token string">"Toyota"</span><span class="token punctuation">;</span> <span class="token punctuation">}</span> <span class="token comment" spellcheck="true">/*  * Declare variable 'mycar';  * create and initialize a new Object;  * assign reference to it to 'mycar'  */</span> <span class="token keyword">var</span> mycar <span class="token operator">=</span> <span class="token punctuation">{</span>   brand<span class="token punctuation">:</span> <span class="token string">"Honda"</span><span class= "token punctuation">,</span>   model<span class="token punctuation">:</span> <span class="token string">"Accord"</span><span class="token punctuation">,</span>   year<span class="token punctuation">:</span> <span class="token number">1998</span> <span class="token punctuation">}</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true"> /* Logs 'Honda' */</span> console<span class="token punctuation">.</span><span class="token function">log<span class="token punctuation">(</span></span>mycar<span class="token punctuation" >.</span>brand<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">/* Pass object reference to the function */ </span> <span class="token function">myFunc<span class="token punctuation">(</span></span>mycar<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class= "token comment" spellcheck="true">/*  * Logs 'Toyota' as the value of the 'brand' property  * of the object, as changed to by the function.  */</span> console<span class="token punctuation">.</span><span class="token function">log<span class="token punctuation">(</span></span>mycar<span class="token punctuation">.</span>brand<span class="token punctuation">) </span><span class="token punctuation">;</span><div class="line-number" data-start="1" style="top: 0px;"></div><div class="line-number" data-start="2" style="top: 19px;"></div><div class= "line-number" data-start="3" style="top: 38px;"></div><div class="line-number" data-start="4" style="top: 57px;"></div><div class="line-number" data-start="5" style="top: 76px;"></div><div class="line-number" data-start="6" style="top: 95px;"></div><div class="line-number" data-start="7" style="top: 114px;"></div><div class="line-number" data-start="8" style="top: 133px;" ></div><div class="line-number" data-start="9" style="top: 152px;"></div><div class="line-number" data-start="10" style="top: 171px;"></div><div class="line-number" data-start="11" style= "top: 190px;"></div><div class="line-number" data-start="12" style="top: 209px;"></div><div class="line-number" data-start="13" style="top: 228px;"></div><div class="line-number" data-start="14" style="top: 247px;"></div><div class="line-number" data-start="15" style="top: 266px;"></div><div class="line-number" data-start="16" style="top: 285px;"></div><div class= "line-number" data-start="17" style="top: 304px;"></div><div class="line-number" data-start="18" style="top: 323px;"></div><div class="line-number" data-start="19" style="top: 342px;" ></div><div class="line-number" data-start="20" style="top: 361px;"></div><div class="line-number" data-start="21" style="top: 380px;"></div><div class="line-number" data-start="22" style= "top: 399px;"></div><div class="line-number" data-start="23" style="top: 418px;"></div><div class="line-number" data-start="24" style="top: 437px;"></div><div class="line-number" data-start="25" style="top: 456px;"></div><div class="line-number" data-start="26" style="top: 475px;"></div><div class="line-number" data-start="27" style="top: 494px;" ></div></code></pre><p>The <a href="/en-US/docs/Web/JavaScript/Reference/Operators/this"><code>this</code> keyword</a> does not refer to the currently executing function, so you must refer to <code>Function</code> objects by name, even within the function body.</p><h2 id="Defining_functions">Defining functions</h2><p>There are several ways to define functions:</p><h3 id="The_function_declaration_(function_statement)">The function declaration (<code>function</code> statement)</h3><p>There is a special syntax for declaring functions (see <a href= "/en-US/docs/Web/JavaScript/Reference/Statements/function">function statement</a> for details):</p><pre class="syntaxbox">function <em>name</em>([<em>param</em>[, <em>param</em>[, ... <em> param</em>]]]) {   <em>statements</em>}</pre><dl> <dt><code>name</code></dt> <dd>The function name.</dd></dl><dl> <dt><code>param</code></dt> <dd>The name of an argument to be passed to the function. A function can have up to 255 arguments.</dd></dl><dl> <dt><code>statements</code></dt> <dd>The statements comprising the body of the function.</dd></dl><h3 id= "The_function_expression_(function_expression)">The function expression (<code>function</code> expression)</h3><p>A function expression is similar to and has the same syntax as a function declaration (see <a href="/en-US/docs/Web/JavaScript/Reference/Operators/function">function expression</a> for details):</p><pre class="syntaxbox">function [<em>name</em>]([<em>param</em> ] [, <em>param</em>] [..., <em>param</em>]) {   <em>statements</em>}</pre><dl> <dt><code>name</code></dt> <dd>The function name. Can be omitted, in which case the function becomes known as an anonymous function.</dd></dl><dl> <dt><code>param</code></dt> <dd>The name of an argument to be passed to the function. A function can have up to 255 arguments.</dd> <dt><code> statements</code></dt> <dd>The statements which comprise the body of the function.</dd></dl><h3 id="The_generator_function_declaration_(function*_statement)">The generator function declaration (<code>function*</code> statement)</h3><div class="note"><p><strong>Note:</strong> Generator function are an <em>experimental technology,</em> part of the ECMAScript 6 proposal, and are not widely supported by browsers yet.</p></div><p>There is a special syntax for declaration generator functions (see <a href= "/en-US/docs/Web/JavaScript/Reference/Statements/function*" title="The function* declaration (function keyword followed by an asterisk) defines a generator function, which returns a Generator object."><code>function* statement</code></a> for details):</p><pre class="syntaxbox">function* <em>name</em>([<em>param</em>[, <em>param</em>[, ... <em>param</em>]]]) {   <em> statements</em>}</pre><dl> <dt><code>name</code></dt> <dd>The function name.</dd></dl><dl> <dt><code>param</code></dt> <dd>The name of an argument to be passed to the function. A function can have up to 255 arguments.</dd></dl><dl> <dt><code>statements</code></dt> <dd>The statements comprising the body of the function.</dd></dl><h3 id= "The_generator_function_expression_(function*_expression)">The generator function expression (<code>function*</code> expression)</h3><div class="note"><p><strong>Note:</strong> Generator function are an <em>experimental technology,</em> part of the ECMAScript 6 proposal, and are not widely supported by browsers yet.</p></div><p>A generator function expression is similar to and has the same syntax as a generator function declaration (see <a href="/en-US/docs/Web/JavaScript/Reference/Operators/function*" title="The function* keyword can be used to define a generator function inside an expression."><code>function* expression</code></a> for details):</p><pre class="syntaxbox">function* [<em>name</em>]([<em>param</em>] [, <em>param</em>] [..., <em>param</em>]) {   <em>statements</em>}</pre><dl> <dt><code>name</code></dt> <dd>The function name. Can be omitted, in which case the function becomes known as an anonymous function. </dd></dl><dl> <dt><code>param</code></dt> <dd>The name of an argument to be passed to the function. A function can have up to 255 arguments.</dd> <dt><code>statements</code></dt> <dd>The statements which comprise the body of the function.</dd></dl><h3 id="The_arrow_function_expression_(>)">The arrow function expression (=&gt;)</h3><div class="note"><p><strong>Note: </strong> Arrow function expressions are an <em>experimental technology,</em> part of the ECMAScript 6 proposal, and are not widely supported by browsers yet.</p></div><p>An arrow function expression has a shorter syntax and lexically binds its this value (see <a href="/en-US/docs/Web/JavaScript/Reference/Functions/Arrow_functions">arrow functions</a> for details): </p><pre class="syntaxbox">([param] [, param]) =&gt; {   statements}param =&gt; expression</pre><dl> <dt><code>param</code></dt> <dd>The name of an argument. Zero arguments need to be indicated with <code>()</code>.&nbsp; For only one argument the parentheses are not required. (like <code>foo =&gt; 1</code>)</dd> <dt><code>statements or expression</code></dt> <dd> Multiple statements need to be enclosed in brackets. A single expression requires no brackets. The expression is also the implicit return value of that function.</dd></dl><h3 id= "The_Function_constructor">The <code>Function</code> constructor</h3><div class="note"><p><strong>Note:</strong> Using the <code>Function</code> constructor to create functions is not recommended since it needs the function body as a string which may prevent some JS engine optimizations and can also cause other problems.</p></div><p>As all other objects, <a href= "/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function" title="The Function constructor creates a new Function object. In JavaScript every function is actually a Function object." ><code>Function</code></a> objects can be created using the <code>new</code> operator:</p><pre class="syntaxbox">new Function (<em>arg1</em>, <em>arg2</em>, ... <em>argN</em>, <em> functionBody</em>)</pre><dl> <dt><code>arg1, arg2, ... arg<em>N</em></code></dt> <dd>Zero or more names to be used by the function as formal argument names. Each must be a string that conforms to the rules for a valid JavaScript identifier or a list of such strings separated with a comma; for example "<code>x</code>", "<code>theValue</code>", or "<code>a,b</code>". </dd></dl><dl> <dt><code>functionBody</code></dt> <dd>A string containing the JavaScript statements comprising the function definition.</dd></dl><p>Invoking the <code>Function</code> constructor as a function (without using the <code>new</code> operator) has the same effect as invoking it as a constructor.</p><h3 id="The_GeneratorFunction_constructor">The <code> GeneratorFunction</code> constructor</h3><div class="note"><p><strong>Note:</strong> Arrow function expressions are an <em>experimental technology,</em> part of the ECMAScript 6 proposal, and are not widely supported by browsers yet.</p></div><div class="note"><p><strong>Note:</strong> <code>GeneratorFunction</code> is not a global object, but could be obtained from generator function instance (see <a href="/en-US/docs/Web/JavaScript/Reference/Global_Objects/GeneratorFunction" title="The GeneratorFunction constructor creates a new generator function object. In JavaScript every generator function is actually a GeneratorFunction object."><code>GeneratorFunction</code></a> for more detail).</p></div><div class="note"><p><strong>Note: </strong> Using the <code>GeneratorFunction</code> constructor to create functions is not recommended since it needs the function body as a string which may prevent some JS engine optimizations and can also cause other problems.</p></div><p>As all other objects, <a href="/en-US/docs/Web/JavaScript/Reference/Global_Objects/GeneratorFunction" title="The GeneratorFunction constructor creates a new generator function object. In JavaScript every generator function is actually a GeneratorFunction object."><code>GeneratorFunction</code></a> objects can be created using the <code>new</code> operator:</p><pre class="syntaxbox">new GeneratorFunction (<em>arg1</em>, <em>arg2</em>, ... <em>argN</em>, <em>functionBody</em>) </pre><dl> <dt><code>arg1, arg2, ... arg<em>N</em></code></dt> <dd>Zero or more names to be used by the function as formal argument names. Each must be a string that conforms to the rules for a valid JavaScript identifier or a list of such strings separated with a comma; for example "<code>x</code>", "<code>theValue</code>", or "<code>a,b</code>".</dd></dl><dl> <dt><code> functionBody</code></dt> <dd>A string containing the JavaScript statements comprising the function definition.</dd></dl><p>Invoking the <code>Function</code> constructor as a function (without using the <code>new</code> operator) has the same effect as invoking it as a constructor.</p><h2 id="Function_parameters">Function parameters</h2><div class="note"><p><strong> Note:</strong> Default and rest parameters are <em>experimental technology,</em> part of the ECMAScript 6 proposal, and are not widely supported by browsers yet.</p></div><h3 id= "Default_parameters">Default parameters</h3><p>Default function parameters allow formal parameters to be initialized with default values if no value or <code>undefined</code> is passed. For more details, see<a href="/en-US/docs/Web/JavaScript/Reference/Functions/Default_parameters"> default parameters</a>.</p><h3 id="Rest_parameters">Rest parameters</h3><p>The rest parameter syntax allows to represent an indefinite number of arguments as an array. For more details, see <a href="/en-US/docs/Web/JavaScript/Reference/Functions/rest_parameters">rest parameters</a>.</p><h2 id="The_arguments_object">The <code>arguments</code> object</h2><p>You can refer to a function's arguments within the function by using the <code>arguments</code> object. See <a href="/en-US/docs/Web/JavaScript/Reference/Functions/arguments">arguments</a>.</p><ul> <li><code><a href= "/en-US/docs/JavaScript/Reference/Functions_and_function_scope/arguments">arguments</a></code>: An array-like object containing the arguments passed to the currently executing function. </li> <li><code><a href="/en-US/docs/JavaScript/Reference/Functions_and_function_scope/arguments/callee">arguments.callee</a></code> <span title="This deprecated API should no longer be used, but will probably still work."><i class="icon-thumbs-down-alt"> </i></span>: The currently executing function.</li> <li><code><a href= "/en-US/docs/JavaScript/Reference/Functions_and_function_scope/arguments/caller">arguments.caller</a></code> <span title="This is an obsolete API and is no longer guaranteed to work."><i class="icon-trash"> </i></span> : The function that invoked the currently executing function.</li> <li><code><a href= "/en-US/docs/JavaScript/Reference/Functions_and_function_scope/arguments/length">arguments.length</a></code>: The number of arguments passed to the function.</li></ul><h2 id= "Defining_method_functions">Defining method functions</h2><h3 id="Getter_and_setter_functions">Getter and setter functions</h3><p>You can define getters (accessor methods) and setters (mutator methods) on any standard built-in object or user-defined object that supports the addition of new properties. The syntax for defining getters and setters uses the object literal syntax.</p><dl> <dt><a href="/en-US/docs/Web/JavaScript/Reference/Functions/get">get</a></dt> <dd> <p>Binds an object property to a function that will be called when that property is looked up.</p> </dd> <dt><a href="/en-US/docs/Web/JavaScript/Reference/Functions/set">set</a></dt> <dd>Binds an object property to a function to be called when there is an attempt to set that property.</dd></dl><h3 id="Method_definition_syntax">Method definition syntax</h3><div class="note"><p><strong>Note:</strong> <em>Method definitions are experimental technology,</em> part of the ECMAScript 6 proposal, and are not widely supported by browsers yet.</p></div><p>Starting with ECMAScript 6, you are able to define own methods in a shorter syntax, similar to the getters and setters. See <a href="/en-US/docs/Web/JavaScript/Reference/Functions/Method_definitions">method definitions</a> for more information.</p><pre class="brush: js  language-js" data-number=""><code class=" language-js"><span class="token keyword">var</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span>  <span class="token function">foo<span class="token punctuation">(</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>  <span class="token function">bar<span class="token punctuation">(</span></span><span class="token punctuation">)</span> <span class="token punctuation"> {</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">;</span><div class="line-number" data-start="1" style="top: 0px;" ></div><div class="line-number" data-start="2" style="top: 19px;"></div><div class="line-number" data-start="3" style="top: 38px;"></div><div class="line-number" data-start="4" style= "top: 57px;"></div></code></pre><h2 id="Function_constructor_vs._function_declaration_vs._function_expression"><code>Function</code> constructor vs. function declaration vs. function expression</h2><p>Compare the following:</p><p>A function defined with the <code>Function</code> constructor assigned to the variable <code>multiply:</code></p><pre class="brush: js language-js" data-number=""><code class=" language-js"><span class="token keyword">function</span> <span class="token function">multiply<span class="token punctuation">(</span></span>x <span class="token punctuation">,</span> y<span class="token punctuation">)</span> <span class="token punctuation">{</span>   <span class="token keyword">return</span> x <span class= "token operator">*</span> y<span class="token punctuation">;</span><span class="token punctuation">}</span><div class="line-number" data-start="1" style="top: 0px;"></div><div class= "line-number" data-start="2" style="top: 19px;"></div><div class="line-number" data-start="3" style="top: 38px;"></div></code></pre><p>A <em>function expression</em> of an anonymous function assigned to the variable <code>multiply:</code></p><pre class="brush: js  language-js" data-number=""><code class=" language-js"><span class="token keyword">var</span> multiply <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span> <span class="token punctuation">{</span>   <span class="token keyword">return</span> x <span class="token operator">*</span> y<span class="token punctuation">; </span><span class="token punctuation">}</span><span class="token punctuation">;</span><div class="line-number" data-start="1" style="top: 0px;"></div><div class="line-number" data-start= "2" style="top: 19px;"></div><div class="line-number" data-start="3" style="top: 38px;"></div></code></pre><p>A <em>function expression</em> of a function named <code>func_name</code> assigned to the variable <code>multiply:</code></p><pre class="brush: js  language-js" data-number=""><code class=" language-js"><span class="token keyword">var</span> multiply <span class ="token operator">=</span> <span class="token keyword">function</span> <span class="token function">func_name<span class="token punctuation">(</span></span>x<span class="token punctuation" >,</span> y<span class="token punctuation">)</span> <span class="token punctuation">{</span>   <span class="token keyword">return</span> x <span class="token operator">*</span> y<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">;</span><div class="line-number" data-start="1" style="top: 0px;"></div><div class ="line-number" data-start="2" style="top: 19px;"></div><div class="line-number" data-start="3" style="top: 38px;"></div></code></pre><h3 id="Differences">Differences</h3><p>All do approximately the same thing, with a few subtle differences:</p><p>There is a distinction between the function name and the variable the function is assigned to. The function name cannot be changed, while the variable the function is assigned to can be reassigned. The function name can be used only within the function's body. Attempting to use it outside the function's body results in an error (or <code>undefined</code> if the function name was previously declared via a <code>var</code> statement). For example:</p><pre class="brush: js  language-js" data-number=""><code class=" language-js"><span class="token keyword">var</span> y <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token function">x<span class="token punctuation">(</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token function">alert<span class="token punctuation">(</span></span>x<span class="token punctuation">)</span><span class="token punctuation"> ;</span><span class="token comment" spellcheck="true"> // throws an error</span><div class="line-number" data-start="1" style="top: 0px;"></div><div class="line-number" data-start="2" style="top: 19px;"></div></code></pre><p>The function name also appears when the function is serialized via <a href="/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function/toString" ><code>Function</code>'s toString method</a>.</p><p>On the other hand, the variable the function is assigned to is limited only by its scope, which is guaranteed to include the scope where the function is declared in.</p><p>As the 4th example shows, the function name can be different from the variable the function is assigned to. They have no relation to each other.A function declaration also creates a variable with the same name as the function name. Thus, unlike those defined by function expressions, functions defined by function declarations can be accessed by their name in the scope they were defined in:</p><p>A function defined by '<code>new Function'</code> does not have a function name. However, in the <a href= "/en-US/docs/Mozilla/Projects/SpiderMonkey">SpiderMonkey</a> JavaScript engine, the serialized form of the function shows as if it has the name "anonymous". For example, <code>alert(new Function())</code> outputs:</p><pre class="brush: js  language-js" data-number=""><code class=" language-js"><span class="token keyword">function</span> <span class="token function"> anonymous<span class="token punctuation">(</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><div class= "line-number" data-start="1" style="top: 0px;"></div><div class="line-number" data-start="2" style="top: 19px;"></div></code></pre><p>Since the function actually does not have a name, <code>anonymous</code> is not a variable that can be accessed within the function. For example, the following would result in an error:</p><pre class="brush: js  language-js" data-number= ""><code class=" language-js"><span class="token keyword">var</span> foo <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name"> Function</span><span class="token punctuation">(</span><span class="token string">"alert(anonymous);"</span><span class="token punctuation">)</span><span class="token punctuation">; </span><span class="token function">foo<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span><div class= "line-number" data-start="1" style="top: 0px;"></div><div class="line-number" data-start="2" style="top: 19px;"></div></code></pre><p>Unlike functions defined by function expressions or by the <code>Function</code> constructor, a function defined by a function declaration can be used before the function declaration itself. For example:</p><pre class="brush: js language-js" data-number=""><code class=" language-js"><span class="token function">foo<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class= "token punctuation">;</span><span class="token comment" spellcheck="true"> // alerts FOO!</span><span class="token keyword">function</span> <span class="token function">foo<span class= "token punctuation">(</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>   <span class="token function">alert<span class="token punctuation">( </span></span><span class="token string">'FOO!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><div class= "line-number" data-start="1" style="top: 0px;"></div><div class="line-number" data-start="2" style="top: 19px;"></div><div class="line-number" data-start="3" style="top: 38px;"></div><div class="line-number" data-start="4" style="top: 57px;"></div></code></pre><p>A function defined by a function expression inherits the current scope. That is, the function forms a closure. On the other hand, a function defined by a <code>Function</code> constructor does not inherit any scope other than the global scope (which all functions inherit).</p><p>Functions defined by function expressions and function declarations are parsed only once, while those defined by the <code>Function</code> constructor are not. That is, the function body string passed to the <code>Function</code> constructor must be parsed each and every time the constructor is called. Although a function expression creates a closure every time, the function body is not reparsed, so function expressions are still faster than "<code>new Function(...)</code>". Therefore the <code>Function</code> constructor should generally be avoided whenever possible. </p><p>It should be noted, however, that function expressions and function declarations nested within the function generated by parsing a <code>Function constructor</code> 's string aren't parsed repeatedly. For example:</p><pre class="brush: js  language-js" data-number=""><code class=" language-js"><span class="token keyword">var</span> foo <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Function</span><span class="token punctuation">( </span><span class="token string">"var bar = \'FOO!\';\nreturn(function() {\n\talert(bar);\n});"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">foo<span class="token punctuation">( </span></span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true"> // The segment "function() {\n\talert(bar);\n}" of the function body string is not re-parsed.</span><div class="line-number" data-start="1" style="top: 0px;"></div><div class="line-number" data-start="2" style= "top: 19px;"></div></code></pre><p>A function declaration is very easily (and often unintentionally) turned into a function expression. A function declaration ceases to be one when it either:</p><ul> <li>becomes part of an expression</li> <li>is no longer a "source element" of a function or the script itself. A "source element" is a non-nested statement in the script or a function body:</li></ul><pre class="brush: js  language-js" data-number=""><code class=" language-js"><span class="token keyword">var</span> x <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>              <span class="token comment" spellcheck="true"> // source element</span><span class="token keyword"> if</span> <span class="token punctuation">(</span>x <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>           <span class="token comment" spellcheck="true"> // source element</span>   x <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>              <span class="token comment" spellcheck="true"> // not a source element</span>   <span class="token keyword">function</span> <span class= "token function">boo<span class="token punctuation">(</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token comment" spellcheck="true"> // not a source element</span><span class="token punctuation">}</span><span class="token keyword">function</span> <span class="token function">foo<span class="token punctuation">(</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token comment" spellcheck= "true"> // source element</span>   <span class="token keyword">var</span> y <span class="token operator">=</span> <span class="token number">20</span><span class="token punctuation">; </span>          <span class="token comment" spellcheck="true"> // source element</span>   <span class="token keyword">function</span> <span class="token function">bar<span class="token punctuation">(</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>    <span class="token comment" spellcheck="true"> // source element</span>   <span class="token keyword">while</span> <span class="token punctuation">(</span>y <span class="token operator">==</span> <span class="token number">10</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token comment" spellcheck="true"> // source element</span>      <span class="token keyword">function</span> <span class="token function">blah<span class="token punctuation">(</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token comment" spellcheck="true"> // not a source element</span>      y<span class="token operator">++</span><span class="token punctuation">;</span>              <span class="token comment" spellcheck="true"> // not a source element</span>   <span class="token punctuation">}</span><span class="token punctuation">}</span><div class="line-number" data-start="1" style="top: 0px;"></div><div class="line-number" data-start="2" style="top: 19px;"></div><div class="line-number" data-start= "3" style="top: 38px;"></div><div class="line-number" data-start="4" style="top: 57px;"></div><div class="line-number" data-start="5" style="top: 76px;"></div><div class="line-number" data-start="6" style="top: 95px;"></div><div class="line-number" data-start="7" style="top: 114px;"></div><div class="line-number" data-start="8" style="top: 133px;"></div><div class= "line-number" data-start="9" style="top: 152px;"></div><div class="line-number" data-start="10" style="top: 171px;"></div><div class="line-number" data-start="11" style="top: 190px;" ></div><div class="line-number" data-start="12" style="top: 209px;"></div><div class="line-number" data-start="13" style="top: 228px;"></div></code></pre><h3 id="Examples">Examples </h3><pre class="brush: js  language-js" data-number=""><code class=" language-js"><span class="token comment" spellcheck="true">// function declaration</span><span class="token keyword"> function</span> <span class="token function">foo<span class="token punctuation">(</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class= "token punctuation">}</span><span class="token comment" spellcheck="true">// function expression</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token function">bar<span class="token punctuation">(</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">// function expression</span>x <span class="token operator">=</span> <span class= "token keyword">function</span> <span class="token function">hello<span class="token punctuation">(</span></span><span class="token punctuation">)</span> <span class="token punctuation">{ </span><span class="token punctuation">}</span><span class="token keyword">if</span> <span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token comment" spellcheck="true"> // function expression</span>   <span class="token keyword">function</span> <span class="token function">world<span class="token punctuation">(</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token comment" spellcheck="true">// function declaration</span><span class="token keyword">function</span> <span class="token function">a<span class= "token punctuation">(</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token comment" spellcheck="true"> // function declaration </span>   <span class="token keyword">function</span> <span class="token function">b<span class="token punctuation">(</span></span><span class="token punctuation">)</span> <span class= "token punctuation">{</span><span class="token punctuation">}</span>   <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token number">0 </span><span class="token punctuation">)</span> <span class="token punctuation">{</span>     <span class="token comment" spellcheck="true"> // function expression</span>      <span class= "token keyword">function</span> <span class="token function">c<span class="token punctuation">(</span></span><span class="token punctuation">)</span> <span class="token punctuation">{ </span><span class="token punctuation">}</span>   <span class="token punctuation">}</span><span class="token punctuation">}</span><div class="line-number" data-start="1" style="top: 0px;" ></div><div class="line-number" data-start="2" style="top: 19px;"></div><div class="line-number" data-start="3" style="top: 38px;"></div><div class="line-number" data-start="4" style= "top: 57px;"></div><div class="line-number" data-start="5" style="top: 76px;"></div><div class="line-number" data-start="6" style="top: 95px;"></div><div class="line-number" data-start="7" style="top: 114px;"></div><div class="line-number" data-start="8" style="top: 133px;"></div><div class="line-number" data-start="9" style="top: 152px;"></div><div class="line-number" data-start="10" style="top: 171px;"></div><div class="line-number" data-start="11" style="top: 190px;"></div><div class="line-number" data-start="12" style="top: 209px;"></div><div class= "line-number" data-start="13" style="top: 228px;"></div><div class="line-number" data-start="14" style="top: 247px;"></div><div class="line-number" data-start="15" style="top: 266px;" ></div><div class="line-number" data-start="16" style="top: 285px;"></div><div class="line-number" data-start="17" style="top: 304px;"></div><div class="line-number" data-start="18" style= "top: 323px;"></div><div class="line-number" data-start="19" style="top: 342px;"></div><div class="line-number" data-start="20" style="top: 361px;"></div><div class="line-number" data-start="21" style="top: 380px;"></div><div class="line-number" data-start="22" style="top: 399px;"></div><div class="line-number" data-start="23" style="top: 418px;"></div><div class= "line-number" data-start="24" style="top: 437px;"></div><div class="line-number" data-start="25" style="top: 456px;"></div></code></pre><h2 id="Conditionally_defining_a_function"> Conditionally defining a function</h2><p>Functions can be conditionally defined using either //function statements// (an allowed extension to the <a href=" http://www.ecma-international.org/publications/standards/Ecma-262.htm" class="external external-icon">ECMA-262 Edition 3</a> standard) or the <code>Function</code> constructor. Please note that such <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=609832" class="external link-https external-icon">function statements are no longer allowed in ES5 strict</a>. Additionally, this feature does not work consistently cross-browser, so you should not rely on it.</p><p>In the following script, the <code>zero</code> function is never defined and cannot be invoked, because '<code>if (0)</code>' evaluates its condition to false:</p><pre class="brush: js  language-js" data-number=""><code class=" language-js"><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>   <span class="token keyword">function</span> <span class="token function">zero<span class="token punctuation">(</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>      document<span class="token punctuation">.</span><span class="token function">writeln<span class="token punctuation">(</span></span><span class="token string"> "This is zero."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token punctuation">}</span><span class="token punctuation">} </span><div class="line-number" data-start="1" style="top: 0px;"></div><div class="line-number" data-start="2" style="top: 19px;"></div><div class="line-number" data-start="3" style="top: 38px;"></div><div class="line-number" data-start="4" style="top: 57px;"></div><div class="line-number" data-start="5" style="top: 76px;"></div></code></pre><p>If the script is changed so that the condition becomes '<code>if (1)</code>', function <code>zero</code> is defined.</p><p>Note: Although this kind of function looks like a function declaration, it is actually an expression (or statement), since it is nested within another statement. See differences between function declarations and function expressions.</p><p>Note: Some JavaScript engines, not including <a href="/en-US/docs/SpiderMonkey">SpiderMonkey</a>, incorrectly treat any function expression with a name as a function definition. This would lead to <code>zero</code> being defined, even with the always-false <code>if</code> condition. A safer way to define functions conditionally is to define the function anonymously and assign it to a variable:</p><pre class="brush: js  language-js" data-number=""><code class=" language-js"><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token number">0 </span><span class="token punctuation">)</span> <span class="token punctuation">{</span>   <span class="token keyword">var</span> zero <span class="token operator">=</span> <span class= "token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>      document<span class="token punctuation">.</span><span class="token function">writeln<span class="token punctuation">(</span></span><span class="token string">"This is zero."</span><span class="token punctuation">) </span><span class="token punctuation">;</span>   <span class="token punctuation">}</span><span class="token punctuation">}</span><div class="line-number" data-start="1" style="top: 0px;" ></div><div class="line-number" data-start="2" style="top: 19px;"></div><div class="line-number" data-start="3" style="top: 38px;"></div><div class="line-number" data-start="4" style= "top: 57px;"></div><div class="line-number" data-start="5" style="top: 76px;"></div></code></pre><h2 id="Examples_2">Examples</h2><h3 id="Returning_a_formatted_number">Returning a formatted number</h3><p>The following function returns a string containing the formatted representation of a number padded with leading zeros.</p><pre class="brush: js  language-js" data-number=""><code class=" language-js"><span class="token comment" spellcheck="true">// This function returns a string padded with leading zeros</span><span class="token keyword"> function</span> <span class="token function">padZeros<span class="token punctuation">(</span></span>num<span class="token punctuation">,</span> totalLen<span class="token punctuation">) </span> <span class="token punctuation">{</span>   <span class="token keyword">var</span> numStr <span class="token operator">=</span> num<span class="token punctuation">.</span><span class="token function">toString<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class= "token comment" spellcheck="true"> // Initialize return value as string</span>   <span class="token keyword">var</span> numZeros <span class="token operator">=</span> totalLen <span class= "token operator">-</span> numStr<span class="token punctuation">.</span>length<span class="token punctuation">;</span><span class="token comment" spellcheck="true"> // Calculate no. of zeros</span>   <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class= "token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> numZeros<span class="token punctuation">;</span> i<span class="token operator"> ++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>      numStr <span class="token operator">=</span> <span class="token string">"0"</span> <span class="token operator">+</span> numStr<span class="token punctuation">;</span>   <span class="token punctuation">}</span>   <span class="token keyword">return</span> numStr<span class= "token punctuation">;</span><span class="token punctuation">}</span><div class="line-number" data-start="1" style="top: 0px;"></div><div class="line-number" data-start="2" style="top: 19px;"></div><div class="line-number" data-start="3" style="top: 38px;"></div><div class="line-number" data-start="4" style="top: 57px;"></div><div class="line-number" data-start="5" style ="top: 76px;"></div><div class="line-number" data-start="6" style="top: 95px;"></div><div class="line-number" data-start="7" style="top: 114px;"></div><div class="line-number" data-start= "8" style="top: 133px;"></div><div class="line-number" data-start="9" style="top: 152px;"></div></code></pre><p>The following statements call the padZeros function.</p><pre class="brush: js  language-js" data-number=""><code class=" language-js"><span class="token keyword">var</span> result<span class="token punctuation">;</span>result <span class="token operator">=</span> <span class="token function">padZeros<span class="token punctuation">(</span></span><span class="token number">42</span><span class="token punctuation">,</span><span class="token number"> 4</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true"> // returns "0042"</span>result <span class="token operator">=</span> <span class="token function">padZeros<span class="token punctuation">(</span></span><span class="token number">42</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true"> // returns "42"</span>result <span class="token operator">=</span> <span class="token function">padZeros<span class="token punctuation">(</span></span><span class="token number">5</span><span class="token punctuation" >,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true"> // returns "0005"</span><div class="line-number" data-start="1" style="top: 0px;"></div><div class="line-number" data-start="2" style="top: 19px;"></div><div class="line-number" data-start="3" style= "top: 38px;"></div><div class="line-number" data-start="4" style="top: 57px;"></div></code></pre><h3 id="Determining_whether_a_function_exists">Determining whether a function exists </h3><p>You can determine whether a function exists by using the <code>typeof</code> operator. In the following example, a test is peformed to determine if the <code>window</code> object has a property called <code>noFunc</code> that is a function. If so, it is used; otherwise some other action is taken.</p><pre class="brush: js  language-js" data-number=""><code class=" language-js"><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token string">'function'</span> <span class="token operator">==</span> <span class= "token keyword">typeof</span> window<span class="token punctuation">.</span>noFunc<span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token comment" spellcheck="true"> // use noFunc()</span> <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>  <span class= "token comment" spellcheck="true"> // do something else</span> <span class="token punctuation">}</span><div class="line-number" data-start="1" style="top: 0px;"></div><div class= "line-number" data-start="2" style="top: 19px;"></div><div class="line-number" data-start="3" style="top: 38px;"></div><div class="line-number" data-start="4" style="top: 57px;"></div><div class="line-number" data-start="5" style="top: 76px;"></div></code></pre><p>Note that in the <code>if</code> test, a reference to <code>noFunc</code> is used-there are no brackets "()" after the function name so the actual function is not called.</p><h2 id="Specifications">Specifications</h2><h2 id="Browser_compatibility">Browser compatibility</h2><p></p><div class= "htab">    <a name="AutoCompatibilityTable" id="AutoCompatibilityTable"></a>    <ul>        <li class="selected"><a>Desktop</a></li>        <li><a>Mobile</a></li>    </ul><div id= "compat-desktop"></div><div id="compat-mobile" ></div></div><p></p><h2 id="See_also">See also</h2>                                                </article>			</div>			</div> <!--=========================			END : POST		=============================-->		<!--=========================			START : POST =============================-->		<div class="post-wrapper">		<h1>CSS Guidelines : High-level advice and guidelines for writing sane, manageable, scalable CSS</h1>		<div class="wrapper">    <h1 class="hide">CSS Guidelines</h1><h2 class="alpha  site-title">High-level advice and guidelines for writing sane, manageable, scalable CSS</h2><h2 id= "about-the-author">About the Author</h2><p><cite>CSS Guidelines</cite> is a document by me, <a href="http://csswizardry.com/work/">HarryRoberts</a>. I am a Consultant Front-end Architectfrom the UK, and I help companies all over the world write and manage betterquality UIs for their products and teams. I am available for hire.</p><p class="text-center"><a href=" https://twitter.com/csswizardry" class="btn  btn--secondary"><span class="hide-palm">Follow me on </span>Twitter</a>or <a href="http://csswizardry.com/work/" class="btn">Hire<span class= "hide-palm"> Me</span></a></p><hr><h2 id="support-the-guidelines">Support the Guidelines</h2><p><cite>CSS Guidelines</cite> is provided through a pay-what-you-like model-from$0 upward. If <cite>CSS Guidelines</cite> is useful to you or your team, pleaseconsider <a href="https://gumroad.com/l/JAgjq">supporting it</a>.</p><p class="text-center"><a href=" https://gumroad.com/l/JAgjq" class="btn">Support the Guidelines</a></p><p>Get updates about changes, additions, and new and upcoming sections by following<a href=" https://twitter.com/cssguidelines">@cssguidelines</a> on Twitter.</p><hr><h2 id="contents">Contents</h2><ul>  <li><a href="#introduction">Introduction</a>    <ul>      <li><a href= "#the-importance-of-a-styleguide">The Importance of a Styleguide</a></li>      <li><a href="#disclaimers">Disclaimers</a></li>    </ul>  </li>  <li><a href="#syntax-and-formatting">Syntax and Formatting</a>    <ul>      <li><a href="#multiple-files">Multiple Files</a></li>      <li><a href="#table-of-contents">Table of Contents</a></li>      <li><a href="#characters-wide"> 80 Characters Wide</a></li>      <li><a href="#titling">Titling</a></li>      <li><a href="#anatomy-of-a-ruleset">Anatomy of a Ruleset</a></li>      <li><a href="#multi-line-css"> Multi-line CSS</a></li>      <li><a href="#indenting">Indenting</a>        <ul>          <li><a href="#indenting-sass">Indenting Sass</a></li>          <li><a href="#alignment">Alignment </a></li>        </ul>      </li>      <li><a href="#meaningful-whitespace">Meaningful Whitespace</a></li>      <li><a href="#html">HTML</a></li>    </ul>  </li>  <li><a href="#commenting" >Commenting</a>    <ul>      <li><a href="#high-level">High-level</a>        <ul>          <li><a href="#objectextension-pointers">Object–Extension Pointers</a></li>        </ul> </li>      <li><a href="#low-level">Low-level</a></li>      <li><a href="#preprocessor-comments">Preprocessor Comments</a></li>      <li><a href="#removing-comments">Removing Comments </a></li>    </ul>  </li>  <li><a href="#naming-conventions">Naming Conventions</a>    <ul>      <li><a href="#hyphen-delimited">Hyphen Delimited</a></li>      <li><a href= "#bem-like-naming">BEM-like Naming</a>        <ul>          <li><a href="#starting-context">Starting Context</a></li>          <li><a href="#more-layers">More Layers</a></li> <li><a href="#modifying-elements">Modifying Elements</a></li>        </ul>      </li>      <li><a href="#naming-conventions-in-html">Naming Conventions in HTML</a></li>      <li><a href= "#javascript-hooks">JavaScript Hooks</a>        <ul>          <li><a href="#data--attributes"><code>data-*</code> Attributes</a></li>        </ul>      </li>      <li><a href= "#taking-it-further">Taking It Further</a></li>    </ul>  </li>  <li><a href="#css-selectors">CSS Selectors</a>    <ul>      <li><a href="#selector-intent">Selector Intent</a></li> <li><a href="#reusability">Reusability</a></li>      <li><a href="#location-independence">Location Independence</a></li>      <li><a href="#portability">Portability</a>        <ul> <li><a href="#quasi-qualified-selectors">Quasi-Qualified Selectors</a></li>        </ul>      </li>      <li><a href="#naming">Naming</a>        <ul>          <li><a href= "#naming-ui-components">Naming UI Components</a></li>        </ul>      </li>      <li><a href="#selector-performance">Selector Performance</a>        <ul>          <li><a href= "#the-key-selector">The Key Selector</a></li>        </ul>      </li>      <li><a href="#general-rules">General Rules</a></li>    </ul>  </li>  <li><a href="#specificity">Specificity</a> <ul>      <li><a href="#ids-in-css">IDs in CSS</a></li>      <li><a href="#nesting">Nesting</a></li>      <li><a href="#important"><code>!important</code></a></li>      <li><a href= "#hacking-specificity">Hacking Specificity</a></li>    </ul>  </li>  <li><a href="#architectural-principles">Architectural Principles</a>    <ul>      <li><a href="#high-level-overview"> High-level Overview</a></li>      <li><a href="#object-orientation">Object-orientation</a></li>      <li><a href="#the-single-responsibility-principle">The Single Responsibility Principle </a></li>      <li><a href="#the-openclosed-principle">The Open/Closed Principle</a></li>      <li><a href="#dry">DRY</a></li>      <li><a href="#composition-over-inheritance">Composition over Inheritance</a></li>      <li><a href="#the-separation-of-concerns">The Separation of Concerns</a>        <ul>          <li><a href="#misconceptions">Misconceptions</a></li> </ul>      </li>    </ul>  </li></ul><h3 id="up-next">Up Next</h3><ul>  <li>Preprocessors</li>  <li>Layout</li>  <li>Performance</li>  <li>Sanity, Simplicity</li>  <li>Code Smells</li> <li>Legacy, Hacks, and Technical Debt</li></ul><hr><h2 id="introduction">Introduction</h2><p>CSS is not a pretty language. While it is simple to learn and get started with,it soon becomes problematic at any reasonable scale. There isn't much we can doto change how CSS works, but we can make changes to the way we author andstructure it.</p><p>In working on large, long-running projects, with dozens of developers ofdiffering specialities and abilities, it is important that we all work in aunified way in order to-among other things-</p><ul>  <li>keep stylesheets maintainable;</li>  <li>keep code transparent, sane, and readable;</li>  <li>keep stylesheets scalable.</li></ul><p>There are a variety of techniques we must employ in order to satisfy thesegoals, and <cite>CSS Guidelines</cite> is a document of recommendations andapproaches that will help us to do so.</p><h3 id="the-importance-of-a-styleguide">The Importance of a Styleguide</h3><p>A coding styleguide (note, not a visual styleguide) is a valuable tool for teamswho</p><ul>  <li>build and maintain products for a reasonable length of time;</li> <li>have developers of differing abilities and specialisms;</li>  <li>have a number of different developers working on a product at any given time;</li>  <li>on-board new staff regularly; </li>  <li>have a number of codebases that developers dip in and out of.</li></ul><p>Whilst styleguides are typically more suited to product teams-large codebases onlong-lived and evolving projects, with multiple developers contributing overprolonged periods of time-all developers should strive for a degree ofstandardisation in their code.</p><p>A good styleguide, when well followed, will</p><ul>  <li>set the standard for code quality across a codebase;</li>  <li>promote consistency across codebases;</li>  <li>give developers a feeling of familiarity across codebases;</li>  <li>increase productivity.</li></ul><p>Styleguides should be learned, understood, and implemented at all times on aproject which is governed by one, and any deviation must be fully justified.</p><h3 id="disclaimers">Disclaimers</h3><p><cite>CSS Guidelines</cite> is <em>a</em> styleguide; it is not <em>the</em> styleguide. Itcontains methodologies, techniques, and tips that I would firmly recommend to myclients and teams, but your own tastes and circumstances may well be different.Your mileage may vary.</p><p>These guidelines are opinionated, but they have been repeatedly tried, tested,stressed, refined, broken, reworked, and revisited over a number of years onprojects of all sizes.</p><hr><h2 id= "syntax-and-formatting">Syntax and Formatting</h2><p>One of the simplest forms of a styleguide is a set of rules regarding syntax andformatting. Having a standard way of writing (<em> literally</em> writing) CSS meansthat code will always look and feel familiar to all members of the team.</p><p>Further, code that looks clean <em>feels</em> clean. It is a much nicer environment towork in, and prompts other team members to maintain the standard of cleanlinessthat they found. Ugly code sets a bad precedent.</p><p>At a very high-level, we want</p><ul> <li>four (4) space indents, no tabs;</li>  <li>80 character wide columns;</li>  <li>multi-line CSS;</li>  <li>meaningful use of whitespace.</li></ul><p><span class="highlight" id= "did-you-see-this-bit">But, as with anything, thespecifics are somewhat irrelevant-consistency is key.</span></p><h3 id="multiple-files">Multiple Files</h3><p>With the meteoric rise of preprocessors of late, more often is the case thatdevelopers are splitting CSS across multiple files.</p><p>Even if not using a preprocessor, it is a good idea to split discrete chunks ofcode into their own files, which are concatenated during a build step.</p><p>If, for whatever reason, you are not working across multiple files, the nextsections might require some bending to fit your setup.</p><h3 id="table-of-contents">Table of Contents</h3><p>A table of contents is a fairly substantial maintenance overhead, but thebenefits it brings far outweigh any costs. It takes a diligent developer to keepa table of contents up to date, but it is well worth sticking with. Anup-to-date table of contents provides a team with a single, canonical catalogueof what is in a CSS project, what it does, and in what order.  </p><p>A simple table of contents will-in order, naturally-simply provide the name ofthe section and a brief summary of what it is and does, for example:</p><pre><code>/** * CONTENTS * * SETTINGS * Global...............Globally-available variables and config. * * TOOLS * Mixins...............Useful mixins. * * GENERIC * Normalize.css........A level playing field. * Box-sizing...........Better default `box-sizing`. * * BASE * Headings.............H1–H6 styles. * * OBJECTS * Wrappers.............Wrapping and constraining elements. * * COMPONENTS * Page-head............The main page header. * Page-foot............The main page footer. * Buttons..............Button elements. * * TRUMPS * Text.................Text helpers. */</code></pre><p>Each item maps to a section and/or include.</p><p>Naturally, this section would be substantially larger on the majority ofprojects, but hopefully we can see how this section-in the masterstylesheet-provides developers with a project-wide view of what is being usedwhere, and why.</p><h3 id="characters-wide">80 Characters Wide</h3><p>Where possible, limit CSS files' width to 80 characters. Reasons for thisinclude</p><ul>  <li>the ability to have multiple files open side by side;</li>  <li>viewing CSS on sites like GitHub, or in terminal windows;</li>  <li>providing a comfortable line length for comments.</li></ul><pre><code>/** * I am a long-form comment. I describe, in detail, the CSS that follows. I am * such a long comment that I easily break the 80 character limit, so I am * broken across several lines. */ </code></pre><p>There will be unavoidable exceptions to this rule-such as URLs, or gradientsyntax-which shouldn't be worried about.</p><h3 id="titling">Titling</h3><p>Begin every new major section of a CSS project with a title:</p><pre><code>/*------------------------------------*\    #SECTION-TITLE\*------------------------------------*/.selector {}</code></pre><p> The title of the section is prefixed with a hash (<code>#</code>) symbol to allow us toperform more targeted searches (e.g. <code>grep</code>, etc.): instead of searching forjust <kbd> SECTION-TITLE</kbd>-which may yield many results-a more scoped searchof <kbd>#SECTION-TITLE</kbd> should return only the section in question.</p><p>Leave a carriage return between this title and the next line of code (be that acomment, some Sass, or some CSS).</p><p>If you are working on a project where each section is its own file, this titleshould appear at the top of each one. If you are working on a project withmultiple sections per file, each title should be preceded by five (5) carriagereturns. This extra whitespace coupled with a title makes new sections mucheasier to spot when scrolling through large files:</p><pre><code>/*------------------------------------*\    #A-SECTION\*------------------------------------*/.selector {}/*------------------------------------*\    #ANOTHER-SECTION\*------------------------------------*//** * Comment */.another-selector {}</code></pre><h3 id="anatomy-of-a-ruleset"> Anatomy of a Ruleset</h3><p>Before we discuss how we write out our rulesets, let's first familiariseourselves with the relevant terminology:</p><pre><code>[selector] {    [property]: [value];    [&lt;--declaration---&gt;]}</code></pre><p>For example:</p><pre><code>.foo, .foo--bar,.baz {    display: block;    background-color: green;    color: red;}</code></pre><p>Here you can see we have</p><ul>  <li>related selectors on the same line; unrelated selectors on new lines;</li>  <li>a space before our opening brace (<code>{</code>);</li>  <li>properties and values on the same line;</li>  <li>a space after our property–value delimiting colon (<code>:</code>);</li>  <li>each declaration on its own new line;</li>  <li>the opening brace ( <code>{</code>) on the same line as our last selector;</li>  <li>our first declaration on a new line after our opening brace (<code>{</code>);</li>  <li>our closing brace (<code>}</code>) on its own new line;</li>  <li>each declaration indented by four (4) spaces;</li>  <li>a trailing semi-colon (<code>;</code>) on our last declaration.</li></ul><p>This format seems to be the largely universal standard (except for variations innumber of spaces, with a lot of developers preferring two (2)).</p><p>As such, the following would be incorrect:</p><pre><code> .foo, .foo--bar, .baz{	display:block;	background-color:green;	color:red }</code></pre><p>Problems here include</p><ul>  <li>tabs instead of spaces;</li>  <li>unrelated selectors on the same line;</li>  <li>the opening brace (<code>{</code>) on its own line;</li>  <li>the closing brace (<code>}</code>) does not sit on its own line;</li>  <li>the trailing (and, admittedly, optional) semi-colon (<code>;</code>) is missing;</li>  <li>no spaces after colons (<code>:</code>).</li></ul><h3 id="multi-line-css">Multi-line CSS</h3><p>CSS should be written across multiple lines, except in very specificcircumstances. There are a number of benefits to this:</p><ul>  <li>A reduced chance of merge conflicts, because each piece of functionalityexists on its own line.</li>  <li>More 'truthful' and reliable <code>diff</code>s, because one line only ever carries onechange.</li></ul><p>Exceptions to this rule should be fairly apparent, such as similar rulesets thatonly carry one declaration each, for example:</p><pre><code>.icon {    display: inline-block;    width:  16px;    height: 16px; background-image: url(/img/sprite.svg);}.icon--home     { background-position:   0     0  ; }.icon--person   { background-position: -16px   0  ; }.icon--files    { background-position: 0   -16px; }.icon--settings { background-position: -16px -16px; }</code></pre><p>These types of ruleset benefit from being single-lined because</p><ul>  <li>they still conform to the one-reason-to-change-per-line rule;</li>  <li>they share enough similarities that they don't need to be read as thoroughlyas other rulesets-there is more benefit in being able to scan their selectors,which are of more interest to us in these cases.</li></ul><h3 id="indenting">Indenting</h3><p>As well as indenting individual declarations, indent entire related rulesets tosignal their relation to one another, for example:</p><pre><code>.foo {}    .foo__bar {}        .foo__baz {}</code></pre><p>By doing this, a developer can see at a glance that <code> .foo__baz {}</code> lives inside<code>.foo__bar {}</code> lives inside <code>.foo {}</code>.</p><p>This quasi-replication of the DOM tells developers a lot about where classes areexpected to be used without them having to refer to a snippet of HTML.</p><h4 id="indenting-sass">Indenting Sass</h4><p>Sass provides nesting functionality. That is to say, by writing this: </p><pre><code>.foo {    color: red;    .bar {        color: blue;    }}</code></pre><p>...we will be left with this compiled CSS:</p><pre><code>.foo { color: red; }.foo .bar { color: blue; }</code></pre><p>When indenting Sass, we stick to the same four (4) spaces, and we also leave ablank line before and after the nested ruleset.</p><p><strong>N.B.</strong> Nesting in Sass should be avoided wherever possible. See <a href="#specificity">theSpecificity section</a> for more details.</p><h4 id="alignment">Alignment</h4><p>Attempt to align common and related identical strings in declarations, forexample:</p><pre><code>.foo {    -webkit-border-radius: 3px;       -moz-border-radius: 3px;            border-radius: 3px;}.bar { position: absolute;    top:    0;    right:  0;    bottom: 0;    left:   0;    margin-right: -10px;    margin-left:  -10px;    padding-right: 10px;    padding-left:  10px;}</code></pre><p> This makes life a little easier for developers whose text editors support columnediting, allowing them to change several identical and aligned lines in one go.</p><div class="box box--promo  box--outdent">    <p>It looks like you're enjoying these guidelines...</p>    <p><a href="https://gumroad.com/l/JAgjq" class="btn  btn--full  btn--tertiary">Support Them </a></p></div><h3 id="meaningful-whitespace">Meaningful Whitespace</h3><p>As well as indentation, we can provide a lot of information through liberal andjudicious use of whitespace between rulesets. We use:</p><ul>  <li>One (1) empty line between closely related rulesets.</li>  <li>Two (2) empty lines between loosely related rulesets.</li>  <li>Five (5) empty lines between entirely new sections.</li></ul><p>For example:</p><pre><code>/*------------------------------------*\    #FOO\*------------------------------------*/.foo {}    .foo__bar {}.foo--baz {}/*------------------------------------*\    #BAR\*------------------------------------*/.bar {}    .bar__baz {}    .bar__foo {}</code></pre><p>There should never be a scenario in which two rulesets do not have an empty linebetween them. This would be incorrect:</p><pre><code>.foo {}    .foo__bar {}.foo--baz {}</code></pre><h3 id="html">HTML</h3><p> Given HTML and CSS' inherently interconnected nature, it would be remiss of meto not cover some syntax and formatting guidelines for markup.</p><p>Always quote attributes, even if they would work without. This reduces thechance of accidents, and is a more familiar format to the majority ofdevelopers. For all this would work (and is valid):</p><pre><code>&lt;div class=box &gt;</code></pre><p>...this format is preferred:</p><pre><code>&lt;div class="box"&gt;</code></pre><p>The quotes are not required here, but err on the safe side and include them.</p><p> When writing multiple values in a class attribute, separate them with twospaces, thus:</p><pre><code>&lt;div class="foo  bar"&gt;</code></pre><p>When multiple classes are related to each other, consider grouping them insquare brackets (<code>[</code> and <code>]</code>), like so:</p><pre><code>&lt;div class="[ box  box--highlight ]  [ bio  bio--long ]"&gt;</code></pre><p> This is not a firm recommendation, and is something I am still trialling myself,but it does carry a number of benefits. Read more in <a href=" http://csswizardry.com/2014/05/grouping-related-classes-in-your-markup/"><cite>Grouping relatedclasses in yourmarkup</cite></a>.</p><p>As with our rulesets, it is possible to use meaningful whitespace in your HTML.You can denote thematic breaks in content with five (5) empty lines, forexample:</p><pre><code>&lt;header class="page-head"&gt;    ...&lt;/header&gt;&lt; main class="page-content"&gt;    ...&lt;/main&gt;&lt;footer class="page-foot"&gt;    ...&lt;/footer&gt;</code></pre><p>Separate independent but loosely related snippets of markup with a single emptyline, for example:</p><pre><code>&lt;ul class="primary-nav"&gt;    &lt;li class="primary-nav__item"&gt;        &lt;a href="/" class="primary-nav__link"&gt;Home&lt;/a&gt; &lt;/li&gt;    &lt;li class="primary-nav__item  primary-nav__trigger"&gt;        &lt;a href="/about" class="primary-nav__link"&gt;About&lt;/a&gt;        &lt;ul class="primary-nav__sub-nav" &gt;            &lt;li&gt;&lt;a href="/about/products"&gt;Products&lt;/a&gt;&lt;/li&gt;            &lt;li&gt;&lt;a href="/about/company"&gt;Company&lt;/a&gt;&lt;/li&gt;        &lt;/ul&gt; &lt;/li&gt;    &lt;li class="primary-nav__item"&gt;        &lt;a href="/contact" class="primary-nav__link"&gt;Contact&lt;/a&gt;    &lt;/li&gt;&lt;/ul&gt;</code></pre><p>This allows developers to spot separate parts of the DOM at a glance, and alsoallows certain text editors-like Vim, for example-to manipulateempty-line-delimited blocks of markup.</p><h3 id= "further-reading">Further Reading</h3><ul>  <li><a href="http://csswizardry.com/2014/05/grouping-related-classes-in-your-markup/"><cite>Grouping related classes in your markup </cite></a></li></ul><hr><h2 id="commenting">Commenting</h2><p>The cognitive overhead of working with CSS is huge. With so much to be aware of,and so many project-specific nuances to remember, the worst situation mostdevelopers find themselves in is being the-person-who-didn't-write-this-code.Remembering your own classes, rules, objects, and helpers is manageable <em> to anextent</em>, but anyone inheriting CSS barely stands a chance.</p><p><strong>CSS needs more comments.</strong></p><p>As CSS is something of a declarative language that doesn't really leave much ofa paper-trail, it is often hard to discern-from looking at the CSS alone-</p><ul>  <li>whether some CSS relies on other code elsewhere;</li>  <li>what effect changing some code will have elsewhere;</li>  <li>where else some CSS might be used;</li>  <li>what styles something might inherit (intentionally or otherwise);</li>  <li>what styles something might pass on (intentionally or otherwise);</li>  <li>where the author intended a piece of CSS to be used.</li></ul><p>This doesn't even take into account some of CSS' many quirks-such as varioussates of <code>overflow</code> triggering block formatting context, or certain transformproperties triggering hardware acceleration-that make it even more baffling todevelopers inheriting projects.</p><p>As a result of CSS not telling its own story very well, it is a language thatreally does benefit from being heavily commented.</p><p>As a rule, you should comment anything that isn't immediately obvious from thecode alone. That is to say, there is no need to tell someone that <code>color: red;</code>will make something red, but if you're using <code>overflow: hidden;</code> to clearfloats-as opposed to clipping an element's overflow-this is probably somethingworth documenting.</p><h3 id="high-level">High-level</h3><p>For large comments that document entire sections or components, we use aDocBlock-esque multi-line comment which adheres to our 80 column width.</p><p>Here is a real-life example from the CSS which styles the page header on <a href="http://csswizardry.com/">CSSWizardry</a>:</p><pre><code>/** * The site's main page-head can have two different states: * * 1) Regular page-head with no backgrounds or extra treatments; it just *    contains the logo and nav. * 2) A masthead that has a fluid-height (becoming fixed after a certain point) *    which has a large background image, and some supporting text. * * The regular page-head is incredibly simple, but the masthead version has some * slightly intermingled dependency with the wrapper that lives inside it. */</code></pre><p>This level of detail should be the norm for all non-trivial code-descriptions ofstates, permutations, conditions, and treatments.</p><h4 id= "objectextension-pointers">Object–Extension Pointers</h4><p>When working across multiple partials, or in an OOCSS manner, you will oftenfind that rulesets that can work in conjunction with each other are not alwaysin the same file or location. For example, you may have a generic buttonobject-which provides purely structural styles-which is to be extended in acomponent-level partial which will add cosmetics. We document this relationshipacross files with simple <i>object–extension pointers</i>. In the object file:</p><pre><code>/** * Extend `.btn {}` in _components.buttons.scss. */.btn {}</code></pre><p>And in your theme file:</p><pre><code>/** * These rules extend `.btn {}` in _objects.buttons.scss. */.btn--positive {}.btn--negative {}</code></pre><p>This simple, low effort commenting can make a lot of difference to developerswho are unaware of relationships across projects, or who are wanting to knowhow, why, and where other styles might be being inherited from.</p><h3 id="low-level">Low-level</h3><p>Oftentimes we want to comment on specific declarations (i.e. lines) in aruleset. To do this we use a kind of reverse footnote. Here is a more complexcomment detailing the larger site headers mentioned above:</p><pre><code>/** * Large site headers act more like mastheads. They have a faux-fluid-height * which is controlled by the wrapping element inside it. * * 1. Mastheads will typically have dark backgrounds, so we need to make sure *    the contrast is okay. This value is subject to change as the background *    image changes. * 2. We need to delegate a lot of the masthead's layout to its wrapper element *    rather than the masthead itself: it is to this wrapper that most things *    are positioned. * 3. The wrapper needs positioning context for us to lay our nav and masthead *    text in. * 4. Faux-fluid-height technique: simply create the illusion of fluid height by *    creating space via a percentage padding, and then position everything over *    the top of that. This percentage gives us a 16:9 ratio. * 5. When the viewport is at 758px wide, our 16:9 ratio means that the masthead *    is currently rendered at 480px high. Let's... * 6. ...seamlessly snip off the fluid feature at this height, and... * 7. ...fix the height at 480px. This means that we should see no jumps in height *    as the masthead moves from fluid to fixed. This actual value takes into *    account the padding and the top border on the header itself. */.page-head--masthead {    margin-bottom: 0;    background: url(/img/css/masthead.jpg) center center #2e2620;    @include vendor(background-size, cover);    color: $color-masthead; /* [1] */    border-top-color: $color-masthead;    border-bottom-width: 0;    box-shadow: 0 0 10px rgba(0, 0, 0, 0.1) inset;    @include media-query(lap-and-up) {        background-image: url(/img/css/masthead-medium.jpg);    }    @include media-query(desk) {        background-image: url(/img/css/masthead-large.jpg);    }    &gt; .wrapper { /* [2] */        position: relative; /* [3] */        padding-top: 56.25%; /* [4] */        @media screen and (min-width: 758px) { /* [5] */            padding-top: 0; /* [6] */            height: $header-max-height - double($spacing-unit) - $header-border-width; /* [7] */        }    }}</code></pre><p>These types of comment allow us to keep all of our documentation in one placewhilst referring to the parts of the ruleset to which they belong.</p><h3 id="preprocessor-comments">Preprocessor Comments </h3><p>With most-if not all-preprocessors, we have the option to write comments thatwill not get compiled out into our resulting CSS file. As a rule, use thesecomments to document code that would not get written out to that CSS fileeither. If you are documenting code which will get compiled, use comments thatwill compile also. For example, this is correct:</p><pre><code> // Dimensions of the @2x image sprite:$sprite-width:  920px;$sprite-height: 212px;/** * 1. Default icon size is 16px. * 2. Squash down the retina sprite to display at the correct size. */.sprite {    width:  16px; /* [1] */    height: 16px; /* [1] */    background-image: url(/img/sprites/main.png);    background-size: ($sprite-width / 2 ) ($sprite-height / 2); /* [2] */} </code></pre><p>We have documented variables-code which will not get compiled into our CSSfile-with preprocessor comments, whereas our CSS-code which will get compiledinto our CSS file-is documented using CSS comments. This means that we have onlythe correct and relevant information available to us when debugging our compiledstylesheets.</p><h3 id="removing-comments"> Removing Comments</h3><p>It should go without saying that no comments should make their way intoproduction environments-all CSS should be minified, resulting in loss ofcomments, before being deployed.</p><hr><h2 id="naming-conventions">Naming Conventions</h2><p>Naming conventions in CSS are hugely useful in making your code morestrict, more transparent, and more informative.</p><p>A good naming convention will tell you and your team</p><ul>  <li>what type of thing a class does;</li>  <li>where a class can be used;</li>  <li>what (else) a class might be related to.</li></ul><p>The naming convention I follow is very simple: hyphen (<code>-</code>) delimited strings,with BEM-like naming for more complex pieces of code.</p><p>It's worth noting that a naming convention is not normally useful CSS-side ofdevelopment; they really come into their own when viewed in HTML.</p><h3 id="hyphen-delimited">Hyphen Delimited </h3><p>All strings in classes are delimited with a hyphen (<code>-</code>), like so:</p><pre><code>.page-head {}.sub-content {}</code></pre><p>Camel case and underscores are not used for regular classes; the following areincorrect:</p><pre><code>.pageHead {}.sub_content {}</code></pre><h3 id="bem-like-naming">BEM-like Naming</h3><p>For larger, more interrelated pieces of UI that require a number of classes, weuse a BEM-like naming convention.</p><p><cite>BEM</cite>, meaning <i>Block</i>, <i>Element</i>, <i>Modifier</i>, is afront-end methodology coined by developers working at Yandex. Whilst BEM is acomplete methodology, here we are only concerned with its naming convention.Further, the naming convention here only is BEM-<em>like</em>; the principles areexactly the same, but the actual syntax differs slightly.</p><p>BEM splits components' classes into three groups:</p><ul>  <li>Block: The sole root of the component.</li> <li>Element: A component part of the Block.</li>  <li>Modifier: A variant or extension of the Block.</li></ul><p>To take an analogy (note, not an example):</p><pre><code>.person {}.person__head {}.person--tall {}</code></pre><p>Elements are delimited with two (2) underscores (<code>__</code>), and Modifiers aredelimited by two (2) hyphens (<code>--</code>).</p><p> Here we can see that <code>.person {}</code> is the Block; it is the sole root of adiscrete entity. <code>.person__head {}</code> is an Element; it is a smaller part of the<code>.person {} </code> Block. Finally, <code>.person--tall {}</code> is a Modifier; it is a specificvariant of the <code>.person {}</code> Block.</p><h4 id="starting-context">Starting Context</h4><p> Your Block context starts at the most logical, self-contained, discretelocation. To continue with our person-based analogy, we'd not have a class like<code>.room__person {}</code>, as the room is another, much higher context. We'd probablyhave separate Blocks, like so:</p><pre><code>.room {}    .room__door {}.room--kitchen {}.person {}    .person__head {}</code></pre><p>If we did want to denote a <code>.person {}</code> inside a <code>.room {}</code>, it is more correctto use a selector like <code>.room .person {}</code> which bridges two Blocks than it is toincrease the scope of existing Blocks and Elements.</p><p>A more realistic example of properly scoped blocks might look something likethis, where each chunk of code represents its own Block:</p><pre><code>.page {}.content {}.sub-content {}.footer {}    .footer__copyright {}</code></pre><p>Incorrect notation for this would be:</p><pre><code>.page {}    .page__content {}    .page__sub-content {}    .page__footer {}        .page__copyright {}</code></pre><p>It is important to know when BEM scope starts and stops. As a rule, BEM appliesto self-contained, discrete parts of the UI.</p><div class="box  box--promo  box--outdent">    <p>Something you need some more help with?</p>    <p><a href="http://csswizardry.com/work/" class="btn btn--full  btn--tertiary">Hire me</a></p></div><h4 id="more-layers">More Layers</h4><p>If we were to add another Element-called, let's say, <code>.person__eye {}</code>-to this<code> .person {}</code> component, we would not need to step through every layer of theDOM. That is to say, the correct notation would be <code>.person__eye {}</code>, and not<code> .person__head__eye {}</code>. Your classes do not reflect the full paper-trail of theDOM.</p><h4 id="modifying-elements">Modifying Elements</h4><p>You can have variants of Elements, and these can be denoted in a number of waysdepending on how and why they are being modified. Carrying on with our personexample, a blue eye might look like this:</p><pre><code> .person__eye--blue {}</code></pre><p>Here we can see we're directly modifying the eye Element.</p><p>Things can get more complex, however. Please excuse the crude analogy, and let'simagine we have a face Element that is handsome. The person themselves isn'tthat handsome, so we modify the face Element directly-a handsome face on aregular person:</p><pre><code> .person__face--handsome {}</code></pre><p>But what if that person <em>is</em> handsome, and we want to style their face becauseof that fact? A regular face on a handsome person: </p><pre><code>.person--handsome .person__face {}</code></pre><p>Here is one of a few occasions where we'd use a descendant selector to modifyan Element based on a Modifier on the Block. </p><p>If using Sass, we would likely write this like so:</p><pre><code>.person {}    .person__face {        .person--handsome &amp; {}    }.person--handsome {}</code></pre><p>Note that we do not nest a new instance of <code>.person__face {}</code> inside of<code>.person--handsome {}</code>; instead, we make use of Sass' parent selectors toprepend <code>.person--handsome </code> onto the existing <code>.person__face {}</code> selector. Thismeans that all of our <code>.person__face {}</code>-related rules exist in once place, andaren't spread throughout the file. This is general good practice when dealingwith nested code: keep all of your context (e.g. all <code>.person__face {}</code> code)encapsulated in one location.</p><h3 id= "naming-conventions-in-html">Naming Conventions in HTML</h3><p>As I previously hinted at, naming conventions aren't necessarily all that usefulin your CSS. Where naming conventions' power really lies is in your markup. Takethe following, non-naming-conventioned HTML:</p><pre><code>&lt;div class="box  profile  pro-user"&gt;    &lt;img class="avatar  image" /&gt;    &lt;p class="bio"&gt;...&lt;/p&gt;&lt;/div&gt;</code></pre><p>How are the classes <code>box</code> and <code>profile</code> related to each other? How are theclasses <code>profile</code> and <code>avatar</code> related to each other? Are they related at all?Should you be using <code>pro-user</code> alongside <code>bio</code>? Will the classes <code>image</code> and<code> profile</code> live in the same part of the CSS? Can you use <code>avatar</code> anywhere else?</p><p>From that markup alone, it is very hard to answer any of those questions. Usinga naming convention, however, changes all that:</p><pre><code>&lt;div class="box  profile  profile--is-pro-user"&gt;    &lt;img class="avatar  profile__image" /&gt;    &lt;p class="profile__bio"&gt;...&lt;/p&gt;&lt;/div&gt;</code></pre><p>Now we can clearly see which classes are and are not related to each other, andhow; we know what classes we can't use outside of the scope of this component;and we know which classes we may be free to reuse elsewhere.</p><h3 id="javascript-hooks">JavaScript Hooks</h3><p>As a rule, it is unwise to bind your CSS and your JS onto the same class in yourHTML. This is because doing so means you can't have (or remove) one without(removing) the other. It is much cleaner, much more transparent, and much moremaintainable to bind your JS onto specific classes.</p><p>I have known occasions before when trying to refactor some CSS has unwittinglyremoved JS functionality because the two were tied to each other-it wasimpossible to have one without the other.</p><p>Typically, these are classes that are prepended with <code>js-</code>, for example:</p><pre><code>&lt; input type="submit" class="btn  js-btn" value="Follow" /&gt;</code></pre><p>This means that we can have an element elsewhere which can carry with style of<code>.btn {}</code>, but without the behaviour of <code>.js-btn</code>.</p><h4 id="data--attributes"><code>data-*</code> Attributes</h4><p>A common practice is to use <code>data-*</code> attributes as JS hooks, but this isincorrect. <code>data-*</code> attributes, as per the spec, are used <q><strong>to store customdata</strong> private to the page or application</q> (emphasis mine). <code>data-*</code> attributes are designed to store data, not be bound to.</p><h3 id="taking-it-further">Taking It Further</h3><p>As previously mentioned, these are very simple naming conventions, and ones thatdon't do much more than denote three distinct groups of class.</p><p>I would encourage you to read up on and further look in to your namingconvention in order to provide more functionality-I know it's something I'm keento research and investigate further.</p><h3 id="further-reading-1">Further Reading</h3><ul>  <li><a href=" http://csswizardry.com/2013/01/mindbemding-getting-your-head-round-bem-syntax/"><cite>MindBEMding – getting your head 'round BEM syntax</cite></a></li></ul><hr><h2 id="css-selectors">CSS Selectors</h2><p>Perhaps somewhat surprisingly, one of the most fundamental, critical aspects ofwriting maintainable and scalable CSS is selectors. Their specificity, theirportability, and their reusability all have a direct impact on the mileage wewill get out of our CSS, and the headaches it might bring us.</p><h3 id="selector-intent">Selector Intent</h3><p>It is important when writing CSS that we scope our selectors correctly, and thatwe're selecting the right things for the right reasons. <i>Selector Intent</i>is the process of deciding and defining what you want to style and how youwill go about selecting it. For example, if you are wanting to style yourwebsite's main navigation menu, a selector like this would be incredibly unwise:</p><pre><code>header ul {}</code></pre><p>This selector's intent is to style any <code>ul</code> inside any <code>header</code> element, whereas<em>our</em> intent was to style the site's main navigation. This is poor SelectorIntent: you can have any number of <code>header</code> elements on a page, and they in turncan house any number of <code>ul</code> s, so a selector like this runs the risk of applyingvery specific styling to a very wide number of elements. This will result inhaving to write more CSS to undo the greedy nature of such a selector.</p><p>A better approach would be a selector like:</p><pre><code>.site-nav {}</code></pre><p>An unambiguous, explicit selector with good Selector Intent. We are explicitlyselecting the right thing for exactly the right reason.</p><p>Poor Selector Intent is one of the biggest reasons for headaches on CSSprojects. Writing rules that are far too greedy-and that apply very specifictreatments via very far reaching selectors-causes unexpected side effects andleads to very tangled stylesheets, with selectors overstepping their intentionsand impacting and interfering with otherwise unrelated rulesets.</p><p>CSS cannot be encapsulated, it is inherently leaky, but we can mitigate some ofthese effects by not writing such globally-operating selectors: <strong>your selectorsshould be as explicit and well reasoned as your reason for wanting to selectsomething.</strong></p><h3 id="reusability"> Reusability</h3><p>With a move toward a more component-based approach to constructing UIs, the ideaof reusability is paramount. We want the option to be able to move, recycle,duplicate, and syndicate components across our projects.</p><p>To this end, we make heavy use of classes. IDs, as well as being hugelyover-specific, cannot be used more than once on any given page, whereas classescan be reused an infinite amount of times. Everything you choose, from the typeof selector to its name, should lend itself toward being reused.</p><h3 id= "location-independence">Location Independence</h3><p>Given the ever-changing nature of most UI projects, and the move to morecomponent-based architectures, it is in our interests not to style things basedon where they are, but on <em>what</em> they are. That is to say, our components'styling should not be reliant upon where we place them-they should remainentirely location independent.</p><p>Let's take an example of a call-to-action button that we have chosen to stylevia the following selector:</p><pre><code>.promo a {}</code></pre><p>Not only does this have poor Selector Intent-it will greedily style any andevery link inside of a <code>.promo</code> to look like a button-it is also pretty wastefulas a result of being so locationally dependent: we can't reuse that button withits correct styling outside of <code>.promo</code> because it is explicitly tied to thatlocation. A far better selector would have been:</p><pre><code>.btn {}</code></pre><p>This single class can be reused anywhere outside of <code>.promo</code> and will alwayscarry its correct styling. As a result of a better selector, this piece of UI ismore portable, more recyclable, doesn't have any dependencies, and has muchbetter Selector Intent. <strong>A component shouldn't have to live in a certain placeto look a certain way.</strong></p><h3 id="portability">Portability</h3><p>Reducing, or, ideally, removing, location dependence means that we can movecomponents around our markup more freely, but how about improving our ability tomove classes around components? On a much lower level, there are changes wecan make to our selectors that make the selectors themselves-as opposed to thecomponents they create-more portable. Take the following example:</p><pre><code>input.btn {}</code></pre><p>This is a <i>qualified</i> selector; the leading <code>input</code> ties this ruleset toonly being able to work on <code>input</code> elements. By omitting this qualification, weallow ourselves to reuse the <code>.btn</code> class on any element we choose, like an <code>a</code>,for example, or a <code>button</code>.</p><p>Qualified selectors do not lend themselves well to being reused, and everyselector we write should be authored with reuse in mind.</p><p>Of course, there are times when you may want to legitimately qualify aselector-you might need to apply some very specific styling to a particularelement when it carries a certain class, for example:</p><pre><code>/** * Embolden and colour any element with a class of `.error`. */.error {    color: red;    font-weight: bold;}/** * If the element is a `div`, also give it some box-like styling. */div.error {    padding: 10px;    border: 1px solid;}</code></pre><p>This is one example where a qualified selector might be justifiable, but I wouldstill recommend an approach more like:</p><pre><code>/** * Text-level errors. */.error-text {    color: red;    font-weight: bold;}/** * Elements that contain errors. */.error-box {    padding: 10px;    border: 1px solid;}</code></pre><p>This means that we can apply <code>.error-box</code> to any element, and not just a<code>div </code>-it is more reusable than a qualified selector.</p><h4 id="quasi-qualified-selectors">Quasi-Qualified Selectors</h4><p>One thing that qualified selectors can be useful for is signalling where a classmight be expected or intended to be used, for example:</p><pre><code>ul.nav {}</code></pre><p>Here we can see that the <code>.nav</code> class is meant to be used on a <code>ul</code> element, andnot on a <code>nav</code>. By using <i>quasi-qualified selectors</i> we can still providethat information without actually qualifying the selector: </p><pre><code>/*ul*/.nav {}</code></pre><p>By commenting out the leading element, we can still leave it to be read, butavoid qualifying and increasing the specificity of the selector. </p><h3 id="naming">Naming</h3><p>As Phil Karlton once said, <q>There are only two hard things in ComputerScience: cache invalidation and naming things.</q></p><p>I won't comment on the former claim here, but the latter has plagued me foryears.  My advice with regard to naming things in CSS is to pick a name that issensible, but somewhat ambiguous: aim for high reusability. For example, insteadof a class like <code>.site-nav</code>, choose something like <code>.primary-nav</code>; rather than<code>.footer-links</code>, favour a class like <code> .sub-links</code>.</p><p>The differences in these names is that the first of each two examples is tied toa very specific use case: they can only be used as the site's navigation or thefooter's links respectively. By using slightly more ambiguous names, we canincrease our ability to reuse these components in different circumstances.</p><p>To quote Nicolas Gallagher: </p><blockquote>  <p>Tying your class name semantics tightly to the nature of the content has alreadyreduced the ability of your architecture to scale or be easily put to use byother developers.</p></blockquote><p>That is to say, we should use sensible names-classes like <code>.border</code> or <code>.red</code>are never advisable-but we should avoid using classes which describe the exactnature of the content and/or its use cases. <strong>Using a class name to describecontent is redundant because content describes itself.</strong></p><p>The debate surrounding semantics has raged for years, but it is important thatwe adopt a more pragmatic, sensible approach to naming things in order to workmore efficiently and effectively. Instead of focussing on 'semantics', look moreclosely at sensibility and longevity-choose names based on ease of maintenance,not for their perceived meaning.</p><p>Name things for people; they're the only things that actually <em>read</em> yourclasses (everything else merely matches them). Once again, it is better tostrive for reusable, recyclable classes rather than writing for specific usecases. Let's take an example:</p><pre><code>/** * Runs the risk of becoming out of date; not very maintainable. */.blue {    color: blue;}/** * Depends on location in order to be rendered properly. */.header span {    color: blue;}/** * Too specific; limits our ability to reuse. */.header-color {    color: blue;}/** * Nicely abstracted, very portable, doesn't risk becoming out of date. */.highlight-color {    color: blue;}</code></pre><p>It is important to strike a balance between names that do not literally describethe style that the class brings, but also ones that do not explicitly describespecific use cases. Instead of <code>.home-page-panel</code>, choose <code>.masthead</code>; insteadof <code>.site-nav</code>, favour <code>.primary-nav</code>; instead of <code>.btn-login</code>, opt for<code>.btn-primary</code>.</p><h4 id="naming-ui-components">Naming UI Components</h4><p>Naming components with agnosticism and reusability in mind really helpsdevelopers construct and modify UIs much more quickly, and with far less waste.However, it can sometimes be beneficial to provide more specific or meaningfulnaming alongside the more ambiguous class, particularly when several agnosticclasses come together to form a more complex and specific component that mightbenefit from having a more meaningful name. In this scenario, we augment theclasses with a  <code>data-ui-component</code> attribute which houses a more specific name,for example:</p><pre><code> &lt;ul class="tabbed-nav" data-ui-component="Main Nav"&gt;</code></pre><p>Here we have the benefits of a highly reusable class name which does notdescribe-and, therefore, tie itself to-a specific use case, and added meaningvia our <code>data-ui-component</code> attribute. The <code>data-ui-component</code>'s value can takeany format you wish, like title case: </p><pre><code>&lt;ul class="tabbed-nav" data-ui-component="Main Nav"&gt;</code></pre><p>Or class-like:</p><pre><code>&lt;ul class="tabbed-nav" data-ui-component="main-nav"&gt; </code></pre><p>Or namespaced:</p><pre><code>&lt;ul class="tabbed-nav" data-ui-component="nav-main"&gt;</code></pre><p>The implementation is largely personal preference, but the concept stillremains: <strong>Add any useful or specific meaning via a mechanism that will notinhibit your and your team's ability to recycle and reuse CSS.</strong></p><div class="box box--promo  box--outdent">    <p>It looks like you're enjoying these guidelines...</p>    <p><a href="https://gumroad.com/l/JAgjq" class="btn  btn--full  btn--tertiary">Support Them </a></p></div><h3 id="selector-performance">Selector Performance</h3><p>A topic which is-with the quality of today's browsers-more interesting than itis important, is selector performance. That is to say, how quickly a browser canmatch the selectors your write in CSS up with the nodes it finds in the DOM.</p><p>Generally speaking, the longer a selector is (i.e. the more component parts) theslower it is, for example:</p><pre><code>body.home div.header ul {}</code></pre><p>...is a far less efficient selector than:</p><pre><code>.primary-nav {} </code></pre><p>This is because browsers read CSS selectors <strong>right-to-left</strong>. A browser willread the first selector as</p><ul>  <li>find all <code>ul</code> elements in the DOM;</li>  <li>now check if they live anywhere inside an element with a class of <code>.header</code>;</li>  <li>next check that <code>.header</code> class exists on a <code>div</code> element;</li>  <li>now check that that all lives anywhere inside any elements with a class of<code>.home</code>;</li>  <li>finally, check that <code>.home</code> exists on a <code>body </code> element.</li></ul><p>The second, in contrast, is simply a case of the browser reading</p><ul>  <li>find all the elements with a class of <code>.primary-nav</code>.</li></ul><p>To further compound the problem, we are using descendant selectors (e.g. <code>.foo.bar {}</code>). The upshot of this is that a browser is required to start with therightmost part of the selector (i.e. <code>.bar</code>) and keep looking up the DOMindefinitely until it finds the next part (i.e. <code>.foo</code>). This could meanstepping up the DOM dozens of times until a match is found.</p><p>This is just one reason why <strong>nesting with preprocessors is often a falseeconomy</strong>; as well as making selectors unnecessarily more specific, and creatinglocation dependency, it also creates more work for the browser.</p><p>By using a child selector (e.g. <code>.foo &gt; .bar {}</code>) we can make the process muchmore efficient, because this only requires the browser to look one level higherin the DOM, and it will stop regardless of whether or not it found a match.</p><h4 id="the-key-selector">The Key Selector </h4><p>Because browsers read selectors right-to-left, the rightmost selector is oftencritical in defining a selector's performance: this is called the <i>keyselector</i>.</p><p>The following selector might appear to be highly performant at first glance. Ituses an ID which is nice and fast, and there can only ever be one on a page, sosurely this will be a nice and speedy lookup-just find that one ID and thenstyle everything inside of it:</p><pre><code>#foo * {}</code></pre><p>The problem with this selector is that the key selector (<code>*</code>) is very, <em>very</em>far reaching. What this selector actually does is find <em>every single</em> node inthe DOM (even <code>&lt;title&gt;</code>, <code>&lt;link&gt;</code>, and <code> &lt;head&gt;</code> elements; <em>everything</em>) and thenlooks to see if it lives anywhere at any level within <code>#foo</code>. This is a very,<em>very</em> expensive selector, and should most likely be avoided or rewritten.</p><p>Thankfully, by writing selectors with good <a href="#selector-intent">Selector Intent</a>,we are probably avoiding inefficient selectors by default; we are very unlikelyto have greedy key selectors if we're targeting the right things for the rightreason.</p><p>That said, however, CSS selector performance should be fairly low on your listof things to optimise; browsers are fast, and are only ever getting faster, andit is only on notable edge cases that inefficient selectors would be likely topose a problem. </p><p>As well as their own specific issues, nesting, qualifying, and poor SelectorIntent all contribute to less efficient selectors.</p><h3 id="general-rules">General Rules</h3><p>Your selectors are fundamental to writing good CSS. To very briefly sum up theabove sections:</p><ul>  <li><strong>Select what you want explicitly</strong>, rather than relying on circumstance orcoincidence. Good Selector Intent will rein in the reach and leak of yourstyles.</li>  <li><strong>Write selectors for reusability</strong>, so that you can work more efficiently andreduce waste and repetition.</li>  <li><strong>Do not nest selectors unnecessarily</strong>, because this will increasespecificity and affect where else you can use your styles.</li> <li><strong>Do not qualify selectors unnecessarily</strong>, as this will impact the number ofdifferent elements you can apply styles to.</li>  <li><strong>Keep selectors as short as possible</strong>, in order to keep specificity down andperformance up.</li></ul><p>Focussing on these points will keep your selectors a lot more sane and easy towork with on changing and long-running projects.</p><h3 id="further-reading-2">Further Reading</h3><ul>  <li><a href="http://csswizardry.com/2012/07/shoot-to-kill-css-selector-intent/"><cite>Shoot to kill; CSS selector intent</cite></a></li>  <li><a href="http://csswizardry.com/2013/05/scope-in-css/"><cite>'Scope' in CSS</cite></a></li>  <li><a href=" http://csswizardry.com/2012/05/keep-your-css-selectors-short/"><cite>Keep your CSS selectors short</cite></a></li>  <li><a href=" http://nicolasgallagher.com/about-html-semantics-front-end-architecture/"><cite>About HTML semantics and front-end architecture</cite></a></li>  <li><a href=" http://csswizardry.com/2014/03/naming-ui-components-in-oocss/"><cite>Naming UI components in OOCSS</cite></a></li>  <li><a href=" http://csswizardry.com/2011/09/writing-efficient-css-selectors/"><cite>Writing efficient CSS selectors</cite></a></li></ul><hr><h2 id="specificity">Specificity</h2><p>As we've seen, CSS isn't the most friendly of languages: globally operating,very leaky, dependent on location, hard to encapsulate, based on inheritance...But! None of that even comes close to the horrors of specificity.</p><p>No matter how well considered your naming, regardless of how perfect your sourceorder and cascade are managed, and how well you've scoped your rulesets, justone overly-specific selector can undo everything. It is a gigantic curveball,and undermines CSS' very nature of the cascade, inheritance, and source order.</p><p>The problem with specificity is that it sets precedents and trumps that cannot<em>simply</em> be undone. If we take a real example that I was responsible for someyears ago:</p><pre><code>#content table {} </code></pre><p>Not only does this exhibit poor <a href="#selector-intent">Selector Intent</a>-I didn'tactually want every <code>table</code> in the <code>#content</code> area, I wanted a specific type of<code>table</code> that just happened to live there-it is a hugely over-specific selector.This became apparent a number of weeks later, when I needed a second type of<code> table</code>:</p><pre><code>#content table {}/** * Uh oh! My styles get overwritten by `#content table {}`. */.my-new-table {}</code></pre><p>The first selector was trumping the specificity of the one defined <em>after</em> it,working against CSS' source-order based application of styles. In order toremedy this, I had two main options. I could</p><ol>  <li> refactor my CSS and HTML to remove that ID;</li>  <li>write a more specific selector to override it.</li></ol><p>Unfortunately, refactoring would have taken a long time; it was a mature productand the knock-on effects of removing this ID would have been a more substantialbusiness cost than the second option: just write a more specific selector.</p><pre><code>#content table {}#content .my-new-table {}</code></pre><p>Now I have a selector that is <em>even more specific still!</em> And if I ever want tooverride this one, I will need another selector of at least the same specificitydefined after it. I've started on a downward spiral.</p><p>Specificity can, among other things,</p><ul>  <li>limit your ability to extend and manipulate a codebase;</li>  <li>interrupt and undo CSS' cascading, inheriting nature;</li>  <li>cause avoidable verbosity in your project;</li>  <li>prevent things from working as expected when moved into differentenvironments;</li>  <li>lead to serious developer frustration.</li></ul><p>All of these issues are greatly magnified when working on a larger project witha number of developers contributing code.</p><h3 id="keep-it-low-at-all-times">Keep It Low at All Times</h3><p>The problem with specificity isn't necessarily that it's high or low; it's thefact it is so variant and that it cannot be opted out of: the only way to dealwith it is to get progressively more specific-the notorious <i>specificitywars</i> we looked at above.</p><p>One of the single, simplest tips for an easier life when writingCSS-particularly at any reasonable scale-is to keep always try and keepspecificity as low as possible at all times. Try to make sure there isn't a lotof variance between selectors in your codebase, and that all selectors strivefor as low a specificity as possible.</p><p>Doing so will instantly help you tame and manage your project, meaning that nooverly-specific selectors are likely to impact or affect anything of a lowerspecificity elsewhere. It also means you're less likely to need to fight yourway out of specificity corners, and you'll probably also be writing much smallerstylesheets.</p><p>Simple changes to the way we work include, but are not limited to,</p><ul>  <li>not using IDs in your CSS;</li>  <li>not nesting selectors;</li>  <li>not qualifying classes;</li>  <li>not chaining selectors.</li></ul><p><strong>Specificity can be wrangled and understood, but it is safer just to avoid itentirely.</strong></p><h3 id="ids-in-css">IDs in CSS</h3><p>If we want to keep specificity low, which we do, we have one really quick-win,simple, easy-to-follow rule that we can employ to help us: avoid using IDs in CSS.</p><p>Not only are IDs inherently non-reusable, they are also vastly more specificthan any other selector, and therefore become specificity anomalies. Where therest of your selectors are relatively low specificity, your ID-based selectorsare, comparatively, much, <em>much</em> higher.</p><p>In fact, to highlight the severity of this difference, see how <em>one thousand</em>chained classes cannot override the specificity of a single ID:<a href=" http://jsfiddle.net/csswizardry/0yb7rque/">jsfiddle.net/0yb7rque</a>.<small>(Please note that in Firefox you may see the text rendering in blue: thisis a <a href=" https://twitter.com/codepo8/status/505004085398224896">known bug</a>, and anID will be overridden by 256 chained classes.)</small></p><p><small><strong>N.B.</strong> It is still perfectly okay to use IDs in HTML and JavaScript; itis only in CSS that they prove troublesome.</small></p><p>It is often suggested that developers who choose not to use IDs in CSS merely<q>don't understand how specificity works</q>. This is as incorrect as it isoffensive: no matter how experienced a developer you are, this behaviour cannotbe circumvented; no amount of knowledge will make an ID less specific.</p><p>Opting into this way of working only introduces the chance of problems occurringfurther down the line, and-particularly when working at scale-all efforts shouldbe made to <em>avoid</em> the potential for problems to arise. In a sentence:</p><p><strong>It is just not worth introducing the risk.</strong></p><h3 id="nesting">Nesting </h3><p>We've already looked at how nesting can lead to location dependent andpotentially inefficient code, but now it's time to take a look at another of itspitfalls: it makes selectors more specific.</p><p>When we talk about nesting, we don't necessarily mean preprocessor nesting, likeso:</p><pre><code>.foo {    .bar {}}</code></pre><p>We're actually talking about <em> descendant</em> or <em>child</em> selectors; selectors whichrely on a thing within a thing. That could look like any one of the following:</p><pre><code>/** * An element with a class of `.bar` anywhere inside an element with a class of * `.foo`. */.foo .bar {}/** * An element with a class of `.module-title` directly inside an element with a * class of `.module`. */.module &gt; .module-title {}/** * Any `li` element anywhere inside a `ul` element anywhere inside a `nav` * element */nav ul li {}</code></pre><p>Whether you arrive at this CSS via a preprocessor or not isn't particularlyimportant, but it is worth noting that <strong>preprocessors tout this as a feature,where is actually to be avoided wherever possible</strong>.</p><p> Generally speaking, each part in a compound selector adds specificity. Ergo, thefewer parts to a compound selector then the lower its overall specificity, andwe always want to keep specificity low. To quote Jonathan Snook:</p><blockquote>  <p>...whenever declaring your styles, <strong>use the least number of selectors requiredto style an element. </strong></p></blockquote><p>Let's look at an example:</p><pre><code>.widget {    padding: 10px;}    .widget &gt; .widget__title {        color: red;    }</code></pre><p>To style an element with a class of <code>.widget__title</code>, we have a selector that istwice as specific as it needs to be. That means that if we want to make anymodifications to <code> .widget__title</code>, we'll need another at-least-equally specificselector:</p><pre><code>.widget { ... }    .widget &gt; .widget__title { ... }    .widget &gt; .widget__title--sub {        color: blue;    }</code></pre><p>Not only is this entirely avoidable-we caused this problem ourselves-we have aselector that is literally double the specificity it needs to be. We used 200%of the specificity actually required. And not only <em>that</em>, but this also leadsto needless verbosity in our code-more to send over the wire.</p><p>As a rule, <strong>if a selector will work without it being nested then do not nestit</strong>.</p><h4 id="scope">Scope</h4><p>One possible advantage of nesting-which, unfortunately, does not outweigh thedisadvantages of increased specificity-is that it provides us with a namespaceof sorts. A selector like <code>.widget .title</code> scopes the styling of <code>.title</code> toan element that only exists inside of an element carrying a class of <code>.widget</code>.</p><p>This goes some way to providing our CSS with scope and encapsulation, but doesstill mean that our selectors are twice as specific as they need to be. A betterway of providing this scope would be via a namespace-which we already have inthe form of <a href="#bem-like-naming"> BEM-like Naming</a>-which does not lead to anunnecessary increase in specificity.</p><p>Now we have better scoped CSS with minimal specificity-the best of both worlds.</p><h5 id= "further-reading-3">Further Reading</h5><ul>  <li><a href="http://csswizardry.com/2013/05/scope-in-css/"><cite>'Scope' in CSS</cite></a></li></ul><h3 id="important"><code>!important </code></h3><p>The word <code>!important</code> sends shivers down the spines of almost all front-enddevelopers. <code>!important</code> is a direct manifestation of problems with specificity;it is a way of cheating your way out of specificity wars, but usually comes at aheavy price. It is often viewed as a last resort-a desperate, defeated stab atpatching over the symptoms of a much bigger problem with your code.</p><p>The general rule is that <code>!important</code> is always a bad thing, but, to quote JamieMason:</p><blockquote>  <p>Rules are the children of principles.</p></blockquote><p>That is to say, a single rule is a simple, black-and-white way of adhering to amuch larger principle. When you're starting out, the rule <q> never use<code>!important</code></q> is a good one.</p><p>However, once you begin to grow and mature as a developer, you begin tounderstand that the principle behind that rule is simply about keepingspecificity low. You'll also learn when and where the rules can be bent...</p><p><code>!important</code> does have a place in CSS projects, but only if used sparingly andproactively.</p><p>Proactive use of <code>!important</code> is when it is used <em>before</em> you've encountered anyspecificity problems; when it is used as a guarantee rather than as a fix. Forexample:</p><pre><code>.one-half {    width: 50% !important;}.hidden {    display: none !important;}</code></pre><p>These two helper, or <i>utility</i>, classes are very specific in theirintentions: you would only use them if you wanted something to be rendered at50% width or not rendered at all. If you didn't want this behaviour, you wouldnot use these classes, therefore whenever you do use them you will definitelywant them to win.</p><p>Here we proactively apply <code>!important</code> to ensure that these styles always win.This is correct use of <code>!important</code> to guarantee that these trumps always work,and don't accidentally get overridden by something else more specific.</p><p>Incorrect, <i>reactive</i> use of <code>!important</code> is when it is used to combatspecificity problems after the fact: applying <code>!important</code> to declarationsbecause of poorly architected CSS. For example, let's imagine we have this HTML:</p><pre><code>&lt;div class="content"&gt;    &lt;h2 class="heading-sub"&gt;...&lt;/h2&gt;&lt;/div&gt;</code></pre><p>...and this CSS: </p><pre><code>.content h2 {    font-size: 2em;}.heading-sub {    font-size: 1.5em !important;}</code></pre><p>Here we can see how we've used <code>!important</code> to force our <code> .heading-sub {}</code>styles to reactively override our <code>.content h2 {}</code> selector. This could havebeen circumvented by any number of things, including using better SelectorIntent, or avoiding nesting.</p><p>In these situations, it is preferable that you investigate and refactor anyoffending rulesets to try and bring specificity down across the board, asopposed to introducing such specificity heavyweights.</p><p><strong>Only use <code>!important</code> proactively, not reactively.</strong></p><h3 id="hacking-specificity">Hacking Specificity</h3><p>With all that said on the topic of specificity, and keeping it low, it isinevitable that we will encounter problems. No matter how hard we try, and howconscientious we are, there will always be times that we need to hack andwrangle specificity.</p><p>When these situations do arise, it is important that we handle the hacks assafely and elegantly as possible.</p><p>In the event that you need to increase the specificity of a class selector,there are a number of options. We could nest the class inside something else tobring its specificity up. For example, we could use <code>.header .site-nav {}</code> tobring up the specificity of a simple <code>.site-nav {}</code> selector.</p><p>The problem with this, as we've discussed, is that it introduces locationdependency: these styles will only work when the <code>.site-nav</code> component is in the<code>.header</code> component.</p><p>Instead, we can use a much safer hack that will not impact this component'sportability: we can chain that class with itself:</p><pre><code>.site-nav.site-nav {}</code></pre><p>This chaining doubles the specificity of the selector, but does not introduceany dependency on location.</p><p>In the event that we do, for whatever reason, have an ID in our markup that wecannot replace with a class, select it via an attribute selector as opposed toan ID selector. For example, let's imagine we have embedded a third-party widgeton our page. We can style the widget via the markup that it outputs, but we haveno ability to edit that markup ourselves:</p><pre><code>&lt;div id="third-party-widget"&gt;    ...&lt;/div&gt;</code></pre><p>Even though we know not to use IDs in CSS, what other option do we have? We wantto style this HTML but have no access to it, and all it has on it is an ID.</p><p>We do this:</p><pre><code>[id="third-party-widget"] {}</code></pre><p>Here we are selecting based on an attribute rather than an ID, and attributeselectors have the same specificity as a class. This allows us to style based onan ID, but without introducing its specificity.</p><p>Do keep in mind that these <em>are</em> hacks, and should not be used unless you haveno better alternative.</p><h4 id="further-reading-4"> Further Reading</h4><ul>  <li><a href="http://csswizardry.com/2014/07/hacks-for-dealing-with-specificity/"><cite>Hacks for dealing with specificity</cite></a></li></ul><hr><h2 id= "architectural-principles">Architectural Principles</h2><p>You would be forgiven for thinking that an architecture for CSS is a somewhatgrandiose and unnecessary concept: why would something so simple, so<em>straightforward</em>, need something as complex or considered as an architecture?!</p><p>Well, as we've seen, CSS' simplicity, its looseness, and its unruly nature meanthat the best way of managing (read, taming) it at any reasonable scale isthrough a strict and specific architecture. A solid architecture can help uscontrol our specificity, enforce naming conventions, manage our source order,create a sane development environment, and generally make managing our CSSprojects a lot more consistent and comfortable.</p><p>There is no tool, no preprocessor, no magic bullet, that will make your CSSbetter on its own: a developer's best tool when working with such a loose syntaxis self-discipline, conscientiousness, and diligence, and a well-definedarchitecture will help enforce and facilitate these traits.</p><p>Architectures are large, overarching, principle-led collections of smallerconventions which come together to provide a managed environment in which codeis written and maintained. Architectures are typically quite high level, andleave implementation details-such as naming conventions or syntax andformatting, for example-to the team implementing it.</p><p>Most architectures are usually based around existing design patterns andparadigms, and, more often than not, these paradigms were born of computerscientists and software engineers. For all CSS isn't 'code', and doesn't exhibitmany traits that programming languages do, we find that we can apply some ofthese same principles to our own work.</p><p>In this section, we'll take a look at some of these design patterns andparadigms, and how we can use them to reduce code-and increase code reuse-in ourCSS projects.</p><h3 id="high-level-overview">High-level Overview</h3><p>At a very high-level, your architecture should help you</p><ul>  <li>provide a consistent and sane environment;</li>  <li>accommodate change;</li>  <li>grow and scale your codebase;</li>  <li>promote reuse and efficiency;</li>  <li>increase productivity.</li></ul><p> Typically, this will mean a class-based and componentised architecture, split upinto manageable modules, probably using a preprocessor. Of course, there is farmore to an architecture than that, so let's look at some principles...</p><h3 id="object-orientation">Object-orientation</h3><p><i>Object-orientation</i> is a programming paradigm that breaks larger programsup into smaller, in(ter)dependent objects that all have their own roles andresponsibilities. From Wikipedia:</p><blockquote>  <p>Object-oriented programming (OOP) is a programming paradigm that representsthe concept of 'objects' [...] which are usually instances of classes, [and] areused to interact with one another to design applications and computerprograms.</p></blockquote><p> When applied to CSS, we call it object-oriented CSS, or <i>OOCSS</i>. OOCSS wascoined and popularised by Nicole Sullivan, whose <cite>Media Object</cite> hasbecome the poster child of the methodology.</p><p>OOCSS deals with the separation of UIs into <i>structure</i> and <i>skin</i>:breaking UI components into their underlying structural forms, and layeringtheir cosmetic forms on separately. This means that we can recycle common andrecurring design <em>patterns</em> very cheaply without having to necessarily recycletheir specific implementation details at the same time. OOCSS promotes reuse ofcode, which makes us quicker, as well as keeping the size of our codebase down.</p><p>Structural aspects can be thought of like skeletons; common, recurring framesthat provide design-free constructs known as <i>objects</i> and<i>abstractions</i>. Objects and abstractions are simple design patterns thatare devoid of any cosmetics; we abstract out the shared structural traits from aseries of components into a generic object.</p><p>Skin is a layer that we (optionally) add to our structure in order to giveobjects and abstractions a specific look-and-feel. Let's look at an example:</p><pre><code>/** * A simple, design-free button object. Extend this object with a `.btn--*` skin * class. */.btn { display: inline-block;    padding: 1em 2em;    vertical-align: middle;}/** * Positive buttons' skin. Extends `.btn`. */.btn--positive {    background-color: green;    color: white;}/** * Negative buttons' skin. Extends `.btn`. */.btn--negative {    background-color: red;    color: white;}</code></pre><p>Above, we can see how the <code>.btn {}</code> class simply provides structural styling toan element, and doesn't concern itself with any cosmetics. We supplement the<code>.btn {}</code> object with a second class, such as <code>.btn--negative {}</code> in order togive that DOM node specific cosmetics:</p><pre><code>&lt;button class="btn  btn--negative"&gt;Delete&lt;/button&gt;</code></pre><p>Favour the multiple-class approach over using something like <code>@extend</code>: usingmultiple classes in your markup-as opposed to wrapping the classes up into oneusing a preprocessor-</p><ul>  <li>gives you a better paper-trail in your markup, and allows you to see quicklyand explicitly which classes are acting on a piece of HTML;</li>  <li>allows for greater composition in that classes are not tightly bound to otherstyles in your CSS.</li></ul><p>Whenever you are building a UI component, try and see if you can break it intotwo parts: one for structural styles (paddings, layout, etc.) and another forskin (colours, typefaces, etc.).</p><h4 id="further-reading-5">Further Reading</h4><ul>  <li><a href=" http://www.stubbornella.org/content/2010/06/25/the-media-object-saves-hundreds-of-lines-of-code/">The media object saves hundreds of lines of code</a></li>  <li><a href=" http://csswizardry.com/2013/05/the-flag-object/">The flag object</a></li>  <li><a href="http://csswizardry.com/2014/03/naming-ui-components-in-oocss/">Naming UI components in OOCSS </a></li></ul><h3 id="the-single-responsibility-principle">The Single Responsibility Principle</h3><p>The <i>single responsibility principle</i> is a paradigm that, very loosely,states that all pieces of code (in our case, classes) should focus on doing onething and one thing only. More formally:</p><blockquote>  <p>...the single responsibility principle states that every context (class,function, variable, etc.) should have a single responsibility, and thatresponsibility should be entirely encapsulated by the context.</p></blockquote><p>What this means for us is that our CSS should be composed of a series of muchsmaller classes that focus on providing very specific and limited functionality.This means that we need to decompose UIs into their smallest component piecesthat each serve a single responsibility; they all do just one job, but can bevery easily combined and composed to make much more versatile and complexconstructs. Let's take some example CSS that does not adhere to the singleresponsibility principle:</p><pre><code>.error-message {    display: block;    padding: 10px; border-top: 1px solid #f00;    border-bottom: 1px solid #f00;    background-color: #fee;    color: #f00;    font-weight: bold;}.success-message {    display: block;    padding: 10px; border-top: 1px solid #0f0;    border-bottom: 1px solid #0f0;    background-color: #efe;    color: #0f0;    font-weight: bold;}</code></pre><p>Here we can see that-despite being named after one very specific use-case-theseclasses are handling quite a lot: layout, structure, and cosmetics. We also havea <em>lot</em> of repetition. We need to refactor this in order to abstract out someshared objects (OOCSS) and bring it more inline with the single responsibilityprinciple. We can break these two classes out into four much smallerresponsibilities: </p><pre><code>.box {    display: block;    padding: 10px;}.message {    border-style: solid;    border-width: 1px 0;    font-weight: bold;}.message--error {    background-color: #fee; color: #f00;}.message--success {    background-color: #efe;    color: #0f0;}</code></pre><p>Now we have a general abstraction for boxes which can live, and be used,completely separately from our message component, and we have a base messagecomponent that can be extended by a number of smaller responsibility classes.The amount of repetition has been greatly reduced, and our ability to extend andcompose our CSS has been greatly increased. This is a great example of OOCSS andthe single responsibility principle working in tandem.</p><p>By focussing on single responsibilities, we can give our code much moreflexibility, and extending components' functions becomes very simple whensticking to the <i>open/closed principle</i>, which we're going to look at next.</p><h4 id="further-reading-6">Further Reading</h4><ul>  <li><a href="http://csswizardry.com/2012/04/the-single-responsibility-principle-applied-to-css/">The single responsibility principle applied to CSS</a></li></ul><h3 id="the-openclosed-principle">The Open/Closed Principle</h3><p>The <i>open/closed principle</i>, in my opinion, is rather poorly named. It ispoorly named because 50% of the vital information is omitted from its title. Theopen/closed principle states that</p><blockquote>  <p>[s]oftware entities (classes, modules, functions, etc.) should be open forextension, but closed for modification.</p></blockquote><p>See? The most important words-<i>extension</i> and <i>modification</i>-arecompletely missing from the name, which isn't very useful at all.</p><p>Once you have trained yourself to remember what the words open and closedactually relate to, you'll find that open/closed principle remarkably simple:any additions, new functionality, or features we add to our classes should beadded via <em>extension</em>-we should not modify these classes directly. This reallytrains us to write bulletproof single responsibilities: because we shouldn'tmodify objects and abstractions directly, we need to make sure we get them assimple as possible the first time. This means that we should never need toactually change an abstraction-we'd simply stop using it-but any slight variantsof it can be made very easily by extending it.</p><p>Let's take an example:</p><pre><code>.box {    display: block;    padding: 10px;}.box--large {    padding: 20px;}</code></pre><p>Here we can see that the <code>.box {}</code> object is incredibly simple: we've strippedit right back into one very small and very focussed responsibility. To modifythat box, we extend it with another class; <code>.box--large {}</code>. Here the <code> .box {}</code>class is closed to modification, but open to being extended.</p><p>An incorrect way of achieving the same might look like this:</p><pre><code>.box {    display: block; padding: 10px;}.content .box {    padding: 20px;}</code></pre><p>Not only is this overly specific, locationally dependent, and potentiallydisplaying poor Selector Intent, we are modifying the <code>.box {}</code> directly. Weshould rarely-if ever-find an object or abstraction's class as a key selector ina compound selector.</p><p>A selector like <code>.content .box {} </code> is potentially troublesome because</p><ul>  <li>it forces all <code>.box</code> components into that style when placed inside of<code>.content</code>, which means the modification is dictated to developers, whereasdevelopers should be allowed to opt into changes explicitly;</li>  <li>the <code>.box</code> style is now unpredictable to developers; the single responsibilityno longer exists because nesting the selector produces a forced caveat.</li></ul><p>All modifications, additions, and changes should always be opt-in, notmandatory. If you think something might need a slight adjustment to take it awayfrom the norm, provide another class which adds this functionality.</p><p>When working in a team environment, be sure to write API-like CSS; always ensurethat existing classes remain backward compatible (i.e. no changes at their root)and provide new hooks to bring in new features. Changing the root object,abstraction, or component could have huge knock-on effects for developers makinguse of that code elsewhere, so never modify existing code directly.</p><p>Exceptions may present themselves when it transpires that a root object doesneed a rewrite or refactor, but it is only in these specific cases that youshould modify code. Remember: <strong>open for extension; closed for modification</strong>.</p><h4 id="further-reading-7">Further Reading</h4><ul>  <li><a href="http://csswizardry.com/2012/06/the-open-closed-principle-applied-to-css/">The open/closed principle applied to CSS</a></li></ul><h3 id="dry">DRY</h3><p><i>DRY</i>, which stands for <i>Don't Repeat Repeat Yourself</i>, is amicro-principle used in software development which aims to keep the repetitionof key information to a minimum. Its formal definition is that</p><blockquote>  <p>[e]very piece of knowledge must have a single, unambiguous, authoritativerepresentation within a system.</p></blockquote><p>Although a very simple principle-in principle-DRY is often misinterpreted as thenecessity to never repeat the exact same thing twice at all in a project. Thisis impractical and usually counterproductive, and can lead to forcedabstractions, over-thought and -engineered code, and unusual dependencies.</p><p> The key isn't to avoid all repetition, but to normalise and abstract<em>meaningful</em> repetition. If two things happen to share the same declarationscoincidentally, then we needn't DRY anything out; that repetition is purelycircumstantial and cannot be shared or abstracted. For example:</p><pre><code>.btn {    display: inline-block;    padding: 1em 2em;    font-weight: bold;}[...].page-title {    font-size: 3rem;    line-height: 1.4;    font-weight: bold;}[...]    .user-profile__title {        font-size: 1.2rem;        line-height: 1.5; font-weight: bold;    }</code></pre><p>From the above code, we can reasonably deduce that the <code>font-weight: bold;</code>declaration appears three times purely coincidentally. To try and create anabstraction, mixin, or <code>@extend</code> directive to cater for this repetition wouldbe overkill, and would tie these three rulesets together based purely oncircumstance. </p><p>However, imagine we're using a web-font that requires <code>font-weight: bold;</code> to bedeclared every time the <code>font-family</code> is:</p><pre><code>.btn {    display: inline-block;    padding: 1em 2em;    font-family: "My Web Font", sans-serif;    font-weight: bold;}[...].page-title {    font-size: 3rem;    line-height: 1.4;    font-family: "My Web Font", sans-serif;    font-weight: bold;}[...]    .user-profile__title {        font-size: 1.2rem;        line-height: 1.5;        font-family: "My Web Font", sans-serif; font-weight: bold;    }</code></pre><p>Here we're repeating a more meaningful snippet of CSS; these two declarationshave to always be declared together. In this instance, we probably would DRYout our CSS.</p><p>I would recommend using a mixin over <code>@extend</code> here because, even though the twodeclarations are thematically grouped, the rulesets themselves are stillseparate, unrelated entities: to use <code>@extend</code> would be to physically groupthese unrelated rulesets together in our CSS, thus making the unrelated related.</p><p>Our mixin: </p><pre><code>@mixin my-web-font() {    font-family: "My Web Font", sans-serif;    font-weight: bold;}.btn {    display: inline-block;    padding: 1em 2em;    @include my-web-font();}[...].page-title {    font-size: 3rem;    line-height: 1.4;    @include my-web-font();}[...]    .user-profile__title {        font-size: 1.2rem;        line-height: 1.5;        @include my-web-font();    }</code></pre><p>Now the two declarations only exist once, meaning we're not repeating ourselves.If we ever switch out our web-font, or move to a <code>font-weight: normal;</code>version, we only need to make that change in one place.</p><p>In short, only DRY code that is actually, thematically related. Do not try toreduce purely coincidental repetition: <strong>duplication is better than the wrongabstraction</strong>.</p><h4 id="further-reading-8">Further Reading</h4><ul>  <li><a href=" http://csswizardry.com/2013/07/writing-dryer-vanilla-css/">Writing DRYer vanilla CSS</a></li></ul><h3 id="composition-over-inheritance">Composition over Inheritance</h3><p>Now that we're used to spotting abstractions and creating singleresponsibilities, we should be in a great position to start composing morecomplex composites from a series of much smaller component parts. NicoleSullivan likens this to using Lego; tiny, single responsibility pieces which canbe combined in a number of different quantities and permutations to create amultitude of very different looking results.</p><p>This idea of building through composition is not a new one, and is oftenreferred to as <i>composition over inheritance</i>. This principle suggests thatlarger systems should be composed from much smaller, individual parts, ratherthan inheriting behaviour from a much larger, monolithic object. This shouldkeep your code decoupled-nothing inherently relies on anything else.</p><p>Composition is a very valuable principle for an architecture to make use of,particularly considering the move toward component-based UIs. It will mean youcan more easily recycle and reuse functionality, as well rapidly constructlarger parts of UI from a known set of composable objects. Think back to ourerror message example in the <a href="#the-single-responsibility-principle">Single ResponsibilityPrinciple</a> section; we created a completeUI component by composing a number of much smaller and unrelated objects.</p><h3 id="the-separation-of-concerns">The Separation of Concerns</h3><p>The <i>separation of concerns</i> is a principle which, at first, sounds a lotlike the single responsibility principle. The separation of concerns states thatcode should be broken up</p><blockquote>  <p>into distinct sections, such that each section addresses a separate concern. Aconcern is a set of information that affects the code of a computer program.[...] A program that embodies SoC well is called a modular program.</p></blockquote><p>Modular is a word we're probably used to; the idea of breaking UIs and CSS intomuch smaller, composable pieces. The separation of concerns is just a formaldefinition which covers the concepts of modularity and encapsulation in code. InCSS this means building individual components, and writing code which onlyfocusses itself on one task at a time.</p><p>The term was coined by Edsger W. Dijkstra, who rather elegantly said:</p><blockquote>  <p>Let me try to explain to you, what to my taste is characteristic for allintelligent thinking. It is, that one is willing to study in depth an aspectof one's subject matter in isolation for the sake of its own consistency, allthe time knowing that one is occupying oneself only with one of the aspects.We know that a program must be correct and we can study it from that viewpointonly; we also know that it should be efficient and we can study its efficiencyon another day, so to speak. In another mood we may ask ourselves whether, andif so: why, the program is desirable. But nothing is gained-on thecontrary!-by tackling these various aspects simultaneously. It is what Isometimes have called 'the separation of concerns', which, even if notperfectly possible, is yet the only available technique for effective orderingof one's thoughts, that I know of. This is what I mean by 'focusing one'sattention upon some aspect': it does not mean ignoring the other aspects, itis just doing justice to the fact that from this aspect's point of view, theother is irrelevant. It is being one- and multiple-track mindedsimultaneously.</p></blockquote><p>Beautiful. The idea here is to focus fully on one thing at once; build one thingto do its job very well whilst paying as little attention as possible to otherfacets of your code. Once you have addressed and built all these separateconcerns in isolation-meaning they're probably very modular, decoupled, andencapsulated-you can begin bringing them together into a larger project.</p><p>A great example is layout. If you are using a grid system, all of the codepertaining to layout should exist on its own, without including anything else.You've written code that handles layout, and that's it:</p><pre><code>&lt;div class="layout"&gt;    &lt;div class="layout__item  two-thirds"&gt;    &lt;/div&gt;    &lt;div class="layout__item  one-third"&gt;    &lt;/div&gt;&lt;/div&gt;</code></pre><p>You will now need to write new, separate code to handle what lives inside ofthat layout:</p><pre><code>&lt;div class="layout"&gt;    &lt;div class="layout__item  two-thirds"&gt;        &lt;section class="content"&gt; ...        &lt;/section&gt;    &lt;/div&gt;    &lt;div class="layout__item  one-third"&gt;        &lt;section class="sub-content"&gt;            ...        &lt;/section&gt;    &lt;/div &gt;&lt;/div&gt;</code></pre><p>The separation of concerns allows you to keep code self-sufficient, ignorant,and ultimately a lot more maintainable. Code which adheres to the separation ofconcerns can be much more confidently modified, edited, extended, and maintainedbecause we know how far its responsibilities reach. We know that modifyinglayout, for example, will only ever modify layout-nothing else.</p><p>The separation of concerns increases reusability and confidence whilst reducingdependency.</p><h4 id="misconceptions">Misconceptions</h4><p>There are, I feel, a number of unfortunate misconceptions surrounding theseparation of concerns when applied to HTML and CSS. They all seem to revolvearound some format of:</p><blockquote>  <p> Using classes for CSS in your markup breaks the separation of concerns.</p></blockquote><p>Unfortunately, this is simply not true. The separation of concerns <em>does</em> existin the context of HTML and CSS (and JS), but not in the way a lot of people seemto believe.</p><p>The separation of concerns when applied to front-end code is not aboutclasses-in-HTML-purely-for-styling-hooks-blurring-the-lines-between-concerns;it is about the very fact that we are using different languages for markup andstyling at all.</p><p>Back before CSS was widely adopted, we'd use <code>table</code>s to lay content out, and<code>font</code> elements with <code>color</code> attributes to provide cosmetic styling. The problemhere is that HTML was being used to create content and also to style it; therewas no way of having one without the other. This was a complete lack ofseparation of concerns, which was a problem. CSS' job was to provide acompletely new syntax to apply this styling, allowing us to separate ourcontent and style concerns across two technologies.</p><p>Another common argument is that <q>putting classes in your HTML puts styleinformation in your markup</q>.</p><p>So, in a bid to circumvent this, people adopt selectors that might look a littlelike this: </p><pre><code>body &gt; header:first-of-type &gt; nav &gt; ul &gt; li &gt; a {}</code></pre><p>This CSS-presumably to style our site's main nav-has the usual problems oflocation dependency, poor Selector Intent, and high specificity, but it alsomanages to do <em>exactly what developers are trying to avoid</em>, only in theopposite direction: <strong>it puts DOM information in your CSS</strong>. Aggressive attemptsto avoid putting any style hints or hooks in markup only lead to overloadingstylesheets with DOM information.</p><p>In short: having classes in your markup does not violate the separation ofconcerns. Classes merely act as an API to link two separate concerns together.The simplest way to separate concerns is to write well formed HTML and wellformed CSS, and link to two together with sensible, judicious use of classes.</p><div class="box  box--promo  box--outdent">    <p>Something you need some more help with?</p>    <p><a href="http://csswizardry.com/work/" class="btn  btn--full  btn--tertiary">Hire me</a></p></div>    <footer class="page-foot">        <hr class="hr-minor">        <p class="version">2.2.4</p>        <p>Last updated: <time datetime="2015-06-25">25 June, 2015</time></p>        <p>© 2014 <a href="https://twitter.com/csswizardry">Harry Roberts</a></p> </footer></div>			</div>		<!--=========================			END : POST		=============================-->		<!--=========================			START : POST		=============================-->		<div class="post-wrapper">		<h1><a href="/JavaScript-Module-Pattern-In-Depth.html">JavaScript Module Pattern: In-Depth</a></h1> <div id="blogbody" class="span-17 last entry">    <p>The module pattern is a common JavaScript coding pattern. It's generally well understood, but there are a number of advanced uses that have not gotten a lot of attention. In this article, I'll review the basics and cover some truly remarkable advanced topics, including one which I think is original.</p><h2 id="the_basics" >The Basics</h2><p>We'll start out with a simple overview of the module pattern, which has been well-known since Eric Miraglia (of YUI) first <a href=" http://yuiblog.com/blog/2007/06/12/module-pattern/">blogged about it</a> three years ago. If you're already familiar with the module pattern, feel free to skip ahead to "Advanced Patterns".</p><h3 id="anonymous_closures">Anonymous Closures</h3><p>This is the fundamental construct that makes it all possible, and really is the single <strong>best feature of JavaScript</strong>. We'll simply create an anonymous function, and execute it immediately. All of the code that runs inside the function lives in a <strong>closure</strong>, which provides <strong>privacy</strong> and <strong>state</strong> throughout the lifetime of our application.</p><pre><code>(function () {	// ... all vars and functions are in this scope only	// still maintains access to all globals}());</code></pre><p>Notice the <code>()</code> around the anonymous function. This is required by the language, since statements that begin with the token <code>function</code> are always considered to be <strong>function declarations</strong>. Including <code>()</code> creates a <strong>function expression</strong> instead.</p><h3 id="global_import">Global Import</h3><p>JavaScript has a feature known as <strong>implied globals</strong>. Whenever a name is used, the interpreter walks the scope chain backwards looking for a <code>var</code> statement for that name. If none is found, that variable is assumed to be global. If it's used in an assignment, the global is created if it doesn't already exist. This means that using or creating global variables in an anonymous closure is easy. Unfortunately, this leads to hard-to-manage code, as it's not obvious (to humans) which variables are global in a given file.</p><p>Luckily, our anonymous function provides an easy alternative. By passing globals as parameters to our anonymous function, we <strong>import</strong> them into our code, which is both <strong>clearer</strong> and <strong>faster</strong> than implied globals. Here's an example:</p><pre><code>(function ($, YAHOO) {	// now have access to globals jQuery (as $) and YAHOO in this code}(jQuery, YAHOO));</code></pre><h3 id="module_export">Module Export</h3><p>Sometimes you don't just want to <em>use </em> globals, but you want to <em>declare</em> them. We can easily do this by exporting them, using the anonymous function's <strong>return value</strong>. Doing so will complete the basic module pattern, so here's a complete example:</p><pre><code>var MODULE = (function () {	var my = {},		privateVariable = 1;	function privateMethod() {		// ...	} my.moduleProperty = 1;	my.moduleMethod = function () {		// ...	};	return my;}());</code></pre><p>Notice that we've declared a global module named <code>MODULE</code>, with two public properties: a method named <code>MODULE.moduleMethod</code> and a variable named <code>MODULE.moduleProperty</code>. In addition, it maintains <strong>private internal state </strong> using the closure of the anonymous function. Also, we can easily import needed globals, using the pattern we learned above.</p><h2 id="advanced_patterns">Advanced Patterns </h2><p>While the above is enough for many uses, we can take this pattern farther and create some very powerful, extensible constructs. Lets work through them one-by-one, continuing with our module named <code>MODULE</code>.</p><h3 id="augmentation">Augmentation</h3><p>One limitation of the module pattern so far is that the entire module must be in one file. Anyone who has worked in a large code-base understands the value of splitting among multiple files. Luckily, we have a nice solution to <strong>augment modules</strong>. First, we import the module, then we add properties, then we export it. Here's an example, augmenting our <code>MODULE</code> from above:</p><pre><code>var MODULE = (function (my) {	my.anotherMethod = function () {		// added method...	};	return my;}(MODULE));</code></pre><p>We use the <code>var</code> keyword again for consistency, even though it's not necessary. After this code has run, our module will have gained a new public method named <code>MODULE.anotherMethod</code>. This augmentation file will also maintain its own private internal state and imports.</p><h3 id= "loose_augmentation">Loose Augmentation</h3><p>While our example above requires our initial module creation to be first, and the augmentation to happen second, that isn't always necessary. One of the best things a JavaScript application can do for performance is to load scripts asynchronously. We can create flexible multi-part modules that can load themselves in any order with <strong>loose augmentation</strong>. Each file should have the following structure:</p><pre><code>var MODULE = (function (my) {	// add capabilities...	return my;}(MODULE || {}));</code></pre><p>In this pattern, the <code>var</code> statement is always necessary. Note that the import will create the module if it does not already exist. This means you can use a tool like <a href="http://labjs.com/">LABjs</a> and load all of your module files in parallel, without needing to block.</p><h3 id="tight_augmentation">Tight Augmentation</h3><p> While loose augmentation is great, it does place some limitations on your module. Most importantly, you cannot override module properties safely. You also cannot use module properties from other files during initialization (but you can at run-time after intialization). <strong>Tight augmentation</strong> implies a set loading order, but allows <strong>overrides</strong> . Here is a simple example (augmenting our original <code>MODULE</code>):</p><pre><code>var MODULE = (function (my) {	var old_moduleMethod = my.moduleMethod;	my.moduleMethod = function () {		// method override, has access to old through old_moduleMethod...	};	return my;}(MODULE));</code></pre><p>Here we've overridden <code>MODULE.moduleMethod</code>, but maintain a reference to the original method, if needed.</p><h3 id="cloning_and_inheritance">Cloning and Inheritance</h3><pre><code>var MODULE_TWO = (function (old) {	var my = {},		key; for (key in old) {		if (old.hasOwnProperty(key)) {			my[key] = old[key];		}	}	var super_moduleMethod = old.moduleMethod;	my.moduleMethod = function () {		// override method on the clone, access to super through super_moduleMethod	};	return my;}(MODULE));</code></pre><p>This pattern is perhaps the <strong>least flexible</strong> option. It does allow some neat compositions, but that comes at the expense of flexibility. As I've written it, properties which are objects or functions will <em>not</em> be duplicated, they will exist as one object with two references. Changing one will change the other. This could be fixed for objects with a recursive cloning process, but probably cannot be fixed for functions, except perhaps with <code>eval</code>. Nevertheless, I've included it for completeness.</p><h3 id="crossfile_private_state">Cross-File Private State</h3><p>One severe limitation of splitting a module across multiple files is that each file maintains its own private state, and does not get access to the private state of the other files. This can be fixed. Here is an example of a loosely augmented module that will <strong>maintain private state</strong> across all augmentations:</p><pre><code>var MODULE = (function (my) {	var _private = my._private = my._private || {},		_seal = my._seal = my._seal || function () {			delete my._private;			delete my._seal;			delete my._unseal;		},		_unseal = my._unseal = my._unseal || function () {			my._private = _private;			my._seal = _seal;			my._unseal = _unseal;		};	// permanent access to _private, _seal, and _unseal	return my;}(MODULE || {}));</code></pre><p>Any file can set properties on their local variable <code>_private</code>, and it will be immediately available to the others. Once this module has loaded completely, the application should call <code>MODULE._seal()</code>, which will prevent external access to the internal <code> _private</code>. If this module were to be augmented again, further in the application's lifetime, one of the internal methods, in any file, can call <code> _unseal()</code> before loading the new file, and call <code> _seal()</code> again after it has been executed. This pattern occurred to me today while I was at work, I have not seen this elsewhere. I think this is a very useful pattern, and would have been worth writing about all on its own.</p><h3 id="submodules">Sub-modules</h3><p>Our final advanced pattern is actually the simplest. There are many good cases for creating sub-modules. It is just like creating regular modules:</p><pre><code>MODULE.sub = (function () {	var my = {};	// ...	return my;}());</code></pre><p>While this may have been obvious, I thought it worth including. Sub-modules have all the advanced capabilities of normal modules, including augmentation and private state.</p><h2 id="conclusions">Conclusions</h2><p>Most of the advanced patterns can be combined with each other to create more useful patterns. If I had to advocate a route to take in designing a complex application, I'd combine <strong>loose augmentation </strong>, <strong>private state</strong>, and <strong>sub-modules</strong>.</p><p>I haven't touched on performance here at all, but I'd like to put in one quick note: The module pattern is <strong>good for performance</strong>. It minifies really well, which makes downloading the code faster. Using <strong>loose augmentation</strong> allows easy non-blocking parallel downloads, which also speeds up download speeds. Initialization time is probably a bit slower than other methods, but worth the trade-off. Run-time performance should suffer no penalties so long as globals are imported correctly, and will probably gain speed in sub-modules by shortening the reference chain with local variables.</p><p>To close, here's an example of a sub-module that loads itself dynamically to its parent (creating it if it does not exist). I've left out private state for brevity, but including it would be simple. This code pattern allows an entire complex heirarchical code-base to be loaded completely in parallel with itself, sub-modules and all.</p><pre><code>var UTIL = (function (parent, $) {	var my = parent.ajax = parent.ajax || {};	my.get = function (url, params, callback) {		// ok, so I'm cheating a bit :)		return $.getJSON(url, params, callback);	};	// etc...	return parent;}(UTIL || {}, jQuery));</code></pre><p>I hope this has been useful, and please leave a comment to share your thoughts. Now, go forth and write better, more modular JavaScript! </p><p><strong><em>This post was <a href="http://ajaxian.com/archives/a-deep-dive-and-analysis-of-the-javascript-module-pattern">featured on Ajaxian.com</a>, and there is a little bit more discussion going on there as well, which is worth reading in addition to the comments below.</em></strong></p>  </div>			</div>		<!--========================= END : POST		=============================-->		<!--=========================			START : POST		=============================-->		<div class="post-wrapper"> <h1>JavaScript : Arrow functions</h1>		<article id="wikiArticle">                                                      <div><section id="Quick_Links" class="Quick_links"><!-- --> </section> <div class="overheadIndicator" style="background: #9CF49C;">    <p><strong>This is a new technology, part of the ECMAScript 2015 (ES6) standard.</strong><br>This technology's specification has been finalized, but  check the <a href="#Browser_compatibility">compatibility table</a> for usage and implementation status in various browsers.</p></div></div><p>An <strong>arrow function expression</strong> (also known as <strong>fat arrow function</strong>) has a shorter syntax compared to <a href= "/en-US/docs/Web/JavaScript/Reference/Operators/function">function expressions</a> and lexically binds the <a href="/en-US/docs/Web/JavaScript/Reference/Operators/this">this</a> value. Arrow functions are always <a href="/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function/name">anonymous</a>.</p><h2 id="Syntax">Syntax</h2><pre class="syntaxbox">// Basic syntax: <strong>(</strong><em>param1</em>, <em>param2</em>, <em>paramN</em><strong>) =&gt; {</strong> <em>statements</em> <strong>}</strong><strong>(</strong><em>param1</em>, <em>param2</em>, <em> paramN</em><strong>) =&gt;</strong> <em>expression</em>   // equivalent to:&nbsp; =&gt; { return expression; }// Parentheses are optional when there's only one argument:<em>singleParam </em> <strong>=&gt; {</strong> <em>statements</em> <strong>}</strong><em>singleParam</em> <strong>=&gt;</strong> <em>expression</em>// A function with no arguments requires parentheses: <strong>() =&gt; {</strong> <em>statements</em> <strong>}</strong>// Advanced:// Parenthesize the body to return an object literal expression:<em>params</em> =&gt; ({<em>foo: bar</em>})// <a href="/en-US/docs/Web/JavaScript/Reference/Functions/rest_parameters">Rest parameters</a> are supported(<em>param1</em>, <em>param2</em>, <strong>...rest</strong>) =&gt; { <em> statements</em> }</pre><p>Detailed syntax examples can be seen <a href="http://wiki.ecmascript.org/doku.php?id=harmony:arrow_function_syntax" class="external external-icon" title=" http://wiki.ecmascript.org/doku.php?id=harmony:arrow_function_syntax">here</a>.</p><h2 id="Description">Description</h2><p>See also <a href=" https://hacks.mozilla.org/2015/06/es6-in-depth-arrow-functions/" class="external external-icon">"ES6 In Depth: Arrow functions" on hacks.mozilla.org</a>.</p><p>Two factors influenced the introduction of arrow functions: shorter functions and lexical <code>this</code>.</p><h3 id="Shorter_functions">Shorter functions</h3><p>In some functional patterns, shorter functions are welcome. Compare:</p><pre class="brush: js  language-js" data-number=""><code class=" language-js"><span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token punctuation">[</span>  <span class="token string">"Hydrogen"</span><span class="token punctuation">,</span>  <span class="token string">"Helium"</span><span class="token punctuation">,</span>  <span class="token string">"Lithium"</span><span class="token punctuation">,</span>  <span class="token string">"Beryl-lium"</span><span class="token punctuation">] </span><span class="token punctuation">;</span><span class="token keyword">var</span> a2 <span class="token operator">=</span> a<span class="token punctuation">.</span><span class="token function">map<span class="token punctuation">(</span></span><span class="token keyword">function</span><span class="token punctuation">(</span>s<span class="token punctuation">) </span><span class="token punctuation">{</span> <span class="token keyword">return</span> s<span class="token punctuation">.</span>length <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">var</span> a3 <span class="token operator">=</span> a<span class="token punctuation">. </span><span class="token function">map<span class="token punctuation">(</span></span> s <span class="token operator">=</span><span class="token operator">&gt;</span> s<span class="token punctuation">.</span>length <span class="token punctuation">)</span><span class="token punctuation">;</span><div class="line-number" data-start="1" style="top: 0px;"></div><div class= "line-number" data-start="2" style="top: 19px;"></div><div class="line-number" data-start="3" style="top: 38px;"></div><div class="line-number" data-start="4" style="top: 57px;"></div><div class="line-number" data-start="5" style="top: 76px;"></div><div class="line-number" data-start="6" style="top: 95px;"></div><div class="line-number" data-start="7" style="top: 114px;" ></div><div class="line-number" data-start="8" style="top: 133px;"></div><div class="line-number" data-start="9" style="top: 152px;"></div><div class="line-number" data-start="10" style= "top: 171px;"></div></code></pre><h3 id="Lexical_this">Lexical <code>this</code></h3><p>Until arrow functions, every new function defined its own <code><a href= "/en-US/docs/Web/JavaScript/Reference/Operators/this">this</a></code> value (a new object in case of a constructor, undefined in <a href="/en-US/docs/Web/JavaScript/Reference/Strict_mode"> strict mode</a> function calls, the context object if the function is called as an "object method", etc.). This proved to be annoying with an object-oriented style of programming.</p><pre class="brush: js  language-js" data-number=""><code class=" language-js"><span class="token keyword">function</span> <span class="token function">Person<span class="token punctuation">( </span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment" spellcheck="true"> // The Person() constructor defines `this` as an instance of itself.</span>  <span class="token keyword">this</span><span class="token punctuation">.</span>age <span class="token operator">=</span> <span class="token number">0 </span><span class="token punctuation">;</span>  <span class="token function">setInterval<span class="token punctuation">(</span></span><span class="token keyword">function</span> <span class="token function">growUp<span class="token punctuation">(</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>   <span class="token comment" spellcheck="true"> // In nonstrict mode, the growUp() function defines `this`</span>   <span class="token comment" spellcheck="true"> // as the global object, which is different from the `this`</span>   <span class="token comment" spellcheck="true"> // defined by the Person() constructor.</span>    <span class="token keyword">this</span><span class="token punctuation">. </span>age<span class="token operator">++</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class= "token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">var</span> p <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><div class="line-number" data-start="1" style="top: 0px;"></div><div class="line-number" data-start="2" style="top: 19px;" ></div><div class="line-number" data-start="3" style="top: 38px;"></div><div class="line-number" data-start="4" style="top: 57px;"></div><div class="line-number" data-start="5" style= "top: 76px;"></div><div class="line-number" data-start="6" style="top: 95px;"></div><div class="line-number" data-start="7" style="top: 114px;"></div><div class="line-number" data-start= "8" style="top: 133px;"></div><div class="line-number" data-start="9" style="top: 152px;"></div><div class="line-number" data-start="10" style="top: 171px;"></div><div class="line-number" data-start="11" style="top: 190px;"></div><div class="line-number" data-start="12" style="top: 209px;"></div><div class="line-number" data-start="13" style="top: 228px;" ></div></code></pre><p>In ECMAScript 3/5, this issue was fixed by assigning the value in <code>this</code> to a variable that could be closed over.</p><pre class="brush: js  language-js" data-number=""><code class=" language-js"><span class="token keyword">function</span> <span class="token function">Person<span class="token punctuation">(</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token keyword">var</span> self <span class="token operator">=</span> <span class="token keyword">this </span><span class="token punctuation">;</span><span class="token comment" spellcheck="true"> // Some choose `that` instead of `self`.</span>                  <span class="token comment" spellcheck="true"> // Choose one and be consistent.</span>  self<span class="token punctuation">.</span>age <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>  <span class="token function">setInterval<span class="token punctuation">(</span></span><span class="token keyword">function</span> <span class="token function">growUp<span class="token punctuation">(</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>   <span class="token comment" spellcheck= "true"> // The callback refers to the `self` variable of which</span>   <span class="token comment" spellcheck="true"> // the value is the expected object.</span>    self<span class= "token punctuation">.</span>age<span class="token operator">++</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">, </span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><div class= "line-number" data-start="1" style="top: 0px;"></div><div class="line-number" data-start="2" style="top: 19px;"></div><div class="line-number" data-start="3" style="top: 38px;"></div><div class="line-number" data-start="4" style="top: 57px;"></div><div class="line-number" data-start="5" style="top: 76px;"></div><div class="line-number" data-start="6" style="top: 95px;" ></div><div class="line-number" data-start="7" style="top: 114px;"></div><div class="line-number" data-start="8" style="top: 133px;"></div><div class="line-number" data-start="9" style= "top: 152px;"></div><div class="line-number" data-start="10" style="top: 171px;"></div><div class="line-number" data-start="11" style="top: 190px;"></div></code></pre><p>Alternatively, a <a href="/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function/bind">bound function</a> could be created so that the proper <code>this</code> value would be passed to the <code> growUp()</code> function.</p><p>Arrow functions capture the <code>this</code> value of the enclosing context, so the following code works as expected.</p><pre class="brush: js language-js" data-number=""><code class=" language-js"><span class="token keyword">function</span> <span class="token function">Person<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">{</span>  <span class="token keyword">this</span><span class="token punctuation">.</span>age <span class="token operator"> =</span> <span class="token number">0</span><span class="token punctuation">;</span>  <span class="token function">setInterval<span class="token punctuation">(</span></span><span class= "token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span> <span class="token keyword">this</span><span class="token punctuation">.</span>age<span class="token operator">++</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true"> // |this| properly refers to the person object</span>  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">var</span> p <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token punctuation">) </span><span class="token punctuation">;</span><div class="line-number" data-start="1" style="top: 0px;"></div><div class="line-number" data-start="2" style="top: 19px;"></div><div class= "line-number" data-start="3" style="top: 38px;"></div><div class="line-number" data-start="4" style="top: 57px;"></div><div class="line-number" data-start="5" style="top: 76px;"></div><div class="line-number" data-start="6" style="top: 95px;"></div><div class="line-number" data-start="7" style="top: 114px;"></div><div class="line-number" data-start="8" style="top: 133px;" ></div><div class="line-number" data-start="9" style="top: 152px;"></div></code></pre><h4 id="Relation_with_strict_mode">Relation with strict mode</h4><p>Given that <code>this</code> is lexical, <a href="/en-US/docs/Web/JavaScript/Reference/Strict_mode">strict mode</a> rules with regard to <code>this</code> are just ignored.</p><pre class="brush: js  language-js" data-number=""><code class=" language-js"><span class="token keyword">var</span> f <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span><span class="token string">'use strict' </span><span class="token punctuation">;</span> <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token function">f<span class="token punctuation">(</span></span><span class="token punctuation">)</span> <span class="token operator">===</span> window <span class="token punctuation">;</span><span class="token comment" spellcheck="true"> // or the global object</span><div class="line-number" data-start="1" style="top: 0px;"></div><div class="line-number" data-start="2" style="top: 19px;"></div></code></pre><p>The rest of strict mode rules apply normally.</p><h4 id="Invoked_through_call_or_apply">Invoked through call or apply</h4><p>Since <code>this</code><em> </em>is already bound lexically, invoking an arrow function through the <code>call()</code><em> </em>or <code>apply()</code> methods can only pass in arguments, but has no effect on <code>this</code>:</p><pre class="brush: js  language-js" data-number=""><code class=" language-js"><span class="token keyword">var</span> adder <span class="token operator">=</span> <span class="token punctuation">{</span>  base <span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">, </span>  add <span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">var</span> f <span class="token operator">=</span> v <span class="token operator">=</span><span class="token operator"> &gt;</span> v <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>base<span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token function">f<span class="token punctuation">(</span></span>a<span class="token punctuation">)</span><span class="token punctuation">; </span>  <span class="token punctuation">}</span><span class="token punctuation">,</span>  addThruCall<span class="token punctuation">:</span> <span class="token keyword">function </span><span class="token punctuation">(</span>a<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">var</span> f <span class= "token operator">=</span> v <span class="token operator">=</span><span class="token operator">&gt;</span> v <span class="token operator">+</span> <span class="token keyword">this </span><span class="token punctuation">.</span>base<span class="token punctuation">;</span>    <span class="token keyword">var</span> b <span class="token operator">=</span> <span class= "token punctuation">{</span>      base <span class="token punctuation">:</span> <span class="token number">2</span>    <span class="token punctuation">}</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> f<span class="token punctuation">.</span><span class="token function">call<span class="token punctuation">(</span></span> b<span class="token punctuation">,</span> a<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">;</span>console<span class="token punctuation">.</span><span class="token function">log<span class="token punctuation">(</span></span> adder<span class="token punctuation">.</span><span class="token function">add<span class="token punctuation">(</span></span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true"> // This would log to 2</span> console<span class="token punctuation">.</span><span class="token function">log<span class="token punctuation">(</span></span>adder<span class="token punctuation">.</span><span class= "token function">addThruCall<span class="token punctuation">(</span></span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">) </span><span class="token punctuation">;</span><span class="token comment" spellcheck="true"> // This would log to 2 still</span><div class="line-number" data-start="1" style="top: 0px;" ></div><div class="line-number" data-start="2" style="top: 19px;"></div><div class="line-number" data-start="3" style="top: 38px;"></div><div class="line-number" data-start="4" style= "top: 57px;"></div><div class="line-number" data-start="5" style="top: 76px;"></div><div class="line-number" data-start="6" style="top: 95px;"></div><div class="line-number" data-start="7" style="top: 114px;"></div><div class="line-number" data-start="8" style="top: 133px;"></div><div class="line-number" data-start="9" style="top: 152px;"></div><div class="line-number" data-start="10" style="top: 171px;"></div><div class="line-number" data-start="11" style="top: 190px;"></div><div class="line-number" data-start="12" style="top: 209px;"></div><div class= "line-number" data-start="13" style="top: 228px;"></div><div class="line-number" data-start="14" style="top: 247px;"></div><div class="line-number" data-start="15" style="top: 266px;" ></div><div class="line-number" data-start="16" style="top: 285px;"></div><div class="line-number" data-start="17" style="top: 304px;"></div><div class="line-number" data-start="18" style= "top: 323px;"></div><div class="line-number" data-start="19" style="top: 342px;"></div><div class="line-number" data-start="20" style="top: 361px;"></div></code></pre><h3 id= "Lexical_arguments">Lexical <code>arguments</code></h3><p>Arrow functions do not expose an <a href="/en-US/docs/Web/JavaScript/Reference/Functions/arguments"><code>arguments</code> object </a> to their code: <code>arguments.length</code>, <code>arguments[0]</code>, <code>arguments[1]</code>, and so forth do not refer to the arguments provided to the arrow function when called.&nbsp; Instead, <code>arguments</code> is simply a reference to the name in the enclosing scope.</p><pre class="brush: js  language-js" data-number=""><code class=" language-js" ><span class="token keyword">var</span> arguments <span class="token operator">=</span> <span class="token number">42</span><span class="token punctuation">;</span><span class="token keyword">var</span> arr <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">&gt;</span> arguments<span class="token punctuation">;</span><span class="token function">arr<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true"> // 42</span><span class="token keyword">function</span> <span class="token function">foo<span class="token punctuation">(</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token keyword">var</span> f <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator"> &gt;</span> arguments<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class= "token comment" spellcheck="true"> // foo's implicit arguments binding</span>  <span class="token keyword">return</span> <span class="token function">f<span class="token punctuation">( </span></span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token function">foo<span class="token punctuation">(</span></span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class= "token comment" spellcheck="true"> // 1</span><div class="line-number" data-start="1" style="top: 0px;"></div><div class="line-number" data-start="2" style="top: 19px;"></div><div class= "line-number" data-start="3" style="top: 38px;"></div><div class="line-number" data-start="4" style="top: 57px;"></div><div class="line-number" data-start="5" style="top: 76px;"></div><div class="line-number" data-start="6" style="top: 95px;"></div><div class="line-number" data-start="7" style="top: 114px;"></div><div class="line-number" data-start="8" style="top: 133px;" ></div><div class="line-number" data-start="9" style="top: 152px;"></div><div class="line-number" data-start="10" style="top: 171px;"></div><div class="line-number" data-start="11" style= "top: 190px;"></div></code></pre><p>Arrow functions don't have their own <code>arguments</code> object, but in most cases <a href=" https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Functions/rest_parameters">rest parameters</a> are a good alternative:</p><pre class="brush: js  language-js" data-number= ""><code class=" language-js"><span class="token keyword">function</span> <span class="token function">foo<span class="token punctuation">(</span></span><span class="token punctuation">) </span> <span class="token punctuation">{</span>  <span class="token keyword">var</span> f <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>args<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">&gt;</span> args<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">; </span>  <span class="token keyword">return</span> <span class="token function">f<span class="token punctuation">(</span></span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token function">foo<span class="token punctuation">(</span></span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true"> // 2</span><div class= "line-number" data-start="1" style="top: 0px;"></div><div class="line-number" data-start="2" style="top: 19px;"></div><div class="line-number" data-start="3" style="top: 38px;"></div><div class="line-number" data-start="4" style="top: 57px;"></div><div class="line-number" data-start="5" style="top: 76px;"></div><div class="line-number" data-start="6" style="top: 95px;" ></div></code></pre><h3 id="Use_of_the_yield_keyword">Use of the <code>yield</code> keyword</h3><p>The <code>yield</code>&nbsp;keyword&nbsp;may not be used in an arrow function's body (except when permitted within functions further nested within it).&nbsp; As a consequence, arrow functions cannot be used as generators.</p><h2 id="Returning_object_literals">Returning object literals</h2><p>Keep in mind that returning object literals using the consise syntax <code>params =&gt; {object:literal}</code> will not work as expected:</p><pre class="brush: js language-js" data-number=""><code class=" language-js"><span class="token keyword">var</span> func <span class="token operator">=</span> <span class="token punctuation">(</span><span class ="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>  foo<span class="token punctuation">: </span> <span class="token number">1</span>  <span class="token punctuation">}</span><span class="token punctuation">;</span>              <span class="token comment" spellcheck="true"> // Calling func() returns undefined!</span><span class="token keyword">var</span> func <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>  foo<span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>  <span class="token punctuation">}</span><span class="token punctuation">;</span>  <span class="token comment" spellcheck="true"> // SyntaxError: function statement requires a name</span><div class="line-number" data-start="1" style="top: 0px;"></div><div class="line-number" data-start="2" style="top: 19px;"></div></code></pre><p>This is because the code inside braces ({}) is parsed as a sequence of statements (i.e. <code>foo</code> is treated like a label, not a key in an object literal).</p><p>Remember to wrap the object literal in parentheses:</p><pre class="brush: js  language-js" data-number=""><code class=" language-js"><span class="token keyword">var</span> func <span class="token operator">=</span> <span class= "token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token punctuation">( </span><span class="token punctuation">{</span> foo<span class="token punctuation">:</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><div class="line-number" data-start="1" style="top: 0px;"></div></code></pre><h2 id="Examples">Examples</h2><pre class="brush: js  language-js" data-number=""><code class=" language-js"><span class="token comment" spellcheck="true">// An empty arrow function returns undefined</span><span class="token keyword">let </span> empty <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class= "token operator">&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token punctuation">( </span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token string">"foobar"</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true" > // returns "foobar"</span><span class="token keyword">var</span> simple <span class="token operator">=</span> a <span class="token operator">=</span><span class="token operator">&gt; </span> a <span class="token operator">&gt;</span> <span class="token number">15</span> <span class="token operator">?</span> <span class="token number">15</span> <span class="token punctuation">:</span> a<span class="token punctuation">;</span><span class="token function">simple<span class="token punctuation">(</span></span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true"> // 15</span><span class="token function">simple<span class="token punctuation">(</span></span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck= "true"> // 10</span><span class="token keyword">let</span> max <span class="token operator">=</span> <span class="token punctuation">(</span>a<span class="token punctuation">,</span> b <span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">&gt;</span> a <span class="token operator">&gt;</span> b <span class="token operator">?</span> a <span class="token punctuation">:</span> b<span class="token punctuation">;</span><span class="token comment" spellcheck="true">// Easy array filtering, mapping, ... </span><span class="token keyword">var</span> arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span> <span class= "token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">18</span><span class= "token punctuation">,</span> <span class="token number">23</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">var</span> sum <span class="token operator">=</span> arr<span class="token punctuation">.</span><span class="token function">reduce<span class="token punctuation">(</span></span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">&gt;</span> a <span class="token operator">+</span> b<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true"> // 66</span><span class="token keyword">var</span> even <span class="token operator">=</span> arr<span class="token punctuation">.</span><span class="token function">filter<span class="token punctuation">( </span></span>v <span class="token operator">=</span><span class="token operator">&gt;</span> v <span class="token operator">%</span> <span class="token number">2</span> <span class= "token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true"> // [6, 0, 18]</span><span class="token keyword">var</span> double <span class="token operator">=</span> arr<span class="token punctuation">.</span><span class="token function">map<span class="token punctuation">(</span></span>v <span class="token operator">=</span><span class="token operator">&gt;</span> v <span class="token operator">*</span> <span class="token number"> 2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token comment" spellcheck="true"> // [10, 12, 26, 0, 2, 36, 46]</span><div class= "line-number" data-start="1" style="top: 0px;"></div><div class="line-number" data-start="2" style="top: 19px;"></div><div class="line-number" data-start="3" style="top: 38px;"></div><div class="line-number" data-start="4" style="top: 57px;"></div><div class="line-number" data-start="5" style="top: 76px;"></div><div class="line-number" data-start="6" style="top: 95px;" ></div><div class="line-number" data-start="7" style="top: 114px;"></div><div class="line-number" data-start="8" style="top: 133px;"></div><div class="line-number" data-start="9" style= "top: 152px;"></div><div class="line-number" data-start="10" style="top: 171px;"></div><div class="line-number" data-start="11" style="top: 190px;"></div><div class="line-number" data-start="12" style="top: 209px;"></div><div class="line-number" data-start="13" style="top: 228px;"></div><div class="line-number" data-start="14" style="top: 247px;"></div><div class= "line-number" data-start="15" style="top: 266px;"></div><div class="line-number" data-start="16" style="top: 285px;"></div><div class="line-number" data-start="17" style="top: 304px;" ></div></code></pre><h2 id="Specifications">Specifications</h2><table class="standard-table"> <tbody>  <tr>   <th scope="col">Specification</th>   <th scope="col">Status</th>   <th scope= "col">Comment</th>  </tr>  <tr>   <td><a href="http://www.ecma-international.org/ecma-262/6.0/#sec-arrow-function-definitions" class="external external-icon" lang="en" hreflang="en"> ECMAScript 2015 (6th Edition, ECMA-262)<br><small lang="en-US">The definition of 'Arrow Function Definitions' in that specification.</small></a></td>   <td><span class="spec-Standard"> Standard</span></td>   <td>Initial definition.</td>  </tr> </tbody></table><h2 id="Browser_compatibility">Browser compatibility</h2><div><div class="htab">    <a name= "AutoCompatibilityTable" id="AutoCompatibilityTable"></a>    <ul>        <li class="selected"><a>Desktop</a></li>        <li><a>Mobile</a></li>    </ul><div id="compat-mobile" ></div></div></div><h2 id="Firefox-specific_notes">Firefox-specific notes</h2><ul> <li>The initial implementation of arrow functions in Firefox made them automatically strict. This has been changed as of <a href="/en-US/docs/Mozilla/Firefox/Releases/24" title="/en-US/docs/Mozilla/Firefox/Releases/24">Firefox 24</a>. The use of <code>"use strict";</code> is now required. </li> <li>Arrow functions are semantically different from the non-standard <a href="/en-US/docs/Web/JavaScript/Reference/Operators/Expression_Closures" title="Expression closures are a shorthand function syntax for writing simple functions.">Expression Closures</a> added in <a href="/en-US/Firefox/Releases/3">Firefox 3</a> (details: <a href= "/en-US/docs/Web/JavaScript/New_in_JavaScript/1.8">Javascript 1.8</a>), for <a href="/en-US/docs/Web/JavaScript/Reference/Operators/Expression_Closures" title="Expression closures are a shorthand function syntax for writing simple functions.">Expression Closures</a> do not bind <code>this</code> lexically.</li> <li>Prior to <a href="/en-US/Firefox/Releases/39">Firefox 39 </a>, a line terminator (<code>\n</code>) was incorrectly allowed after arrow function arguments. This has been fixed to conform to the ES6 specification and code like <code>() \n =&gt; {} </code> will now throw a <a href="/en-US/docs/Web/JavaScript/Reference/Global_Objects/SyntaxError" title="The SyntaxError object represents an error when trying to interpret syntactically invalid code."><code>SyntaxError</code></a> in this and later versions.</li></ul><h2 id="See_also">See also</h2><ul> <li><a href=" https://hacks.mozilla.org/2015/06/es6-in-depth-arrow-functions/" class="external external-icon">"ES6 In Depth: Arrow functions" on hacks.mozilla.org</a></li></ul> </article>			</div>		<!--=========================			END : POST		=============================--> <!--=========================			START : POST		=============================-->		<div class="post-wrapper"><article class="post clear">      <h1 class="post__title"> Everything you wanted to know about JavaScript scope      </h1>      <div class="post__meta">        <a href= "//github.com/toddmotto/toddmotto.github.io/blob/master/_posts/2013-12-29-everything-you-wanted-to-know-about-javascript-scope.md" class="post__meta-edit">          <i class="fa fa-github" ></i>          Edit this page on GitHub        </a>        <p>          December 29, 2013        </p>      </div>      <p>The JavaScript language has a few concepts of "scope", none of which are straightforward or easy to understand as a new JavaScript developer (and even some experienced JavaScript developers). This post is aimed at those wanting to learn about the many depths of JavaScript after hearing words such as <code>scope</code>, <code>closure</code>, <code>this</code>, <code>namespace</code>, <code>function scope</code>, <code>global scope </code>, <code>lexical scope</code> and <code>public/private scope</code>. Hopefully by reading this post you'll know the answers to:</p><ul><li>What is Scope?</li><li>What is Global/Local Scope?</li><li>What is a Namespace and how does it differ to Scope?</li><li>What is the <code>this</code> keyword and how does Scope affect it?</li><li>What is Function/Lexical Scope?</li><li>What are Closures?</li><li>What is Public/Private Scope?</li><li>How can I understand/create/do all of the above?</li></ul><h3>What is Scope?</h3><p>In JavaScript, scope refers to the current context of your code. Scopes can be <em>globally</em> or <em>locally</em> defined. Understanding JavaScript scope is key to writing bulletproof code and being a better developer. You'll understand where variables/functions are accessible, be able to change the scope of your code's context and be able to write faster and more maintainable code, as well as debug much faster.</p><p>Thinking about scope is easy, are we inside <code>Scope A</code> or <code>Scope B</code>?</p><h3>What is Global Scope?</h3><p>Before you write a line of JavaScript, you're in what we call the <code>Global Scope</code>. If we declare a variable, it's defined globally:</p><div class="highlight"><pre><code data-lang= "javascript" class="language-javascript"><span class="c1">// global scope</span><span class="kd">var</span> <span class="nx">name</span> <span class="o">=</span> <span class="s1">'Todd' </span><span class="p">;</span></code></pre></div><p>Global scope is your best friend and your worst nightmare, learning to control your scopes is easy and in doing so, you''ll run into no issues with global scope problems (usually namespace clashes). You'll often hear people saying "Global Scope is <em>bad</em>", but never really justifying as to <em>why</em>. Global scope isn't bad, you need it to create Modules/APIs that are accessible across scopes, you must use it to your advantage and not cause issues.</p><p>Everyone's used jQuery before, as soon as you do this...</p><div class="highlight"><pre><code data-lang="javascript" class="language-javascript"><span class="nx">jQuery</span><span class="p">(</span><span class="s1">'.myClass' </span><span class="p">);</span></code></pre></div><p>... we're accessing jQuery in <em>global</em> scope, we can refer to this access as the <code>namespace</code>. The namespace is sometimes an interchangable word for scope, but usually the refers to the highest level scope. In this case, <code>jQuery</code> is in the global scope, and is also our namespace. The <code>jQuery</code> namespace is defined in the global scope, which acts as a namespace for the jQuery library as everything inside it becomes a descendent of that namespace.</p><h3>What is Local Scope?</h3><p>A local scope refers to any scope defined past the global scope. There is typically one global scope, and each function defined has its own (nested) local scope. Any function defined within another function has a local scope which is linked to the outer function.</p><p>If I define a function and create variables inside it, those variables becomes locally scoped. Take this example:</p><div class="highlight"><pre><code data-lang="javascript" class="language-javascript"><span class="c1">// Scope A: Global scope out here</span><span class="kd">var</span> <span class="nx">myFunction</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>  <span class="c1">// Scope B: Local scope in here</span><span class="p">};</span></code></pre></div><p>Any locally scoped items are not visible in the global scope - <em>unless</em> exposed, meaning if I define functions or variables within a new scope, it's inaccessible <em>outside</em> of that current scope. A simple example of this is the following:</p><div class="highlight"><pre><code data-lang="javascript" class="language-javascript"><span class="kd">var</span> <span class="nx">myFunction</span> <span class="o">=</span> <span class="kd">function</span> <span class="p"> ()</span> <span class="p">{</span>  <span class="kd">var</span> <span class="nx">name</span> <span class="o">=</span> <span class="s1">'Todd'</span><span class="p">;</span>  <span class= "nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">name</span><span class="p">);</span> <span class="c1">// Todd</span><span class="p">};</span><span class="c1">// Uncaught ReferenceError: name is not defined</span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p"> (</span><span class="nx">name</span><span class="p">);</span></code></pre></div><p>The variable <code>name</code> is scoped locally, it isn't exposed to the parent scope and therefore undefined.</p><h3>Function scope</h3><p>All scopes in JavaScript are created with <code>Function Scope</code> <em>only</em>, they aren't created by <code>for</code> or <code>while</code> loops or expression statements like <code>if</code> or <code>switch</code>. New functions = new scope - that's the rule. A simple example to demonstrate this scope creation:</p><div class= "highlight"><pre><code data-lang="javascript" class="language-javascript"><span class="c1">// Scope A</span><span class="kd">var</span> <span class="nx">myFunction</span> <span class="o">= </span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>  <span class="c1">// Scope B</span>  <span class="kd">var</span> <span class="nx"> myOtherFunction</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>    <span class="c1">// Scope C</span>  <span class="p"> };</span><span class="p">};</span></code></pre></div><p>It's easy to create new scope and create local variables/functions/objects.</p><h3>Lexical Scope</h3><p>Whenever you see a function within another function, the inner function has access to the scope in the outer function, this is called Lexical Scope or Closure - also referred to as Static Scope. The easiest way to demonstrate that again:</p><div class="highlight"><pre><code data-lang="javascript" class="language-javascript"><span class="c1">// Scope A</span><span class="kd">var</span> <span class= "nx">myFunction</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>  <span class="c1">// Scope B</span>  <span class="kd"> var</span> <span class="nx">name</span> <span class="o">=</span> <span class="s1">'Todd'</span><span class="p">;</span> <span class="c1">// defined in Scope B</span>  <span class="kd">var </span> <span class="nx">myOtherFunction</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>    <span class="c1">// Scope C: `name` is accessible here!</span>  <span class="p">};</span><span class="p">};</span></code></pre></div><p>You'll notice that <code>myOtherFunction</code> <em>isn't</em> being called here, it's simply defined. It's order of call also has effect on how the scoped variables react, here I've defined my function and called it <em>under</em> another <code>console</code> statement:</p><div class="highlight"><pre><code data-lang="javascript" class="language-javascript"><span class="kd">var</span> <span class="nx">myFunction</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>  <span class="kd">var</span> <span class="nx">name</span> <span class="o">=</span> <span class="s1"> 'Todd'</span><span class="p">;</span>  <span class="kd">var</span> <span class="nx">myOtherFunction</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">() </span> <span class="p">{</span>    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">'My name is '</span> <span class="o">+</span> <span class="nx">name</span><span class="p">);</span>  <span class="p">};</span>  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">name</span><span class="p">);</span>  <span class="nx">myOtherFunction</span><span class="p">();</span> <span class="c1">// call function</span><span class="p">};</span><span class="c1">// Will then log out:</span><span class="c1">// `Todd`</span><span class="c1">// `My name is Todd`</span></code></pre></div><p>Lexical scope is easy to work with, <em>any</em> variables/objects/functions defined in <em>it's</em> parent scope, are available in the scope chain. For example:</p><div class="highlight"><pre><code data-lang= "javascript" class="language-javascript"><span class="kd">var</span> <span class="nx">name</span> <span class="o">=</span> <span class="s1">'Todd'</span><span class="p">;</span><span class ="kd">var</span> <span class="nx">scope1</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>  <span class="c1">// name is available here</span>  <span class="kd">var</span> <span class="nx">scope2</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{ </span>    <span class="c1">// name is available here too</span>    <span class="kd">var</span> <span class="nx">scope3</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>      <span class="c1">// name is also available here!</span>    <span class="p">};</span>  <span class="p">};</span><span class="p">}; </span></code></pre></div><p>The only important thing to remember is that Lexical scope does <em>not</em> work backwards. Here we can see how Lexical scope <em>doesn't</em> work:</p><div class="highlight"><pre><code data-lang="javascript" class="language-javascript"><span class="c1">// name = undefined</span><span class="kd">var</span> <span class="nx">scope1</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>  <span class="c1">// name = undefined</span>  <span class="kd">var</span> <span class ="nx">scope2</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>    <span class="c1">// name = undefined</span>    <span class="kd">var</span> <span class="nx">scope3</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>      <span class="kd">var </span> <span class="nx">name</span> <span class="o">=</span> <span class="s1">'Todd'</span><span class="p">;</span> <span class="c1">// locally scoped</span>    <span class="p">};</span> <span class="p">};</span><span class="p">};</span></code></pre></div><p>I can always return a reference to <code>name</code>, but never the variable itself.</p><h3>Scope Chain</h3><p> Scope chains establish the scope for a given function. Each function defined has its own nested scope as we know, and any function defined within another function has a local scope which is linked to the outer function - this link is called the chain. It's always the <em>position</em> in the code that defines the scope. When resolving a variable, JavaScript starts at the innermost scope and searches outwards until it finds the variable/object/function it was looking for.</p><h3>Closures</h3><p>Closures ties in very closely with Lexical Scope. A better example of how the <em>closure</em> side of things works, can be seen when returning a <em>function reference</em> - a more practical usage. Inside our scope, we can return things so that they're available in the parent scope:</p><div class="highlight"><pre><code data-lang="javascript" class="language-javascript"><span class="kd">var</span> <span class="nx">sayHello</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">name</span><span class="p">)</span> <span class="p">{</span>  <span class="kd">var</span> <span class="nx">text</span> <span class="o">=</span> <span class="s1">'Hello, '</span> <span class="o">+</span> <span class="nx">name</span><span class="p">;</span>  <span class="k"> return</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">text</span><span class="p">);</span>  <span class="p">};</span><span class="p">};</span></code></pre></div><p>The <code>closure</code> concept we've used here makes our scope inside <code>sayHello</code> inaccessible to the public scope. Calling the function alone will do nothing as it <em>returns</em> a function:</p><div class= "highlight"><pre><code data-lang="javascript" class="language-javascript"><span class="nx">sayHello</span><span class="p">(</span><span class="s1">'Todd'</span><span class="p">);</span> <span class="c1">// nothing happens, no errors, just silence...</span></code></pre></div><p>The function returns a function, which means it needs assignment, and <em>then</em> calling: </p><div class="highlight"><pre><code data-lang="javascript" class="language-javascript"><span class="kd">var</span> <span class="nx">helloTodd</span> <span class="o">=</span> <span class= "nx">sayHello</span><span class="p">(</span><span class="s1">'Todd'</span><span class="p">);</span><span class="nx">helloTodd</span><span class="p">();</span> <span class="c1">// will call the closure and log 'Hello, Todd'</span></code></pre></div><p>Okay, I lied, you <em>can</em> call it, and you may have seen functions like this, but this will call your closure: </p><div class="highlight"><pre><code data-lang="javascript" class="language-javascript"><span class="nx">sayHello2</span><span class="p">(</span><span class="s1">'Bob'</span><span class= "p">)();</span> <span class="c1">// calls the returned function without assignment</span></code></pre></div><p>AngularJS uses the above technique for it's <code>$compile</code> method, where you pass the current scope reference into the closure:</p><div class="highlight"><pre><code data-lang="javascript" class="language-javascript"><span class="nx">$compile</span><span class="p">(</span><span class="nx">template</span><span class="p">)(</span><span class="nx">scope</span><span class="p">);</span></code></pre></div><p>Meaning we could guess that their code would (over-simplified) look like this:</p><div class="highlight"><pre><code data-lang="javascript" class="language-javascript"><span class="kd">var</span> <span class="nx">$compile </span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">template</span><span class="p">)</span> <span class="p">{</span>  <span class= "c1">// some magic stuff here</span>  <span class="c1">// scope is out of scope, though...</span>  <span class="k">return</span> <span class="kd">function</span> <span class="p">( </span><span class="nx">scope</span><span class="p">)</span> <span class="p">{</span>    <span class="c1">// access to `template` and `scope` to do magic with too</span>  <span class="p"> };</span><span class="p">};</span></code></pre></div><p>A function doesn't <em>have</em> to return in order to be called a closure though. Simply accessing variables outside of the immediate lexical scope creates a closure.</p><h3>Scope and 'this'</h3><p>Each scope binds a different value of <code>this</code> depending on how the function is invoked. We've all used the <code>this</code> keyword, but not all of us understand it and how it differs when invoked. By default <code>this</code> refers to the outer most global object, the <code>window</code> . We can easily show how invoking functions in different ways binds the <code>this</code> value differently:</p><div class="highlight"><pre><code data-lang="javascript" class= "language-javascript"><span class="kd">var</span> <span class="nx">myFunction</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{ </span>  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="k">this</span><span class="p">);</span> <span class="c1">// this = global, [object Window]</span><span class="p">};</span><span class="nx">myFunction</span><span class="p">();</span><span class="kd">var</span> <span class="nx">myObject</span> <span class="o">=</span> <span class="p">{};</span><span class="nx">myObject</span><span class="p">.</span><span class="nx">myMethod</span> <span class="o">=</span> <span class="kd">function </span> <span class="p">()</span> <span class="p">{</span>  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="k">this </span><span class="p">);</span> <span class="c1">// this = Object { myObject }</span><span class="p">};</span><span class="kd">var</span> <span class="nx">nav</span> <span class="o">= </span> <span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s1">'.nav'</span><span class="p">);</span> <span class="c1">// &lt;nav class="nav"&gt;</span><span class="kd">var</span> <span class="nx">toggleNav</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">() </span> <span class="p">{</span>  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="k">this</span><span class="p">); </span> <span class="c1">// this = &lt;nav&gt; element</span><span class="p">};</span><span class="nx">nav</span><span class="p">.</span><span class="nx">addEventListener</span><span class ="p">(</span><span class="s1">'click'</span><span class="p">,</span> <span class="nx">toggleNav</span><span class="p">,</span> <span class="kc">false</span><span class="p">); </span></code></pre></div><p>There are also problems that we run into when dealing with the <code>this</code> value, for instance if I do this, even inside the same function the scope can be changed and the <code>this</code> value can be changed:</p><div class="highlight"><pre><code data-lang="javascript" class="language-javascript"><span class="kd">var</span> <span class= "nx">nav</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s1">'.nav' </span><span class="p">);</span> <span class="c1">// &lt;nav class="nav"&gt;</span><span class="kd">var</span> <span class="nx">toggleNav</span> <span class="o">=</span> <span class="kd"> function</span> <span class="p">()</span> <span class="p">{</span>  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class= "k">this</span><span class="p">);</span> <span class="c1">// &lt;nav&gt; element</span>  <span class="nx">setTimeout</span><span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="k">this</span><span class="p">);</span> <span class="c1">// [object Window]</span>  <span class="p">},</span> <span class="mi">1000</span><span class="p">);</span><span class="p">};</span><span class="nx">nav </span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s1">'click'</span><span class="p">,</span> <span class="nx">toggleNav </span><span class="p">,</span> <span class="kc">false</span><span class="p">);</span></code></pre></div><p>So what's happened here? We've created new scope which is not invoked from our event handler, so it defaults to the <code>window</code> Object as expected. There are several things we can do if we want to access the proper <code>this</code> value which isn't affected by the new scope. You might have seen this before, where we can cache a reference to the <code>this</code> value using a <code>that</code> variable and refer to the lexical binding:</p><div class="highlight"><pre><code data-lang="javascript" class="language-javascript"><span class="kd">var</span> <span class="nx">nav</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s1">'.nav'</span><span class="p">);</span> <span class="c1">// &lt;nav class="nav"&gt;</span><span class="kd">var</span> <span class="nx">toggleNav</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class= "p">{</span>  <span class="kd">var</span> <span class="nx">that</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">that</span><span class="p">);</span> <span class="c1">// &lt;nav&gt; element</span>  <span class="nx"> setTimeout</span><span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">that</span><span class="p">);</span> <span class="c1">// &lt;nav&gt; element</span>  <span class="p">},</span> <span class= "mi">1000</span><span class="p">);</span><span class="p">};</span><span class="nx">nav</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s1">'click'</span><span class="p">,</span> <span class="nx">toggleNav</span><span class="p">,</span> <span class="kc">false</span><span class="p">);</span></code></pre></div><p> This is a neat little trick to be able to use the proper <code>this</code> value and resolve problems with newly created scope.</p><h3>Changing scope with .call(), .apply() and .bind() </h3><p>Sometimes you need to manipulate the scopes of your JavaScript depending on what you're looking to do. A simple demonstration of how to change the scope when looping:</p><div class ="highlight"><pre><code data-lang="javascript" class="language-javascript"><span class="kd">var</span> <span class="nx">links</span> <span class="o">=</span> <span class="nb">document </span><span class="p">.</span><span class="nx">querySelectorAll</span><span class="p">(</span><span class="s1">'nav li'</span><span class="p">);</span><span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o" >&lt;</span> <span class="nx">links</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">) </span> <span class="p">{</span>  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="k">this</span><span class="p">); </span> <span class="c1">// [object Window]</span><span class="p">}</span></code></pre></div><p>The <code>this</code> value here doesn't refer to our elements, we're not invoking anything or changing the scope. Let's look at how we can change scope (well, it looks like we change scope, but what we're really doing is changing the <em>context</em> of how the function is called).</p><h4>.call() and .apply()</h4><p>The <code>.call()</code> and <code>.apply()</code> methods are really sweet, they allows you to pass in a scope to a function, which binds the correct <code>this</code> value. Let's manipulate the above function to make it so that our <code>this</code> value is each element in the array:</p><div class="highlight"><pre><code data-lang="javascript" class="language-javascript"><span class="kd">var</span> <span class="nx">links</span> <span class="o">=</span> <span class="nb">document</span><span class="p">. </span><span class="nx">querySelectorAll</span><span class="p">(</span><span class="s1">'nav li'</span><span class="p">);</span><span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class ="nx">links</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p"> {</span>  <span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>    <span class="nx">console</span><span class="p">.</span><span class= "nx">log</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>  <span class="p">}).</span><span class="nx">call</span><span class="p">(</span><span class="nx"> links</span><span class="p">[</span><span class="nx">i</span><span class="p">]);</span><span class="p">}</span></code></pre></div><p>You can see I'm passing in the current element in the Array iteration, <code>links[i]</code>, which changes the scope of the function so that the <code>this</code> value becomes that iterated element. We can then use the <code>this</code> binding if we wanted. We can use either <code>.call()</code> or <code>.apply()</code> to change the scope, but any further arguments are where the two differ: <code>.call(scope, arg1, arg2, arg3)</code> takes individual arguments, comma separated, whereas <code>.apply(scope, [arg1, arg2])</code> takes an Array of arguments.</p><p>It's important to remember that using <code>.call()</code> or <code>.apply()</code> actually invokes your function, so instead of doing this:</p><div class="highlight"><pre><code data-lang="javascript" class= "language-javascript"><span class="nx">myFunction</span><span class="p">();</span> <span class="c1">// invoke myFunction</span></code></pre></div><p>You'll let <code>.call()</code> handle it and chain the method:</p><div class="highlight"><pre><code data-lang="javascript" class="language-javascript"><span class="nx">myFunction</span><span class="p">.</span><span class="nx"> call</span><span class="p">(</span><span class="nx">scope</span><span class="p">);</span> <span class="c1">// invoke myFunction using .call()</span></code></pre></div><h4>.bind()</h4><p> Unlike the above, using <code>.bind()</code> does not <em>invoke</em> a function, it merely binds the values before the function is invoked. It's a real shame this was introduced in ECMASCript 5 and not earlier as this method is fantastic. As you know we can't pass parameters into function references, something like this:</p><div class="highlight"><pre><code data-lang ="javascript" class="language-javascript"><span class="c1">// works</span><span class="nx">nav</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">( </span><span class="s1">'click'</span><span class="p">,</span> <span class="nx">toggleNav</span><span class="p">,</span> <span class="kc">false</span><span class="p">);</span><span class= "c1">// will invoke the function immediately</span><span class="nx">nav</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s1"> 'click'</span><span class="p">,</span> <span class="nx">toggleNav</span><span class="p">(</span><span class="nx">arg1</span><span class="p">,</span> <span class="nx">arg2</span><span class ="p">),</span> <span class="kc">false</span><span class="p">);</span></code></pre></div><p>We <em>can</em> fix this, by creating a new function inside it:</p><div class="highlight" ><pre><code data-lang="javascript" class="language-javascript"><span class="nx">nav</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s1">'click'</span><span class="p">,</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>  <span class="nx">toggleNav</span><span class="p">( </span><span class="nx">arg1</span><span class="p">,</span> <span class="nx">arg2</span><span class="p">);</span><span class="p">},</span> <span class="kc">false</span><span class="p">); </span></code></pre></div><p>But again this changes scope and we're creating a needless function again, which will be costly on performance if we were inside a loop and binding event listeners. This is where <code>.bind()</code> shines through, as we can pass in arguments but the functions are not called:</p><div class="highlight"><pre><code data-lang="javascript" class="language-javascript"><span class="nx">nav</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s1">'click'</span><span class= "p">,</span> <span class="nx">toggleNav</span><span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="nx">scope</span><span class="p">,</span> <span class= "nx">arg1</span><span class="p">,</span> <span class="nx">arg2</span><span class="p">),</span> <span class="kc">false</span><span class="p">);</span></code></pre></div><p>The function isn't invoked, and the scope can be changed if needed, but arguments are sat waiting to be passed in.</p><h3>Private and Public Scope</h3><p>In many programming languages, you'll hear about <code>public</code> and <code>private</code> scope, in JavaScript there is no such thing. We can, however, emulate public and private scope through things like Closures.</p><p>By using JavaScript design patterns, such as the <code>Module</code> pattern for example, we can create <code>public</code> and <code>private</code> scope. A simple way to create private scope, is by wrapping our functions inside a function. As we've learned, functions create scope, which keeps things out of the global scope:</p><div class="highlight"><pre><code data-lang= "javascript" class="language-javascript"><span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>  <span class="c1">// private scope inside here</span><span class="p">})();</span></code></pre></div><p>We might then add a few functions for use in our app:</p><div class="highlight"><pre><code data-lang="javascript" class= "language-javascript"><span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>  <span class="kd">var</span> <span class="nx">myFunction </span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>    <span class="c1">// do some stuff here</span>  <span class="p">}; </span><span class="p">})();</span></code></pre></div><p>But when we come to calling our function, it would be out of scope:</p><div class="highlight"><pre><code data-lang="javascript" class="language-javascript"><span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>  <span class="kd">var</span> <span class="nx"> myFunction</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>    <span class="c1">// do some stuff here</span>  <span class ="p">};</span><span class="p">})();</span><span class="nx">myFunction</span><span class="p">();</span> <span class="c1">// Uncaught ReferenceError: myFunction is not defined </span></code></pre></div><p>Success! We've created private scope. But what if I want the function to be public? There's a great pattern (called the Module Pattern [and Revealing Module Pattern]) which allows us to scope our functions correctly, using private and public scope and an <code>Object</code>. Here I grab my global namespace, called <code>Module</code>, which contains all of my relevant code for that module:</p><div class="highlight"><pre><code data-lang="javascript" class="language-javascript"><span class="c1">// define module</span><span class="kd">var</span> <span class="nx">Module</span> <span class="o">=</span> <span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span> <span class="k">return</span> <span class="p">{</span>    <span class="nx">myMethod</span><span class="o">:</span> <span class="kd">function</span> <span class="p">()</span> <span class= "p">{</span>      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">'myMethod has been called.'</span><span class= "p">);</span>    <span class="p">}</span>  <span class="p">};</span><span class="p">})();</span><span class="c1">// call module + methods</span><span class="nx">Module</span><span class= "p">.</span><span class="nx">myMethod</span><span class="p">();</span></code></pre></div><p>The <code>return</code> statement here is what returns our <code>public</code> methods, which are accessible in the global scope - <em>but</em> are <code>namespaced</code>. This means our Module takes care of our namespace, and can contain as many methods as we want. We can extend the Module as we wish:</p><div class="highlight"><pre><code data-lang="javascript" class="language-javascript"><span class="c1">// define module</span><span class="kd">var</span> <span class="nx">Module</span> <span class="o">=</span> <span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>  <span class="k">return</span> <span class="p">{</span>    <span class="nx">myMethod</span><span class="o">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>    <span class="p" >},</span>    <span class="nx">someOtherMethod</span><span class="o">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>    <span class="p">} </span>  <span class="p">};</span><span class="p">})();</span><span class="c1">// call module + methods</span><span class="nx">Module</span><span class="p">.</span><span class="nx"> myMethod</span><span class="p">();</span><span class="nx">Module</span><span class="p">.</span><span class="nx">someOtherMethod</span><span class="p">();</span></code></pre></div><p>So what about private methods? This is where a lot of developers go wrong and pollute the global namespace by dumping all their functions in the global scope. Functions that help our code <em>work</em> do not need to be in the global scope, only the API calls do - things that <em>need</em> to be accessed globally in order to work. Here's how we can create private scope, by <em>not</em> returning functions:</p><div class="highlight"><pre><code data-lang="javascript" class="language-javascript"><span class="kd">var</span> <span class="nx">Module</span> <span class="o">=</span> <span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>  <span class="kd">var</span> <span class="nx">privateMethod </span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>  <span class="p">};</span>  <span class="k">return</span> <span class= "p">{</span>    <span class="nx">publicMethod</span><span class="o">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>    <span class="p">}</span> <span class="p">};</span><span class="p">})();</span></code></pre></div><p>This means that <code>publicMethod</code> can be called, but <code>privateMethod</code> cannot, as it's privately scoped! These privately scoped functions are things like helpers, addClass, removeClass, Ajax/XHR calls, Arrays, Objects, anything you can think of.</p><p>Here's an interesting twist though, anything in the same scope has access to anything in the same scope, even <em>after</em> the function has been returned. Which means, our <code>public</code> methods have <em>access</em> to our <code>private</code> ones, so they can still interact but are unaccessible in the global scope.</p><div class="highlight"><pre><code data-lang="javascript" class= "language-javascript"><span class="kd">var</span> <span class="nx">Module</span> <span class="o">=</span> <span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>  <span class="kd">var</span> <span class="nx">privateMethod</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class ="p">{</span>  <span class="p">};</span>  <span class="k">return</span> <span class="p">{</span>    <span class="nx">publicMethod</span><span class="o">:</span> <span class="kd">function </span> <span class="p">()</span> <span class="p">{</span>      <span class="c1">// has access to `privateMethod`, we can call it:</span>      <span class="c1">// privateMethod();</span> <span class="p">}</span>  <span class="p">};</span><span class="p">})();</span></code></pre></div><p>This allows a very powerful level of interactivity, as well as code security. A very important part of JavaScript is ensuring security, which is exactly <em>why</em> we can't afford to put all functions in the global scope as they'll be publically available, which makes them open to vulnerable attacks.</p><p>Here's an example of returning an Object, making use of <code>public</code> and <code>private</code> methods:</p><div class="highlight" ><pre><code data-lang="javascript" class="language-javascript"><span class="kd">var</span> <span class="nx">Module</span> <span class="o">=</span> <span class="p">(</span><span class="kd"> function</span> <span class="p">()</span> <span class="p">{</span>  <span class="kd">var</span> <span class="nx">myModule</span> <span class="o">=</span> <span class="p">{};</span>  <span class="kd">var</span> <span class="nx">privateMethod</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>  <span class="p">}; </span>  <span class="nx">myModule</span><span class="p">.</span><span class="nx">publicMethod</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>  <span class="p">};</span>  <span class="nx">myModule</span><span class="p">.</span><span class="nx">anotherPublicMethod</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>  <span class="p">};</span>  <span class="k">return</span> <span class="nx">myModule</span><span class="p">; </span> <span class="c1">// returns the Object with public methods</span><span class="p">})();</span><span class="c1">// usage</span><span class="nx">Module</span><span class="p">. </span><span class="nx">publicMethod</span><span class="p">();</span></code></pre></div><p>One neat naming convention is to begin <code>private</code> methods with an underscore, which visually helps you differentiate between public and private:</p><div class="highlight"><pre><code data-lang="javascript" class="language-javascript"><span class="kd">var</span> <span class ="nx">Module</span> <span class="o">=</span> <span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>  <span class="kd">var</span> <span class="nx">_privateMethod</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>  <span class="p">};</span>  <span class="kd"> var</span> <span class="nx">publicMethod</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>  <span class="p">};</span><span class="p">})();</span></code></pre></div><p>This helps us when returning an anonymous <code>Object</code>, which the Module can use in Object fashion as we can simply assign the function references:</p><div class="highlight"><pre><code data-lang="javascript" class="language-javascript"><span class="kd">var</span> <span class="nx">Module</span> <span class="o">=</span> <span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>  <span class="kd">var</span> <span class="nx">_privateMethod</span> <span class= "o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>  <span class="p">};</span>  <span class="kd">var</span> <span class="nx">publicMethod </span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>  <span class="p">};</span>  <span class="k">return</span> <span class= "p">{</span>    <span class="nx">publicMethod</span><span class="o">:</span> <span class="nx">publicMethod</span><span class="p">,</span>    <span class="nx">anotherPublicMethod </span><span class="o">:</span> <span class="nx">anotherPublicMethod</span>  <span class="p">}</span><span class="p">})();</span></code></pre></div><p>Happy scoping!</p>    </article> </div>		<!--=========================			END : POST		=============================-->		<!--=========================			START : POST =============================-->		<div class="post-wrapper">		<h1 class="post-title">Understanding Scope and Context in JavaScript</h1>		<section class="post-content"> <p>JavaScript's implementation of scope and context is a unique feature of the language, in part because it is so flexible. Functions can be adopted for various contexts and scope can be encapsulated and preserved. These concepts lend to some of the most powerful design patterns JavaScript has to offer. However, this is also a tremendous source of confusion amongst developers, and for good reason. The following is a comprehensive explanation of scope and context, the difference between them, and how various design patterns make use of them. <span id="more-10"></span></p><h2>Context vs. Scope</h2><p>The first important thing to clear up is that context and scope are not the same. I have noticed many developers over the years often confuse the two terms (myself included), incorrectly describing one for the other. To be fair, the terminology has become quite muddled over the years.</p><p>Every function invocation has both a scope and a context associated with it. Fundamentally, scope is function-based while context is object-based. In other words, scope pertains to the variable access of a function when it is invoked and is unique to each invocation. Context is always the value of the <code>this</code> keyword which is a reference to the object that "owns" the currently executing code. </p><h2>Variable Scope</h2><p>A variable can be defined in either local or global scope, which establishes the variables' accessibility from different scopes during runtime. Any defined global variable, meaning any variable declared outside of a function body will live throughout runtime and can be accessed and altered in any scope. Local variables exist only within the function body of which they are defined and will have a different scope for every call of that function. There it is subject for value assignment, retrieval, and manipulation only within that call and is not accessible outside of that scope.</p><p>JavaScript presently does not support block scope which is the ability to define a variable to the scope of an if statement, switch statement, for loop, or while loop. This means the variable will not be accessible outside the opening and closing curly braces of the block. Currently any defined variables inside a block are accessible outside the block. However, this is soon to change, the <code>let</code> keyword has officially been added to the ES6 specification. It can be used alternatively to the <code>var</code> keyword and supports the declaration of block scope local variables.</p><h2>What is "this" Context</h2><p>Context is most often determined by how a function is invoked. When a function is called as a method of an object, <code>this</code> is set to the object the method is called on:</p><div class= "code-block"><pre class="prettyprint lang-javascript"><span class="kwd">var</span><span class="pln"> obj </span><span class="pun">=</span><span class="pln"> </span><span class="pun">{ </span><span class="pln">    foo</span><span class="pun">:</span><span class="pln"> </span><span class="kwd">function</span><span class="pun">(){</span><span class="pln">        alert </span><span class="pun">(</span><span class="kwd">this</span><span class="pln"> </span><span class="pun">===</span><span class="pln"> obj</span><span class="pun">);</span><span class= "pln">    </span><span class="pun">}</span><span class="pln"></span><span class="pun">};</span><span class="pln">obj</span><span class="pun">.</span><span class="pln">foo</span><span class ="pun">();</span><span class="pln"> </span><span class="com">// true</span></pre></div><p>The same principle applies when invoking a function with the <code>new</code> operator to create an instance of an object. When invoked in this manner, the value of <code>this</code> within the scope of the function will be set to the newly created instance:</p><div class="code-block" ><pre class="prettyprint lang-javascript"><span class="kwd">function</span><span class="pln"> foo</span><span class="pun">(){</span><span class="pln">    alert</span><span class="pun">( </span><span class="kwd">this</span><span class="pun">);</span><span class="pln"></span><span class="pun">}</span><span class="pln">foo</span><span class="pun">()</span><span class="pln"> </span><span class="com">// window</span><span class="pln"></span><span class="kwd">new</span><span class="pln"> foo</span><span class="pun">()</span><span class="pln"> </span><span class= "com">// foo</span></pre></div><p>When called as an unbound function, <code>this</code> will default to the global context or window object in the browser. However, if the function is executed in <em>strict mode</em>, the context will default to undefined.</p><h2>Execution Context</h2><p>JavaScript is a single threaded language, meaning only one task can be executed at a time. When the JavaScript interpreter initially executes code, it first enters into a global execution context by default. Each invocation of a function from this point on will result in the creation of a new execution context. </p><p>This is where confusion often sets in, the term "execution context" is actually for all intents and purposes referring more to scope and not context as previously discussed. It is an unfortunate naming convention, however it is the terminology as defined by the ECMAScript specification, so we're kinda stuck with it.</p><p> Each time a new execution context is created it is appended to the top of the <em>execution stack</em>. The browser will always execute the current execution context that is atop the execution stack. Once completed, it will be removed from the top of the stack and control will return to the execution context below. </p><p>An execution context can be divided into a creation and execution phase. In the creation phase, the interpreter will first create a <em>variable object</em> (also called an <em>activation object</em>) that is composed of all the variables, function declarations, and arguments defined inside the execution context. From there the <em>scope chain</em> is initialized next, and the value of <code>this</code> is determined last. Then in the execution phase, code is interpreted and executed. </p><h2>The Scope Chain</h2><p>For each execution context there is a scope chain coupled with it. The scope chain contains the variable object for every execution context in the execution stack. It is used for determining variable access and identifier resolution. For example:</p><div class= "code-block"><pre class="prettyprint lang-javascript"><span class="kwd">function</span><span class="pln"> first</span><span class="pun">(){</span><span class="pln">    second</span><span class="pun">();</span><span class="pln">    </span><span class="kwd">function</span><span class="pln"> second</span><span class="pun">(){</span><span class="pln">        third</span><span class="pun">();</span><span class="pln">        </span><span class="kwd">function</span><span class="pln"> third</span><span class="pun">(){</span><span class="pln">            fourth </span><span class="pun">();</span><span class="pln">            </span><span class="kwd">function</span><span class="pln"> fourth</span><span class="pun">(){</span><span class="pln"> </span><span class="com">// do something</span><span class="pln">            </span><span class="pun">}</span><span class="pln">        </span><span class="pun">} </span><span class="pln">    </span><span class="pun">}</span><span class="pln"></span><span class="pun">}</span><span class="pln">first</span><span class="pun">();</span></pre></div><p> Running the preceding code will result in the nested functions being executed all the way down to the <code>fourth</code> function. At this point the scope chain would be, from top to bottom: fourth, third, second, first, global. The <code>fourth</code> function would have access to global variables and any variables defined within the <code>first</code>, <code>second </code>, and <code>third</code> functions as well as the functions themselves. </p><p>Name conflicts amongst variables between different execution contexts are resolved by climbing up the scope chain, moving locally to globally. This means that local variables with the same name as variables higher up the scope chain take precedence. </p><p>To put it simply, each time you attempt to access a variable within a function's execution context, the look-up process will always begin with its own variable object. If the identifier is not found in the variable object, the search continues into the scope chain. It will climb up the scope chain examining the variable object of every execution context looking for a match to the variable name. </p><h2>Closures</h2><p>Accessing variables outside of the immediate lexical scope creates a closure. In other words, a closure is formed when a nested function is defined inside of another function, allowing access to the outer functions variables. Returning the nested function allows you to maintain access to the local variables, arguments, and inner function declarations of its outer function. This encapsulation allows us to hide and preserve the execution context from outside scopes while exposing a public interface and thus is subject to further manipulation. A simple example of this looks like the following:</p><div class="code-block"><pre class="prettyprint lang-javascript"><span class="kwd">function</span><span class= "pln"> foo</span><span class="pun">(){</span><span class="pln">    </span><span class="kwd">var</span><span class="pln"> localVariable </span><span class="pun">=</span><span class="pln"> </span><span class="str">'private variable'</span><span class="pun">;</span><span class="pln">    </span><span class="kwd">return</span><span class="pln"> </span><span class="kwd">function </span><span class="pln"> bar</span><span class="pun">(){</span><span class="pln">        </span><span class="kwd">return</span><span class="pln"> localVariable</span><span class="pun">; </span><span class="pln">    </span><span class="pun">}</span><span class="pln"></span><span class="pun">}</span><span class="pln"></span><span class="kwd">var</span><span class="pln"> getLocalVariable </span><span class="pun">=</span><span class="pln"> foo</span><span class="pun">();</span><span class="pln">getLocalVariable</span><span class="pun">()</span><span class= "pln"> </span><span class="com">// private variable</span></pre></div><p>One of the most popular types of closures is what is widely known as the <em>module pattern</em>; it allows you to emulate public, private, and privileged members:</p><div class="code-block"><pre class="prettyprint lang-javascript"><span class="kwd">var</span><span class="pln"> </span><span class="typ" >Module</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">function</span><span class="pun">(){</span><span class="pln">    </span><span class="kwd">var</span><span class="pln"> privateProperty </span><span class="pun">=</span><span class="pln"> </span><span class="str">'foo'</span><span class= "pun">;</span><span class="pln">    </span><span class="kwd">function</span><span class="pln"> privateMethod</span><span class="pun">(</span><span class="pln">args</span><span class="pun"> ){</span><span class="pln">        </span><span class="com">// do something</span><span class="pln">    </span><span class="pun">}</span><span class="pln">    </span><span class="kwd"> return</span><span class="pln"> </span><span class="pun">{</span><span class="pln">        publicProperty</span><span class="pun">:</span><span class="pln"> </span><span class="str">'' </span><span class="pun">,</span><span class="pln">        publicMethod</span><span class="pun">:</span><span class="pln"> </span><span class="kwd">function</span><span class="pun">( </span><span class="pln">args</span><span class="pun">){</span><span class="pln">            </span><span class="com">// do something</span><span class="pln">        </span><span class= "pun">},</span><span class="pln">        privilegedMethod</span><span class="pun">:</span><span class="pln"> </span><span class="kwd">function</span><span class="pun">(</span><span class= "pln">args</span><span class="pun">){</span><span class="pln">            </span><span class="kwd">return</span><span class="pln"> privateMethod</span><span class="pun">(</span><span class ="pln">args</span><span class="pun">);</span><span class="pln">        </span><span class="pun">}</span><span class="pln">    </span><span class="pun">};</span><span class="pln" ></span><span class="pun">})();</span></pre></div><p>The module acts as if it were a singleton, executed as soon as the compiler interprets it, hence the opening and closing parenthesis at the end of the function. The only available members outside of the execution context of the closure are your public methods and properties located in the return object (<code> Module.publicMethod</code> for example). However, all private properties and methods will live throughout the life of the application as the execution context is preserved, meaning variables are subject to further interaction via the public methods. </p><p>Another type of closure is what is called an immediately-invoked function expression (IIFE) which is nothing more than a self-invoked anonymous function executed in the context of the window:</p><div class="code-block"><pre class="prettyprint lang-javascript"><span class="pun">(</span><span class ="kwd">function</span><span class="pun">(</span><span class="pln">window</span><span class="pun">){</span><span class="pln">    </span><span class="kwd">var</span><span class="pln"> foo </span><span class="pun">,</span><span class="pln"> bar</span><span class="pun">;</span><span class="pln">    </span><span class="kwd">function</span><span class="pln"> </span><span class= "kwd">private</span><span class="pun">(){</span><span class="pln">        </span><span class="com">// do something</span><span class="pln">    </span><span class="pun">}</span><span class= "pln">    window</span><span class="pun">.</span><span class="typ">Module</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="pun">{ </span><span class="pln">        </span><span class="kwd">public</span><span class="pun">:</span><span class="pln"> </span><span class="kwd">function</span><span class="pun">(){ </span><span class="pln">            </span><span class="com">// do something </span><span class="pln">        </span><span class="pun">}</span><span class="pln">    </span><span class= "pun">};</span><span class="pln"></span><span class="pun">})(</span><span class="kwd">this</span><span class="pun">);</span></pre></div><p>This expression is most useful when attempting to preserve the global namespace as any variables declared within the function body will be local to the closure but will still live throughout runtime. This is a popular means of encapsulating source code for applications and frameworks, typically exposing a single global interface in which to interact with.</p><h2>Call and Apply</h2><p>These two methods inherent to all functions allow you to execute any function in any desired context. This makes for incredibly powerful capabilities. The <code>call</code> function requires the arguments to be listed explicitly while the <code>apply</code> function allows you to provide the arguments as an array:</p><div class="code-block"><pre class="prettyprint lang-javascript"><span class= "kwd">function</span><span class="pln"> user</span><span class="pun">(</span><span class="pln">firstName</span><span class="pun">,</span><span class="pln"> lastName</span><span class="pun" >,</span><span class="pln"> age</span><span class="pun">){</span><span class="pln">    </span><span class="com">// do something </span><span class="pln"></span><span class="pun">} </span><span class="pln">user</span><span class="pun">.</span><span class="pln">call</span><span class="pun">(</span><span class="pln">window</span><span class="pun">,</span><span class= "pln"> </span><span class="str">'John'</span><span class="pun">,</span><span class="pln"> </span><span class="str">'Doe'</span><span class="pun">,</span><span class="pln"> </span><span class="lit">30</span><span class="pun">);</span><span class="pln">user</span><span class="pun">.</span><span class="pln">apply</span><span class="pun">(</span><span class="pln">window </span><span class="pun">,</span><span class="pln"> </span><span class="pun">[</span><span class="str">'John'</span><span class="pun">,</span><span class="pln"> </span><span class="str"> 'Doe'</span><span class="pun">,</span><span class="pln"> </span><span class="lit">30</span><span class="pun">]);</span></pre></div><p>The result of both calls is exactly the same, the <code>user</code> function is invoked in the context of the window and provided the same three arguments.</p><p>ECMAScript 5 (ES5) introduced the <code>Function.prototype.bind</code> method that is used for manipulating context. It returns a new function which is permanently bound to the first argument of <code>bind</code> regardless of how the function is being used. It works by using a closure that is responsible for redirecting the call in the appropriate context. See the following polyfill for unsupported browsers:</p><div class="code-block"><pre class="prettyprint lang-javascript"><span class="kwd">if</span><span class="pun">(!(</span><span class="str">'bind'</span><span class="pln"> </span><span class="kwd">in</span><span class= "pln"> </span><span class="typ">Function</span><span class="pun">.</span><span class="pln">prototype</span><span class="pun">)){</span><span class="pln">    </span><span class="typ"> Function</span><span class="pun">.</span><span class="pln">prototype</span><span class="pun">.</span><span class="pln">bind </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">function</span><span class="pun">(){</span><span class="pln">        </span><span class="kwd">var</span><span class="pln"> fn </span><span class="pun">=</span><span class= "pln"> </span><span class="kwd">this</span><span class="pun">,</span><span class="pln">        context </span><span class="pun">=</span><span class="pln"> arguments</span><span class="pun" >[</span><span class="lit">0</span><span class="pun">],</span><span class="pln">        args </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Array</span><span class="pun">.</span><span class="pln">prototype</span><span class="pun">.</span><span class="pln">slice</span><span class="pun">.</span><span class="pln">call</span><span class="pun">( </span><span class="pln">arguments</span><span class="pun">,</span><span class="pln"> </span><span class="lit">1</span><span class="pun">);</span><span class="pln">        </span><span class="kwd">return</span><span class="pln"> </span><span class="kwd">function</span><span class="pun">(){</span><span class="pln">            </span><span class="kwd">return</span><span class="pln"> fn</span><span class="pun">.</span><span class="pln">apply</span><span class="pun">(</span><span class="pln">context</span><span class="pun">,</span><span class="pln"> args </span><span class="pun">.</span><span class="pln">concat</span><span class="pun">([].</span><span class="pln">slice</span><span class="pun">.</span><span class="pln">call</span><span class="pun">(</span><span class="pln">arguments</span><span class="pun">)));</span><span class="pln">        </span><span class="pun">}</span><span class="pln">    </span><span class="pun" >}</span><span class="pln"></span><span class="pun">}</span></pre></div><p>It is commonly used where context is commonly lost; object-orientation and event handling. This is necessary because the <code>addEventListener</code> method of a node will always execute the callback in the context of the node the event handler is bound to, which is the way it should be. However if your employing advanced object-oriented techniques and require your callback to be a method of an instance, you will be required to manually adjust the context, this is where <code>bind</code> comes in handy:</p><div class="code-block"><pre class="prettyprint lang-javascript"><span class="kwd">function</span><span class="pln"> </span><span class="typ">MyClass </span><span class="pun">(){</span><span class="pln">    </span><span class="kwd">this</span><span class="pun">.</span><span class="pln">element </span><span class="pun">=</span><span class="pln"> document</span><span class="pun">.</span><span class="pln">createElement</span><span class="pun">(</span><span class="str">'div'</span><span class="pun">);</span><span class= "pln">    </span><span class="kwd">this</span><span class="pun">.</span><span class="pln">element</span><span class="pun">.</span><span class="pln">addEventListener</span><span class="pun" >(</span><span class="str">'click'</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">this</span><span class="pun">.</span><span class="pln">onClick</span><span class="pun">.</span><span class="pln">bind</span><span class="pun">(</span><span class="kwd">this</span><span class="pun">),</span><span class="pln"> </span><span class="kwd">false </span><span class="pun">);</span><span class="pln"></span><span class="pun">}</span><span class="pln"></span><span class="typ">MyClass</span><span class="pun">.</span><span class="pln"> prototype</span><span class="pun">.</span><span class="pln">onClick </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">function</span><span class="pun">( </span><span class="pln">e</span><span class="pun">){</span><span class="pln">    </span><span class="com">// do something</span><span class="pln"></span><span class="pun">}; </span></pre></div><p>While reviewing the source of the polyfill for <code>Function.prototype.bind</code> function, you may have noticed 2 invocations involving the <code>slice</code> method of an <code>Array</code>:</p><div class="code-block"><pre class="prettyprint lang-javascript"><span class="typ">Array</span><span class="pun">.</span><span class="pln">prototype </span><span class="pun">.</span><span class="pln">slice</span><span class="pun">.</span><span class="pln">call</span><span class="pun">(</span><span class="pln">arguments</span><span class="pun">,</span><span class="pln"> </span><span class="lit">1</span><span class="pun">);</span><span class="pln"></span><span class="pun">[].</span><span class="pln">slice</span><span class="pun">.</span><span class="pln">call</span><span class="pun">(</span><span class="pln">arguments</span><span class="pun">);</span></pre></div><p>What is interesting to note here is that the <code>arguments</code> object is not actually an array at all, however it is often described as an array-like object much like a nodelist (anything returned by <code> element.childNodes</code>). They contain a length property and indexed values but they are still not arrays, and subsequently don't support any of the native methods of arrays such as <code>slice</code> and <code>push</code>. However, because of their similar behavior, the methods of <code>Array</code> can be adopted or hijacked, if you will, and executed in the context of an array-like object as is the case above. </p><p>This technique of adopting another object's methods also applies to object-orientation when emulating classical based inheritance in JavaScript: </p><div class="code-block"><pre class="prettyprint lang-javascript"><span class="typ">MyClass</span><span class="pun">.</span><span class="pln">prototype </span><span class="pun">.</span><span class="pln">init </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">function</span><span class="pun">(){</span><span class= "pln">    </span><span class="com">// call the superclass init method in the context of the "MyClass" instance</span><span class="pln">    </span><span class="typ">MySuperClass</span><span class="pun">.</span><span class="pln">prototype</span><span class="pun">.</span><span class="pln">init</span><span class="pun">.</span><span class="pln">apply</span><span class="pun">( </span><span class="kwd">this</span><span class="pun">,</span><span class="pln"> arguments</span><span class="pun">);</span><span class="pln"></span><span class="pun">} </span></pre></div><p>By invoking the method of the superclass (<code>MySuperClass</code>) in the context of an instance of a subclass (<code>MyClass</code>), we can mimic the ability of calling a method's super to fully exploit this powerful design pattern.</p><h2>Conclusion</h2><p>It is important to understand these concepts before you begin to approach advanced design patterns, as scope and context play a fundamental role in modern JavaScript. Whether were talking about closures, object-orientation and inheritance, or various native implementations, context and scope play a significant role in all of them. If your goal is to master the JavaScript language and better understand all it encompasses than scope and context should be one of your starting points.</p>        </section>			</div>		<!--=========================			END : POST		=============================--> <!--=========================			START : POST		=============================-->		<div class="post-wrapper"><div class="span8">        <h2 class="section-header"> Explaining function and variable hoisting in JavaScript</h2><p>Perhaps one of the most potentially confusing aspects of JavaScript is its scoping mechanism. If you don't fully understand what's going on, you can easily run into all sorts of difficulties. Key to understanding how scope in JavaScript works is understanding the concept of hoisting.</p><p>Let's jump straight in with an example:</p><div class="highlight"><pre><code class="javascript"><span class="kd">var</span> <span class="nx">x</span> <span class="o">=</span> <span class="mi">10</span><span class="p">;</span><span class="kd">function</span> <span class="nx">y</span><span class="p">()</span> <span class="p">{</span>    <span class="nx">console</span><span class="p">. </span><span class="nx">log</span><span class="p">(</span><span class="nx">x</span><span class="p">);</span> <span class="c1">//Prints undefined</span>    <span class="kd">var</span> <span class="nx">x</span> <span class="o">=</span> <span class="mi">20</span><span class="p">;</span>    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">x</span><span class="p">);</span> <span class="c1">//Prints 20</span><span class="p">}</span><span class="nx">y</span><span class="p">();</span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">x</span><span class="p">);</span> <span class="c1">//Prints 10 </span></code></pre></div><p></p><p>On the first line in that snippet we declare a variable, <span class="code">x</span>, and assign it the value <span class="code">10</span>. We then define a function, in which we try and output the value of <span class="code">x</span>. If you understand the basics of scope in JavaScript then you should be well aware that variables declared in the parent scope of a function are accessible inside that function. Going by that logic, it could fairly be assumed that the first <span class="code">console.log</span> statement would print <span class="code">10</span>, since that's what we assigned to <span class="code">x</span> just before we called the function.</p><p>However, the second line of that function body causes things to change. If you remove that line, the first <span class="code">console.log</span> call does indeed print <span class="code">10</span>. So, why does that line affect us in this way? Well, variable declarations in JavaScript are <em>hoisted</em> to the top of their scope. That means the above snippet is effectively interpreted like this:</p><div class="highlight"><pre><code class="javascript"><span class="kd">var</span> <span class="nx">x</span><span class="p">;</span> <span class="c1">//Declaration of x is hoisted (x is undefined)</span><span class="nx">x</span> <span class="o">=</span> <span class="mi">10</span><span class="p">;</span> <span class="c1">//Assignment still occurs where we intended (x is 10)</span><span class="kd">function</span> <span class="nx">y</span><span class="p">()</span> <span class="p">{</span>    <span class="kd">var</span> <span class="nx">x</span><span class= "p">;</span> <span class="c1">//Declaration of a different variable named x is hoisted (x is undefined)</span>    <span class="nx">console</span><span class="p">.</span><span class="nx"> log</span><span class="p">(</span><span class="nx">x</span><span class="p">);</span> <span class="c1">//Prints undefined</span>    <span class="nx">x</span> <span class="o">=</span> <span class="mi">20</span><span class="p">;</span> <span class="c1">//Assignment (x is 20)</span>    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class ="p">(</span><span class="nx">x</span><span class="p">);</span> <span class="c1">//Prints 20</span><span class="p">}</span><span class="nx">y</span><span class="p">();</span><span class= "nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">x</span><span class="p">);</span> <span class="c1">//The variable named x in the outer scope still contains 10</span></code></pre></div><p></p><p>That simple example should be enough to demonstrate the concept of hoisting as it applies to variable declarations. A couple of important point to remember.</p><p>First, we only observe the "strange" behaviour in the above snippet because we've declared a new variable with the same name as one in an outer scope. The new variable shadows the other so we see <span class="code">undefined</span> as the output of the second log.</p><p></p><p>Second is that it's the <em>declaration</em> itself that gets hoisted, not the assignment. Assignments will happen at the point you expect when you write them. That's particularly important to bear in mind as we move on to look at function hoisting.</p><p>With functions, the concept is the same. That is, function declarations are hoisted to the top of the scope in which they are defined. This means it's possible to call a function before it's actually been declared in your code. For example:</p><div class="highlight"><pre><code class="javascript"><span class="nx">sayHello</span><span class="p">(); </span> <span class="c1">//Calling the function before it's been declared</span><span class="kd">function</span> <span class="nx">sayHello</span><span class="p">()</span> <span class="p">{ </span>    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">"Hi!"</span><span class="p">);</span><span class="p">} </span></code></pre></div><p></p><p>Again, that should be pretty self explanatory if you've followed the article this far. The function declaration, including the function body, is hoisted to the top of its scope, so it's available on the first line of our example to be called.</p><p>Now remember that important second point when we were talking about variable hoisting. As I'm sure you're aware, JavaScript has function <em>expressions</em>, as well as the function declarations mentioned above:</p><div class="highlight"><pre><code class= "javascript"><span class="nx">sayHello</span><span class="p">();</span> <span class="c1">//Uh-oh... TypeError, undefined is not a function!</span><span class="kd">var</span> <span class= "nx">sayHello</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>    <span class="nx">console</span><span class="p">. </span><span class="nx">log</span><span class="p">(</span><span class="s2">"Hi!"</span><span class="p">);</span><span class="p">};</span></code></pre></div><p></p><p>So why did that last example fail? If you think about it, it's quite obvious really. We know that variable declarations are hoisted, and we know that function declarations are hoisted. A function expression is effectively a variable declaration and an assignment. The variable declaration is hoisted, but the assignment stays where it is, resulting in something like this:</p><div class= "highlight"><pre><code class="javascript"><span class="kd">var</span> <span class="nx">sayHello</span><span class="p">;</span><span class="nx">sayHello</span><span class="p">();</span> <span class="c1">//Uh-oh... TypeError, undefined is not a function!</span><span class="nx">sayHello</span> <span class="o">=</span> <span class="kd">function</span><span class="p">() </span> <span class="p">{</span>    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">"Hi!"</span><span class="p"> );</span><span class="p">};</span></code></pre></div><p></p><p>And that's pretty much all there is to it! If you've made it to the end of this article you should have a decent understanding of how JavaScript hoists variable and function declarations and will be able to quickly eliminate that next time you run into an awkward scoping bug in your code.</p> </div>			</div>		<!--=========================			END : POST		=============================-->		<!--=========================			START : POST =============================-->		<div class="post-wrapper">		<h1 class="post-title">True Hash Maps in JavaScript</h1>		<section class="post-content">        	<p>Using an object literal as a simple means to storing key-value pairs is common place within JavaScript. However, an object literal is not a true hash map and therefore poses potential liabilities if used in the wrong manner. While JavaScript may not offer native hash maps (at least not cross-browser), there is a superior alternative to object literals to capture the desired functionality without the pitfalls.<span id="more-665"></span></p><h2>The Problem with Object Literals</h2><p>The problem resides in the prototype chain of object literals as the <a href=" https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/prototype#Properties">properties and methods</a> inherited from the <code>Object</code> prototype can clash with the mechanisms used to assert the existence of a key. Take for instance the <code>toString</code> method, checking the existence of a key with the same name using the <code> in</code> operator will result in a false positive:</p><div class="code-block"><pre class="prettyprint lang-javascript"><span class="kwd">var</span><span class="pln"> map </span><span class="pun">=</span><span class="pln"> </span><span class="pun">{};</span><span class="pln"></span><span class="str">'toString'</span><span class="pln"> </span><span class="kwd">in </span><span class="pln"> map</span><span class="pun">;</span><span class="pln"> </span><span class="com">// true</span></pre></div><p>This happens because the <code>in</code> operator looks up the object's prototype chain to find inherited properties, in this case the <code>toString</code> method. To resolve this, the <code>hasOwnProperty</code> method was conceived which only looks for the existence of a specified key as a direct property of an object:</p><div class="code-block"><pre class="prettyprint lang-javascript"><span class="kwd">var </span><span class="pln"> map </span><span class="pun">=</span><span class="pln"> </span><span class="pun">{};</span><span class="pln">map</span><span class="pun">.</span><span class="pln" >hasOwnProperty</span><span class="pun">(</span><span class="str">'toString'</span><span class="pun">);</span><span class="pln"> </span><span class="com">// false</span></pre></div><p> This works fine until you encounter a key named "hasOwnProperty". Overwriting this method would cause further attempts to invoke the <code>hasOwnProperty</code> method to result in unexpected behavior, most likely an error depending on the new value:</p><div class="code-block"><pre class="prettyprint lang-javascript"><span class="kwd">var</span><span class="pln"> map </span><span class="pun">=</span><span class="pln"> </span><span class="pun">{};</span><span class="pln">map</span><span class="pun">.</span><span class="pln">hasOwnProperty </span><span class="pun">=</span><span class="pln"> </span><span class="str">'foo'</span><span class="pun">;</span><span class="pln">map</span><span class="pun">.</span><span class="pln"> hasOwnProperty</span><span class="pun">(</span><span class="str">'hasOwnproperty'</span><span class="pun">);</span><span class="pln"> </span><span class="com">// TypeError </span></pre></div><p>A quick fix for this is leveraging a generic object literal, one that hasn't been tampered with, and executing it's <code>hasOwnProperty</code> method in the context of your hash map:</p><div class="code-block"><pre class="prettyprint lang-javascript"><span class="kwd">var</span><span class="pln"> map </span><span class="pun">=</span><span class="pln"> </span><span class="pun">{};</span><span class="pln">map</span><span class="pun">.</span><span class="pln">hasOwnProperty </span><span class="pun">=</span><span class="pln"> </span><span class="str">'foo'</span><span class="pun">;</span><span class="pln"></span><span class="pun">{}.</span><span class="pln">hasOwnProperty</span><span class="pun">.</span><span class="pln"> call</span><span class="pun">(</span><span class="pln">map</span><span class="pun">,</span><span class="pln"> </span><span class="str">'hasOwnproperty'</span><span class="pun">); </span><span class="pln"> </span><span class="com">// true</span></pre></div><p>This works without any issues, but nevertheless, the object still imposes restrictions on how it can be utilized. For instance, every time you wanted to enumerate the properties of the object within a <code>for ... in</code> loop, you would need to filter out the properties of the prototype chain:</p><div class="code-block"><pre class="prettyprint lang-javascript"><span class="kwd">var</span><span class="pln"> map </span><span class="pun">=</span><span class="pln"> </span><span class="pun">{};</span><span class="pln"></span><span class="kwd">var</span><span class="pln"> has </span><span class="pun">=</span><span class="pln"> </span><span class="pun"> {}.</span><span class="pln">hasOwnProperty</span><span class="pun">;</span><span class="pln"></span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">var</span><span class="pln"> key </span><span class="kwd">in</span><span class="pln"> map</span><span class="pun">){</span><span class="pln">    </span><span class="kwd">if</span><span class="pun">( </span><span class="pln">has</span><span class="pun">.</span><span class="pln">call</span><span class="pun">(</span><span class="pln">map</span><span class="pun">,</span><span class="pln"> key</span><span class="pun">)){</span><span class="pln">        </span><span class="com">// do something</span><span class="pln">    </span><span class="pun">}</span><span class="pln" ></span><span class="pun">}</span></pre></div><p>This can become a bit tedious after awhile. Thankfully, there is a better way.</p><h2>Bare Objects</h2><p>The secret to creating a true hash map is loosing the prototype all together, and the baggage that comes with it. To do this we can take advantage of the <code>Object.create</code> method <a href=" http://www.ecma-international.org/ecma-262/5.1/#sec-15.2.3.5">introduced in ES5</a>. What's unique about this method is that you can explicitly define the prototype for a new object. For example, defining a plain object literal with a little more verbosity:</p><div class="code-block"><pre class="prettyprint lang-javascript"><span class="kwd">var</span><span class="pln"> obj </span><span class="pun">=</span><span class="pln"> </span><span class="pun">{};</span><span class="pln"></span><span class="com">// is equivalent to:</span><span class="pln" ></span><span class="kwd">var</span><span class="pln"> obj </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Object</span><span class="pun">.</span><span class= "pln">create</span><span class="pun">(</span><span class="typ">Object</span><span class="pun">.</span><span class="pln">prototype</span><span class="pun">);</span></pre></div><p>In addition to defining a prototype of your choosing, you can also forgo a prototype completely by passing a <code>null</code> value in place of a prototype object:</p><div class="code-block" ><pre class="prettyprint lang-javascript"><span class="kwd">var</span><span class="pln"> map </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Object</span><span class="pun">.</span><span class="pln">create</span><span class="pun">(</span><span class="kwd">null</span><span class="pun">);</span><span class="pln">map </span><span class="kwd"> instanceof</span><span class="pln"> </span><span class="typ">Object</span><span class="pun">;</span><span class="pln"> </span><span class="com">// false</span><span class="pln" ></span><span class="typ">Object</span><span class="pun">.</span><span class="pln">prototype</span><span class="pun">.</span><span class="pln">isPrototypeOf</span><span class="pun">( </span><span class="pln">map</span><span class="pun">);</span><span class="pln"> </span><span class="com">// false</span><span class="pln"></span><span class="typ">Object</span><span class ="pun">.</span><span class="pln">getPrototypeOf</span><span class="pun">(</span><span class="pln">map</span><span class="pun">);</span><span class="pln"> </span><span class="com">// null </span></pre></div><p>These <em>bare</em> (aka <em>dictionary</em>) objects are ideal for hash maps because the absence of a <code>[[Prototype]]</code> removes the risk of name conflicts. Since the object is completely void of any methods or properties, it will resist any type of coercion, attempting to do so would result in an error:</p><div class="code-block"><pre class= "prettyprint lang-javascript"><span class="kwd">var</span><span class="pln"> map </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Object</span><span class="pun" >.</span><span class="pln">create</span><span class="pun">(</span><span class="kwd">null</span><span class="pun">);</span><span class="pln">map </span><span class="pun">+</span><span class ="pln"> </span><span class="str">""</span><span class="pun">;</span><span class="pln"> </span><span class="com">// TypeError: Cannot convert object to primitive value</span></pre></div><p> There is no primitive value or string representation because bare objects are not intended to be used for anything other than a key-value store, plain and simple. This serves to rationalize its distinct purpose. </p><p>Keep in mind that the <code>hasOwnProperty</code> method is also lost to the bare object, which is okay because the <code>in</code> operator now works without any exceptions:</p><div class="code-block"><pre class="prettyprint lang-javascript"><span class="kwd">var</span><span class="pln"> map </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Object</span><span class="pun">.</span><span class="pln">create</span><span class="pun">(</span><span class="kwd">null</span><span class="pun">); </span><span class="pln"></span><span class="str">'toString'</span><span class="pln"> </span><span class="kwd">in</span><span class="pln"> map</span><span class="pun">;</span><span class= "pln"> </span><span class="com">// false</span></pre></div><p>Better yet, those tedious <code>for ... in</code> loops become much simpler. We can finally write a loop the way it was meant to be:</p><div class="code-block"><pre class="prettyprint lang-javascript"><span class="kwd">var</span><span class="pln"> map </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Object</span><span class="pun">.</span><span class="pln">create</span><span class="pun">(</span><span class="kwd">null</span><span class="pun">);</span><span class ="pln"></span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">var</span><span class="pln"> key </span><span class="kwd">in</span><span class="pln"> map</span><span class="pun">){</span><span class="pln">    </span><span class="com">// do something</span><span class="pln"></span><span class="pun">}</span></pre></div><p>Despite the differences, for all intents and purposes, it still behaves much like an object literal. Properties can be accessed using dot or bracket notation, the object can be stringified, and the object can still be employed as the context of a method from the <code>Object</code> prototype:</p><div class="code-block"><pre class="prettyprint lang-javascript"><span class="kwd">var</span><span class= "pln"> map </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Object</span><span class="pun">.</span><span class="pln">create</span><span class="pun">( </span><span class="kwd">null</span><span class="pun">);</span><span class="pln"></span><span class="typ">Object</span><span class="pun">.</span><span class="pln">defineProperties </span><span class="pun">(</span><span class="pln">map</span><span class="pun">,</span><span class="pln"> </span><span class="pun">{</span><span class="pln">    </span><span class="str"> 'foo'</span><span class="pun">:</span><span class="pln"> </span><span class="pun">{</span><span class="pln">        value</span><span class="pun">:</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln">        enumerable</span><span class="pun">:</span><span class="pln"> </span><span class="kwd">true</span><span class="pln"> </span><span class="pun">},</span><span class="pln">    </span><span class="str">'bar'</span><span class="pun">:</span><span class="pln"> </span><span class="pun">{</span><span class= "pln">        value</span><span class="pun">:</span><span class="pln"> </span><span class="lit">2</span><span class="pun">,</span><span class="pln">        enumerable</span><span class= "pun">:</span><span class="pln"> </span><span class="kwd">false</span><span class="pln">    </span><span class="pun">}</span><span class="pln"></span><span class="pun">});</span><span class="pln">map</span><span class="pun">.</span><span class="pln">foo</span><span class="pun">;</span><span class="pln"> </span><span class="com">// 1</span><span class="pln">map </span><span class="pun">[</span><span class="str">'bar'</span><span class="pun">];</span><span class="pln"> </span><span class="com">// 2</span><span class="pln">JSON</span><span class= "pun">.</span><span class="pln">stringify</span><span class="pun">(</span><span class="pln">map</span><span class="pun">);</span><span class="pln"> </span><span class="com">// {"foo":1} </span><span class="pln"></span><span class="pun">{}.</span><span class="pln">hasOwnProperty</span><span class="pun">.</span><span class="pln">call</span><span class="pun">(</span><span class="pln">map</span><span class="pun">,</span><span class="pln"> </span><span class="str">'foo'</span><span class="pun">);</span><span class="pln"> </span><span class="com">// true </span><span class="pln"></span><span class="pun">{}.</span><span class="pln">propertyIsEnumerable</span><span class="pun">.</span><span class="pln">call</span><span class="pun">( </span><span class="pln">map</span><span class="pun">,</span><span class="pln"> </span><span class="str">'bar'</span><span class="pun">);</span><span class="pln"> </span><span class="com"> // false</span></pre></div><p>Even different methods of type checking will indicate what you would expect from an object literal:</p><div class="code-block"><pre class="prettyprint lang-javascript"><span class="kwd">var</span><span class="pln"> map </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Object</span><span class="pun">. </span><span class="pln">create</span><span class="pun">(</span><span class="kwd">null</span><span class="pun">);</span><span class="pln"></span><span class="kwd">typeof</span><span class= "pln"> map</span><span class="pun">;</span><span class="pln"> </span><span class="com">// object</span><span class="pln"></span><span class="pun">{}.</span><span class="pln">toString </span><span class="pun">.</span><span class="pln">call</span><span class="pun">(</span><span class="pln">map</span><span class="pun">);</span><span class="pln"> </span><span class="com"> // [object Object]</span><span class="pln"></span><span class="pun">{}.</span><span class="pln">valueOf</span><span class="pun">.</span><span class="pln">call</span><span class="pun">( </span><span class="pln">map</span><span class="pun">);</span><span class="pln"> </span><span class="com">// Object {}</span></pre></div><p>All this makes it simple to replace object literals with bare objects and have them integrate nicely into a pre-existing application without forcing wide spread changes. </p><h2>Conclusion</h2><p>In the context of simple key-value stores, a bare object is the clear successor to object literals, helping to alleviate the quirks with a clearly defined purpose. For more fully-featured data structures, ES6 will introduce native hash maps in the form of the <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Map">Map</a> and <a href=" https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Set">Set</a> objects, among others. Until then, or even after, you should look to bare objects for all your basic hash map needs.</p>        </section>			</div>		<!--=========================			END : POST		=============================--> <!--=========================			START : POST		=============================-->		<div class="post-wrapper">		<h1 class="post-title">Using Mutation Observers to Watch for Element Availability</h1>		<section class="post-content">        	<p>Many developers have become accustomed to using some variant of a DOM ready method to signify when they can begin to traverse and manipulate the DOM. Or, better yet, placing the scripts at the bottom of the HTML to avoid blocking render while ensuring the DOM is loaded when the JavaScript is executed. However, in this day and age of dynamic web applications, it seems like a rather antiquated approach. The DOM is not static, it is alive and subject to manipulation long after the initial page load. Simply knowing when the DOM is ready, while still useful, does not encompass the entirely of the desired functionality. Instead, how about watching for when specific elements become available throughout the course of runtime? Well, I intend to offer a solution to support exactly that kind of functionality using <a href=" https://developer.mozilla.org/en/docs/Web/API/MutationObserver">mutation observers</a> as the means to a more modern approach.<span id="more-619"></span></p><h2>Mutation Observers</h2><p> The <a href="http://www.w3.org/TR/dom/#mutation-observers">W3C DOM4 specification</a> initially introduced mutation observers as a replacement for the deprecated <a href=" https://developer.mozilla.org/en-US/docs/Web/Guide/Events/Mutation_events">mutation events</a>. The new specification essentially permits the same functionality, but with some added benefits. Most notably is that mutation observers are asynchronous, and will invoke the callback after a batch of changes rather than every single change. This allows mutation observers to operate in a more performant manner, one of the pitfalls of mutation events, <a href="http://lists.w3.org/Archives/Public/public-webapps/2011JulSep/0779.html">among others</a>.</p><p> Mutations that can be observed include the addition and removal of child nodes, changes to attributes, and updates to text nodes. For the purposes of this article, we want to focus on the addition of elements into the DOM. For this, we need to create a new instance of <code>MutationObserver</code> passing the callback function as the only argument. Then we invoke the <code> observe</code> method with the element we want to be observed and a configuration object as the first and second arguments:</p><div class="code-block"><pre class="prettyprint lang-javascript"><span class="kwd">var</span><span class="pln"> observer </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">MutationObserver</span><span class="pun">(</span><span class="pln">callback</span><span class="pun">);</span><span class="pln">observer</span><span class="pun">. </span><span class="pln">observe</span><span class="pun">(</span><span class="pln">document</span><span class="pun">.</span><span class="pln">documentElement</span><span class="pun">, </span><span class="pln"> </span><span class="pun">{</span><span class="pln">    childList</span><span class="pun">:</span><span class="pln"> </span><span class="kwd">true</span><span class="pun">,</span><span class="pln">    subtree</span><span class="pun">:</span><span class="pln"> </span><span class="kwd">true</span><span class="pln"></span><span class="pun">}); </span></pre></div><p>The <code>childList</code> configuration option causes the observer to monitor the DOM for any nodes added or removed from the <code>documentElement</code>. The <code>subtree</code> option will additionally allow every child node of the <code>documentElement</code> to be monitored for these same changes. This gives us the means to detecting element insertion anywhere in the DOM, which bodes well for our purposes. The next step is to formulate the solution.</p><h2>Watching for Desired Element Availability</h2><p>The solution supports detecting element readiness on the initial page load as well as elements dynamically appended to the DOM. The code in full is as follows:</p><div class="code-block"><pre class= "prettyprint lang-javascript"><span class="pun">(</span><span class="kwd">function</span><span class="pun">(</span><span class="pln">win</span><span class="pun">){</span><span class="pln"> </span><span class="str">'use strict'</span><span class="pun">;</span><span class="pln">    </span><span class="kwd">var</span><span class="pln"> listeners </span><span class="pun">= </span><span class="pln"> </span><span class="pun">[],</span><span class="pln">    doc </span><span class="pun">=</span><span class="pln"> win</span><span class="pun">.</span><span class= "pln">document</span><span class="pun">,</span><span class="pln">    </span><span class="typ">MutationObserver</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> win</span><span class="pun">.</span><span class="typ">MutationObserver</span><span class="pln"> </span><span class="pun">||</span><span class="pln"> win</span><span class="pun">. </span><span class="typ">WebKitMutationObserver</span><span class="pun">,</span><span class="pln">    observer</span><span class="pun">;</span><span class="pln">    </span><span class= "kwd">function</span><span class="pln"> ready</span><span class="pun">(</span><span class="pln">selector</span><span class="pun">,</span><span class="pln"> fn</span><span class="pun">){ </span><span class="pln">        </span><span class="com">// Store the selector and callback to be monitored</span><span class="pln">        listeners</span><span class="pun">.</span><span class="pln">push</span><span class="pun">({</span><span class="pln">            selector</span><span class="pun">:</span><span class="pln"> selector</span><span class="pun">,</span><span class="pln">            fn</span><span class="pun">:</span><span class="pln"> fn        </span><span class="pun">});</span><span class="pln">        </span><span class="kwd">if</span><span class="pun">(!</span><span class="pln">observer</span><span class="pun">){</span><span class="pln">            </span><span class="com">// Watch for changes in the document</span><span class="pln">            observer </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">MutationObserver </span><span class="pun">(</span><span class="pln">check</span><span class="pun">);</span><span class="pln">            observer</span><span class="pun">.</span><span class="pln">observe </span><span class="pun">(</span><span class="pln">doc</span><span class="pun">.</span><span class="pln">documentElement</span><span class="pun">,</span><span class="pln"> </span><span class="pun">{</span><span class="pln">                childList</span><span class="pun">:</span><span class="pln"> </span><span class="kwd">true</span><span class="pun">,</span><span class ="pln">                subtree</span><span class="pun">:</span><span class="pln"> </span><span class="kwd">true</span><span class="pln">            </span><span class="pun">});</span><span class="pln">        </span><span class="pun">}</span><span class="pln">        </span><span class="com">// Check if the element is currently in the DOM</span><span class="pln"> check</span><span class="pun">();</span><span class="pln">    </span><span class="pun">}</span><span class="pln">    </span><span class="kwd">function</span><span class="pln"> check </span><span class="pun">(){</span><span class="pln">        </span><span class="com">// Check the DOM for elements matching a stored selector</span><span class="pln">        </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">var</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">,</span><span class="pln"> len </span><span class="pun">=</span><span class="pln"> listeners</span><span class="pun">.</span><span class="pln">length</span><span class="pun">, </span><span class="pln"> listener</span><span class="pun">,</span><span class="pln"> elements</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt; </span><span class="pln"> len</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++){</span><span class="pln">            listener </span><span class="pun">= </span><span class="pln"> listeners</span><span class="pun">[</span><span class="pln">i</span><span class="pun">];</span><span class="pln">            </span><span class="com">// Query for elements matching the specified selector</span><span class="pln">            elements </span><span class="pun">=</span><span class="pln"> doc</span><span class="pun">.</span><span class="pln">querySelectorAll</span><span class="pun">(</span><span class="pln">listener</span><span class="pun">.</span><span class="pln">selector</span><span class="pun">);</span><span class="pln">            </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">var</span><span class="pln"> j </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">,</span><span class="pln"> jLen </span><span class="pun">=</span><span class="pln"> elements</span><span class="pun">.</span><span class= "pln">length</span><span class="pun">,</span><span class="pln"> element</span><span class="pun">;</span><span class="pln"> j </span><span class="pun">&lt;</span><span class="pln"> jLen </span><span class="pun">;</span><span class="pln"> j</span><span class="pun">++){</span><span class="pln">                element </span><span class="pun">=</span><span class="pln"> elements</span><span class="pun">[</span><span class="pln">j</span><span class="pun">];</span><span class="pln">                </span><span class="com">// Make sure the callback isn't invoked with the </span><span class="pln">                </span><span class="com">// same element more than once</span><span class="pln">                </span><span class="kwd">if </span><span class="pun">(!</span><span class="pln">element</span><span class="pun">.</span><span class="pln">ready</span><span class="pun">){</span><span class="pln"> element</span><span class="pun">.</span><span class="pln">ready </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">true</span><span class="pun">;</span><span class="pln">                    </span><span class="com">// Invoke the callback with the element</span><span class="pln">                    listener</span><span class="pun">.</span><span class="pln">fn</span><span class="pun">.</span><span class="pln">call</span><span class="pun">(</span><span class="pln">element</span><span class="pun">,</span><span class="pln"> element </span><span class="pun">);</span><span class="pln">                </span><span class="pun">}</span><span class="pln">            </span><span class="pun">}</span><span class="pln"> </span><span class="pun">}</span><span class="pln">    </span><span class="pun">}</span><span class="pln">    </span><span class="com">// Expose `ready`</span><span class="pln"> win</span><span class="pun">.</span><span class="pln">ready </span><span class="pun">=</span><span class="pln"> ready</span><span class="pun">;</span><span class="pln"></span><span class="pun">})(</span><span class="kwd">this</span><span class="pun">);</span></pre></div><p>The <code>ready</code> function accepts a selector string as the first argument and the callback function as the second. Once ready, the callback is invoked, passing the element as the only parameter:</p><div class="code-block"><pre class="prettyprint lang-javascript"><span class="pln">ready</span><span class="pun">(</span><span class="str">'.foo'</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">function</span><span class="pun">( </span><span class="pln">element</span><span class="pun">){</span><span class="pln">    </span><span class="com">// do something</span><span class="pln"></span><span class="pun">}); </span></pre></div><p>What is important to note here is that a <code>ready</code> invocation is not a one-off binding. Instead, the callback lives throughout the life of the page, and is invoked any time an element matching the selector string is added to the DOM. If multiple elements matching the selector are added at once, the callback is invoked in succession for each element in document order.</p><h2>Conclusion</h2><p>This serves as a more robust and forward-thinking approach to initializing DOM traversal and manipulation than your typical DOM ready methods. Despite growing <a href="http://caniuse.com/#feat=mutationobserver">browser support for mutation observers</a>, some browsers such as IE 10 and below lack support. While it may be too early for widespread adoption, it could be a small window into the future of DOM initialization via JavaScript. View full documentation and download the source for this project on <a href="https://github.com/ryanmorr/ready">GitHub</a>.</p>        </section>			</div>		<!--=========================			END : POST =============================-->		<!--=========================			START : POST		=============================-->		<div class="post-wrapper">		<h1>What is the Execution Context &amp; Stack in JavaScript?</h1>		<div class="entry-content">						<p>In this post I will take an in-depth look at one of the most fundamental parts of JavaScript, the <code>Execution Context</code>.<span id="more-137"></span> By the end of this post, you should have a clearer understanding about what the interpreter is trying to do, why some functions / variables can be used before they are declared and how their value is really determined.</p><h2>What is the Execution Context?</h2><p>When code is run in JavaScript, the environment in which it is executed is very important, and is evaluated as 1 of the following:</p><ul style="margin-bottom: 20px;" class="square"><li><strong>Global code</strong> &ndash; The default envionment where your code is executed for the first time.</li><li><strong>Function code</strong> &ndash; Whenever the flow of execution enters a function body. </li><li><strong>Eval code</strong> &ndash; Text to be executed inside the internal eval function.</li></ul><p>You can read a lot of resources online that refer to <code>scope</code>, and for the purpose of this article to make things easier to understand, let's think of the term <code>execution context</code> as the envionment / scope the current code is being evaluated in. Now, enough talking, let's see an example that includes both <code>global</code> and <code>function / local</code> context evaluated code.</p><p><a href=" http://davidshariff.com/blog/wp-content/uploads/2012/06/img1.jpg"><img alt="" src="http://davidshariff.com/blog/wp-content/uploads/2012/06/img1.jpg" title="Execution Context" class= "alignnone size-full wp-image-145"></a></p><p>Nothing special is going on here, we have 1 <code>global context</code> represented by the purple border and 3 different <code>function contexts</code> represented by the green, blue and orange borders. There can only ever be 1 <code>global context</code>, which can be accessed from any other context in your program. </p><p>You can have any number of <code>function contexts</code>, and each function call creates a new context, which creates a private scope where anything declared inside of the function can not be directly accessed from outside the current function scope. In the example above, a function can access a variable declared outside of its current context, but an outside context can not access the variables / functions declared inside. Why does this happen? How exactly is this code evaluated?</p><h2 id="ecstack">Execution Context Stack</h2><p>The JavaScript interpreter in a browser is implemented as a single thread. What this actually means is that only 1 thing can ever happen at one time in the browser, with other actions or events being queued in what is called the <code>Execution Stack</code>. The diagram below is an abstract view of a single threaded stack:</p><p><a href=" http://davidshariff.com/blog/wp-content/uploads/2012/06/ecstack.jpg"><img width="555" height="288" alt="" src="http://davidshariff.com/blog/wp-content/uploads/2012/06/ecstack.jpg" title= "Execution Context Stack" class="size-full wp-image-152"></a></p><p>As we already know, when a browser first loads your script, it enters the <code>global execution context</code> by default. If, in your global code you call a function, the sequence flow of your program enters the function being called, creating a new <code>execution context</code> and pushing that context to the top of the <code>execution stack</code>.</p><p>If you call another function inside this current function, the same thing happens. The execution flow of code enters the inner function, which creates a new <code>execution context</code> that is pushed to the top of the existing stack. The browser will always execute the current <code>execution context </code> that sits on top of the stack, and once the function completes executing the current <code>execution context</code>, it will be popped off the top of the stack, returning control to the context below in the current stack. The example below shows a recursive function and the program's <code>execution stack</code>:</p><pre class=" language-javascript"><code class=" language-javascript"><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token function">foo<span class="token punctuation">(</span></span>i <span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">===</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">return </span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">else</span> <span class="token punctuation">{</span>        <span class="token function">foo<span class="token punctuation">(</span></span><span class="token operator">++</span>i<span class="token punctuation">)</span><span class="token punctuation">; </span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p><a href=" http://davidshariff.com/blog/wp-content/uploads/2012/06/es1.gif"><img width="390" height="259" alt="" src="http://davidshariff.com/blog/wp-content/uploads/2012/06/es1.gif" title= "Execution Stack" style="padding-bottom: 40px;" class="size-full wp-image-157 left"></a></p><p>The code simply calls itself 3 times, incrementing the value of i by 1. Each time the function <code>foo</code> is called, a new execution context is created. Once a context has finished executing, it pops off the stack and control returns to the context below it until the <code>global context</code> is reached again.</p><p><strong>There are 5 key points to remember about the <code>execution stack</code></strong>:</p><ul style="margin-bottom: 20px; list-style-type: square; margin-left: 20px; display: inline-block;"><li>Single threaded.</li><li>Synchronous execution.</li><li>1 Global context.</li><li>Infinite function contexts. </li><li>Each function call creates a new <code>execution context</code>, even a call to itself.</li></ul><h2>Execution Context in Detail</h2><p>So we now know that everytime a function is called, a new <code>execution context</code> is created. However, inside the JavaScript interpreter, every call to an <code>execution context</code> has 2 stages:</p><ol><li><strong> Creation Stage</strong> [when the function is called, but before it executes any code inside]:</li><ul class="square"><li>Create the <a title="JavaScript Scope Chain and Closures Explained" href="http://davidshariff.com/blog/javascript-scope-chain-and-closures/">Scope Chain</a>.</li><li>Create variables, functions and arguments.</li><li>Determine the value of <a href="http://davidshariff.com/blog/javascript-this-keyword/"><code>"this"</code></a>.</li></ul><li><strong>Activation / Code Execution Stage</strong>:</li><ul class="square"><li>Assign values, references to functions and interpret / execute code.</li></ul></ol><p>It is possible to represent each <code>execution context</code> conceptually as an object with 3 properties: </p><pre class=" language-markup"><code class=" language-markup">executionContextObj = {    scopeChain: { /* variableObject + all parent execution context's variableObject */ }, variableObject: { /* function arguments / parameters, inner variable and function declarations */ },    this: {}}</code></pre><h3 id="ao">Activation / Variable Object [AO/VO]</h3><p>This <code>executionContextObj</code> is created when the function is invoked, but <em>before</em> the actual function has been executed. This is known as stage 1, the <code>Creation Stage </code>. Here, the interpreter creates the <code>executionContextObj</code> by scanning the function for parameters or arguments passed in, local function declarations and local variable declarations. The result of this scan becomes the <code>variableObject</code> in the <code>executionContextObj</code>.</p><p><strong>Here is a pseudo-overview of how the interpreter evaluates the code</strong>:</p><ol><li>Find some code to invoke a function.</li><li>Before executing the <code>function</code> code, create the <code>execution context</code>.</li><li> Enter the creation stage:</li><ul class="square"><li>Initialize the <a title="JavaScript Scope Chain and Closures Explained" href=" http://davidshariff.com/blog/javascript-scope-chain-and-closures/"><code>Scope Chain</code></a>.</li><li>Create the <code>variable object</code>:</li><ul class="square"><li>Create the <code>arguments object</code>, check the context for parameters, initialize the name and value and create a reference copy.</li><li>Scan the context for function declarations:</li><ul class="circle"><li>For each function found, create a property in the <code>variable object</code> that is the exact function name, which has a reference pointer to the function in memory. </li><li>If the function name exists already, the reference pointer value will be overwritten.</li></ul><li>Scan the context for variable declarations:</li><ul class="circle"><li>For each variable declaration found, create a property in the <code>variable object</code> that is the variable name, and initialize the value as <a href=" http://davidshariff.com/blog/javascripts-undefined-explored/">undefined</a>.</li><li>If the variable name already exists in the <code>variable object</code>, do nothing and continue scanning.</li></ul></ul><li>Determine the value of <a href="http://davidshariff.com/blog/javascript-this-keyword/"><code>"this"</code></a> inside the context.</li></ul><li>Activation / Code Execution Stage:</li><ul class="square"><li>Run / interpret the function code in the context and assign variable values as the code is executed line by line.</li></ul></ol><p>Let's look at an example:</p><pre class=" language-javascript"><code class=" language-javascript"><span class="token keyword">function</span> <span class="token function">foo<span class="token punctuation">(</span></span>i<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">var</span> a <span class="token operator">= </span> <span class="token string">'hello'</span><span class="token punctuation">;</span>    <span class="token keyword">var</span> b <span class="token operator">=</span> <span class= "token keyword">function</span> <span class="token function">privateB<span class="token punctuation">(</span></span><span class="token punctuation">)</span> <span class="token punctuation" >{</span>    <span class="token punctuation">}</span><span class="token punctuation">;</span>    <span class="token keyword">function</span> <span class="token function">c<span class= "token punctuation">(</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token function">foo<span class="token punctuation">(</span></span><span class="token number">22</span><span class="token punctuation">)</span><span class= "token punctuation">;</span></code></pre><p>On calling <code>foo(22)</code>, the <code>creation stage</code> looks as follows:</p><pre class=" language-markup"><code class=" language-markup">fooExecutionContext = {    scopeChain: { ... },    variableObject: {        arguments: {            0: 22,            length: 1        },        i: 22,        c: pointer to function c()        a: undefined,        b: undefined    },    this: { ... }}</code></pre><p>As you can see, the <code>creation stage</code> handles defining the names of the properties, not assigning a value to them, with the exception of formal arguments / parameters. Once the <code>creation stage</code> has finished, the flow of execution enters the function and the activation / code <code>execution stage</code> looks like this after the function has finished execution:</p><pre class=" language-markup"><code class=" language-markup"> fooExecutionContext = {    scopeChain: { ... },    variableObject: {        arguments: {            0: 22,            length: 1        },        i: 22,        c: pointer to function c()        a: 'hello',        b: pointer to function privateB()    },    this: { ... }}</code></pre><h3>A Word On Hoisting</h3><p>You can find many resources online defining the term <code>hoisting</code> in JavaScript, explaining that variable and function declarations are <em>hoisted</em> to the top of their function scope. However, none explain in detail why this happens, and armed with your new knowledge about how the interpreter creates the <code>activation object</code>, it is easy to see why. Take the following code example:</p><pre class=" line-numbers language-javascript"><code class=" language-javascript">&#8203;<span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    console<span class="token punctuation">.</span><span class="token function">log <span class="token punctuation">(</span></span><span class="token keyword">typeof</span> foo<span class="token punctuation">)</span><span class="token punctuation">;</span><span spellcheck ="true" class="token comment"> // function pointer</span>    console<span class="token punctuation">.</span><span class="token function">log<span class="token punctuation">( </span></span><span class="token keyword">typeof</span> bar<span class="token punctuation">)</span><span class="token punctuation">;</span><span spellcheck="true" class="token comment"> // undefined</span>    <span class="token keyword">var</span> foo <span class="token operator">=</span> <span class="token string">'hello'</span><span class="token punctuation">,</span> bar <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class= "token punctuation">{</span>            <span class="token keyword">return</span> <span class="token string">'world'</span><span class="token punctuation">;</span>        <span class= "token punctuation">}</span><span class="token punctuation">;</span>    <span class="token keyword">function</span> <span class="token function">foo<span class="token punctuation">( </span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">return</span> <span class="token string">'hello' </span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">(</span><span class= "token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>&#8203;<span class="line-numbers-rows" ><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span> </span></span></code></pre><p>The questions we can now answer are:</p><ul style="margin-bottom: 20px;" class="square"><li><strong>Why can we access foo before we have declared it? </strong></li><ul class="circle"><li>If we follow the <code>creation stage</code>, we know the variables have already been created before the <code>activation / code execution stage</code> . So as the function flow started executing, <code>foo</code> had already been defined in the <code>activation object</code>.</li></ul><li><strong>Foo is declared twice, why is foo shown to be</strong> <code>function</code> <strong>and not</strong> <code>undefined</code> <strong>or</strong> <code>string</code><strong>?</strong></li><ul class="circle"><li>Even though <code> foo</code> is declared twice, we know from the <code>creation stage</code> that functions are created on the <code>activation object</code> before variables, and if the property name already exists on the <code>activation object</code>, we simply bypass the decleration.</li><li>Therefore, a reference to <code>function foo()</code> is first created on the <code> activation object</code>, and when we get interpreter gets to <code>var foo</code>, we already see the property name <code>foo</code> exists so the code does nothing and proceeds. </li></ul><li><strong>Why is bar</strong> <code><a href="http://davidshariff.com/blog/javascripts-undefined-explored/">undefined</a></code><strong>?</strong></li><ul class="circle" ><li><code>bar</code> is actually a variable that has a function assignment, and we know the variables are created in the <code>creation stage</code> but they are initialized with the value of <code><a href="http://davidshariff.com/blog/javascripts-undefined-explored/">undefined</a></code>.</li></ul></ul><h2>Summary</h2><p>Hopefully by now you have a good grasp about how the JavaScript interpreter is evaluating your code. Understanding the execution context and stack allows you to know the reasons behind why your code is evaluating to different values that you had not initially expected.</p><p>Do you think knowing the inner workings of the interpreter is too much overhead or a necessity to your JavaScript knowledge ? Does knowing the execution context phase help you write better JavaScript ?</p><p><strong>Note:</strong> Some people have been asking about closures, callbacks, timeout etc which I will cover in the <a title="JavaScript Scope Chain and Closures Explained" href="http://davidshariff.com/blog/javascript-scope-chain-and-closures/">next post</a>, focusing more on the <a title="JavaScript Scope Chain and Closures Explained" href="http://davidshariff.com/blog/javascript-scope-chain-and-closures/">Scope Chain</a> in relation to the <code>execution context</code>.</p><section class="further-reading"><h3>Further Reading</h3><ul><li><a href="http://www.ecma-international.org/publications/files/ECMA-ST/ECMA-262.pdf">ECMA-262 5th Edition</a></li><li><a href=" http://dmitrysoshnikov.com/ecmascript/chapter-2-variable-object/">ECMA-262-3 in detail. Chapter 2. Variable object</a></li><li><a href="http://jibbering.com/faq/notes/closures/#clIRExSc"> Identifier Resolution, Execution Contexts and scope chains</a></li></ul></section>											</div>			</div> <!--=========================			END : POST		=============================-->		<!--=========================			START : POST =============================-->		<div class="post-wrapper"><h1>JavaScript Inheritance Patterns</h1><div class="entry-content">						<p>In this post, I am going to introduce to you 3 different ways of how you can implement inheritance in JavaScript.<span id="more-28"></span> You will see inheritance implemented in languages such as Java by allowing a class to inherit state and behavior from a superclass, where each superclass can have many subclasses.</p><p>This means that in Java an object is an instance of a class, which can inherit other classes. Now in JavaScript, being prototypal by nature, an object can inherit from an object.</p><p>For the rest of this post, I will introduce the Pseudoclassical, Functional and Prototypal inheritance patterns in JavaScript.</p><h2>Pseudoclassical pattern</h2><p>The Pseudoclassical pattern tries to replicate inheritance in a way that is familiar to those who come from a Java or C like background. By using Pseudoclassical inheritance, we attempt to recreate classic programming language's behavior by using class wide inheritance and where <em>objects are instances of those classes</em>.</p><p>A pattern which uses a <code>constructor</code> function and the <code>new</code> operator, combined with a prototype added to the <code>constructor</code> is said to be Pseudoclassical.</p><p>In JavaScript, one way to do this inheritance is:</p><ol><li>Invoke a constructor function.</li><li>Point a child's prototype to the parent's prototype for inheritance to occur.</li></ol><pre class=" language-javascript"><code class=" language-javascript"><span spellcheck="true" class="token comment"> /** * Point a child's prototype to a parent's prototype **/</span><span class="token keyword">var</span> extendObj <span class="token operator">=</span> <span class="token keyword"> function</span><span class="token punctuation">(</span>childObj<span class="token punctuation">,</span> parentObj<span class="token punctuation">)</span> <span class="token punctuation">{ </span>    childObj<span class="token punctuation">.</span>prototype <span class="token operator">=</span> parentObj<span class="token punctuation">.</span>prototype<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span spellcheck="true" class="token comment">// base human object</span><span class= "token keyword">var</span> Human <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">) </span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span spellcheck="true" class="token comment">// inhertiable attributes / methods</span>Human<span class="token punctuation">.</span>prototype <span class="token operator">=</span> <span class="token punctuation">{</span>    name<span class="token punctuation">:</span> <span class="token string">''</span><span class="token punctuation">,</span>    gender<span class="token punctuation">:</span> <span class="token string" >''</span><span class="token punctuation">,</span>    planetOfBirth<span class="token punctuation">:</span> <span class="token string">'Earth'</span><span class="token punctuation">, </span>    sayGender<span class="token punctuation">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token function">alert<span class="token punctuation">(</span></span>this<span class="token punctuation">.</span>name <span class="token operator">+</span> <span class="token string">' says my gender is '</span> <span class="token operator">+</span> this<span class="token punctuation">.</span>gender<span class= "token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">,</span>    sayPlanet<span class="token punctuation">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token function">alert<span class="token punctuation">(</span></span>this<span class="token punctuation">.</span>name <span class="token operator">+</span> <span class= "token string">' was born on '</span> <span class="token operator">+</span> this<span class="token punctuation">.</span>planetOfBirth<span class="token punctuation">)</span><span class= "token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span spellcheck="true" class= "token comment">// male</span><span class="token keyword">var</span> Male <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation"> (</span>name<span class="token punctuation">)</span> <span class="token punctuation">{</span>    this<span class="token punctuation">.</span>gender <span class="token operator">=</span> <span class="token string">'Male'</span><span class="token punctuation">;</span>    this<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class= "token string">'David'</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span spellcheck="true" class="token comment">// inherits human</span><span class="token function">extendObj<span class="token punctuation">(</span></span>Male<span class="token punctuation">,</span> Human<span class="token punctuation">)</span><span class="token punctuation">;</span><span spellcheck="true" class="token comment">// female</span><span class="token keyword">var</span> Female <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>name<span class="token punctuation">)</span> <span class="token punctuation">{</span> this<span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>    this<span class="token punctuation">.</span> gender <span class="token operator">=</span> <span class="token string">'Female'</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span spellcheck="true" class="token comment">// inherits human</span><span class="token function">extendObj<span class="token punctuation">(</span></span>Female<span class="token punctuation">,</span> Human<span class="token punctuation">)</span><span class="token punctuation">;</span><span spellcheck="true" class="token comment">// new instances </span><span class="token keyword">var</span> david <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Male</span><span class= "token punctuation">(</span><span class="token string">'David'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">var</span> jane <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Female</span><span class="token punctuation">(</span><span class="token string">'Jane'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>david<span class="token punctuation">.</span><span class="token function">sayGender <span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span><span spellcheck="true" class="token comment"> // David says my gender is Male</span>jane<span class="token punctuation">.</span><span class="token function">sayGender<span class="token punctuation">(</span></span><span class="token punctuation">) </span><span class="token punctuation">;</span><span spellcheck="true" class="token comment"> // Jane says my gender is Female</span>Male<span class="token punctuation">.</span>prototype <span class="token punctuation">.</span>planetOfBirth <span class="token operator">=</span> <span class="token string">'Mars'</span><span class="token punctuation">;</span>david<span class ="token punctuation">.</span><span class="token function">sayPlanet<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">; </span><span spellcheck="true" class="token comment"> // David was born on Mars</span>jane<span class="token punctuation">.</span><span class="token function">sayPlanet<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span><span spellcheck="true" class="token comment"> // Jane was born on Mars </span></code></pre><p>As expected, we have achieved inheritance in a Pseudoclassical manner, however, this solution has a problem. If you look at the last line, you will see the alert says <code>Jane was born on Mars</code>, but what we really want it to say is <code>Jane was born on Earth</code>. The reason for this is the Male prototype was changed to "Mars".</p><p> Given the direct link between the <code>Male</code> and <code>Human</code> prototype, if <code>Human</code> has many children inheriting from it, any change on a child's prototype properties will affect <code>Human</code>, and thus all children inheriting from <code>Human</code>. Changing a child's prototype should not affect other children inheriting from the same parent. The reason for this is because JavaScript passes objects by reference, not by value, meaning all children of <code>Human</code> inherit changes occurred on other children's prototypes.</p><p><code>childObj.prototype = parentObj.prototype</code> does give us inheritance. However, if you want to fix the issue above, you need to replace the <code>extendObj </code> function to take the child's prototype and link it to a temporary object, whose prototype is the parent object's prototype. In this way, by creating a temporary "middle" object, you allow the temporary object to be empty and inherit its properties from <code>Human</code>.</p><p>By doing this, you have solved the pass by reference issue with a new instance of an empty object, which still inherits from the parent, but is not affected by other children.</p><p>To understand this clearly, the image below shows the flow of the <code>extendObj</code> function.</p><p><img alt="classical inheritance" src="http://davidshariff.com/blog/images/classical_inheritance.png"></p><p>Now, if you ran the same code again, but with the changes in <code>extendObj</code> below, you would see "Jane was born on Earth" was alerted.</p><pre class=" language-javascript"><code class=" language-javascript"><span spellcheck="true" class= "token comment">/** * Create a new constructor function, whose prototype is the parent object's prototype. * Set the child's prototype to the newly created constructor function. **/ </span><span class="token keyword">var</span> extendObj <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>childObj <span class="token punctuation">,</span> parentObj<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">var</span> tmpObj <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation" >{</span><span class="token punctuation">}</span>    tmpObj<span class="token punctuation">.</span>prototype <span class="token operator">=</span> parentObj<span class="token punctuation"> .</span>prototype<span class="token punctuation">;</span>    childObj<span class="token punctuation">.</span>prototype <span class="token operator">=</span> <span class="token keyword">new </span> <span class="token class-name">tmpObj</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    childObj <span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>constructor <span class="token operator">=</span> childObj<span class="token punctuation">; </span><span class="token punctuation">}</span><span class="token punctuation">;</span><span spellcheck="true" class="token comment">// base human object</span><span class="token keyword"> var</span> Human <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span spellcheck="true" class="token comment">// inhertiable attributes / methods</span>Human<span class="token punctuation">.</span>prototype <span class="token operator">=</span> <span class="token punctuation">{</span>    name<span class="token punctuation">: </span> <span class="token string">''</span><span class="token punctuation">,</span>    gender<span class="token punctuation">:</span> <span class="token string">''</span><span class= "token punctuation">,</span>    planetOfBirth<span class="token punctuation">:</span> <span class="token string">'Earth'</span><span class="token punctuation">,</span>    sayGender<span class="token punctuation">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token function">alert<span class="token punctuation">(</span></span>this<span class="token punctuation">.</span>name <span class="token operator"> +</span> <span class="token string">' says my gender is '</span> <span class="token operator">+</span> this<span class="token punctuation">.</span>gender<span class="token punctuation">) </span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">,</span>    sayPlanet<span class="token punctuation">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class= "token function">alert<span class="token punctuation">(</span></span>this<span class="token punctuation">.</span>name <span class="token operator">+</span> <span class="token string">' was born on '</span> <span class="token operator">+</span> this<span class="token punctuation">.</span>planetOfBirth<span class="token punctuation">)</span><span class="token punctuation"> ;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span spellcheck="true" class="token comment">// male </span><span class="token keyword">var</span> Male <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>name<span class ="token punctuation">)</span> <span class="token punctuation">{</span>    this<span class="token punctuation">.</span>gender <span class="token operator">=</span> <span class="token string">'Male'</span><span class="token punctuation">;</span>    this<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">'David' </span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span spellcheck="true" class="token comment">// inherits human</span><span class="token function">extendObj<span class="token punctuation">(</span></span>Male<span class="token punctuation">,</span> Human<span class="token punctuation">) </span><span class="token punctuation">;</span><span spellcheck="true" class="token comment">// female</span><span class="token keyword">var</span> Female <span class="token operator">= </span> <span class="token keyword">function</span> <span class="token punctuation">(</span>name<span class="token punctuation">)</span> <span class="token punctuation">{</span>    this <span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>    this<span class="token punctuation">.</span>gender <span class="token operator">=</span> <span class="token string">'Female'</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">; </span><span spellcheck="true" class="token comment">// inherits human</span><span class="token function">extendObj<span class="token punctuation">(</span></span>Female<span class="token punctuation">,</span> Human<span class="token punctuation">)</span><span class="token punctuation">;</span><span spellcheck="true" class="token comment">// new instances</span><span class= "token keyword">var</span> david <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Male</span><span class="token punctuation">( </span><span class="token string">'David'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">var</span> jane <span class= "token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Female</span><span class="token punctuation">(</span><span class="token string">'Jane' </span><span class="token punctuation">)</span><span class="token punctuation">;</span>david<span class="token punctuation">.</span><span class="token function">sayGender<span class= "token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span><span spellcheck="true" class="token comment"> // David says my gender is Male</span>jane<span class="token punctuation">.</span><span class="token function">sayGender<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span><span spellcheck="true" class="token comment"> // Jane says my gender is Female</span>Male<span class="token punctuation">.</span>prototype<span class= "token punctuation">.</span>planetOfBirth <span class="token operator">=</span> <span class="token string">'Mars'</span><span class="token punctuation">;</span>david<span class="token punctuation">.</span><span class="token function">sayPlanet<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">; </span><span spellcheck="true" class="token comment"> // David was born on Mars</span>jane<span class="token punctuation">.</span><span class="token function">sayPlanet<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span><span spellcheck="true" class="token comment"> // Jane was born on Earth </span></code></pre><h2>Functional pattern</h2><p>Another pattern you can use to achieve inheritance in JavaScript is by <a href="www.crockford.com">Douglas Crockford</a>, called Functional inheritance. This pattern allows one object to inherit from another, take the result and augment it at the child level to achieve inheritance. What this really means, is you create an object as your parent, pass the child object to the parent to inherit / apply its properties, and return the resulting object back to the child, who can then augment its&nbsp; own properties to the object returned from the parent.</p><p>Below is the same example used above to explain Pseudoclassical inheritance, but written in a functional nature.</p><pre class= " language-javascript"><code class=" language-javascript"><span class="token keyword">var</span> human <span class="token operator">=</span> <span class="token keyword">function </span><span class="token punctuation">(</span>name<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">var</span> that <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>    that<span class="token punctuation">.</span>name <span class="token operator">=</span> name <span class="token operator">||</span> <span class="token string">''</span><span class="token punctuation">;</span> that<span class="token punctuation">.</span>gender <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">;</span>    that<span class= "token punctuation">.</span>planetOfBirth <span class="token operator">=</span> <span class="token string">'Earth'</span><span class="token punctuation">;</span>    that<span class="token punctuation">.</span>sayGender <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">) </span> <span class="token punctuation">{</span>        <span class="token function">alert<span class="token punctuation">(</span></span>that<span class="token punctuation">.</span>name <span class="token operator">+</span> <span class="token string">' says my gender is '</span> <span class="token operator">+</span> that<span class="token punctuation">.</span>gender<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">;</span>    that<span class="token punctuation">.</span>sayPlanet <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">) </span> <span class="token punctuation">{</span>        <span class="token function">alert<span class="token punctuation">(</span></span>that<span class="token punctuation">.</span>name <span class="token operator">+</span> <span class="token string">' was born on '</span> <span class="token operator">+</span> that<span class="token punctuation">.</span>planetOfBirth<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> that<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">var</span> male <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>name<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class= "token keyword">var</span> that <span class="token operator">=</span> <span class="token function">human<span class="token punctuation">(</span></span>name<span class="token punctuation">) </span><span class="token punctuation">;</span>    that<span class="token punctuation">.</span>gender <span class="token operator">=</span> <span class="token string">'Male'</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> that<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">var</span> female <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>name<span class="token punctuation">) </span> <span class="token punctuation">{</span>    <span class="token keyword">var</span> that <span class="token operator">=</span> <span class="token function">human<span class="token punctuation">(</span></span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>    that<span class="token punctuation">.</span>gender <span class="token operator">=</span> <span class="token string">'Female'</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> that<span class="token punctuation">; </span><span class="token punctuation">}</span><span class="token keyword">var</span> david <span class="token operator">=</span> <span class="token function">male<span class="token punctuation">(</span></span><span class="token string">'David'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">var</span> jane <span class="token operator">=</span> <span class="token function">female<span class="token punctuation">(</span></span><span class="token string">'Jane'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>david<span class="token punctuation">.</span><span class="token function">sayGender<span class="token punctuation">( </span></span><span class="token punctuation">)</span><span class="token punctuation">;</span><span spellcheck="true" class="token comment"> // David says my gender is Male</span>jane<span class="token punctuation">.</span><span class="token function">sayGender<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span><span spellcheck="true" class="token comment"> // Jane says my gender is Female</span>david<span class="token punctuation">.</span>planetOfBirth <span class="token operator">=</span> <span class="token string">'Mars'</span><span class="token punctuation">;</span>david<span class="token punctuation">.</span><span class="token function">sayPlanet<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span><span spellcheck="true" class="token comment"> // David was born on Mars</span>jane<span class="token punctuation">.</span><span class="token function">sayPlanet<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span><span spellcheck="true" class="token comment"> // Jane was born on Earth</span></code></pre><p>As you can see by using this pattern, there is no need to use the prototype chain, constructors or the "new" keyword. Functional inheritance achieves this by passing a unique object around every time an instance of the function is called.</p><p> This however, has a downside for performance because each object is unique, meaning each function call creates a new object, so the JavaScript interpreter has to assign new memory to the function in order to recompile everything inside of it as unique again.</p><p>There are also benefits to this approach, as the closures of each function allow for good use of public and private methods / attributes. Let's take this code for example, which shows a parent class of vehicle and children classes of <code>motorbike</code> and <code>boat</code>.</p><pre class=" language-javascript"><code class=" language-javascript"><span class="token keyword">var</span> vehicle <span class="token operator">=</span> <span class="token keyword">function </span><span class="token punctuation">(</span>attrs<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">var</span> _privateObj <span class="token operator">=</span> <span class="token punctuation">{</span>        hasEngine<span class="token punctuation">:</span> <span class="token boolean">true</span>    <span class="token punctuation">}</span><span class="token punctuation">,</span>    that <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>    that<span class="token punctuation">.</span>name <span class="token operator">=</span> attrs<span class="token punctuation" >.</span>name <span class="token operator">||</span> <span class="token keyword">null</span><span class="token punctuation">;</span>    that<span class="token punctuation">.</span> engineSize <span class="token operator">=</span> attrs<span class="token punctuation">.</span>engineSize <span class="token operator">||</span> <span class="token keyword">null</span><span class="token punctuation">;</span>    that<span class="token punctuation">.</span>hasEngine <span class="token operator">=</span> <span class="token keyword">function</span> <span class= "token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token function">alert<span class="token punctuation">( </span></span><span class="token string">'This '</span> <span class="token operator">+</span> that<span class="token punctuation">.</span>name <span class="token operator">+</span> <span class="token string">' has an engine: '</span> <span class="token operator">+</span> _privateObj<span class="token punctuation">.</span>hasEngine<span class="token punctuation">) </span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> that<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">var</span> motorbike <span class="token operator">=</span> <span class="token keyword" >function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>   <span spellcheck="true" class="token comment"> // private</span>    <span class="token keyword">var</span> _privateObj <span class="token operator">=</span> <span class="token punctuation">{</span>        numWheels<span class="token punctuation">:</span> <span class="token number">2</span>    <span class="token punctuation">}</span><span class="token punctuation">,</span>   <span spellcheck="true" class="token comment"> // inherit</span>    that <span class="token operator">=</span> <span class="token function">vehicle<span class="token punctuation">(</span></span><span class="token punctuation" >{</span>        name<span class="token punctuation">:</span> <span class="token string">'Motorbike'</span><span class="token punctuation">,</span>        engineSize<span class="token punctuation">:</span> <span class="token string">'Small'</span>    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span spellcheck="true" class="token comment"> // public</span>    that<span class="token punctuation">.</span>totalNumWheels <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token function">alert <span class="token punctuation">(</span></span><span class="token string">'This Motobike has '</span> <span class="token operator">+</span> _privateObj<span class="token punctuation">. </span>numWheels <span class="token operator">+</span> <span class="token string">' wheels'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">;</span>    that<span class="token punctuation">.</span>increaseWheels <span class="token operator">=</span> <span class= "token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        _privateObj<span class= "token punctuation">.</span>numWheels<span class="token operator">++</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> that<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">; </span><span class="token keyword">var</span> boat <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class= "token punctuation">)</span> <span class="token punctuation">{</span>   <span spellcheck="true" class="token comment"> // inherit</span>    that <span class="token operator">=</span> <span class="token function">vehicle<span class="token punctuation">(</span></span><span class="token punctuation">{</span>        name<span class="token punctuation">:</span> <span class= "token string">'Boat'</span><span class="token punctuation">,</span>        engineSize<span class="token punctuation">:</span> <span class="token string">'Large'</span>    <span class= "token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> that<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">;</span>myBoat <span class="token operator">=</span> <span class="token function">boat<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>myBoat<span class="token punctuation">.</span><span class="token function">hasEngine<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span><span spellcheck="true" class="token comment"> // This Boat has an engine: true</span><span class="token function">alert<span class="token punctuation">(</span></span>myBoat<span class="token punctuation">.</span>engineSize <span class="token punctuation">)</span><span class="token punctuation">;</span><span spellcheck="true" class="token comment"> // Large</span>myMotorbike <span class="token operator">= </span> <span class="token function">motorbike<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>myMotorbike <span class="token punctuation">.</span><span class="token function">hasEngine<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span><span spellcheck="true" class="token comment"> // This Motorbike has an engine: true</span>myMotorbike<span class="token punctuation">.</span><span class="token function">increaseWheels<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>myMotorbike<span class="token punctuation">.</span><span class="token function">totalNumWheels<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">; </span><span spellcheck="true" class="token comment"> // This Motorbike has 3 wheels</span><span class="token function">alert<span class="token punctuation">(</span></span>myMotorbike<span class="token punctuation">.</span>engineSize<span class="token punctuation">)</span><span class="token punctuation">;</span><span spellcheck="true" class="token comment"> // Small</span> myMotorbike2 <span class="token operator">=</span> <span class="token function">motorbike<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class= "token punctuation">;</span>myMotorbike2<span class="token punctuation">.</span><span class="token function">totalNumWheels<span class="token punctuation">(</span></span><span class= "token punctuation">)</span><span class="token punctuation">;</span><span spellcheck="true" class="token comment"> // This Motorbike has 2 wheels</span>myMotorbike<span class="token punctuation">.</span>_privateObj<span class="token punctuation">.</span>numWheels <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">; </span><span spellcheck="true" class="token comment"> // undefined</span>myBoat<span class="token punctuation">.</span><span class="token function">totalNumWheels<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span><span spellcheck="true" class="token comment"> // undefined </span></code></pre><p>You can see that it is fairly easy to provide encapsulation. The <code>_privateObj</code> can not be modified from outside of the object, unless exposed by a public method like increaseWheels(). Similarly, private values can also only be read when exposed by a public method, such as motorbike's <code>totalNumWheels()</code> function.</p><h2> Prototypal pattern</h2><p>You can also implement inheritance in JavaScript using a pure prototypal approach which is more suited to the language.<br>As of ECMAScript 5, it is possible to create an inherited object by simply doing the following:</p><pre class=" language-javascript"><code class=" language-javascript"><span class="token keyword">var</span> male <span class= "token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">create<span class="token punctuation">(</span></span>human<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>However, support is not so good for older browsers, thankfully you can augment the Object with a create method should it not exist already, which will have the same behavior as that of ECMAScript 5.</p><pre class=" language-javascript"><code class=" language-javascript"><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token string">'use strict'</span><span class="token punctuation">;</span>    <span spellcheck="true" class="token comment"> /***************************************************************     * Helper functions for older browsers     ***************************************************************/</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>Object<span class="token punctuation">.</span><span class="token function">hasOwnProperty<span class="token punctuation">(</span></span><span class="token string">'create'</span><span class="token punctuation">)</span><span class="token punctuation">) </span> <span class="token punctuation">{</span>        Object<span class="token punctuation">.</span>create <span class="token operator">=</span> <span class="token keyword">function </span> <span class="token punctuation">(</span>parentObj<span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token keyword">function </span> <span class="token function">tmpObj<span class="token punctuation">(</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class= "token punctuation">}</span>            tmpObj<span class="token punctuation">.</span>prototype <span class="token operator">=</span> parentObj<span class="token punctuation">;</span> <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">tmpObj</span><span class="token punctuation">(</span><span class ="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>Object<span class="token punctuation">. </span><span class="token function">hasOwnProperty<span class="token punctuation">(</span></span><span class="token string">'defineProperties'</span><span class="token punctuation">) </span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        Object<span class="token punctuation">.</span>defineProperties <span class="token operator"> =</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>obj<span class="token punctuation">,</span> props<span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> prop <span class= "token keyword">in</span> props<span class="token punctuation">)</span> <span class="token punctuation">{</span>                Object<span class="token punctuation">.</span><span class= "token function">defineProperty<span class="token punctuation">(</span></span>obj<span class="token punctuation">,</span> prop<span class="token punctuation">,</span> props<span class= "token punctuation">[</span>prop<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span spellcheck="true" class= "token comment">/*************************************************************/</span>    <span class="token keyword">var</span> human <span class="token operator">=</span> <span class= "token punctuation">{</span>        name<span class="token punctuation">:</span> <span class="token string">''</span><span class="token punctuation">,</span>        gender<span class= "token punctuation">:</span> <span class="token string">''</span><span class="token punctuation">,</span>        planetOfBirth<span class="token punctuation">:</span> <span class="token string">'Earth'</span><span class="token punctuation">,</span>        sayGender<span class="token punctuation">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token function">alert<span class="token punctuation">( </span></span>this<span class="token punctuation">.</span>name <span class="token operator">+</span> <span class="token string">' says my gender is '</span> <span class="token operator">+ </span> this<span class="token punctuation">.</span>gender<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">} </span><span class="token punctuation">,</span>        sayPlanet<span class="token punctuation">:</span> <span class="token keyword">function</span> <span class="token punctuation">( </span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token function">alert<span class="token punctuation">(</span></span>this <span class="token punctuation">.</span>name <span class="token operator">+</span> <span class="token string">' was born on '</span> <span class="token operator">+</span> this<span class= "token punctuation">.</span>planetOfBirth<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class= "token punctuation">}</span><span class="token punctuation">;</span>    <span class="token keyword">var</span> male <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">create<span class="token punctuation">(</span></span>human<span class="token punctuation">,</span> <span class="token punctuation">{ </span>        gender<span class="token punctuation">:</span> <span class="token punctuation">{</span>value<span class="token punctuation">:</span> <span class="token string">'Male' </span><span class="token punctuation">}</span>    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class= "token keyword">var</span> female <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">create<span class="token punctuation">( </span></span>human<span class="token punctuation">,</span> <span class="token punctuation">{</span>        gender<span class="token punctuation">:</span> <span class="token punctuation">{ </span>value<span class="token punctuation">:</span> <span class="token string">'Female'</span><span class="token punctuation">}</span>    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">var</span> david <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">create<span class="token punctuation">(</span></span>male<span class="token punctuation">,</span> <span class="token punctuation">{</span> name<span class="token punctuation">:</span> <span class="token punctuation">{</span>value<span class="token punctuation">:</span> <span class="token string">'David'</span><span class="token punctuation">}</span><span class="token punctuation">,</span>        planetOfBirth<span class="token punctuation">:</span> <span class="token punctuation">{</span>value<span class="token punctuation">:</span> <span class="token string">'Mars'</span><span class="token punctuation">}</span>    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">var</span> jane <span class="token operator">=</span> Object<span class="token punctuation">. </span><span class="token function">create<span class="token punctuation">(</span></span>female<span class="token punctuation">,</span> <span class="token punctuation">{</span>        name <span class="token punctuation">:</span> <span class="token punctuation">{</span>value<span class="token punctuation">:</span> <span class="token string">'Jane'</span><span class="token punctuation">}</span>    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    david<span class="token punctuation">. </span><span class="token function">sayGender<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span><span spellcheck ="true" class="token comment"> // David says my gender is Male</span>    david<span class="token punctuation">.</span><span class="token function">sayPlanet<span class="token punctuation"> (</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span><span spellcheck="true" class="token comment"> // David was born on Mars</span>    jane<span class="token punctuation">.</span><span class="token function">sayGender<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span><span spellcheck="true" class="token comment"> // Jane says my gender is Female</span>    jane<span class="token punctuation">.</span><span class="token function"> sayPlanet<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span><span spellcheck="true" class="token comment"> // Jane was born on Earth</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">) </span><span class="token punctuation">;</span></code></pre><h2>Summary</h2><p>So today we have covered 3 different ways that you can implement inheritance in JavaScript. Most people are aware of prototypes, but as we have seen today, the Pseudoclassical and Functional patterns are just as valid. </p><p>Which pattern you should use varies depending on your project, there is no real "1 fits all" solution, so you are best to choose 1 you feel is the most suitable.</p>											</div>			</div> <!--=========================			END : POST		=============================-->		<!--=========================			START : POST =============================-->		<div class="post-wrapper">		<h1>JavaScript's 'this' Keyword</h1>		<div class="entry-content">						<p>A commonly used feature of JavaScript is the "this" keyword, but it is often also one of the most confused and misinterpreted&nbsp;features of the language. What does "this" actually mean and how is it decided?<span id="more-34"></span></p><p>This article tries to clear up the confusion&nbsp;and explain the answer in a clear fashion.</p><p>The "this" keyword is not new to those who have programmed in other languages, and more often than not it refers to&nbsp;the new object created when instantiating a class via it's constructor. For example, if I have a class Boat(), which has a&nbsp;method moveBoat(), when refering to "this" inside of the moveBoat() method, we are actually accessing the newly created object of Boat().</p><p>In JavaScript, we also have this concept inside a Function constructor when it is invoked using the "new" keyword, however it&nbsp;is not the only rule and "this" can often refer to a different object from a different execution context. If you are not familiar&nbsp;with JavaScript's execution context, I recommend you read my other post on the topic <a href=" http://davidshariff.com/blog/javascript_execution_context">here</a>. Enough talking, let's see some JavaScript examples:</p><pre class=" language-javascript"><code class=" language-javascript"><span spellcheck="true" class="token comment">// global scope</span>foo <span class="token operator">=</span> <span class="token string">'abc'</span><span class= "token punctuation">;</span><span class="token function">alert<span class="token punctuation">(</span></span>foo<span class="token punctuation">)</span><span class="token punctuation">; </span><span spellcheck="true" class="token comment"> // abc</span>this<span class="token punctuation">.</span>foo <span class="token operator">=</span> <span class="token string">'def' </span><span class="token punctuation">;</span><span class="token function">alert<span class="token punctuation">(</span></span>foo<span class="token punctuation">)</span><span class= "token punctuation">;</span><span spellcheck="true" class="token comment"> // def</span></code></pre><p>Whenever you use the keyword "this" in the global context (not inside a function), it always refers to the global object. Now&nbsp;let's look at the value of "this" inside a function:</p><pre class=" language-javascript"><code class=" language-javascript"><span class= "token keyword">var</span> boat <span class="token operator">=</span> <span class="token punctuation">{</span>    size<span class="token punctuation">:</span> <span class="token string"> 'normal'</span><span class="token punctuation">,</span>    boatInfo<span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">( </span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token function">alert<span class="token punctuation">(</span></span>this <span class="token operator">===</span> boat<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">alert<span class="token punctuation">(</span></span>this<span class="token punctuation">.</span>size<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">;</span>boat<span class="token punctuation">.</span><span class="token function">boatInfo<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span><span spellcheck="true" class="token comment"> // true, 'normal' </span><span class="token keyword">var</span> bigBoat <span class="token operator">=</span> <span class="token punctuation">{</span>    size<span class="token punctuation">:</span> <span class="token string">'big'</span><span class="token punctuation">}</span><span class="token punctuation">;</span>bigBoat<span class="token punctuation">.</span>boatInfo <span class="token operator">=</span> boat<span class="token punctuation">.</span>boatInfo<span class="token punctuation">;</span>bigBoat<span class="token punctuation">.</span><span class="token function"> boatInfo<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span><span spellcheck="true" class="token comment"> // false, 'big'</span></code></pre><p>So how is "this" determined above? We can see an object boat which has a property size and a method boatInfo().&nbsp;Inside boatInfo(), it alerts if the value of this is the actual boat object, and also alerts the size property of this.&nbsp;So, we invoke the function using boat.boatInfo() and can see that this is the boat object and the size property of the boat is normal.</p><p>We then create another object, bigBoat, which has a size property of big. However, the bigBoat object does not have a boatInfo()&nbsp;method, so we copy the method from boat using bigBoat.boatInfo = boat.boatInfo. Now, when we call bigBoat.boatInfo() and enter the function, we&nbsp;see that this is not equal to boat and that size property is now big. Why did this happen? How did the value of this change inside boatInfo()?</p><p>The first thing you must realise is that the value of this inside any function is never static, it is always determined every time&nbsp;you call a function, but before the function actually executes it's code. The value of this&nbsp;inside a function is actually provided by &nbsp;the parent scope in which the function was called, and more importantly, how the actual function syntax was written.</p><p>Whenever a function is called, we must look at the immediate left side of the brackets / parentheses "()". If on the left side of the&nbsp;parentheses we can see a reference, then the value of "this" passed to the function call is exactly of which that object belongs to, otherwise it is the global object. Let's see&nbsp;some examples:</p><pre class=" language-javascript"><code class=" language-javascript"><span class= "token keyword">function</span> <span class="token function">bar<span class="token punctuation">(</span></span><span class="token punctuation">)</span> <span class="token punctuation">{ </span>    <span class="token function">alert<span class="token punctuation">(</span></span>this<span class="token punctuation">)</span><span class="token punctuation">;</span><span class= "token punctuation">}</span><span class="token function">bar<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">; </span><span spellcheck="true" class="token comment"> // global - because the method bar() belongs to the global object when invoked</span><span class="token keyword">var</span> foo <span class="token operator">=</span> <span class="token punctuation">{</span>    baz<span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token function">alert<span class="token punctuation">( </span></span>this<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span>foo <span class="token punctuation">.</span><span class="token function">baz<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span><span spellcheck="true" class="token comment"> // foo - because the method baz() belongs to the object foo when invoked</span></code></pre><p>If things are clear this far, then the above code obviously makes sense. We can further complicate things by&nbsp;changing the value of "this" inside the very same function, by writing the call / invoke syntax in 2 different ways:</p><pre class=" language-javascript"><code class=" language-javascript"><span class="token keyword">var</span> foo <span class="token operator">=</span> <span class= "token punctuation">{</span>    baz<span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token function">alert<span class="token punctuation">(</span></span>this<span class="token punctuation">) </span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span>foo<span class="token punctuation">.</span><span class= "token function">baz<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span><span spellcheck="true" class="token comment"> // foo - because baz belongs to the foo object when invoked</span><span class="token keyword">var</span> anotherBaz <span class="token operator">=</span> foo<span class="token punctuation">.</span>baz<span class="token punctuation">;</span><span class="token function">anotherBaz<span class="token punctuation">(</span></span><span class="token punctuation">) </span><span class="token punctuation">;</span><span spellcheck="true" class="token comment"> // global - because the method anotherBaz() belongs to the global object when invoked, NOT foo </span></code></pre><p>Here, we see the value of "this" inside baz()&nbsp;was different each time, as it was syntactically called in 2 different ways. Now, let's see the value of "this" inside a deeply nested object:</p><pre class=" language-javascript"><code class=" language-javascript"><span class="token keyword">var</span> anum <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token keyword">var</span> foo <span class="token operator">=</span> <span class="token punctuation"> {</span>    anum<span class="token punctuation">:</span> <span class="token number">10</span><span class="token punctuation">,</span>    baz<span class="token punctuation">:</span> <span class="token punctuation">{</span>        anum<span class="token punctuation">:</span> <span class="token number">20</span><span class="token punctuation">,</span>        bar<span class= "token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{ </span>            console<span class="token punctuation">.</span><span class="token function">log<span class="token punctuation">(</span></span>this<span class="token punctuation">. </span>anum<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span>foo<span class="token punctuation">.</span>baz<span class="token punctuation">.</span><span class="token function">bar<span class="token punctuation">( </span></span><span class="token punctuation">)</span><span class="token punctuation">;</span><span spellcheck="true" class="token comment"> // 20 - because left side of () is bar, which belongs to baz object when invoked</span><span class="token keyword">var</span> hello <span class="token operator">=</span> foo<span class="token punctuation">.</span>baz<span class= "token punctuation">.</span>bar<span class="token punctuation">;</span><span class="token function">hello<span class="token punctuation">(</span></span><span class="token punctuation">) </span><span class="token punctuation">;</span><span spellcheck="true" class="token comment"> // 0 - because left side of () is hello, which belongs to global object when invoked </span></code></pre><p>Another question often asked is how is the keyword "this" determined inside an event handler? The answer is "this"&nbsp;inside of an event handler always refers to the element it was triggered on. Let's see an example:</p><pre class="  language-javascript"><code class=" language-markup"><span class="token tag"><span class="token tag"><span class= "token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">" </span>test<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>I am an element with id #test<span class="token tag"><span class="token tag" ><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span></code><code class=" language-javascript"><span class="token keyword">function </span> <span class="token function">doAlert<span class="token punctuation">(</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class= "token function">alert<span class="token punctuation">(</span></span>this<span class="token punctuation">.</span>innerHTML<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token function">doAlert<span class="token punctuation">(</span></span><span class="token punctuation">) </span><span class="token punctuation">;</span><span spellcheck="true" class="token comment"> // undefined</span><span class="token keyword">var</span> myElem <span class="token operator"> =</span> document<span class="token punctuation">.</span><span class="token function">getElementById<span class="token punctuation">(</span></span><span class="token string">'test' </span><span class="token punctuation">)</span><span class="token punctuation">;</span>myElem<span class="token punctuation">.</span>onclick <span class="token operator">=</span> doAlert <span class="token punctuation">;</span><span class="token function">alert<span class="token punctuation">(</span></span>myElem<span class="token punctuation">.</span>onclick <span class= "token operator">===</span> doAlert<span class="token punctuation">)</span><span class="token punctuation">;</span><span spellcheck="true" class="token comment"> // true</span>myElem<span class="token punctuation">.</span><span class="token function">onclick<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation" >;</span><span spellcheck="true" class="token comment"> // I am an element</span></code></pre><p>Here we can see that when doAlert() is first called, it alerts undefined, as doAlert() belongs to the&nbsp;global object. We then write myElem.onclick = doAlert, which copies the function doAlert() to the onclick()&nbsp;event of myElem. This basically means that whenever onclick() is fired, it is a method of myElem, meaning the value of "this" will be the myElem object exactly.</p><p>One last thing I want to note on this topic, is that the value of "this" can also be manually set using call() and apply(),&nbsp;overriding what we have discussed here today. Also of interested is that when calling "this" inside a&nbsp;function constructor, "this" refers to the newly created object in all instances inside the constructor. The reason for that is&nbsp;the function constructor is invoked with the "new" keyword, which creates a new object where "this" inside the&nbsp;constructor always refers to the new object just created.</p><h2>Summary</h2><p>Hopefully today's blog post has cleared up any misunderstanding of the "this" keyword and you can go forth always&nbsp;knowing the correct value of "this". We now know that the value of "this" is never static and has a different value&nbsp;depending on how the function was invoked.</p>											</div>			</div>		<!--=========================			END : POST =============================-->		<!--=========================			START : POST		=============================-->		<div class="post-wrapper">		<h1>Identifier Resolution and Closures in the JavaScript Scope Chain</h1>		<div class="entry-content">						<p>From my <a href=" http://davidshariff.com/blog/what-is-the-execution-context-in-javascript/">previous post</a>, we now know that every function has an associated <code><a href=" http://davidshariff.com/blog/what-is-the-execution-context-in-javascript/">execution context</a></code> that contains a <code><a href=" http://davidshariff.com/blog/what-is-the-execution-context-in-javascript/#ao">variable object [VO]</a></code>, which is composed of all the variables, functions and parameters defined inside that given local function.<span id="more-271"></span></p><p>The <code>scope chain</code> property of each <code><a href=" http://davidshariff.com/blog/what-is-the-execution-context-in-javascript/">execution context</a></code> is simply a collection of the current <code>context's</code> <code><a href=" http://davidshariff.com/blog/what-is-the-execution-context-in-javascript/#ao">[VO]</a></code> + all parent's lexical <code><a href=" http://davidshariff.com/blog/what-is-the-execution-context-in-javascript/#ao">[VO]</a></code>s.</p><pre>Scope = VO + All Parent VOsEg: scopeChain = [ [VO] + [VO1] + [VO2] + [VO n+1] ]; </pre><h2>Determining a Scope Chain's Variable Objects [VO]s</h2><p>We now know that the first <code>[VO]</code> of the <code>scope chain</code> belongs to the current <code><a href=" http://davidshariff.com/blog/what-is-the-execution-context-in-javascript/">execution context</a></code>, and we can find the remaining parent [VO]s by looking at the parent context's <code>scope chain</code>:</p><pre class=" line-numbers language-javascript"><code class=" language-javascript"><span class="token keyword">function</span> <span class="token function">one <span class="token punctuation">(</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token function">two<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">function</span> <span class="token function">two <span class="token punctuation">(</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token function">three<span class= "token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">function</span> <span class="token function">three<span class="token punctuation">(</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token function"> alert<span class="token punctuation">(</span></span><span class="token string">'I am at function three'</span><span class="token punctuation">)</span><span class="token punctuation">; </span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token function">one<span class= "token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="line-numbers-rows" ><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span> </span><span></span><span></span></span></code></pre><p><img width="378" height="300" alt="" src="http://davidshariff.com/blog/wp-content/uploads/2012/06/stack14.jpg" title="stack1" class= "alignnone size-full wp-image-299 left"></p><p>The example is straight forward, starting from the global context we call <code>one()</code>, <code>one()</code> calls <code>two()</code>, which in turn calls <code>three()</code>, thus alerting that it is at function three. The image above shows the call stack at function <code>three</code> at the time <code>alert('I am at function three')</code> is fired. We can see that the <code>scope chain</code> at this point in time looks as follows:</p><pre>three() Scope Chain = [ [three() VO] + [two() VO] + [one() VO] + [Global VO] ];</pre><h2>Lexical Scope</h2><p>An important feature of JavaScript to note, is that the interpreter uses <code>Lexical Scoping</code>, as opposed to<a href=" http://en.wikipedia.org/wiki/Scope_(computer_science)#Dynamic_scoping"> Dynamic Scoping</a>. This is just a complicated way of saying all inner functions, are statically (lexically) bound to the parent context in which the inner function was physically defined in the program code.</p><p>In our previous example above, it does not matter in which sequence the inner functions are called. <code>three()</code> will always be statically bound to <code>two()</code>, which in turn will always be bound to <code>one()</code> and so on and so forth. This gives a chaining effect where all inner functions can access the outer functions <code>VO</code> through the statically bound <code>Scope Chain</code>.</p><p>This <code>lexical scope</code> is the source of confusion for many developers. We know that every invocation of a function will create a new <code>execution context</code> and associated <code>VO</code>, which holds the values of variables evaluated in the current context. </p><p>It is this dynamic, runtime evaluation of the <code>VO</code> paired with the lexical (static) defined scope of each context that leads unexpected results in program behaviour. Take the following classic example:</p><pre class=" line-numbers left no-b language-javascript"><code class=" language-javascript"><span class="token keyword">var</span> myAlerts <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">5</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    myAlerts<span class="token punctuation">.</span><span class= "token function">push<span class="token punctuation">(</span></span>        <span class="token keyword">function</span> <span class="token function">inner<span class="token punctuation">( </span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token function">alert<span class="token punctuation">(</span></span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">)</span><span class= "token punctuation">;</span><span class="token punctuation">}</span>myAlerts<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">] </span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span spellcheck="true" class="token comment"> // 5</span> myAlerts<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span spellcheck="true" class="token comment"> // 5</span>myAlerts<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span spellcheck="true" class="token comment"> // 5</span>myAlerts<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class= "token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span spellcheck="true" class="token comment"> // 5</span>myAlerts<span class= "token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span spellcheck="true" class="token comment"> // 5</span><span class="line-numbers-rows" ><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span> </span></span></code></pre><p>At first glance, those new to JavaScript would assume <code>alert(i);</code> to be the value of <code>i</code> on each increment where the function was physically defined in the source code, alerting 1, 2, 3, 4 and 5 respectively. </p><p>This is the most common point of confusion. Function <code>inner</code> was created in the global context, therefore its scope chain is statically bound to the global context.</p><p>Lines 11 ~ 15 invoke <code>inner()</code>, which looks in <code>inner.ScopeChain</code> to resolve <code>i</code>, which is located in the <code>global</code> context. At the time of each invocation, <code>i</code>, has already been incremented to 5, giving the same result every time <code>inner()</code> is called. The statically bound scope chain, which holds <code>[VOs]</code> from each <code>context</code> containing live variables, often catches developers by surprise.</p><h2>Resolving the value of variables</h2><p>The following example alerts the value of variables <code>a</code>, <code>b</code> and <code>c</code>, which gives us a result of 6.</p><pre class=" line-numbers no-b language-javascript"><code class=" language-javascript">&#8203;<span class="token keyword">function</span> <span class="token function">one<span class= "token punctuation">(</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>    <span class="token function">two<span class="token punctuation">(</span></span><span class ="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">function</span> <span class="token function">two<span class="token punctuation">( </span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">var</span> b <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>        <span class="token function">three<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">function</span> <span class="token function">three<span class="token punctuation">( </span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token keyword">var</span> c <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span>            <span class="token function">alert<span class="token punctuation">(</span></span>a <span class= "token operator">+</span> b <span class="token operator">+</span> c<span class="token punctuation">)</span><span class="token punctuation">;</span><span spellcheck="true" class="token comment"> // 6</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token function">one <span class="token punctuation">(</span></span><span class="token punctuation">)</span>&#8203;<span class="token punctuation">;</span>&#8203;<span class="line-numbers-rows" ><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span> </span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>Line 14 is intriguing, at first glance it seems that <code>a</code> and <code>b</code> are not "inside" function three, so how can this code still work? To understand how the interpreter evaluates this code, we need to look at the scope chain of function three at the time line 14 was executed:</p><p><img width="600" height="150" alt="" src="http://davidshariff.com/blog/wp-content/uploads/2012/06/scopechain1.png" title="scopechain1" class= "alignnone size-full wp-image-372"></p><p>When the interpreter executes line 14: <code>alert(a + b + c)</code>, it resolves <code>a</code> first by looking into the scope chain and checking the first variable object, <code>three's [VO]</code>. It checks to see if <code>a</code> exists inside <code>three's [VO]</code> but can not find any property with that name, so moves on to check the next <code>[VO]</code>.</p><p>The interpreter keeps checking each <code>[VO]</code> in sequence for the existence of the variable name, in which case the value will be returned to the original evaluated code, or the program will throw a <code>ReferenceError</code> if none is found. Therefore, given the example above, you can see that <code>a</code>, <code>b</code> and <code>c</code> are all resolvable given function three's scope chain.</p><h2>How does this work with closures?</h2><p>In JavaScript, closures are often regarded as some sort of magical unicorn that only advanced developers can really understand, but truth be told it is just a simple understanding of the scope chain. A closure, as <a href=" http://javascript.crockford.com/private.html">Crockford</a> says, is simply:</p><blockquote><p>An inner function always has access to the vars and parameters of its outer function, even after the outer function has returned...</p></blockquote><p>The code below is an example of a closure:</p><pre class=" line-numbers language-javascript"><code class=" language-javascript" ><span class="token keyword">function</span> <span class="token function">foo<span class="token punctuation">(</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token string">'private variable'</span><span class="token punctuation"> ;</span>    <span class="token keyword">return</span> <span class="token keyword">function</span> <span class="token function">bar<span class="token punctuation">(</span></span><span class ="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token function">alert<span class="token punctuation">(</span></span>a<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">var</span> callAlert <span class="token operator">=</span> <span class="token function">foo<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">callAlert<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">; </span><span spellcheck="true" class="token comment"> // private variable</span><span class="line-numbers-rows" ><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>The <code>global context</code> has a function named <code>foo()</code> and a variable named <code>callAlert</code>, which holds the returned value of <code>foo()</code>. What often surprises and confuses developers is that the private variable, <code>a</code>, is still available even after <code>foo()</code> has finished executing.</p><p>However, if we look at each of the context in detail, we will see the following:</p><pre class=" line-numbers left no-b language-javascript"><code class=" language-javascript"><span spellcheck="true" class="token comment">// Global Context when evaluated </span>global<span class="token punctuation">.</span>VO <span class="token operator">=</span> <span class="token punctuation">{</span>    foo<span class="token punctuation">:</span> pointer to <span class="token function">foo<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">,</span>    callAlert<span class="token punctuation">:</span> returned value of global<span class="token punctuation">.</span>VO<span class="token punctuation">.</span>foo    scopeChain<span class="token punctuation">:</span> <span class="token punctuation">[</span>global<span class="token punctuation">.</span>VO<span class="token punctuation">]</span><span class="token punctuation">} </span><span spellcheck="true" class="token comment">// Foo Context when evaluated</span>foo<span class="token punctuation">.</span>VO <span class="token operator">=</span> <span class= "token punctuation">{</span>    bar<span class="token punctuation">:</span> pointer to <span class="token function">bar<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">,</span>    a<span class="token punctuation">:</span> <span class="token string">'private variable'</span><span class="token punctuation">,</span>    scopeChain<span class="token punctuation">:</span> <span class="token punctuation">[</span>foo<span class="token punctuation">.</span>VO<span class="token punctuation">,</span> global<span class="token punctuation">.</span>VO<span class="token punctuation">]</span><span class="token punctuation">}</span><span spellcheck="true" class="token comment">// Bar Context when evaluated</span>bar<span class="token punctuation">.</span>VO <span class="token operator">=</span> <span class="token punctuation">{</span>    scopeChain<span class="token punctuation">:</span> <span class="token punctuation">[</span>bar<span class="token punctuation">.</span>VO<span class="token punctuation">,</span> foo<span class="token punctuation">.</span>VO<span class="token punctuation">,</span> global<span class="token punctuation">.</span>VO<span class="token punctuation">]</span><span class="token punctuation">} </span><span class="line-numbers-rows" ><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span> </span><span></span><span></span><span></span></span></code></pre><p>Now we can see by invoking <code>callAlert()</code>, we get the function <code>foo()</code>, which returns the pointer to <code>bar()</code>. On entering <code>bar()</code>, <code>bar.VO.scopeChain</code> is <code>[bar.VO, foo.VO, global.VO]</code>.</p><p>By alerting <code>a</code>, the interpreter checks the first VO in the <code>bar.VO.scopeChain</code> for a property named <code>a</code> but can not find a match, so promptly moves on to the next VO, <code>foo.VO</code>.</p><p>It checks for the existence of the property and this time finds a match, returning the value back to the <code>bar</code> context, which explains why the <code>alert</code> gives us <code>'private variable'</code> even though <code>foo()</code> had finished executing sometime ago.</p><p>By this point in the article, we have covered the details of the <code>scope chain</code> and its <code>lexical</code> environment, along with how <code>closures</code> and <code>variable resolution</code> work. The rest of this article looks at some interesting situations in relation to those covered above.</p><h2>Wait, how does the prototype chain affect variable resolution?</h2><p>JavaScript is <a href=" http://davidshariff.com/blog/javascript-inheritance-patterns/" title="JavaScript Inheritance Patterns">prototypal</a> by nature and almost everything in the language, except for <code>null </code> and <code>undefined</code>, are <code>objects</code>. When trying to access a property on an <code>object</code>, the interpreter will try to resolve it by looking for the existence of the property in the <code>object</code>. If it can't find the property, it will continue to look up the <a href="http://davidshariff.com/blog/javascript-inheritance-patterns/" title="JavaScript Inheritance Patterns">prototype chain</a>, which is an inherited chain of objects, until it finds the property, or traversed to the end of the chain.</p><p>This leads to an interesting question, does the interpreter resolve an object property using the <code>scope chain</code> or <code>prototype chain</code> first ? It uses both. When trying to resolve a property or identifier, the <code>scope chain</code> will be used first to locate the <code>object</code>. Once the <code>object</code> has been found, the <code>prototype chain</code> of that <code>object</code> will then be traversed looking for the property name. Let's look at an example:</p><pre class=" line-numbers language-javascript"><code class=" language-javascript"><span class="token keyword">var</span> bar <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token keyword">function</span> <span class="token function">foo<span class="token punctuation">(</span></span><span class="token punctuation" >)</span> <span class="token punctuation">{</span>    bar<span class="token punctuation">.</span>a <span class="token operator">=</span> <span class="token string">'Set from foo()' </span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token keyword">function</span> <span class="token function">inner<span class= "token punctuation">(</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token function">alert<span class="token punctuation">(</span></span>bar<span class="token punctuation">.</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation"> }</span><span class="token punctuation">}</span><span class="token function">foo<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span spellcheck="true" class="token comment"> // 'Set from foo()'</span><span class= "line-numbers-rows" ><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre ><p>Line 5 creates the property <code>a</code> on the global object <code>bar</code>, and sets its value to <code>'Set from foo()'</code>. The interpreter looks into the <code>scope chain </code> and as expected finds <code>bar.a</code> in the <code>global context</code>. Now, lets consider the following:</p><pre class=" line-numbers language-javascript"><code class=" language-javascript"><span class="token keyword">var</span> bar <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token keyword">function</span> <span class="token function">foo<span class="token punctuation">(</span></span><span class="token punctuation" >)</span> <span class="token punctuation">{</span>    Object<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>a <span class="token operator">=</span> <span class="token string">'Set from prototype'</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token keyword">function</span> <span class="token function">inner<span class="token punctuation">(</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class= "token function">alert<span class="token punctuation">(</span></span>bar<span class="token punctuation">.</span>a<span class="token punctuation">)</span><span class="token punctuation">; </span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token function">foo<span class="token punctuation">(</span></span><span class= "token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span spellcheck="true" class="token comment"> // 'Set from prototype()'</span><span class="line-numbers-rows" ><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre ><p>At runtime, we invoke <code>inner()</code>, which tries to resolve <code>bar.a</code> by looking in its scope chain for the existence of <code>bar</code>. It finds <code>bar</code> in the global context, and proceeds to search <code>bar</code> for a property named <code>a</code>. However, <code>a</code> was never set on <code>bar</code>, so the interpreter traverses the object's prototype chain and finds <code>a</code> was set on <code>Object.prototype</code>.</p><p>It is this exact behavior which explains identifier resolution; locate the <code> object</code> in the <code>scope chain</code>, then proceed up the object's <code>prototype chain</code> until the property is found, or returned <code>undefined</code>.</p><h2>When to use Closures?</h2><p>Closures are a powerful concept given to JavaScript and some of the most common situations to use them are:</p><ul class="no-list-type"><li><h4>Encapsulation</h4><p> Allows us to hide the implementation details of a context from outside scopes, while exposing a controlled public interface. This is commonly referred to as the <a href=" http://addyosmani.com/resources/essentialjsdesignpatterns/book/#modulepatternjavascript">module pattern</a> or <a href=" http://addyosmani.com/resources/essentialjsdesignpatterns/book/#revealingmodulepatternjavascript">revealing module pattern</a>.</p></li><li><h4>Callbacks</h4><p>Perhaps one of the most powerful uses for closures are callbacks. JavaScript, in the browser, typically runs in a single threaded event loop, blocking other events from starting until one event has finished. Callbacks allow us to defer the invocation of a function, typically in response to an event completing, in a non-blocking manner. An example of this is when making an AJAX call to the server, using a callback to handle to response, while still maintaining the bindings in which it was created.</p></li><li><h4>Closures as arguments</h4><p>We can also pass closures as arguments to a function, which is a powerful functional paradigm for creating more graceful solutions for complex code. Take for example a minimum sort function. By passing closures as parameters, we could define the implementation for different types of data sorting, while still reusing a single function body as a schematic.</p></li></ul><h2>When not to use Closures ? </h2><p>Although closures are powerful, they should be used sparingly due to some performance concerns:</p><ul class="no-list-type"><li><h4>Large scope lengths</h4><p>Multiple nested functions are a typical sign that you might run into some performance issues. Remember, every time you need to evaluate a variable, the Scope Chain must be traversed to find the identifier, so it goes without saying that the further down the chain the variable is defined, the longer to lookup time.</p></li></ul><h2>Garbage collection</h2><p>JavaScript is a <code> garbage collected</code> language, which means developers generally don't have to worry about memory management, unlike lower level programming languages. However, this automatic garbage collection often leads developers application to suffer from poor performance and memory leaks.</p><p>Different JavaScript engines implement garbage collection slightly different, since ECMAScript does not define how the implementation should be handled, but the same philosophy can apply across engines when trying to create high performance, leak free JavaScript code. Generally speaking, the garbage collector will try to free the memory of objects when they can not be referenced by any other live object running in the program, or are unreachable. </p><h3>Circular references</h3><p>This leads us to closures, and the possibility of circular references in a program, which is a term used to describe a situation where one object references another object, and that object points back to the first object. Closures are especially susceptible to leaks, remember that an inner function can reference a variable defined further up the scope chain even after the parent has finished executing and returned. Most JavaScript engines handle these situations quite well (damn you IE), but it's still worth noting and taking into consideration when doing your development.</p><p>For older versions of IE, referencing a DOM element would often cause you memory leaks. Why? In IE, the JavaScript (JScript ?) engine and DOM both have their own individual garbage collector. So when referencing a DOM element from JavaScript, the native collector hands off to the DOM and the DOM collector points back to native, resulting in neither collector knowing about the circular reference.</p><h2>Summary</h2><p>From working with many developers over the past few years, I often found that the concepts of <code>scope chain</code> and <code>closures</code> were known about, but not truly understood in detail. I hope this article has helped to take you from knowing the basic concept, to an understanding in more detail and depth. </p><p>Going forward, you should be armed with all the knowledge you need to determine how the resolution of variables, in any situation, works when writing your JavaScript. Happy coding !</p>											</div>			</div> <!--=========================			END : POST		=============================-->		<!--=========================			START : POST =============================-->		<div class="post-wrapper">		<h1>JavaScript Variables</h1>		<div style="padding:25px 0 0 20px;" class="col-xs-8"><div class="row">    <div class="col-xs-7">        <br>        <h1 class="h1-tutorial">3. JavaScript Variables</h1>        <div class="tutlinks">            <div>• &nbsp;<a class="scrollToTarget" href="#section1"> Primitive types:  number, string, Boolean, null, undefined</a></div>            <div>• &nbsp;<a class="scrollToTarget" href="#section2">Declaring JavaScript variables</a></div> <div>• &nbsp;<a class="scrollToTarget" href="#section3">Variable scoping</a></div>            <div>• &nbsp;<a class="scrollToTarget" href="#section4">Variable and function hoisting </a></div>        </div>    </div>    <div class="col-xs-5">        <div style="text-align:center;" class="ctr">    <a class="link-brown" href= "/products/javascript-jquery-design-pattern-framework">        <img width="160" style="padding:2px 2px 0 0;" alt="Order today!" src= "/Images/Box/javascriptbox%20190x277%20cropped%20noshade1.png">        <br>        The definitive guide<br>for front-end architects    </a></div>    </div></div><br><a name="section1" ></a><br><hr class="hr-orange"><br><h2 class="jsh2">Primitive types:  number, string, Boolean, null, undefined</h2><p>JavaScript supports only a handful of data types. The primitive types are <i>number</i>, <i>string</i>, <i>Boolean</i>, and two special types: <i>null</i> and <i>undefined</i>. These are referred to as primitive types because they are the basic, ready-to-use variable types that are built into the language.  </p><h3>The number variable type</h3><p>JavaScript's number is the only type to hold numbers. It does not distinguish between byte, integer, long, double, or any other numeric type. As far as JavaScript is concerned a number is a number. Most programming languages support a separate integer type, but JavaScript does not. The implication of this is that in JavaScript the values <span class="cd">10</span>, <span class="cd">10.0</span>, and <span class="cd">1e1</span> are all the same. </p><pre class="prettyprint linenums run"><ol class="linenums"><li class="L0"><span class="kwd">var</span><span class="pln"> a </span><span class="pun">=</span><span class="pln"> </span><span class="lit">10</span><span class="pun">;</span><span class="pln">     </span></li><li class="L1"><span class="kwd">var</span><span class="pln"> b </span><span class="pun">= </span><span class="pln"> </span><span class="lit">10.0</span><span class="pun">;</span></li><li class="L2"><span class="kwd">var</span><span class="pln"> c </span><span class="pun">= </span><span class="pln"> </span><span class="lit">1e1</span><span class="pun">;</span></li><li class="L3"><span class="pln">alert</span><span class="pun">(</span><span class="pln">a </span><span class="pun">===</span><span class="pln"> b</span><span class="pun">);</span><span class="pln">     </span><span class="com">// =&gt; true</span></li><li class="L4"><span class ="pln">alert</span><span class="pun">(</span><span class="pln">a </span><span class="pun">===</span><span class="pln"> c</span><span class="pun">);</span><span class="pln"> </span><span class="com">// =&gt; true</span></li><li class="L5"><span class="pln">alert</span><span class="pun">(</span><span class="pln">b </span><span class="pun">===</span><span class= "pln"> c</span><span class="pun">);</span><span class="pln">     </span><span class="com">// =&gt; true</span></li></ol></pre><a onclick="run1();return false" href="javascript:void(0);" class="btn btn-brown">Run</a><script type="text/javascript">    function run1() {        var a = 10;        var b = 10.0;        var c = 1e1;        alert(a === b);     // =&gt; true        alert(a === c);     // =&gt; true        alert(b === c);     // =&gt; true    }</script><p>Here are some valid numeric literals: <span class="cd">1</span>, <span class="cd">209 </span>, <span class="cd">-8</span>, <span class="cd">4.5</span>, <span class="cd">-99.9999</span>, <span class="cd">3e2</span>. </p><p>JavaScript supports two special numeric values: <i> NaN</i> and <i>Infinity</i>. They are discussed on the page about 'JavaScript Operators'.</p><h3>The string variable type</h3><p>JavaScript's strings are immutable sequences of characters. String literals are enclosed by single or double quotes, like so: <span class="cd">"Hello"</span> or <span class="cd">'Hello'</span>. Once created a string cannot be changed (this is what immutable refers to). However, it is easy to create a new string by manipulating existing strings, such as:  <span class="cd">"Hello".substr(3)</span>, which creates a new string with <span class="cd">"lo"</span> as its value.  JavaScript does not support the single character (char) type, but you can easily use a single character string, such, as <span class ="cd">"a"</span>, or <span class="cd">"Y"</span>.  </p><p>Here are some string examples:</p><pre class="prettyprint linenums run"><ol class="linenums"><li class="L0"><span class="kwd">var </span><span class="pln"> s </span><span class="pun">=</span><span class="pln"> </span><span class="str">"Hello World"</span><span class="pun">;</span></li><li class="L1"><span class="kwd" >var</span><span class="pln"> t </span><span class="pun">=</span><span class="pln"> s</span><span class="pun">.</span><span class="pln">substr</span><span class="pun">(</span><span class= "lit">6</span><span class="pun">);</span><span class="pln">      </span><span class="com">// new string </span></li><li class="L2"><span class="pln">alert</span><span class="pun">( </span><span class="pln">t</span><span class="pun">);</span><span class="pln">                 </span><span class="com">// =&gt; World</span></li></ol></pre><a onclick="run2();return false" href="javascript:void(0);" class="btn btn-brown">Run</a><script type="text/javascript">    function run2() {        var s = "Hello World";        var t = s.substr(6);      // new string        alert(t);                 // =&gt; World    }</script><h3>The Boolean variable type</h3><p>Like in other languages, JavaScript's Boolean has two possible values: true and false.  Note that true and false are language keywords and they are distinct from 1 and 0.</p><pre class="prettyprint linenums run"><ol class="linenums"><li class="L0"><span class="kwd"> var</span><span class="pln"> b </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">false</span><span class="pun">;</span></li><li class="L1"><span class="pln"> alert</span><span class="pun">(</span><span class="pln">b</span><span class="pun">);</span><span class="pln">                </span><span class="com">// =&gt; false (i.e. not 0) </span></li></ol></pre><a onclick="run3();return false" href="javascript:void(0);" class="btn btn-brown">Run</a><script type="text/javascript">    function run3() {        var b = false; alert(b);                // =&gt; false (i.e. not 0)    }</script><h3>null and undefined</h3><p>Both <i>null</i> and <i>undefined</i> can be regarded as a special value that indicates "no value". </p><p>The <i>null</i> is a language keyword (in fact, it is an object) which is used to indicate the expected lack of value. On the other hand, <i>undefined</i> is a predefined global variable that has a deeper meaning and is used to indicate an error-like, unexpected lack of value.</p><p>When your function has no return value, it returns undefined. If you declare a variable and don't initialize it, it returns the undefined value. If you query a non-existent array element or object property, again an undefined is returned. Here is an example.</p><pre class="prettyprint linenums run"><ol class="linenums"><li class="L0"><span class="kwd">var</span><span class="pln"> book</span><span class="pun">;</span><span class="pln"> </span></li><li class="L1"><span class="pln">     </span></li><li class="L2"><span class="pln">alert</span><span class="pun">(</span><span class="pln">book</span><span class="pun"> );</span><span class="pln">          </span><span class="com">// =&gt; undefined</span></li><li class="L3"><span class="pln">alert</span><span class="pun">(</span><span class="kwd">typeof </span><span class="pln"> book</span><span class="pun">);</span><span class="pln">   </span><span class="com">// =&gt; undefined </span></li></ol></pre><a onclick="run4();return false" href="javascript:void(0);" class="btn btn-brown">Run</a><script type="text/javascript">    function run4() {        var book;        alert(book);          // =&gt; undefined alert(typeof book);   // =&gt; undefined    }</script><p>If you want to indicate the 'lack of value' in your code, you typically use null rather than undefined.</p><pre class="prettyprint linenums run"><ol class="linenums"><li class="L0"><span class="kwd">var</span><span class="pln"> book </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">null </span><span class="pun">;</span><span class="pln">  </span></li><li class="L1"><span class="pln">      </span></li><li class="L2"><span class="pln">alert</span><span class="pun">( </span><span class="pln">book</span><span class="pun">);</span><span class="pln">          </span><span class="com">// =&gt; null</span></li><li class="L3"><span class="pln">alert </span><span class="pun">(</span><span class="kwd">typeof</span><span class="pln"> book</span><span class="pun">);</span><span class="pln">   </span><span class="com">// =&gt; object (although null is not a true object)</span></li></ol></pre><a onclick="run5();return false" href="javascript:void(0);" class="btn btn-brown">Run</a><script type="text/javascript"> function run5() {        var book = null;        alert(book);          // =&gt; null        alert(typeof book);   // =&gt; object  (although null is not a true object)    }</script><p> Both null and undefined qualify as false when a Boolean value is required. They don't have any properties. If you attempt to access a property on them, an exception will be raised.</p><p> It is considered good practice to leave the use of undefined to JavaScript. In other words, let JavaScript determine if something is undefined, rather than you setting variables or properties to undefined. If your app requires that a variable or property value is unknown, give it a value of null and not undefined.  </p><p>It is interesting to note that undefined is implemented as a global variable named 'undefined'. Its value is undefined. Since it is a global variable, there is nothing that prevents a malicious coder from re-assigning the value of undefined to something else, like so:</p><pre class="prettyprint linenums run"><ol class="linenums"><li class="L0"><span class="com">// hacker's code</span></li><li class="L1"><span class= "kwd">undefined</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">true</span><span class="pun">;</span></li></ol></pre><p>Clearly, this will wreak havoc with many JavaScript programs. Our <a href="/products/javascript-jquery-design-pattern-framework"><b>JavaScript + jQuery Design Pattern Framework</b></a> has a lot more to say about this attack and ways to protect your code against this risk.  To learn more <a href="/products/javascript-jquery-design-pattern-framework">click here</a>.</p><br><a name= "section2"></a><br><hr class="hr-orange"><br><h2 class="jsh2">Declaring JavaScript variables</h2><p>Variables in JavaScript are declared with the var keyword.  You have several options on structuring your variable declaration and initialization: </p><pre class="prettyprint linenums run"><ol class="linenums"><li class="L0"><span class="com">// declaring one variable </span></li><li class="L1"><span class="kwd">var</span><span class="pln"> cost</span><span class="pun">;</span><span class="pln">                    </span></li><li class="L2"><span class= "com">// declaring multiple variables, delimited by commas</span></li><li class="L3"><span class="kwd">var</span><span class="pln"> cost</span><span class="pun">,</span><span class="pln"> profit</span><span class="pun">;</span><span class="pln">            </span></li><li class="L4"><span class="com">// declaring and assigning one variable</span></li><li class="L5"><span class="kwd">var</span><span class="pln"> cost </span><span class="pun">=</span><span class="pln"> </span><span class="lit">120</span><span class="pun">;</span><span class="pln"> </span></li><li class="L6"><span class="com">// declaring and assigning multiple variables</span></li><li class="L7"><span class="kwd">var</span><span class="pln"> cost </span><span class="pun">=</span><span class="pln"> </span><span class="lit">120</span><span class="pun">,</span><span class="pln"> profit </span><span class="pun">=</span><span class= "pln"> </span><span class="lit">77</span><span class="pun">;</span><span class="pln"> </span></li></ol></pre><p>You can declare one variable at a time. </p><p>Let's look at variable naming rules. A variable name can contain any combination of alpha-numeric characters, the $ sign, and the underscore character. Its first character cannot be a digit. Variable names cannot contain space characters or any of the punctuation characters. Here are some examples of valid variable identifiers:</p><pre class="prettyprint linenums run"><ol class="linenums" ><li class="L0"><span class="kwd">var</span><span class="pln"> _groupName_</span><span class="pun">;</span></li><li class="L1"><span class="kwd">var</span><span class="pln"> $bicycle12 </span><span class="pun">;</span><span class="pln"> </span></li><li class="L2"><span class="kwd">var</span><span class="pln"> ABH</span><span class="pun">;</span></li><li class="L3"><span class="kwd">var</span><span class="pln"> particle_X_Y</span><span class="pun">;</span></li><li class="L4"><span class="kwd">var</span><span class="pln"> abc$123</span><span class="pun">; </span></li><li class="L5"><span class="kwd">var</span><span class="pln"> easy</span><span class="pun">;</span></li></ol></pre><h3>Implied global variables</h3><p>If a variable is not declared explicitly (using var), then JavaScript will automatically treat it as a global variable. This can hide misspelled and forgotten variable declarations and consequently introduce bugs in your program. This is demonstrated below. The variable count is missing a var and will be created implicitly. The variable reslt is a misspelling of 'result' and a new global variable named 'reslt' will be created. Worse, the original result value will always remain false. </p><pre class="prettyprint linenums run"><ol class="linenums"><li class="L0"><span class ="pln">count </span><span class="pun">=</span><span class="pln"> </span><span class="lit">4</span><span class="pun">;</span><span class="pln">                 </span><span class="com">// = &gt; global count is created</span></li><li class="L1"><span class="kwd">var</span><span class="pln"> result </span><span class="pun">=</span><span class="pln"> </span><span class="kwd"> false</span><span class="pun">;</span></li><li class="L2"><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">condition </span><span class= "pun">===</span><span class="pln"> </span><span class="kwd">true</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span></li><li class="L3"><span class="pln"> reslt </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">true</span><span class="pun">;</span><span class="pln">          </span><span class="com">// =&gt; global reslt is created!</span></li><li class="L4"><span class="pun">}</span></li></ol></pre><p>As you can see, typos are not called out in JavaScript and can lead to subtle and hard-to-detect bugs.</p><p>JSLint uncovers implied global variables and requires that you declare them explicitly using the var keyword before they are assigned a value. Using var also improves program readability. Even if you use var, you still have to be careful when chaining declarations and assignments. In the following code all seems fine, but total is a local variable, but summary is an implied global.</p><pre class="prettyprint linenums run"><ol class="linenums"><li class="L0"><span class="kwd">function</span><span class="pln"> calculate </span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span></li><li class="L1"><span class="pln">   </span><span class="kwd">var</span><span class="pln"> total </span><span class="pun">=</span><span class="pln"> summary </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln" >   </span><span class="com">// =&gt; summary is implied global variable</span></li><li class="L2"><span class="pln">   </span><span class="pun">...</span></li><li class="L3"><span class= "pun">}</span></li></ol></pre><p>The expression <span class="cd">summary = 0</span> is evaluated first. Since <span class="cd">summary</span> is not declared, it is treated as global. The expression returns the value 0 which is further assigned to the variable <span class="cd">total</span>. Because <span class="cd">total</span> is declared with a <span class="cd">var</span> keyword, it is a local variable with function scope.</p><h3>Variables as properties</h3><p>When declaring a global variable, you are actually defining a property on the global object. If the global variable is created with <span class="cd">var</span>, the property that is created cannot be deleted (undefined) with the delete operator. On the other hand, implied globals can be deleted.</p><pre class="prettyprint linenums run"><ol class="linenums"><li class="L0"><span class="kwd">var</span><span class="pln"> a </span><span class="pun">=</span><span class= "pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">        </span><span class="com">// =&gt; explicit global</span></li><li class="L1"><span class="pln">b </span><span class="pun">=</span><span class="pln"> </span><span class="lit">2</span><span class="pun">;</span><span class="pln">            </span><span class="com">// =&gt; implied global</span></li><li class="L2"><span class="kwd">delete</span><span class="pln"> a</span><span class="pun">;</span><span class="pln">         </span><span class="com">// =&gt; cannot delete</span></li><li class="L3"><span class="kwd">delete</span><span class="pln"> b</span><span class="pun">;</span><span class="pln">         </span><span class="com">// =&gt; deleted </span></li></ol></pre><br><a name="section3"></a><br><hr class="hr-orange"><br><h2 class="jsh2">Variable scoping</h2><p>The scope of the variable determines its <i>visibility</i> and its <i>lifetime</i>.  Visibility determines the portions of the program in which it can be 'seen' and referenced.  Lifetime is the period during execution of a program in which a variable or function exists</p><p>In programming, variable scoping is an important concept. JavaScript supports two scope-levels, <i>global</i> and <i>functional</i>, which are discussed next. </p><h3>Global scope and function scope</h3><p>In JavaScript, all variables that are defined outside functions are globally scoped; this means they are visible and accessible anywhere in the program. Variables that are defined inside a function have function scope, meaning they are only visible and accessible within the function, for the duration of that function. </p><p> In the example below variable <span class="cd">g</span> is global and is visible anywhere, including the function. The variables <span class="cd">u</span> and <span class="cd">c</span> are only visible within the function.  It is said that variable <span class="cd">g</span> has global scope and variables <span class="cd">u</span> and <span class="cd">c</span> have function scope.</p><pre class="prettyprint linenums run"><ol class="linenums"><li class="L0"><span class="kwd">var</span><span class="pln"> g </span><span class="pun">=</span><span class= "pln"> </span><span class="str">"World"</span><span class="pun">;</span><span class="pln">           </span><span class="com">// global scope</span></li><li class="L1"><span class="kwd"> function</span><span class="pln"> countries</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span></li><li class="L2"><span class="pln">    </span><span class="kwd">var</span><span class="pln"> u </span><span class="pun">=</span><span class="pln"> </span><span class="str">"US"</span><span class="pun">;</span><span class="pln"> </span><span class="com">// function scope</span></li><li class="L3"><span class="pln">    </span><span class="kwd">var</span><span class="pln"> c </span><span class="pun">=</span><span class="pln"> </span><span class="str">"China"</span><span class="pun">;</span><span class="pln">       </span><span class="com">// function scope</span></li><li class="L4"><span class= "pln">    alert</span><span class="pun">(</span><span class="pln">g</span><span class="pun">);</span><span class="pln">              </span><span class="com">// =&gt; World</span></li><li class="L5"><span class="pln">    alert</span><span class="pun">(</span><span class="pln">u</span><span class="pun">);</span><span class="pln">              </span><span class="com">// = &gt; US</span></li><li class="L6"><span class="pln">    alert</span><span class="pun">(</span><span class="pln">c</span><span class="pun">);</span><span class="pln"> </span><span class="com">// =&gt; China</span></li><li class="L7"><span class="pun">}</span></li><li class="L8"><span class="pln">countries</span><span class="pun">();</span></li><li class ="L9"><span class="pln">alert</span><span class="pun">(</span><span class="pln">g</span><span class="pun">);</span><span class="pln">                  </span><span class="com">// =&gt; World</span></li><li class="L0"><span class="pln">alert</span><span class="pun">(</span><span class="kwd">typeof</span><span class="pln"> u</span><span class="pun">);</span><span class= "pln">           </span><span class="com">// =&gt; undefined</span></li></ol></pre><a onclick="run20();return false" href="javascript:void(0);" class="btn btn-brown">Run</a><script type= "text/javascript">    function run20() {        var g = "World";           // global scope        function countries() {            var u = "US";          // function scope            var c = "China";       // function scope            alert(g);              // =&gt; World            alert(u);              // =&gt; US            alert(c);              // =&gt; China }        countries();        alert(g);                  // =&gt; World        alert(typeof u);           // =&gt; undefined    }</script><p>The last line demonstrates the variable <span class="cd">u</span> is not visible outside the <span class="cd">countries()</span> function. </p><h3>Function scope hides global scope</h3><p>If you declare a local variable inside a function with the exact same name as a global variable, then the local variable will hide the global variable. In the next example, the local client variable hides the global client variable. </p><pre class="prettyprint linenums run"><ol class="linenums"><li class="L0"><span class="kwd">var</span><span class="pln"> client </span><span class="pun">=</span><span class= "pln"> </span><span class="str">"Joan"</span><span class="pun">;</span><span class="pln">            </span><span class="com">// global</span></li><li class="L1"><span class="kwd">function </span><span class="pln"> getClient</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span></li><li class="L2"><span class="pln">   </span><span class="kwd"> var</span><span class="pln"> client </span><span class="pun">=</span><span class="pln"> </span><span class="str">"Timothy"</span><span class="pun">;</span><span class="pln"> </span><span class="com">// local, hides global</span></li><li class="L3"><span class="pln">   </span><span class="kwd">return</span><span class="pln"> client</span><span class="pun">; </span></li><li class="L4"><span class="pun">}</span></li><li class="L5"><span class="pln">alert</span><span class="pun">(</span><span class="pln">getClient</span><span class="pun">()); </span><span class="pln">             </span><span class="com">// =&gt; "Timothy"</span></li></ol></pre><a onclick="run21();return false" href="javascript:void(0);" class="btn btn-brown"> Run</a><script type="text/javascript">    function run21() {        var client = "Joan";            // global        function getClient() {            var client = "Timothy";      // local, hides global            return client;        }        alert(getClient());             // =&gt; "Timothy"    }</script><h3>JavaScript does not support block scope</h3><p>In C-like languages, when control enters a code block (for example an if statement enclosed by brackets), then local variables defined within the block will have their own execution context and are destroyed when the closing block brace is encountered.  However, JavaScript does not support block-level scoping, only function and global level scoping.</p><p>In the example below, the client variable in the if-block refers to the global variable. There is no hiding or anything of that nature, just one global variable named client.</p><pre class="prettyprint linenums run"><ol class="linenums"><li class="L0"><span class="kwd">var</span><span class="pln"> client </span><span class="pun">=</span><span class="pln"> </span><span class="str">"Joan" </span><span class="pun">;</span></li><li class="L1"><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">true</span><span class="pun">) </span><span class="pln"> </span><span class="pun">{</span></li><li class="L2"><span class="pln">   </span><span class="kwd">var</span><span class="pln"> client </span><span class="pun">= </span><span class="pln"> </span><span class="str">"Timothy"</span><span class="pun">;</span><span class="pln">   </span><span class="com">// refers to global variable</span></li><li class ="L3"><span class="pln">   alert</span><span class="pun">(</span><span class="pln">client</span><span class="pun">);</span><span class="pln">            </span><span class="com">// =&gt; "Timothy" </span></li><li class="L4"><span class="pun">}</span></li><li class="L5"><span class="pln">alert</span><span class="pun">(</span><span class="pln">client</span><span class="pun"> );</span><span class="pln">               </span><span class="com">// =&gt; "Timothy"</span></li></ol></pre><a onclick="run22();return false" href="javascript:void(0);" class="btn btn-brown">Run</a><script type="text/javascript">    function run22() {        var client = "Joan";        if (true) {            var client = "Timothy";   // refers to global variable            alert(client);            // =&gt; "Timothy"        }        alert(client);               // =&gt; "Timothy"    }</script><h3>Looping variables</h3><p>When using variables in <span class="cd">for</span> loops you have to be careful because they continue to exist outside the loop. In the example below, the for-statement creates the variable <span class="cd">i</span> which continues to exist outside the loop, even after the for-statement finishes execution. Most other languages that support block level scoping the looping variables cease to exist outside the for loop.</p><pre class="prettyprint linenums run"><ol class="linenums"><li class="L0"><span class="kwd">for</span><span class="pln"> </span><span class="pun">( </span><span class="kwd">var</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;</span><span class="pln"> </span><span class="lit">5</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln"> </span><span class="pun">{</span></li><li class="L1"><span class="pln">    </span><span class="com">// do something </span></li><li class="L2"><span class="pun">}</span></li><li class="L3" ><span class="pln">alert</span><span class="pun">(</span><span class="pln">i</span><span class="pun">);</span><span class="pln">     </span><span class="com">// =&gt; 5 </span></li></ol></pre><a onclick="run23();return false" href="javascript:void(0);" class="btn btn-brown">Run</a><h2 class="jsh2">Variable and function hoisting</h2><p>The JavaScript compiler invisibly moves (hoists) all the variables to the top of their containing scope.  Consider this code: </p><pre class="prettyprint linenums run"><ol class="linenums"><li class="L0" ><span class="kwd">function</span><span class="pln"> f</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span></li><li class="L1"><span class="pln"> doSomething</span><span class="pun">();</span></li><li class="L2"><span class="pln">    </span><span class="kwd">var</span><span class="pln"> count</span><span class="pun">;</span></li><li class="L3"><span class="pun">}</span></li></ol></pre><p>JavaScript transforms this code to this: </p><pre class="prettyprint linenums run"><ol class="linenums"><li class="L0"><span class= "kwd">function</span><span class="pln"> f</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span></li><li class="L1"><span class="pln">    </span><span class= "kwd">var</span><span class="pln"> count</span><span class="pun">;</span><span class="pln">               </span><span class="com">// hoisted</span></li><li class="L2"><span class="pln"> doSomething</span><span class="pun">();</span></li><li class="L3"><span class="pun">}</span></li></ol></pre><p>All variables that you declare inside a function are visible throughout the function body (this is what we mean with function scope). This implies that variables are visible even before they are declared, but using a variable before it is initialized can lead to bugs. Here is an example:</p><pre class="prettyprint linenums run"><ol class="linenums"><li class="L0"><span class="kwd">var</span><span class="pln"> x </span><span class="pun">= </span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span></li><li class="L1"><span class="kwd">function</span><span class="pln"> f </span><span class="pun">() </span><span class="pln"> </span><span class="pun">{</span></li><li class="L2"><span class="pln">    alert</span><span class="pun">(</span><span class="pln">x</span><span class="pun">); </span><span class="pln">        </span><span class="com">// =&gt; undefined</span></li><li class="L3"><span class="pln">    </span><span class="kwd">var</span><span class="pln"> x </span><span class="pun">=</span><span class="pln"> </span><span class="lit">2</span><span class="pun">;</span></li><li class="L4"><span class="pun">}</span></li></ol></pre><p>Notice we have a global variable <span class="cd">x</span> and a local variable <span class="cd">x</span>.  The undefined result may surprise you.  Perhaps you expected a value of 1 or possibly 2, but not undefined. It's all because of hoisting which involves the variable declaration, but does not include the assignment portion.  Here is how the code executes:</p><pre class= "prettyprint linenums run"><ol class="linenums"><li class="L0"><span class="kwd">var</span><span class="pln"> x </span><span class="pun">=</span><span class="pln"> </span><span class="lit" >1</span><span class="pun">;</span></li><li class="L1"><span class="kwd">function</span><span class="pln"> f </span><span class="pun">()</span><span class="pln"> </span><span class="pun">{ </span></li><li class="L2"><span class="pln">    </span><span class="kwd">var</span><span class="pln"> x</span><span class="pun">;</span><span class="pln">        </span><span class="com"> // hoisted. hides global variable, but is unitialized.</span></li><li class="L3"><span class="pln">    alert</span><span class="pun">(</span><span class="pln">x</span><span class="pun">); </span><span class="pln">     </span><span class="com">// =&gt; undefined </span></li><li class="L4"><span class="pln">    x </span><span class="pun">=</span><span class="pln"> </span><span class="lit">2</span><span class="pun">;</span></li><li class="L5"><span class="pun">}</span></li></ol></pre><h3>Function hoisting</h3><p>Not only variables, but also functions are hoisted. Consider the following code:</p><pre class="prettyprint linenums run"><ol class="linenums"><li class="L0"><span class="kwd">var</span><span class="pln"> text </span><span class="pun">=</span><span class="pln"> </span><span class="str">"Hello"</span><span class="pun">;</span></li><li class="L1"><span class="kwd">function</span><span class="pln"> f</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span></li><li class="L2"><span class="pln">   text </span><span class="pun">=</span><span class="pln"> </span><span class="str">"Greetings"</span><span class="pun">;</span></li><li class="L3"><span class="pln">   </span><span class="kwd">return</span><span class="pun">;</span></li><li class ="L4"><span class="pln">   </span><span class="kwd">function</span><span class="pln"> text</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{}</span></li><li class="L5"><span class="pun">}</span></li><li class="L6"><span class="pln">f</span><span class="pun">();</span></li><li class="L7"><span class="pln">alert</span><span class="pun">( </span><span class="pln">text</span><span class="pun">);</span><span class="pln">            </span><span class="com">// =&gt; "Hello"</span></li></ol></pre><a onclick="run40();return false" href="javascript:void(0);" class="btn btn-brown">Run</a><script type="text/javascript">    function run40() {        var text = "Hello";        function f() {            text = "Greetings";            return;            function text() { }        }        f();        alert(text);            // =&gt; "Hello"    }</script><p>What is going on here?  Well, the compiler lifts (hoists) the local function <span class="cd">text()</span> to the top of <span class="cd">f()</span>'s function body. Since declarations are function-scoped, the assignment of "Greetings" is made to the local <span class="cd">text</span> instance (which is a function) and, therefore, the global text variable remains unchanged.  The code executes like this: </p><pre class="prettyprint linenums run"><ol class="linenums"><li class="L0"><span class="kwd">var</span><span class="pln"> text </span><span class="pun">=</span><span class="pln"> </span><span class="str">"Hello"</span><span class="pun">;</span></li><li class="L1"><span class="kwd">function</span><span class="pln"> f</span><span class="pun">()</span><span class= "pln"> </span><span class="pun">{</span></li><li class="L2"><span class="pln">   </span><span class="kwd">function</span><span class="pln"> text</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{}</span><span class="pln">    </span><span class="com">// local variable text. Hides global text.</span></li><li class="L3"><span class="pln"> text </span><span class="pun">=</span><span class="pln"> </span><span class="str">"Greetings"</span><span class="pun">;</span><span class="pln">   </span><span class="com">// local assignment to function named text</span></li><li class="L4"><span class="pln">   </span><span class="kwd">return</span><span class="pun">;</span></li><li class="L5"><span class="pun">} </span></li><li class="L6"><span class="pln">f</span><span class="pun">();</span></li><li class="L7"><span class="pln">alert</span><span class="pun">(</span><span class="pln">text </span><span class="pun">);</span><span class="pln">            </span><span class="com">// =&gt; "Hello"</span></li></ol></pre><a onclick="run41();return false" href="javascript:void(0);" class="btn btn-brown">Run</a><script type="text/javascript">    function run41() {        var text = "Hello";        function f() {            function text() { }    // local variable text. Hides global text.            text = "Greetings";   // local assignment to function named text            return;        }        f();        alert(text);            // =&gt; "Hello"    }</script><p>Finally, consider this example in which two local print functions are within an if-else statement: </p><pre class="prettyprint linenums run"><ol class="linenums" ><li class="L0"><span class="kwd">function</span><span class="pln"> f</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span></li><li class="L1"><span class= "pln">  </span><span class="kwd">var</span><span class="pln"> condition </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">true</span><span class="pun">; </span></li><li class="L2"><span class="pln">  </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">condition</span><span class="pun">) </span><span class="pln"> </span><span class="pun">{</span></li><li class="L3"><span class="pln">     </span><span class="kwd">function</span><span class="pln"> </span><span class="kwd"> print</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> alert</span><span class="pun">(</span><span class="str">"true"</span><span class="pun">);</span><span class="pln"> </span><span class="pun">};</span></li><li class="L4"><span class="pln">  </span><span class="pun">}</span><span class="pln"> </span><span class= "kwd">else</span><span class="pln"> </span><span class="pun">{</span></li><li class="L5"><span class="pln">     </span><span class="kwd">function</span><span class="pln"> </span><span class="kwd">print</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> alert</span><span class="pun">(</span><span class="str">"false" </span><span class="pun">);</span><span class="pln"> </span><span class="pun">};</span></li><li class="L6"><span class="pln">  </span><span class="pun">}</span></li><li class="L7"><span class="pln">  </span><span class="kwd">print</span><span class="pun">();</span><span class="pln">               </span><span class="com">// =&gt; true or false (depending on browser) </span></li><li class="L8"><span class="pun">}</span></li><li class="L9"><span class="pln">f</span><span class="pun">();</span></li></ol></pre><a onclick="run42();return false" href= "javascript:void(0);" class="btn btn-brown">Run</a><script type="text/javascript">    function run42() {        function f() {            var condition = true;            if (condition) { function print() { alert("true"); };            } else {                function print() { alert("false"); };            }            print();               // =&gt; true or false (depending on browser)        }        f();    }</script><p>We know that functions get hoisted, so what will happen? Since the value of condition is true, you may expect that the <span class="cd">print()</span> inside the if block will execute. But this is not the case. IE prints false and Firefox prints true. What this indicates is that hoisting is not concerned about the runtime code, that is, at compile time the conditions in the if-else statements are irrelevant. Also, there are no definite rules that dictate which function declaration shall prevail over the others.</p><p>The lesson learned here is that side effects of implicit global variables and of hoisting can result in hard-to-find bugs. Our <a href= "/products/javascript-jquery-design-pattern-framework"><b>JavaScript + jQuery Design Pattern Framework</b></a> offers proven patterns and best practice techniques to minimize these kinds of problems. To learn more <a href="/products/javascript-jquery-design-pattern-framework">click here</a>. </p>                </div>			</div> <!--=========================			END : POST		=============================-->		<!--=========================			START : POST =============================-->		<div class="post-wrapper">		<h1>JavaScript Design Pattern : Factory Method</h1>		<div style="padding: 10px 0 0 30px;"> <h3>Definition</h3>                    <div style="width:80%;padding:6px 0;">                        Define an interface for creating an object, but let subclasses decide which class to instantiate. Factory Method lets a class defer instantiation to subclasses.                    </div>                    <br>                    <div class="clearfix"> <div style="padding:5px 20px 0 0;" class="pull-left">Frequency of use (<i>in JavaScript</i>):</div>                        <div class="pull-left"><img src= "/images/use_medium_high.gif"></div>                        <div style="padding:5px 0px 0 15px;" class="pull-left">medium high</div>                    </div>                    <br> <hr class="hr-orange">                    <br>                    <div style="width:90%;"><h3 class="phead">Summary</h3><p class="ptext">    A Factory Method creates new objects as instructed by the client. One way to create objects in JavaScript is by invoking a constructor function with the new operator.    There are situations however, where the client does not, or should not, know which one of several candidate objects to instantiate.    The Factory Method allows the client to delegate object creation while still retaining control over which type to instantiate.</p><p class="ptext">    The key objective of the Factory Method is extensibility. Factory Methods are frequently used in applications that manage, maintain,    or manipulate collections of objects that are different but at the same time have many characteristics (i.e. methods and properties) in common.    An example would be a collection of documents with a mix of Xml documents, Pdf documents, and Rtf documents.</p><br><h3 class="phead">Diagram</h3><div style="padding-left:30px;">    <img alt="Diagram JavaScript Factory Method Design Pattern" src="/images/diagrams/javascript/javascript-factory-method.jpg" class="diagram"></div><br><br><h3 class="phead">Participants</h3><div class= "ptext">    The objects participating in this pattern are:    <br><br>    <ul>        <li>            <b>Creator</b> -- In sample code: <b style="color:#088;">Factory</b>            <ul> <li>the 'factory' object that creates new products</li>                <li>implements 'factoryMethod' which returns newly created products</li>            </ul> </li>        <li>            <b>AbstractProduct</b> -- not used in JavaScript            <ul>                <li>declares an interface for products</li>            </ul>        </li> <li>            <b>ConcreteProduct</b> -- In sample code: <b style="color:#088;">Employees</b>            <ul>                <li>the product being created</li>                <li> all products support the same interface (properties and methods)</li>            </ul>        </li>    </ul></div><br><h3 class="phead">Sample code in JavaScript</h3><p class="ptext"> In this JavaScript example the <span class="cd">Factory</span> object creates four different types of employees.    Each employee type has a different hourly rate.  The <span class="cd"> createEmployee</span> method is the actual Factory Method.    The client instructs the factory what type of employee to create by passing a type argument into the Factory Method.</p><p class="ptext">    The AbstractProduct in the diagram is not implemented because Javascript does not support abstract classes or interfaces.    However, we still need to ensure that all employee types have the same interface (properties and methods).</p><p class="ptext">    Four different employee types are created; all are stored in the same array.    Each employee is asked to say what they are and their hourly rate.</p><p class="ptext">    The <span class="cd">log</span> function is a helper which collects and displays results.</p><pre class= "prettyprint linenums run"><ol class="linenums"><li class="L0"><span class="kwd">function</span><span class="pln"> </span><span class="typ">Factory</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span></li><li class="L1"><span class="pln">    </span><span class="kwd">this</span><span class="pun">.</span><span class="pln">createEmployee </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">function</span><span class="pln"> </span><span class="pun">(</span><span class="pln">type</span><span class= "pun">)</span><span class="pln"> </span><span class="pun">{</span></li><li class="L2"><span class="pln">        </span><span class="kwd">var</span><span class="pln"> employee</span><span class="pun">;</span></li><li class="L3"><span class="pln">&nbsp;</span></li><li class="L4"><span class="pln">        </span><span class="kwd">if</span><span class="pln"> </span><span class ="pun">(</span><span class="pln">type </span><span class="pun">===</span><span class="pln"> </span><span class="str">"fulltime"</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span></li><li class="L5"><span class="pln">            employee </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">FullTime</span><span class="pun">();</span></li><li class="L6"><span class="pln">        </span><span class="pun">}</span><span class="pln"> </span><span class="kwd">else</span><span class="pln"> </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">type </span><span class="pun" >===</span><span class="pln"> </span><span class="str">"parttime"</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span></li><li class="L7"><span class="pln"> employee </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">PartTime</span><span class="pun">(); </span></li><li class="L8"><span class="pln">        </span><span class="pun">}</span><span class="pln"> </span><span class="kwd">else</span><span class="pln"> </span><span class="kwd">if </span><span class="pln"> </span><span class="pun">(</span><span class="pln">type </span><span class="pun">===</span><span class="pln"> </span><span class="str">"temporary"</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span></li><li class="L9"><span class="pln">            employee </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">Temporary</span><span class="pun">();</span></li><li class="L0"><span class="pln">        </span><span class= "pun">}</span><span class="pln"> </span><span class="kwd">else</span><span class="pln"> </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class= "pln">type </span><span class="pun">===</span><span class="pln"> </span><span class="str">"contractor"</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{ </span></li><li class="L1"><span class="pln">            employee </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">Contractor</span><span class="pun">();</span></li><li class="L2"><span class="pln">        </span><span class="pun">}</span></li><li class="L3"><span class="pln">&nbsp; </span></li><li class="L4"><span class="pln">        employee</span><span class="pun">.</span><span class="pln">type </span><span class="pun">=</span><span class="pln"> type</span><span class="pun">;</span></li><li class="L5"><span class="pln">&nbsp;</span></li><li class="L6"><span class="pln">        employee</span><span class="pun">.</span><span class="pln">say </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">function</span><span class="pln"> </span><span class="pun">()</span><span class="pln"> </span><span class="pun" >{</span></li><li class="L7"><span class="pln">            log</span><span class="pun">.</span><span class="pln">add</span><span class="pun">(</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">type </span><span class="pun">+</span><span class="pln"> </span><span class="str">": rate "</span><span class="pln"> </span><span class="pun">+ </span><span class="pln"> </span><span class="kwd">this</span><span class="pun">.</span><span class="pln">hourly </span><span class="pun">+</span><span class="pln"> </span><span class= "str">"/hour"</span><span class="pun">);</span></li><li class="L8"><span class="pln">        </span><span class="pun">}</span></li><li class="L9"><span class="pln">&nbsp;</span></li><li class="L0"><span class="pln">        </span><span class="kwd">return</span><span class="pln"> employee</span><span class="pun">;</span></li><li class="L1"><span class="pln"> </span><span class="pun">}</span></li><li class="L2"><span class="pun">}</span></li><li class="L3"><span class="pln">&nbsp;</span></li><li class="L4"><span class="kwd">var</span><span class="pln"> </span><span class="typ">FullTime</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">function</span><span class="pln"> </span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span></li><li class="L5"><span class="pln">    </span><span class="kwd">this</span><span class="pun">. </span><span class="pln">hourly </span><span class="pun">=</span><span class="pln"> </span><span class="str">"$12"</span><span class="pun">;</span></li><li class="L6"><span class="pun">}; </span></li><li class="L7"><span class="pln">&nbsp;</span></li><li class="L8"><span class="kwd">var</span><span class="pln"> </span><span class="typ">PartTime</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">function</span><span class="pln"> </span><span class="pun">()</span><span class="pln"> </span><span class="pun" >{</span></li><li class="L9"><span class="pln">    </span><span class="kwd">this</span><span class="pun">.</span><span class="pln">hourly </span><span class="pun">=</span><span class="pln" > </span><span class="str">"$11"</span><span class="pun">;</span></li><li class="L0"><span class="pun">};</span></li><li class="L1"><span class="pln">&nbsp;</span></li><li class="L2"><span class="kwd">var</span><span class="pln"> </span><span class="typ">Temporary</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">function </span><span class="pln"> </span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span></li><li class="L3"><span class="pln">    </span><span class="kwd">this </span><span class="pun">.</span><span class="pln">hourly </span><span class="pun">=</span><span class="pln"> </span><span class="str">"$10"</span><span class="pun">;</span></li><li class= "L4"><span class="pun">};</span></li><li class="L5"><span class="pln">&nbsp;</span></li><li class="L6"><span class="kwd">var</span><span class="pln"> </span><span class="typ">Contractor </span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">function</span><span class="pln"> </span><span class="pun">()</span><span class="pln" > </span><span class="pun">{</span></li><li class="L7"><span class="pln">    </span><span class="kwd">this</span><span class="pun">.</span><span class="pln">hourly </span><span class="pun" >=</span><span class="pln"> </span><span class="str">"$15"</span><span class="pun">;</span></li><li class="L8"><span class="pun">};</span></li><li class="L9"><span class="pln">&nbsp; </span></li><li class="L0"><span class="com">// log helper</span></li><li class="L1"><span class="kwd">var</span><span class="pln"> log </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">function</span><span class="pln"> </span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span></li><li class= "L2"><span class="pln">    </span><span class="kwd">var</span><span class="pln"> log </span><span class="pun">=</span><span class="pln"> </span><span class="str">""</span><span class="pun" >;</span></li><li class="L3"><span class="pln">&nbsp;</span></li><li class="L4"><span class="pln">    </span><span class="kwd">return</span><span class="pln"> </span><span class="pun">{ </span></li><li class="L5"><span class="pln">        add</span><span class="pun">:</span><span class="pln"> </span><span class="kwd">function</span><span class="pln"> </span><span class= "pun">(</span><span class="pln">msg</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> log </span><span class="pun">+=</span><span class ="pln"> msg </span><span class="pun">+</span><span class="pln"> </span><span class="str">"\n"</span><span class="pun">;</span><span class="pln"> </span><span class="pun">},</span></li><li class="L6"><span class="pln">        show</span><span class="pun">:</span><span class="pln"> </span><span class="kwd">function</span><span class="pln"> </span><span class="pun">() </span><span class="pln"> </span><span class="pun">{</span><span class="pln"> alert</span><span class="pun">(</span><span class="pln">log</span><span class="pun">);</span><span class="pln" > log </span><span class="pun">=</span><span class="pln"> </span><span class="str">""</span><span class="pun">;</span><span class="pln"> </span><span class="pun">}</span></li><li class= "L7"><span class="pln">    </span><span class="pun">}</span></li><li class="L8"><span class="pun">})();</span></li><li class="L9"><span class="pln">&nbsp;</span></li><li class="L0"><span class="kwd">function</span><span class="pln"> run</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span></li><li class="L1"><span class="pln"> </span><span class="kwd">var</span><span class="pln"> employees </span><span class="pun">=</span><span class="pln"> </span><span class="pun">[];</span></li><li class="L2"><span class="pln" >    </span><span class="kwd">var</span><span class="pln"> factory </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">Factory</span><span class="pun">();</span></li><li class="L3"><span class="pln">&nbsp;</span></li><li class="L4"><span class="pln">    employees</span><span class="pun">. </span><span class="pln">push</span><span class="pun">(</span><span class="pln">factory</span><span class="pun">.</span><span class="pln">createEmployee</span><span class="pun">( </span><span class="str">"fulltime"</span><span class="pun">));</span></li><li class="L5"><span class="pln">    employees</span><span class="pun">.</span><span class="pln">push</span><span class="pun">(</span><span class="pln">factory</span><span class="pun">.</span><span class="pln">createEmployee</span><span class="pun">(</span><span class="str">"parttime"</span><span class="pun">));</span></li><li class="L6"><span class="pln">    employees</span><span class="pun">.</span><span class="pln">push</span><span class="pun">(</span><span class="pln">factory </span><span class="pun">.</span><span class="pln">createEmployee</span><span class="pun">(</span><span class="str">"temporary"</span><span class="pun">));</span></li><li class="L7"><span class="pln">    employees</span><span class="pun">.</span><span class="pln">push</span><span class="pun">(</span><span class="pln">factory</span><span class="pun">.</span><span class="pln" >createEmployee</span><span class="pun">(</span><span class="str">"contractor"</span><span class="pun">));</span></li><li class="L8"><span class="pln">    </span></li><li class="L9"><span class="pln">    </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">var</span><span class="pln"> i </span><span class="pun">= </span><span class="pln"> </span><span class="lit">0</span><span class="pun">,</span><span class="pln"> len </span><span class="pun">=</span><span class="pln"> employees</span><span class= "pun">.</span><span class="pln">length</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;</span><span class="pln"> len</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln"> </span><span class="pun">{</span></li><li class="L0"><span class="pln">        employees</span><span class="pun">[ </span><span class="pln">i</span><span class="pun">].</span><span class="pln">say</span><span class="pun">();</span></li><li class="L1"><span class="pln">    </span><span class="pun">} </span></li><li class="L2"><span class="pln">&nbsp;</span></li><li class="L3"><span class="pln">    log</span><span class="pun">.</span><span class="pln">show</span><span class="pun">(); </span></li><li class="L4"><span class="pun">}</span></li></ol></pre>                    </div>                </div>			</div>		<!--=========================			END : POST		=============================-->		<!--=========================			START : POST		=============================-->		<div class="post-wrapper">		<h1> JavaScript Design Pattern : Facade</h1>		<div style="padding: 10px 0 0 30px;">                    <h3>Definition</h3>                    <div style="width:80%;padding:6px 0;"> Provide a unified interface to a set of interfaces in a subsystem. Façade defines a higher-level interface that makes the subsystem easier to use.                    </div>                    <br>                    <div class="clearfix">                        <div style="padding:5px 20px 0 0;" class="pull-left">Frequency of use (<i>in JavaScript</i>):</div>                        <div class="pull-left"><img src="/images/use_high.gif"></div>                        <div style="padding:5px 0px 0 15px;" class= "pull-left">high</div>                    </div>                    <br>                    <hr class="hr-orange">                    <br>                    <div style="width:90%;"><h3 class="phead">Summary</h3><p class="ptext">    The Façade pattern provides an interface which shields clients from complex functionality in one or more subsystems.    It is a simple pattern that may seem trivial but it is powerful and extremely useful.    It is often present in systems that are built around a multi-layer architecture.</p><p class="ptext">    The intent of the Façade is to provide a high-level interface (properties and methods) that makes a subsystem or toolkit easy to use for the client.</p><p class="ptext">    On the server, in a multi-layer web application you frequently have a presentation layer which is a client to a service layer.    Communication between these two layers takes place via a well-defined API.    This API, or façade, hides the complexities of the business objects and their interactions from the presentation layer.</p><p class="ptext">    Another area where Façades are used is in refactoring. Suppose you have a confusing or messy set of legacy objects that the client should not be concerned about.    You can hide this code behind a Façade. The Façade exposes only what is necessary and presents a cleaner and easy-to-use interface.</p><p class="ptext">    Façades are frequently combined with other design patterns.  Facades themselves are often implemented as singleton factories.</p><br><h3 class="phead">Diagram</h3><div style="padding-left:30px;">    <img alt="Diagram JavaScript Facade  Design Pattern" src= "/images/diagrams/javascript/javascript-facade.jpg" class="diagram"></div><br><br><h3 class="phead">Participants</h3><div class="ptext">    The objects participating in this pattern are: <br><br>    <ul>        <li>            <b>Facade</b> -- In sample code: <b style="color:#088;">Mortgage</b>            <ul>                <li>knows which subsystems are responsible for a request</li>                <li>delegates client requests to appropriate subsystem objects</li>            </ul>        </li>        <li>            <b>Sub Systems</b> -- In sample code: <b style="color:#088;">Bank, Credit, Background</b>            <ul>                <li>implements and performs specialized subsystem functionality</li>                <li>have no knowledge of or reference to the facade</li>            </ul>        </li>    </ul></div><br><h3 class="phead">Sample code in JavaScript</h3><p class="ptext">    The  <span class="cd"> Mortgage</span> object is the Facade in the sample code.    It presents a simple interface to the client with only a single method: <span class="cd">applyFor</span>.    Eut underneath this simple API lies considerable complexity.</p><p class="ptext">    The applicant's name is passed into the Mortgage constructor function.    Then the <span class="cd">applyFor</span> method is called with the requested loan amount.    Internally, this method uses services from 3 separate subsystems that are complex and possibly take some time to process; they are <span class="cd">Bank</span>,  <span class="cd">Credit</span>, and  <span class="cd">Background</span>.</p><p class="ptext">    Based on several criteria (bank statements, credit reports, and criminal background) the applicant is either accepted or denied for the    requested loan.</p><pre class="prettyprint linenums run"><ol class="linenums"><li class="L0"><span class= "kwd">var</span><span class="pln"> </span><span class="typ">Mortgage</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">function </span><span class="pun">(</span><span class="pln">name</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span></li><li class="L1"><span class="pln"> </span><span class="kwd">this</span><span class="pun">.</span><span class="pln">name </span><span class="pun">=</span><span class="pln"> name</span><span class="pun">;</span></li><li class ="L2"><span class="pun">}</span></li><li class="L3"><span class="pln">&nbsp;</span></li><li class="L4"><span class="typ">Mortgage</span><span class="pun">.</span><span class="pln"> prototype </span><span class="pun">=</span><span class="pln"> </span><span class="pun">{</span></li><li class="L5"><span class="pln">&nbsp;</span></li><li class="L6"><span class="pln"> applyFor</span><span class="pun">:</span><span class="pln"> </span><span class="kwd">function</span><span class="pun">(</span><span class="pln">amount</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span></li><li class="L7"><span class="pln">        </span><span class="com">// access multiple subsystems...</span></li><li class="L8"><span class ="pln">        </span><span class="kwd">var</span><span class="pln"> result </span><span class="pun">=</span><span class="pln"> </span><span class="str">"approved"</span><span class="pun"> ;</span></li><li class="L9"><span class="pln">        </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(!</span><span class="kwd">new</span><span class="pln"> </span><span class="typ">Bank</span><span class="pun">().</span><span class="pln">verify</span><span class="pun">(</span><span class="kwd">this</span><span class="pun">.</span><span class= "pln">name</span><span class="pun">,</span><span class="pln"> amount</span><span class="pun">))</span><span class="pln"> </span><span class="pun">{</span></li><li class="L0"><span class= "pln">            result </span><span class="pun">=</span><span class="pln"> </span><span class="str">"denied"</span><span class="pun">;</span></li><li class="L1"><span class="pln"> </span><span class="pun">}</span><span class="pln"> </span><span class="kwd">else</span><span class="pln"> </span><span class="kwd">if</span><span class="pln"> </span><span class= "pun">(!</span><span class="kwd">new</span><span class="pln"> </span><span class="typ">Credit</span><span class="pun">().</span><span class="kwd">get</span><span class="pun">(</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">name</span><span class="pun">))</span><span class="pln"> </span><span class="pun">{</span></li><li class="L2"><span class ="pln">            result </span><span class="pun">=</span><span class="pln"> </span><span class="str">"denied"</span><span class="pun">;</span></li><li class="L3"><span class="pln"> </span><span class="pun">}</span><span class="pln"> </span><span class="kwd">else</span><span class="pln"> </span><span class="kwd">if</span><span class="pln"> </span><span class= "pun">(!</span><span class="kwd">new</span><span class="pln"> </span><span class="typ">Background</span><span class="pun">().</span><span class="pln">check</span><span class="pun">( </span><span class="kwd">this</span><span class="pun">.</span><span class="pln">name</span><span class="pun">))</span><span class="pln"> </span><span class="pun">{</span></li><li class= "L4"><span class="pln">            result </span><span class="pun">=</span><span class="pln"> </span><span class="str">"denied"</span><span class="pun">;</span></li><li class="L5"><span class="pln">        </span><span class="pun">}</span></li><li class="L6"><span class="pln">        </span><span class="kwd">return</span><span class="pln"> </span><span class="kwd">this </span><span class="pun">.</span><span class="pln">name </span><span class="pun">+</span><span class="pln"> </span><span class="str">" has been "</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> result </span><span class="pun">+</span></li><li class="L7"><span class="pln">               </span><span class="str">" for a "</span><span class= "pln"> </span><span class="pun">+</span><span class="pln"> amount </span><span class="pun">+</span><span class="pln"> </span><span class="str">" mortgage"</span><span class="pun">; </span></li><li class="L8"><span class="pln">    </span><span class="pun">}</span></li><li class="L9"><span class="pun">}</span></li><li class="L0"><span class="pln">&nbsp;</span></li><li class="L1"><span class="kwd">var</span><span class="pln"> </span><span class="typ">Bank</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class= "kwd">function</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span></li><li class="L2"><span class="pln">    </span><span class="kwd">this</span><span class="pun">.</span><span class="pln">verify </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">function</span><span class="pun">(</span><span class="pln">name </span><span class="pun">,</span><span class="pln"> amount</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span></li><li class="L3"><span class="pln"> </span><span class="com">// complex logic ...</span></li><li class="L4"><span class="pln">        </span><span class="kwd">return</span><span class="pln"> </span><span class="kwd"> true</span><span class="pun">;</span></li><li class="L5"><span class="pln">    </span><span class="pun">}</span></li><li class="L6"><span class="pun">}</span></li><li class="L7"><span class="pln">&nbsp;</span></li><li class="L8"><span class="kwd">var</span><span class="pln"> </span><span class="typ">Credit</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">function</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span></li><li class="L9"><span class="pln">    </span><span class="kwd">this</span><span class="pun">.</span><span class="kwd">get</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">function </span><span class="pun">(</span><span class="pln">name</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span></li><li class="L0"><span class="pln"> </span><span class="com">// complex logic ...</span></li><li class="L1"><span class="pln">        </span><span class="kwd">return</span><span class="pln"> </span><span class="kwd">true </span><span class="pun">;</span></li><li class="L2"><span class="pln">    </span><span class="pun">}</span></li><li class="L3"><span class="pun">}</span></li><li class="L4"><span class= "pln">&nbsp;</span></li><li class="L5"><span class="kwd">var</span><span class="pln"> </span><span class="typ">Background</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">function</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span></li><li class="L6"><span class="pln">    </span><span class="kwd">this</span><span class="pun">.</span><span class="pln">check </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">function</span><span class="pun">( </span><span class="pln">name</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span></li><li class="L7"><span class="pln">        </span><span class="com">// complex logic ...</span></li><li class="L8"><span class="pln">        </span><span class="kwd">return</span><span class="pln"> </span><span class="kwd">true</span><span class="pun">; </span></li><li class="L9"><span class="pln">    </span><span class="pun">}</span></li><li class="L0"><span class="pun">}</span></li><li class="L1"><span class="pln">&nbsp;</span></li><li class="L2"><span class="kwd">function</span><span class="pln"> run</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span></li><li class="L3"><span class= "pln">    </span><span class="kwd">var</span><span class="pln"> mortgage </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">Mortgage</span><span class="pun">(</span><span class="str">"Joan Templeton"</span><span class="pun">);</span></li><li class="L4"><span class="pln">    </span><span class="kwd">var</span><span class="pln"> result </span><span class="pun">=</span><span class="pln"> mortgage</span><span class="pun">.</span><span class="pln">applyFor</span><span class= "pun">(</span><span class="str">"$100,000"</span><span class="pun">);</span></li><li class="L5"><span class="pln">&nbsp;</span></li><li class="L6"><span class="pln">    alert</span><span class="pun">(</span><span class="pln">result</span><span class="pun">);</span></li><li class="L7"><span class="pun">}</span></li><li class="L8"><span class="pln">&nbsp; </span></li></ol></pre>                    </div>                </div>			</div>		<!--=========================			END : POST		=============================--> <!--=========================			START : POST		=============================-->		<div class="post-wrapper">		<h1>Basic JavaScript Part 1 : Functions</h1> <div class="vw-post-content clearfix"><p>Functions are a very important concept in most programming languages, but they are even more important in JavaScript. When you read this as a C# or VB developer you probably won't see this as a big deal. But there are some essential things you can do with functions that you should be aware of when doing JavaScript development.</p><h3></h3><h3>Self-executing functions</h3><p>As the name implies, these are functions that are called after they are defined. Let's look at an example:</p><pre class= "csharpcode">(  <span class="kwrd">function</span>() {    alert(<span class="str">"Hello Mars"</span>);  })()</pre><p>This basically is an anonymous function that is invoked immediately, caused by the last pair of parentheses. It's also possible to specify arguments to the anonymous function like so:</p><pre class="csharpcode">(  <span class="kwrd">function</span>(planet) {    alert(<span class="str">"Hello "</span> +  planet);  })(<span class="str">"Jupiter"</span>)</pre><p>Why is this useful? Well, you can do all sorts of stuff with self-executing functions like one-off initialization without having to mess around with global variables. They are also commonly used for variable scoping. Variables declared inside a self-executing function cannot be accessed from outside the function. This way it's possible to provide proper encapsulation, which I might come back in a later blog post.&nbsp; </p><h3>Inner functions </h3><p>This feature reminds me to the early stages of career as a software developer when I was still programming Delphi. Just like Delphi, JavaScript makes it possible to define functions inside another function.</p><pre class="csharpcode">function show() {  function getPlanet() {    <span class="kwrd">return</span> <span class="str">"Saturn"</span>;  }  alert( <span class="str">"Hello "</span> + getPlanet());}</pre><p>The function <em>show()</em> is publicly available, but the function <em>getPlanet()</em> is a private function and can only be called from code that lives inside the <em>show()</em> function. So the main benefit here is encapsulation. </p><h3>Self-rewriting functions</h3><p>It's possible to assign functions to a variable. Nothing unusual there. But we can also assign a new function to the same variable from within the function that was originally assigned to the variable. You can think of it as a function that rewrites itself from the inside when it is executed. This probably sounds more complicated that it really is so I'll show you an example.</p><pre class="csharpcode"><span class="kwrd">var</span> doSomething = <span class="kwrd">function</span>() {  alert(<span class="str">"Doing something useful"</span>);  doSomething = <span class="kwrd">function</span>() {    alert(<span class="str">"But I already did something!"</span>);  }}</pre><p>Again, this technique is quite useful when you need to do some one-off initialization or perhaps feature sniffing on different browsers. </p><h3>Closures</h3><p>In order to understand closures in JavaScript, it is also vital to understand scoping. Unlike other programming languages, JavaScript has function scope instead of block scope. This is also called scope chain.</p><pre class="csharpcode">function foo() {  var x = 8;  <span class="kwrd">if</span>(x &gt; 0) {    var y = 12;  }  (    function bar() {      alert(x + y);    }  )();}</pre><p>This might come of a little bit strange, but this code is completely legit. Both the variables <em>x</em> and <em>y</em> are available inside our self-executing function <em>bar()</em>. Variable <em>y</em> is available in function <em>foo()</em> after its definition inside the <em>if</em> block. This is why it's a best practice in JavaScript to declare all variables at the top of the function in order to prevent some nastiness later on. </p><p>JavaScript functions also have <a href="http://en.wikipedia.org/wiki/Scope_(programming)#Lexical_versus_dynamic_scoping">lexical scope</a>. This means that a function doesn't create its scope at runtime but when its defined. I have to admit that I still run into some issues regarding this concept from time to time.</p><p>Now let's get back to closures by looking at a very basic example.</p><pre class="csharpcode">function foo(){  var x = 15;  <span class="kwrd">return</span> function() {    <span class="kwrd">return</span> x;  }}</pre><p>This might look familiar when you've worked with lambdas in C#. Calling the function <em>foo()</em> returns another function that returns the value of the local variable <em>x</em>. Closures are often used when doing OO-style programming in JavaScript. An example of this are getters and setters.</p><h3>Closing</h3><p>These are just some of the nice little tidbits that are very powerful tools in your JavaScript tool belt. Actually sitting down and learning about JavaScript as a programming language can be a real eye opener and a very rewarding experience. </p></div>			</div> <!--=========================			END : POST		=============================-->		<!--=========================			START : POST =============================-->		<div class="post-wrapper"><h1>Basic JavaScript Part 2 : Objects</h1><div class="vw-post-content clearfix"><p>In a <a target="_blank" href=" http://elegantcode.com/2010/10/22/basic-javascript-part-1-functions/">previous blog post</a>, I showed some of the rich capabilities of functions in JavaScript. For this post I want to have a brief look at objects in JavaScript. Let's start with a basic example:</p><pre class="csharpcode"><span class="kwrd">var</span> podcast = {    title: <span class="str">'Astronomy Cast'</span>,    description: <span class="str">'A fact-based journey through the galaxy.'</span>,    link: <span class="str">'http://www.astronomycast.com'</span>};</pre><p>When you've already seen some kind of data in JSON format, this might look familiar.&nbsp; In JavaScript, this is called an <em>object literal</em>. The example above shows a variable named <em> podcast</em> that contains an object with three properties, named <em>title</em>, <em>description</em> and <em>link</em>. As you might expect, it's now possible to access the data of these properties using the regular dot notation.</p><pre class="csharpcode">console.log(podcast.title);console.log(podcast.description);console.log(podcast.link);</pre><p><!--.csharpcode, .csharpcode pre { 	font-size: small; 	color: black; 	font-family: consolas, "Courier New", courier, monospace; 	background-color: #ffffff; 	/*white-space: pre;*/ } .csharpcode pre { margin: 0em; } .csharpcode .rem { color: #008000; } .csharpcode .kwrd { color: #0000ff; } .csharpcode .str { color: #006080; } .csharpcode .op { color: #0000c0; } .csharpcode .preproc { color: #cc6633; } .csharpcode .asp { background-color: #ffff00; } .csharpcode .html { color: #800000; } .csharpcode .attr { color: #ff0000; } .csharpcode .alt  { 	background-color: #f4f4f4; 	width: 100%; 	margin: 0em; } .csharpcode .lnum { color: #606060; } -->Hopefully there are no big surprises here. But what I find to be more interesting about objects in JavaScript are their similarities with arrays. Take a look at the following array definition:</p><pre class="csharpcode"><span class="kwrd">var</span> astronomyPodcast = [<span class="str" >'Astronomy Cast'</span>, <span class="str">'A fact based ...'</span>, <span class="str">'http://www.astro ...'</span>];</pre><p><!--.csharpcode, .csharpcode pre { 	font-size: small; color: black; 	font-family: consolas, "Courier New", courier, monospace; 	background-color: #ffffff; 	/*white-space: pre;*/ } .csharpcode pre { margin: 0em; } .csharpcode .rem { color: #008000; } .csharpcode .kwrd { color: #0000ff; } .csharpcode .str { color: #006080; } .csharpcode .op { color: #0000c0; } .csharpcode .preproc { color: #cc6633; } .csharpcode .asp { background-color: #ffff00; } .csharpcode .html { color: #800000; } .csharpcode .attr { color: #ff0000; } .csharpcode .alt  { 	background-color: #f4f4f4; 	width: 100%; 	margin: 0em; } .csharpcode .lnum { color: #606060; } -->When I want to access the description in the array, I simply go by using the correct index:</p><pre class="csharpcode"> console.log(astronomy[1]);    // outputs the description</pre><p>No big deal so far. The nice thing about objects in JavaScript is that we can use the same notation but only with a small difference:</p><pre class="csharpcode">console.log(podcast[<span class="str">'description'</span>]);</pre><p><!--.csharpcode, .csharpcode pre { 	font-size: small; 	color: black; font-family: consolas, "Courier New", courier, monospace; 	background-color: #ffffff; 	/*white-space: pre;*/ } .csharpcode pre { margin: 0em; } .csharpcode .rem { color: #008000; } .csharpcode .kwrd { color: #0000ff; } .csharpcode .str { color: #006080; } .csharpcode .op { color: #0000c0; } .csharpcode .preproc { color: #cc6633; } .csharpcode .asp { background-color: #ffff00; } .csharpcode .html { color: #800000; } .csharpcode .attr { color: #ff0000; } .csharpcode .alt  { 	background-color: #f4f4f4; 	width: 100%; 	margin: 0em; } .csharpcode .lnum { color: #606060; } -->The sole difference here is that we are using the name of the property instead of a numeric index. Objects actually behave the same as arrays in JavaScript except that for objects you get to choose a nice and friendly name for its properties. Lets look at another example that&nbsp; loops over every item in the array:</p><pre class= "csharpcode"><span class="kwrd">for</span>(<span class="kwrd">var</span> i in astronomy) {    console.log(astronomy[i]);}</pre><p>This outputs every value contained by the array. The variable i contains the current index in the array. We can do the same for objects:</p><pre class="csharpcode"><span class="kwrd">for</span>(var i <span class="kwrd">in</span> podcast) {    console.log(podcast[i]);}</pre><p><!--.csharpcode, .csharpcode pre { 	font-size: small; 	color: black; 	font-family: consolas, "Courier New", courier, monospace; background-color: #ffffff; 	/*white-space: pre;*/ } .csharpcode pre { margin: 0em; } .csharpcode .rem { color: #008000; } .csharpcode .kwrd { color: #0000ff; } .csharpcode .str { color: #006080; } .csharpcode .op { color: #0000c0; } .csharpcode .preproc { color: #cc6633; } .csharpcode .asp { background-color: #ffff00; } .csharpcode .html { color: #800000; } .csharpcode .attr { color: #ff0000; } .csharpcode .alt  { 	background-color: #f4f4f4; 	width: 100%; 	margin: 0em; } .csharpcode .lnum { color: #606060; } -->The variable <em>i</em> doesn't contain a numeric value in this case, but the name of the current property. So in short, a JavaScript object is very similar to an array with the sole difference that you have to define the keys yourself. Just a quick side note here: try to avoid for-in loops with arrays and use a regular for loop instead.</p><h3>Methods</h3><p>A method on an object is simply a property that contains a function.</p><pre class="csharpcode"><span class="kwrd">var</span> podcast = {    title: <span class="str">'Astronomy Cast'</span>,    description: <span class="str">'A fact-based journey through the galaxy.'</span>,    link: <span class="str">'http://www.astronomycast.com',</span>    toString: <span class="kwrd">function()</span> {       <span class= "kwrd">return</span> <span class="str">'Title: '</span> + this.title;    }};</pre><p><!--.csharpcode, .csharpcode pre { 	font-size: small; 	color: black; 	font-family: consolas, "Courier New", courier, monospace; 	background-color: #ffffff; 	/*white-space: pre;*/ } .csharpcode pre { margin: 0em; } .csharpcode .rem { color: #008000; } .csharpcode .kwrd { color: #0000ff; } .csharpcode .str { color: #006080; } .csharpcode .op { color: #0000c0; } .csharpcode .preproc { color: #cc6633; } .csharpcode .asp { background-color: #ffff00; } .csharpcode .html { color: #800000; } .csharpcode .attr { color: #ff0000; } .csharpcode .alt  { 	background-color: #f4f4f4; 	width: 100%; 	margin: 0em; } .csharpcode .lnum { color: #606060; } --> Again, calling a method can be done using the dot notation or the square bracket notation as we saw earlier:</p><pre class="csharpcode">podcast.toString();&nbsp;&nbsp; ORpodcast[<span class="str">'toString'</span>]();</pre><p><!--.csharpcode, .csharpcode pre { 	font-size: small; 	color: black; 	font-family: consolas, "Courier New", courier, monospace; background-color: #ffffff; 	/*white-space: pre;*/ } .csharpcode pre { margin: 0em; } .csharpcode .rem { color: #008000; } .csharpcode .kwrd { color: #0000ff; } .csharpcode .str { color: #006080; } .csharpcode .op { color: #0000c0; } .csharpcode .preproc { color: #cc6633; } .csharpcode .asp { background-color: #ffff00; } .csharpcode .html { color: #800000; } .csharpcode .attr { color: #ff0000; } .csharpcode .alt  { 	background-color: #f4f4f4; 	width: 100%; 	margin: 0em; } .csharpcode .lnum { color: #606060; } -->I have to admit that this last notation looks a bit weird and I don't think it's a common practice.</p><h3>Constructors</h3><p>Instead of using object literals, the most common way I've seen so far for creating an object in JavaScript is by using a so called <em>constructor function</em>. A constructor function is just a regular function but with a slightly different naming convention. The name of a constructor function is generally defined using Pascal casing as opposed to the usual Camel casing (like the <em>toString</em> method as shown earlier).</p><pre class="csharpcode"><span class="kwrd">function</span> Podcast() {    this.title = <span class="str">'Astronomy Cast';</span>    this.description = <span class="str">'A fact-based journey through the galaxy.'; </span>    this.link = <span class="str">'http://www.astronomycast.com';</span>    this.toString = <span class="kwrd">function()</span> {       <span class="kwrd">return</span> <span class ="str">'Title: '</span> + this.title;    }}</pre><p><!--.csharpcode, .csharpcode pre { 	font-size: small; 	color: black; 	font-family: consolas, "Courier New", courier, monospace; background-color: #ffffff; 	/*white-space: pre;*/ } .csharpcode pre { margin: 0em; } .csharpcode .rem { color: #008000; } .csharpcode .kwrd { color: #0000ff; } .csharpcode .str { color: #006080; } .csharpcode .op { color: #0000c0; } .csharpcode .preproc { color: #cc6633; } .csharpcode .asp { background-color: #ffff00; } .csharpcode .html { color: #800000; } .csharpcode .attr { color: #ff0000; } .csharpcode .alt  { 	background-color: #f4f4f4; 	width: 100%; 	margin: 0em; } .csharpcode .lnum { color: #606060; } -->In order to create a Podcast object, we simply use the <em>new</em> operator:</p><pre class="csharpcode"><span class="kwrd">var</span> podcast = <span class="kwrd">new</span> Podcast();podcast.toString();</pre><p> <!--.csharpcode, .csharpcode pre { 	font-size: small; 	color: black; 	font-family: consolas, "Courier New", courier, monospace; 	background-color: #ffffff; 	/*white-space: pre;*/ } .csharpcode pre { margin: 0em; } .csharpcode .rem { color: #008000; } .csharpcode .kwrd { color: #0000ff; } .csharpcode .str { color: #006080; } .csharpcode .op { color: #0000c0; } .csharpcode .preproc { color: #cc6633; } .csharpcode .asp { background-color: #ffff00; } .csharpcode .html { color: #800000; } .csharpcode .attr { color: #ff0000; } .csharpcode .alt  { background-color: #f4f4f4; 	width: 100%; 	margin: 0em; } .csharpcode .lnum { color: #606060; } -->When a constructor function is invoked with the <em>new</em> operator, an object is always returned. By default, <em>this</em> points to the created object. The properties and methods are added to the object (referenced by <em>this</em>) after which the new object is returned. Because a constructor function is only a convention, you can also pass arguments to it just as with regular functions.</p><p>When an object is created using a constructor function, there's also a property named <em>constructor</em> that is set with a reference to the constructor function that was used for creating the respective object.</p><h3>Encapsulation </h3><p>In the example we've been using so far, it's fairly easy to replace property values and method implementations of a <em>Podcast</em> object.</p><pre class="csharpcode"><span class= "kwrd">var</span> podcast = <span class="kwrd">new</span> Podcast();podcast.title = <span class="str">'The Simpsons'</span>;podcast.toString = <span class="kwrd">function</span>() { <span class="kwrd">return</span> <span class="str">'D</span>oh';}</pre><p><!--.csharpcode, .csharpcode pre { 	font-size: small; 	color: black; 	font-family: consolas, "Courier New", courier, monospace; 	background-color: #ffffff; 	/*white-space: pre;*/ } .csharpcode pre { margin: 0em; } .csharpcode .rem { color: #008000; } .csharpcode .kwrd { color: #0000ff; } .csharpcode .str { color: #006080; } .csharpcode .op { color: #0000c0; } .csharpcode .preproc { color: #cc6633; } .csharpcode .asp { background-color: #ffff00; } .csharpcode .html { color: #800000; } .csharpcode .attr { color: #ff0000; } .csharpcode .alt  { 	background-color: #f4f4f4; 	width: 100%; 	margin: 0em; } .csharpcode .lnum { color: #606060; } -->Suppose we want our <em>Podcast</em> objects to be immutable. Unfortunately, JavaScript doesn't have a notation for private, protected, public or internal methods like C# does. So, if we want to hide the values of the properties on this object, we have to refactor them to regular variables and make use of closures (these are explained in <a target="_blank" href=" http://elegantcode.com/2010/10/22/basic-javascript-part-1-functions/">the previous post</a>).</p><pre class="csharpcode"><span class="kwrd">function</span> Podcast() {    <span class= "kwrd">var</span> _title = <span class="str">'Astronomy Cast';</span>    <span class="kwrd">var</span> _description = <span class="str">'A fact-based journey through the galaxy.';</span> <span class="kwrd">var</span> _link = <span class="str">'http://www.astronomycast.com';</span>    <span class="kwrd">this</span>.getTitle = <span class="kwrd">function</span>() {        <span class="kwrd">return</span> _title;    }    <span class="kwrd">this</span>.getDescription = <span class="kwrd">function</span>() {        <span class="kwrd">return</span> _description;    }    <span class="kwrd">this</span>.getLink = <span class="kwrd">function</span>() {        <span class="kwrd">return</span> _link;    }    <span class="kwrd">this</span> .toString: <span class="kwrd">function()</span> {       <span class="kwrd">return</span> <span class="str">'Title: '</span> + _title;    }}</pre><p><!--.csharpcode, .csharpcode pre { font-size: small; 	color: black; 	font-family: consolas, "Courier New", courier, monospace; 	background-color: #ffffff; 	/*white-space: pre;*/ } .csharpcode pre { margin: 0em; } .csharpcode .rem { color: #008000; } .csharpcode .kwrd { color: #0000ff; } .csharpcode .str { color: #006080; } .csharpcode .op { color: #0000c0; } .csharpcode .preproc { color: #cc6633; } .csharpcode .asp { background-color: #ffff00; } .csharpcode .html { color: #800000; } .csharpcode .attr { color: #ff0000; } .csharpcode .alt  { 	background-color: #f4f4f4; 	width: 100%; 	margin: 0em; } .csharpcode .lnum { color: #606060; } -->The ‘public' methods have access to the ‘private' variables while the latter are not exposed to the externals of the object. These public methods that have access to the private members are also called <em>privileged methods</em>.</p><pre class="csharpcode"><span class="kwrd">var</span> podcast = <span class="kwrd">new</span> Podcast();console.log(podcast.getTitle());console.log(podcast._title);    // undefined</pre><p><!--.csharpcode, .csharpcode pre { 	font-size: small; 	color: black; 	font-family: consolas, "Courier New", courier, monospace; 	background-color: #ffffff; 	/*white-space: pre;*/ } .csharpcode pre { margin: 0em; } .csharpcode .rem { color: #008000; } .csharpcode .kwrd { color: #0000ff; } .csharpcode .str { color: #006080; } .csharpcode .op { color: #0000c0; } .csharpcode .preproc { color: #cc6633; } .csharpcode .asp { background-color: #ffff00; } .csharpcode .html { color: #800000; } .csharpcode .attr { color: #ff0000; } .csharpcode .alt  { 	background-color: #f4f4f4; 	width: 100%; 	margin: 0em; } .csharpcode .lnum { color: #606060; } -->You probably want to watch our for these privileged methods returning a private member that holds either an object or an array. Because these are passed by reference, the client code can still change the private member. To prevent this from happening, you might want to consider returning a copy of the object or array.</p><p>We can have private functions as well using the same approach as for private variables:</p><pre class="csharpcode"><span class="kwrd">function</span> Podcast() {    ...    <span class="rem">// Private function</span>    <span class="kwrd">function</span> download() {        ...    }    <span class="kwrd">function</span> reliesOnDownload() {        ...        download(); ...    }    ...}</pre><p><!--.csharpcode, .csharpcode pre { 	font-size: small; 	color: black; 	font-family: consolas, "Courier New", courier, monospace; 	background-color: #ffffff; /*white-space: pre;*/ } .csharpcode pre { margin: 0em; } .csharpcode .rem { color: #008000; } .csharpcode .kwrd { color: #0000ff; } .csharpcode .str { color: #006080; } .csharpcode .op { color: #0000c0; } .csharpcode .preproc { color: #cc6633; } .csharpcode .asp { background-color: #ffff00; } .csharpcode .html { color: #800000; } .csharpcode .attr { color: #ff0000; } .csharpcode .alt  { 	background-color: #f4f4f4; 	width: 100%; 	margin: 0em; } .csharpcode .lnum { color: #606060; } -->Suppose we want to make the <em>download</em> method publicly available. But on the other hand, we also have some other methods in our <em>Podcast</em> object (like the <em>reliesOnDownload method</em>) that make use of the <em>download </em>method, relying on its robust functionality. So making this method publicly available can jeopardize the correct working of these other methods if some client decides to replace our <em>download </em> method with its own buggy implementation or even worse, deletes it completely. We can't have that, of course.</p><p>We mentioned earlier that constructor functions implicitly return <em>this</em>. But we can return our own custom object as well and we can use this to solve our problem of elevating private methods.</p><pre class="csharpcode"><span class="kwrd">function </span> Podcast() {    <span class="kwrd">var</span> _title = <span class="str">'Astronomy Cast';</span>    <span class="kwrd">var</span> _description = <span class="str">'A fact-based journey through the galaxy.';</span>    <span class="kwrd">var</span> _link = <span class="str">'http://www.astronomycast.com';</span>    <span class="kwrd">function</span> getTitle() {        <span class="kwrd">return</span> _title;    }    <span class="kwrd">function</span> getDescription() {        <span class="kwrd">return</span> _description;    }    <span class= "kwrd">function</span> getLink() {        <span class="kwrd">return</span> _link;    }    <span class="kwrd">function</span> toString() {        <span class="rem">// Now we can safely rely on the getTitle() accessor as well.</span>        <span class="kwrd">return</span> <span class="str">'Title: '</span> + getTitle();    }    <span class="kwrd">function</span> download() {        <span class="rem">// Some highly resilient implementation ...</span>    }&nbsp;&nbsp;    <span class="kwrd">function</span> reliesOnDownload() {       <span class="rem" >// Relies on our own implementation of the download() method</span>       download();       ...&nbsp;&nbsp; }    <span class="kwrd">return</span> {        getTitle: getTitle, getDescription: getDescription,        getLink: getLink,        toString: toString,        download: download    }}</pre><p><!--.csharpcode, .csharpcode pre { 	font-size: small; color: black; 	font-family: consolas, "Courier New", courier, monospace; 	background-color: #ffffff; 	/*white-space: pre;*/ } .csharpcode pre { margin: 0em; } .csharpcode .rem { color: #008000; } .csharpcode .kwrd { color: #0000ff; } .csharpcode .str { color: #006080; } .csharpcode .op { color: #0000c0; } .csharpcode .preproc { color: #cc6633; } .csharpcode .asp { background-color: #ffff00; } .csharpcode .html { color: #800000; } .csharpcode .attr { color: #ff0000; } .csharpcode .alt  { 	background-color: #f4f4f4; 	width: 100%; 	margin: 0em; } .csharpcode .lnum { color: #606060; } -->The net result here is that we safely exposed our private methods to any outside code. Clients can still replace the download method on the custom object that we explicitly returned from the constructor function, but at the very least we can safely rely on our own implementation.</p><h3>Closing</h3><p>There you go, just some quick trivia on objects in JavaScript. I cannot emphasize enough how powerful JavaScript really is and that learning about this great programming language is a tremendous experience.</p></div> </div>		<!--=========================			END : POST		=============================-->		<!--=========================			START : POST =============================-->		<div class="post-wrapper"><h1>Basic JavaScript Part 3 : Prototypes</h1><div class="vw-post-content clearfix"><p>In previous blog posts, I talked about the rich capabilities of <a target="_blank" href="http://elegantcode.com/2010/10/22/basic-javascript-part-1-functions/">functions</a> and <a target="_blank" href=" http://elegantcode.com/2010/11/12/basic-javascript-part-2-objects/">objects</a> in JavaScript. For this post I want to briefly touch on the concept of prototypes. Having a decent understanding of prototypes in JavaScript is highly recommended as they are a very important part of the language. I have to admit that I'm still trying to fully get my head around the concept of prototypes, but writing this blog post is part of my learning process :-).&nbsp; </p><p>As you probably know, JavaScript is not a ‘classical' language but a prototypal object language. This means that pretty much everything is an object, including functions. Every function has a property named <em>prototype</em>. This property is set to an empty object as soon as the former object gets created. As with every object we can augment it with our own methods.</p><p>In a <a target="_blank" href=" http://elegantcode.com/2010/11/12/basic-javascript-part-2-objects/">previous post</a>, I showed how to use constructor functions for creating new objects. Have a look at the following simple constructor function.</p><pre class="csharpcode"><span class="kwrd">function</span> Podcast(title, url) {    <span class="kwrd">this</span>.title = title;    <span class="kwrd">this </span>.url = url;    <span class="kwrd">this</span>.toString = <span class="kwrd">function</span>() {       <span class="kwrd">return</span> <span class="str">'Title: '</span> + <span class="kwrd">this</span>.title;    }}<span class="kwrd">var</span> podcast1 = <span class="kwrd">new</span> Podcast(<span class="str">'Astronomy cast', 'http:// ...'</span>);<span class= "kwrd">var</span> podcast2 = <span class="kwrd">new</span> Podcast(<span class="str">'jQuery podcast', 'http:// ...'</span>);</pre><p>This constructor function adds two properties and one method to the objects that we created. Suppose that we developed a magnificent method for downloading the podcast itself. The most obvious place to put this code is in the constructor function as we did with the <em>toString</em> method. But we can also add this new method to the prototype of our constructor function. </p><pre class="csharpcode"> Podcast.prototype.download = <span class="kwrd">function</span>() {    console.log(<span class="str">"Downloading podcast ..."</span>);}</pre><p>When a new <em>Podcast</em> object is created, this new object will <em>‘inherit'</em> the <em>download</em> method from the prototype of the constructor function and becomes available for use. In fact, <em>Podcast</em> objects that were created before the new function was added to the prototype of the constructor function also get this new method! Take a look at the following sample code:</p><pre class= "csharpcode"><span class="kwrd">var</span> podcast1 = <span class="kwrd">new</span> Podcast(<span class="str">'Astronomy cast'</span>, <span class="str">'http:// ...'</span>);console.log( <span class="kwrd">typeof</span> podcast1.download);        <span class="rem">// outputs 'undefined'            </span>Podcast.prototype.download = <span class="kwrd">function</span>() {    console.log(<span class="str">"Downloading podcast ..."</span>);}<span class="kwrd">var</span> podcast2 = <span class="kwrd">new</span> Podcast(<span class="str">'jQuery podcast' </span>, , <span class="str">'http:// ...'</span>);console.log(<span class="kwrd">typeof</span> podcast1.download);        <span class="rem">// outputs 'function'</span>console.log(<span class="kwrd">typeof</span> podcast2.download);        // outputs <span class="str">'function'</span></pre><p>When the <em>Podcast</em> constructor function gets augmented with the <em> download</em> function, the previously created object now also exposes the newly added function. I find this a quite&nbsp; fascinating feature.</p><p>As already mentioned, we can now simply call the <em>download</em> method that we added to the prototype.</p><pre class="csharpcode"><span class="kwrd">var</span> podcast = <span class="kwrd">new</span> Podcast(<span class="str">'Railscasts'</span>, <span class="str">'http:// ...'</span>);podcast.download();</pre><p>Even though the <em>download</em> method is now available for every object created through the <em>Podcast</em> constructor function, that doesn't mean that this new method is ‘owned' by the created <em>podcast</em> object itself. </p><pre class="csharpcode"><span class= "kwrd">var</span> podcast = <span class="kwrd">new</span> Podcast(<span class="str">'Railscasts'</span>, <span class="str">'http:// ...'</span>);console.log(podcast.hasOwnProperty(<span class="str">'download'</span>));    // outputs <span class="str">'false'</span></pre><p>When the <em>download</em> method is called, the JavaScript engine first looks at the methods of the <em>podcast</em> object which doesn't seem have this method. Next thing, the engine identifies the prototype of the constructor function used for creating the <em>podcast</em> object. If the engine can find the method in the prototype object then this method will be called.</p><p>Besides the <em>prototype</em> property, every object also has a property named <em> constructor</em> that contains a reference to the constructor function used for creating the object. The code snippet shown earlier therefore resolves into something like this:</p><pre class="csharpcode"><span class="kwrd">var</span> podcast = <span class="kwrd">new</span> Podcast(<span class="str">'Railscasts'</span>, <span class="str">'http:// ...'</span>);<span class= "rem">// outputs 'true'</span>console.log(podcast.constructor.prototype.hasOwnProperty(<span class="str">'download'</span>));podcast.constructor.prototype.download();</pre><p>As I just mentioned, every object has a <em>constructor</em> property. Because the prototype property of the constructor function holds a reference to an object, that means that it also has a constructor which has a prototype of its own, etc ... . The engine goes up the prototype chain searching for a requested method or property until it finds what needs to be called or until it reaches the root prototype, which is <em>Object.prototype</em>. </p><p>When a <em>download</em> method is added to the <em>Podcast</em> constructor function, then this method will take precedence over the <em>download</em> method of the prototype. This is illustrated by the following code sample:</p><pre class="csharpcode"><span class="kwrd">function</span> Podcast(title, url) {    <span class="kwrd">this</span>.title = title;    <span class="kwrd">this</span>.url = url;    <span class="kwrd">this</span>.download = <span class="kwrd">function </span>() {        console.log(<span class="str">'Own download function.'</span>);    }    <span class="kwrd">this</span>.toString = <span class="kwrd">function</span>() {       <span class="kwrd">return</span> <span class="str">'Title: '</span> + <span class="kwrd">this</span>.title;    }}Podcast.prototype.download = <span class="kwrd">function</span>() { console.log(<span class="str">"Prototype download function."</span>);}<span class="kwrd">var</span> podcast = <span class="kwrd">new</span> Podcast(<span class="str">'Railscasts'</span>, <span class="str">'http:// ...'</span>);podcast.download();    // Outputs <span class="str">'Own download function.'</span></pre><p>These are the very basics of prototypes in JavaScript. I really enjoy learning JavaScript as it broadens my perspective on programming languages. </p><p>Until next time. </p></div>			</div> <!--=========================			END : POST		=============================-->		<!--=========================			START : POST =============================-->		<div class="post-wrapper"><h1>Basic JavaScript Part 4: Enforcing New on Constructor Functions</h1><div class="vw-post-content clearfix"><p>As this is already the fourth blog post using the "Basic JavaScript" theme, I guess we're slowly getting a small blog series on our hands. Here are the links to the previous installments: </p><ol><li><a target="_blank" href="http://elegantcode.com/2010/10/22/basic-javascript-part-1-functions/">Functions</a> </li><li><a target="_blank" href=" http://elegantcode.com/2010/11/12/basic-javascript-part-2-objects/">Objects</a> </li><li><a target="_blank" href="http://elegantcode.com/2010/12/03/basic-javascript-part-3-prototypes/"> Prototypes</a> </li></ol><p>In the <a target="_blank" href="http://elegantcode.com/2010/11/12/basic-javascript-part-2-objects/">blog post on objects</a>, I mentioned that there's a general naming convention for constructor functions, using Pascal casing as opposed to the usual Camel case naming style for JavaScript functions. When following this naming convention we can make a visual distinction between a constructor function and a normal function. We want to make this distinction because we always need to call a constructor function with the <em>new </em> operator.</p><pre class="csharpcode"><span class="kwrd">function</span> Podcast() {    <span class="kwrd">this</span>.title = <span class="str">'Astronomy Cast'</span>;    <span class="kwrd">this</span>.description = <span class="str">'A fact-based journey through the galaxy.'</span>;    <span class="kwrd">this</span>.link = <span class="str">' http://www.astronomycast.com'</span>;}Podcast.prototype.toString = <span class="kwrd">function</span>() {   <span class="kwrd">return</span> <span class="str">'Title: '</span> + <span class="kwrd">this</span>.title;};<span class="kwrd">var</span> podcast = <span class="kwrd">new</span> Podcast();podcast.toString();</pre><p>Suppose that for some reason this naming convention slips our mind and we forget using the <em>new</em> operator when calling this constructor function. This usually leads to some nasty and unexpected behavior that is sometimes very hard to track down. What actually happens when we omit the <em>new</em> keyword, is that <em>this</em> now points to the global object (the <em>window</em> object when the JavaScript code is running in the browser) instead of the object that we intended to create. As a result, the properties in the constructor function are now added to the global object. This is definitely not what we want.</p><p>Rather than relying purely on a naming convention, we might want to enforce that every time a constructor function is called, this function is invoked properly using the <em>new</em> operator. In order to achieve this, we can add the following check to the beginning of the constructor function shown earlier:</p><pre class="csharpcode" ><span class="kwrd">function</span> Podcast() {    <span class="kwrd">if</span>(<span class="kwrd">false</span> === (<span class="kwrd">this</span> instanceof Podcast)) {        <span class="kwrd">return</span> <span class="kwrd">new</span> Podcast();    }    <span class="kwrd">this</span>.title = <span class="str">'Astronomy Cast'</span>;    <span class="kwrd">this </span>.description = <span class="str">'A fact-based journey through the galaxy.'</span>;    <span class="kwrd">this</span>.link = <span class="str">'http://www.astronomycast.com'</span> ;}Podcast.prototype.toString = <span class="kwrd">function</span>() {   <span class="kwrd">return</span> <span class="str">'Title: '</span> + <span class="kwrd">this</span>.title;};<span class="kwrd">var</span> podcast1 = Podcast();<span class="kwrd">var</span> podcast2 = <span class="kwrd">new</span> Podcast();</pre><p>Adding this check verifies whether <em>this</em> references an object created by our constructor function, and if not, the constructor function is called again but this time using the <em>new</em> operator. </p><p>So adding this check to all your constructor functions guarantees that these are invoked correctly using <em>new</em>. </p><p>Till next time.</p></div>			</div> <!--=========================			END : POST		=============================-->		<!--=========================			START : POST =============================-->		<div class="post-wrapper"><h1>Basic JavaScript Part 5: Hoisting</h1><div class="vw-post-content clearfix"><p>Here are the links to the previous installments:</p><ol><li><a target="_blank" href="http://elegantcode.com/2010/10/22/basic-javascript-part-1-functions/">Functions</a> </li><li><a target="_blank" href=" http://elegantcode.com/2010/11/12/basic-javascript-part-2-objects/">Objects</a> </li><li><a target="_blank" href="http://elegantcode.com/2010/12/03/basic-javascript-part-3-prototypes/"> Prototypes</a> </li><li><a target="_blank" href="http://elegantcode.com/?p=4015">Enforcing New on Constructor Functions</a></li></ol><ol>I just wanted to quickly share a little tidbit that I ran into the other day while I was messing with JavaScript again. Try to guess what the output is going to be when running the following code snippet:</ol><ol><pre class= "csharpcode"><span class="kwrd">var</span> num = 56;<span class="kwrd">function</span> calculateSomething() {    console.log(num);    <span class="kwrd">var</span> num = 12; console.log(num);}calculateSomething();</pre></ol><ol>Without further ado, this is the output shown in the console window:</ol><p><a href=" http://elegantcode.com/wp-content/uploads/2010/12/image8.png"><img width="287" border="0" height="92" src="http://elegantcode.com/wp-content/uploads/2010/12/image_thumb8.png" alt="image" title="image" style="border-bottom: 0px; border-left: 0px; display: inline; border-top: 0px; border-right: 0px"></a> </p><ol>I must admit that this had me beat the first time I saw this, but it really makes perfect sense. </ol><ol>JavaScript doesn't support block scope but instead it makes use of function scope. Block scope means that variables declared in a block are not visible to code outside that block. We all know that the following C#code doesn't compile for exactly that reason:</ol><ol><pre class="csharpcode"><span class="kwrd">public</span> <span class="kwrd">void</span> Stuff(){    {        var i = 2;    }    <span class="rem">// Compiler error: The name 'i' does not exist in the current context.</span>    Console.WriteLine(i);} </pre></ol><p>But function scope means that all variables and parameters declared inside a function are visible everywhere within that function, even before the variable has been declared. This is the behavior that we see by running the code snippet shown earlier.</p><ol>Just as with C#, we can put a variable declaration anywhere in our JavaScript function as we did earlier. In that case, JavaScript will just act as if the variable has been declared at the top of the function. This behavior is called <em>hoisting</em>. This means that it is valid to use this variable as long as it has been declared somewhere within the function. Going back to our previous sample, the net result is that JavaScript will interpret the function as something like this:</ol><ol><pre class="csharpcode"><span class="kwrd">var</span> num = 56;<span class="kwrd">function</span> calculateSomething() {    <span class="kwrd">var</span> num;            <span class="rem">// undefined</span>    console.log(num);    <span class="rem">// outputs 'undefined'    </span>    num = 12;            <span class="rem">// 12</span> console.log(num);    <span class="rem">// outputs '12'    </span>}calculateSomething();</pre><p>Now I know why <a target="_blank" href="http://www.crockford.com/">Douglas Crockford</a> advised in his book <a target="_blank" href="http://elegantcode.com/2010/05/24/book-review-javascript-the-good-parts/">JavaScript &ndash; The Good Parts</a> to declare all variables at the top of the function body. In order to prevent nasty side-effects like this to happen, I think it's best taking up on that advice.</p></ol><ol>Till next time.</ol></div> </div>		<!--=========================			END : POST		=============================-->		<!--=========================			START : POST =============================-->		<div class="post-wrapper">		<h1>Basic JavaScript Part 8: Namespaces</h1>		<div class="vw-post-content clearfix"><p>Here are the links to the previous installments:</p><ol><li><a href="http://elegantcode.com/2010/10/22/basic-javascript-part-1-functions/">Functions</a> </li><li><a href=" http://elegantcode.com/2010/11/12/basic-javascript-part-2-objects/">Objects</a> </li><li><a href="http://elegantcode.com/2010/12/03/basic-javascript-part-3-prototypes/">Prototypes</a> </li><li><a href="http://elegantcode.com/?p=4015">Enforcing New on Constructor Functions</a> </li><li><a href="http://elegantcode.com/2010/12/24/basic-javascript-part-5-hoisting/">Hoisting </a> </li><li><a href="http://elegantcode.com/2011/01/12/basic-javascript-part-6-automatic-semicolon-insertion/">Automatic Semicolon Insertion</a> </li><li><a href=" http://elegantcode.com/2011/01/19/basic-javascript-part-7-static-properties-and-methods/">Static Properties and Methods</a> </li></ol><p>In my <a href=" http://elegantcode.com/2011/01/19/basic-javascript-part-7-static-properties-and-methods/">previous post</a>, I showed how you can <em>‘emulate'</em> static members in JavaScript without having a dedicated syntax for it. For this post, I'm going to discuss namespaces in JavaScript. In order to reduce the number of objects and functions that are added to the global scope in our applications, using namespaces in JavaScript is definitely a recommended practice. Just like static members, namespaces don't have any dedicated syntax built into the language either. But we're able to get the same benefits by creating a single global object and adding all our objects and functions to this object.</p><pre class="csharpcode"><span class="kwrd"> var</span> AppSpace = AppSpace || {};AppSpace.Podcast = <span class="kwrd">function</span> {    <span class="kwrd">this</span>.title = <span class="str">'Astronomy Cast'</span>;    <span class="kwrd">this</span>.description = <span class="str">'A fact-based journey through the galaxy.'</span>;    <span class="kwrd">this</span>.link = <span class="str">' http://www.astronomycast.com'</span>;};AppSpace.Podcast.prototype.toString = <span class="kwrd">function</span>() {    <span class="kwrd">return</span> <span class="str">'Title: '</span> + <span class="kwrd">this</span>.title;}</pre><p>This way we lower the possibility of naming collisions when using our code in conjunction with other JavaScript libraries. We can also use the same naming conventions for namespaces as in any other programming language that does provide syntactical support. Suppose we want to use a namespace like "<em> MyCompany.MyApplication.Model"</em>. We can accomplish this by using the same approach as shown earlier:</p><pre class="csharpcode"><span class="kwrd">var</span> MyCompany = MyCompany || {};MyCompany.MyApplication = {};MyCompany.MyApplication.Model = {};</pre><p>or something like the following:</p><pre class="csharpcode"><span class="kwrd">var</span> MyCompany = MyCompany || {    MyApplication: {        Model: {}    }};</pre><p>However, this approach can become very cumbersome and hard to maintain when our code expands over time. In order to overcome this issue we can use a general purpose namespace function to achieve the same thing using a single line of code.</p><pre class="csharpcode"><span class="kwrd">var</span> model = <span class= "kwrd">namespace</span>(<span class="str">'MyCompany.MyApplication.Model'</span>);model.Podcast = <span class="kwrd">function</span> {    <span class="kwrd">this</span>.title = <span class ="str">'Astronomy Cast'</span>;    <span class="kwrd">this</span>.description = <span class="str">'A fact-based journey through the galaxy.'</span>;    <span class="kwrd">this</span>.link = <span class="str">'http://www.astronomycast.com'</span>;};model.Podcast.prototype.toString = <span class="kwrd">function</span>() {    <span class="kwrd">return</span> <span class="str"> 'Title: '</span> + <span class="kwrd">this</span>.title;}</pre><p>Here's an example of how we can implement such a namespace function.</p><pre class="csharpcode"><span class="kwrd"> function</span> <span class="kwrd">namespace</span>(namespaceString) {    <span class="kwrd">var</span> parts = namespaceString.split(<span class="str">'.'</span>),        parent = window,        currentPart = <span class="str">''</span>;    <span class="kwrd">for</span>(<span class="kwrd">var</span> i = 0, length = parts.length; i &lt; length; i++) { currentPart = parts[i];        parent[currentPart] = parent[currentPart] || {};        parent = parent[currentPart];    }    <span class="kwrd">return</span> parent;}</pre><p>Using this approach requires less typing and the resulting code also looks less verbose. Some JavaScript libraries, like YUI and the Dojo Toolkit, provide their own implementations for such a namespace utility function. I encourage you to take a look at their implementations as well.</p><p>Until next time.&nbsp; </p></div>			</div> <!--=========================			END : POST		=============================-->		<!--=========================			START : POST =============================-->		<div class="post-wrapper">		<h1>Basic JavaScript Part 10: The Module Pattern</h1>		<div class="vw-post-content clearfix"><p>Here are the links to the previous installments:</p><ol><li><a target="_blank" href="http://elegantcode.com/2010/10/22/basic-javascript-part-1-functions/">Functions</a></li><li><a target="_blank" href= "http://elegantcode.com/2010/11/12/basic-javascript-part-2-objects/">Objects</a></li><li><a target="_blank" href="http://elegantcode.com/2010/12/03/basic-javascript-part-3-prototypes/"> Prototypes</a></li><li><a target="_blank" href="http://elegantcode.com/?p=4015">Enforcing New on Constructor Functions</a></li><li><a target="_blank" href=" http://elegantcode.com/2010/12/24/basic-javascript-part-5-hoisting/">Hoisting</a></li><li><a target="_blank" href=" http://elegantcode.com/2011/01/12/basic-javascript-part-6-automatic-semicolon-insertion/">Automatic Semicolon Insertion</a></li><li><a target="_blank" href=" http://elegantcode.com/2011/01/19/basic-javascript-part-7-static-properties-and-methods/">Static Properties and Methods</a></li><li><a target="_blank" href=" http://elegantcode.com/2011/01/26/basic-javascript-part-8-namespaces/">Namespaces</a></li><li><a target="_blank" href=" http://elegantcode.com/2011/01/31/basic-javascript-part-9-reusing-methods-of-other-objects/">Reusing Methods of Other Objects</a></li></ol><ol>The module pattern is quite popular in the JavaScript community as is heavily applied by many JavaScript developers. There's also the <a href="http://www.commonjs.org/">CommonJS</a> initiative, which defines a specification for a common set of JavaScript API's that are organized using self-contained modules. These specifications are supported by a growing community as they provide the foundation for the <a target= "_blank" href="http://www.dzone.com/links/r/taking_baby_steps_with_nodejs_commonjs_and_creati.html">modules that are built into Node.js</a> and numerous other open-source JavaScript libraries. This pattern has become so widespread because it's an excellent way to package and organize an independent, self-containing piece of JavaScript code. The module pattern is composed by using <a target="_blank" href="http://elegantcode.com/2010/10/22/basic-javascript-part-1-functions/">self-executing functions</a> combined with <a target="_blank" href=" http://elegantcode.com/2011/01/26/basic-javascript-part-8-namespaces/">namespaces</a>. Let's show a simple example.<pre class="csharpcode"><span class="kwrd">namespace</span>(<span class= "str">'media'</span>);media.podcast = (<span class="kwrd">function</span>(name) {    <span class="kwrd">var</span> fileExtension = <span class="str">'mp3'</span>;    <span class="kwrd"> function</span> determineFileExtension() {        console.log(<span class="str">'File extension is of type '</span> + fileExtension);    }    <span class="kwrd">return</span> { download: <span class="kwrd">function</span>(episode) {            console.log(<span class="str">'Downloading '</span> + episode + <span class="str">' of '</span> + name); determineFileExtension();        }    }}(<span class="str">'Astronomy podcast'</span>));</pre><p>First we define a namespace called <em>media</em>. Then we use a self-executing function that returns an anonymous object with a method named <em>download</em> that can be invoked by external code. Inside the self-executing function we have a variable <em>fileExtension</em> and a function <em>determineFileExtension</em> that are private and can only be used inside the <em>module</em>. Notice that we provide a fixed parameter value for the self-executing function. This technique is usually applied to pass in some kind of global object. <a target="_blank" href="https://github.com/jquery">jQuery</a> uses this same approach to <a target= "_blank" href="https://github.com/jquery/jquery/blob/master/src/core.js">inject a reference to the global window object</a> into the scope of its module. </p></ol><ol>We can use the <em> download</em> method of our module like so ...<p></p><pre class="csharpcode">media.podcast.download(<span class="str">'the first episode'</span>);</pre><p>... which outputs what we expect: </p><blockquote dir="ltr" style="margin-right: 0px"><p><em>Downloading the first episode of Astronomy podcast</em></p><p><em>File extension is of type mp3</em></p></blockquote><p>The way we implemented the module pattern here has at least one major downside. We're able to completely replace the implementation of the <em>download</em> method that is exported by the anonymous object returned from the self-executing function. This can become quite troublesome if we have other functions inside our module that also make use of the <em>download</em> method and thereby rely on its functionality. The way to fix this issue is to make all functions private and export them using the anonymous object: </p></ol><ol><pre class="csharpcode" ><span class="kwrd">namespace</span>(<span class="str">'media'</span>);media.podcast = (<span class="kwrd">function</span>(name) {    <span class="kwrd">var</span> fileExtension = <span class="str">'mp3'</span>;    <span class="kwrd">function</span> determineFileExtension() {        console.log(<span class="str">'File extension is of type '</span> +fileExtension); }    <span class="kwrd">function</span> download(episode) {        console.log(<span class="str">'Downloading '</span> + episode + <span class="str">' of '</span> + name); determineFileExtension();    }    <span class="kwrd">return</span> {        download: download    }}(<span class="str">'Astronomy podcast'</span>));</pre></ol><ol>The <em>download</em> method exposed by the anonymous object can still be replaced, but at least the correct implementation is preserved by the private <em>download</em> function for other functions that rely on its behavior. This approach is commonly called the <em>"revealing module pattern"</em>.&nbsp; </ol><ol>Another neat approach is to export a constructor function instead of an anonymous object.</ol><ol><pre class="csharpcode"><span class="kwrd">namespace</span>(<span class="str">'media'</span>);media.Podcast = (<span class="kwrd">function</span>() {    <span class="kwrd"> var</span> fileExtension = <span class="str">'mp3'</span>;    <span class="kwrd">function</span> determineFileExtension() {        console.log(<span class="str">'File extension is of type '</span> +fileExtension);    }    <span class="kwrd">var</span> podcastConstructor = <span class="kwrd">function</span> Podcast(name) {        <span class="kwrd">if</span>(<span class= "kwrd">false</span> === (<span class="kwrd">this</span> instanceof Podcast)) {            <span class="kwrd">return</span> <span class="kwrd">new</span> Podcast();        }        <span class="kwrd">this</span>.getName = <span class="kwrd">function</span>() {            <span class="kwrd">return</span> name;        }    }    podcastConstructor.prototype.download = <span class="kwrd">function</span> (episode) {        console.log(<span class="str">'Downloading '</span> + episode + <span class="str">' of '</span> + <span class="kwrd">this</span> .getName());        determineFileExtension();    }    <span class="kwrd">return</span> podcastConstructor;}());</pre></ol><ol>Instead of returning an anonymous object from our self-executing function, we create another function and add the <em>download</em> method to the prototype of this constructor function. Notice that we also moved the <em>name</em> parameter to the constructor function instead of passing it into the self-executing function. At the end of the self-executing function we just return this constructor function like we did with the anonymous object. </ol><ol>We can now use this module like so ... </ol><ol><pre class="csharpcode"><span class="kwrd">var</span> astronomyCast = <span class="kwrd">new</span> media.Podcast(<span class="str">'Astronomy podcast'</span>);astronomyCast.download(<span class="str">'the first episode'</span>);</pre></ol><ol>... which yields the same output as before. </ol><ol>The module pattern is a very powerful concept in JavaScript. Being able to expose and use JavaScript code, treating it as a black box, is a very common technique that is used in lots of JavaScript libraries and frameworks. </ol><p>Happy coding!</p></div>			</div>		<!--=========================			END : POST =============================-->		<!--=========================			START : POST		=============================-->		<div class="post-wrapper">		<h1> Demystifying JavaScript Variable Scope and Hoisting</h1>		<div class="ArticleCopy language-">    <p>Every building needs strong foundation to build on. Understanding variable scope in JavaScript is one of the keys to building a solid foundation. This article will explain how JavaScript's scoping system works. We'll also cover a related topic known as <a href=" http://www.sitepoint.com/back-to-basics-javascript-hoisting/">hoisting</a>.</p><h2 id="variable-scope">Variable Scope</h2><p>To work with JavaScript efficiently, one of the first things you need to understand is the concept of variable scope. The scope of a variable is controlled by the location of the variable declaration, and defines the part of the program where a particular variable is accessible.</p><p>Scoping rules vary from language to language. JavaScript has two scopes &ndash; <em>global</em> and <em>local</em>. Any variable declared outside of a function belongs to the global scope, and is therefore accessible from anywhere in your code. Each function has its own scope, and any variable declared within that function is only accessible from that function and any nested functions. Because local scope in JavaScript is created by functions, it's also called function scope. When we put a function inside another function, then we create nested scope.</p><p>Currently, JavaScript, unlike many other languages, does not support block level scoping. This means that declaring a variable inside of a block structure like a <code class=" language-undefined">for</code> loop, does not restrict that variable to the loop. Instead, the variable will be accessible from the entire function. It's worth noting that the upcoming <a href="http://www.sitepoint.com/preparing-ecmascript-6-let-const/">ECMAScript 6 will support block level scopes via the <code class=" language-undefined">let</code> keyword</a>.</p><p>To make things clear let's use a simple metaphor. Every country in our world has frontiers. Everything inside these frontiers belongs to the country's scope. In every country there are many cities, and each one of them has its own city's scope. The countries and cities are just like JavaScript functions &ndash; they have their local scopes. The same is true for the continents. Although they are huge in size they also can be defined as locales. On the other hand, the world's oceans can't be defined as having local scope, because it actually wraps all local objects &ndash; continents, countries, and cities &ndash; and thus, its scope is defined as global. Let's visualize this in the next example:</p><pre class=" language-javascript"><code class=" language-javascript"><span class="token keyword">var</span> locales <span class="token operator">=</span> <span class= "token punctuation">{</span>  europe<span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>          <span spellcheck="true" class="token comment">// The Europe continent's local scope</span>    <span class="token keyword">var</span> myFriend <span class="token operator">=</span> <span class="token string">"Monique"</span><span class="token punctuation">;</span>    <span class="token keyword">var </span> france <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class ="token punctuation">{</span>   <span spellcheck="true" class="token comment">// The France country's local scope</span>      <span class="token keyword">var</span> paris <span class= "token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{ </span>  <span spellcheck="true" class="token comment">// The Paris city's local scope</span>        console<span class="token punctuation">.</span><span class="token function">log </span><span class="token punctuation">(</span>myFriend<span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token punctuation">}</span><span class="token punctuation">;</span>      <span class="token function">paris</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">;</span>    <span class="token function">france</span><span class="token punctuation">( </span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">;</span>locales<span class="token punctuation">.</span><span class="token function">europe</span><span class="token punctuation">(</span><span class="token punctuation">) </span><span class="token punctuation">;</span></code></pre><p><a href="http://jsbin.com/lewufuroqi/1/edit?js,console,output">Try out the example in JS Bin</a></p><p>Now that we understand what local and global scopes are, and how they are created, it's time to learn how the JavaScript interpreter uses them to find a particular variable.</p><p>Back to the given metaphor, let's say I want to find a friend of mine whose name is Monique. I know that she lives in Paris, so I start my searching from there. When I can't find her in Paris I go one level up and expand my searching in all of France. But again, she is not there. Next, I expand my searching again by going another level up. Finally, I found her in Italy, which in our case is the local scope of Europe. </p><p>In the previous example my friend Monique is represented by the variable <code class=" language-undefined">myFriend</code>. In the last line we call the <code class=" language-undefined">europe()</code> function, which calls <code class=" language-undefined">france()</code>, and finally when the <code class=" language-undefined"> paris()</code> function is called, the searching begins. The JavaScript interpreter works from the currently executing scope and works it way out until it finds the variable in question. If the variable is not found in any scope, then an exception is thrown.</p><p>This type of look up is called <a href="http://en.wikipedia.org/wiki/Lexical_scoping#Lexical_scoping">lexical (static) scope</a>. The static structure of a program determines the variable scope. The scope of a variable is defined by its location within the source code, and nested functions have access to variables declared in their outer scope. No matter where a function is called from, or even how it's called, its lexical scope depends only by where the function was declared. </p><p>In JavaScript, variables with the same name can be specified at multiple layers of nested scope. In such case local variables gain priority over global variables. If you declare a local variable and a global variable with the same name, the local variable will take precedence when you use it inside a function. This type of behavior is called <em>shadowing</em>. Simply put, the inner variable shadows the outer.</p><p>That's the exact mechanism used when a JavaScript interpreter is trying to find a particular variable. It starts at the innermost scope being executed at the time, and continue until the first match is found, no matter whether there are other variables with the same name in the outer levels or not. Let's see an example:</p><pre class=" language-javascript"><code class=" language-javascript"><span class="token keyword">var</span> test <span class="token operator">=</span> <span class="token string">"I'm global"</span><span class="token punctuation">;</span><span class="token keyword">function</span> <span class="token function">testScope</span><span class="token punctuation"> (</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token keyword">var</span> test <span class="token operator">=</span> <span class= "token string">"I'm local"</span><span class="token punctuation">;</span>  console<span class="token punctuation">.</span>log <span class="token punctuation">(</span>test<span class= "token punctuation">)</span><span class="token punctuation">;</span>     <span class="token punctuation">}</span><span class="token function">testScope</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>           <span spellcheck="true" class="token comment">// output: I'm local</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>test<span class="token punctuation">)</span><span class= "token punctuation">;</span>     <span spellcheck="true" class="token comment">// output: I'm global</span></code></pre><p><a href="http://jsbin.com/lewufuroqi/2/edit?js,console,output"> Try out the example in JS Bin</a></p><p>As we can see even with the same name the local variable doesn't overwrite the global one after the execution of <code class=" language-undefined"> testScope()</code> function. But this is not always the truth. Let's consider this:</p><pre class=" language-javascript"><code class=" language-javascript"><span class="token keyword">var </span> test <span class="token operator">=</span> <span class="token string">"I'm global"</span><span class="token punctuation">;</span><span class="token keyword">function</span> <span class="token function">testScope</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  test <span class="token operator">=</span> <span class="token string">"I'm local"</span><span class="token punctuation">;</span>  console<span class="token punctuation">.</span><span class="token function">log </span><span class="token punctuation">(</span>test<span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token punctuation">}</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>test<span class="token punctuation">)</span><span class="token punctuation">;</span>     <span spellcheck="true" class="token comment">// output: I'm global</span><span class="token function">testScope</span><span class="token punctuation">( </span><span class="token punctuation">)</span><span class="token punctuation">;</span>           <span spellcheck="true" class="token comment">// output: I'm local</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>test<span class="token punctuation">)</span><span class="token punctuation" >;</span>     <span spellcheck="true" class="token comment">// output: I'm local (the global variable is reassigned)</span></code></pre><p><a href=" http://jsbin.com/lewufuroqi/3/edit?js,console,output">Try out the example in JS Bin</a></p><p>This time the local variable <code class=" language-undefined">test</code> overwrites the global variable with the same name. When we run the code inside <code class=" language-undefined">testScope()</code> function the global variable is reassigned. If a local variable is assigned without first being declared with the <code class=" language-undefined">var</code> keyword, it becomes a global variable. To avoid such unwanted behavior you should always declare your local variables before you use them. Any variable declared with the <code class=" language-undefined">var</code> keyword inside of a function is a local variable. It's considered best practice to declare your variables.</p><p>Note &ndash; In <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Strict_mode">strict mode</a>, it is an error, if you assign value to variable without first declaring the variable.</p><h2 id="hoisting">Hoisting</h2><p>A JavaScript interpreter performs many things behind the scene, and one of them is called hoisting. If you are not aware of this "hidden" behavior, it can cause a lot of confusion. The best way of thinking about the behavior of JavaScript variables is to always visualize them as consisting of two parts: a declaration and an assignment:</p><pre class=" language-javascript"><code class=" language-javascript"><span class="token keyword">var </span> state<span class="token punctuation">;</span>             <span spellcheck="true" class="token comment">// variable declaration</span>state <span class="token operator">=</span> <span class="token string">"ready"</span><span class="token punctuation">;</span>       <span spellcheck="true" class="token comment">// variable definition (assignment)</span><span class= "token keyword">var</span> state <span class="token operator">=</span> <span class="token string">"ready"</span><span class="token punctuation">;</span>   <span spellcheck="true" class= "token comment">// declaration plus definition</span></code></pre><p>In the above code we first declare variable <code class=" language-undefined">state</code>, and then we assign the value "ready" to it. And in the last line of code we see that these two steps can be combined. But what you need to bear in mind is, even though they seem like one statement, in practice, the JavaScript engine treats that single statement as two separate statements, just like in the first two lines in the example.</p><p>We already know that any variable declared within a scope belongs to that scope. But what we don't know yet, is that no matter where variables are declared within a particular scope, all variable declarations are moved to the top of their scope (global or local). This is called <em>hoisting</em>, as the variable declarations are hoisted to the top of the scope. Note that hoisting only moves the declaration. Any assignments are left in place. Let's see an example:</p><pre class=" language-javascript"><code class=" language-javascript">console<span class="token punctuation">.</span><span class="token function" >log</span><span class="token punctuation">(</span>state<span class="token punctuation">)</span><span class="token punctuation">;</span>   <span spellcheck="true" class="token comment">// output: undefined</span><span class="token keyword">var</span> state <span class="token operator">=</span> <span class="token string">"ready"</span><span class="token punctuation">; </span></code></pre><p><a href="http://jsbin.com/lewufuroqi/4/edit?js,console,output">Try out the example in JS Bin</a></p><p>As you can see when we log the value of <code class=" language-undefined">state</code>, the output is <code class=" language-undefined">undefined</code>, because we reference it before the actual assignment. You may have expected a ReferenceError to be thrown because <code class=" language-undefined">state</code> is not declared yet. But what you don't know is that the variable <em>is</em> declared behind the scene. Here is how the code is interpreted by a JavaScript engine:</p><pre class=" language-javascript"><code class=" language-javascript"><span class="token keyword">var</span> state<span class= "token punctuation">;</span>           <span spellcheck="true" class="token comment">// moved to the top</span>console<span class="token punctuation">.</span><span class="token function"> log</span><span class="token punctuation">(</span>state<span class="token punctuation">)</span><span class="token punctuation">;</span>   state <span class="token operator">=</span> <span class="token string">"ready"</span><span class="token punctuation">;</span>     <span spellcheck="true" class="token comment">// left in place</span></code></pre><p>Hoisting also affects function declarations. But before we see some examples, let's first learn the difference between function declaration and function expression.</p><pre class=" language-javascript"><code class=" language-javascript"><span class="token keyword">function</span> <span class="token function">showState</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>          <span spellcheck="true" class="token comment">// function declaration </span><span class="token keyword">var</span> showState <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class ="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>   <span spellcheck="true" class= "token comment">// function expression</span></code></pre><p>The easiest way to distinguish a function declaration from a function expression is to check the position of the word <code class=" language-undefined">function</code> in the statement. If <code class=" language-undefined">function</code> is the very first thing in the statement, then it's a function declaration. Otherwise, it's a function expression.</p><p>Function declarations are hoisted completely. This means that the entire function's body is moved to the top. This allows you to call a function before it has been declared:</p><pre class=" language-javascript"><code class=" language-javascript"><span class="token function">showState</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span spellcheck="true" class="token comment">// output: Ready</span><span class="token keyword">function</span> <span class="token function">showState</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"Ready" </span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span> <span class="token keyword">var</span> showState <span class ="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{ </span>  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"Idle"</span><span class= "token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre><p><a href=" http://jsbin.com/lewufuroqi/5/edit?js,console,output">Try out the example in JS Bin</a></p><p>The reason the preceding code works is that JavaScript engine moves the declaration of <code class=" language-undefined">showState()</code> function, and all its content, to the beginning of the scope. The code is interpreted like this:</p><pre class=" language-javascript"><code class=" language-javascript"><span class="token keyword">function</span> <span class="token function">showState</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>     <span spellcheck="true" class="token comment">// moved to the top (function declaration)</span>  console<span class= "token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"Ready"</span><span class="token punctuation">) </span><span class="token punctuation">;</span><span class="token punctuation">}</span> <span class="token keyword">var</span> showState<span class="token punctuation">;</span> <span spellcheck="true" class="token comment">// moved to the top (variable declaration)</span><span class="token function">showState</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  showState <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>   <span spellcheck="true" class="token comment">// left in place (variable assignment)</span>  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"Idle" </span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre><p>As you may have noticed, only the function declaration is hoisted, but the function expression is not. When a function is assigned to a variable, the rules are the same as for variable hoisting (only the declaration is moved, while the assignment is left in place).</p><p>In the code above we saw that the function declaration takes precedence over the variable declaration. And in the next example we'll see that when we have function declaration versus variable assignment, the last takes priority.</p><pre class=" language-javascript"><code class= " language-javascript"><span class="token keyword">var</span> showState <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">( </span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  console<span class="token punctuation">.</span><span class="token function">log</span><span class= "token punctuation">(</span><span class="token string">"Idle"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">} </span><span class="token punctuation">;</span><span class="token keyword">function</span> <span class="token function">showState</span><span class="token punctuation">(</span><span class= "token punctuation">)</span> <span class="token punctuation">{</span>  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation" >(</span><span class="token string">"Ready"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span> <span class= "token function">showState</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span spellcheck="true" class="token comment">// output: Idle</span></code></pre><p><a href="http://jsbin.com/lewufuroqi/6/edit?js,console,output">Try out the example in JS Bin</a></p><p>This time we call <code class=" language-undefined">showState()</code> function in the last line of code which change the situation. Now we get output "Idle". Here is how it looks when interpreted by JavaScript engine:</p><pre class=" language-javascript"><code class=" language-javascript"><span class="token keyword">function</span> <span class="token function">showState</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span spellcheck="true" class="token comment">// moved to the top (function declaration)</span>  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"Ready" </span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span> <span class="token keyword">var</span> showState<span class= "token punctuation">;</span>               <span spellcheck="true" class="token comment">// moved to the top (variable declaration)</span>showState <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>      <span spellcheck= "true" class="token comment">// left in place (variable assignment)</span>  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"Idle"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token function">showState</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><h2 id="things-to-remember">Things to Remember</h2><ul><li>All declarations, both functions and variables, are hoisted to the top of the containing scope, before any part of your code is executed. </li><li>Functions are hoisted first, and then variables. </li><li>Function declarations have priority over variable declarations, but not over variable assignments.</li></ul>  </div>			</div>		<!--=========================			END : POST		=============================--> <!--=========================			START : POST		=============================-->		<div class="post-wrapper">		<h1>The Final Steps to Mastering JavaScript's "this" Keyword</h1>		<div class="ArticleCopy language-">    <p>In a <a href="http://www.sitepoint.com/inner-workings-javascripts-this-keyword/">previous article</a> we learned the fundamentals of using JavaScript's <code class=" language-undefined">this</code> keyword properly. We saw that the crucial factor in determining what <code class=" language-undefined">this </code> refers to, is to find out the current execution context. However, this task can be a bit tricky in situations where the context gets changed in a way we don't expect. In this article I will highlight when this might happen and what we can do to remedy it.</p><h2 id="fixing-common-issues">Fixing Common Issues</h2><p>In this section we'll explore some of the most common issues arising from the use of the <code class=" language-undefined">this</code> keyword and  we'll learn how to fix them.</p><h3 id="1-using-this-in-extracted-methods">1. Using <code class=" language-undefined">this</code> in Extracted Methods</h3><p>One of the most common mistakes that people make is when trying to assign an object's method to a variable and expecting that <code class=" language-undefined">this</code> will still point to the original object. As we can see from the following example, that simply doesn't work.</p><pre class= " language-javascript"><code class=" language-javascript"><span class="token keyword">var</span> car <span class="token operator">=</span> <span class="token punctuation">{</span>  brand <span class="token punctuation">:</span> <span class="token string">"Nissan"</span><span class="token punctuation">,</span>  getBrand<span class="token punctuation">:</span> <span class= "token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>brand <span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token keyword">var</span> getCarBrand <span class="token operator">=</span> car<span class="token punctuation">.</span>getBrand<span class="token punctuation">;</span><span class="token function">getCarBrand</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span spellcheck="true" class="token comment">// output: undefined</span></code></pre><p>Even though <code class=" language-undefined">getCarBrand</code> appears to be a reference to <code class=" language-undefined">car.getBrand()</code>, in fact, it's just another reference to <code class=" language-undefined">getBrand()</code> itself. We already know that the call-site is what matters in determining the context, and here, the call-site is <code class=" language-undefined">getCarBrand()</code>, which is a plain and simple function call.</p><p> To prove that <code class=" language-undefined">getCarBrand</code> points to a baseless function (one which isn't bound to any specific object), just add <code class=" language-undefined"> alert(getCarBrand);</code> to the bottom of the code and you'll see the following output:</p><pre class=" language-javascript"><code class=" language-javascript"><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>  console<span class="token punctuation">. </span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>brand<span class= "token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><p><code class=" language-undefined">getCarBrand</code> holds just a plain function, which is no longer a method of the <code class=" language-undefined">car</code> object. So, in this case, <code class=" language-undefined">this.brand</code> actually translates to <code class=" language-undefined">window.brand</code>, which is, of course, <code class=" language-undefined">undefined</code>. </p><p>If we extract a method from an object, it becomes a plain function again. Its connection to the object is severed, and it no longer works as intended. In other words, an extracted function is not bound to the object it was taken from.</p><p>So how can we remedy this? Well, if we want to keep the reference to the original object, we need to explicitly bind the <code class=" language-undefined">getBrand() </code> function to the <code class=" language-undefined">car</code> object when we assign it to the <code class=" language-undefined">getCarBrand</code> variable. We can do this by using the <a href="https://developer.mozilla.org/de/docs/Web/JavaScript/Reference/Global_Objects/Function/bind">bind() method</a>.</p><pre class=" language-javascript"><code class=" language-javascript"><span class="token keyword">var</span> getCarBrand <span class="token operator">=</span> car<span class="token punctuation">.</span>getBrand<span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span>car<span class="token punctuation">)</span><span class="token punctuation">; </span><span class="token function">getCarBrand</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span spellcheck="true" class="token comment">// output: Nissan</span></code></pre><p>Now, we get the proper output, because we successfully redefine the context to what we want it to be.</p><h3 id="2-this-used-in-callbacks">2 <code class=" language-undefined">this</code> Used in Callbacks</h3><p>The next issue occurs when we pass a method (that uses <code class=" language-undefined">this</code> as a parameter) to be used as a callback function. For example:</p><pre class=" language-javascript"><code class=" language-javascript"><span class="token operator">&lt;</span>button id<span class="token operator">=</span><span class="token string">"btn"</span> type<span class="token operator">=</span><span class="token string">"button" </span><span class="token operator">&gt;</span>Get the car's brand<span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt; </span><span class="token keyword">var</span> car <span class="token operator">=</span> <span class="token punctuation">{</span>  brand<span class="token punctuation">:</span> <span class= "token string">"Nissan"</span><span class="token punctuation">,</span>  getBrand<span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    console<span class="token punctuation">.</span><span class="token function">log </span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>brand<span class="token punctuation">)</span><span class= "token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token keyword">var</span> el <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">"btn"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>el<span class="token punctuation">.</span><span class="token function"> addEventListener</span><span class="token punctuation">(</span><span class="token string">"click"</span><span class="token punctuation">,</span> car<span class="token punctuation">.</span> getBrand<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>Even though we use <code class=" language-undefined">car.getBrand</code>, we actually only get the function <code class=" language-undefined">getBrand()</code> which is attached to the <code class=" language-undefined">button</code> object. </p><p>Passing a parameter to a function is an implicit assignment, so what happens here is almost the same as in the previous example. The difference is that now <code class=" language-undefined"> car.getBrand</code> is not explicitly assigned, but implicitly. And the result is pretty much the same&mdash;what we get is a plain function, bound to the <code class=" language-undefined" >button</code> object. </p><p>In other words, when we execute a method on an object, which is different from the object upon which the method was originally defined, the <code class=" language-undefined">this</code> keyword no longer refers to the original object, rather to the object that invokes the method. </p><p>With reference to our example: we are executing <code class=" language-undefined">car.getBrand</code> on <code class=" language-undefined">el</code> (the button element), not the <code class=" language-undefined">car</code> object, upon which it was originally defined. Consequently, <code class=" language-undefined">this</code> no longer refers to <code class=" language-undefined">car</code>, rather to <code class=" language-undefined">el</code>.</p><p>If we want to keep the reference to the original object intact, again, we need to explicitly bind the <code class=" language-undefined">getBrand() </code> function to the <code class=" language-undefined">car</code> object by using the <code class=" language-undefined">bind()</code> method.</p><pre class=" language-javascript"><code class=" language-javascript">el<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">"click"</span><span class="token punctuation">,</span> car<span class="token punctuation">.</span>getBrand<span class="token punctuation">.</span><span class="token function">bind </span><span class="token punctuation">(</span>car<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p> Now, everything works as expected.</p><h3 id="3-this-used-inside-closures">3 <code class=" language-undefined">this</code> Used Inside Closures</h3><p>Another instance when <code class=" language-undefined">this</code>'s context can be mistaken is when we use <code class=" language-undefined">this</code> inside of <a href=" http://www.sitepoint.com/demystifying-javascript-closures-callbacks-iifes/">a closure</a>. Consider the following example:</p><pre class=" language-javascript"><code class=" language-javascript"><span class="token keyword">var</span> car <span class="token operator">=</span> <span class="token punctuation">{</span>  brand<span class="token punctuation">: </span> <span class="token string">"Nissan"</span><span class="token punctuation">,</span>  getBrand<span class="token punctuation">:</span> <span class="token keyword">function </span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">var</span> closure <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{ </span>      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>brand<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token function">closure</span><span class="token punctuation">(</span><span class="token punctuation">) </span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">;</span>car<span class= "token punctuation">.</span><span class="token function">getBrand</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">; </span>   <span spellcheck="true" class="token comment">// output: undefined</span></code></pre><p>Here, the output we get is <code class=" language-undefined">undefined</code>, because closure functions (inner functions) don't have access to the <code class=" language-undefined">this</code> variable of outer functions. The net result is that <code class=" language-undefined">this.brand</code> is equal to <code class=" language-undefined">window.brand</code>, because <code class=" language-undefined">this</code> in inner functions is bound to the global object.</p><p>To fix this issue, we need to keep <code class=" language-undefined">this</code> bound to the <code class=" language-undefined">getBrand()</code> function. </p><pre class=" language-javascript"><code class=" language-javascript"><span class="token keyword">var</span> car <span class="token operator">=</span> <span class="token punctuation">{ </span>  brand<span class="token punctuation">:</span> <span class="token string">"Nissan"</span><span class="token punctuation">,</span>  getBrand<span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">var</span> closure <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">) </span><span class="token punctuation">{</span>      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>brand<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token function">closure</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">;</span>car<span class="token punctuation">.</span><span class="token function">getBrand</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span spellcheck="true" class="token comment">// output: Nissan</span></code></pre><p>This binding is equivalent to <code class=" language-undefined">car.getBrand.bind(car)</code>.</p><p>Another popular method to fix closures, is to assign the <code class=" language-undefined">this</code> value to another variable, thus preventing the unwanted change.</p><pre class=" language-javascript"><code class=" language-javascript"><span class="token keyword">var</span> car <span class="token operator">=</span> <span class="token punctuation">{</span>  brand<span class="token punctuation">:</span> <span class="token string">"Nissan"</span><span class="token punctuation">, </span>  getBrand<span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">var</span> self <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>    <span class="token keyword">var</span> closure <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">( </span><span class="token punctuation">)</span><span class="token punctuation">{</span>      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>brand<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token function">closure</span><span class="token punctuation">( </span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">;</span>car<span class="token punctuation">.</span><span class="token function">getBrand</span><span class="token punctuation">(</span><span class="token punctuation">) </span><span class="token punctuation">;</span>   <span spellcheck="true" class="token comment">// output: Nissan</span></code></pre><p>Here, the value of <code class=" language-undefined" >this</code> can be assigned to <code class=" language-undefined">_this</code>, <code class=" language-undefined">that</code>, <code class=" language-undefined">self</code>, <code class=" language-undefined">me</code>, <code class=" language-undefined">my</code>, <code class=" language-undefined">context</code>, an object's pseudo name, or whatever else works for you. The main point is to keep a reference to the original object. </p><h2 id="ecmascript-6-to-the-rescue">ECMAScript 6 to the Rescue</h2><p>In the previous example we saw a primer on what is known as "lexical <code class=" language-undefined">this</code>"&mdash;when we set the <code class=" language-undefined">this</code> value to another variable. In ECMAScript 6 we can use the similar, but more elegant, technique, applicable via the new arrow functions.</p><p><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Functions/Arrow_functions ">Arrow-functions</a> are created not by the <code class=" language-undefined">function</code> keyword, but by the so-called "fat arrow" operator (<code class=" language-undefined">=&gt; </code>).  Unlike regular functions, arrow functions take the <code class=" language-undefined">this</code> value from their immediate enclosing scope. The lexical binding of an arrow function can't be overridden, even with the <code class=" language-undefined">new</code> operator.</p><p>Let's now see how arrow function can be used to substitute the <code class=" language-undefined">var self = this;</code> statement.</p><pre class=" language-javascript"><code class=" language-javascript"><span class="token keyword">var</span> car <span class= "token operator">=</span> <span class="token punctuation">{</span>  brand<span class="token punctuation">:</span> <span class="token string">"Nissan"</span><span class="token punctuation"> ,</span>  getBrand<span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span spellcheck="true" class="token comment">// the arrow function keeps the scope of "this" lexical</span>    <span class="token keyword">var</span> closure <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>         console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation" >(</span><span class="token keyword">this</span><span class="token punctuation">.</span>brand<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class ="token punctuation">}</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token function">closure</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">;</span>car<span class="token punctuation">.</span><span class="token function">getBrand</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span spellcheck="true" class="token comment">// output: Nissan</span></code></pre><h2 id= "what-you-need-to-remember-about-this">What You Need to Remember About <code class=" language-undefined">this</code></h2><p>We saw that the <code class=" language-undefined">this</code> keyword, like every other mechanism, follows some simple rules, and if we know them well, then we can use that mechanism with more confidence. So, let's quickly recap what we have learned (from this and from the previous article):</p><ul><li><code class=" language-undefined">this</code> refers to the global object in the following cases: <ul><li>in the outermost context, outside of any function block</li><li>in functions that are not methods of objects</li><li>in functions that are not object constructors</li></ul></li><li>When a function is called as a property on a parent object, <code class=" language-undefined">this</code> refers to the parent object.</li><li>When a function is called using <code class=" language-undefined">call() </code> or <code class=" language-undefined">apply()</code>, or <code class=" language-undefined">bind()</code>, <code class=" language-undefined">this</code> refers to the first argument passed to these methods. If the first argument is <code class=" language-undefined">null</code> or not an object, <code class=" language-undefined">this</code> refers to the global object. </li><li>When a function is called with the <code class=" language-undefined">new</code> operator, <code class=" language-undefined">this</code> refers to the newly created object. </li><li>When an arrow function (introduced in ECMAScript 6) is used, <code class=" language-undefined">this</code> relies on lexical scope and refers to the parent object.</li></ul><p> Knowing these straight and simple rules, we can easily predict what <code class=" language-undefined">this</code> will point to, and if it's not what we want, we know which methods we can use to fix it.</p><h2 id="summary">Summary</h2><p>JavaScript's <code class=" language-undefined">this</code> keyword is a tricky concept to master, but with enough practice, master it you can. I hope that this article and my previous article, serve as good basis for your understanding and prove to be a valuable reference the next time <code class=" language-undefined">this </code> is causing you headaches.</p>  </div>			</div>		<!--=========================			END : POST		=============================--> <!--=========================			START : POST		=============================-->		<div class="post-wrapper">		<h1>Revealing the Inner Workings of JavaScript's "this" Keyword</h1>		<div class="ArticleCopy language-">    <p>To know a programming language doesn't mean that you understand it or are using it properly. It's the same with JavaScript. Although it's an easy language to learn, there are many pitfalls for novices, and even for seasoned programmers. </p><p>One thing that confuses inexperienced developers is how the <code class=" language-undefined">this</code> keyword works. Put simply, <code class=" language-undefined">this</code> is a referencing alias&mdash;it's just knowing what exactly it references, that is the tricky part.</p><p>This article aims to dispel the confusion and offer an insight into the inner workings of the <code class=" language-undefined">this</code> keyword.</p><h2 id="so-what-is-this-anyway">So, What is <code class=" language-undefined">this</code> Anyway?</h2><p>In a nutshell, <code class=" language-undefined">this</code> is a special identifier keyword&mdash;automatically defined in the scope of every function&mdash;pointing to the "owner" of the function being executed. But, to fully grasp its tricky nature, we need to answer two key questions:</p><h3 id="how-is-this-created">How is <code class=" language-undefined">this</code> Created?</h3><p>Each time a JavaScript function is invoked, a new object is created containing information about which parameters were passed, how the function was invoked, where the function was called from, and so on. One of the main properties of that object is the <code class=" language-undefined">this</code> reference, which is automatically bound to the object of which the function is a method. </p><p><strong>Note:</strong> for the curious, this is detailed in <a href="http://www.ecma-international.org/ecma-262/5.1/#sec-10.4.3">§10.4.3 of the ECMAScript Language Specification</a> and the sections which that links to.</p><pre class =" language-javascript"><code class=" language-javascript"><span class="token keyword">var</span> car <span class="token operator">=</span> <span class="token punctuation">{</span>  brand <span class="token punctuation">:</span> <span class="token string">"Nissan"</span><span class="token punctuation">,</span>  getBrand<span class="token punctuation">:</span> <span class= "token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>brand <span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">;</span>car<span class="token punctuation">.</span><span class="token function">getBrand</span><span class="token punctuation">(</span><span class="token punctuation">) </span><span class="token punctuation">;</span><span spellcheck="true" class="token comment">// output: Nissan</span></code></pre><p>In this example <code class=" language-undefined">this </code>, used in <code class=" language-undefined">this.brand</code>, is a reference to the <code class=" language-undefined">car</code> object. So, <code class=" language-undefined"> this.brand</code> is the same as <code class=" language-undefined">car.brand</code>.  </p><h3 id="what-does-this-refer-to">What Does <code class=" language-undefined">this</code> Refer to? </h3><p>The value of <code class=" language-undefined">this</code>, passed to all functions, is based on the <strong>context</strong> in which the function is called at run-time. The scope of <code class=" language-undefined">this</code> isn't concerned with how and where functions are declared, but rather where they are called from (i.e. the context). </p><p>Every line of JavaScript code is run in an <a href="http://davidshariff.com/blog/what-is-the-execution-context-in-javascript/">execution context</a>. The object that <code class=" language-undefined">this</code> refers to is redefined every time a new execution context is entered and remains fixed until it's shifted to a different context. To find the execution context (and <code class=" language-undefined">this</code> binding) we need to find the call-site&mdash;the location in the code where a function is called from (not where it's declared). </p><p>Let's demonstrate this in the following example:</p><pre class=" language-javascript"><code class=" language-javascript"><span class="token keyword">var</span> brand <span class= "token operator">=</span> <span class="token string">'Nissan'</span><span class="token punctuation">;</span><span class="token keyword">var</span> myCar <span class="token operator">= </span> <span class="token punctuation">{</span>brand<span class="token punctuation">:</span> <span class="token string">'Honda'</span><span class="token punctuation">}</span><span class= "token punctuation">;</span><span class="token keyword">var</span> getBrand <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation" >(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>brand<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">;</span>myCar<span class="token punctuation">.</span>getBrand <span class="token operator">= </span> getBrand<span class="token punctuation">;</span>myCar<span class="token punctuation">.</span><span class="token function">getBrand</span><span class="token punctuation">( </span><span class="token punctuation">)</span><span class="token punctuation">;</span><span spellcheck="true" class="token comment">// output: Honda</span><span class="token function"> getBrand</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span spellcheck="true" class="token comment">// output: Nissan</span></code></pre><p>Even though both <code class=" language-undefined">myCar.getBrand()</code> and <code class=" language-undefined">getBrand()</code> point to one and the same function, the value of <code class=" language-undefined">this</code> is different because it's based on the context in which <code class=" language-undefined">getBrand()</code> is being called. </p><p>As we already know, within a function, <code class=" language-undefined">this</code> is bound to the object of which the function is a method. In the first function call, the object is <code class=" language-undefined">myCar</code>, while in the second, the object is <code class=" language-undefined">window</code> (<code class=" language-undefined">getBrand()</code> is the same as  <code class=" language-undefined">window.getBrand()</code>). So, a different context yields different a result.</p><h2 id= "invocation-contexts">Invocation Contexts</h2><p>Now, let's look at what <code class=" language-undefined">this</code> points to when it's put into different contexts.</p><h3 id= "global-scope">Global Scope</h3><p>All JavaScript runtimes have a unique object called the <em>global object</em>. In browsers, the global object is the <code class=" language-undefined"> window</code> object. In Node.js, it's called the <code class=" language-undefined">global</code> object.</p><p>In the global execution context (outside of any function), <code class=" language-undefined">this</code> refers to the global object, whether in strict mode or not.</p><h3 id="local-scope">Local Scope</h3><p>Inside of a function, the value of <code class=" language-undefined">this</code> depends on how the function is called. There are three main variations: </p><h4 id="this-used-in-a-simple-function-call"><code class=" language-undefined"> this</code> Used in a Simple Function Call</h4><p>The first variation is a standalone function invocation where we call a function directly.</p><pre class=" language-javascript"><code class=" language-javascript"><span class="token keyword">function</span> <span class="token function">simpleCall</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">( </span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token function">simpleCall</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span spellcheck="true" class="token comment">// output: the Window object</span></code></pre><p>In this case, the value of <code class=" language-undefined">this</code> is not set by the call. Since the code is not running in strict mode, the value of <code class=" language-undefined">this</code> must always be an object so it defaults to the global object.</p><p>In <a href=" https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Functions_and_function_scope/Strict_mode">strict mode</a>, the value of <code class=" language-undefined">this</code> remains at whatever it's set to when entering the execution context. If it's not defined, it remains undefined, as we can see in the following example:</p><pre class=" language-javascript" ><code class=" language-javascript"><span class="token keyword">function</span> <span class="token function">simpleCall</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>  <span class="token string">"use strict"</span><span class="token punctuation">;</span>  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token function">simpleCall</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span spellcheck="true" class="token comment">// output: undefined</span></code></pre><h4 id="this-used-in-an-objects-method" ><code class=" language-undefined">this</code> Used in an Object's Method</h4><p>We can store a function in a property of an object, which turns it into a method that we can invoke via that object. When a function is called as a method of an object, its <code class=" language-undefined">this</code> value is set to the object the method is called on.</p><pre class=" language-javascript"><code class=" language-javascript"><span class="token keyword">var</span> message <span class="token operator">=</span> <span class="token punctuation">{</span> content<span class="token punctuation">:</span> <span class="token string">"I'm a JavaScript Ninja!"</span><span class="token punctuation">,</span>  showContent<span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>content<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">} </span><span class="token punctuation">;</span>message<span class="token punctuation">.</span><span class="token function">showContent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span spellcheck="true" class="token comment">// output: I'm a JavaScript Ninja!</span></code></pre><p>Here, <code class=" language-undefined">showContent()</code> is a method of the <code class=" language-undefined">message</code> object, and thus <code class=" language-undefined">this.content </code> is equal to <code class=" language-undefined">message.content</code>.</p><h4 id="this-used-in-constructor-functions"><code class=" language-undefined">this</code> Used in Constructor Functions</h4><p>We can invoke a function via the <code class=" language-undefined">new</code> operator. In this case the function becomes a constructor&mdash;a factory for objects. Unlike the simple function calls and method calls discussed above, a constructor call passes a brand new object as the value of <code class=" language-undefined">this</code>, and implicitly returns the new object as its result. </p><p>When a function is used as a constructor (with the <code class=" language-undefined">new</code> keyword), its <code class=" language-undefined">this</code> value is bound to the newly constructed object. If we miss the <code class=" language-undefined">new</code> keyword, then it will be a regular function and <code class=" language-undefined">this</code> will point to the <code class=" language-undefined">window</code> object.</p><pre class=" language-javascript"><code class=" language-javascript"><span class="token keyword">function</span> <span class="token function">Message</span><span class="token punctuation">(</span>content<span class="token punctuation">) </span><span class="token punctuation">{</span>  <span class="token keyword">this</span><span class="token punctuation">.</span>content <span class="token operator">=</span> content<span class="token punctuation">;</span>  <span class="token keyword">this</span><span class="token punctuation">.</span>showContent <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    console<span class="token punctuation">. </span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>content<span class= "token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token punctuation">} </span><span class="token keyword">var</span> message <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Message</span><span class= "token punctuation">(</span><span class="token string">"I'm JavaScript Ninja!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>message<span class= "token punctuation">.</span><span class="token function">showContent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">; </span><span spellcheck="true" class="token comment">// output: I'm JavaScript Ninja!</span></code></pre><p>In the above example, we have a constructor function named <code class=" language-undefined">Message()</code>. By using the <code class=" language-undefined">new</code> operator we create a brand new object named <code class=" language-undefined">message</code> . We also pass the constructor function a string, which it sets as the <code class=" language-undefined">content</code> property of our new object. In last line of code we see that this string is successfully output, because <code class=" language-undefined">this</code> is pointing to the newly created object, and not to the constructor function itself. </p><h2 id= "how-this-can-be-successfully-manipulated">How <code class=" language-undefined">this</code> Can Be Successfully Manipulated</h2><p>In this section, we'll examine some built-in mechanisms for controlling the behavior  of <code class=" language-undefined">this</code>.</p><p>In JavaScript, all functions are objects, and therefore they can have methods. Two of these methods, which all functions have, are <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function/apply">apply()</a> and <a href=" https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function/call">call()</a>. We can use these methods to change the context to whatever we need and thus, explicitly set the value of <code class=" language-undefined">this</code>.</p><p>The <code class=" language-undefined">apply()</code> method takes two arguments: an object to set <code class=" language-undefined">this</code> to, and an (optional) array of arguments to pass to the function.</p><p>The <code class=" language-undefined">call()</code> method works exactly the same as <code class=" language-undefined">apply()</code>, but we pass the arguments individually rather than in an array.</p><p>Let's see it in action:</p><pre class=" language-javascript"><code class=" language-javascript"><span class="token keyword">function</span> <span class="token function">warrior</span><span class="token punctuation">(</span>speed <span class="token punctuation">,</span> strength<span class="token punctuation">)</span><span class="token punctuation">{</span>  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>    <span class="token string">"Warrior: "</span> <span class="token operator">+</span> <span class="token keyword" >this</span><span class="token punctuation">.</span>kind <span class="token operator">+</span>    <span class="token string">", weapon: "</span> <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>weapon <span class="token operator">+</span>    <span class="token string">", speed: "</span> <span class="token operator">+</span> speed <span class="token operator">+</span>    <span class="token string">", strength: "</span> <span class="token operator">+</span> strength  <span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">var</span> warrior1 <span class="token operator">=</span> <span class="token punctuation">{</span>  kind<span class="token punctuation">:</span> <span class="token string">"ninja"</span><span class="token punctuation">,</span>  weapon<span class= "token punctuation">:</span> <span class="token string">"shuriken"</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token keyword">var </span> warrior2 <span class="token operator">=</span> <span class="token punctuation">{</span>  kind<span class="token punctuation">:</span> <span class="token string">"samurai" </span><span class="token punctuation">,</span>  weapon<span class="token punctuation">:</span> <span class="token string">"katana"</span><span class="token punctuation">}</span><span class="token punctuation">;</span>warrior<span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>warrior1<span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class= "token punctuation">;</span><span spellcheck="true" class="token comment">// output: Warrior: ninja, weapon: shuriken, speed: 9, strength: 5</span>warrior<span class="token punctuation">. </span><span class="token function">apply</span><span class="token punctuation">(</span>warrior2<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class ="token number">6</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span spellcheck="true" class="token comment">// output: Warrior: samurai, weapon: katana, speed: 6, strength: 10</span></code></pre><p>Here, we have a factory function <code class=" language-undefined">warrior()</code>, which is used to create different types of warriors by using different warrior objects. So, in that factory function, <code class=" language-undefined">this</code> will point to the different objects we pass in using <code class=" language-undefined">call()</code> and/or <code class=" language-undefined"> apply()</code>. </p><p>In the first function call, we use the <code class=" language-undefined">call()</code> method to set <code class=" language-undefined">this</code> to the <code class =" language-undefined">warrior1</code> object, and pass the other arguments we need, separated by commas. In the second function call, we do almost the same, but this time we pass in the <code class=" language-undefined">warrior2</code> object and the necessary arguments are put in an array.</p><p>Besides <code class=" language-undefined">apply()</code> and <code class=" language-undefined">call()</code> ECMAScript 5 added the <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function/bind">bind()</a> method, which also allows us to set which specific object will be bound to <code class=" language-undefined">this</code> when a function or method is invoked. Let's consider the following example: </p><pre class=" language-javascript"><code class=" language-javascript"><span class="token keyword">function</span> <span class="token function">warrior</span><span class="token punctuation">(</span>kind<span class="token punctuation">)</span><span class="token punctuation">{</span>  console<span class="token punctuation">.</span><span class="token function">log </span><span class="token punctuation">(</span>    <span class="token string">"Warrior: "</span> <span class="token operator">+</span> kind <span class="token operator">+</span>    <span class="token string">". Favorite weapon: "</span> <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>weapon <span class= "token operator">+</span>    <span class="token string">". Main mission: "</span> <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>mission  <span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">var</span> attributes <span class="token operator">=</span> <span class="token punctuation">{</span>  weapon<span class="token punctuation">:</span> <span class="token string">"shuriken"</span><span class="token punctuation">,</span>  mission<span class="token punctuation">:</span> <span class="token string">"espionage"</span><span class="token punctuation">}</span><span class= "token punctuation">;</span><span class="token keyword">var</span> ninja <span class="token operator">=</span> warrior<span class="token punctuation">.</span><span class="token function"> bind</span><span class="token punctuation">(</span>attributes<span class="token punctuation">,</span> <span class="token string">"ninja"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">ninja</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation"> ;</span><span spellcheck="true" class="token comment">// output: Warrior: ninja. Favorite weapon: shuriken. Main mission: espionage</span></code></pre><p>In this example, the <code class= " language-undefined">bind()</code> method is used in similar way, but unlike the <code class=" language-undefined">call()</code> and <code class=" language-undefined">apply()</code> methods, <code class=" language-undefined">warrior.bind()</code> creates a new function (with the same body and scope as <code class=" language-undefined">warrior()</code>) rather than modifying the original <code class=" language-undefined">warrior()</code> function. The new function behaves just like the old one, but with its receiver bound to the <code class=" language-undefined">attributes</code> object, while the old one remains unchanged.</p><h2 id="summary">Summary</h2><p>So, that's it. This is almost everything you need to know about the <code class=" language-undefined">this</code> keyword in order to use it properly and with more confidence. Of course, there are some tricky parts and some common issues which you may face up along the way. These will be explored in an upcoming article, so stay tuned.</p>  </div>			</div>		<!--=========================			END : POST =============================-->		<!--=========================			START : POST		=============================-->		<div class="post-wrapper">		<h1> Demystifying JavaScript Closures, Callbacks and IIFEs</h1>		<div class="ArticleCopy language-">    <p>We've already taken a close look at <a href=" http://www.sitepoint.com/demystifying-javascript-variable-scope-hoisting/">variable scope and hoisting</a>, so today we'll finish our exploration by examining three of the most important and heavily-used concepts in modern JavaScript development &mdash; closures, callbacks and IIFEs.</p><h2 id="closures">Closures</h2><p>In JavaScript, a <a href=" http://en.wikipedia.org/wiki/Closure_(computer_programming)">closure</a> is any function that keeps reference to variables from its parent's scope <em>even after the parent has returned </em>. </p><p>This means practically any function can be considered a closure, because, as we learned in the <a href=" http://www.sitepoint.com/demystifying-javascript-variable-scope-hoisting/#variable-scope">variable scope</a> section from the first part of this tutorial, a function can refer to, or have access to &ndash; </p><ul><li>any variables and parameters in its own function scope </li><li>any variables and parameters of outer (parent) functions</li><li>any variables from the global scope.</li></ul><p>So, chances are you've already used closures without even knowing it. But our aim is not just to use them &ndash; it is to understand them. If we don't understand how they work, we can't use them <em>properly</em>. For that reason, we are going to split the above closure definition into three easy-to-comprehend points.</p><p><strong> Point 1:</strong> <em>You can refer to variables defined outside of the current function.</em></p><pre class=" language-javascript"><code class=" language-javascript"><span class="token keyword">function</span> <span class="token function">setLocation</span><span class="token punctuation">(</span>city<span class="token punctuation">)</span> <span class="token punctuation" >{</span>  <span class="token keyword">var</span> country <span class="token operator">=</span> <span class="token string">"France"</span><span class="token punctuation">;</span>   <span class="token keyword">function</span> <span class="token function">printLocation</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>           console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string"> "You are in "</span> <span class="token operator">+</span> city <span class="token operator">+</span> <span class="token string">", "</span> <span class="token operator">+</span> country <span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>  <span class="token function">printLocation</span><span class= "token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span>setLocation <span class="token punctuation">(</span><span class="token string">"Paris"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span spellcheck="true" class="token comment">// output: You are in Paris, France</span></code></pre><p><a href="http://jsbin.com/sakiqepato/1/edit?js,console,output">Try out the example in JS Bin</a></p><p>In this code example, the <code class=" language-undefined">printLocation()</code> function refers to the <code class=" language-undefined">country</code> variable and the <code class=" language-undefined">city</code> parameter of the enclosing (parent) <code class=" language-undefined">setLocation()</code> function. And the result is that, when <code class=" language-undefined">setLocation()</code> is called, <code class=" language-undefined">printLocation()</code> successfully uses the variables and parameters of the former to output "You are in Paris, France".</p><p><strong>Point 2:</strong> <em>Inner functions can refer to variables defined in outer functions even after the latter have returned.</em></p><pre class=" language-javascript"><code class=" language-javascript"><span class="token keyword">function</span> <span class="token function">setLocation</span><span class="token punctuation">(</span> city<span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token keyword">var</span> country <span class="token operator">=</span> <span class= "token string">"France"</span><span class="token punctuation">;</span>   <span class="token keyword">function</span> <span class="token function">printLocation</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>           console<span class="token punctuation">.</span><span class="token function" >log</span><span class="token punctuation">(</span><span class="token string">"You are in "</span> <span class="token operator">+</span> city <span class="token operator">+</span> <span class="token string">", "</span> <span class="token operator">+</span> country<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>  <span class="token keyword">return</span> printLocation<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword"> var</span> currentLocation <span class="token operator">=</span> setLocation <span class="token punctuation">(</span><span class="token string">"Paris"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token function">currentLocation</span><span class="token punctuation">(</span><span class="token punctuation">) </span><span class="token punctuation">;</span>   <span spellcheck="true" class="token comment">// output: You are in Paris, France</span></code></pre><p><a href=" http://jsbin.com/sakiqepato/2/edit?js,console,output">Try out the example in JS Bin</a></p><p>This is almost identical to the first example, except that this time <code class=" language-undefined">printLocation()</code> <em>is returned</em> inside the outer <code class=" language-undefined">setLocation()</code> function, instead of being immediately called. So, the value of <code class=" language-undefined">currentLocation</code> is the inner <code class=" language-undefined">printLocation()</code> function. </p><p>If we alert <code class=" language-undefined">currentLocation</code> like this &ndash; <code class=" language-undefined">alert(currentLocation);</code> &ndash; we'll get the following output:</p><pre class=" language-javascript"><code class=" language-javascript"><span class="token keyword">function</span> printLocation <span class="token punctuation">(</span><span class="token punctuation">) </span> <span class="token punctuation">{</span>         console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"You are in "</span> <span class="token operator">+</span> city <span class="token operator">+</span> <span class="token string">", "</span> <span class="token operator">+</span> country<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span></code></pre><p>As we can see, <code class=" language-undefined">printLocation()</code> is executed outside its lexical scope. It seems that <code class=" language-undefined">setLocation()</code> is gone, but <code class=" language-undefined">printLocation()</code> still has access to, and "remembers", its variable (<code class=" language-undefined">country</code>) and parameter (<code class=" language-undefined">city</code>).</p><p>A closure (inner function) is able to remember its surrounding scope (outer functions) even when it's executed outside its lexical scope. Therefore, you can call it at any time later in your program.</p><p><strong>Point 3:</strong> <em>Inner functions store their outer function's variables by reference, not by value. </em></p><pre class=" language-javascript"><code class=" language-javascript"><span class="token keyword">function</span> <span class="token function">cityLocation</span><span class= "token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token keyword">var</span> city <span class="token operator">= </span> <span class="token string">"Paris"</span><span class="token punctuation">;</span>  <span class="token keyword">return</span> <span class="token punctuation">{</span>    <span class ="token keyword">get</span><span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">) </span> <span class="token punctuation">{</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>city<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>      <span class="token keyword" >set</span><span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span>newCity<span class="token punctuation">)</span> <span class="token punctuation">{</span> city <span class="token operator">=</span> newCity<span class="token punctuation">;</span> <span class="token punctuation">}</span>  <span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">var</span> myLocation <span class="token operator">=</span> <span class="token function">cityLocation</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>myLocation<span class="token punctuation">.</span><span class="token keyword">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">; </span>           <span spellcheck="true" class="token comment">// output: Paris</span>myLocation<span class="token punctuation">.</span><span class="token keyword">set</span><span class= "token punctuation">(</span><span class="token string">'Sydney'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>myLocation<span class="token punctuation">.</span><span class="token keyword">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span spellcheck="true" class="token comment">// output: Sydney</span></code></pre><p><a href="http://jsbin.com/sakiqepato/3/edit?js,console,output">Try out the example in JS Bin</a></p><p>Here <code class=" language-undefined">cityLocation()</code> returns an object containing two closures &ndash; <code class=" language-undefined">get()</code> and <code class= " language-undefined">set()</code> &ndash; and they both refer to the outer variable <code class=" language-undefined">city</code>. <code class=" language-undefined">get()</code> obtains the current value of <code class=" language-undefined">city</code>, while <code class=" language-undefined">set()</code> updates it. When <code class=" language-undefined">myLocation.get() </code> is called for the second time, it outputs the updated (current) value of <code class=" language-undefined">city</code> &ndash; "Sydney" &ndash; rather than the default "Paris". </p><p>So, closures can both read and update their stored variables, and the updates are visible to any closures that have access to them. This means that closures store <em>references </em> to their outer variables, rather than copying their values. This is a very important point to remember, because not knowing it can lead to some hard-to-spot logic errors &ndash; as we'll see in the "Immediately-Invoked Function Expressions (IIFEs)" section.</p><p>One interesting feature of closures is that the variables in a closure are automatically hidden. Closures store data in their enclosed variables without providing direct access to them. The only way to alter those variables is by providing access to them indirectly. For example, in the last piece of code we saw that we can modify the variable <code class=" language-undefined">city</code> only obliquely by using the <code class=" language-undefined">get()</code> and <code class=" language-undefined">set()</code> closures.</p><p>We can take advantage of this behavior to store private data in an object. Instead of storing the data as an object's properties, we can store it as variables in the constructor, and then use closures as methods that refer to those variables. </p><p>As you can see, there is nothing mystical or esoteric around the closures &ndash; only three simple points to remember.</p><h2 id="callbacks">Callbacks</h2><p>In JavaScript, functions are first-class objects. One of the consequences of this fact is that functions can be passed as arguments to other functions and can also be returned by other <br>functions.</p><p>A function that takes other functions as arguments or returns functions as its result is called a <a href="http://en.wikipedia.org/wiki/Higher-order_function">higher-order function</a>, and the function that is passed as an argument is called a <a href="http://en.wikipedia.org/wiki/Callback_%28computer_programming%29">callback function</a>. It's named "callback" because at some point in time it is "called back" by the higher-order function.</p><p>Callbacks have many everyday usages. One of them is when we use the <code class=" language-undefined">setTimeout()</code> and <code class=" language-undefined"> setInterval()</code> methods of the browser's <code class=" language-undefined">window</code> object &ndash; methods that accept and execute callbacks:</p><pre class=" language-javascript" ><code class=" language-javascript"><span class="token keyword">function</span> <span class="token function">showMessage</span><span class="token punctuation">(</span>message<span class= "token punctuation">)</span><span class="token punctuation">{</span>  <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword"> function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token function">alert</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">3000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token function">showMessage</span><span class="token punctuation">(</span><span class="token string">'Function called 3 seconds ago'</span><span class="token punctuation">) </span><span class="token punctuation">;</span></code></pre><p><a href="http://jsbin.com/sakiqepato/4/edit?js,console,output">Try out the example in JS Bin</a></p><p>Another example is when we attach an event listener to an element on a page. By doing that we're actually providing a pointer to a callback function that will be called when the event occurs.</p><pre class= " language-javascript"><code class=" language-javascript"><span spellcheck="true" class="token comment">// HTML</span><span class="token operator">&amp;</span>lt<span class="token punctuation">;</span>button id<span class="token operator">=</span><span class="token string">'btn'</span><span class="token operator">&amp;</span>gt<span class="token punctuation">; </span>Click me<span class="token operator">&amp;</span>lt<span class="token punctuation">;</span><span class="token operator">/</span>button<span class="token operator">&amp;</span>gt <span class="token punctuation">;</span><span spellcheck="true" class="token comment">// JavaScript</span><span class="token keyword">function</span> <span class="token function"> showMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>  <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">'Woohoo!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation" >}</span><span class="token keyword">var</span> el <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById </span><span class="token punctuation">(</span><span class="token string">"btn"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>el<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">"click"</span><span class="token punctuation">, </span> showMessage<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p><a href="http://jsbin.com/sakiqepato/5/edit?html,js,console,output">Try out the example in JS Bin</a></p><p>The easiest way to understand how higher-order functions and callbacks work is to create your own. So, let's create one now:</p><pre class=" language-javascript"><code class=" language-javascript"><span class="token keyword">function</span> <span class="token function">fullName</span><span class="token punctuation">(</span> firstName<span class="token punctuation">,</span> lastName<span class="token punctuation">,</span> callback<span class="token punctuation">)</span><span class="token punctuation">{</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"My name is "</span> <span class= "token operator">+</span> firstName <span class="token operator">+</span> <span class="token string">" "</span> <span class="token operator">+</span> lastName<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token function">callback</span><span class="token punctuation">(</span>lastName<span class="token punctuation">) </span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">var</span> greeting <span class="token operator">=</span> <span class= "token keyword">function</span><span class="token punctuation">(</span>ln<span class="token punctuation">)</span><span class="token punctuation">{</span>  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Welcome Mr. '</span> <span class="token operator">+</span> ln<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token function">fullName</span><span class="token punctuation">(</span><span class="token string">"Jackie"</span><span class="token punctuation">,</span> <span class="token string">"Chan" </span><span class="token punctuation">,</span> greeting<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p><a href=" http://jsbin.com/sakiqepato/6/edit?js,console,output">Try out the example in JS Bin</a></p><p>Here we create a function <code class=" language-undefined">fullName()</code> that takes three arguments &ndash; two for the first and last name, and one for the callback function. Then, after the <code class=" language-undefined">console.log()</code> statement, we put a function call that will trigger the actual callback function &ndash; the <code class=" language-undefined">greeting()</code> function defined below the <code class=" language-undefined"> fullName()</code>. And finally, we call <code class=" language-undefined">fullName()</code>, where <code class=" language-undefined">greeting()</code> is passed as a variable &ndash; <em> without parentheses</em> &ndash; because we don't want it executed right away, but simply want to point to it for later use by <code class=" language-undefined">fullName()</code>. </p><p> We are passing the function definition, not the function call. This prevents the callback from being executed immediately, which is not the idea behind the callbacks. Passed as function definitions, they can be executed at any time and at any point in the containing function. Also, because callbacks behave as if they are actually placed inside that function, they are in practice closures: they can access the containing function's variables and parameters, and even the variables from the global scope.</p><p>The callback can be an existing function as shown in the preceding example, or it can be an anonymous function, which we create when we call the higher-order function, as shown in the following example:</p><pre class=" language-javascript"><code class=" language-javascript"><span class="token keyword">function</span> <span class="token function">fullName</span><span class="token punctuation">(</span> firstName<span class="token punctuation">,</span> lastName<span class="token punctuation">,</span> callback<span class="token punctuation">)</span><span class="token punctuation">{</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"My name is "</span> <span class= "token operator">+</span> firstName <span class="token operator">+</span> <span class="token string">" "</span> <span class="token operator">+</span> lastName<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token function">callback</span><span class="token punctuation">(</span>lastName<span class="token punctuation">) </span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token function">fullName</span><span class="token punctuation">(</span><span class= "token string">"Jackie"</span><span class="token punctuation">,</span> <span class="token string">"Chan"</span><span class="token punctuation">,</span> <span class="token keyword">function </span><span class="token punctuation">(</span>ln<span class="token punctuation">)</span><span class="token punctuation">{</span>console<span class="token punctuation">.</span><span class= "token function">log</span><span class="token punctuation">(</span><span class="token string">'Welcome Mr. '</span> <span class="token operator">+</span> ln<span class="token punctuation"> )</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p><a href="http://jsbin.com/sakiqepato/7/edit?js,console,output">Try out the example in JS Bin</a></p><p>Callbacks are heavily used in JavaScript libraries to provide generalization and reusability. They allow the library methods to be easily customized and/or extended. Also, the code is easier to maintain, and much more concise and readable. Every time you need to transform your unnecessary repeated code pattern into more abstract/generic function, callbacks come to the rescue. </p><p>Let's say we need two functions &ndash; one that prints information about published articles and another that prints information about sent messages. We create them, but we notice that some part of our logic is repeated in both of the functions. We know that having one and the same piece of code in different places is unnecessary and hard to maintain. So, what is the solution? Let's illustrate it in the next example: </p><pre class=" language-javascript"><code class=" language-javascript"><span class="token keyword">function</span> <span class="token function">publish</span><span class="token punctuation">(</span>item<span class="token punctuation">,</span> author<span class="token punctuation">,</span> callback<span class="token punctuation">)</span><span class="token punctuation">{</span>   <span spellcheck="true" class="token comment">// Generic function with common data</span>  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">var</span> date <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token function">callback</span><span class="token punctuation">(</span>author<span class="token punctuation">, </span> date<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">function</span> <span class= "token function">messages</span><span class="token punctuation">(</span>author<span class="token punctuation">,</span> time<span class="token punctuation">)</span><span class="token punctuation">{</span>   <span spellcheck="true" class="token comment">// Callback function with specific data</span>  <span class="token keyword">var</span> sendTime <span class="token operator">=</span> time<span class="token punctuation">.</span><span class="token function">toLocaleTimeString</span><span class="token punctuation">(</span><span class="token punctuation" >)</span><span class="token punctuation">;</span>  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class ="token string">"Sent from "</span> <span class="token operator">+</span> author <span class="token operator">+</span> <span class="token string">" at "</span> <span class="token operator" >+</span> sendTime<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">function</span> <span class="token function">articles</span><span class="token punctuation">(</span>author<span class="token punctuation">,</span> date<span class="token punctuation">)</span><span class="token punctuation">{</span>   <span spellcheck="true" class="token comment">// Callback function with specific data</span>  <span class="token keyword">var</span> pubDate <span class="token operator">=</span> date<span class="token punctuation">.</span><span class="token function">toDateString</span><span class="token punctuation">(</span><span class="token punctuation">) </span><span class="token punctuation">;</span>  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class= "token string">"Written by "</span> <span class="token operator">+</span> author<span class="token punctuation">)</span><span class="token punctuation">;</span>  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"Published "</span> <span class="token operator">+</span> pubDate<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token function">publish</span><span class= "token punctuation">(</span><span class="token string">"How are you?"</span><span class="token punctuation">,</span> <span class="token string">"Monique"</span><span class="token punctuation">,</span> messages<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">publish</span><span class="token punctuation">( </span><span class="token string">"10 Tips for JavaScript Developers"</span><span class="token punctuation">,</span> <span class="token string">"Jane Doe"</span><span class="token punctuation">,</span> articles<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p><a href="http://jsbin.com/sakiqepato/8/edit?js,console,output" >Try out the example in JS Bin</a></p><p>What we've done here is to put the repeated code pattern (<code class=" language-undefined">console.log(item)</code> and <code class=" language-undefined">var date = new Date()</code>) into a separate, generic function (<code class=" language-undefined">publish()</code>), and leave only the specific data inside other functions &ndash; which are now callbacks. That way, with one and the same function we can print information for all sorts of related things &ndash; messages, articles, books, magazines and so on. The only thing you need to do is to create a specialized callback function for each type, and pass it as an argument to the <code class=" language-undefined">publish()</code> function.</p><h2 id="immediately-invoked-function-expressions-iifes">Immediately-Invoked Function Expressions (IIFEs)</h2><p>An <a href=" http://en.wikipedia.org/wiki/Immediately-invoked_function_expression">Immediately-invoked function expression</a>, or IIFE (pronounced "iffy"), is a function expression (named or anonymous) that is executed right away after its creation. </p><p>There are two slightly different syntax variations of this pattern:</p><pre class=" language-javascript"><code class=" language-javascript"><span spellcheck="true" class="token comment">// variant 1</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class= "token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token function">alert</span><span class="token punctuation">( </span><span class="token string">'Woohoo!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class= "token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span spellcheck="true" class="token comment">// variant 2</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">) </span> <span class="token punctuation">{</span>  <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">'Woohoo!'</span><span class= "token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">(</span><span class="token punctuation">) </span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>To turn a regular function into an IIFE you need to perform two steps:</p><ol><li> You need to wrap the whole function in parentheses. As the name suggests, an IIFE must be a function expression, not a function definition. So, the purpose of the enclosing parentheses is to transform a function definition into an expression. This is because, in JavaScript, everything in parentheses is treated as an expression.</li><li>You need to add a pair of parentheses at the very end (variant 1), or right after the closing curly brace (variant 2), which causes the function to be executed immediately.</li></ol><p>There are also three more things to bear in mind:</p><p>First, if you assign the function to a variable, you don't need to enclose the whole function in parentheses, because it is already an expression:</p><pre class=" language-javascript"><code class=" language-javascript"><span class="token keyword">var</span> sayWoohoo <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">'Woohoo!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">} </span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>Second, a semicolon is required at the end of an IIFE, as otherwise your code may not work properly.</p><p>And third, you can pass arguments to an IIFE (it's a function, after all), as the following example demonstrates:</p><pre class=" language-javascript"><code class=" language-javascript"><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span> name<span class="token punctuation">,</span> profession<span class="token punctuation">)</span> <span class="token punctuation">{</span>  console<span class="token punctuation">. </span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"My name is "</span> <span class="token operator">+</span> name <span class ="token operator">+</span> <span class="token string">". I'm an "</span> <span class="token operator">+</span> profession <span class="token operator">+</span> <span class="token string"> "."</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class= "token punctuation">(</span><span class="token string">"Jackie Chan"</span><span class="token punctuation">,</span> <span class="token string">"actor"</span><span class="token punctuation" >)</span><span class="token punctuation">;</span>   <span spellcheck="true" class="token comment">// output: My name is Jackie Chan. I'm an actor.</span></code></pre><p><a href=" http://jsbin.com/sakiqepato/9/edit?js,console,output">Try out the example in JS Bin</a></p><p>It's a common pattern to pass the global object as an argument to the IIFE so that it's accessible inside of the function without having to use the <code class=" language-undefined">window</code> object, which makes the code independent of the browser environment. The following code creates a variable <code class=" language-undefined">global</code> that will refer to the global object no matter what platform you are working on:</p><pre class=" language-javascript"><code class=" language-javascript"><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span>global <span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span spellcheck="true" class="token comment">// access the global object via 'global'</span><span class= "token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">) </span><span class="token punctuation">;</span><span class="token operator">&lt;</span><span class="token operator">/</span>code<span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>pre<span class="token operator">&gt;</span><span class="token operator">&lt;</span>p<span class="token operator">&gt;</span>This code will work both <span class="token keyword">in</span> the browser <span class="token punctuation">(</span>where the global object is <span class="token operator">&lt;</span>code<span class="token operator">&gt;</span>window<span class="token operator">&lt;</span><span class="token operator">/</span>code<span class="token operator">&gt;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> or <span class="token keyword">in</span> a Node<span class="token punctuation">.</span>js environment <span class="token punctuation">(</span>where we refer to the global object <span class="token keyword">with</span> the special variable <span class="token operator">&lt;</span>code<span class="token operator">&gt;</span>global<span class="token operator">&lt;</span><span class="token operator">/</span>code<span class="token operator">&gt;</span><span class="token punctuation">) </span><span class="token punctuation">.</span> <span class="token operator">&lt;</span><span class="token operator">/</span>p<span class="token operator">&gt;</span><span class="token operator">&lt;</span>p<span class="token operator">&gt;</span>One <span class="token keyword">of</span> the great benefits <span class="token keyword">of</span> an IIFE is that<span class= "token punctuation">,</span> when using it<span class="token punctuation">,</span> you don't have to worry about polluting the global space <span class="token keyword">with</span> temporary variables<span class="token punctuation">.</span> All the variables you define inside an IIFE will be local<span class="token punctuation">.</span> Let's check <span class= "token keyword">this</span> out<span class="token punctuation">:</span><span class="token operator">&lt;</span><span class="token operator">/</span>p<span class="token operator">&gt; </span><span class="token punctuation">[</span>code language<span class="token operator">=</span><span class="token string">"javascript"</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>  <span class="token keyword">var</span> today <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Date </span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">var</span> currentTime <span class="token operator">=</span> today<span class="token punctuation">.</span><span class="token function">toLocaleTimeString</span><span class="token punctuation">(</span><span class= "token punctuation">)</span><span class="token punctuation">;</span>  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation"> (</span>currentTime<span class="token punctuation">)</span><span class="token punctuation">;</span>   <span spellcheck="true" class="token comment">// output: the current local time (e.g. 7:08:52 PM)</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>currentTime<span class= "token punctuation">)</span><span class="token punctuation">;</span>   <span spellcheck="true" class="token comment">// output: undefined</span></code></pre><p><a href=" http://jsbin.com/sakiqepato/10/edit?js,console,output">Try out the example in JS Bin</a></p><p>In this example, the first <code class=" language-undefined">console.log()</code> statement works fine, but the second fails, because the variables <code class=" language-undefined">today</code> and <code class=" language-undefined">currentTime</code> are made local thanks to the IIFE.</p><p>We know already that closures keep references to outer variables, and thus, they return the most recent/updated values. So, what do you think is going to be the output of the following example?</p><pre class=" language-javascript"><code class=" language-javascript"><span class="token keyword">function</span> <span class="token function">printFruits </span><span class="token punctuation">(</span>fruits<span class="token punctuation">)</span><span class="token punctuation">{</span>  <span class="token keyword">for</span> <span class= "token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&amp;</span>lt<span class="token punctuation">;</span> fruits<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token function">setTimeout</span><span class="token punctuation">(</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span> fruits<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">,</span> i <span class="token operator">*</span> <span class="token number">1000</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token function">printFruits</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">"Lemon"</span><span class="token punctuation">,</span> <span class="token string">"Orange"</span><span class="token punctuation">,</span> <span class="token string">"Mango"</span><span class="token punctuation">,</span> <span class="token string">"Banana"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p><a href="http://jsbin.com/sakiqepato/11/edit?js,console,output">Try out the example in JS Bin</a></p><p>You may have expected that the names of the fruits would be printed one after another at one-second intervals. But, in practice, the output is four times "undefined". So, where is the catch? </p><p>The catch is that the value of <code class=" language-undefined">i</code>, inside the <code class=" language-undefined">console.log()</code> statement, is equal to 4 for each iteration of the loop. And, since we have nothing at index 4 in our fruits array, the output is "undefined". (Remember that, in JavaScript, an array's index starts at 0.) The loop terminates when <code class=" language-undefined">i &lt; fruits.length</code> returns <code class=" language-undefined">false</code>. So, at the end of the loop the value of <code class=" language-undefined">i</code> is 4. That most recent version of the variable is used in all the functions produced by the loop. All this happens because closures are linked to the variables themselves, not to their values.</p><p>To fix the problem, we need to provide a new scope &ndash; for each function created by the loop &ndash; that will capture the current state of the <code class=" language-undefined">i</code> variable. We do that by closing the <code class=" language-undefined">setTimeout()</code> method in an IIFE, and defining a private variable to hold the current copy of <code class=" language-undefined">i</code>.</p><pre class=" language-javascript"><code class=" language-javascript"><span class="token keyword"> function</span> <span class="token function">printFruits</span><span class="token punctuation">(</span>fruits<span class="token punctuation">)</span><span class="token punctuation">{ </span>  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&amp;</span>lt<span class="token punctuation">;</span> fruits<span class="token punctuation">. </span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation" >{</span>      <span class="token keyword">var</span> current <span class="token operator">=</span> i<span class="token punctuation">;</span>                    <span spellcheck="true" class="token comment">// define new variable that will hold the current value of "i"</span>      <span class="token function">setTimeout</span><span class="token punctuation">(</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span> fruits<span class="token punctuation">[</span>current<span class="token punctuation">]</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>   <span spellcheck="true" class="token comment">// this time the value of "current" will be different for each iteration</span>      <span class="token punctuation">}</span><span class="token punctuation">,</span> current <span class="token operator">*</span> <span class= "token number">1000</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">) </span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token function">printFruits</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">"Lemon" </span><span class="token punctuation">,</span> <span class="token string">"Orange"</span><span class="token punctuation">,</span> <span class="token string">"Mango"</span><span class= "token punctuation">,</span> <span class="token string">"Banana"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">; </span></code></pre><p><a href="http://jsbin.com/sakiqepato/12/edit?js,console,output">Try out the example in JS Bin</a></p><p>We can also use the following variant, which does the same job:</p><pre class=" language-javascript"><code class=" language-javascript"><span class="token keyword">function</span> <span class="token function">printFruits</span><span class="token punctuation">(</span>fruits<span class="token punctuation">)</span><span class="token punctuation">{</span>  <span class="token keyword">for</span> <span class="token punctuation">( </span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&amp;</span>lt<span class="token punctuation">;</span> fruits<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator"> ++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token punctuation">(</span><span class="token keyword">function</span><span class ="token punctuation">(</span>current<span class="token punctuation">)</span><span class="token punctuation">{</span>      <span class="token function">setTimeout</span><span class="token punctuation">(</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span> fruits<span class="token punctuation">[</span>current <span class="token punctuation">]</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token punctuation">}</span><span class="token punctuation">,</span> current <span class="token operator">*</span> <span class="token number">1000</span> <span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span> i <span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token function">printFruits</span><span class="token punctuation">( </span><span class="token punctuation">[</span><span class="token string">"Lemon"</span><span class="token punctuation">,</span> <span class="token string">"Orange"</span><span class= "token punctuation">,</span> <span class="token string">"Mango"</span><span class="token punctuation">,</span> <span class="token string">"Banana"</span><span class="token punctuation">] </span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p><a href="http://jsbin.com/sakiqepato/13/edit?js,console,output">Try out the example in JS Bin</a></p><p>An IIFE is often used to create scope to encapsulate modules. Within the module there is a private scope that is self-contained and safe from unwanted or accidental modification. This technique, called the <a href="http://addyosmani.com/resources/essentialjsdesignpatterns/book/#modulepatternjavascript">module pattern</a>, is a powerful example of using closures to manage scope, and it's heavily used in many of the modern JavaScript libraries (jQuery and Underscore, for example).</p><h2 id="conclusion">Conclusion</h2><p>The aim of this tutorial has been to present these fundamental concepts as clearly and concisely as possible &ndash; as a set of simple principles or rules. Understanding them well is key to being a successful and productive JavaScript developer.</p><p>For a more detailed and in-depth explanation of the topics presented here, I recommend you take a look at Kyle Simpson's <a href=" https://github.com/getify/You-Dont-Know-JS/blob/master/scope%20&amp;%20closures/README.md">You Don't Know JS: Scope &amp; Closures</a>.</p>  </div>			</div> <!--=========================			END : POST		=============================-->		<!--=========================			START : POST =============================-->		<div class="post-wrapper">		<div class="container">      <div class="page-header">        <h1>Named function expressions demystified <span class="small"><em>by <a href="http://perfectionkills.com/">Juriy "kangax" Zaytsev</a></em></span>        </h1>      </div>      <ol>        <li><a href="#introduction">Introduction </a></li>        <li><a href="#expr-vs-decl">Function expressions vs. Function declarations</a></li>        <li><a href="#function-statements">Function Statements</a></li>        <li><a href="#named-expr">Named function expressions</a></li>        <li><a href="#names-in-debuggers">Function names in debuggers</a></li>        <li><a href="#jscript-bugs">JScript bugs </a></li>        <li><a href="#jscript-memory-management">JScript memory management</a></li>        <li><a href="#tests">Tests</a></li>        <li><a href="#safari-bug">Safari bug</a></li> <li><a href="#spidermonkey-peculiarity">SpiderMonkey peculiarity</a></li>        <li><a href="#solution">Solution</a></li>        <li><a href="#alt-solution">Alternative solution </a></li>        <li><a href="#webkit-displayName">WebKit's displayName</a></li>        <li><a href="#future-considerations">Future considerations</a></li>        <li><a href="#credits"> Credits</a></li>      </ol>      <h2 id="introduction">Introduction</h2>      <p>Surprisingly, a topic of named function expressions doesn't seem to be covered well enough on the web. This is probably why there are so many misconceptions floating around. In this article, I'll try to summarize both &mdash; theoretical and practical aspects of these wonderful Javascript constructs; the good, bad and ugly parts of them.</p>      <p>In a nutshell, named function expressions are useful for one thing only &mdash; <strong>descriptive function names in debuggers and profilers</strong>. Well, there is also a possibility of using function names for recursion, but you will soon see that this is often impractical nowadays. If you don't care about debugging experience, you have nothing to worry about. Otherwise, read on to see some of the cross-browser glitches you would have to deal with and tips on how work around them.</p> <p>I'll start with a general explanation of what function expressions are how modern debuggers handle them. Feel free to skip to a <a href="#solution">final solution</a>, which explains how to use these constructs safely.</p>      <h2 id="expr-vs-decl">Function expressions vs. Function declarations</h2>      <p>One of the two most common ways to create a function object in ECMAScript is by means of either <em>Function Expression</em> or <em>Function Declaration</em>. The difference between two is <strong>rather confusing</strong>. At least it was to me. The only thing ECMA specs make clear is that <em>Function Declaration</em> must always have an <em>Identifier</em> (or a function name, if you prefer), and <em> Function Expression</em> may omit it:</p>      <blockquote>        <p>FunctionDeclaration :<br>        function Identifier ( FormalParameterList <sub>opt</sub> ){ FunctionBody }</p> <p>FunctionExpression :<br>        function Identifier <sub>opt</sub> ( FormalParameterList <sub>opt</sub> ){ FunctionBody }</p>      </blockquote>      <p>We can see that when identifier is omitted, that "something" can only be an expression. But what if identifier is present? How can one tell whether it is a function declaration or a function expression &mdash; they look identical after all? It appears that ECMAScript differentiates between two based on a context. If a <code>function foo(){}</code> is part of, say, assignment expression, it is considered a function expression. If, on the other hand, <code>function foo(){}</code> is contained in a function body or in a (top level of) program itself &mdash; it is parsed as a function declaration.</p><div class="highlight"><pre><code data-lang="js" class="language-js"><span class="kd">function</span> <span class="nx">foo</span><span class="p">(){}</span> <span class="c1">// declaration, since it's part of a &lt;em&gt;Program&lt;/em&gt;</span><span class="kd">var</span> <span class="nx">bar</span> <span class="o">=</span> <span class="kd"> function</span> <span class="nx">foo</span><span class="p">(){};</span> <span class="c1">// expression, since it's part of an &lt;em&gt;AssignmentExpression&lt;/em&gt;</span><span class= "k">new</span> <span class="kd">function</span> <span class="nx">bar</span><span class="p">(){};</span> <span class="c1">// expression, since it's part of a &lt;em&gt;NewExpression&lt;/em &gt;</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span>  <span class="kd">function</span> <span class="nx">bar</span><span class="p">(){}</span> <span class="c1">// declaration, since it's part of a &lt;em&gt;FunctionBody&lt;/em&gt;</span><span class="p">})();</span></code></pre></div><p>A somewhat less obvious example of function expression is the one where function is wrapped with parenthesis &mdash; <code>(function foo(){})</code>. The reason it is an expression is again due to a context: "(" and ")" constitute a grouping operator and grouping operator can only contain an expression:</p><p>To demonstrate with examples:</p><div class="highlight"><pre><code data-lang="js" class="language-js"><span class="kd">function</span> <span class="nx">foo</span><span class="p">(){}</span> <span class="c1">// function declaration</span><span class="p">(</span><span class="kd">function</span> <span class="nx">foo</span><span class="p">(){});</span> <span class="c1">// function expression: due to grouping operator</span><span class="k">try</span> <span class="p">{</span>  <span class="p">(</span><span class="kd">var</span> <span class="nx">x</span> <span class="o">=</span> <span class="mi">5</span><span class="p">);</span> <span class="c1">// grouping operator can only contain expression, not a statement (which `var` is)</span><span class="p">}</span> <span class="k">catch</span><span class="p">(</span><span class="nx">err</span><span class="p"> )</span> <span class="p">{</span>  <span class="c1">// SyntaxError</span><span class="p">}</span></code></pre></div><p>You might also recall that when evaluating JSON with <code>eval </code>, the string is usually wrapped with parenthesis &mdash; <code>eval('(' + json + ')')</code>. This is of course done for the same reason &mdash; grouping operator, which parenthesis are, forces JSON brackets to be parsed as expression rather than as a block:</p><div class="highlight"><pre><code data-lang="js" class="language-js"><span class="k">try</span> <span class="p">{</span>  <span class="p">{</span> <span class="s2">"x"</span><span class="o">:</span> <span class="mi">5</span> <span class="p">};</span> <span class="c1">// "{" and "}" are parsed as a block</span><span class="p">}</span> <span class="k">catch</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>  <span class="c1">// SyntaxError</span><span class="p">}</span><span class="p">({</span> <span class="s2">"x"</span><span class="o">:</span> <span class="mi">5</span> <span class="p">});</span> <span class="c1">// grouping operator forces "{" and "}" to be parsed as object literal</span></code></pre></div>      <p>There's a subtle difference in behavior of declarations and expressions.</p>      <p>First of all, function declarations are parsed and evaluated before any other expressions are. Even if declaration is positioned last in a source, it will be evaluated <strong>foremost any other expressions</strong> contained in a scope. The following example demonstrates how <code>fn</code> function is already defined by the time <code>alert </code> is executed, even though it's being declared right after it:</p><div class="highlight"><pre><code data-lang="js" class="language-js"><span class="nx">alert</span><span class="p">( </span><span class="nx">fn</span><span class="p">());</span><span class="kd">function</span> <span class="nx">fn</span><span class="p">()</span> <span class="p">{</span>  <span class="k"> return</span> <span class="s1">'Hello world!'</span><span class="p">;</span><span class="p">}</span></code></pre></div>      <p>Another important trait of function declarations is that declaring them conditionally is non-standardized and varies across different environments. You should never rely on functions being declared conditionally and use function expressions instead.</p><div class="highlight"><pre><code data-lang="js" class="language-js"><span class="c1">// Never do this!</span><span class="c1">// Some browsers will declare `foo` as the one returning 'first',</span><span class="c1">// while others &mdash; returning 'second'</span><span class="k">if</span> <span class="p">(</span><span class="kc">true</span><span class="p">) </span> <span class="p">{</span>  <span class="kd">function</span> <span class="nx">foo</span><span class="p">()</span> <span class="p">{</span>    <span class="k">return</span> <span class="s1">'first'</span><span class="p">;</span>  <span class="p">}</span><span class="p">}</span><span class="k">else</span> <span class="p">{</span>  <span class="kd">function</span> <span class="nx">foo</span><span class="p">()</span> <span class="p">{</span>    <span class="k">return</span> <span class="s1">'second'</span><span class="p">;</span>  <span class="p">} </span><span class="p">}</span><span class="nx">foo</span><span class="p">();</span><span class="c1">// Instead, use function expressions:</span><span class="kd">var</span> <span class= "nx">foo</span><span class="p">;</span><span class="k">if</span> <span class="p">(</span><span class="kc">true</span><span class="p">)</span> <span class="p">{</span>  <span class="nx">foo </span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>    <span class="k">return</span> <span class="s1">'first'</span><span class="p">;</span>  <span class="p">};</span><span class="p">}</span><span class="k">else</span> <span class="p">{</span>  <span class="nx">foo</span> <span class="o">=</span> <span class= "kd">function</span><span class="p">()</span> <span class="p">{</span>    <span class="k">return</span> <span class="s1">'second'</span><span class="p">;</span>  <span class="p">}; </span><span class="p">}</span><span class="nx">foo</span><span class="p">();</span></code></pre></div>      <p>If you're curious about actual production rules of function declarations, read on. Otherwise, feel free to skip the following excerpt.</p>      <div class="well bg-success" id="function-declarations-in-blocks">        <p>          <em>FunctionDeclaration</em>s are only allowed to appear in <em>Program</em> or <em>FunctionBody</em>.          Syntactically, they <strong>can not appear in <em>Block</em></strong> (<code>{ ... }</code>) &mdash; such as that of <code>if</code>,          <code>while</code> or <code>for</code> statements. This is because <em>Block</em>s can only contain <em>Statement</em>s,          not <em>SourceElement </em>s, which <em>FunctionDeclaration</em> is.          If we look at production rules carefully, we can see that the only way <em>Expression</em> is allowed directly within <em>Block</em> is when it is part of <em>ExpressionStatement</em>. However, <em>ExpressionStatement</em> is explicitly defined          <strong>to not begin with "function" keyword</strong>, and this is exactly why <em>FunctionDeclaration</em> cannot appear directly within a <em>Statement</em> or <em>Block</em> (note that <em>Block</em> is merely a list of <em>Statement</em> s).        </p>        <p>          Because of these restrictions, whenever function appears directly in a block (such as in the previous example) it should actually be          <strong> considered a syntax error</strong>, not function declaration or expression. The problem is that almost none of the          implementations I've seen parse these functions strictly per rules (exceptions are <a href="http://sourceforge.net/projects/besen/">BESEN</a> and <a href="http://www.digitalmars.com/dscript/">DMDScript</a>). They interpret them in proprietary ways instead.        </p>      </div>      <p>It's worth mentioning that as per specification, implementations are allowed to introduce <strong>syntax extensions</strong> (see section 16), yet still be fully conforming. This is exactly what happens in so many clients these days. Some of them interpret function declarations in blocks as any other function declarations &mdash; simply hoisting them to the top of the enclosing scope; Others &mdash; introduce different semantics and follow slightly more complex rules.</p>      <h2 id="function-statements">Function statements</h2>      <div>        <p>          One of such syntax extensions to ECMAScript is <strong>Function Statements</strong>,          currently implemented in Gecko-based browsers (tested in Firefox 1-3.7a1pre on Mac OS X).          Somehow, this extension doesn't seem to be widely known, either for good or bad (<a href=" https://developer.mozilla.org/En/Core_JavaScript_1.5_Reference:Functions#Conditionally_defining_a_function">MDC mentions them</a>, but very briefly).          Please remember, that we are discussing it here only for learning purposes and to satisfy our curiosity;          unless you're writing scripts for specific Gecko-based environment,          <strong>I do not recommend relying on this extension</strong>.        </p>        <p>          So, here are some of the traits of these non-standard constructs:        </p>        <ol>          <li> Function statements are allowed to be anywhere where plain <em>Statement</em>s are allowed. This, of course, includes <em>Block</em>s:<div class="highlight"><pre><code data-lang="js" class ="language-js"><span class="k">if</span> <span class="p">(</span><span class="kc">true</span><span class="p">)</span> <span class="p">{</span>  <span class="kd">function</span> <span class ="nx">f</span><span class="p">(){</span> <span class="p">}</span><span class="p">}</span><span class="k">else</span> <span class="p">{</span>  <span class="kd">function</span> <span class= "nx">f</span><span class="p">(){</span> <span class="p">}</span><span class="p">}</span></code></pre></div>        </li>          <li>Function statements are interpreted as any other statements, including conditional execution:<div class="highlight"><pre><code data-lang="js" class="language-js"><span class="k">if</span> <span class="p">(</span><span class="kc">true </span><span class="p">)</span> <span class="p">{</span>  <span class="kd">function</span> <span class="nx">foo</span><span class="p">(){</span> <span class="k">return</span> <span class= "mi">1</span><span class="p">;</span> <span class="p">}</span><span class="p">}</span><span class="k">else</span> <span class="p">{</span>  <span class="kd">function</span> <span class= "nx">foo</span><span class="p">(){</span> <span class="k">return</span> <span class="mi">2</span><span class="p">;</span> <span class="p">}</span><span class="p">}</span><span class="nx"> foo</span><span class="p">();</span> <span class="c1">// 1</span><span class="c1">// Note that other clients interpet `foo` as function declaration here,</span><span class="c1">// overwriting first `foo` with the second one, and producing "2", not "1" as a result</span></code></pre></div>        </li>        <li>          Function statements are NOT declared during variable instantiation. They are declared at run time, just like function expressions.          However, once declared, function statement's identifier <strong>becomes available to the entire scope</strong> of the function.          This identifier availability is what makes function statements different from function expressions (you will see exact behavior of named function expressions in next chapter).<div class="highlight"><pre><code data-lang="js" class="language-js"><span class="c1">// at this point, `foo` is not yet declared</span><span class= "k">typeof</span> <span class="nx">foo</span><span class="p">;</span> <span class="c1">// "undefined"</span><span class="k">if</span> <span class="p">(</span><span class="kc">true </span><span class="p">)</span> <span class="p">{</span>  <span class="c1">// once block is entered, `foo` becomes declared and available to the entire scope</span>  <span class="kd"> function</span> <span class="nx">foo</span><span class="p">(){</span> <span class="k">return</span> <span class="mi">1</span><span class="p">;</span> <span class="p">}</span><span class= "p">}</span><span class="k">else</span> <span class="p">{</span>  <span class="c1">// this block is never entered, and `foo` is never redeclared</span>  <span class="kd">function</span> <span class="nx">foo</span><span class="p">(){</span> <span class="k">return</span> <span class="mi">2</span><span class="p">;</span> <span class="p">}</span><span class="p">}</span><span class="k">typeof</span> <span class="nx">foo</span><span class="p">;</span> <span class="c1">// "function"</span></code></pre></div>  Generally, we can emulate function statements behavior from the previous example with this standards-compliant (and unfortunately, more verbose) code:<div class="highlight"><pre><code data-lang="js" class="language-js"><span class= "kd">var</span> <span class="nx">foo</span><span class="p">;</span><span class="k">if</span> <span class="p">(</span><span class="kc">true</span><span class="p">)</span> <span class="p">{ </span>  <span class="nx">foo</span> <span class="o">=</span> <span class="kd">function</span> <span class="nx">foo</span><span class="p">(){</span> <span class="k">return</span> <span class="mi">1</span><span class="p">;</span> <span class="p">};</span><span class="p">}</span><span class="k">else</span> <span class="p">{</span>  <span class="nx">foo</span> <span class= "o">=</span> <span class="kd">function</span> <span class="nx">foo</span><span class="p">()</span> <span class="p">{</span> <span class="k">return</span> <span class="mi">2</span><span class="p">;</span> <span class="p">};</span><span class="p">}</span></code></pre></div>        </li>        <li>          String representation of functions statements is similar to that of function declarations or named function expressions (and includes identifier &mdash; "foo" in this example):<div class="highlight"><pre><code data-lang="js" class="language-js"><span class="k">if</span> <span class="p">(</span><span class="kc">true</span><span class="p">)</span> <span class="p">{</span>  <span class="kd">function</span> <span class="nx">foo</span><span class="p">(){</span> <span class="k">return</span> <span class="mi">1</span><span class="p">;</span> <span class="p">}</span><span class="p">}</span><span class="nb">String</span><span class="p">(</span><span class="nx">foo</span><span class="p">);</span> <span class="c1">// function foo() { return 1; }</span></code></pre></div>        </li>        <li>Finally, what appears to be a bug in earlier Gecko-based implementations (present in &lt;= Firefox 3), is the way function statements overwrite function declarations. Earlier versions were somehow failing to overwrite function declarations with function statements:<div class="highlight"><pre><code data-lang="js" class="language-js"><span class="c1">// function declaration </span><span class="kd">function</span> <span class="nx">foo</span><span class="p">(){</span> <span class="k">return</span> <span class="mi">1</span><span class="p">;</span> <span class= "p">}</span><span class="k">if</span> <span class="p">(</span><span class="kc">true</span><span class="p">)</span> <span class="p">{</span>  <span class="c1">// overwritting with function statement</span>  <span class="kd">function</span> <span class="nx">foo</span><span class="p">(){</span> <span class="k">return</span> <span class="mi">2</span><span class="p">;</span> <span class="p">}</span><span class="p">}</span><span class="nx">foo</span><span class="p">();</span> <span class="c1">// 1 in FF&lt;= 3, 2 in FF3.5 and later</span><span class="c1">// however, this doesn't happen when overwriting function expression</span><span class="kd">var</span> <span class="nx">foo</span> <span class="o">=</span> <span class="kd">function </span><span class="p">(){</span> <span class="k">return</span> <span class="mi">1</span><span class="p">;</span> <span class="p">};</span><span class="k">if</span> <span class="p">( </span><span class="kc">true</span><span class="p">)</span> <span class="p">{</span>  <span class="kd">function</span> <span class="nx">foo</span><span class="p">(){</span> <span class="k" >return</span> <span class="mi">2</span><span class="p">;</span> <span class="p">}</span><span class="p">}</span><span class="nx">foo</span><span class="p">();</span> <span class="c1">// 2 in all versions</span></code></pre></div>        </li>        </ol>        <p id="function-statements-in-safari">          Note that older Safari (at least 1.2.3, 2.0 - 2.0.4 and 3.0.4, and possibly earlier versions too) implement function statements <strong>identically to SpiderMonkey</strong>.          All examples from this chapter, except the last "bug" one, produce same results in those versions of Safari as they do in, say, Firefox. Another browser that seems to          follow same semantics is Blackberry one (at least 8230, 9000 and 9530 models). This diversity in behavior demonstrates once again what a bad idea it is to rely on these extensions.        </p>      </div>      <h2 id="named-expr">Named function expressions</h2> <p>Function expressions can actually be seen quite often. A common pattern in web development is to "fork" function definitions based on some kind of a feature test, allowing for the best performance. Since such forking usually happens in the same scope, it is almost always necessary to use function expressions. After all, as we know by now, function declarations should not be executed conditionally:</p><div class="highlight"><pre><code data-lang="js" class="language-js"><span class="c1">// `contains` is part of "APE Javascript library" ( http://dhtmlkitchen.com/ape/) by Garrett Smith</span><span class="kd">var</span> <span class="nx">contains</span> <span class="o">=</span> <span class="p">(</span><span class="kd">function </span><span class="p">()</span> <span class="p">{</span>  <span class="kd">var</span> <span class="nx">docEl</span> <span class="o">=</span> <span class="nb">document</span><span class= "p">.</span><span class="nx">documentElement</span><span class="p">;</span>  <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">docEl </span><span class="p">.</span><span class="nx">compareDocumentPosition</span> <span class="o">!=</span> <span class="s1">'undefined'</span><span class="p">)</span> <span class="p">{ </span>    <span class="k">return</span> <span class="kd">function</span><span class="p">(</span><span class="nx">el</span><span class="p">,</span> <span class="nx">b</span><span class="p" >)</span> <span class="p">{</span>      <span class="k">return</span> <span class="p">(</span><span class="nx">el</span><span class="p">.</span><span class="nx">compareDocumentPosition </span><span class="p">(</span><span class="nx">b</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mi">16</span><span class="p">)</span> <span class="o">!==</span> <span class="mi">0</span><span class="p">;</span>    <span class="p">};</span>  <span class="p">}</span>  <span class="k">else</span> <span class="k">if</span> <span class="p">( </span><span class="k">typeof</span> <span class="nx">docEl</span><span class="p">.</span><span class="nx">contains</span> <span class="o">!=</span> <span class="s1">'undefined' </span><span class="p">)</span> <span class="p">{</span>    <span class="k">return</span> <span class="kd">function</span><span class="p">(</span><span class="nx">el</span><span class="p"> ,</span> <span class="nx">b</span><span class="p">)</span> <span class="p">{</span>      <span class="k">return</span> <span class="nx">el</span> <span class="o">!==</span> <span class= "nx">b</span> <span class="o">&amp;&amp;</span> <span class="nx">el</span><span class="p">.</span><span class="nx">contains</span><span class="p">(</span><span class="nx">b</span><span class="p">);</span>    <span class="p">};</span>  <span class="p">}</span>  <span class="k">return</span> <span class="kd">function</span><span class="p">(</span><span class="nx">el </span><span class="p">,</span> <span class="nx">b</span><span class="p">)</span> <span class="p">{</span>    <span class="k">if</span> <span class="p">(</span><span class="nx">el</span> <span class="o">===</span> <span class="nx">b</span><span class="p">)</span> <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>    <span class="k">while </span> <span class="p">(</span><span class="nx">el</span> <span class="o">!=</span> <span class="nx">b</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="nx">b </span> <span class="o">=</span> <span class="nx">b</span><span class="p">.</span><span class="nx">parentNode</span><span class="p">)</span> <span class="o">!=</span> <span class="kc">null </span><span class="p">);</span>    <span class="k">return</span> <span class="nx">el</span> <span class="o">===</span> <span class="nx">b</span><span class="p">;</span>  <span class="p"> };</span><span class="p">})();</span></code></pre></div><p>Quite obviously, when a function expression has a name (technically &mdash; <em>Identifier</em>), it is called a <strong>named function expression</strong>. What you've seen in the very first example &mdash; <code>var bar = function foo(){};</code> &mdash; was exactly that &mdash; a named function expression with <code>foo</code> being a function name. An important detail to remember is that this name is <strong>only available in the scope of a newly-defined function</strong>; specs mandate that an identifier should not be available to an enclosing scope:</p><div class="highlight"><pre><code data-lang="js" class="language-js"><span class="kd">var</span> <span class="nx">f</span> <span class="o">=</span> <span class="kd">function</span> <span class="nx">foo</span><span class="p">(){</span>  <span class="k">return</span> <span class="k">typeof</span> <span class= "nx">foo</span><span class="p">;</span> <span class="c1">// "foo" is available in this inner scope</span><span class="p">};</span><span class="c1">// `foo` is never visible "outside" </span><span class="k">typeof</span> <span class="nx">foo</span><span class="p">;</span> <span class="c1">// "undefined"</span><span class="nx">f</span><span class="p">();</span> <span class="c1">// "function"</span></code></pre></div>      <p>So what's so special about these named function expressions? Why would we want to give them names at all? </p>      <p>It appears that named functions make for a much more pleasant debugging experience. When debugging an application, having a call stack with descriptive items makes a huge difference.</p> <h2 id="names-in-debuggers">Function names in debuggers</h2>      <p>When a function has a corresponding identifier, debuggers show that identifier as a function name, when inspecting call stack. Some debuggers (e.g. Firebug) helpfully show names of even anonymous functions &mdash; making them identical to names of variables that functions are assigned to. Unfortunately, these debuggers usually rely on simple parsing rules; Such extraction is usually quite fragile and often produces false results. </p>      <p>Let's look at a simple example: </p><div class="highlight"><pre><code data-lang="js" class="language-js"><span class="kd">function</span> <span class="nx">foo</span><span class="p">(){</span>  <span class="k">return </span> <span class="nx">bar</span><span class="p">();</span><span class="p">}</span><span class="kd">function</span> <span class="nx">bar</span><span class="p">(){</span>  <span class="k" >return</span> <span class="nx">baz</span><span class="p">();</span><span class="p">}</span><span class="kd">function</span> <span class="nx">baz</span><span class="p">(){</span>  <span class="kr">debugger</span><span class="p">;</span><span class="p">}</span><span class="nx">foo</span><span class="p">();</span><span class="c1">// Here, we used function declarations when defining all of 3 functions</span><span class="c1">// When debugger stops at the `debugger` statement,</span><span class="c1">// the call stack (in Firebug) looks quite descriptive: </span><span class="nx">baz</span><span class="nx">bar</span><span class="nx">foo</span><span class="nx">expr_test</span><span class="p">.</span><span class="nx">html</span><span class="p" >()</span></code></pre></div>      <p>We can see that <code>foo</code> called <code>bar</code> which in its turn called <code>baz</code> (and that <code>foo</code> itself was called from the global scope of <code>expr_test.html</code> document). What's really nice, is that Firebug manages to parse the "name" of a function even when an anonymous expression is used:</p><div class="highlight"><pre><code data-lang="js" class="language-js"><span class="kd">function</span> <span class="nx">foo</span><span class="p">(){</span>  <span class="k">return</span> <span class="nx">bar</span><span class="p">();</span><span class="p">}</span><span class="kd">var</span> <span class="nx">bar</span> <span class="o">=</span> <span class="kd">function </span><span class="p">(){</span>  <span class="k">return</span> <span class="nx">baz</span><span class="p">();</span><span class="p">}</span><span class="kd">function</span> <span class= "nx">baz</span><span class="p">(){</span>  <span class="kr">debugger</span><span class="p">;</span><span class="p">}</span><span class="nx">foo</span><span class="p">();</span><span class= "c1">// Call stack</span><span class="nx">baz</span><span class="nx">bar</span><span class="p">()</span><span class="nx">foo</span><span class="nx">expr_test</span><span class="p">. </span><span class="nx">html</span><span class="p">()</span></code></pre></div>      <p>What's not very nice, though, is that if a function expression gets any more complex (which, in real life, it almost always is) all of the debugger's efforts turn out to be pretty useless; we end up with a shiny question mark in place of a function name:</p><div class="highlight" ><pre><code data-lang="js" class="language-js"><span class="kd">function</span> <span class="nx">foo</span><span class="p">(){</span>  <span class="k">return</span> <span class="nx">bar </span><span class="p">();</span><span class="p">}</span><span class="kd">var</span> <span class="nx">bar</span> <span class="o">=</span> <span class="p">(</span><span class="kd">function </span><span class="p">(){</span>  <span class="k">if</span> <span class="p">(</span><span class="nb">window</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">)</span> <span class="p">{</span>    <span class="k">return</span> <span class="kd">function</span><span class="p">(){</span>      <span class="k">return</span> <span class="nx"> baz</span><span class="p">();</span>    <span class="p">};</span>  <span class="p">}</span>  <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nb"> window</span><span class="p">.</span><span class="nx">attachEvent</span><span class="p">)</span> <span class="p">{</span>    <span class="k">return</span> <span class="kd">function </span><span class="p">()</span> <span class="p">{</span>      <span class="k">return</span> <span class="nx">baz</span><span class="p">();</span>    <span class="p">};</span>  <span class ="p">}</span><span class="p">})();</span><span class="kd">function</span> <span class="nx">baz</span><span class="p">(){</span>  <span class="kr">debugger</span><span class="p">; </span><span class="p">}</span><span class="nx">foo</span><span class="p">();</span><span class="c1">// Call stack</span><span class="nx">baz</span><span class="p">(</span><span class="o"> ?</span><span class="p">)()</span><span class="nx">foo</span><span class="nx">expr_test</span><span class="p">.</span><span class="nx">html</span><span class="p">() </span></code></pre></div>      <p>Another confusion appears when a function is being assigned to more than one variable:</p><div class="highlight"><pre><code data-lang="js" class= "language-js"><span class="kd">function</span> <span class="nx">foo</span><span class="p">(){</span>  <span class="k">return</span> <span class="nx">baz</span><span class="p">(); </span><span class="p">}</span><span class="kd">var</span> <span class="nx">bar</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(){</span>  <span class="kr" >debugger</span><span class="p">;</span><span class="p">};</span><span class="kd">var</span> <span class="nx">baz</span> <span class="o">=</span> <span class="nx">bar</span><span class="p" >;</span><span class="nx">bar</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>  <span class="nx">alert</span><span class= "p">(</span><span class="s1">'spoofed'</span><span class="p">);</span><span class="p">};</span><span class="nx">foo</span><span class="p">();</span><span class="c1">// Call stack: </span><span class="nx">bar</span><span class="p">()</span><span class="nx">foo</span><span class="nx">expr_test</span><span class="p">.</span><span class="nx">html</span><span class="p"> ()</span></code></pre></div>      <p>You can see call stack showing that <code>foo</code> invoked <code>bar</code>. Clearly, that's not what has happened. The confusion is due to the fact that <code>baz</code> was "exchanged" references with another function &mdash; the one alerting "spoofed". As you can see, such parsing &mdash; while great in simple cases &mdash; is often useless in any non-trivial script. </p>      <p>What it all boils down to is the fact that named <strong>function expressions is the only way to get a truly robust stack inspection </strong>. Let's rewrite our previous example with named functions in mind. Notice how both of the functions returning from self-executing wrapper, are named as <code>bar</code>:</p><div class="highlight"><pre><code data-lang="js" class="language-js"><span class="kd">function</span> <span class="nx">foo</span><span class="p">(){</span>  <span class="k">return</span> <span class="nx">bar</span><span class="p">();</span><span class="p">}</span><span class="kd">var</span> <span class="nx">bar</span> <span class="o">=</span> <span class="p">(</span><span class= "kd">function</span><span class="p">(){</span>  <span class="k">if</span> <span class="p">(</span><span class="nb">window</span><span class="p">.</span><span class="nx">addEventListener </span><span class="p">)</span> <span class="p">{</span>    <span class="k">return</span> <span class="kd">function</span> <span class="nx">bar</span><span class="p">(){</span>      <span class="k">return</span> <span class="nx">baz</span><span class="p">();</span>    <span class="p">};</span>  <span class="p">}</span>  <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nb">window</span><span class="p">.</span><span class="nx">attachEvent</span><span class="p">)</span> <span class="p">{</span>    <span class="k">return </span> <span class="kd">function</span> <span class="nx">bar</span><span class="p">()</span> <span class="p">{</span>      <span class="k">return</span> <span class="nx">baz</span><span class="p">();</span>    <span class="p">};</span>  <span class="p">}</span><span class="p">})();</span><span class="kd">function</span> <span class="nx">baz</span><span class="p">(){ </span>  <span class="kr">debugger</span><span class="p">;</span><span class="p">}</span><span class="nx">foo</span><span class="p">();</span><span class="c1">// And, once again, we have a descriptive call stack!</span><span class="nx">baz</span><span class="nx">bar</span><span class="nx">foo</span><span class="nx">expr_test</span><span class="p">.</span><span class="nx"> html</span><span class="p">()</span></code></pre></div>      <p>Before we start dancing happily celebrating this holy grail finding, I'd like to bring a beloved JScript into the picture. </p>      <h2 id="jscript-bugs">JScript bugs</h2>      <p>Unfortunately, JScript (i.e. Internet Explorer's ECMAScript implementation) seriously messed up named function expressions. JScript is responsible for named function expressions <strong>being recommended against</strong> by many people these days. It's also quite sad that even <strong>last version of JScript &mdash; 5.8 &mdash; used in Internet Explorer 8, still exhibits every single quirk described below</strong></p>      <p>Let's look at what exactly is wrong with its broken implementation. Understanding all of its issues will allow us to work around them safely. Note that I broke these discrepancies into few examples &mdash; for clarity &mdash; even though all of them are most likely a consequence of one major bug.</p>      <h3 id="example_1_function_expression_identifier_leaks_into_an_enclosing_scope">Example #1: Function expression identifier leaks into an enclosing scope</h3><div class="highlight"><pre><code data-lang="js" class="language-js"><span class="kd">var</span> <span class="nx">f</span> <span class="o">=</span> <span class="kd"> function</span> <span class="nx">g</span><span class="p">(){};</span><span class="k">typeof</span> <span class="nx">g</span><span class="p">;</span> <span class="c1">// "function" </span></code></pre></div>      <p>Remember how I mentioned that an identifier of named function expression is <strong>not available in an enclosing scope</strong>? Well, JScript doesn't agree with specs on this one &mdash; <code>g</code> in the above example resolves to a function object. This is a most widely observed discrepancy. It's dangerous in that it inadvertedly pollutes an enclosing scope &mdash; a scope that might as well be a global one &mdash; with an extra identifier. Such pollution can, of course, be a source of hard-to-track bugs.</p> <h3 id="example_2_named_function_expression_is_treated_as_both_function_declaration_and_function_expression">Example #2: Named function expression is treated as BOTH &mdash; function declaration AND function expression</h3><div class="highlight"><pre><code data-lang="js" class="language-js"><span class="k">typeof</span> <span class="nx">g</span><span class="p">;</span> <span class="c1">// "function"</span><span class="kd">var</span> <span class="nx">f</span> <span class="o">=</span> <span class="kd">function</span> <span class="nx">g</span><span class= "p">(){};</span></code></pre></div>      <p>As I explained before, function declarations are parsed foremost any other expressions in a particular execution context. The above example demonstrates how <strong>JScript actually treats named function expressions as function declarations</strong>. You can see that it parses <code>g</code> before an "actual declaration" takes place. </p>      <p>This brings us to a next example:</p>      <h3 id="example_3_named_function_expression_creates_two_distinct_function_objects">Example #3: Named function expression creates TWO DISTINCT function objects!</h3><div class="highlight"><pre><code data-lang="js" class="language-js"><span class="kd">var</span> <span class="nx">f</span> <span class ="o">=</span> <span class="kd">function</span> <span class="nx">g</span><span class="p">(){};</span><span class="nx">f</span> <span class="o">===</span> <span class="nx">g</span><span class="p">;</span> <span class="c1">// false</span><span class="nx">f</span><span class="p">.</span><span class="nx">expando</span> <span class="o">=</span> <span class="s1">'foo' </span><span class="p">;</span><span class="nx">g</span><span class="p">.</span><span class="nx">expando</span><span class="p">;</span> <span class="c1">// undefined </span></code></pre></div>      <p>This is where things are getting interesting. Or rather &mdash; completely nuts. Here we are seeing the dangers of having to deal with two distinct objects &mdash; augmenting one of them obviously does not modify the other one; This could be quite troublesome if you decided to employ, say, caching mechanism and store something in a property of <code>f</code>, then tried accessing it as a property of <code>g</code>, thinking that it is the same object you're working with.</p>      <p>Let's look at something a bit more complex.</p>      <h3 id="example_4_function_declarations_are_parsed_sequentially_and_are_not_affected_by_conditional_blocks">Example #4: Function declarations are parsed sequentially and are not affected by conditional blocks</h3><div class="highlight"><pre><code data-lang="js" class="language-js"><span class="kd">var</span> <span class="nx">f</span> <span class="o">=</span> <span class="kd">function</span> <span class="nx">g</span><span class="p">()</span> <span class="p">{</span>  <span class="k">return</span> <span class="mi">1 </span><span class="p">;</span><span class="p">};</span><span class="k">if</span> <span class="p">(</span><span class="kc">false</span><span class="p">)</span> <span class="p">{</span> <span class="nx">f</span> <span class="o">=</span> <span class="kd">function</span> <span class="nx">g</span><span class="p">(){</span>    <span class="k">return</span> <span class="mi">2 </span><span class="p">;</span>  <span class="p">};</span><span class="p">}</span><span class="nx">g</span><span class="p">();</span> <span class="c1">// 2</span></code></pre></div> <p>An example like this could cause even harder to track bugs. What happens here is actually quite simple. First, <code>g</code> is being parsed as a function declaration, and since declarations in JScript are independent of conditional blocks, <code>g</code> is being declared as a function from the "dead" <code>if</code> branch &mdash; <code>function g(){ return 2 } </code>. Then all of the "regular" expressions are being evaluated and <code>f</code> is being assigned another, newly created function object to. "dead" <code>if</code> branch is never entered when evaluating expressions, so <code>f</code> keeps referencing first function &mdash; <code>function g(){ return 1 }</code>. It should be clear by now, that if you're not careful enough, and call <code>g</code> from within <code>f</code>, you'll end up calling a completely unrelated <code>g</code> function object.</p>      <p>You might be wondering how all this mess with different function objects compares to <code>arguments.callee</code>. Does <code>callee</code> reference <code>f</code> or <code>g</code>? Let's take a look:</p><div class= "highlight"><pre><code data-lang="js" class="language-js"><span class="kd">var</span> <span class="nx">f</span> <span class="o">=</span> <span class="kd">function</span> <span class="nx">g </span><span class="p">(){</span>  <span class="k">return</span> <span class="p">[</span>    <span class="nx">arguments</span><span class="p">.</span><span class="nx">callee</span> <span class="o">==</span> <span class="nx">f</span><span class="p">,</span>    <span class="nx">arguments</span><span class="p">.</span><span class="nx">callee</span> <span class="o">==</span> <span class="nx">g</span>  <span class="p">];</span><span class="p">};</span><span class="nx">f</span><span class="p">();</span> <span class="c1">// [true, false]</span><span class="nx">g </span><span class="p">();</span> <span class="c1">// [false, true]</span></code></pre></div>      <p>As you can see, <code>arguments.callee</code> references whatever function is being invoked. This is actually good news, as you will see later on.</p>      <p>Another interesting example of "unexpected behavior" can be observed when using named <strong>function expression in undeclared assignment</strong>, but only when function is "named" the same way as identifier it's being assigned to:</p><div class="highlight"><pre><code data-lang="js" class ="language-js"><span class="p">(</span><span class="kd">function</span><span class="p">(){</span>  <span class="nx">f</span> <span class="o">=</span> <span class="kd">function</span> <span class="nx">f</span><span class="p">(){};</span><span class="p">})();</span></code></pre></div>      <p>As you might know, undeclared assignment (which is <strong>not recommended</strong> and is only used here for demonstration purposes) should result in creation of global <code>f</code> property. This is exactly what happens in conforming implementations. However, JScript bug makes things a bit more confusing. Since named function expression is parsed as function declaration (see <a href= "#example_2_named_function_expression_is_treated_as_both_function_declaration_and_function_expression">example #2</a>), what happens here is that <code>f</code> becomes declared as a local variable during the phase of variable declarations. Later on, when function execution begins, assignment is no longer undeclared, so <code>function f(){}</code> on the right hand side is simply assigned to this newly created <strong>local</strong> <code>f</code> variable. Global <code>f</code> is never created.</p>      <p>This demonstrates how failing to understand JScript peculiarities can lead to drastically different behavior in code.</p>      <p>Looking at JScript deficiencies, it becomes pretty clear what exactly we need to avoid. First, we need <strong>to be aware of a leaking identifier</strong> (so that it doesn't pollute enclosing scope). Second, we should <strong>never reference identifier used as a function name</strong>; A troublesome identifier is <code>g</code> from the previous examples. Notice how many ambiguities could have been avoided if we were to forget about <code>g</code>'s existance. Always referencing function via <code>f</code> or <code>arguments.callee</code> is the key here. If you use named expression, think of that name as something that's only being used for debugging purposes. And finally, a bonus point is to <strong>always clean up an extraneous function</strong> created erroneously during NFE declaration.</p>      <p>I think last point needs a bit of an explanation:</p>      <h2 id="jscript-memory-management">JScript memory management</h2>      <p>Being familiar with JScript discrepancies, we can now see a potential problem with memory consumption when using these buggy constructs. Let's look at a simple example:</p><div class="highlight"><pre><code data-lang="js" class="language-js"><span class="kd">var</span> <span class="nx">f</span> <span class="o">=</span> <span class="p">(</span><span class="kd">function</span><span class="p">(){</span>  <span class="k">if</span> <span class="p">(</span><span class="kc">true</span><span class="p">)</span> <span class="p">{</span>    <span class="k">return</span> <span class="kd">function</span> <span class="nx">g </span><span class="p">(){};</span>  <span class="p">}</span>  <span class="k">return</span> <span class="kd">function</span> <span class="nx">g</span><span class="p">(){};</span><span class="p">})();</span></code></pre></div>      <p>We know that a function returned from within this anonymous invocation &mdash; the one that has <code>g</code> identifier &mdash; is being assigned to outer <code>f</code>. We also know that named function expressions produce superfluous function object, and that this object is not the same as returned function. The memory issue here is caused by this extraneous <code>g</code> function being literally "trapped" in a closure of returning function. This happens because inner function is declared in the same scope as that pesky <code>g</code> one. Unless we <strong>explicitly break reference to <code>g</code> function</strong> it will keep consuming memory.</p><div class="highlight" ><pre><code data-lang="js" class="language-js"><span class="kd">var</span> <span class="nx">f</span> <span class="o">=</span> <span class="p">(</span><span class="kd">function</span><span class="p">(){</span>  <span class="kd">var</span> <span class="nx">f</span><span class="p">,</span> <span class="nx">g</span><span class="p">;</span>  <span class="k">if</span> <span class ="p">(</span><span class="kc">true</span><span class="p">)</span> <span class="p">{</span>    <span class="nx">f</span> <span class="o">=</span> <span class="kd">function</span> <span class="nx">g</span><span class="p">(){};</span>  <span class="p">}</span>  <span class="k">else</span> <span class="p">{</span>    <span class="nx">f</span> <span class="o">=</span> <span class="kd">function</span> <span class="nx">g</span><span class="p">(){};</span>  <span class="p">}</span>  <span class="c1">// null `g`, so that it doesn't reference extraneous function any longer</span>  <span class="nx">g</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>  <span class="k">return</span> <span class="nx">f</span><span class="p">;</span><span class="p">})();</span></code></pre></div>      <p>Note that we explicitly declare <code>g</code> as well, so that <code>g = null</code> assignment wouldn't create a global <code>g</code> variable in conforming clients (i.e. non-JScript ones). By <code>null</code>ing reference to <code>g</code>, we allow garbage collector to wipe off this implicitly created function object that <code>g</code> refers to.</p>      <p>When taking care of JScript NFE memory leak, I decided to run a simple series of tests to confirm that <code>null</code> ing <code>g</code> actually does free memory.</p>      <h2 id="tests">Tests</h2>      <p>The test was simple. It would simply create 10000 functions via named function expressions and store them in an array. I would then wait for about a minute and check how high the memory consumption is. After that I would null-out the reference and repeat the procedure again. Here's a test case I used:</p><div class="highlight"><pre><code data-lang="js" class="language-js"><span class="kd">function</span> <span class="nx">createFn</span><span class="p">(){</span> <span class="k">return</span> <span class="p">(</span><span class="kd">function</span><span class="p">(){</span>    <span class="kd">var</span> <span class="nx">f</span><span class="p">; </span>    <span class="k">if</span> <span class="p">(</span><span class="kc">true</span><span class="p">)</span> <span class="p">{</span>      <span class="nx">f</span> <span class="o">= </span> <span class="kd">function</span> <span class="nx">F</span><span class="p">(){</span>        <span class="k">return</span> <span class="s1">'standard'</span><span class="p">;</span> <span class="p">};</span>    <span class="p">}</span>    <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="kc">false</span><span class="p">) </span> <span class="p">{</span>      <span class="nx">f</span> <span class="o">=</span> <span class="kd">function</span> <span class="nx">F</span><span class="p">(){</span>        <span class="k">return</span> <span class="s1">'alternative'</span><span class="p">;</span>      <span class="p">};</span>    <span class="p">}</span>    <span class="k">else</span> <span class= "p">{</span>      <span class="nx">f</span> <span class="o">=</span> <span class="kd">function</span> <span class="nx">F</span><span class="p">(){</span>        <span class="k">return </span> <span class="s1">'fallback'</span><span class="p">;</span>      <span class="p">};</span>    <span class="p">}</span>    <span class="c1">// var F = null;</span>    <span class="k" >return</span> <span class="nx">f</span><span class="p">;</span>  <span class="p">})();</span><span class="p">}</span><span class="kd">var</span> <span class="nx">arr</span> <span class= "o">=</span> <span class="p">[</span> <span class="p">];</span><span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span><span class="o">= </span><span class="mi">0</span><span class="p">;</span> <span class="nx">i</span><span class="o">&lt;</span><span class="mi">10000</span><span class="p">;</span> <span class="nx">i </span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>  <span class="nx">arr</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">=</span> <span class="nx">createFn</span><span class="p">();</span><span class="p">}</span></code></pre></div>      <p>Results as seen in Process Explorer on Windows XP SP2 were:</p><pre>  IE6:    without `null`:   7.6K -&gt; 20.3K    with `null`:      7.6K -&gt; 18K  IE7:    without `null`:   14K -&gt; 29.7K    with `null`:      14K -&gt; 27K</pre> <p>The results somewhat confirmed my assumptions &mdash; explicitly nulling superfluous reference did free memory, but the difference in consumption was relatively insignificant. For 10000 function objects, there would be a ~3MB difference. This is definitely something that should be kept in mind when designing large-scale applications, applications that will run for either long time or on devices with limited memory (such as mobile devices). For any small script, the difference probably doesn't matter.</p>      <p>You might think that it's all finally over, but we are not just quite there yet :) There's a tiny little detail that I'd like to mention and that detail is Safari 2.x</p>      <h2 id="safari-bug">Safari bug</h2> <p>      Even less widely known bug with NFE is present in older versions of Safari; namely, Safari 2.x series. I've seen some <a href=" http://meyerweb.com/eric/thoughts/2005/07/11/safari-syntaxerror/">claims on the web</a> that Safari 2.x does not support NFE at all. This is not true. Safari does support it, but has bugs in its implementation which you will see shortly.</p>      <p>When encountering function expression in a certain context, Safari 2.x fails to parse the program entirely. It doesn't throw any errors (such as <code>SyntaxError</code> ones). It simply bails out:</p><div class="highlight"><pre><code data-lang="js" class="language-js"><span class="p">(</span><span class="kd"> function</span> <span class="nx">f</span><span class="p">(){})();</span> <span class="c1">// &lt;== NFE</span><span class="nx">alert</span><span class="p">(</span><span class="mi">1 </span><span class="p">);</span> <span class="c1">// this line is never reached, since previous expression fails the entire program</span></code></pre></div>      <p>After fiddling with various test cases, I came to conclusion that Safari 2.x <strong>fails to parse named function expressions, if those are not part of assignment expressions</strong>. Some examples of assignment expressions are:</p><div class="highlight"><pre><code data-lang="js" class="language-js"><span class="c1">// part of variable declaration</span><span class="kd">var</span> <span class="nx">f</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span><span class="c1">// part of simple assignment</span><span class="nx">f</span> <span class="o" >=</span> <span class="mi">2</span><span class="p">,</span> <span class="nx">g</span> <span class="o">=</span> <span class="mi">3</span><span class="p">;</span><span class="c1">// part of return statement</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span>  <span class="k">return</span> <span class="p">(</span><span class="nx">f</span> <span class="o">=</span> <span class="mi">2</span><span class="p">);</span><span class="p">})();</span></code></pre></div>      <p>This means that putting named function expression into an assignment makes Safari "happy":</p><div class="highlight"><pre><code data-lang="js" class="language-js"><span class="p">(</span><span class="kd">function</span> <span class="nx">f </span><span class="p">(){});</span> <span class="c1">// fails</span><span class="kd">var</span> <span class="nx">f</span> <span class="o">=</span> <span class="kd">function</span> <span class="nx">f</span><span class="p">(){};</span> <span class="c1">// works</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span>  <span class="k">return </span> <span class="kd">function</span> <span class="nx">f</span><span class="p">(){};</span> <span class="c1">// fails</span><span class="p">})();</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span>  <span class="k">return</span> <span class="p">(</span><span class="nx">f</span> <span class="o">=</span> <span class="kd">function </span> <span class="nx">f</span><span class="p">(){});</span> <span class="c1">// works</span><span class="p">})();</span><span class="nx">setTimeout</span><span class="p">(</span><span class="kd">function</span> <span class="nx">f</span><span class="p">(){</span> <span class="p">},</span> <span class="mi">100</span><span class="p">);</span> <span class="c1">// fails </span><span class="nx">Person</span><span class="p">.</span><span class="nx">prototype</span> <span class="o">=</span> <span class="p">{</span>  <span class="nx">say</span><span class="o" >:</span> <span class="kd">function</span> <span class="nx">say</span><span class="p">()</span> <span class="p">{</span> <span class="p">...</span> <span class="p">}</span> <span class= "c1">// fails</span><span class="p">}</span><span class="nx">Person</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">say</span> <span class="o">=</span> <span class="kd">function</span> <span class="nx">say</span><span class="p">(){</span> <span class="p">...</span> <span class="p">};</span> <span class="c1">// works </span></code></pre></div>      <p>It also means that we can't use such common pattern as returning named function expression without an assignment:</p><div class="highlight"><pre><code data-lang="js" class="language-js"><span class="c1">// Instead of this non-Safari-2x-compatible syntax:</span><span class="p">(</span><span class="kd">function</span><span class="p">(){ </span>  <span class="k">if</span> <span class="p">(</span><span class="nx">featureTest</span><span class="p">)</span> <span class="p">{</span>    <span class="k">return</span> <span class ="kd">function</span> <span class="nx">f</span><span class="p">(){};</span>  <span class="p">}</span>  <span class="k">return</span> <span class="kd">function</span> <span class="nx">f </span><span class="p">(){};</span><span class="p">})();</span><span class="c1">// we should use this slightly more verbose alternative:</span><span class="p">(</span><span class="kd"> function</span><span class="p">(){</span>  <span class="kd">var</span> <span class="nx">f</span><span class="p">;</span>  <span class="k">if</span> <span class="p">(</span><span class="nx" >featureTest</span><span class="p">)</span> <span class="p">{</span>    <span class="nx">f</span> <span class="o">=</span> <span class="kd">function</span> <span class="nx">f</span><span class="p">(){};</span>  <span class="p">}</span>  <span class="k">else</span> <span class="p">{</span>    <span class="nx">f</span> <span class="o">=</span> <span class="kd">function </span> <span class="nx">f</span><span class="p">(){};</span>  <span class="p">}</span>  <span class="k">return</span> <span class="nx">f</span><span class="p">;</span><span class="p"> })();</span><span class="c1">// or another variation of it:</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span>  <span class="kd">var</span> <span class="nx">f</span><span class="p">;</span>  <span class="k">if</span> <span class="p">(</span><span class="nx">featureTest</span><span class="p">)</span> <span class="p">{</span>    <span class="k">return</span> <span class="p">(</span><span class="nx">f</span> <span class="o">=</span> <span class="kd">function</span> <span class="nx">f</span><span class="p">(){});</span> <span class="p">}</span>  <span class="k">return</span> <span class="p">(</span><span class="nx">f</span> <span class="o">=</span> <span class="kd">function</span> <span class="nx">f </span><span class="p">(){});</span><span class="p">})();</span><span class="cm">/*</span><span class="cm">  Unfortunately, by doing so, we introduce an extra reference to a function </span><span class="cm">  which gets trapped in a closure of returning function. To prevent extra memory usage,</span><span class="cm">  we can assign all named function expressions to one single variable.</span><span class="cm">*/</span><span class="kd">var</span> <span class="nx">__temp</span><span class="p">;</span><span class="p">(</span><span class="kd">function </span><span class="p">(){</span>  <span class="k">if</span> <span class="p">(</span><span class="nx">featureTest</span><span class="p">)</span> <span class="p">{</span>    <span class="k" >return</span> <span class="p">(</span><span class="nx">__temp</span> <span class="o">=</span> <span class="kd">function</span> <span class="nx">f</span><span class="p">(){});</span> <span class="p">}</span>  <span class="k">return</span> <span class="p">(</span><span class="nx">__temp</span> <span class="o">=</span> <span class="kd">function</span> <span class="nx">f </span><span class="p">(){});</span><span class="p">})();</span><span class="p">...</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span>  <span class= "k">if</span> <span class="p">(</span><span class="nx">featureTest2</span><span class="p">)</span> <span class="p">{</span>    <span class="k">return</span> <span class="p">(</span><span class="nx">__temp</span> <span class="o">=</span> <span class="kd">function</span> <span class="nx">g</span><span class="p">(){});</span>  <span class="p">}</span>  <span class="k">return </span> <span class="p">(</span><span class="nx">__temp</span> <span class="o">=</span> <span class="kd">function</span> <span class="nx">g</span><span class="p">(){});</span><span class= "p">})();</span><span class="cm">/*</span><span class="cm">  Note that subsequent assignments destroy previous references,</span><span class="cm">  preventing any excessive memory usage. </span><span class="cm">*/</span></code></pre></div>      <p>If Safari 2.x compatibility is important, we need to make sure <strong>"incompatible" constructs do not even appear in the source</strong>. This is of course quite irritating, but is definitely possible to achieve, especially when knowing the root of the problem.</p>      <p>It's also worth mentioning that declaring a function as NFE in Safari 2.x exhibits another minor glitch, where function representation does not contain function identifier:</p><div class="highlight"><pre><code data-lang= "js" class="language-js"><span class="kd">var</span> <span class="nx">f</span> <span class="o">=</span> <span class="kd">function</span> <span class="nx">g</span><span class="p">(){}; </span><span class="c1">// Notice how function representation is lacking `g` identifier</span><span class="nb">String</span><span class="p">(</span><span class="nx">f</span><span class="p" >);</span> <span class="c1">// function () { }</span></code></pre></div>      <p>This is not really a big deal. As I have already mentioned before, function decompilation is something that <a href="http://perfectionkills.com/those-tricky-functions/">should not be relied upon</a> anyway. </p>      <h2 id="spidermonkey-peculiarity">SpiderMonkey peculiarity</h2>      <p> We know that identifier of named function expression is only available to the local scope of a function.        But how does this "magic" scoping actually happen? It appears to be very simple.        When named function expression is evaluated, a <strong>special object is created</strong>.        The sole purpose of that object is to hold a property with the name corresponding to function identifier, and value corresponding to function itself.        That object is then injected into the front of the current scope chain, and this "augmented" scope chain is then used to initialize a function.      </p>      <p>        The interesting part here, however, is the way ECMA-262 defines this "special" object &mdash; the one that holds function identifier.        Spec says that an object is created <strong>"as if by expression new Object()"</strong> which, when interpreted literally,        makes this object an instance of built-in <code>Object</code> constructor. However, only one implementation &mdash; SpiderMonkey &mdash;        followed this specification requirement literally. In SpiderMonkey, it is possible to interfere with function local variables by augmenting <code>Object.prototype</code>:      </p><div class="highlight"><pre><code data-lang="js" class="language-js"><span class= "nb">Object</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">x</span> <span class="o">=</span> <span class="s1">'outer'</span><span class="p">;</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span>  <span class="kd">var</span> <span class="nx">x</span> <span class="o">=</span> <span class="s1">'inner'</span><span class="p">;</span>  <span class="cm">/*</span><span class="cm">    `foo` function here has a special object in its scope chain &mdash; to hold an identifier. That object is practically a &mdash;</span><span class="cm">    `{ foo: &lt;function object&gt; }`. When `x` is being resolved through the scope chain, it is first searched for in</span><span class="cm">    `foo`'s local context. When not found, it is searched in the next object from the scope chain. That object turns out</span><span class="cm">    to be the one that holds identifier &mdash; { foo: &lt;function object&gt; } and since it inherits from `Object.prototype`,</span><span class="cm">    `x` is found right here, and is the one that's `Object.prototype.x` (with value of 'outer'). Outer function's scope</span><span class="cm">    (with x === 'inner') is never even reached.</span><span class="cm">  */</span>  <span class= "p">(</span><span class="kd">function</span> <span class="nx">foo</span><span class="p">(){</span>    <span class="nx">alert</span><span class="p">(</span><span class="nx">x</span><span class="p">);</span> <span class="c1">// alerts `outer`</span>  <span class="p">})();</span><span class="p">})();</span></code></pre></div><p>  Note that later versions of SpiderMonkey actually <strong>changed this behavior</strong>,  as it was probably considered a security hole. A "special" object no longer inherits from <code>Object.prototype</code>.  You can, however, still see it in Firefox &lt;=3.</p><p id="activation-object-in-blackberry-browser">  Another environment implementing internal object as an instance of global <code>Object</code> is <strong>Blackberry browser</strong>.  Only this time, it's <em>Activation Object</em> that inherits from <code>Object.prototype</code>. Note that specification actually  doesn't codify <em>Activation Object</em> to be created "as if by expression new Object()" (as is the case with NFE's identifier holder object).  It states that <em>Activation Object</em> is merely a specification mechanism.</p><p>So, let's see what happens in Blackberry browser:</p><div class="highlight"><pre><code data-lang="js" class="language-js"><span class="nb">Object</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">x</span> <span class="o">=</span> <span class="s1">'outer'</span><span class="p">;</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span>  <span class="kd">var</span> <span class="nx">x</span> <span class="o">=</span> <span class="s1">'inner' </span><span class="p">;</span>  <span class="p">(</span><span class="kd">function</span><span class="p">(){</span>    <span class="cm">/*</span><span class="cm">    When `x` is being resolved against scope chain, this local function's Activation Object is searched first.</span><span class="cm">    There's no `x` in it, of course. However, since Activation Object inherits from `Object.prototype`, it is</span><span class="cm">    `Object.prototype` that's being searched for `x` next. `Object.prototype.x` does in fact exist and so `x`</span><span class="cm">    resolves to its value &mdash; 'outer'. As in the previous example, outer function's scope (Activation Object)</span><span class="cm">    with its own x === 'inner' is never even reached.</span><span class="cm">    */</span>    <span class="nx">alert</span><span class="p">(</span><span class="nx">x</span><span class="p">);</span> <span class="c1">// alerts 'outer'</span>  <span class="p">})();</span><span class="p">})();</span></code></pre></div><p>  This might look bizarre, but what's really disturbing is that there's even more chance of conflict with  already existing <code>Object.prototype</code> members:</p><div class="highlight"><pre><code data-lang="js" class="language-js"><span class="p">(</span><span class="kd"> function</span><span class="p">(){</span>  <span class="kd">var</span> <span class="nx">constructor</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(){ </span> <span class="k">return</span> <span class="mi">1</span><span class="p">;</span> <span class="p">};</span>  <span class="p">(</span><span class="kd">function</span><span class="p"> (){</span>    <span class="nx">constructor</span><span class="p">();</span> <span class="c1">// evaluates to an object `{ }`, not `1`</span>    <span class="nx">constructor</span> <span class="o">===</span> <span class="nb">Object</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">constructor</span><span class="p">; </span> <span class="c1">// true</span>    <span class="nx">toString</span> <span class="o">===</span> <span class="nb">Object</span><span class="p">.</span><span class="nx">prototype </span><span class="p">.</span><span class="nx">toString</span><span class="p">;</span> <span class="c1">// true</span>    <span class="c1">// etc.</span>  <span class="p">})(); </span><span class="p">})();</span></code></pre></div><p>  Solution to this Blackberry discrepancy is obvious: avoid naming variables as <code>Object.prototype</code> properties  &mdash; <code>toString</code>, <code>valueOf</code>, <code>hasOwnProperty</code>, and so on.</p>      <h2 id="solution">JScript solution</h2><div class="highlight"><pre><code data-lang="js" class= "language-js"><span class="kd">var</span> <span class="nx">fn</span> <span class="o">=</span> <span class="p">(</span><span class="kd">function</span><span class="p">(){</span>  <span class="c1">// declare a variable to assign function object to</span>  <span class="kd">var</span> <span class="nx">f</span><span class="p">;</span>  <span class="c1">// conditionally create a named function</span>  <span class="c1">// and assign its reference to `f`</span>  <span class="k">if</span> <span class="p">(</span><span class="kc">true</span><span class="p">) </span> <span class="p">{</span>    <span class="nx">f</span> <span class="o">=</span> <span class="kd">function</span> <span class="nx">F</span><span class="p">(){</span> <span class="p"> };</span>  <span class="p">}</span>  <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="kc">false</span><span class="p">)</span> <span class="p">{ </span>    <span class="nx">f</span> <span class="o">=</span> <span class="kd">function</span> <span class="nx">F</span><span class="p">(){</span> <span class="p">};</span>  <span class= "p">}</span>  <span class="k">else</span> <span class="p">{</span>    <span class="nx">f</span> <span class="o">=</span> <span class="kd">function</span> <span class="nx">F</span><span class="p">(){</span> <span class="p">};</span>  <span class="p">}</span>  <span class="c1">// Assign `null` to a variable corresponding to a function name</span>  <span class="c1">// This marks the function object (referred to by that identifier)</span>  <span class="c1">// available for garbage collection</span>  <span class="kd">var</span> <span class="nx">F</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>  <span class="c1">// return a conditionally defined function</span>  <span class="k">return</span> <span class="nx"> f</span><span class="p">;</span><span class="p">})();</span></code></pre></div>      <p>Finally, here's how we would apply this "techinque" in real life, when writing something like a cross-browser <code>addEvent</code> function:</p><div class="highlight"><pre><code data-lang="js" class="language-js"><span class="c1">// 1) enclose declaration with a separate scope </span><span class="kd">var</span> <span class="nx">addEvent</span> <span class="o">=</span> <span class="p">(</span><span class="kd">function</span><span class="p">(){</span>  <span class ="kd">var</span> <span class="nx">docEl</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">documentElement</span><span class="p">; </span>  <span class="c1">// 2) declare a variable to assign function to</span>  <span class="kd">var</span> <span class="nx">fn</span><span class="p">;</span>  <span class="k">if</span> <span class="p">(</span><span class="nx">docEl</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">)</span> <span class="p">{</span>    <span class="c1"> // 3) make sure to give function a descriptive identifier</span>    <span class="nx">fn</span> <span class="o">=</span> <span class="kd">function</span> <span class="nx">addEvent </span><span class="p">(</span><span class="nx">element</span><span class="p">,</span> <span class="nx">eventName</span><span class="p">,</span> <span class="nx">callback</span><span class ="p">)</span> <span class="p">{</span>      <span class="nx">element</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="nx"> eventName</span><span class="p">,</span> <span class="nx">callback</span><span class="p">,</span> <span class="kc">false</span><span class="p">);</span>    <span class="p">};</span>  <span class="p">}</span>  <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">docEl</span><span class="p">.</span><span class="nx">attachEvent </span><span class="p">)</span> <span class="p">{</span>    <span class="nx">fn</span> <span class="o">=</span> <span class="kd">function</span> <span class="nx">addEvent</span><span class ="p">(</span><span class="nx">element</span><span class="p">,</span> <span class="nx">eventName</span><span class="p">,</span> <span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>      <span class="nx">element</span><span class="p">.</span><span class="nx">attachEvent</span><span class="p">(</span><span class="s1">'on'</span> <span class="o" >+</span> <span class="nx">eventName</span><span class="p">,</span> <span class="nx">callback</span><span class="p">);</span>    <span class="p">};</span>  <span class="p">}</span>  <span class="k">else</span> <span class="p">{</span>    <span class="nx">fn</span> <span class="o">=</span> <span class="kd">function</span> <span class="nx">addEvent</span><span class="p">( </span><span class="nx">element</span><span class="p">,</span> <span class="nx">eventName</span><span class="p">,</span> <span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>      <span class="nx">element</span><span class="p">[</span><span class="s1">'on'</span> <span class="o">+</span> <span class="nx">eventName</span><span class="p">] </span> <span class="o">=</span> <span class="nx">callback</span><span class="p">;</span>    <span class="p">};</span>  <span class="p">}</span>  <span class="c1">// 4) clean up `addEvent` function created by JScript</span>  <span class="c1">//    make sure to either prepend assignment with `var`,</span>  <span class="c1">//    or declare `addEvent` at the top of the function</span>  <span class="kd">var</span> <span class="nx">addEvent</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>  <span class="c1">// 5) finally return function referenced by `fn`</span>  <span class="k">return</span> <span class="nx">fn</span><span class="p">;</span><span class="p">})();</span></code></pre></div>      <h2 id="alt-solution">Alternative solution</h2>      <p>It's worth mentioning that there actually exist alternative ways of having descriptive names in call stacks. Ways that don't require one to use named function expressions. First of all, it is often possible to define function via declaration, rather than via expression. This option is only viable when you don't need to create more than one function:</p><div class="highlight"><pre><code data-lang="js" class="language-js"><span class="kd">var</span> <span class="nx">hasClassName</span> <span class="o">= </span> <span class="p">(</span><span class="kd">function</span><span class="p">(){</span>  <span class="c1">// define some private variables</span>  <span class="kd">var</span> <span class="nx">cache</span> <span class="o">=</span> <span class="p">{</span> <span class="p">};</span>  <span class="c1">// use function declaration</span>  <span class="kd">function</span> <span class="nx">hasClassName</span><span class="p">(</span><span class="nx">element</span><span class="p">,</span> <span class="nx">className</span><span class="p">)</span> <span class= "p">{</span>    <span class="kd">var</span> <span class="nx">_className</span> <span class="o">=</span> <span class="s1">'(?:^|\\s+)'</span> <span class="o">+</span> <span class="nx"> className</span> <span class="o">+</span> <span class="s1">'(?:\\s+|$)'</span><span class="p">;</span>    <span class="kd">var</span> <span class="nx">re</span> <span class="o">=</span> <span class="nx">cache</span><span class="p">[</span><span class="nx">_className</span><span class="p">]</span> <span class="o">||</span> <span class="p">(</span><span class="nx">cache </span><span class="p">[</span><span class="nx">_className</span><span class="p">]</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">RegExp</span><span class="p"> (</span><span class="nx">_className</span><span class="p">));</span>    <span class="k">return</span> <span class="nx">re</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">element</span><span class="p">.</span><span class="nx">className</span><span class="p">);</span>  <span class="p">}</span>  <span class="c1">// return function</span>  <span class="k">return</span> <span class="nx">hasClassName</span><span class="p">;</span><span class="p">})();</span></code></pre></div>      <p>This obviously wouldn't work when forking function definitions. Nevertheless, there's an interesting pattern that I first seen used by <a href="http://tobielangel.com/">Tobie Langel</a>. The way it works is by <strong>defining all functions upfront using function declarations, but giving them slightly different identifiers</strong>:</p><div class="highlight"><pre><code data-lang="js" class= "language-js"><span class="kd">var</span> <span class="nx">addEvent</span> <span class="o">=</span> <span class="p">(</span><span class="kd">function</span><span class="p">(){</span> <span class="kd">var</span> <span class="nx">docEl</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">documentElement</span><span class="p">;</span>  <span class="kd">function</span> <span class="nx">addEventListener</span><span class="p">(){</span>    <span class="cm">/* ... */</span>  <span class="p">}</span> <span class="kd">function</span> <span class="nx">attachEvent</span><span class="p">(){</span>    <span class="cm">/* ... */</span>  <span class="p">}</span>  <span class="kd">function </span> <span class="nx">addEventAsProperty</span><span class="p">(){</span>    <span class="cm">/* ... */</span>  <span class="p">}</span>  <span class="k">if</span> <span class="p">( </span><span class="k">typeof</span> <span class="nx">docEl</span><span class="p">.</span><span class="nx">addEventListener</span> <span class="o">!=</span> <span class="s1">'undefined' </span><span class="p">)</span> <span class="p">{</span>    <span class="k">return</span> <span class="nx">addEventListener</span><span class="p">;</span>  <span class="p">}</span>  <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">docEl</span><span class="p">.</span><span class="nx">attachEvent </span> <span class="o">!=</span> <span class="s1">'undefined'</span><span class="p">)</span> <span class="p">{</span>    <span class="k">return</span> <span class="nx">attachEvent </span><span class="p">;</span>  <span class="p">}</span>  <span class="k">return</span> <span class="nx">addEventAsProperty</span><span class="p">;</span><span class="p">})(); </span></code></pre></div>      <p>While it's an elegant approach, it has its own drawbacks. First, by using different identifiers, you lose naming consistency. Whether it's good or bad thing is not very clear. Some might prefer to have identical names, while others wouldn't mind varying ones; after all, different names can often "speak" about implementation used. For example, seeing "attachEvent" in debugger, would let you know that it is an <code>attachEvent</code>-based implementation of <code>addEvent</code>. On the other hand, implementation-related name might not be meaningful at all. If you're providing an API and name "inner" functions in such way, the user of API could easily get lost in all of these implementation details. </p>      <p>A solution to this problem might be to employ different naming convention. Just be careful not to introduce extra verbosity. Some alternatives that come to mind are:</p><pre>  `addEvent`, `altAddEvent` and `fallbackAddEvent`  // or  `addEvent`, `addEvent2`, `addEvent3`  // or  `addEvent_addEventListener`, `addEvent_attachEvent`, `addEvent_asProperty`</pre>      <p>Another minor issue with this pattern is increased memory consumption. By defining all of the function variations upfront, you implicitly create N-1 unused functions. As you can see, if <code>attachEvent</code> is found in <code>document.documentElement</code>, then neither <code>addEventListener</code> nor <code>addEventAsProperty </code> are ever really used. Yet, they already consume memory; memory which is never deallocated for the same reason as with JScript's buggy named expressions &mdash; both functions are "trapped" in a closure of returning one. </p>      <p>This increased consumption is of course hardly an issue. If a library such as Prototype.js was to use this pattern, there would be not more than 100-200 extra function objects created. As long as functions are not created in such way repeatedly (at runtime) but only once (at load time), you probably shouldn't worry about it.</p>      <h2 id="webkit-displayName">WebKit's displayName</h2>      <p>A somewhat different approach was taken by WebKit team. Frustrated with poor representation of functions &mdash; both, anonymous and named &mdash; WebKit introduced "special" <code>displayName</code> property (essentially a string) that when assigned to a function is displayed in debugger/profiler in place of that function's "name". <a href="http://www.alertdebugging.com/2009/04/29/building-a-better-javascript-profiler-with-webkit/">Francisco Tolmasky explains in details</a> the rationale and implementation of this solution.</p>      <h2 id="future-considerations">Future considerations</h2>      <p>Upcoming version of ECMAScript &mdash; <a title= "Standard ECMA-262" href="http://www.ecma-international.org/publications/standards/Ecma-262.htm">ECMA-262, 5th edition</a> &mdash; introduces so-called <strong>strict mode</strong>. The purpose of strict mode is to disallow certain parts of the language which are considered to be fragile, unreliable or dangerous. One of such parts is <code>arguments.callee</code>, "banned" presumably due to security concerns. When in strict mode, access to <code>arguments.callee</code> results in <code>TypeError</code> (see section 10.6). The reason I'm bringing up strict mode is because inability to use <code>arguments.callee</code> for recursion in 5th edition will most likely result in increased use of named function expressions. Understanding their semantics and bugs will become even more important.</p><div class="highlight"><pre><code data-lang="js" class="language-js"><span class="c1">// Before, you could use arguments.callee </span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">x</span><span class="p">)</span> <span class="p">{</span>  <span class="k">if</span> <span class="p">(</span><span class="nx">x</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">)</span> <span class="k">return</span> <span class="mi">1 </span><span class="p">;</span>  <span class="k">return</span> <span class="nx">x</span> <span class="o">*</span> <span class="nx">arguments</span><span class="p">.</span><span class="nx"> callee</span><span class="p">(</span><span class="nx">x</span> <span class="o">-</span> <span class="mi">1</span><span class="p">);</span><span class="p">})(</span><span class="mi">10 </span><span class="p">);</span><span class="c1">// In strict mode, an alternative solution is to use named function expression</span><span class="p">(</span><span class="kd">function </span> <span class="nx">factorial</span><span class="p">(</span><span class="nx">x</span><span class="p">)</span> <span class="p">{</span>  <span class="k">if</span> <span class="p">( </span><span class="nx">x</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">)</span> <span class="k">return</span> <span class="mi">1</span><span class="p">; </span>  <span class="k">return</span> <span class="nx">x</span> <span class="o">*</span> <span class="nx">factorial</span><span class="p">(</span><span class="nx">x</span> <span class="o" >-</span> <span class="mi">1</span><span class="p">);</span><span class="p">})(</span><span class="mi">10</span><span class="p">);</span><span class="c1">// or just fall back to slightly less flexible function declaration</span><span class="kd">function</span> <span class="nx">factorial</span><span class="p">(</span><span class="nx">x</span><span class="p">)</span> <span class="p">{</span>  <span class="k">if</span> <span class="p">(</span><span class="nx">x</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">)</span> <span class= "k">return</span> <span class="mi">1</span><span class="p">;</span>  <span class="k">return</span> <span class="nx">x</span> <span class="o">*</span> <span class="nx">factorial</span><span class="p">(</span><span class="nx">x</span> <span class="o">-</span> <span class="mi">1</span><span class="p">);</span><span class="p">}</span><span class="nx">factorial</span><span class ="p">(</span><span class="mi">10</span><span class="p">);</span></code></pre></div>      <h2 id="credits">Credits</h2>      <p><strong><em>Richard Cornford</em></strong>, for being one of the first people <a href="http://groups.google.com/group/comp.lang.javascript/msg/5b508b03b004bce8">to explain JScript bug with named function expressions</a>. Richard explains most of the bugs mentioned in this article. I highly recommend reading his explanation. I would also like to thank <strong><em>Yann-Erwan Perio</em></strong> and <strong><em>Douglas Crockford </em></strong> for <a href="http://groups.google.com/group/comp.lang.javascript/msg/03d53d114d176323">mentioning and discussing NFE issues in comp.lang.javascript</a> as far back as in 2003.</p>      <p><strong><em>John-David Dalton</em></strong>, for giving useful suggestions about "final solution".</p>      <p><strong><em>Tobie Langel</em></strong>, for ideas presented in "alternative solution".</p>      <p><strong><em>Garrett Smith</em></strong> and <strong><em>Dmitry A. Soshnikov</em></strong> for various additions and corrections.</p> <p>For an extensive explanation of functions in ECMAScript in Russian, see <a href="http://dmitrysoshnikov.com/ecmascript/ru-chapter-5-functions/">this article by Dmitry A. Soshnikov</a>. </p>      <div class="footer clearfix">        <div class="row">          <div class="col-md-7">            <p class="bg-info">              Have suggestions or corrections? Feel free to <a href="http://perfectionkills.com/named-function-expressions-demystified/">comment on a blog post</a>              or <a href="mailto:kangax@gmail.com">drop me an email</a> .              <br>              This <a title="this article on GitHub" href="https://github.com/kangax/nfe">article is also versioned on GitHub</a>, where you can track its changes.            </p>          </div>          <div class="col-md-4 col-md-offset-1 footer-right">            <p>              Created: <span class="bg-info"><strong>June 17, 2009 </strong></span> Last modified: <span class="bg-info"><strong>August 04, 2014</strong></span>            </p>          </div>        </div>      </div>    </div>			</div> <!--=========================			END : POST		=============================-->		<!--=========================			START : POST =============================-->		<div class="post-wrapper">		<h1>JavaScript Prototype Chains, Scope Chains, and Performance: What You Need to Know</h1>		<div data-view= "content#body" data-subscribe="true" class="content_body"><h2 id="javascript--more-than-meets-the-eye">JavaScript:  More than meets the eye</h2><p>JavaScript can seem like a very easy language to learn at first.  Perhaps it's because of its flexible syntax.  Or perhaps it's because of its similarity to other well known languages like Java.  Or perhaps it's because it has so few data types in comparison to languages like Java, Ruby, or .NET.</p><p>But in truth, JavaScript is much less simplistic and more nuanced than most developers initially realize. Even for <a href="http://www.toptal.com/javascript">developers with more experience</a>, some of JavaScript's most salient features continue to be misunderstood and lead to confusion. One such feature is the way that data (property and variable) lookups are performed and the JavaScript performance ramifications to be aware of.</p><p>In JavaScript, data lookups are governed by two things:  <em>prototypal inheritance</em> and <em>scope chain</em>.  As a developer, clearly understanding these two mechanisms is essential, since doing so can improve the structure, and often the performance, of your code.</p><h2 id="property-lookups-through-the-prototype-chain">Property lookups through the prototype chain</h2><p>When accessing a property in a prototype-based language like JavaScript, a dynamic lookup takes places that involves different layers within the object's prototypal tree.</p><p>In JavaScript, every function is an object. When a function is invoked with the <code>new</code> operator, a new object is created.  For example:</p><pre><code class=" hljs javascript"><span class="hljs-function"><span class ="hljs-keyword">function</span> <span class="hljs-title">Person</span><span class="hljs-params">(firstName, lastName)</span> {</span>  <span class="hljs-keyword">this</span>.firstName = firstName;  <span class="hljs-keyword">this</span>.lastName = lastName;}<span class="hljs-keyword">var</span> p1 = <span class="hljs-keyword">new</span> Person(<span class="hljs-string"> 'John'</span>, <span class="hljs-string">'Doe'</span>);<span class="hljs-keyword">var</span> p2 = <span class="hljs-keyword">new</span> Person(<span class="hljs-string">'Robert'</span>, <span class="hljs-string">'Doe'</span>);</code></pre><p>In the above example, <code>p1</code> and <code>p2</code> are two different objects, each created using the <code>Person</code> function as a constructor.  They are independent instances of <code>Person</code>, as demonstrated by this code snippet:</p><pre><code class=" hljs coffeescript"><span class= "hljs-built_in">console</span>.log(p1 <span class="hljs-keyword">instanceof</span> Person); <span class="hljs-regexp">//</span> prints <span class="hljs-string">'true'</span><span class= "hljs-built_in">console</span>.log(p2 <span class="hljs-keyword">instanceof</span> Person); <span class="hljs-regexp">//</span> prints <span class="hljs-string">'true'</span><span class= "hljs-built_in">console</span>.log(p1 === p2);            <span class="hljs-regexp">//</span> prints <span class="hljs-string">'false'</span></code></pre><p>Since JavaScript functions are objects, they can have properties.  A particularly important property that each function has is called <code>prototype</code>.</p><p><code>prototype</code>, which is itself an object, inherits from its parent's prototype, which inherits from its parent's prototype, and and so on.  This is often referred to as the <em>prototype chain</em>.  <code>Object.prototype</code> , which is always at the end of the prototype chain (i.e., at the top of the prototypal inheritance tree), contains methods like <code>toString()</code>, <code>hasProperty()</code>, <code> isPrototypeOf()</code>, and so on.</p><p><img alt="The relationship between JavaScript prototype and the scope chain is important" src=" http://assets.toptal.io/uploads/blog/image/392/toptal-blog-image-1399822383211.png"></p><p>Each function's prototype can be extended to define its own custom methods and properties.</p><p> When you instantiate an object (by invoking the function using the <code>new</code> operator), it inherits all the properties in the prototype of that function.  Keep in mind, though, that those instances will not have direct access to the <code>prototype</code> object but only to its properties.  For example:</p><pre><code class=" hljs perl">// Extending the Person <span class="hljs-keyword">prototype</span> from <span class="hljs-keyword">our</span> earlier example to// also include a <span class="hljs-string">'getFullName'</span> method:Person. <span class="hljs-keyword">prototype</span>.getFullName = function() {  <span class="hljs-keyword">return</span> this.firstName + <span class="hljs-string">' '</span> + this.lastName;}// Referencing the p1 object from <span class="hljs-keyword">our</span> earlier exampleconsole.<span class="hljs-keyword">log</span>(p1.getFullName());            <span class="hljs-regexp">// </span> prints <span class="hljs-string">'John Doe'</span>// but p1 can't directly access the <span class="hljs-string">'prototype'</span> object...console.<span class="hljs-keyword">log </span>(p1.<span class="hljs-keyword">prototype</span>);                <span class="hljs-regexp">//</span> prints <span class="hljs-string">'undefined'</span>console.<span class= "hljs-keyword">log</span>(p1.<span class="hljs-keyword">prototype</span>.getFullName());  <span class="hljs-regexp">//</span> generates an error</code></pre><p>There's an important and somewhat subtle point here:  Even if <code>p1</code> was created before the <code>getFullName</code> method was defined, it will still have access to it because its prototype is the <code> Person</code> prototype.</p><p>(It is worth noting that browsers also store a reference to the prototype of any object in a <code>__proto__</code> property, but it's <strong>really bad practice</strong> to directly access the prototype via the <code>__proto__</code> property, since it's not part of the standard <a href="http://www.ecma-international.org/ecma-262/5.1/" target="_blank">ECMAScript Language Specification</a>, <em>so don't do it!</em>)</p><p>Since the <code>p1</code> instance of the <code>Person</code> object doesn't itself have direct access to the <code>prototype</code> object, if we want overwrite <code>getFullName</code> in <code>p1</code>, we would do so as follows:</p><pre><code class=" hljs javascript"><span class ="hljs-comment">// We reference p1.getFullName, *NOT* p1.prototype.getFullName,</span><span class="hljs-comment">// since p1.prototype does not exist:</span>p1.getFullName = <span class= "hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span>{</span>  <span class="hljs-keyword">return</span> <span class="hljs-string">'I am anonymous' </span>;}</code></pre><p>Now <code>p1</code> has its own <code>getFullName</code> property.  But the <code>p2</code> instance (created in our earlier example) does <em>not</em> have any such property of its own. Therefore, invoking <code>p1.getFullName()</code> accesses the <code>getFullName</code> method of the <code>p1</code> instance itself, while invoking <code> p2.getFullName()</code> goes up the prototype chain to the <code>Person</code> prototype object to resolve <code>getFullName</code>:</p><pre><code class=" hljs ruby"> console.log(p1.getFullName()); <span class="hljs-regexp">//</span> prints <span class="hljs-string">'I am anonymous'</span>console.log(p2.getFullName()); <span class="hljs-regexp">// </span> prints <span class="hljs-string">'Robert Doe'</span></code></pre><p><img alt="See how P1 and P2 relate to the Person prototype in this JavaScript prototype example." src=" http://assets.toptal.io/uploads/blog/image/385/toptal-blog-image-1398995950007.png"></p><p>Another important thing to be aware of is that it's also possible to <em>dynamically</em> change an object's prototype.  For example:</p><pre><code class=" hljs javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Parent </span><span class="hljs-params">()</span> {</span>  <span class="hljs-keyword">this</span>.someVar = <span class="hljs-string">'someValue'</span>;};<span class="hljs-comment">// extend Parent's prototype to define a 'sayHello' method</span>Parent.prototype.sayHello = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>    console.log(<span class="hljs-string">'Hello'</span>);};<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Child</span><span class= "hljs-params">()</span>{</span>  <span class="hljs-comment">// this makes sure that the parent's constructor is called and that</span>  <span class="hljs-comment">// any state is initialized correctly. </span>  Parent.call(<span class="hljs-keyword">this</span>);};<span class="hljs-comment">// extend Child's prototype to define an 'otherVar' property...</span> Child.prototype.otherVar = <span class="hljs-string">'otherValue'</span>;<span class="hljs-comment">// ... but then set the Child's prototype to the Parent prototype</span><span class= "hljs-comment">// (whose prototype doesn't have any 'otherVar' property defined,</span><span class="hljs-comment">//  so the Child prototype no longer has ‘otherVar' defined!)</span> Child.prototype = <span class="hljs-built_in">Object</span>.create(Parent.prototype);<span class="hljs-keyword">var</span> child = <span class="hljs-keyword">new</span> Child();child.sayHello();            <span class="hljs-comment">// prints 'Hello'</span>console.log(child.someVar);  <span class="hljs-comment">// prints 'someValue'</span> console.log(child.otherVar); <span class="hljs-comment">// prints 'undefined' </span></code></pre><p>When using prototypal inheritance, remember to define properties in the prototype <em> after</em> having either inherited from the parent class or specified an alternate prototype.</p><p><img alt="This diagram shows an example of the relationship between JavaScript prototypes in a prototype chain." src="http://assets.toptal.io/uploads/blog/image/386/toptal-blog-image-1398996926565.png"></p><p><strong>To summarize, property lookups through the JavaScript prototype chain work as follows:</strong></p><ul>  <li>If the object has a property with the given name, that value is returned.  (The <a href=" https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/hasOwnProperty" target="_blank"><code>hasOwnProperty</code></a> method can be used to check if an object has a particular named property.)</li>  <li>If the object does not have the named property, the object's prototype is checked</li>  <li>Since the prototype is an object as well, if it does not contain the property either, its parent's prototype is checked.</li>  <li>This process continues up the prototype chain until the property is found.</li>  <li>If <code> Object.prototype</code> is reached and it does not have the property either, the property is considered <code>undefined</code>.</li></ul><p>Understanding how prototypal inheritance and property lookups work is important in general for developers but is also essential because of its (sometimes significant) JavaScript performance ramifications.  As mentioned in the documentation for <a href="https://developers.google.com/v8/design#prop_access" target="_blank">V8</a> (Google's open source, high performance JavaScript engine), most JavaScript engines use a dictionary-like data structure to store object properties.  Each property access therefore requires a dynamic look-up in that data structure to resolve the property.  This approach makes accessing properties in JavaScript typically much slower than accessing instance variables in programming languages like Java and Smalltalk.</p><h2 id= "variable-lookups-through-the-scope-chain">Variable lookups through the scope chain</h2><p>Another lookup mechanism in JavaScript is based on scope.</p><p>To understand how this works, it's necessary to introduce the concept of <a href="http://davidshariff.com/blog/what-is-the-execution-context-in-javascript/" target="_blank">execution context</a>.</p><p>In JavaScript, there are two types of execution contexts:</p><ul>  <li>Global context, created when a JavaScript process is launched</li>  <li>Local context, created when a function is invoked </li></ul><p>Execution contexts are organized into a stack.  At the bottom of the stack, there is always the global context, that is unique for each JavaScript program.  Each time a function is encountered, a new execution context is created and pushed onto the top of the stack.  Once the function has finished executing, its context is popped off the stack.</p><p> Consider the following code:</p><pre><code class=" hljs javascript"><span class="hljs-comment">// global context</span><span class="hljs-keyword">var</span> message = <span class= "hljs-string">'Hello World'</span>;<span class="hljs-keyword">var</span> sayHello = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(n) </span>{</span>  <span class="hljs-comment">// local context 1 created and pushed onto context stack</span>  <span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; <span class="hljs-keyword">var</span> innerSayHello = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>    <span class= "hljs-comment">// local context 2 created and pushed onto context stack</span>    console.log((i + <span class="hljs-number">1</span>) + <span class="hljs-string">':  '</span> + message);    <span class="hljs-comment">// local context 2 popped off of context stack</span>  }  <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; n; i++) {    innerSayHello();  }  <span class="hljs-comment">// local context 1 popped off of context stack</span>};sayHello(<span class="hljs-number">3</span>);<span class="hljs-comment">// Prints:</span><span class="hljs-comment">// 1:  Hello World</span><span class="hljs-comment">// 2:  Hello World</span><span class="hljs-comment">// 3:  Hello World</span></code></pre><p> Within each execution context is a special object called a <em>scope chain</em> which is used to resolve variables.  A scope chain is essentially a stack of currently accessible scopes, from the most immediate context to the global context.  (To be a bit more precise, the object at the top of the stack is called an <em>Activation Object</em> which contains references to the local variables for the function being executed, the named function arguments, and two "special" objects: <code>this</code> and <code>arguments</code>.)  For example:</p><p><img alt= "The way the scope chain relates to the objects is outlined in this JavaScript example." src="http://assets.toptal.io/uploads/blog/image/387/toptal-blog-image-1398997067365.png"></p><p> Note in the above diagram how <code>this</code> points to the <code>window</code> object by default and also how the global context contains examples of other objects such as <code>console </code> and <code>location</code>.</p><p>When attempting to resolve variables via the scope chain, the immediate context is first checked for a matching variable.  If no match is found, the next context object in the scope chain is checked, and so on, until a match is found.  If no match is found, a <code>ReferenceError</code> is thrown.</p><p>It is important to also note that a new scope is added to the scope chain when a <code>try-catch</code> block or a <code>with</code> block is encountered.  In either of these cases, a new object is created and placed at top of the scope chain:</p><pre><code class=" hljs coffeescript"><span class="hljs-reserved">function</span> Person(firstName, lastName) {    <span class="hljs-keyword">this </span>.firstName = firstName;    <span class="hljs-keyword">this</span>.lastName = lastName;};<span class="hljs-reserved">function</span> persist(person) {  <span class="hljs-reserved"> with</span> (person) {    <span class="hljs-regexp">//</span> The <span class="hljs-string">'person'</span> object was pushed onto the scope chain <span class="hljs-keyword">when</span> we    <span class="hljs-regexp">//</span> entered <span class="hljs-keyword">this</span> <span class="hljs-string">"with"</span> block, so we can simply reference    <span class= "hljs-regexp">//</span> <span class="hljs-string">'firstName'</span> <span class="hljs-keyword">and</span> <span class="hljs-string">'lastName'</span>, rather than person.firstName <span class="hljs-keyword">and</span>    <span class="hljs-regexp">//</span> person.lastName    <span class="hljs-keyword">if</span> (!firstName) {      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> Error(<span class="hljs-string">'FirstName is mandatory'</span>);    }    <span class="hljs-keyword">if</span> (!lastName) {      <span class= "hljs-keyword">throw</span> <span class="hljs-keyword">new</span> Error(<span class="hljs-string">'LastName is mandatory'</span>);    }  }  <span class="hljs-keyword">try</span> { person.save();  } <span class="hljs-keyword">catch</span>(error) {    <span class="hljs-regexp">//</span> A <span class="hljs-keyword">new</span> scope containing the <span class= "hljs-string">'error'</span> object <span class="hljs-keyword">is</span> accessible here    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'Impossible to store ' </span> + person + <span class="hljs-string">', Reason: '</span> + error);  }}<span class="hljs-reserved">var</span> p1 = <span class="hljs-keyword">new</span> Person(<span class= "hljs-string">'John'</span>, <span class="hljs-string">'Doe'</span>);persist(p1);</code></pre><p>To fully understand how scope-based variable lookups occur, it is important to keep in mind that in JavaScript there are currently no block-level scopes.  For example:</p><pre><code class=" hljs r"><span class="hljs-keyword">for</span> (var i = <span class="hljs-number">0 </span>; i &lt; <span class="hljs-number">10</span>; i++) {  /* <span class="hljs-keyword">...</span> */}// <span class="hljs-string">'i'</span> is still <span class="hljs-keyword">in </span> scope!console.log(i);  // prints <span class="hljs-string">'10'</span></code></pre><p>In most other languages, the code above would lead to an error because the "life" (i.e., scope) of the variable <code>i</code> would be restricted to the for block.  In JavaScript, though, this is not the case.  Rather, <code>i</code> is added to the activation object at the top of the scope chain and it will stay there until that object is removed from the scope, which happens when the corresponding execution context is removed from the stack. This behavior is known as variable hoisting.</p><p>It is worth noting, though, that support for block-level scopes is making its way into JavaScript through the new <a href=" https://developer.mozilla.org/en-US/docs/Web/JavaScript/New_in_JavaScript/1.7#Block_scope_with_let_%28Merge_into_let_Statement%29" target="_blank"><code>let</code></a> keyword.  The <code> let</code> keyword is already available in JavaScript 1.7 and is slated to become an officially supported JavaScript keyword as of ECMAScript 6.</p><h2 id= "javascript-performance-ramifications">JavaScript Performance Ramifications</h2><p>The way that property and variable lookups, using prototype chain and scope chain respectively, work in JavaScript is one of the language's key features, yet it is one of the trickiest and most subtle to understand.</p><p>The lookup operations we've described in this example, whether based on the prototype chain or the scope chain, are repeated <em>every</em> time a property or variable is accessed.  When this lookup occurs within loops or other intensive operations, it can have significant JavaScript performance ramifications, especially in light of the single-threaded nature of the language which prevents multiple operations from happening concurrently. </p><p>Consider the following example:</p><pre><code class=" hljs javascript"><span class="hljs-keyword">var</span> start = <span class="hljs-keyword">new</span> <span class= "hljs-built_in">Date</span>().getTime();<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Parent</span><span class="hljs-params">()</span> { </span> <span class="hljs-keyword">this</span>.delta = <span class="hljs-number">10</span>; };<span class="hljs-function"><span class="hljs-keyword">function</span> <span class= "hljs-title">ChildA</span><span class="hljs-params">()</span>{</span>};ChildA.prototype = <span class="hljs-keyword">new</span> Parent();<span class="hljs-function"><span class= "hljs-keyword">function</span> <span class="hljs-title">ChildB</span><span class="hljs-params">()</span>{</span>}ChildB.prototype = <span class="hljs-keyword">new</span> ChildA();<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">ChildC</span><span class="hljs-params">()</span>{</span>}ChildC.prototype = <span class= "hljs-keyword">new</span> ChildB();<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">ChildD</span><span class="hljs-params">()</span>{</span> };ChildD.prototype = <span class="hljs-keyword">new</span> ChildC();<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">ChildE</span><span class ="hljs-params">()</span>{</span>};ChildE.prototype = <span class="hljs-keyword">new</span> ChildD();<span class="hljs-function"><span class="hljs-keyword">function</span> <span class= "hljs-title">nestedFn</span><span class="hljs-params">()</span> {</span>  <span class="hljs-keyword">var</span> child = <span class="hljs-keyword">new</span> ChildE();  <span class= "hljs-keyword">var</span> counter = <span class="hljs-number">0</span>;  <span class="hljs-keyword">for</span>(<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span> ; i &lt; <span class="hljs-number">1000</span>; i++) {    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">var</span> j = <span class="hljs-number">0</span>; j &lt; <span class="hljs-number">1000</span>; j++) {      <span class="hljs-keyword">for</span>(<span class="hljs-keyword">var</span> k = <span class="hljs-number">0</span>; k &lt; <span class= "hljs-number">1000</span>; k++) {        counter += child.delta;      }    }  }  console.log(<span class="hljs-string">'Final result: '</span> + counter);}nestedFn();<span class= "hljs-keyword">var</span> end = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>().getTime();<span class="hljs-keyword">var</span> diff = end - start;console.log(<span class="hljs-string">'Total time: '</span> + diff + <span class="hljs-string">' milliseconds'</span>);</code></pre><p>In this example, we have a long inheritance tree and three nested loops.  Inside the deepest loop, the counter variable is incremented with the value of <code>delta</code>.  But <code>delta</code> is located almost at the top of the inheritance tree! <em>This means that each time <code>child.delta</code> is accessed, the full tree needs to be navigated from bottom to top.</em>  This can have a really negative impact on performance.</p><p>Understanding this, we can easily improve performance of the above <code>nestedFn</code> function by using a local <code>delta</code> variable to cache the value in <code>child.delta</code> (and thereby avoid the need for repetitive traversal of the entire inheritance tree) as follows:</p><pre><code class=" hljs javascript"><span class= "hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">nestedFn</span><span class="hljs-params">()</span> {</span>  <span class="hljs-keyword">var</span> child = <span class="hljs-keyword">new</span> ChildE();  <span class="hljs-keyword">var</span> counter = <span class="hljs-number">0</span>;  <span class="hljs-keyword">var</span> delta = child.delta;  <span class="hljs-comment">// cache child.delta value in current scope</span>  <span class="hljs-keyword">for</span>(<span class="hljs-keyword">var</span> i = <span class= "hljs-number">0</span>; i &lt; <span class="hljs-number">1000</span>; i++) {    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">var</span> j = <span class="hljs-number">0 </span>; j &lt; <span class="hljs-number">1000</span>; j++) {      <span class="hljs-keyword">for</span>(<span class="hljs-keyword">var</span> k = <span class="hljs-number">0</span>; k &lt; <span class="hljs-number">1000</span>; k++) {        counter += delta;  <span class="hljs-comment">// no inheritance tree traversal needed!</span>      }    }  }  console.log(<span class="hljs-string">'Final result: '</span> + counter);}nestedFn();<span class="hljs-keyword">var</span> end = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span> ().getTime();<span class="hljs-keyword">var</span> diff = end - start;console.log(<span class="hljs-string">'Total time: '</span> + diff + <span class="hljs-string">' milliseconds'</span> );</code></pre><p>Of course, this particular technique is only viable in a scenario where it is known that the value of <code>child.delta</code> won't change while the for loops are executing; otherwise, the local copy would need to be updated with the current value.</p><p>OK, let's run both versions of the <code>nestedFn</code> method and see if there is any appreciable performance difference between the two.</p><p>We'll start by running the first example in a <a href="http://nodejs.org/api/repl.html" target="_blank">node.js REPL</a>: </p><pre><code class=" hljs ruby">diego<span class="hljs-variable">@alkadia</span><span class="hljs-symbol">:~</span><span class="hljs-variable">$ </span>node test.js <span class= "hljs-constant">Final</span> <span class="hljs-symbol">result:</span> <span class="hljs-number">10000000000</span><span class="hljs-constant">Total</span> <span class="hljs-symbol">time: </span> <span class="hljs-number">8270</span> milliseconds</code></pre><p>So that takes about 8 seconds to run.  That's a long time.</p><p>Now let's see what happens when we run the optimized version:</p><pre><code class=" hljs ruby">diego<span class="hljs-variable">@alkadia</span><span class="hljs-symbol">:~</span><span class="hljs-variable">$ </span>node test2.js <span class="hljs-constant">Final</span> <span class="hljs-symbol">result:</span> <span class="hljs-number">10000000000</span><span class="hljs-constant">Total</span> <span class= "hljs-symbol">time:</span> <span class="hljs-number">1143</span> milliseconds</code></pre><p>This time it took just one second.  Much faster!</p><p>Note that use of local variables to avoid expensive lookups is a technique that can be applied both for property lookup (via the prototype chain) and for variable lookups (via the scope chain).</p><p>Moreover, this type of "caching" of values (i.e., in variables in the local scope) can also be beneficial when using some of the most common JavaScript libraries.  Take <a href="http://jquery.com/" target= "_blank">jQuery</a>, for example.  jQuery supports the notion of "selectors", which are basically a mechanism for retrieving one or more matching elements in the <a href=" http://en.wikipedia.org/wiki/Document_Object_Model" target="_blank">DOM</a>.  The ease with which one can specify selectors in jQuery can cause one to forget how costly (from a performance standpoint) each selector lookup can be.  Accordingly, storing selector lookup results in a local variable can be extremely beneficial to performance.  For example: </p><pre><code class=" hljs php"><span class="hljs-comment">// this does the DOM search for $('.container') "n" times</span><span class="hljs-keyword">for</span> (<span class= "hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; n; i++) {    $(<span class="hljs-string">'.container'</span>).append("Line "+i+"&lt;br /&gt;");}<span class= "hljs-comment">// this accomplishes the same thing...</span><span class="hljs-comment">// but only does the DOM search for $('.container') once,</span><span class="hljs-comment">// although it does still modify the DOM "n" times</span><span class="hljs-keyword">var</span> <span class="hljs-variable">$container</span> = $(<span class="hljs-string">'.container'</span> );<span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; n; i++) {    <span class="hljs-variable">$container</span> .append(<span class="hljs-string">"Line "</span>+i+<span class="hljs-string">"&lt;br /&gt;"</span>);}<span class="hljs-comment">// or even better yet...</span><span class="hljs-comment"> // this version only does the DOM search for $('.container') once</span><span class="hljs-comment">// AND only modifies the DOM once</span><span class="hljs-keyword">var</span> <span class ="hljs-variable">$html</span> = <span class="hljs-string">''</span>;<span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; n; i++) {    <span class="hljs-variable">$html</span> += <span class="hljs-string">'Line '</span> + i + <span class="hljs-string">'&lt;br /&gt;'</span>;}$(<span class="hljs-string"> '.container'</span>).append(<span class="hljs-variable">$html</span>);</code></pre><p>Especially on a web page with a large number of elements, the second approach in the code sample above can potentially result in significantly better performance than the first.</p><h2 id="wrap-up">Wrap-up</h2><p>Data lookup in JavaScript is quite different than it is in most other languages, and it is highly nuanced.  It is therefore essential to fully and properly understand these concepts in order to truly master the language. Data lookup and <a href=" http://www.toptal.com/javascript/10-most-common-javascript-mistakes">other common JavaScript mistakes</a> should be avoided whenever possible. This understanding is likely to yield cleaner, more robust code that achieves improved JavaScript performance.</p><div class="post-join"><a href="/javascript" class="button is-white_and_green is-default is-full_width">Hiring? Meet the Top 10 JavaScript Developers for Hire in September 2015</a></div></div>			</div>		<!--=========================			END : POST =============================-->		<!--=========================			START : POST		=============================-->		<div class="post-wrapper">		<h1></h1> <div class="comparisons">      <div class="empty-message">Your search didn't match any comparisons.</div>      <section id="ajax" class="odd">        <div class="inner">          <h2>AJAX </h2>          <div class="alternatives-block">            <h4>Alternatives:</h4>            <ul class="alternatives">              <li><a href=" https://github.com/ForbesLindesay/ajax" target="_blank">ajax</a></li>              <li><a href=" https://github.com/then/request" target="_blank">request</a></li>              <li><a href=" https://github.com/ded/Reqwest" target ="_blank">reqwest</a></li>            </ul>          </div>          <div id="json" class="comparison">            <h3><a href="#json">JSON</a></h3>            <div data-browser="jquery" class="browser jquery">              <h4>jQuery</h4>              <div data-lang="javascript" class="code-block language-javascript">                <pre class=" language-javascript"><code class=" language-javascript">$<span class="token punctuation">.</span><span class="token function">getJSON<span class="token punctuation">(</span></span><span class="token string"> '/my/url'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre> </div>            </div>            <div data-browser="ie8" class="browser ie8">              <h4>IE8+</h4>              <div data-lang="javascript" class="code-block language-javascript"> <pre class=" language-javascript"><code class=" language-javascript"><span class="token keyword">var</span> request <span class="token operator">=</span> <span class= "token keyword">new</span> <span class="token class-name">XMLHttpRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>request<span class="token punctuation">.</span><span class="token function">open<span class="token punctuation">(</span></span><span class="token string">'GET' </span><span class="token punctuation">,</span> <span class="token string">'/my/url'</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class= "token punctuation">)</span><span class="token punctuation">;</span>request<span class="token punctuation">.</span>onreadystatechange <span class="token operator">=</span> <span class= "token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token keyword">if </span> <span class="token punctuation">(</span>this<span class="token punctuation">.</span>readyState <span class="token operator">===</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>this<span class="token punctuation">.</span>status <span class="token operator">&gt;=</span> <span class="token number">200</span> <span class="token operator">&amp;&amp;</span> this<span class="token punctuation">.</span>status <span class="token operator">&lt;</span> <span class="token number">400</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment" spellcheck="true"> // Success!</span>      <span class="token keyword">var</span> data <span class="token operator">=</span> JSON<span class="token punctuation">.</span><span class="token function">parse<span class="token punctuation">(</span></span>this<span class="token punctuation">.</span>responseText<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span> <span class="token comment" spellcheck="true"> // Error :(</span>    <span class="token punctuation">}</span>  <span class="token punctuation">}</span><span class="token punctuation"> }</span><span class="token punctuation">;</span>request<span class="token punctuation">.</span><span class="token function">send<span class="token punctuation">(</span></span><span class= "token punctuation">)</span><span class="token punctuation">;</span>request <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">; </span></code></pre>              </div>            </div>            <div data-browser="ie9" class="browser ie9" >              <h4>IE9+</h4>              <div data-lang="javascript" class="code-block language-javascript">                <pre class=" language-javascript"><code class=" language-javascript"><span class="token keyword">var</span> request <span class= "token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">XMLHttpRequest</span><span class="token punctuation">(</span><span class="token punctuation" >)</span><span class="token punctuation">;</span>request<span class="token punctuation">.</span><span class="token function">open<span class="token punctuation">(</span></span><span class= "token string">'GET'</span><span class="token punctuation">,</span> <span class="token string">'/my/url'</span><span class="token punctuation">,</span> <span class="token boolean">true </span><span class="token punctuation">)</span><span class="token punctuation">;</span>request<span class="token punctuation">.</span>onload <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token keyword"> if</span> <span class="token punctuation">(</span>request<span class="token punctuation">.</span>status <span class="token operator">&gt;=</span> <span class="token number">200</span> <span class="token operator">&amp;&amp;</span> request<span class="token punctuation">.</span>status <span class="token operator">&lt;</span> <span class="token number">400</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>   <span class="token comment" spellcheck="true"> // Success!</span>    <span class="token keyword">var</span> data <span class="token operator">=</span> JSON<span class="token punctuation">.</span><span class="token function">parse<span class="token punctuation">(</span></span>request<span class= "token punctuation">.</span>responseText<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>   <span class="token comment" spellcheck="true"> // We reached our target server, but it returned an error</span>  <span class ="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">;</span>request<span class="token punctuation">.</span>onerror <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment" spellcheck="true"> // There was a connection error of some sort</span><span class="token punctuation">}</span><span class="token punctuation">;</span>request <span class="token punctuation">.</span><span class="token function">send<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>              </div>            </div>            <div data-browser="ie10" class="browser ie10" >              <h4>IE10+</h4>              <div data-lang= "javascript" class="code-block language-javascript">                <pre class=" language-javascript"><code class=" language-javascript"><span class="token keyword">var</span> request <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">XMLHttpRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>request<span class="token punctuation">.</span><span class="token function">open<span class="token punctuation">( </span></span><span class="token string">'GET'</span><span class="token punctuation">,</span> <span class="token string">'/my/url'</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>request<span class="token punctuation">.</span>onload <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>this<span class="token punctuation">.</span>status <span class="token operator">&gt;=</span> <span class= "token number">200</span> <span class="token operator">&amp;&amp;</span> this<span class="token punctuation">.</span>status <span class="token operator">&lt;</span> <span class="token number">400</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>   <span class="token comment" spellcheck="true"> // Success!</span>    <span class= "token keyword">var</span> data <span class="token operator">=</span> JSON<span class="token punctuation">.</span><span class="token function">parse<span class="token punctuation">( </span></span>this<span class="token punctuation">.</span>response<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>   <span class="token comment" spellcheck="true"> // We reached our target server, but it returned an error </span>  <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">;</span>request<span class="token punctuation">.</span>onerror <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment" spellcheck="true"> // There was a connection error of some sort</span><span class="token punctuation">}</span><span class="token punctuation">;</span>request<span class="token punctuation">.</span><span class="token function">send<span class="token punctuation">(</span></span><span class="token punctuation">) </span><span class="token punctuation">;</span></code></pre>              </div>            </div>          </div>          <div id="post" class="comparison">            <h3><a href= "#post">Post</a></h3>            <div data-browser="jquery" class="browser jquery">              <h4>jQuery</h4>              <div data-lang="javascript" class="code-block language-javascript">                <pre class=" language-javascript"><code class=" language-javascript">$<span class="token punctuation">.</span><span class="token function">ajax<span class="token punctuation">(</span></span><span class="token punctuation">{</span>  type<span class="token punctuation">:</span> <span class="token string">'POST'</span><span class="token punctuation">,</span>  url<span class="token punctuation">:</span> <span class="token string">'/my/url'</span><span class="token punctuation">,</span>  data<span class="token punctuation"> :</span> data<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>              </div>            </div> <div data-browser="ie8" class="browser ie8">              <h4>IE8+</h4>              <div data-lang="javascript" class="code-block language-javascript">                <pre class=" language-javascript"><code class=" language-javascript"><span class="token keyword">var</span> request <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">XMLHttpRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>request<span class="token punctuation">.</span><span class="token function">open<span class="token punctuation">(</span></span><span class="token string">'POST'</span><span class="token punctuation">, </span> <span class="token string">'/my/url'</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class= "token punctuation">;</span>request<span class="token punctuation">.</span><span class="token function">setRequestHeader<span class="token punctuation">(</span></span><span class="token string">'Content-Type'</span><span class="token punctuation">,</span> <span class="token string">'application/x-www-form-urlencoded; charset=UTF-8'</span><span class="token punctuation">) </span><span class="token punctuation">;</span>request<span class="token punctuation">.</span><span class="token function">send<span class="token punctuation">(</span></span>data<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>              </div>            </div>          </div>          <div id="request" class="comparison"> <h3><a href="#request">Request</a></h3>            <div data-browser="jquery" class="browser jquery">              <h4>jQuery</h4>              <div data-lang="javascript" class="code-block language-javascript">                <pre class=" language-javascript"><code class=" language-javascript">$<span class="token punctuation">.</span><span class="token function">ajax<span class="token punctuation">(</span></span><span class="token punctuation">{</span>  type<span class="token punctuation">:</span> <span class="token string">'GET' </span><span class="token punctuation">,</span>  url<span class="token punctuation">:</span> <span class="token string">'/my/url'</span><span class="token punctuation">,</span>  success <span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span>resp<span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token punctuation">}</span><span class="token punctuation">,</span>  error<span class="token punctuation">:</span> <span class="token keyword">function </span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token punctuation">}</span><span class= "token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>              </div>            </div>            <div data-browser ="ie8" class="browser ie8">              <h4>IE8+</h4>              <div data-lang="javascript" class="code-block language-javascript">                <pre class=" language-javascript" ><code class=" language-javascript"><span class="token keyword">var</span> request <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">XMLHttpRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>request<span class="token punctuation">.</span><span class="token function">open<span class="token punctuation">(</span></span><span class="token string">'GET'</span><span class="token punctuation">,</span> <span class="token string">'/my/url'</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation" >;</span>request<span class="token punctuation">.</span>onreadystatechange <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation"> (</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token keyword">if</span> <span class="token punctuation">(</span>this<span class= "token punctuation">.</span>readyState <span class="token operator">===</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token punctuation">{ </span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>this<span class="token punctuation">.</span>status <span class="token operator">&gt;=</span> <span class="token number">200</span> <span class="token operator">&amp;&amp;</span> this<span class="token punctuation">.</span>status <span class="token operator">&lt;</span> <span class= "token number">400</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>     <span class="token comment" spellcheck="true"> // Success!</span>      <span class="token keyword">var</span> resp <span class="token operator">=</span> this<span class="token punctuation">.</span>responseText<span class="token punctuation">;</span>    <span class= "token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>     <span class="token comment" spellcheck="true"> // Error :(</span>    <span class="token punctuation">}</span>  <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">;</span>request<span class="token punctuation">.</span><span class="token function">send<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span> request <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span></code></pre>              </div>            </div> <div data-browser="ie9" class="browser ie9" >              <h4>IE9+</h4>              <div data-lang="javascript" class="code-block language-javascript">                <pre class=" language-javascript"><code class=" language-javascript"><span class="token keyword">var</span> request <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">XMLHttpRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>request<span class= "token punctuation">.</span><span class="token function">open<span class="token punctuation">(</span></span><span class="token string">'GET'</span><span class="token punctuation">,</span> <span class="token string">'/my/url'</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>request<span class="token punctuation">.</span>onload <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation"> (</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token keyword">if</span> <span class="token punctuation">(</span>request<span class= "token punctuation">.</span>status <span class="token operator">&gt;=</span> <span class="token number">200</span> <span class="token operator">&amp;&amp;</span> request<span class="token punctuation">.</span>status <span class="token operator">&lt;</span> <span class="token number">400</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment" spellcheck="true"> // Success!</span>    <span class="token keyword">var</span> resp <span class="token operator">=</span> request<span class="token punctuation">.</span>responseText<span class="token punctuation">;</span>  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation"> {</span>   <span class="token comment" spellcheck="true"> // We reached our target server, but it returned an error</span>  <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">;</span>request<span class="token punctuation">.</span>onerror <span class="token operator">=</span> <span class="token keyword"> function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment" spellcheck="true"> // There was a connection error of some sort</span><span class="token punctuation">}</span><span class="token punctuation">;</span>request<span class="token punctuation">.</span><span class= "token function">send<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>              </div> </div>            <div data-browser="ie10" class="browser ie10" >              <h4>IE10+</h4>              <div data-lang="javascript" class="code-block language-javascript"> <pre class=" language-javascript"><code class=" language-javascript"><span class="token keyword">var</span> request <span class="token operator">=</span> <span class= "token keyword">new</span> <span class="token class-name">XMLHttpRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>request<span class="token punctuation">.</span><span class="token function">open<span class="token punctuation">(</span></span><span class="token string">'GET' </span><span class="token punctuation">,</span> <span class="token string">'/my/url'</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class= "token punctuation">)</span><span class="token punctuation">;</span>request<span class="token punctuation">.</span>onload <span class="token operator">=</span> <span class="token keyword"> function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token keyword">if</span> <span class= "token punctuation">(</span>this<span class="token punctuation">.</span>status <span class="token operator">&gt;=</span> <span class="token number">200</span> <span class="token operator"> &amp;&amp;</span> this<span class="token punctuation">.</span>status <span class="token operator">&lt;</span> <span class="token number">400</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>   <span class="token comment" spellcheck="true"> // Success!</span>    <span class="token keyword">var</span> resp <span class="token operator">= </span> this<span class="token punctuation">.</span>response<span class="token punctuation">;</span>  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>   <span class="token comment" spellcheck="true"> // We reached our target server, but it returned an error</span>  <span class="token punctuation">} </span><span class="token punctuation">}</span><span class="token punctuation">;</span>request<span class="token punctuation">.</span>onerror <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment" spellcheck="true"> // There was a connection error of some sort</span><span class="token punctuation">}</span><span class="token punctuation">;</span>request<span class="token punctuation" >.</span><span class="token function">send<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre> </div>            </div>          </div>        </div>      </section>      <section id="effects">        <div class="inner">          <h2>Effects</h2>          <div class= "alternatives-block">            <h4>Alternatives:</h4>            <ul class="alternatives">              <li><a href=" http://daneden.github.io/animate.css/" target="_blank">animate.css </a></li>              <li><a href=" https://github.com/visionmedia/move.js" target="_blank">move.js</a></li>            </ul>          </div>          <div id="fade_in" class="comparison" >            <h3><a href="#fade_in">Fade In</a></h3>            <div data-browser="jquery" class="browser jquery">              <h4>jQuery</h4>              <div data-lang="javascript" class="code-block language-javascript">                <pre class=" language-javascript"><code class=" language-javascript">$<span class="token punctuation">(</span>el<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">fadeIn<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>              </div>            </div>            <div data-browser="ie8" class="browser ie8">              <h4>IE8+</h4>              <div data-lang="javascript" class="code-block language-javascript">                <pre class=" language-javascript"><code class=" language-javascript"><span class="token keyword">function </span> <span class="token function">fadeIn<span class="token punctuation">(</span></span>el<span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class= "token keyword">var</span> opacity <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>  el<span class="token punctuation">. </span>style<span class="token punctuation">.</span>opacity <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>  el<span class ="token punctuation">.</span>style<span class="token punctuation">.</span>filter <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">; </span>  <span class="token keyword">var</span> last <span class="token operator">=</span> <span class="token operator">+</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">var</span> tick <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    opacity <span class="token operator">+</span><span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> last<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">400</span><span class="token punctuation">;</span>    el<span class="token punctuation">.</span>style <span class="token punctuation">.</span>opacity <span class="token operator">=</span> opacity<span class="token punctuation">;</span>    el<span class="token punctuation">.</span>style <span class="token punctuation">.</span>filter <span class="token operator">=</span> <span class="token string">'alpha(opacity='</span> <span class="token operator">+</span> <span class= "token punctuation">(</span><span class="token number">100</span> <span class="token operator">*</span> opacity<span class="token punctuation">)</span><span class="token operator">| </span><span class="token number">0</span> <span class="token operator">+</span> <span class="token string">')'</span><span class="token punctuation">;</span>    last <span class="token operator">=</span> <span class="token operator">+</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class ="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>opacity <span class="token operator"> &lt;</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>      <span class="token punctuation">(</span>window<span class="token punctuation">.</span>requestAnimationFrame <span class="token operator">&amp;&amp;</span> <span class="token function">requestAnimationFrame<span class="token punctuation">( </span></span>tick<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token function">setTimeout<span class ="token punctuation">(</span></span>tick<span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation" >;</span>    <span class="token punctuation">}</span>  <span class="token punctuation">}</span><span class="token punctuation">;</span>  <span class="token function">tick<span class= "token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token function"> fadeIn<span class="token punctuation">(</span></span>el<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>              </div>            </div> <div data-browser="ie9" class="browser ie9" >              <h4>IE9+</h4>              <div data-lang="javascript" class="code-block language-javascript">                <pre class=" language-javascript"><code class=" language-javascript"><span class="token keyword">function</span> <span class="token function">fadeIn<span class="token punctuation">( </span></span>el<span class="token punctuation">)</span> <span class="token punctuation">{</span>  el<span class="token punctuation">.</span>style<span class="token punctuation">.</span> opacity <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>  <span class="token keyword">var</span> last <span class="token operator">=</span> <span class="token operator">+</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class ="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">var</span> tick <span class="token operator">=</span> <span class="token keyword"> function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    el<span class="token punctuation">.</span>style <span class="token punctuation">.</span>opacity <span class="token operator">=</span> <span class="token operator">+</span>el<span class="token punctuation">.</span>style<span class= "token punctuation">.</span>opacity <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Date </span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> last<span class="token punctuation">)</span> <span class= "token operator">/</span> <span class="token number">400</span><span class="token punctuation">;</span>    last <span class="token operator">=</span> <span class="token operator">+ </span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">+</span>el<span class="token punctuation">.</span>style <span class="token punctuation">.</span>opacity <span class="token operator">&lt;</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>      <span class="token punctuation">(</span>window<span class="token punctuation">.</span>requestAnimationFrame <span class="token operator">&amp;&amp;</span> <span class="token function">requestAnimationFrame<span class="token punctuation">(</span></span>tick<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class= "token operator">||</span> <span class="token function">setTimeout<span class="token punctuation">(</span></span>tick<span class="token punctuation">,</span> <span class="token number">16 </span><span class="token punctuation">)</span>    <span class="token punctuation">}</span>  <span class="token punctuation">}</span><span class="token punctuation">;</span>  <span class= "token function">tick<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">} </span><span class="token function">fadeIn<span class="token punctuation">(</span></span>el<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre> </div>            </div>            <div data-browser="ie10" class="browser ie10" >              <h4>IE10+</h4>              <div data-lang="javascript" class="code-block language-javascript">                <pre class=" language-javascript"><code class=" language-javascript">el<span class="token punctuation">.</span>classList<span class="token punctuation" >.</span><span class="token function">add<span class="token punctuation">(</span></span><span class="token string">'show'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>el<span class="token punctuation">.</span>classList<span class="token punctuation">.</span><span class="token function">remove<span class="token punctuation">( </span></span><span class="token string">'hide'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>              </div>              <div data-lang="css" class="code-block language-css">                <pre class=" language-css"><code class=" language-css"><span class="token selector">.show </span><span class="token punctuation">{</span>  <span class="token property">transition</span><span class="token punctuation">:</span> opacity 400ms<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token selector">.hide </span><span class="token punctuation">{</span>  <span class="token property">opacity</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre>              </div>            </div>          </div>          <div id="hide" class= "comparison">            <h3><a href="#hide">Hide</a></h3>            <div data-browser="jquery" class="browser jquery">              <h4>jQuery</h4>              <div data-lang= "javascript" class="code-block language-javascript">                <pre class=" language-javascript"><code class=" language-javascript">$<span class="token punctuation">(</span>el<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">hide<span class="token punctuation">(</span></span><span class="token punctuation">) </span><span class="token punctuation">;</span></code></pre>              </div>            </div>            <div data-browser="ie8" class="browser ie8">              <h4>IE8+</h4> <div data-lang="javascript" class="code-block language-javascript">                <pre class=" language-javascript"><code class=" language-javascript">el<span class="token punctuation">.</span>style<span class="token punctuation">.</span>display <span class="token operator">=</span> <span class="token string">'none'</span><span class="token punctuation">; </span></code></pre>              </div>            </div>          </div>          <div id="show" class="comparison">            <h3><a href="#show">Show</a></h3>            <div data-browser="jquery" class="browser jquery">              <h4>jQuery</h4>              <div data-lang="javascript" class="code-block language-javascript">                <pre class=" language-javascript"><code class=" language-javascript">$<span class="token punctuation">(</span>el<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">show<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>              </div> </div>            <div data-browser="ie8" class="browser ie8">              <h4>IE8+</h4>              <div data-lang="javascript" class="code-block language-javascript"> <pre class=" language-javascript"><code class=" language-javascript">el<span class="token punctuation">.</span>style<span class="token punctuation">.</span>display <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">;</span></code></pre>              </div>            </div>          </div> </div>      </section>      <section id="elements" class="odd">        <div class="inner">          <h2>Elements</h2>          <div class="alternatives-block">            <h4>Alternatives: </h4>            <ul class="alternatives">              <li><a href=" https://github.com/ded/bonzo" target="_blank">bonzo</a></li>              <li><a href=" https://github.com/julienw/dollardom" target="_blank">$dom</a></li>            </ul>          </div>          <div id="add_class" class="comparison">            <h3><a href="#add_class"> Add Class</a></h3>            <div data-browser="jquery" class="browser jquery">              <h4>jQuery</h4>              <div data-lang="javascript" class="code-block language-javascript">                <pre class=" language-javascript"><code class=" language-javascript">$<span class="token punctuation">(</span>el<span class="token punctuation">) </span><span class="token punctuation">.</span><span class="token function">addClass<span class="token punctuation">(</span></span>className<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>              </div>            </div>            <div data-browser="ie8" class="browser ie8">              <h4>IE8+</h4>              <div data-lang="javascript" class="code-block language-javascript">                <pre class=" language-javascript"><code class=" language-javascript"><span class="token keyword">if</span> <span class="token punctuation">(</span>el<span class="token punctuation">.</span>classList<span class="token punctuation">)</span>  el<span class="token punctuation">.</span>classList <span class="token punctuation">.</span><span class="token function">add<span class="token punctuation">(</span></span>className<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">else</span>  el<span class="token punctuation">.</span>className <span class="token operator">+</span><span class="token operator">=</span> <span class="token string">' '</span> <span class="token operator">+</span> className<span class="token punctuation">;</span></code></pre>              </div>            </div> <div data-browser="ie10" class="browser ie10" >              <h4>IE10+</h4>              <div data-lang="javascript" class="code-block language-javascript">                <pre class=" language-javascript"><code class=" language-javascript">el<span class="token punctuation">.</span>classList<span class="token punctuation">.</span><span class="token function">add <span class="token punctuation">(</span></span>className<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>              </div>            </div> </div>          <div id="after" class="comparison">            <h3><a href="#after">After</a></h3>            <div data-browser="jquery" class="browser jquery">              <h4> jQuery</h4>              <div data-lang="javascript" class="code-block language-javascript">                <pre class=" language-javascript"><code class=" language-javascript">$<span class="token punctuation">(</span>el<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">after<span class="token punctuation">( </span></span>htmlString<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>              </div>            </div>            <div data-browser= "ie8" class="browser ie8">              <h4>IE8+</h4>              <div data-lang="javascript" class="code-block language-javascript">                <pre class=" language-javascript" ><code class=" language-javascript">el<span class="token punctuation">.</span><span class="token function">insertAdjacentHTML<span class="token punctuation">(</span></span><span class= "token string">'afterend'</span><span class="token punctuation">,</span> htmlString<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre> </div>            </div>          </div>          <div id="append" class="comparison">            <h3><a href="#append">Append</a></h3>            <div data-browser="jquery" class="browser jquery">              <h4>jQuery</h4>              <div data-lang="javascript" class="code-block language-javascript">                <pre class=" language-javascript"><code class=" language-javascript">$<span class="token punctuation">(</span>parent<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function"> append<span class="token punctuation">(</span></span>el<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>              </div>            </div> <div data-browser="ie8" class="browser ie8">              <h4>IE8+</h4>              <div data-lang="javascript" class="code-block language-javascript">                <pre class=" language-javascript"><code class=" language-javascript">parent<span class="token punctuation">.</span><span class="token function">appendChild<span class="token punctuation">( </span></span>el<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>              </div>            </div>          </div>          <div id= "before" class="comparison">            <h3><a href="#before">Before</a></h3>            <div data-browser="jquery" class="browser jquery">              <h4>jQuery</h4>              <div data-lang="javascript" class="code-block language-javascript">                <pre class=" language-javascript"><code class=" language-javascript">$<span class="token punctuation">(</span> el<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">before<span class="token punctuation">(</span></span>htmlString<span class= "token punctuation">)</span><span class="token punctuation">;</span></code></pre>              </div>            </div>            <div data-browser="ie8" class="browser ie8"> <h4>IE8+</h4>              <div data-lang="javascript" class="code-block language-javascript">                <pre class=" language-javascript"><code class=" language-javascript">el<span class="token punctuation">.</span><span class="token function">insertAdjacentHTML<span class="token punctuation">(</span></span><span class="token string"> 'beforebegin'</span><span class="token punctuation">,</span> htmlString<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>              </div> </div>          </div>          <div id="children" class="comparison">            <h3><a href="#children">Children</a></h3>            <div data-browser="jquery" class= "browser jquery">              <h4>jQuery</h4>              <div data-lang="javascript" class="code-block language-javascript">                <pre class=" language-javascript"><code class =" language-javascript">$<span class="token punctuation">(</span>el<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">children <span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>              </div>            </div> <div data-browser="ie8" class="browser ie8">              <h4>IE8+</h4>              <div data-lang="javascript" class="code-block language-javascript">                <pre class=" language-javascript"><code class=" language-javascript"><span class="token keyword">var</span> children <span class="token operator">=</span> <span class="token punctuation">[ </span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> el<span class="token punctuation">.</span>children<span class="token punctuation">.</span>length<span class="token punctuation"> ;</span> i<span class="token operator">--</span><span class="token punctuation">;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class= "token comment" spellcheck="true"> // Skip comment nodes on IE8</span>  <span class="token keyword">if</span> <span class="token punctuation">(</span>el<span class="token punctuation">. </span>children<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>nodeType <span class="token operator">!</span><span class="token operator">=</span> <span class="token number">8</span><span class="token punctuation">)</span>    children<span class="token punctuation">.</span><span class="token function"> unshift<span class="token punctuation">(</span></span>el<span class="token punctuation">.</span>children<span class="token punctuation">[</span>i<span class="token punctuation">] </span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre>              </div>            </div> <div data-browser="ie9" class="browser ie9" >              <h4>IE9+</h4>              <div data-lang="javascript" class="code-block language-javascript">                <pre class=" language-javascript"><code class=" language-javascript">el<span class="token punctuation">.</span>children</code></pre>              </div>            </div>          </div> <div id="clone" class="comparison">            <h3><a href="#clone">Clone</a></h3>            <div data-browser="jquery" class="browser jquery">              <h4>jQuery</h4> <div data-lang="javascript" class="code-block language-javascript">                <pre class=" language-javascript"><code class=" language-javascript">$<span class="token punctuation">(</span>el<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">clone<span class="token punctuation">( </span></span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>              </div>            </div>            <div data-browser="ie8" class= "browser ie8">              <h4>IE8+</h4>              <div data-lang="javascript" class="code-block language-javascript">                <pre class=" language-javascript"><code class=" language-javascript">el<span class="token punctuation">.</span><span class="token function">cloneNode<span class="token punctuation">(</span></span><span class="token boolean">true </span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>              </div>            </div>          </div>          <div id="contains" class ="comparison">            <h3><a href="#contains">Contains</a></h3>            <div data-browser="jquery" class="browser jquery">              <h4>jQuery</h4>              <div data-lang= "javascript" class="code-block language-javascript">                <pre class=" language-javascript"><code class=" language-javascript">$<span class="token punctuation">.</span><span class="token function">contains<span class="token punctuation">(</span></span>el<span class="token punctuation">,</span> child<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>              </div>            </div>            <div data-browser="ie8" class="browser ie8">              <h4>IE8+</h4>              <div data-lang= "javascript" class="code-block language-javascript">                <pre class=" language-javascript"><code class=" language-javascript">el <span class="token operator">!</span><span class ="token operator">==</span> child <span class="token operator">&amp;&amp;</span> el<span class="token punctuation">.</span><span class="token function">contains<span class="token punctuation">(</span></span>child<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>              </div>            </div>          </div> <div id="contains_selector" class="comparison">            <h3><a href="#contains_selector">Contains Selector</a></h3>            <div data-browser="jquery" class="browser jquery">              <h4>jQuery</h4>              <div data-lang="javascript" class="code-block language-javascript">                <pre class=" language-javascript"><code class=" language-javascript">$<span class="token punctuation">(</span>el<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">find<span class ="token punctuation">(</span></span>selector<span class="token punctuation">)</span><span class="token punctuation">.</span>length<span class="token punctuation">;</span></code></pre> </div>            </div>            <div data-browser="ie8" class="browser ie8">              <h4>IE8+</h4>              <div data-lang="javascript" class="code-block language-javascript">                <pre class=" language-javascript"><code class=" language-javascript">el<span class="token punctuation">.</span><span class="token function"> querySelector<span class="token punctuation">(</span></span>selector<span class="token punctuation">)</span> <span class="token operator">!</span><span class="token operator">==</span> <span class="token keyword">null</span></code></pre>              </div>            </div>          </div>          <div id="each" class="comparison">            <h3><a href="#each">Each </a></h3>            <div data-browser="jquery" class="browser jquery">              <h4>jQuery</h4>              <div data-lang="javascript" class="code-block language-javascript"> <pre class=" language-javascript"><code class=" language-javascript">$<span class="token punctuation">(</span>selector<span class="token punctuation">)</span><span class= "token punctuation">.</span><span class="token function">each<span class="token punctuation">(</span></span><span class="token keyword">function</span><span class="token punctuation">( </span>i<span class="token punctuation">,</span> el<span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class= "token punctuation">)</span><span class="token punctuation">;</span></code></pre>              </div>            </div>            <div data-browser="ie8" class="browser ie8"> <h4>IE8+</h4>              <div data-lang="javascript" class="code-block language-javascript">                <pre class=" language-javascript"><code class=" language-javascript"><span class="token keyword">function</span> <span class="token function">forEachElement<span class="token punctuation">(</span></span>selector<span class="token punctuation">,</span> fn<span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token keyword">var</span> elements <span class="token operator">= </span> document<span class="token punctuation">.</span><span class="token function">querySelectorAll<span class="token punctuation">(</span></span>selector<span class="token punctuation"> )</span><span class="token punctuation">;</span>  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class= "token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> elements<span class="token punctuation">. </span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>    <span class="token function">fn<span class="token punctuation">(</span></span>elements<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token function">forEachElement<span class="token punctuation">( </span></span>selector<span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>el<span class="token punctuation">,</span> i<span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>              </div>            </div>            <div data-browser="ie9" class="browser ie9" >              <h4>IE9+</h4>              <div data-lang= "javascript" class="code-block language-javascript">                <pre class=" language-javascript"><code class=" language-javascript"><span class="token keyword">var</span> elements <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelectorAll<span class="token punctuation">(</span></span>selector <span class="token punctuation">)</span><span class="token punctuation">;</span>Array<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>forEach<span class="token punctuation">.</span><span class="token function">call<span class="token punctuation">(</span></span>elements<span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>el<span class="token punctuation">,</span> i<span class="token punctuation">)</span><span class="token punctuation">{ </span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>              </div>            </div> </div>          <div id="empty" class="comparison">            <h3><a href="#empty">Empty</a></h3>            <div data-browser="jquery" class="browser jquery">              <h4>jQuery </h4>              <div data-lang="javascript" class="code-block language-javascript">                <pre class=" language-javascript"><code class=" language-javascript">$<span class= "token punctuation">(</span>el<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">empty<span class="token punctuation">( </span></span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>              </div>            </div>            <div data-browser="ie8" class= "browser ie8">              <h4>IE8+</h4>              <div data-lang="javascript" class="code-block language-javascript">                <pre class=" language-javascript"><code class=" language-javascript"><span class="token keyword">while</span><span class="token punctuation">(</span>el<span class="token punctuation">.</span>firstChild<span class="token punctuation">) </span>  el<span class="token punctuation">.</span><span class="token function">removeChild<span class="token punctuation">(</span></span>el<span class="token punctuation">.</span> firstChild<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>              </div>            </div>            <div data-browser="ie9" class= "browser ie9" >              <h4>IE9+</h4>              <div data-lang="javascript" class="code-block language-javascript">                <pre class=" language-javascript"><code class=" language-javascript">el<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">; </span></code></pre>              </div>            </div>          </div>          <div id="filter" class="comparison">            <h3><a href="#filter">Filter</a></h3>            <div data-browser="jquery" class="browser jquery">              <h4>jQuery</h4>              <div data-lang="javascript" class="code-block language-javascript">                <pre class=" language-javascript"><code class=" language-javascript">$<span class="token punctuation">(</span>selector<span class="token punctuation">)</span><span class="token punctuation">. </span><span class="token function">filter<span class="token punctuation">(</span></span>filterFn<span class="token punctuation">)</span><span class="token punctuation">; </span></code></pre>              </div>            </div>            <div data-browser="ie8" class="browser ie8">              <h4>IE8+</h4>              <div data-lang="javascript" class ="code-block language-javascript">                <pre class=" language-javascript"><code class=" language-javascript"><span class="token keyword">function</span> <span class="token function">filter<span class="token punctuation">(</span></span>selector<span class="token punctuation">,</span> filterFn<span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token keyword">var</span> elements <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function"> querySelectorAll<span class="token punctuation">(</span></span>selector<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">var </span> out <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>  <span class= "token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> elements<span class="token punctuation">. </span>length<span class="token punctuation">;</span> i<span class="token operator">--</span><span class="token punctuation">;</span><span class="token punctuation">)</span> <span class= "token punctuation">{</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">filterFn<span class="token punctuation">( </span></span>elements<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> out<span class="token punctuation">.</span><span class="token function">unshift<span class="token punctuation">(</span></span>elements<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span>  <span class="token keyword"> return</span> out<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token function">filter<span class="token punctuation">(</span></span>selector <span class="token punctuation">,</span> filterFn<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>              </div>            </div> <div data-browser="ie9" class="browser ie9" >              <h4>IE9+</h4>              <div data-lang="javascript" class="code-block language-javascript">                <pre class=" language-javascript"><code class=" language-javascript">Array<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>filter<span class="token punctuation">.</span><span class="token function">call<span class="token punctuation">(</span></span>document<span class="token punctuation">.</span><span class="token function"> querySelectorAll<span class="token punctuation">(</span></span>selector<span class="token punctuation">)</span><span class="token punctuation">,</span> filterFn<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>              </div>            </div>          </div>          <div id="find_children" class="comparison"> <h3><a href="#find_children">Find Children</a></h3>            <div data-browser="jquery" class="browser jquery">              <h4>jQuery</h4>              <div data-lang= "javascript" class="code-block language-javascript">                <pre class=" language-javascript"><code class=" language-javascript">$<span class="token punctuation">(</span>el<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">find<span class="token punctuation">(</span></span>selector<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>              </div>            </div>            <div data-browser="ie8" class="browser ie8">              <h4> IE8+</h4>              <div data-lang="javascript" class="code-block language-javascript">                <pre class=" language-javascript"><code class=" language-javascript">el<span class ="token punctuation">.</span><span class="token function">querySelectorAll<span class="token punctuation">(</span></span>selector<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>              </div>            </div>          </div>          <div id="find_elements" class="comparison">            <h3><a href="#find_elements">Find Elements</a></h3>            <div class="alternatives-block">              <h4>Alternatives:</h4>              <ul class="alternatives">                <li><a href=" https://github.com/ded/qwery" target="_blank">qwery</a></li>                <li><a href=" http://sizzlejs.com/" target="_blank">sizzle</a></li>              </ul>            </div> <div data-browser="jquery" class="browser jquery">              <h4>jQuery</h4>              <div data-lang="javascript" class="code-block language-javascript"> <pre class=" language-javascript"><code class=" language-javascript">$<span class="token punctuation">(</span><span class="token string">'.my #awesome selector'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>              </div>            </div>            <div data-browser="ie8" class="browser ie8">              <h4> IE8+</h4>              <div data-lang="javascript" class="code-block language-javascript">                <pre class=" language-javascript"><code class=" language-javascript">document<span class="token punctuation">.</span><span class="token function">querySelectorAll<span class="token punctuation">(</span></span><span class="token string">'.my #awesome selector' </span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>              </div>            </div>          </div>          <div id="get_attributes" class="comparison">            <h3><a href="#get_attributes">Get Attributes</a></h3>            <div data-browser="jquery" class="browser jquery">              <h4>jQuery</h4> <div data-lang="javascript" class="code-block language-javascript">                <pre class=" language-javascript"><code class=" language-javascript">$<span class="token punctuation">(</span>el<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">attr<span class="token punctuation">(</span></span><span class="token string">'tabindex'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>              </div>            </div>            <div data-browser="ie8" class="browser ie8">              <h4>IE8+</h4>              <div data-lang="javascript" class="code-block language-javascript">                <pre class=" language-javascript"><code class=" language-javascript">el<span class="token punctuation">.</span><span class="token function">getAttribute<span class="token punctuation">( </span></span><span class="token string">'tabindex'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>              </div> </div>          </div>          <div id="get_html" class="comparison">            <h3><a href="#get_html">Get Html</a></h3>            <div data-browser="jquery" class="browser jquery"> <h4>jQuery</h4>              <div data-lang="javascript" class="code-block language-javascript">                <pre class=" language-javascript"><code class=" language-javascript">$<span class="token punctuation">(</span>el<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">html<span class ="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>              </div>            </div>            <div data-browser="ie8" class="browser ie8">              <h4>IE8+</h4>              <div data-lang="javascript" class="code-block language-javascript">                <pre class=" language-javascript"><code class=" language-javascript">el<span class="token punctuation">.</span>innerHTML</code></pre>              </div>            </div>          </div>          <div id="get_outer_html" class="comparison">            <h3><a href="#get_outer_html">Get Outer Html</a></h3>            <div data-browser="jquery" class="browser jquery">              <h4> jQuery</h4>              <div data-lang="javascript" class="code-block language-javascript">                <pre class=" language-javascript"><code class=" language-javascript">$<span class="token punctuation">(</span><span class="token string">'&lt;div&gt;'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">append<span class="token punctuation">(</span></span>$<span class="token punctuation">(</span>el<span class="token punctuation">)</span><span class="token punctuation">. </span><span class="token function">clone<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">html<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">; </span></code></pre>              </div>            </div>            <div data-browser="ie8" class="browser ie8">              <h4>IE8+</h4>              <div data-lang="javascript" class ="code-block language-javascript">                <pre class=" language-javascript"><code class=" language-javascript">el<span class="token punctuation">.</span>outerHTML</code></pre> </div>            </div>          </div>          <div id="get_style" class="comparison">            <h3><a href="#get_style">Get Style</a></h3>            <div data-browser= "jquery" class="browser jquery">              <h4>jQuery</h4>              <div data-lang="javascript" class="code-block language-javascript">                <pre class=" language-javascript"><code class=" language-javascript">$<span class="token punctuation">(</span>el<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">css<span class="token punctuation">(</span></span>ruleName<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre> </div>            </div>            <div data-browser="ie8" class="browser ie8">              <h4>IE8+</h4>              <div data-lang="javascript" class="code-block language-javascript"> <pre class=" language-javascript"><code class=" language-javascript"><span class="token comment" spellcheck="true">// Varies based on the properties being retrieved, some can be retrieved from el.currentStyle</span><span class="token comment" spellcheck="true">// https://github.com/jonathantneal/Polyfills-for-IE8/blob/master/getComputedStyle.js </span></code></pre>              </div>            </div>            <div data-browser="ie9" class="browser ie9" >              <h4>IE9+</h4>              <div data-lang="javascript" class="code-block language-javascript">                <pre class=" language-javascript"><code class=" language-javascript"><span class="token function">getComputedStyle<span class="token punctuation">(</span></span>el<span class="token punctuation">)</span><span class="token punctuation">[</span>ruleName<span class="token punctuation">]</span><span class="token punctuation">;</span></code></pre>              </div>            </div>          </div>          <div id="get_text" class="comparison">            <h3><a href="#get_text">Get Text </a></h3>            <div data-browser="jquery" class="browser jquery">              <h4>jQuery</h4>              <div data-lang="javascript" class="code-block language-javascript"> <pre class=" language-javascript"><code class=" language-javascript">$<span class="token punctuation">(</span>el<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">text<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">; </span></code></pre>              </div>            </div>            <div data-browser="ie8" class="browser ie8">              <h4>IE8+</h4>              <div data-lang="javascript" class ="code-block language-javascript">                <pre class=" language-javascript"><code class=" language-javascript">el<span class="token punctuation">.</span>textContent <span class= "token operator">||</span> el<span class="token punctuation">.</span>innerText</code></pre>              </div>            </div>            <div data-browser="ie9" class="browser ie9" > <h4>IE9+</h4>              <div data-lang="javascript" class="code-block language-javascript">                <pre class=" language-javascript"><code class=" language-javascript">el<span class="token punctuation">.</span>textContent</code></pre>              </div>            </div>          </div>          <div id="has_class" class= "comparison">            <h3><a href="#has_class">Has Class</a></h3>            <div data-browser="jquery" class="browser jquery">              <h4>jQuery</h4>              <div data-lang= "javascript" class="code-block language-javascript">                <pre class=" language-javascript"><code class=" language-javascript">$<span class="token punctuation">(</span>el<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">hasClass<span class="token punctuation">(</span></span>className<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>              </div>            </div>            <div data-browser="ie8" class="browser ie8">              <h4> IE8+</h4>              <div data-lang="javascript" class="code-block language-javascript">                <pre class=" language-javascript"><code class=" language-javascript"><span class= "token keyword">if</span> <span class="token punctuation">(</span>el<span class="token punctuation">.</span>classList<span class="token punctuation">)</span>  el<span class="token punctuation">.</span>classList<span class="token punctuation">.</span><span class="token function">contains<span class="token punctuation">(</span></span>className<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">else</span>  <span class="token keyword">new</span> <span class="token class-name">RegExp </span><span class="token punctuation">(</span><span class="token string">'(^| )'</span> <span class="token operator">+</span> className <span class="token operator">+</span> <span class= "token string">'( |$)'</span><span class="token punctuation">,</span> <span class="token string">'gi'</span><span class="token punctuation">)</span><span class="token punctuation">. </span><span class="token function">test<span class="token punctuation">(</span></span>el<span class="token punctuation">.</span>className<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>              </div>            </div>            <div data-browser="ie10" class="browser ie10" >              <h4>IE10+</h4> <div data-lang="javascript" class="code-block language-javascript">                <pre class=" language-javascript"><code class=" language-javascript">el<span class="token punctuation">. </span>classList<span class="token punctuation">.</span><span class="token function">contains<span class="token punctuation">(</span></span>className<span class="token punctuation">) </span><span class="token punctuation">;</span></code></pre>              </div>            </div>          </div>          <div id="matches" class="comparison">            <h3><a href= "#matches">Matches</a></h3>            <div data-browser="jquery" class="browser jquery">              <h4>jQuery</h4>              <div data-lang="javascript" class="code-block language-javascript">                <pre class=" language-javascript"><code class=" language-javascript">$<span class="token punctuation">(</span>el<span class="token punctuation">) </span><span class="token punctuation">.</span><span class="token function">is<span class="token punctuation">(</span></span>$<span class="token punctuation">(</span>otherEl<span class= "token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>              </div>            </div>            <div data-browser ="ie8" class="browser ie8">              <h4>IE8+</h4>              <div data-lang="javascript" class="code-block language-javascript">                <pre class=" language-javascript" ><code class=" language-javascript">el <span class="token operator">===</span> otherEl</code></pre>              </div>            </div>          </div>          <div id= "matches_selector" class="comparison">            <h3><a href="#matches_selector">Matches Selector</a></h3>            <div data-browser="jquery" class="browser jquery">              <h4> jQuery</h4>              <div data-lang="javascript" class="code-block language-javascript">                <pre class=" language-javascript"><code class=" language-javascript">$<span class="token punctuation">(</span>el<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">is<span class="token punctuation">( </span></span><span class="token string">'.my-class'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>              </div> </div>            <div data-browser="ie8" class="browser ie8">              <h4>IE8+</h4>              <div data-lang="javascript" class="code-block language-javascript"> <pre class=" language-javascript"><code class=" language-javascript"><span class="token keyword">var</span> matches <span class="token operator">=</span> <span class="token keyword"> function</span><span class="token punctuation">(</span>el<span class="token punctuation">,</span> selector<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">var</span> _matches <span class="token operator">=</span> <span class="token punctuation">(</span>el<span class="token punctuation">.</span>matches <span class="token operator">||</span> el<span class="token punctuation">.</span>matchesSelector <span class="token operator">||</span> el<span class="token punctuation">.</span> msMatchesSelector <span class="token operator">||</span> el<span class="token punctuation">.</span>mozMatchesSelector <span class="token operator">||</span> el<span class="token punctuation">.</span>webkitMatchesSelector <span class="token operator">||</span> el<span class="token punctuation">.</span>oMatchesSelector<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">if</span> <span class="token punctuation">(</span>_matches<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">return</span> _matches<span class="token punctuation">.</span><span class="token function">call<span class="token punctuation">( </span></span>el<span class="token punctuation">,</span> selector<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>    <span class="token keyword">var</span> nodes <span class="token operator">=</span> el<span class="token punctuation">.</span>parentNode<span class="token punctuation">.</span><span class="token function">querySelectorAll<span class="token punctuation">(</span></span>selector<span class= "token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var </span> i <span class="token operator">=</span> nodes<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">--</span><span class="token punctuation">;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>      <span class="token keyword">if</span> <span class="token punctuation">(</span>nodes<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">===</span> el<span class="token punctuation">) </span>        <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span> <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token function">matches<span class="token punctuation">(</span></span>el<span class="token punctuation">,</span> <span class="token string">'.my-class'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>              </div>            </div> <div data-browser="ie9" class="browser ie9" >              <h4>IE9+</h4>              <div data-lang="javascript" class="code-block language-javascript">                <pre class=" language-javascript"><code class=" language-javascript"><span class="token keyword">var</span> matches <span class="token operator">=</span> <span class="token keyword">function </span><span class="token punctuation">(</span>el<span class="token punctuation">,</span> selector<span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token keyword">return</span> <span class="token punctuation">(</span>el<span class="token punctuation">.</span>matches <span class="token operator">||</span> el<span class="token punctuation">.</span>matchesSelector <span class="token operator">||</span> el<span class="token punctuation">.</span>msMatchesSelector <span class="token operator">||</span> el<span class ="token punctuation">.</span>mozMatchesSelector <span class="token operator">||</span> el<span class="token punctuation">.</span>webkitMatchesSelector <span class="token operator">|| </span> el<span class="token punctuation">.</span>oMatchesSelector<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">call<span class="token punctuation">(</span></span>el<span class="token punctuation">,</span> selector<span class="token punctuation">)</span><span class="token punctuation">;</span><span class= "token punctuation">}</span><span class="token punctuation">;</span><span class="token function">matches<span class="token punctuation">(</span></span>el<span class="token punctuation">, </span> <span class="token string">'.my-class'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>              </div>            </div> </div>          <div id="next" class="comparison">            <h3><a href="#next">Next</a></h3>            <div data-browser="jquery" class="browser jquery">              <h4> jQuery</h4>              <div data-lang="javascript" class="code-block language-javascript">                <pre class=" language-javascript"><code class=" language-javascript">$<span class="token punctuation">(</span>el<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">next<span class="token punctuation">( </span></span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>              </div>            </div>            <div data-browser="ie8" class= "browser ie8">              <h4>IE8+</h4>              <div data-lang="javascript" class="code-block language-javascript">                <pre class=" language-javascript"><code class=" language-javascript"><span class="token comment" spellcheck="true">// nextSibling can include text nodes</span><span class="token keyword">function</span> <span class="token function"> nextElementSibling<span class="token punctuation">(</span></span>el<span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token keyword">do</span> <span class="token punctuation">{</span> el <span class="token operator">=</span> el<span class="token punctuation">.</span>nextSibling<span class="token punctuation">;</span> <span class= "token punctuation">}</span> <span class="token keyword">while</span> <span class="token punctuation">(</span> el <span class="token operator">&amp;&amp;</span> el<span class="token punctuation">.</span>nodeType <span class="token operator">!</span><span class="token operator">==</span> <span class="token number">1</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">return</span> el<span class="token punctuation">;</span><span class="token punctuation">}</span>el<span class="token punctuation">.</span>nextElementSibling <span class="token operator">||</span> <span class="token function">nextElementSibling<span class="token punctuation">(</span></span>el<span class= "token punctuation">)</span><span class="token punctuation">;</span></code></pre>              </div>            </div>            <div data-browser="ie9" class="browser ie9" > <h4>IE9+</h4>              <div data-lang="javascript" class="code-block language-javascript">                <pre class=" language-javascript"><code class=" language-javascript">el<span class="token punctuation">.</span>nextElementSibling</code></pre>              </div>            </div>          </div>          <div id="offset" class= "comparison">            <h3><a href="#offset">Offset</a></h3>            <div data-browser="jquery" class="browser jquery">              <h4>jQuery</h4>              <div data-lang= "javascript" class="code-block language-javascript">                <pre class=" language-javascript"><code class=" language-javascript">$<span class="token punctuation">(</span>el<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">offset<span class="token punctuation">(</span></span><span class="token punctuation"> )</span><span class="token punctuation">;</span></code></pre>              </div>            </div>            <div data-browser="ie8" class="browser ie8">              <h4>IE8+</h4> <div data-lang="javascript" class="code-block language-javascript">                <pre class=" language-javascript"><code class=" language-javascript"><span class="token keyword">var</span> rect <span class="token operator">=</span> el<span class="token punctuation">.</span><span class="token function">getBoundingClientRect<span class="token punctuation">( </span></span><span class="token punctuation">)</span><span class="token punctuation">{</span>  top<span class="token punctuation">:</span> rect<span class="token punctuation">.</span>top <span class="token operator">+</span> document<span class="token punctuation">.</span>body<span class="token punctuation">.</span>scrollTop<span class="token punctuation">,</span>  left <span class="token punctuation">:</span> rect<span class="token punctuation">.</span>left <span class="token operator">+</span> document<span class="token punctuation">.</span>body<span class="token punctuation">.</span>scrollLeft<span class="token punctuation">}</span></code></pre>              </div>            </div>          </div>          <div id="offset_parent" class="comparison">            <h3><a href="#offset_parent">Offset Parent</a></h3>            <div data-browser="jquery" class="browser jquery">              <h4>jQuery</h4> <div data-lang="javascript" class="code-block language-javascript">                <pre class=" language-javascript"><code class=" language-javascript">$<span class="token punctuation">( </span>el<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">offsetParent<span class="token punctuation">(</span></span><span class ="token punctuation">)</span><span class="token punctuation">;</span></code></pre>              </div>            </div>            <div data-browser="ie8" class="browser ie8"> <h4>IE8+</h4>              <div data-lang="javascript" class="code-block language-javascript">                <pre class=" language-javascript"><code class=" language-javascript">el<span class="token punctuation">.</span>offsetParent <span class="token operator">||</span> el</code></pre>              </div>            </div>          </div> <div id="outer_height" class="comparison">            <h3><a href="#outer_height">Outer Height</a></h3>            <div data-browser="jquery" class="browser jquery"> <h4>jQuery</h4>              <div data-lang="javascript" class="code-block language-javascript">                <pre class=" language-javascript"><code class=" language-javascript">$<span class="token punctuation">(</span>el<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">outerHeight <span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>              </div>            </div> <div data-browser="ie8" class="browser ie8">              <h4>IE8+</h4>              <div data-lang="javascript" class="code-block language-javascript">                <pre class=" language-javascript"><code class=" language-javascript">el<span class="token punctuation">.</span>offsetHeight</code></pre>              </div>            </div>          </div> <div id="outer_height_with_margin" class="comparison">            <h3><a href="#outer_height_with_margin">Outer Height With Margin</a></h3>            <div data-browser="jquery" class="browser jquery">              <h4>jQuery</h4>              <div data-lang="javascript" class="code-block language-javascript">                <pre class=" language-javascript"><code class=" language-javascript">$<span class="token punctuation">(</span>el<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function"> outerHeight<span class="token punctuation">(</span></span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">; </span></code></pre>              </div>            </div>            <div data-browser="ie8" class="browser ie8">              <h4>IE8+</h4>              <div data-lang="javascript" class ="code-block language-javascript">                <pre class=" language-javascript"><code class=" language-javascript"><span class="token keyword">function</span> <span class="token function">outerHeight<span class="token punctuation">(</span></span>el<span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token keyword">var </span> height <span class="token operator">=</span> el<span class="token punctuation">.</span>offsetHeight<span class="token punctuation">;</span>  <span class="token keyword">var</span> style <span class="token operator">=</span> el<span class="token punctuation">.</span>currentStyle <span class="token operator">||</span> <span class="token function">getComputedStyle<span class="token punctuation">(</span></span>el<span class="token punctuation">)</span><span class="token punctuation">;</span>  height <span class="token operator">+</span><span class= "token operator">=</span> <span class="token function">parseInt<span class="token punctuation">(</span></span>style<span class="token punctuation">.</span>marginTop<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token function">parseInt<span class="token punctuation">(</span></span>style<span class="token punctuation">. </span>marginBottom<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">return</span> height<span class="token punctuation">; </span><span class="token punctuation">}</span><span class="token function">outerHeight<span class="token punctuation">(</span></span>el<span class="token punctuation">)</span><span class= "token punctuation">;</span></code></pre>              </div>            </div>            <div data-browser="ie9" class="browser ie9" >              <h4>IE9+</h4>              <div data-lang="javascript" class="code-block language-javascript">                <pre class=" language-javascript"><code class=" language-javascript"><span class="token keyword">function </span> <span class="token function">outerHeight<span class="token punctuation">(</span></span>el<span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token keyword">var</span> height <span class="token operator">=</span> el<span class="token punctuation">.</span>offsetHeight<span class="token punctuation">;</span>  <span class= "token keyword">var</span> style <span class="token operator">=</span> <span class="token function">getComputedStyle<span class="token punctuation">(</span></span>el<span class="token punctuation">)</span><span class="token punctuation">;</span>  height <span class="token operator">+</span><span class="token operator">=</span> <span class="token function">parseInt<span class="token punctuation">(</span></span>style<span class="token punctuation">.</span>marginTop<span class="token punctuation">)</span> <span class="token operator">+</span> <span class= "token function">parseInt<span class="token punctuation">(</span></span>style<span class="token punctuation">.</span>marginBottom<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">return</span> height<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token function"> outerHeight<span class="token punctuation">(</span></span>el<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>              </div> </div>          </div>          <div id="outer_width_with_margin" class="comparison">            <h3><a href="#outer_width_with_margin">Outer Width With Margin</a></h3>            <div data-browser="jquery" class="browser jquery">              <h4>jQuery</h4>              <div data-lang="javascript" class="code-block language-javascript">                <pre class=" language-javascript"><code class=" language-javascript">$<span class="token punctuation">(</span>el<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">outerWidth<span class="token punctuation">(</span></span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>              </div>            </div>            <div data-browser="ie8" class="browser ie8">              <h4>IE8+</h4>              <div data-lang= "javascript" class="code-block language-javascript">                <pre class=" language-javascript"><code class=" language-javascript"><span class="token keyword">function</span> <span class="token function">outerWidth<span class="token punctuation">(</span></span>el<span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token keyword">var</span> width <span class="token operator">=</span> el<span class="token punctuation">.</span>offsetWidth<span class="token punctuation">;</span>  <span class="token keyword"> var</span> style <span class="token operator">=</span> el<span class="token punctuation">.</span>currentStyle <span class="token operator">||</span> <span class="token function"> getComputedStyle<span class="token punctuation">(</span></span>el<span class="token punctuation">)</span><span class="token punctuation">;</span>  width <span class="token operator">+ </span><span class="token operator">=</span> <span class="token function">parseInt<span class="token punctuation">(</span></span>style<span class="token punctuation">.</span>marginLeft <span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token function">parseInt<span class="token punctuation">(</span></span>style<span class="token punctuation">.</span>marginRight<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">return</span> width<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token function">outerWidth<span class="token punctuation">(</span></span>el<span class="token punctuation">) </span><span class="token punctuation">;</span></code></pre>              </div>            </div>            <div data-browser="ie9" class="browser ie9" >              <h4>IE9+</h4> <div data-lang="javascript" class="code-block language-javascript">                <pre class=" language-javascript"><code class=" language-javascript"><span class="token keyword">function</span> <span class="token function">outerWidth<span class="token punctuation">(</span></span>el<span class="token punctuation">)</span> <span class="token punctuation">{ </span>  <span class="token keyword">var</span> width <span class="token operator">=</span> el<span class="token punctuation">.</span>offsetWidth<span class="token punctuation">;</span> <span class="token keyword">var</span> style <span class="token operator">=</span> <span class="token function">getComputedStyle<span class="token punctuation">(</span></span>el<span class ="token punctuation">)</span><span class="token punctuation">;</span>  width <span class="token operator">+</span><span class="token operator">=</span> <span class="token function"> parseInt<span class="token punctuation">(</span></span>style<span class="token punctuation">.</span>marginLeft<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token function">parseInt<span class="token punctuation">(</span></span>style<span class="token punctuation">.</span>marginRight<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">return</span> width<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token function">outerWidth<span class="token punctuation">(</span></span>el<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>              </div> </div>          </div>          <div id="outer_width" class="comparison">            <h3><a href="#outer_width">Outer Width</a></h3>            <div data-browser="jquery" class ="browser jquery">              <h4>jQuery</h4>              <div data-lang="javascript" class="code-block language-javascript">                <pre class=" language-javascript"><code class=" language-javascript">$<span class="token punctuation">(</span>el<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function"> outerWidth<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>              </div>            </div> <div data-browser="ie8" class="browser ie8">              <h4>IE8+</h4>              <div data-lang="javascript" class="code-block language-javascript">                <pre class=" language-javascript"><code class=" language-javascript">el<span class="token punctuation">.</span>offsetWidth</code></pre>              </div>            </div>          </div> <div id="parent" class="comparison">            <h3><a href="#parent">Parent</a></h3>            <div data-browser="jquery" class="browser jquery">              <h4>jQuery</h4> <div data-lang="javascript" class="code-block language-javascript">                <pre class=" language-javascript"><code class=" language-javascript">$<span class="token punctuation">(</span>el<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">parent<span class="token punctuation">( </span></span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>              </div>            </div>            <div data-browser="ie8" class= "browser ie8">              <h4>IE8+</h4>              <div data-lang="javascript" class="code-block language-javascript">                <pre class=" language-javascript"><code class=" language-javascript">el<span class="token punctuation">.</span>parentNode</code></pre>              </div>            </div>          </div>          <div id="position" class="comparison"> <h3><a href="#position">Position</a></h3>            <div data-browser="jquery" class="browser jquery">              <h4>jQuery</h4>              <div data-lang="javascript" class="code-block language-javascript">                <pre class=" language-javascript"><code class=" language-javascript">$<span class="token punctuation">(</span>el<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">position<span class="token punctuation">(</span></span><span class="token punctuation">) </span><span class="token punctuation">;</span></code></pre>              </div>            </div>            <div data-browser="ie8" class="browser ie8">              <h4>IE8+</h4> <div data-lang="javascript" class="code-block language-javascript">                <pre class=" language-javascript"><code class=" language-javascript"><span class="token punctuation">{</span>left<span class="token punctuation">:</span> el<span class="token punctuation">.</span>offsetLeft<span class="token punctuation">,</span> top<span class="token punctuation">:</span> el<span class="token punctuation">.</span>offsetTop<span class="token punctuation">}</span></code></pre>              </div>            </div>          </div> <div id="position_relative_to_viewport" class="comparison">            <h3><a href="#position_relative_to_viewport">Position Relative To Viewport</a></h3>            <div data-browser="jquery" class="browser jquery">              <h4>jQuery</h4>              <div data-lang="javascript" class="code-block language-javascript">                <pre class=" language-javascript"><code class=" language-javascript"><span class="token keyword">var</span> offset <span class="token operator">=</span> el<span class="token punctuation">.</span><span class="token function">offset<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation"> {</span>  top<span class="token punctuation">:</span> offset<span class="token punctuation">.</span>top <span class="token operator">-</span> document<span class="token punctuation">. </span>body<span class="token punctuation">.</span>scrollTop<span class="token punctuation">,</span>  left<span class="token punctuation">:</span> offset<span class="token punctuation">. </span>left <span class="token operator">-</span> document<span class="token punctuation">.</span>body<span class="token punctuation">.</span>scrollLeft<span class="token punctuation">} </span></code></pre>              </div>            </div>            <div data-browser="ie8" class="browser ie8">              <h4>IE8+</h4>              <div data-lang="javascript" class ="code-block language-javascript">                <pre class=" language-javascript"><code class=" language-javascript">el<span class="token punctuation">.</span><span class="token function">getBoundingClientRect<span class="token punctuation">(</span></span><span class="token punctuation">)</span></code></pre>              </div>            </div>          </div> <div id="prepend" class="comparison">            <h3><a href="#prepend">Prepend</a></h3>            <div data-browser="jquery" class="browser jquery">              <h4>jQuery </h4>              <div data-lang="javascript" class="code-block language-javascript">                <pre class=" language-javascript"><code class=" language-javascript">$<span class= "token punctuation">(</span>parent<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">prepend<span class="token punctuation">( </span></span>el<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>              </div>            </div>            <div data-browser="ie8" class ="browser ie8">              <h4>IE8+</h4>              <div data-lang="javascript" class="code-block language-javascript">                <pre class=" language-javascript"><code class=" language-javascript">parent<span class="token punctuation">.</span><span class="token function">insertBefore<span class="token punctuation">(</span></span>el<span class="token punctuation" >,</span> parent<span class="token punctuation">.</span>firstChild<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>              </div> </div>          </div>          <div id="prev" class="comparison">            <h3><a href="#prev">Prev</a></h3>            <div data-browser="jquery" class="browser jquery"> <h4>jQuery</h4>              <div data-lang="javascript" class="code-block language-javascript">                <pre class=" language-javascript"><code class=" language-javascript">$<span class="token punctuation">(</span>el<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">prev<span class ="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>              </div>            </div>            <div data-browser="ie8" class="browser ie8">              <h4>IE8+</h4>              <div data-lang="javascript" class="code-block language-javascript">                <pre class=" language-javascript"><code class=" language-javascript"><span class="token comment" spellcheck="true">// prevSibling can include text nodes</span><span class="token keyword">function </span> <span class="token function">previousElementSibling<span class="token punctuation">(</span></span>el<span class="token punctuation">)</span> <span class="token punctuation">{ </span>  <span class="token keyword">do</span> <span class="token punctuation">{</span> el <span class="token operator">=</span> el<span class="token punctuation">.</span>previousSibling <span class="token punctuation">;</span> <span class="token punctuation">}</span> <span class="token keyword">while</span> <span class="token punctuation">(</span> el <span class="token operator">&amp;&amp;</span> el<span class="token punctuation">.</span>nodeType <span class="token operator">!</span><span class="token operator">==</span> <span class="token number">1 </span> <span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">return</span> el<span class="token punctuation">;</span><span class= "token punctuation">}</span>el<span class="token punctuation">.</span>previousElementSibling <span class="token operator">||</span> <span class="token function">previousElementSibling<span class="token punctuation">(</span></span>el<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>              </div>            </div> <div data-browser="ie9" class="browser ie9" >              <h4>IE9+</h4>              <div data-lang="javascript" class="code-block language-javascript">                <pre class=" language-javascript"><code class=" language-javascript">el<span class="token punctuation">.</span>previousElementSibling</code></pre>              </div>            </div>          </div> <div id="remove" class="comparison">            <h3><a href="#remove">Remove</a></h3>            <div data-browser="jquery" class="browser jquery">              <h4>jQuery</h4> <div data-lang="javascript" class="code-block language-javascript">                <pre class=" language-javascript"><code class=" language-javascript">$<span class="token punctuation">(</span>el<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">remove<span class="token punctuation">( </span></span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>              </div>            </div>            <div data-browser="ie8" class= "browser ie8">              <h4>IE8+</h4>              <div data-lang="javascript" class="code-block language-javascript">                <pre class=" language-javascript"><code class=" language-javascript">el<span class="token punctuation">.</span>parentNode<span class="token punctuation">.</span><span class="token function">removeChild<span class="token punctuation">( </span></span>el<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>              </div>            </div>          </div>          <div id= "remove_class" class="comparison">            <h3><a href="#remove_class">Remove Class</a></h3>            <div data-browser="jquery" class="browser jquery">              <h4>jQuery</h4> <div data-lang="javascript" class="code-block language-javascript">                <pre class=" language-javascript"><code class=" language-javascript">$<span class="token punctuation">(</span>el<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">removeClass<span class="token punctuation">( </span></span>className<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>              </div>            </div>            <div data-browser= "ie8" class="browser ie8">              <h4>IE8+</h4>              <div data-lang="javascript" class="code-block language-javascript">                <pre class=" language-javascript" ><code class=" language-javascript"><span class="token keyword">if</span> <span class="token punctuation">(</span>el<span class="token punctuation">.</span>classList<span class="token punctuation">)</span>  el<span class="token punctuation">.</span>classList<span class="token punctuation">.</span><span class="token function">remove<span class="token punctuation">( </span></span>className<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">else</span>  el<span class="token punctuation">.</span> className <span class="token operator">=</span> el<span class="token punctuation">.</span>className<span class="token punctuation">.</span><span class="token function">replace<span class= "token punctuation">(</span></span><span class="token keyword">new</span> <span class="token class-name">RegExp</span><span class="token punctuation">(</span><span class="token string"> '(^|\\b)'</span> <span class="token operator">+</span> className<span class="token punctuation">.</span><span class="token function">split<span class="token punctuation">( </span></span><span class="token string">' '</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">join<span class="token punctuation">(</span></span><span class="token string">'|'</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'(\\b|$)' </span><span class="token punctuation">,</span> <span class="token string">'gi'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">' '</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>              </div>            </div>            <div data-browser="ie10" class="browser ie10" >              <h4>IE10+</h4>              <div data-lang="javascript" class="code-block language-javascript">                <pre class=" language-javascript"><code class=" language-javascript">el<span class="token punctuation">.</span>classList<span class="token punctuation">.</span><span class="token function">remove<span class="token punctuation">( </span></span>className<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>              </div>            </div>          </div>          <div id= "replace_from_html" class="comparison">            <h3><a href="#replace_from_html">Replace From Html</a></h3>            <div data-browser="jquery" class="browser jquery"> <h4>jQuery</h4>              <div data-lang="javascript" class="code-block language-javascript">                <pre class=" language-javascript"><code class=" language-javascript">$<span class="token punctuation">(</span>el<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">replaceWith<span class="token punctuation"> (</span></span>string<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>              </div>            </div>            <div data-browser="ie8" class="browser ie8">              <h4>IE8+</h4>              <div data-lang="javascript" class="code-block language-javascript">                <pre class=" language-javascript"><code class=" language-javascript">el<span class="token punctuation">.</span>outerHTML <span class="token operator">=</span> string<span class="token punctuation">;</span></code></pre> </div>            </div>          </div>          <div id="set_attributes" class="comparison">            <h3><a href="#set_attributes">Set Attributes</a></h3> <div data-browser="jquery" class="browser jquery">              <h4>jQuery</h4>              <div data-lang="javascript" class="code-block language-javascript">                <pre class= " language-javascript"><code class=" language-javascript">$<span class="token punctuation">(</span>el<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">attr<span class="token punctuation">(</span></span><span class="token string">'tabindex'</span><span class="token punctuation">,</span> <span class="token number">3 </span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>              </div>            </div>            <div data-browser="ie8" class= "browser ie8">              <h4>IE8+</h4>              <div data-lang="javascript" class="code-block language-javascript">                <pre class=" language-javascript"><code class=" language-javascript">el<span class="token punctuation">.</span><span class="token function">setAttribute<span class="token punctuation">(</span></span><span class="token string">'tabindex' </span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre> </div>            </div>          </div>          <div id="set_html" class="comparison">            <h3><a href="#set_html">Set Html</a></h3>            <div data-browser= "jquery" class="browser jquery">              <h4>jQuery</h4>              <div data-lang="javascript" class="code-block language-javascript">                <pre class=" language-javascript"><code class=" language-javascript">$<span class="token punctuation">(</span>el<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">html<span class="token punctuation">(</span></span>string<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre> </div>            </div>            <div data-browser="ie8" class="browser ie8">              <h4>IE8+</h4>              <div data-lang="javascript" class="code-block language-javascript"> <pre class=" language-javascript"><code class=" language-javascript">el<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> string<span class="token punctuation">;</span></code></pre>              </div>            </div>          </div>          <div id="set_style" class="comparison">            <h3><a href="#set_style"> Set Style</a></h3>            <div data-browser="jquery" class="browser jquery">              <h4>jQuery</h4>              <div data-lang="javascript" class="code-block language-javascript">                <pre class=" language-javascript"><code class=" language-javascript">$<span class="token punctuation">(</span>el<span class="token punctuation">) </span><span class="token punctuation">.</span><span class="token function">css<span class="token punctuation">(</span></span><span class="token string">'border-width'</span><span class= "token punctuation">,</span> <span class="token string">'20px'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>              </div> </div>            <div data-browser="ie8" class="browser ie8">              <h4>IE8+</h4>              <div data-lang="javascript" class="code-block language-javascript"> <pre class=" language-javascript"><code class=" language-javascript"><span class="token comment" spellcheck="true">// Use a class if possible</span>el<span class="token punctuation">.</span>style<span class="token punctuation">.</span>borderWidth <span class="token operator">=</span> <span class="token string">'20px'</span><span class="token punctuation"> ;</span></code></pre>              </div>            </div>          </div>          <div id="set_text" class="comparison">            <h3><a href="#set_text">Set Text</a></h3> <div data-browser="jquery" class="browser jquery">              <h4>jQuery</h4>              <div data-lang="javascript" class="code-block language-javascript">                <pre class= " language-javascript"><code class=" language-javascript">$<span class="token punctuation">(</span>el<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">text<span class="token punctuation">(</span></span>string<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre> </div>            </div>            <div data-browser="ie8" class="browser ie8">              <h4>IE8+</h4>              <div data-lang="javascript" class="code-block language-javascript"> <pre class=" language-javascript"><code class=" language-javascript"><span class="token keyword">if</span> <span class="token punctuation">(</span>el<span class="token punctuation">.</span>textContent <span class="token operator">!</span><span class="token operator">==</span> undefined<span class="token punctuation">)</span>  el<span class="token punctuation">.</span>textContent <span class="token operator">=</span> string<span class="token punctuation">;</span><span class="token keyword">else</span>  el<span class="token punctuation">.</span>innerText <span class="token operator">=</span> string<span class="token punctuation">;</span></code></pre>              </div>            </div>            <div data-browser="ie9" class="browser ie9" >              <h4>IE9+</h4>              <div data-lang="javascript" class="code-block language-javascript">                <pre class=" language-javascript"><code class=" language-javascript">el<span class="token punctuation">.</span>textContent <span class="token operator">=</span> string<span class="token punctuation">; </span></code></pre>              </div>            </div>          </div>          <div id="siblings" class="comparison">            <h3><a href="#siblings">Siblings</a></h3> <div data-browser="jquery" class="browser jquery">              <h4>jQuery</h4>              <div data-lang="javascript" class="code-block language-javascript">                <pre class= " language-javascript"><code class=" language-javascript">$<span class="token punctuation">(</span>el<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">siblings<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre> </div>            </div>            <div data-browser="ie8" class="browser ie8">              <h4>IE8+</h4>              <div data-lang="javascript" class="code-block language-javascript"> <pre class=" language-javascript"><code class=" language-javascript"><span class="token keyword">var</span> siblings <span class="token operator">=</span> Array<span class= "token punctuation">.</span>prototype<span class="token punctuation">.</span>slice<span class="token punctuation">.</span><span class="token function">call<span class="token punctuation">( </span></span>el<span class="token punctuation">.</span>parentNode<span class="token punctuation">.</span>children<span class="token punctuation">)</span><span class="token punctuation">; </span><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> siblings<span class= "token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">--</span><span class="token punctuation">;</span><span class="token punctuation">) </span> <span class="token punctuation">{</span>  <span class="token keyword">if</span> <span class="token punctuation">(</span>siblings<span class="token punctuation">[</span>i<span class ="token punctuation">]</span> <span class="token operator">===</span> el<span class="token punctuation">)</span> <span class="token punctuation">{</span>    siblings<span class="token punctuation">.</span><span class="token function">splice<span class="token punctuation">(</span></span>i<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">break</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">}</span></code></pre>              </div>            </div>            <div data-browser="ie9" class="browser ie9" >              <h4> IE9+</h4>              <div data-lang="javascript" class="code-block language-javascript">                <pre class=" language-javascript"><code class=" language-javascript">Array<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>filter<span class="token punctuation">.</span><span class="token function">call<span class="token punctuation">(</span></span>el<span class="token punctuation">.</span>parentNode<span class="token punctuation">.</span>children<span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>child<span class="token punctuation">)</span><span class="token punctuation">{</span>  <span class="token keyword">return </span> child <span class="token operator">!</span><span class="token operator">==</span> el<span class="token punctuation">;</span><span class="token punctuation">}</span><span class= "token punctuation">)</span><span class="token punctuation">;</span></code></pre>              </div>            </div>          </div>          <div id="toggle_class" class="comparison"> <h3><a href="#toggle_class">Toggle Class</a></h3>            <div data-browser="jquery" class="browser jquery">              <h4>jQuery</h4>              <div data-lang= "javascript" class="code-block language-javascript">                <pre class=" language-javascript"><code class=" language-javascript">$<span class="token punctuation">(</span>el<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toggleClass<span class="token punctuation">(</span></span>className<span class= "token punctuation">)</span><span class="token punctuation">;</span></code></pre>              </div>            </div>            <div data-browser="ie8" class="browser ie8"> <h4>IE8+</h4>              <div data-lang="javascript" class="code-block language-javascript">                <pre class=" language-javascript"><code class=" language-javascript"><span class="token keyword">if</span> <span class="token punctuation">(</span>el<span class="token punctuation">.</span>classList<span class="token punctuation">) </span> <span class="token punctuation">{</span>  el<span class="token punctuation">.</span>classList<span class="token punctuation">.</span><span class="token function">toggle<span class= "token punctuation">(</span></span>className<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>    <span class="token keyword">var</span> classes <span class="token operator">=</span> el<span class="token punctuation">. </span>className<span class="token punctuation">.</span><span class="token function">split<span class="token punctuation">(</span></span><span class="token string">' '</span><span class= "token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">var</span> existingIndex <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class= "token keyword">var</span> i <span class="token operator">=</span> classes<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">--</span><span class="token punctuation">;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>      <span class="token keyword">if</span> <span class="token punctuation">(</span>classes<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">===</span> className<span class="token punctuation">)</span>        existingIndex <span class="token operator">=</span> i<span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>existingIndex <span class="token operator">&gt;=</span> <span class="token number">0</span><span class="token punctuation">)</span>      classes<span class="token punctuation">.</span><span class="token function">splice<span class="token punctuation">(</span></span>existingIndex<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">else</span> classes<span class="token punctuation">.</span><span class="token function">push<span class="token punctuation">(</span></span>className<span class="token punctuation">)</span><span class= "token punctuation">;</span>  el<span class="token punctuation">.</span>className <span class="token operator">=</span> classes<span class="token punctuation">.</span><span class="token function">join<span class="token punctuation">(</span></span><span class="token string">' '</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre>              </div>            </div>            <div data-browser="ie9" class="browser ie9" >              <h4>IE9+</h4>              <div data-lang="javascript" class="code-block language-javascript">                <pre class=" language-javascript"><code class=" language-javascript"><span class="token keyword">if</span> <span class="token punctuation">(</span>el<span class="token punctuation">.</span>classList<span class="token punctuation">)</span> <span class="token punctuation">{</span>  el<span class= "token punctuation">.</span>classList<span class="token punctuation">.</span><span class="token function">toggle<span class="token punctuation">(</span></span>className<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span> <span class="token keyword">var</span> classes <span class="token operator">=</span> el<span class="token punctuation">.</span>className<span class="token punctuation">.</span><span class= "token function">split<span class="token punctuation">(</span></span><span class="token string">' '</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">var</span> existingIndex <span class="token operator">=</span> classes<span class="token punctuation">.</span><span class="token function">indexOf<span class= "token punctuation">(</span></span>className<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">if</span> <span class="token punctuation">(</span>existingIndex <span class="token operator">&gt;=</span> <span class="token number">0</span><span class="token punctuation">)</span>    classes<span class="token punctuation">.</span><span class="token function">splice<span class="token punctuation">(</span></span>existingIndex<span class="token punctuation">,</span> <span class="token number">1 </span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">else</span>    classes<span class="token punctuation">.</span><span class="token function">push<span class="token punctuation">(</span></span>className<span class="token punctuation">)</span><span class="token punctuation">;</span>  el<span class="token punctuation">.</span>className <span class="token operator">=</span> classes<span class="token punctuation">.</span><span class="token function">join<span class="token punctuation">( </span></span><span class="token string">' '</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre> </div>            </div>            <div data-browser="ie10" class="browser ie10" >              <h4>IE10+</h4>              <div data-lang="javascript" class="code-block language-javascript">                <pre class=" language-javascript"><code class=" language-javascript">el<span class="token punctuation">.</span>classList<span class="token punctuation" >.</span><span class="token function">toggle<span class="token punctuation">(</span></span>className<span class="token punctuation">)</span><span class="token punctuation">; </span></code></pre>              </div>            </div>          </div>        </div>      </section>      <section id="events">        <div class="inner">          <h2>Events</h2> <div id="off" class="comparison">            <h3><a href="#off">Off</a></h3>            <div data-browser="jquery" class="browser jquery">              <h4>jQuery</h4> <div data-lang="javascript" class="code-block language-javascript">                <pre class=" language-javascript"><code class=" language-javascript">$<span class="token punctuation">(</span>el<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">off<span class="token punctuation">(</span></span> eventName<span class="token punctuation">,</span> eventHandler<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>              </div> </div>            <div data-browser="ie8" class="browser ie8">              <h4>IE8+</h4>              <div data-lang="javascript" class="code-block language-javascript"> <pre class=" language-javascript"><code class=" language-javascript"><span class="token keyword">function</span> <span class="token function">removeEventListener<span class="token punctuation">(</span></span>el<span class="token punctuation">,</span> eventName<span class="token punctuation">,</span> handler<span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token keyword">if</span> <span class="token punctuation">(</span>el<span class="token punctuation">.</span>removeEventListener<span class="token punctuation">)</span>    el<span class="token punctuation">.</span><span class="token function">removeEventListener<span class="token punctuation">(</span></span>eventName<span class= "token punctuation">,</span> handler<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">else</span>    el<span class="token punctuation">.</span><span class="token function">detachEvent<span class="token punctuation">(</span></span><span class="token string">'on'</span> <span class="token operator">+</span> eventName<span class="token punctuation">,</span> handler<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class ="token function">removeEventListener<span class="token punctuation">(</span></span>el<span class="token punctuation">,</span> eventName<span class="token punctuation">,</span> handler <span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>              </div>            </div>            <div data-browser="ie9" class="browser ie9" > <h4>IE9+</h4>              <div data-lang="javascript" class="code-block language-javascript">                <pre class=" language-javascript"><code class=" language-javascript">el<span class="token punctuation">.</span><span class="token function">removeEventListener<span class="token punctuation">(</span></span>eventName<span class="token punctuation">,</span> eventHandler<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>              </div>            </div>          </div> <div id="on" class="comparison">            <h3><a href="#on">On</a></h3>            <div data-browser="jquery" class="browser jquery">              <h4>jQuery</h4> <div data-lang="javascript" class="code-block language-javascript">                <pre class=" language-javascript"><code class=" language-javascript">$<span class="token punctuation">( </span>el<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">on<span class="token punctuation">(</span></span>eventName<span class= "token punctuation">,</span> eventHandler<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>              </div>            </div>            <div data-browser="ie8" class="browser ie8">              <h4>IE8+</h4>              <div data-lang="javascript" class="code-block language-javascript">                <pre class=" language-javascript"><code class=" language-javascript"><span class="token keyword">function</span> <span class="token function">addEventListener<span class="token punctuation">( </span></span>el<span class="token punctuation">,</span> eventName<span class="token punctuation">,</span> handler<span class="token punctuation">)</span> <span class="token punctuation">{ </span>  <span class="token keyword">if</span> <span class="token punctuation">(</span>el<span class="token punctuation">.</span>addEventListener<span class="token punctuation">)</span> <span class="token punctuation">{</span>    el<span class="token punctuation">.</span><span class="token function">addEventListener<span class="token punctuation">(</span></span>eventName <span class="token punctuation">,</span> handler<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span> <span class= "token keyword">else</span> <span class="token punctuation">{</span>    el<span class="token punctuation">.</span><span class="token function">attachEvent<span class="token punctuation">( </span></span><span class="token string">'on'</span> <span class="token operator">+</span> eventName<span class="token punctuation">,</span> <span class="token keyword">function </span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>      handler<span class="token punctuation">.</span><span class="token function">call<span class="token punctuation">(</span></span>el<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token function">addEventListener<span class="token punctuation">(</span></span>el<span class="token punctuation">,</span> eventName<span class="token punctuation">,</span> handler <span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>              </div>            </div>            <div data-browser="ie9" class="browser ie9" > <h4>IE9+</h4>              <div data-lang="javascript" class="code-block language-javascript">                <pre class=" language-javascript"><code class=" language-javascript">el<span class="token punctuation">.</span><span class="token function">addEventListener<span class="token punctuation">(</span></span>eventName<span class="token punctuation">,</span> eventHandler<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>              </div>            </div>          </div> <div id="ready" class="comparison">            <h3><a href="#ready">Ready</a></h3>            <div data-browser="jquery" class="browser jquery">              <h4>jQuery</h4> <div data-lang="javascript" class="code-block language-javascript">                <pre class=" language-javascript"><code class=" language-javascript">$<span class="token punctuation">(</span>document<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ready<span class="token punctuation">( </span></span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class ="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>              </div>            </div>            <div data-browser="ie8" class="browser ie8">              <h4>IE8+</h4>              <div data-lang="javascript" class="code-block language-javascript">                <pre class=" language-javascript"><code class=" language-javascript"><span class="token keyword">function</span> <span class="token function">ready<span class="token punctuation">(</span></span>fn<span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token keyword">if</span> <span class="token punctuation">(</span>document<span class="token punctuation">.</span>readyState <span class="token operator">!</span><span class="token operator">=</span> <span class="token string">'loading'</span><span class="token punctuation">) </span><span class="token punctuation">{</span>    <span class="token function">fn<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span> document<span class="token punctuation">.</span>addEventListener<span class="token punctuation">)</span> <span class="token punctuation">{</span>    document<span class="token punctuation" >.</span><span class="token function">addEventListener<span class="token punctuation">(</span></span><span class="token string">'DOMContentLoaded'</span><span class="token punctuation">, </span> fn<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class= "token punctuation">{</span>    document<span class="token punctuation">.</span><span class="token function">attachEvent<span class="token punctuation">(</span></span><span class="token string">'onreadystatechange'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>      <span class="token keyword">if</span> <span class="token punctuation">(</span>document<span class="token punctuation">. </span>readyState <span class="token operator">!</span><span class="token operator">=</span> <span class="token string">'loading'</span><span class="token punctuation">)</span> <span class="token function">fn<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">} </span></code></pre>              </div>            </div>            <div data-browser="ie9" class="browser ie9" >              <h4>IE9+</h4>              <div data-lang="javascript" class="code-block language-javascript">                <pre class=" language-javascript"><code class=" language-javascript"><span class="token keyword">function</span> <span class="token function">ready<span class="token punctuation">(</span></span>fn<span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token keyword">if</span> <span class="token punctuation">(</span>document<span class="token punctuation">.</span>readyState <span class="token operator">!</span><span class="token operator">=</span> <span class= "token string">'loading'</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token function">fn<span class="token punctuation">( </span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class ="token punctuation">{</span>    document<span class="token punctuation">.</span><span class="token function">addEventListener<span class="token punctuation">(</span></span><span class= "token string">'DOMContentLoaded'</span><span class="token punctuation">,</span> fn<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">}</span></code></pre>              </div>            </div>          </div>          <div id="trigger_custom" class="comparison"> <h3><a href="#trigger_custom">Trigger Custom</a></h3>            <div class="alternatives-block">              <h4>Alternatives:</h4>              <ul class="alternatives"> <li><a href=" https://github.com/Wolfy87/EventEmitter" target="_blank">EventEmitter</a></li>                <li><a href=" https://github.com/arextar/Vine" target="_blank"> Vine</a></li>                <li><a href=" https://github.com/jeromeetienne/microevent.js" target="_blank">microevent</a></li>              </ul>            </div>            <div data-browser="jquery" class="browser jquery">              <h4>jQuery</h4>              <div data-lang="javascript" class="code-block language-javascript">                <pre class=" language-javascript"><code class=" language-javascript">$<span class="token punctuation">(</span>el<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">trigger<span class="token punctuation">(</span></span><span class="token string">'my-event'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>some<span class="token punctuation">:</span> <span class="token string">'data'</span><span class="token punctuation">}</span><span class="token punctuation">) </span><span class="token punctuation">;</span></code></pre>              </div>            </div>            <div data-browser="ie8" class="browser ie8">              <h4>IE8+</h4> <div data-lang="javascript" class="code-block language-javascript">                <pre class=" language-javascript"><code class=" language-javascript"><span class="token comment" spellcheck="true">// Custom events are not natively supported, so you have to hijack a random</span><span class="token comment" spellcheck="true">// event.</span><span class= "token comment" spellcheck="true">//</span><span class="token comment" spellcheck="true">// Just use jQuery.</span></code></pre>              </div>            </div>            <div data-browser="ie9" class="browser ie9" >              <h4>IE9+</h4>              <div data-lang="javascript" class="code-block language-javascript">                <pre class=" language-javascript"><code class=" language-javascript"><span class="token keyword">if</span> <span class="token punctuation">(</span>window<span class="token punctuation">.</span> CustomEvent<span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token keyword">var</span> event <span class="token operator">=</span> <span class ="token keyword">new</span> <span class="token class-name">CustomEvent</span><span class="token punctuation">(</span><span class="token string">'my-event'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>detail<span class="token punctuation">:</span> <span class="token punctuation">{</span>some<span class="token punctuation">: </span> <span class="token string">'data'</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>  <span class="token keyword">var</span> event <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createEvent<span class="token punctuation">(</span></span><span class="token string">'CustomEvent'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  event<span class="token punctuation">.</span><span class="token function">initCustomEvent<span class="token punctuation">(</span></span><span class="token string">'my-event'</span><span class="token punctuation">,</span> <span class="token boolean"> true</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>some<span class= "token punctuation">:</span> <span class="token string">'data'</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">; </span><span class="token punctuation">}</span>el<span class="token punctuation">.</span><span class="token function">dispatchEvent<span class="token punctuation">(</span></span>event<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>              </div>            </div>          </div>          <div id="trigger_native" class= "comparison">            <h3><a href="#trigger_native">Trigger Native</a></h3>            <div data-browser="jquery" class="browser jquery">              <h4>jQuery</h4>              <div data-lang="javascript" class="code-block language-javascript">                <pre class=" language-javascript"><code class=" language-javascript">$<span class="token punctuation">(</span> el<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">trigger<span class="token punctuation">(</span></span><span class="token string">'change'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>              </div>            </div>            <div data-browser= "ie8" class="browser ie8">              <h4>IE8+</h4>              <div data-lang="javascript" class="code-block language-javascript">                <pre class=" language-javascript" ><code class=" language-javascript"><span class="token keyword">if</span> <span class="token punctuation">(</span>document<span class="token punctuation">.</span>createEvent<span class= "token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token keyword">var</span> event <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createEvent<span class="token punctuation">(</span></span><span class="token string">'HTMLEvents'</span><span class="token punctuation">) </span><span class="token punctuation">;</span>  event<span class="token punctuation">.</span><span class="token function">initEvent<span class="token punctuation">(</span></span><span class="token string">'change'</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token boolean"> false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  el<span class="token punctuation">.</span><span class="token function">dispatchEvent<span class="token punctuation">(</span></span>event<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>  el<span class="token punctuation">.</span><span class="token function">fireEvent<span class="token punctuation">( </span></span><span class="token string">'onchange'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">} </span></code></pre>              </div>            </div>            <div data-browser="ie9" class="browser ie9" >              <h4>IE9+</h4>              <div data-lang="javascript" class="code-block language-javascript">                <pre class=" language-javascript"><code class=" language-javascript"><span class="token comment" spellcheck="true">// For a full list of event types: https://developer.mozilla.org/en-US/docs/Web/API/document.createEvent</span><span class="token keyword">var</span> event <span class="token operator">=</span> document <span class="token punctuation">.</span><span class="token function">createEvent<span class="token punctuation">(</span></span><span class="token string">'HTMLEvents'</span><span class= "token punctuation">)</span><span class="token punctuation">;</span>event<span class="token punctuation">.</span><span class="token function">initEvent<span class="token punctuation">( </span></span><span class="token string">'change'</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class ="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>el<span class="token punctuation">.</span><span class="token function"> dispatchEvent<span class="token punctuation">(</span></span>event<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>              </div> </div>          </div>        </div>      </section>      <section id="utils" class="odd">        <div class="inner">          <h2>Utils</h2>          <div id="array_each" class="comparison">            <h3><a href="#array_each">Array Each</a></h3>            <div data-browser="jquery" class="browser jquery">              <h4>jQuery</h4>              <div data-lang="javascript" class="code-block language-javascript">                <pre class=" language-javascript"><code class=" language-javascript">$<span class="token punctuation">. </span><span class="token function">each<span class="token punctuation">(</span></span>array<span class="token punctuation">,</span> <span class="token keyword">function</span><span class= "token punctuation">(</span>i<span class="token punctuation">,</span> item<span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">} </span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>              </div>            </div>            <div data-browser="ie8" class= "browser ie8">              <h4>IE8+</h4>              <div data-lang="javascript" class="code-block language-javascript">                <pre class=" language-javascript"><code class=" language-javascript"><span class="token keyword">function</span> <span class="token function">forEach<span class="token punctuation">(</span></span>array<span class="token punctuation">, </span> fn<span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class= "token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> array<span class="token punctuation">. </span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>    <span class="token function">fn<span class="token punctuation">(</span></span>array<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> i<span class="token punctuation"> )</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token function">forEach<span class="token punctuation">(</span></span>array<span class= "token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>item<span class="token punctuation">,</span> i<span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">; </span></code></pre>              </div>            </div>            <div data-browser="ie9" class="browser ie9" >              <h4>IE9+</h4>              <div data-lang="javascript" class="code-block language-javascript">                <pre class=" language-javascript"><code class=" language-javascript">array<span class="token punctuation">.</span><span class="token function">forEach<span class="token punctuation">(</span></span><span class="token keyword">function</span><span class="token punctuation">(</span>item<span class="token punctuation">, </span> i<span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>              </div>            </div>          </div>          <div id="deep_extend" class="comparison">            <h3><a href="#deep_extend">Deep Extend</a></h3>            <div data-browser="jquery" class="browser jquery">              <h4>jQuery</h4>              <div data-lang="javascript" class="code-block language-javascript"> <pre class=" language-javascript"><code class=" language-javascript">$<span class="token punctuation">.</span><span class="token function">extend<span class="token punctuation">(</span></span><span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token punctuation">} </span><span class="token punctuation">,</span> objA<span class="token punctuation">,</span> objB<span class="token punctuation">)</span><span class="token punctuation">; </span></code></pre>              </div>            </div>            <div data-browser="ie8" class="browser ie8">              <h4>IE8+</h4>              <div data-lang="javascript" class ="code-block language-javascript">                <pre class=" language-javascript"><code class=" language-javascript"><span class="token keyword">var</span> deepExtend <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>out<span class="token punctuation">)</span> <span class="token punctuation">{</span> out <span class="token operator">=</span> out <span class="token operator">||</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> arguments<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">var</span> obj <span class="token operator">=</span> arguments<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class= "token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>obj<span class="token punctuation">)</span>      <span class="token keyword">continue </span><span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> key <span class= "token keyword">in</span> obj<span class="token punctuation">)</span> <span class="token punctuation">{</span>      <span class="token keyword">if</span> <span class="token punctuation">( </span>obj<span class="token punctuation">.</span><span class="token function">hasOwnProperty<span class="token punctuation">(</span></span>key<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> obj<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">===</span> <span class="token string">'object' </span><span class="token punctuation">)</span>          <span class="token function">deepExtend<span class="token punctuation">(</span></span>out<span class="token punctuation">[</span> key<span class="token punctuation">]</span><span class="token punctuation">,</span> obj<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class= "token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">else</span>          out<span class="token punctuation">[</span>key<span class= "token punctuation">]</span> <span class="token operator">=</span> obj<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">; </span>      <span class="token punctuation">}</span>    <span class="token punctuation">}</span>  <span class="token punctuation">}</span>  <span class="token keyword">return</span> out <span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token function">deepExtend<span class="token punctuation">(</span></span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> objA<span class="token punctuation">, </span> objB<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>              </div>            </div>          </div>          <div id="bind" class="comparison">            <h3><a href="#bind">Bind</a></h3>            <div data-browser="jquery" class="browser jquery">              <h4>jQuery</h4>              <div data-lang= "javascript" class="code-block language-javascript">                <pre class=" language-javascript"><code class=" language-javascript">$<span class="token punctuation">.</span><span class="token function">proxy<span class="token punctuation">(</span></span>fn<span class="token punctuation">,</span> context<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>              </div>            </div>            <div data-browser="ie8" class="browser ie8">              <h4>IE8+</h4>              <div data-lang= "javascript" class="code-block language-javascript">                <pre class=" language-javascript"><code class=" language-javascript">fn<span class="token punctuation">.</span><span class="token function">apply<span class="token punctuation">(</span></span>context<span class="token punctuation">,</span> arguments<span class="token punctuation">)</span><span class= "token punctuation">;</span></code></pre>              </div>            </div>            <div data-browser="ie9" class="browser ie9" >              <h4>IE9+</h4>              <div data-lang="javascript" class="code-block language-javascript">                <pre class=" language-javascript"><code class=" language-javascript">fn<span class="token punctuation">. </span><span class="token function">bind<span class="token punctuation">(</span></span>context<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre> </div>            </div>          </div>          <div id="extend" class="comparison">            <h3><a href="#extend">Extend</a></h3>            <div class= "alternatives-block">              <h4>Alternatives:</h4>              <ul class="alternatives">                <li><a href=" http://lodash.com/docs#assign" target="_blank">lo-dash </a></li>                <li><a href=" http://underscorejs.org/#extend" target="_blank">underscore</a></li>                <li><a href=" http://www.2ality.com/2014/01/object-assign.html" target="_blank">ECMA6</a></li>              </ul>            </div>            <div data-browser="jquery" class="browser jquery">              <h4>jQuery</h4>              <div data-lang= "javascript" class="code-block language-javascript">                <pre class=" language-javascript"><code class=" language-javascript">$<span class="token punctuation">.</span><span class="token function">extend<span class="token punctuation">(</span></span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation"> ,</span> objA<span class="token punctuation">,</span> objB<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>              </div> </div>            <div data-browser="ie8" class="browser ie8">              <h4>IE8+</h4>              <div data-lang="javascript" class="code-block language-javascript"> <pre class=" language-javascript"><code class=" language-javascript"><span class="token keyword">var</span> extend <span class="token operator">=</span> <span class="token keyword"> function</span><span class="token punctuation">(</span>out<span class="token punctuation">)</span> <span class="token punctuation">{</span>  out <span class="token operator">=</span> out <span class="token operator">||</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>  <span class="token keyword" >for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> arguments<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>arguments<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>      <span class="token keyword">continue</span><span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> key <span class="token keyword">in</span> arguments<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class= "token punctuation">{</span>      <span class="token keyword">if</span> <span class="token punctuation">(</span>arguments<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">hasOwnProperty<span class="token punctuation">(</span></span>key<span class="token punctuation">) </span><span class="token punctuation">)</span>        out<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> arguments<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class= "token punctuation">;</span>    <span class="token punctuation">}</span>  <span class="token punctuation">}</span>  <span class="token keyword">return</span> out<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token function">extend<span class="token punctuation">(</span></span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> objA<span class="token punctuation">,</span> objB<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>              </div>            </div>          </div>          <div id="index_of" class="comparison"> <h3><a href="#index_of">Index Of</a></h3>            <div data-browser="jquery" class="browser jquery">              <h4>jQuery</h4>              <div data-lang="javascript" class= "code-block language-javascript">                <pre class=" language-javascript"><code class=" language-javascript">$<span class="token punctuation">.</span><span class="token function"> inArray<span class="token punctuation">(</span></span>item<span class="token punctuation">,</span> array<span class="token punctuation">)</span><span class="token punctuation">; </span></code></pre>              </div>            </div>            <div data-browser="ie8" class="browser ie8">              <h4>IE8+</h4>              <div data-lang="javascript" class ="code-block language-javascript">                <pre class=" language-javascript"><code class=" language-javascript"><span class="token keyword">function</span> <span class="token function">indexOf<span class="token punctuation">(</span></span>array<span class="token punctuation">,</span> item<span class="token punctuation">)</span> <span class="token punctuation">{ </span>  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> array<span class="token punctuation">.</span>length<span class="token punctuation">; </span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">if</span> <span class= "token punctuation">(</span>array<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">===</span> item<span class="token punctuation">)</span>      <span class="token keyword">return</span> i<span class="token punctuation">;</span>  <span class="token punctuation">}</span>  <span class="token keyword">return </span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token function" >indexOf<span class="token punctuation">(</span></span>array<span class="token punctuation">,</span> item<span class="token punctuation">)</span><span class="token punctuation">; </span></code></pre>              </div>            </div>            <div data-browser="ie9" class="browser ie9" >              <h4>IE9+</h4>              <div data-lang="javascript" class="code-block language-javascript">                <pre class=" language-javascript"><code class=" language-javascript">array<span class="token punctuation">.</span><span class="token function">indexOf<span class="token punctuation">(</span></span>item<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>              </div> </div>          </div>          <div id="is_array" class="comparison">            <h3><a href="#is_array">Is Array</a></h3>            <div data-browser="jquery" class= "browser jquery">              <h4>jQuery</h4>              <div data-lang="javascript" class="code-block language-javascript">                <pre class=" language-javascript"><code class =" language-javascript">$<span class="token punctuation">.</span><span class="token function">isArray<span class="token punctuation">(</span></span>arr<span class="token punctuation">) </span><span class="token punctuation">;</span></code></pre>              </div>            </div>            <div data-browser="ie8" class="browser ie8">              <h4>IE8+</h4> <div data-lang="javascript" class="code-block language-javascript">                <pre class=" language-javascript"><code class=" language-javascript">isArray <span class= "token operator">=</span> Array<span class="token punctuation">.</span>isArray <span class="token operator">||</span> <span class="token keyword">function</span><span class="token punctuation">(</span>arr<span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token keyword">return</span> Object<span class="token punctuation">. </span>prototype<span class="token punctuation">.</span>toString<span class="token punctuation">.</span><span class="token function">call<span class="token punctuation">(</span></span>arr <span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token string">'[object Array]'</span><span class="token punctuation">;</span><span class= "token punctuation">}</span><span class="token function">isArray<span class="token punctuation">(</span></span>arr<span class="token punctuation">)</span><span class="token punctuation">; </span></code></pre>              </div>            </div>            <div data-browser="ie9" class="browser ie9" >              <h4>IE9+</h4>              <div data-lang="javascript" class="code-block language-javascript">                <pre class=" language-javascript"><code class=" language-javascript">Array<span class="token punctuation">.</span><span class="token function">isArray<span class="token punctuation">(</span></span>arr<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>              </div> </div>          </div>          <div id="map" class="comparison">            <h3><a href="#map">Map</a></h3>            <div data-browser="jquery" class="browser jquery"> <h4>jQuery</h4>              <div data-lang="javascript" class="code-block language-javascript">                <pre class=" language-javascript"><code class=" language-javascript">$<span class="token punctuation">.</span><span class="token function">map<span class="token punctuation">(</span></span>array<span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>value<span class="token punctuation">,</span> index<span class="token punctuation">)</span><span class= "token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>              </div> </div>            <div data-browser="ie8" class="browser ie8">              <h4>IE8+</h4>              <div data-lang="javascript" class="code-block language-javascript"> <pre class=" language-javascript"><code class=" language-javascript"><span class="token keyword">function</span> <span class="token function">map<span class="token punctuation">(</span></span>arr<span class="token punctuation">,</span> fn<span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token keyword">var </span> results <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>  <span class= "token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> arr<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>    results<span class="token punctuation">.</span><span class="token function">push<span class="token punctuation">( </span></span><span class="token function">fn<span class="token punctuation">(</span></span>arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class= "token punctuation">,</span> i<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">return </span> results<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token function">map<span class="token punctuation">(</span></span>array<span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>value<span class="token punctuation">,</span> index<span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">; </span></code></pre>              </div>            </div>            <div data-browser="ie9" class="browser ie9" >              <h4>IE9+</h4>              <div data-lang="javascript" class="code-block language-javascript">                <pre class=" language-javascript"><code class=" language-javascript">array<span class="token punctuation">.</span><span class="token function">map<span class="token punctuation">(</span></span><span class="token keyword">function</span><span class="token punctuation">(</span>value<span class="token punctuation">,</span> index<span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>              </div>            </div>          </div>          <div id="now" class="comparison">            <h3><a href="#now">Now</a></h3> <div data-browser="jquery" class="browser jquery">              <h4>jQuery</h4>              <div data-lang="javascript" class="code-block language-javascript">                <pre class= " language-javascript"><code class=" language-javascript">$<span class="token punctuation">.</span><span class="token function">now<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>              </div>            </div>            <div data-browser="ie8" class="browser ie8"> <h4>IE8+</h4>              <div data-lang="javascript" class="code-block language-javascript">                <pre class=" language-javascript"><code class=" language-javascript"><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getTime<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation" >;</span></code></pre>              </div>            </div>            <div data-browser="ie9" class="browser ie9" >              <h4>IE9+</h4>              <div data-lang="javascript" class="code-block language-javascript">                <pre class=" language-javascript"><code class=" language-javascript">Date<span class="token punctuation">.</span><span class="token function">now<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>              </div> </div>          </div>          <div id="parse_html" class="comparison">            <h3><a href="#parse_html">Parse Html</a></h3>            <div data-browser="jquery" class="browser jquery">              <h4>jQuery</h4>              <div data-lang="javascript" class="code-block language-javascript">                <pre class=" language-javascript"><code class=" language-javascript">$<span class="token punctuation">.</span><span class="token function">parseHTML<span class="token punctuation">(</span></span>htmlString<span class="token punctuation" >)</span><span class="token punctuation">;</span></code></pre>              </div>            </div>            <div data-browser="ie8" class="browser ie8">              <h4>IE8+</h4> <div data-lang="javascript" class="code-block language-javascript">                <pre class=" language-javascript"><code class=" language-javascript"><span class="token keyword">var</span> parseHTML <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>str<span class="token punctuation">) </span> <span class="token punctuation">{</span>  <span class="token keyword">var</span> el <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement<span class="token punctuation">(</span></span><span class="token string">'div'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  el<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> str<span class="token punctuation">;</span>  <span class="token keyword"> return</span> el<span class="token punctuation">.</span>children<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">; </span><span class="token function">parseHTML<span class="token punctuation">(</span></span>htmlString<span class="token punctuation">)</span><span class="token punctuation">; </span></code></pre>              </div>            </div>            <div data-browser="ie9" class="browser ie9" >              <h4>IE9+</h4>              <div data-lang="javascript" class="code-block language-javascript">                <pre class=" language-javascript"><code class=" language-javascript"><span class="token keyword">var</span> parseHTML <span class= "token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span> <span class="token punctuation">{ </span>  <span class="token keyword">var</span> tmp <span class="token operator">=</span> document<span class="token punctuation">.</span>implementation<span class="token punctuation">. </span><span class="token function">createHTMLDocument<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>  tmp <span class="token punctuation">.</span>body<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> str<span class="token punctuation">;</span>  <span class ="token keyword">return</span> tmp<span class="token punctuation">.</span>body<span class="token punctuation">.</span>children<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token function">parseHTML<span class="token punctuation">(</span></span>htmlString<span class="token punctuation"> )</span><span class="token punctuation">;</span></code></pre>              </div>            </div>          </div>          <div id="parse_json" class="comparison">            <h3><a href ="#parse_json">Parse Json</a></h3>            <div data-browser="jquery" class="browser jquery">              <h4>jQuery</h4>              <div data-lang="javascript" class="code-block language-javascript">                <pre class=" language-javascript"><code class=" language-javascript">$<span class="token punctuation">.</span><span class="token function">parseJSON <span class="token punctuation">(</span></span>string<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>              </div>            </div> <div data-browser="ie8" class="browser ie8">              <h4>IE8+</h4>              <div data-lang="javascript" class="code-block language-javascript">                <pre class=" language-javascript"><code class=" language-javascript">JSON<span class="token punctuation">.</span><span class="token function">parse<span class="token punctuation">( </span></span>string<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>              </div>            </div>          </div>          <div id= "trim" class="comparison">            <h3><a href="#trim">Trim</a></h3>            <div data-browser="jquery" class="browser jquery">              <h4>jQuery</h4>              <div data-lang="javascript" class="code-block language-javascript">                <pre class=" language-javascript"><code class=" language-javascript">$<span class="token punctuation">. </span><span class="token function">trim<span class="token punctuation">(</span></span>string<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre> </div>            </div>            <div data-browser="ie8" class="browser ie8">              <h4>IE8+</h4>              <div data-lang="javascript" class="code-block language-javascript">                <pre class=" language-javascript"><code class=" language-javascript">string<span class="token punctuation">.</span><span class="token function">replace <span class="token punctuation">(</span></span><span class="token regex">/^\s+|\s+$/g</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>              </div>            </div>            <div data-browser="ie9" class="browser ie9" >              <h4> IE9+</h4>              <div data-lang="javascript" class="code-block language-javascript">                <pre class=" language-javascript"><code class=" language-javascript">string<span class="token punctuation">.</span><span class="token function">trim<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">; </span></code></pre>              </div>            </div>          </div>          <div id="type" class="comparison">            <h3><a href="#type">Type</a></h3>            <div data-browser="jquery" class="browser jquery">              <h4>jQuery</h4>              <div data-lang="javascript" class="code-block language-javascript">                <pre class=" language-javascript"><code class=" language-javascript">$<span class="token punctuation">.</span><span class="token function">type<span class="token punctuation">(</span></span>obj<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>              </div>            </div>            <div data-browser="ie8" class="browser ie8"> <h4>IE8+</h4>              <div data-lang="javascript" class="code-block language-javascript">                <pre class=" language-javascript"><code class=" language-javascript">Object<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>toString<span class="token punctuation">.</span><span class="token function">call<span class="token punctuation">(</span></span>obj<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">replace<span class="token punctuation">(</span></span><span class="token regex">/^\[object (.+)\]$/</span><span class="token punctuation">,</span> <span class="token string">"$1"</span><span class= "token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toLowerCase<span class="token punctuation">(</span></span><span class="token punctuation">) </span><span class="token punctuation">;</span></code></pre>              </div>            </div>          </div>        </div>      </section>    </div>			</div> <!--=========================			END : POST		=============================-->		<!--=========================			START : POST =============================-->		<div class="post-wrapper">		<h1>Getting Out of Binding Situations in JavaScript</h1>		<div class="main-content" itemprop="articleBody"> <p>Most developers don't know about-or don't care enough about-binding in JavaScript. Yet this single issue is responsible for a sizeable portion of the questions on most JavaScript-related support channels, and thousands-if not millions-of hairs being tortured away from developer heads every single day. Yet with a little attention to this oft-overlooked subject, you can avoid wasting your time, energy, and patience and move on to more powerful, efficient scripting.</p><h2 id="section1">Why should we care about binding?<a class= "subhead-anchor" href="#section1">#section1</a></h2>				<div class="aside-breaker"><b>Article Continues Below</b></div>						<p>Almost no major object-oriented programming (OOP) languages force you to consider <em>binding</em>. That is, they don't require you to explicitly qualify access to the current object's members (methods and properties) with a reference such as <strong><code>this</code></strong> or <strong><code>self</code></strong>. If you're calling a method on no particular object, you're usually calling it on the current object. The same goes when you're passing a method around for later invocation: it will retain its current object. In short, for most <span class="caps">OOP</span> languages, binding is <em>implicit</em>. This is true in Java, C#, Ruby, Delphi, and C++, to name but a few.</p><p><span class="caps">PHP</span> and JavaScript do require you to explicitly state which object you're accessing, even if it's the current one. (And that is about as far as I'm willing to put <span class="caps">PHP</span> and JavaScript in the same basket.)</p><p>Of course, neither <span class="caps">PHP</span> nor JavaScript are actually object-oriented in the traditional sense. In the case of <span class="caps">PHP</span>, object support was added, rather slapdash, as an afterthought; even in <span class="caps">PHP5</span>, functions are not first-order values, and many <span class="caps">OOP</span> features are lackluster.&nbsp; JavaScript is very dynamic and relies on "prototypal inheritance," which is a significantly different paradigm than class-based inheritance. Such distinctions do not immediately relate to binding issues, but demonstrate that traditional object-related syntaxes and behaviors were of little importance to the designers of JavaScript.</p><p>In JavaScript, binding is always explicit, and can easily be <em>lost</em>, so a method using <strong><code>this</code></strong> will not refer to the proper object in all situations, unless you force it to. Overall, binding in JavaScript is not a difficult concept, but it is far too often ignored or glossed over by JavaScripters, which leads to confusion.</p><h2 id="section2">Let's step in it<a class= "subhead-anchor" href="#section2">#section2</a></h2><p>Consider the following, innocuous-looking examples, and how their actual behavior can seem unpredictable.</p><pre id="snippet1">var john = {  name: 'John',  greet: function(person) {    alert("Hi " + person + ", my name is " + name);  }};john.greet("Mark");// =&gt; "Hi Mark, my name is " </pre><p>Okay, that's weird. Where did the name go?&nbsp; Well, we were guilty of a binding assumption here: our method just refers to <code>name</code>, which JavaScript will look for in the several valid levels of variables, ending up with the properties of the <strong><code>window</code></strong> object. Of course our window does have a <code>name</code> property, but it's empty by default, so no name shows up.</p><p>Let's try it out:</p><pre id="snippet2">name = 'Ray'; // Or explictly: window.name = 'Ray';var john = {  name: 'John',  greet: function(person) {    alert("Hi " + person + ", my name is " + name);  }};john.greet("Mark");// =&gt; "Hi Mark, my name is Ray" </pre><p>Well, that's just dandy, but useless. What we want is our object's <code>name</code> property, not the one in <code>window</code>!&nbsp; Here is where explicit binding is important:</p><pre id="snippet3">var john = {  name: 'John',  greet: function(person) {    alert("Hi " + person + ", my name is " + this.name);  }};john.greet("Mark");// =&gt; "Hi Mark, my name is John" </pre><p>Notice how we prefix our reference to <code>name</code> with the keyword <strong><code>this</code></strong>: that's explicit binding. And indeed it works!&nbsp; Or does it? (Line wraps marked » <em>-Ed.</em>)</p><pre id="snippet4">var john = {  name: 'John', greet: function(person) {    alert("Hi " + person + ", my name is " + this.name);  }};var fx = john.greet;fx("Mark");// =&gt; "Hi Mark, my name is " (or "Hi Mark, my name »is Ray" depending on where you're trying it) </pre><p>Perhaps you're not familiar with languages that treat functions as first-order values, in which case the line <code>var fx = john.greet; </code> may seem weird. This does <em>not</em> call the <code>greet</code> method, but creates a reference to it-an alias of sorts, if you will.&nbsp; Hence, calling <code>fx</code> ends up calling the <code>greet</code> method. However, we're apparently in some trouble all of a sudden: we're explicitly using the <strong><code>this</code></strong> keyword, yet it does not use John. What gives?</p><p>This is the <em>single most important issue with JavaScript binding</em>-something I'll refer to as "binding loss."&nbsp; It happens <em>whenever you're accessing a method through a reference instead of directly through its owner object</em>. The method loses its implicit binding, and <strong><code>this</code></strong> stops referencing its owner object and goes back to its default value, which in this case is <code>window</code> (so if <code>window</code> had a <code>name</code> property by then, it would be used). </p><h3 id="section3">Recognizing binding-sensitive code patterns<a class="subhead-anchor" href="#section3">#section3</a></h3><p>Binding-sensitive code patterns involve passing method references, which usually happens through two possible means: either you're assigning a method as a value, or you're passing a method as an argument (which is essentially the same thing, when you think about it).</p><p>Consider the following simple class definition (Line wraps marked » <em>-Ed.</em>):</p><pre id="snippet5">function Person(first, last, age) {  this.first = first;  this.last = last;  this.age = age;}Person.prototype = {  getFullName: function() {    alert(this.first + ' ' + this.last);  },  greet: function(other) {    alert("Hi " + other.first + ", I'm " + »    this.first + ".");  }};</pre><p>Let's try it out (Line wraps marked » <em>-Ed.</em>):</p><pre id="snippet6">var elodie = new Person('Elodie', 'Jaubert', 27);var christophe = new Person('Christophe', »'Porteneuve', 30);christophe.greet(elodie);// =&gt; "Hi Elodie, I'm Christophe." </pre><p>Looking good so far.&nbsp; Let's push ahead: </p><pre id="snippet7">function times(n, fx, arg) {  for (var index = 0; index &lt; n; ++index) {    fx(arg);  }}times(3, christophe.greet, elodie);// =&gt; Three times "Hi Elodie, I'm undefined." times(1, elodie.getFullName);// =&gt; "undefined undefined"</pre><p>Whoa-we're in trouble!&nbsp; What's with the undefined? We lost our binding when we passed <code>greet </code> and <code>getFullName</code> as arguments, so their <strong><code>this</code></strong> reference points to the <code>window</code> object, which does not have the <code>first </code> and <code>last</code> properties.&nbsp; Boom.</p><p>When you do all your JavaScript heavy lifting by hand, as we just did, you're usually more aware of such issues. But when you rely on a framework to handle the basics, binding can elude you, leaving you writing simple code that just borks. Consider the following <a href="http://prototypejs.org/">Prototype-based </a> snippet:</p><pre id="snippet8">this.items.each(function(item) {  // Process item  this.markItemAsProcessed(item);});</pre><p>This code will trigger an error stating that the <code> markItemAsProcessed</code> method is undefined.&nbsp; Why is that?&nbsp; Because you just passed <code>each</code> a reference to an anonymous function, so <strong><code>this </code></strong> in there refers to <code>window</code>, not to what it was outside <code>each</code>. This is a <em>very</em> common mistake, and makes up a fair share of the questions on the framework mailing lists.</p><h2 id="section4">Binding explicitly<a class="subhead-anchor" href="#section4">#section4</a></h2><p>So how do we fix it?&nbsp; We bind explicitly-that is, we <em>explicitly state to what <strong><code>this</code></strong> will point to within the method when it gets called</em>.&nbsp; And how do we do that?&nbsp; JavaScript provides us with two options: <code>apply</code> and <code>call</code>.</p><h3 id="section5">Apply within<a class="subhead-anchor" href="#section5">#section5</a></h3><p>Every JavaScript function is equipped with an <code>apply</code> method that allows you to call that function with specific binding (a specific <strong><code>this</code></strong>, if you will).&nbsp; It takes two arguments: the binding object, and an array of the arguments to be passed to the function. Here's an example based on our previous code:</p><pre id="snippet9">var fx = christophe.greet;fx.apply(christophe, [elodie]);// =&gt; "Hi Elodie, I'm Christophe." </pre><p>The nice thing with an array is, you don't need to know in advance which arguments the function you'll call <code>apply</code> on will take. You can write code independent of the actual <em>argument list</em>-just construct the array any way you want, and pass it on.&nbsp; You can also take an existing array of arguments and tweak it to your heart's content before passing it along.</p><h3 id="section6">Call now<a class="subhead-anchor" href="#section6"> #section6</a></h3><p>When you do know exactly which arguments you want to pass, <code>call</code> may feel nicer, as it takes the arguments themselves, not an array of them:</p><pre id= "snippet10">var fx = christophe.greet;fx.call(christophe, elodie);// =&gt; "Hi Elodie, I'm Christophe." </pre><p>However, with <code>call</code> you lose the flexibility of an array. It all depends on your particular situation: aside from this difference, <code>apply</code> and <code>call</code> have identical semantics and behavior.</p><p>Note, by the way, that the method does not actually need to belong to the object you're binding it to: as long as it uses <strong><code>this</code></strong> in ways that are compatible with its binding (read: with members that exist in its bound object), we're in the clear. Such flexibility is possible because JavaScript is a dynamic language that resolves member access at runtime-when the access happens-a feature sometimes referred to as "late binding." You'll also find late binding in just about every scripting language (e.g., Perl, Ruby, Python, <span class="caps">PHP</span>) and, incidentally, <span class="caps">OLE </span>Automation.</p><h3 id="section7">Losing the shackles<a class="subhead-anchor" href="#section7">#section7</a></h3><p>It's nice to have a way to specify binding, but the problem is, you can only specify it at invocation time.&nbsp; You can't, say, specify it in advance and then let some other code invoke your properly bound method when it sees fit.&nbsp; This is a major problem, because when we pass method references around, we're doing just that: letting other code choose when to invoke methods.</p><p>So what we want is a way to <em>persistently</em> bind a method, so that we get a bound method reference, so to speak. The only way to achieve this requires us to wrap our original method in another one, that will perform the <code>apply</code> call.&nbsp; Here's a stab at it:</p><pre id="snippet11">function createBoundedWrapper(object, method) {  return function() { return method.apply(object, arguments);  };}</pre><p>If you're not too keen on JavaScript, the code above may confuse you a bit. The idea here is that calling <code>createBoundedWrapper </code> with a given object and method (which, presumably, belongs to said object) will produce a brand new function (the anonymous one we're returning).</p><p><br>That function, <em>when called</em>, will take our original method and invoke <code>apply</code> on it, passing:<br></p><ol> <li>the original object's binding (the variable named <code>object</code>), and </li><li>whatever arguments were provided at call time, as an array.</li> </ol><p>(Every function has an automatic <code>arguments</code> variable that behaves as an array of all the arguments that were passed to it.)</p><p>Let's try it out (Line wraps marked » <em>-Ed.</em>):</p><pre id="snippet12">var chrisGreet = createBoundedWrapper(christophe, »christophe.greet);chrisGreet(elodie);// "Hi Elodie, I'm Christophe." </pre><p>Ah-ha!&nbsp; It works!&nbsp; We created a bound method reference based on <code>christophe</code> and its <code>greet</code> method.</p><h2 id="section8">JavaScript frameworks do it<a class="subhead-anchor" href="#section8">#section8</a></h2><p>Our <code>createBoundedWrapper</code> function is neat, but may prove a bit unwieldy. If you're smart about your JavaScript work, you'll probably rely on a framework to smooth out browser incompatibilities, ease <span class="caps">DOM </span> access, and enhance JavaScript. So let's have a look at how a few popular JavaScript frameworks deal with method binding.</p><h3 id="section9">Prototype<a class="subhead-anchor" href="#section9">#section9</a></h3><p><a href="http://prototypejs.org/">Prototype</a> has long equipped functions with a <code>bind</code> method that lets you do just that:</p><pre id= "snippet13">var chrisGreet = christophe.greet.bind(christophe);chrisGreet(elodie);</pre><p>Far too few people know that <code>bind</code> also allows you to do "partial application"-that is, pre-filling one or more arguments. For instance, let's say you have a method that toggles the active status of a feature:</p><pre id="snippet14">var coolBehavior = {  // ...  toggle: function(enabled) {    this.enabled = enabled;    // ...  },  // ...};</pre><p>You can easily define two shortcuts-<code>enable</code> and <code>disable</code>-in the following way (Line wraps marked » <em>-Ed.</em>):</p><pre id="snippet15">coolBehavior.enable = coolBehavior.toggle.bind »(coolBehavior, true);coolBehavior.disable = coolBehavior.toggle.bind »(coolBehavior, false);// And then:coolBehavior.enable();</pre><p>A note on proper usage: sometimes, <code>bind</code> was used for pre-filling only, without interest in the binding.&nbsp; Something like the following may be seen in code:</p><pre id="snippet16">function times (count, fx) {  for (var index = 0; index &lt; count; ++index) {    fx();  }}// ...var threeTimes = times.bind(null, 3);// ...threeTimes(someFunction);</pre><p>So as a side note, with Prototype 1.6, if you're only interested in pre-filling, prefer <code>curry</code>-it preserves the current binding and focuses on argument pre-filling:</p><pre id="snippet17">var threeTimes = times.curry(3);</pre><h2 id="ext_js">Ext JS<a class="subhead-anchor" href="#ext_js">#ext_js </a></h2><p>The <a href="http://www.sencha.com/products/extjs/">Ext JS</a> library tailors binding through a method added to functions, called <code>createDelegate</code>. The syntax goes like this (Line wraps marked » <em>-Ed.</em>):</p><pre id="snippet18">method.createDelegate(scope[, argArray] »[, appendArgs = false])</pre><p>First, note that the extra arguments you may specify are provided as an array, instead of inline: <code>myMethod.createDelegate(scope, [arg1, arg2])</code>, <em>not</em> <code>myMethod.createDelegate(scope, arg1, arg2)</code>.</p><p> Another important nuance is that these arguments will <em>replace</em> whatever arguments you pass at call time, instead of resulting in partial application. If you want the latter, you need to pass <code>true</code> (which will append the argument array, when Prototype would prepend them instead) or an insert position as a third argument (typically, using zero will prepend).&nbsp; Here's an example lifted from the <span class="caps">API</span> documentation (Line wraps marked » <em>-Ed.</em>):</p><pre id="snippet19">var fn = scope.func1.createDelegate(scope, »[arg1, arg2], true);fn(a, b, c); // =&gt; scope.func1(a, b, c, arg1, arg2);var fn = scope.func1.createDelegate(scope, »[arg1, arg2]);fn(a, b, c); // = &gt; scope.func1(arg1, arg2);var fn = scope.func1.createDelegate(scope, »[arg1, arg2], 1);fn(a, b, c); // =&gt; scope.func1(a, arg1, arg2, b, c);</pre><h3 id="section11">Dojo<a class= "subhead-anchor" href="#section11">#section11</a></h3><p>The <a href="http://dojotoolkit.org/">Dojo</a> toolkit also caters to method binding with the humorously named <code>hitch</code> function.&nbsp; The syntax is:</p><pre id="snippet20">dojo.hitch(scope, methodOrMethodName[, arg…])</pre><p>Interestingly, the method can be passed either directly, or using its name. Extra arguments, if any, are passed before actual, call-time arguments. Here are a few examples:</p><pre id="snippet21">var fn = dojo.hitch(scope, func1)fn(a, b, c); // =&gt; scope.func1(a, b, c);var fn = dojo.hitch(scope, func1, arg1, arg2)fn(a, b, c); // =&gt; scope.func1(arg1, arg2, a, b, c);</pre><h3 id="section12">Base2<a class="subhead-anchor" href= "#section12">#section12</a></h3><p>Dean Edwards' superb <a href="http://code.google.com/p/base2/">Base2</a> library acts as a least common denominator of sorts to all JavaScript libraries by ironing out all the annoying differences in JavaScript implementations. It acknowledges a binding facility is needed and provides a simple <code>bind</code> function:</p><pre id= "snippet22">base2.bind(method, scope[, arg]);</pre><p>Note the scope object comes second, not first. Aside from that, the semantics are strictly equivalent to Prototype's <code>bind</code> or Dojo's <code>hitch</code>:</p><pre id="snippet23">var fn = base2.bind(func1, scope)fn(a, b, c); // =&gt; scope.func1(a, b, c);var fn = base2.bind(func1, scope, arg1, arg2)fn(a, b, c); // =&gt; scope.func1(arg1, arg2, a, b, c);</pre><h3 id="section13">jQuery<a class="subhead-anchor" href="#section13">#section13</a></h3><p><a href="http://jquery.com/">jQuery</a> does not provide such a binding facility. The library's philosophy favors closures over binding and forces users to jump through hoops (that is, manually combine lexical closures and <code>apply </code> or <code>call</code>, much as other libraries do internally) when they actually need to pass along a piece of code referring to "instance members."</p><h2 id="section14">Should you even bind?<a class="subhead-anchor" href="#section14">#section14</a></h2><p>Now that we've been through the details of binding, it's only fair to stress that sometimes, binding is overkill.&nbsp; Specifically, there's a code pattern in which binding can be replaced, with significant performance profit, by using the lexical closure. (If you're not clear on a what a closure is, don't panic.)</p><p>Here's the pattern: some code within a method relies on an anonymous function passed by reference to work. That anonymous function needs to access the surrounding method's <strong><code>this</code></strong> keyword. For instance, assuming for a minute we have the <code>each</code> iterator within arrays, consider the following code again:</p><pre id="snippet24">  // ...  processItems: function() {    this.items.each(function(item) {      // Process item…      this.markItemAsProcessed(item);    });  },  // ... </pre><p>The issue here is that the anonymous function holding the actual processing code is passed as an argument to <code>each</code>, and therefore loses the current binding.&nbsp; When it attempts to call <code>this.markItemAsProcessed</code>, it crashes because <code>window</code> has no such method.</p><p>Many developers are quick to fix that with binding. Using Prototype, for instance, they would add the following tweak:</p><pre id="snippet25">  // ...  processItems: function() {    this.items.each(function(item) {      // Process item this.markItemAsProcessed(item);    }.bind(this));  },  // ...</pre><p>Notice the trailing call to <code>bind</code>. However, such code is not as good an idea as it may seem. We saw that achieving such a "bound reference" requires us to wrap the original method within an anonymous function, which means calling the bound method reference results in two method calls: our anonymous wrapper, and the original method. And if there's one thing true of just about any language, it's that <em>method calls are costly</em>.</p><p>In this situation, we have access to the original, desired <strong><code>this</code></strong> keyword in the same code location where we define and call the faulty function (the anonymous method we're passing as an argument to <code>each</code>). We can simply save the proper <strong><code>this</code></strong> reference in a local variable, and use that inside our iteration function:</p><pre id= "snippet26">  // ...  processItems: function() {    var that = this;    this.items.each(function(item) {      // Process item      that.markItemAsProcessed(item);    });  },  // ... </pre><p>Look, Ma!&nbsp; No binding!&nbsp; This code uses a language feature called "lexical closure." In short, closures let code at point A access identifiers declared in scopes surrounding A. Here, our anonymous function has access to variables in the surrounding function-our <code>processItems</code> method. Such a closure will be maintained by the JavaScript runtime no matter what, so there is no extra cost to using it. Even if there were, I'm fairly confident that it would be far less than the cost of an extra function call at every turn of the loop.</p><p>Be cautious about your bindings: sometimes closures provide a simpler, shorter, and better way. (Which is, I believe, precisely why jQuery decided to "force" its users to think about the best option for each situation by having them deal with binding manually.) While closures do have their own set of problems-ill-employed, they can result in memory leaks for certain browsers-the usage I recommend here is pretty safe.</p><h2 id="section15">Takeaway points<a class="subhead-anchor" href="#section15">#section15</a></h2><p>To recap:</p><ul><li> Any member access must be qualified with the object it pertains to, even when it is <strong><code>this</code></strong>.</li><li>Any sort of function reference (assigning as a value, passing as an argument) loses the function's original binding.</li><li>JavaScript provides two equivalent ways of explicitly specifying a function's binding when calling it: <code>apply </code> and <code>call</code>.</li><li>Creating a "bound method reference" requires an anonymous wrapper function, and a calling cost. In specific situations, leveraging closures may be a better alternative.</li></ul><p>And now, with the help of this article, you'll have no trouble in binding situations!</p>			</div>			</div> <!--=========================			END : POST		=============================-->		<!--=========================			START : POST =============================-->		<div class="post-wrapper">		<h1>SEVEN SURPRISING JAVASCRIPT 'FEATURES'</h1>		<div class="row">        <div class="col-xs-12">          <p> Over the last couple of months I've made a few enhancements to JSHint, mainly as a way of learning ES6(I'm <a href=" https://github.com/lukeapage/jshint/commit/08eb4e25962eb71f94c09f79b3b08288b91a7bce">most proud</a> of re-implementingvariable scope detection) and during that process I've come across a few things that surprised me, mostly about ES6but also in ES3, including the following feature, which I've never used and this is where I will start.</p><h2 id="break-from-any-block"> Break from any block</h2><p>You should be aware that you can break and continue from any loop - it is a fairly standard programming language construct.You might not be aware that you can label loops and jump out of any particular loop…</p><div class="highlight"><pre><code class="language-js" data-lang="js"><span class="nx">outer</span><span class="o">:</span> <span class= "k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i </span> <span class="o">&lt;</span> <span class="mi">4</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span> <span class="k">while</span><span class="p">(</span><span class="kc">true</span><span class="p">)</span> <span class="p">{</span>        <span class="k">continue</span> <span class= "nx">outer</span><span class="p">;</span>    <span class="p">}</span><span class="p">}</span></code></pre></div><p>The same applies to both <code>break</code> and <code>continue</code>. You will have definitely seen break used with switch statements…</p><div class="highlight"><pre><code class="language-js" data-lang="js"><span class="k">switch</span><span class="p">( </span><span class="nx">i</span><span class="p">)</span> <span class="p">{</span>   <span class="k">case</span> <span class="mi">1</span><span class="o">:</span>       <span class="k"> break</span><span class="p">;</span><span class="p">}</span></code></pre></div><p>Incidentally, this is why Crockford suggests your <code>case</code> should not be indented - the <code> break</code> jumps out of the <code>switch</code>, not the <code>case</code>, but I prefer the readability of indenting <code>case</code>.You can also label switch statements…</p><div class="highlight"><pre><code class="language-js" data-lang="js"><span class="nx">myswitch</span><span class="o">:</span> <span class="k">switch</span><span class="p">(</span><span class= "nx">i</span><span class="p">)</span> <span class="p">{</span>   <span class="k">case</span> <span class="mi">1</span><span class="o">:</span>       <span class="k">break</span> <span class="nx">myswitch</span><span class="p">;</span><span class="p">}</span></code></pre></div><p>Another thing you can do is create arbitrary blocks (I know you can do this in C#, I expect other languages too).</p><div class="highlight"><pre><code class="language-js" data-lang="js"><span class="p">{</span>  <span class="p">{</span>      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">"I'm in an abritrary block"</span><span class="p">);</span>  <span class="p">}</span><span class="p">} </span></code></pre></div><p>So, we can put this together and label and break from arbitrary blocks.</p><div class="highlight"><pre><code class="language-js" data-lang="js"><span class= "nx">outer</span><span class="o">:</span> <span class="p">{</span>  <span class="nx">inner</span><span class="o">:</span> <span class="p">{</span>      <span class="k">if</span> <span class="p">(</span><span class="kc">true</span><span class="p">)</span> <span class="p">{</span>        <span class="k">break</span> <span class="nx">outer</span><span class="p">;</span> <span class="p">}</span>  <span class="p">}</span>  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">"I will never be executed"</span><span class="p">);</span><span class="p">}</span></code></pre></div><p>Note that this only applies to break - you can only <code>continue</code> in a loop block.I've never seen labels being used in JavaScript and I wondered why - I think it's because if I need to break two layersof blocks, it's a good sign that the block might be more readable inside a function and there I will use a single breakor an early return to achieve the same thing.</p><p>However, if I wanted to write code that had a single return in every function, which is not to my taste, then I could use block breaking. E.g. Take this multiple return function…</p><div class="highlight"><pre><code class="language-js" data-lang="js"><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span> <span class="nx">b</span><span class="p">,</span> <span class="nx">c</span><span class= "p">)</span> <span class="p">{</span>  <span class="k">if</span> <span class="p">(</span><span class="nx">a</span><span class="p">)</span> <span class="p">{</span>     <span class="k">if </span> <span class="p">(</span><span class="nx">b</span><span class="p">)</span> <span class="p">{</span>       <span class="k">return</span> <span class="kc">true</span><span class="p">; </span>     <span class="p">}</span>     <span class="nx">doSomething</span><span class="p">();</span>     <span class="k">if</span> <span class="p">(</span><span class="nx">c</span><span class="p">)</span> <span class="p">{</span>       <span class="k">return</span> <span class="nx">c</span><span class="p">;</span>     <span class="p">}</span>  <span class="p">}</span> <span class="k">return</span> <span class="nx">b</span><span class="p">;</span><span class="p">}</span></code></pre></div><p>And use labels…</p><div class="highlight"><pre><code class= "language-js" data-lang="js"><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span> <span class="nx">b</span><span class="p">,</span> <span class="nx">c</span><span class="p">)</span> <span class="p">{</span>  <span class="kd">var</span> <span class="nx">returnValue</span> <span class="o">=</span> <span class="nx">b </span><span class="p">;</span>  <span class="nx">myBlock</span><span class="o">:</span> <span class="k">if</span> <span class="p">(</span><span class="nx">a</span><span class="p">)</span> <span class="p">{</span>     <span class="k">if</span> <span class="p">(</span><span class="nx">b</span><span class="p">)</span> <span class="p">{</span>       <span class="nx"> returnValue</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>       <span class="k">break</span> <span class="nx">myBlock</span><span class="p">;</span> <span class="p">}</span>     <span class="nx">doSomething</span><span class="p">();</span>     <span class="k">if</span> <span class="p">(</span><span class="nx">c</span><span class= "p">)</span> <span class="p">{</span>       <span class="nx">returnValue</span> <span class="o">=</span> <span class="nx">c</span><span class="p">;</span>     <span class="p">}</span> <span class="p">}</span>  <span class="k">return</span> <span class="nx">returnValue</span><span class="p">;</span><span class="p">}</span></code></pre></div><p>The alternative being more blocks…</p><div class="highlight"><pre><code class="language-js" data-lang="js"><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span> <span class="nx">b</span><span class="p">,</span> <span class="nx">c</span><span class="p">)</span> <span class="p">{</span>  <span class="kd">var</span> <span class="nx">returnValue </span> <span class="o">=</span> <span class="nx">b</span><span class="p">;</span>  <span class="k">if</span> <span class="p">(</span><span class="nx">a</span><span class="p">)</span> <span class="p">{</span>     <span class="k">if</span> <span class="p">(</span><span class="nx">b</span><span class="p">)</span> <span class="p">{</span>       <span class="nx">returnValue </span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>     <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>       <span class= "nx">doSomething</span><span class="p">();</span>       <span class="k">if</span> <span class="p">(</span><span class="nx">c</span><span class="p">)</span> <span class="p">{</span> <span class="nx">returnValue</span> <span class="o">=</span> <span class="nx">c</span><span class="p">;</span>       <span class="p">}</span>    <span class="p">}</span>  <span class="p">}</span>  <span class="k">return</span> <span class="nx">returnValue</span><span class="p">;</span><span class="p">}</span></code></pre></div><p>I prefer the original, then using elses and then block labels - but maybe that's because it's what I'm used to?</p><h2 id="destructuring-an-existing-variable">Destructuring an existing variable</h2><p>First off, a quirk I cannot explain. It seems in ES3 you can add parentheses around a simple assignment and it works…</p><div class="highlight"><pre><code class="language-js" data-lang="js"><span class ="kd">var</span> <span class="nx">a</span><span class="p">;</span><span class="p">(</span><span class="nx">a</span><span class="p">)</span> <span class="o">=</span> <span class="mi">1 </span><span class="p">;</span><span class="nx">assertTrue</span><span class="p">(</span><span class="nx">a</span> <span class="o">===</span> <span class="mi">1</span><span class="p">); </span></code></pre></div><p>If you can think of why anyone would do this, then please comment!</p><p>Destructuring is the process of pulling a variable out of an array or object. Most often you will see the following examples…</p><div class="highlight"><pre><code class="language-js" data-lang="js"><span class="kd">function</span> <span class="nx">pullOutInParams </span><span class="p">({</span><span class="nx">a</span><span class="p">},</span> <span class="p">[</span><span class="nx">b</span><span class="p">])</span> <span class="p">{</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span> <span class="nx">b</span><span class="p">);</span><span class="p">}</span><span class="kd">function</span> <span class="nx">pullOutInLet</span><span class="p">(</span><span class="nx">obj</span><span class="p">,</span> <span class="nx">arr</span><span class="p">)</span> <span class="p">{</span>  <span class="kd">let</span> <span class="p">{</span><span class="nx">a</span><span class="p">}</span> <span class="o">=</span> <span class="nx">obj</span><span class="p">;</span>  <span class="kd">let</span> <span class="p">[</span><span class="nx">b</span><span class="p">]</span> <span class= "o">=</span> <span class="nx">arr</span><span class="p">;</span>  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx" >a</span><span class="p">,</span> <span class="nx">b</span><span class="p">);</span><span class="p">}</span><span class="nx">pullOutInParams</span><span class="p">({</span><span class="nx" >a</span><span class="o">:</span> <span class="s2">"Hello"</span> <span class="p">},</span> <span class="p">[</span><span class="s2">"World"</span><span class="p">]);</span><span class= "nx">pullOutInLet</span><span class="p">({</span><span class="nx">a</span><span class="o">:</span> <span class="s2">"Hello"</span> <span class="p">},</span> <span class="p">[</span><span class="s2">"World"</span><span class="p">]);</span></code></pre></div><p>But you can also do it without a <code>var</code>/<code>let</code>/<code>const</code>. With arrays you can just write it as you expect…</p><div class="highlight"><pre><code class="language-js" data-lang="js"><span class="kd">var</span> <span class="nx">a</span><span class="p">;</span><span class="p" >[</span><span class="nx">a</span><span class="p">]</span> <span class="o">=</span> <span class="nx">array</span><span class="p">;</span></code></pre></div><p>But with objects you must surround the whole assignment in parenthesis…</p><div class="highlight"><pre><code class="language-js" data-lang="js"><span class="kd">var</span> <span class="nx">a</span><span class="p">; </span><span class="p">({</span><span class="nx">a</span><span class="p">}</span> <span class="o">=</span> <span class="nx">obj</span><span class="p">);</span></code></pre></div><p>The reasoning was that there was too much scope for confusion with code blocks, since you can have anonymous code blocks and ASI (automatic semi-colon insertion) will convert identifiers to expressions that evaluate (and as shown in the example below, can have side effects…)</p><div class="highlight"><pre><code class="language-js" data-lang="js"><span class="kd">var</span> <span class="nx">a</span> <span class="o">=</span> <span class="p">{</span>   <span class="nx">get</span> <span class="nx">b</span><span class="p">()</span> <span class="p">{</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">"Hello!"</span><span class="p">);</span>   <span class="p">} </span><span class="p">};</span><span class="kd">with</span><span class="p">(</span><span class="nx">a</span><span class="p">)</span> <span class="p">{</span>  <span class="p">{</span> <span class="nx">b</span>  <span class="p">}</span><span class="p">}</span></code></pre></div><p>Going back to the original example, where we parenthesised our identifier before assignment - you might think that also applies to destructuring. It doesn't.</p><div class="highlight"><pre><code class="language-js" data-lang="js"><span class="kd">var</span> <span class ="nx">a</span><span class="p">,</span> <span class="nx">b</span><span class="p">,</span> <span class="nx">c</span><span class="p">;</span><span class="p">(</span><span class="nx">a </span><span class="p">)</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span><span class="p">[</span><span class="nx">b</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">];</span><span class="p">({</span><span class="nx">c</span><span class="p">}</span> <span class="o">= </span> <span class="p">{</span> <span class="nx">c</span> <span class="o">:</span> <span class="mi">3</span> <span class="p">});</span></code></pre></div><h2 id= "destructuring-with-numbers">Destructuring with numbers</h2><p>Another aspect of destructuring you might not realise is that the property names do not have to be unquoted strings. They can be numbers..</p><div class="highlight"><pre><code class="language-js" data-lang="js"><span class="kd">var</span> <span class="p">{</span><span class="mi">1</span> <span class="o">: </span> <span class="nx">a</span><span class="p">}</span> <span class="o">=</span> <span class="p">{</span> <span class="mi">1</span><span class="o">:</span> <span class="kc">true</span> <span class="p">};</span></code></pre></div><p>Or quoted strings…</p><div class="highlight"><pre><code class="language-js" data-lang="js"><span class="kd">var</span> <span class="p">{ </span><span class="s2">"1"</span> <span class="o">:</span> <span class="nx">a</span><span class="p">}</span> <span class="o">=</span> <span class="p">{</span> <span class="s2">"1" </span><span class="o">:</span> <span class="kc">true</span> <span class="p">};</span></code></pre></div><p>Or you might want to pull out a computed name…</p><div class="highlight" ><pre><code class="language-js" data-lang="js"><span class="kd">var</span> <span class="nx">myProp</span> <span class="o">=</span> <span class="s2">"1"</span><span class="p">;</span><span class="kd">var</span> <span class="p">{[</span><span class="nx">myProp</span><span class="p">]</span> <span class="o">:</span> <span class="nx">a</span><span class="p">}</span> <span class ="o">=</span> <span class="p">{</span> <span class="p">[</span><span class="nx">myProp</span><span class="p">]</span><span class="o">:</span> <span class="kc">true</span> <span class="p"> };</span></code></pre></div><p>Which makes it quite easy to write confusing code…</p><div class="highlight"><pre><code class="language-js" data-lang="js"><span class="kd">var</span> <span class="nx">a</span> <span class="o">=</span> <span class="s2">"a"</span><span class="p">;</span><span class="kd">var</span> <span class="p">{[</span><span class="nx">a</span><span class= "p">]</span> <span class="o">:</span> <span class="p">[</span><span class="nx">a</span><span class="p">]}</span> <span class="o">=</span> <span class="p">{</span> <span class="nx">a </span><span class="o">:</span> <span class="p">[</span><span class="nx">a</span><span class="p">]</span> <span class="p">};</span></code></pre></div><h2 id= "class-declarations-are-block-scoped">class declarations are block scoped</h2><p>Functions are hoisted to their function scope, meaning you can have a function declaration after its usage… </p><div class="highlight"><pre><code class="language-js" data-lang="js"><span class="nx">func</span><span class="p">();</span><span class="kd">function</span> <span class="nx">func </span><span class="p">()</span> <span class="p">{</span>  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">"Fine" </span><span class="p">);</span><span class="p">}</span></code></pre></div><p>as opposed to function expressions which when assigned to a variable, the variable is hoisted but the assignment doesn't happen until the function expression is assigned.</p><div class="highlight"><pre><code class="language-js" data-lang="js"><span class="nx">func</span><span class="p">(); </span> <span class="c1">// func is declared, but undefined, so this throws E.g. "func is not a function"</span><span class="kd">var</span> <span class="nx">func</span> <span class="o">= </span> <span class="kd">function</span> <span class="nx">func</span><span class="p">()</span> <span class="p">{</span>  <span class="nx">console</span><span class="p">.</span><span class= "nx">log</span><span class="p">(</span><span class="s2">"Fine"</span><span class="p">);</span><span class="p">};</span></code></pre></div><p>Classes have been a popular part of ES6 and have been widely touted as syntactic sugar for functions. So you might think that the following will work..</p><div class="highlight"><pre><code class="language-js" data-lang="js"><span class="k">new</span> <span class="nx">func</span><span class="p">();</span><span class="kr">class</span> <span class="nx">func</span> <span class="p">{</span>  <span class="nx">constructor </span><span class="p">()</span> <span class="p">{</span>    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2"> "Fine"</span><span class="p">);</span>  <span class="p">}</span><span class="p">}</span></code></pre></div><p>But even though this is basically syntactic sugar for our first example, it doesn't work. It is actually equivalent to..</p><div class="highlight"><pre><code class="language-js" data-lang="js"><span class="k">new</span> <span class="nx">func</span><span class="p"> ();</span><span class="kd">let</span> <span class="nx">func</span> <span class="o">=</span> <span class="kd">function</span> <span class="nx">func</span><span class="p">()</span> <span class="p">{</span>  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">"Fine"</span><span class="p">);</span><span class="p">}</span></code></pre></div><p>Which means we are accessing <code>func</code> in the temporal dead zone (TDZ), which is a reference error.</p><h2 id="same-name-parameters">Same name parameters</h2><p>I assumed it was not possible to specify parameters with the same name, however, it is!</p><div class="highlight"><pre><code class="language-js" data-lang="js"><span class="kd">function</span> <span class="nx">func</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span> <span class="nx">a</span><span class="p">)</span> <span class="p">{</span>  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">a</span><span class="p">);</span><span class= "p">}</span><span class="nx">func</span><span class="p">(</span><span class="s2">"Hello"</span><span class="p">,</span> <span class="s2">"World"</span><span class="p">);</span><span class= "c1">// outputs "World"</span></code></pre></div><p>Except in strict mode…</p><div class="highlight"><pre><code class="language-js" data-lang="js"><span class="kd">function</span> <span class="nx">func</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span> <span class="nx">a</span><span class="p">)</span> <span class="p">{</span>  <span class="s2" >"use strict"</span><span class="p">;</span>  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">a</span><span class ="p">);</span><span class="p">}</span><span class="nx">func</span><span class="p">(</span><span class="s2">"Hello"</span><span class="p">,</span> <span class="s2">"World"</span><span class ="p">);</span><span class="c1">// errors in chrome - SyntaxError: Strict mode function may not have duplicate parameter names</span></code></pre></div><h2 id="typeof-is-not-safe">typeof code></div><div class="line number7 index6 alt2"><code class="jscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class= "jscript keyword">return</code> <code class="jscript plain">{</code></div><div class="line number8 index7 alt1"><code class="jscript spaces"> an class="p">(</span><span class="nx">a</span><span class="p">,</span> <span class="nx">a</span><span class="p">)</span> <span class="p">{</span>  <span class="s2" >"use strict"</span><span class="p">;</span>  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">a</span><span class ="p">);</span><span class="p">}</span><span class="nx">func</span><span class="p">(</span><span class="s2">"Hello"</span><span class="p">,</span> <span class="s2">"World"</span><span class ="p">);</span><span class="c1">// errors in chrome - SyntaxError: Strict mode function may not have duplicate parameter names</span></code></pre></div><h2 id="typeof-is-not-safe">typeof is not safe</h2><p><a href="http://es-discourse.com/t/why-typeof-is-no-longer-safe/15">Okay, I stole this observation</a>, but it is worth repeating.</p><p>Before ES6, it was well known you could always use typeof to safely find out if something was defined, whether it was declared or not…</p><div class="highlight"><pre><code class="language-js" data-lang="js"><span class ="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">Symbol</span> <span class="o">!==</span> <span class="s2">"undefined"</span><span class="p">)</span> <span class="p">{</span>  <span class="c1">// Symbol is available</span><span class="p">}</span><span class="c1">// The following throws an exception if Symbol not declared</span><span class="k">if</span> <span class="p">(</span><span class="nx">Symbol</span> <span class="o">!==</span> <span class="s2">"undefined"</span><span class="p">)</span> <span class="p">{ </span><span class="p">}</span></code></pre></div><p>But now this only works if you have not declared the variable using let or const. This because of the TDZ, which makes it a reference error to access the variable before declaration. Essentially the variable is hoisted to the beginning of the block, but it is a reference error to access it. In JSHint's scope manager I have to record usages of a variable, then if it is declared as a <code>let</code> or <code>const</code> within the current block or parent blocks, it is a reference error. If it is declared by a var statement it is valid but a JSHint warning and if it is not declared it is using a global and possibly a different warning.</p><div class="highlight"><pre><code class= "language-js" data-lang="js"><span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">Symbol</span> <span class="o">!==</span> <span class="s2"> "undefined"</span><span class="p">)</span> <span class="p">{</span>  <span class="c1">// Symbol is available</span><span class="p">}</span><span class="kd">let</span> <span class="nx"> Symbol</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span> <span class="c1">// causes a reference error</span></code></pre></div><h2 id="new-array">new Array</h2><p>I've always avoided using the new Array constructor. Part of the reasoning is that its arguments can either be a length or a list of items…</p><div class="highlight" ><pre><code class="language-js" data-lang="js"><span class="k">new</span> <span class="nb">Array</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span> <span class="c1">// [undefined]</span><span class="k">new</span> <span class="nb">Array</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2 </span><span class="p">);</span> <span class="c1">// [1, 2]</span></code></pre></div><p>But a colleague was using it recently and came across something I haven't seen before..</p><div class="highlight"><pre><code class="language-js" data-lang="js"><span class="kd">var</span> <span class="nx">arr</span> <span class="o">=</span> <span class="k">new</span> <span class="nb" >Array</span><span class="p">(</span><span class="mi">10</span><span class="p">);</span><span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">i </span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">arr</span><span class="p">. </span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>  <span class="nx">arr </span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">=</span> <span class="nx">i</span><span class="p">;</span><span class="p">}</span><span class="nx">console</span><span class="p">.</span><span class="nx">dir</span><span class="p">(</span><span class="nx">arr</span><span class="p">);</span></code></pre></div><p>This produces an array of items from 0 to 9. But then, if this is refactored to use map…</p><div class="highlight"><pre><code class="language-js" data-lang="js"><span class="kd">var</span> <span class= "nx">arr</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Array</span><span class="p">(</span><span class="mi">10</span><span class="p">);</span><span class="nx" >arr</span> <span class="o">=</span> <span class="nx">arr</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="kd">function</span><span class="p">( </span><span class="nx">item</span><span class="p">,</span> <span class="nx">index</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="nx"> index</span><span class="p">;</span> <span class="p">});</span><span class="nx">console</span><span class="p">.</span><span class="nx">dir</span><span class="p">(</span><span class="nx"> arr</span><span class="p">);</span></code></pre></div><p>Then <code>arr</code> is unchanged. It seems that <code>new Array(length)</code> creates an array with that length, but does not set any items, so referring to the length works, but enumerating does not. What about if I set a number ?</p><div class="highlight"><pre><code class="language-js" data-lang="js"><span class="kd">var</span> <span class="nx">arr</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Array</span><span class="p">(</span><span class="mi">10</span><span class="p">);</span><span class="nx">arr</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span> <span class="o">=</span> <span class="kc">undefined</span><span class="p">;</span><span class="nx">arr</span> <span class="o">=</span> <span class="nx">arr</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class= "kd">function</span><span class="p">(</span><span class="nx">item</span><span class="p">,</span> <span class="nx">index</span><span class="p">)</span> <span class="p">{</span> <span class= "k">return</span> <span class="nx">index</span><span class="p">;</span> <span class="p">});</span><span class="nx">console</span><span class="p">.</span><span class="nx">dir</span><span class="p">(</span><span class="nx">arr</span><span class="p">);</span></code></pre></div><p>Now I get an array where the 8th index is equal to 8, but all the others are set to undefined. Looking at the polyfill for map, it loops over every item (hence why index is correct) but uses an <code>in</code> check to see if the property is set. You also get the same behaviour using array literals…</p><div class="highlight"><pre><code class="language-js" data-lang="js"><span class="kd">var</span> <span class="nx">arr</span> <span class="o">=</span> <span class= "p">[];</span><span class="nx">arr</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span> <span class="o">=</span> <span class="kc">undefined</span><span class="p" >;</span><span class="c1">// or</span><span class="kd">var</span> <span class="nx">arr</span> <span class="o">=</span> <span class="p">[];</span><span class="nx">arr</span><span class="p"> .</span><span class="nx">length</span> <span class="o">=</span> <span class="mi">10</span><span class="p">;</span></code></pre></div><h2 id="other-gems">Other gems</h2><p>Mozilla's developer blog has <a href="https://hacks.mozilla.org/2015/06/es6-in-depth-arrow-functions/">a great post on arrow functions</a>, which includes details of using <code>&lt;!--</code> as an official ES6 comment token. It is worth checking out the <a href="https://hacks.mozilla.org/category/es6-in-depth/">whole blog series</a> too.</p>        </div>      </div> </div>		<!--=========================			END : POST		=============================-->		<!--=========================			START : POST =============================-->		<div class="post-wrapper">		<h1>Overview of the JavaScript ecosystem : An introduction to the vast world of JavaScript</h1>		<main role= "main" class="postArticle-content js-postField js-notesSource" data-scroll="native"><section name="6bc1" class=" section--body"><div class="section-divider layoutSingleColumn"><hr class= "section-divider"></div><div class="section-content"><div class="section-inner layoutSingleColumn"><h3 name="9918" id="9918" class="graf--h3 graf--first">What can I accomplish with Javascript?</h3><p name="d467" id="d467" class="graf--p">The ecosystem of JavaScript has grown. Long gone are the days of simply inserting jQuery into your website and fading stuff in or out.</p><p name="c045" id="c045" class="graf--p">Entering the world of JavaScript today is an overwhelming task with lots of possibilities. It also means that it's a world that's brimming with opportunity. In the words of Jeff Atwood (<a href="http://blog.codinghorror.com/the-principle-of-least-power/" data-href="http://blog.codinghorror.com/the-principle-of-least-power/" class="markup--anchor markup--p-anchor" rel="nofollow">http://blog.codinghorror.com/the-principle-of-least-power/</a>):</p><blockquote name="397f" id="397f" class="graf--blockquote">Any application that <strong class="markup--strong markup--blockquote-strong">can</strong> be written in JavaScript, <strong class="markup--strong markup--blockquote-strong">will</strong> eventually be written in JavaScript.</blockquote><h3 name="3adb" id="3adb" class="graf--h3">The different aspects of JavaScript</h3><p name="2a34" id="2a34" class="graf--p">There was never a better time to find a niche within the JavaScript ecosystem. Here's a list of aspects you can dive into and which this <span class="markup--quote markup--p-quote is-other" name= "anon_ae37aa4c2d5" data-creator-ids="anon">article</span> will explore deeper:</p><ol class="postList"><li name="8fb7" id="8fb7" class="graf--li">Front-end development</li><li name="3d9d" id="3d9d" class="graf--li">Command line interface (CLI) applications</li><li name="e373" id="e373" class="graf--li">Desktop (GUI) applications</li><li name="2300" id="2300" class= "graf--li">Mobile applications</li><li name="9c53" id="9c53" class="graf--li">Back-end development</li><li name="f57f" id="f57f" class="graf--li graf--last">Any combination of the above </li></ol></div></div></section><section name="2950" class=" section--body"><div class="section-divider layoutSingleColumn"><hr class="section-divider"></div><div class="section-content" ><div class="section-inner layoutSingleColumn"><h3 name="8f36" id="8f36" class="graf--h3 graf--first">Front-end development</h3><p name="4a62" id="4a62" class="graf--p">Developing the user facing part of websites has become increasingly complex by becoming highly interactive and offloading traditional server-side tasks to the front-end. It was once unfathomable that we'll be running the likes of Google Maps, Spotify or YouTube in our web browsers but here we are, with a varied toolset to make complex web applications.</p><p name="c037" id="c037" class ="graf--p">Front-end web development has grown exponentially in the last few years and I'll offer just a glimpse of that here.</p><h4 name="e908" id="e908" class="graf--h4">The basics of front-end web development</h4><p name="7310" id="7310" class="graf--p">For a long time, JavaScript has been used solely for DOM manipulation with the odd animation thrown in for good measure. Since the beginnings, there was a big discrepancy between browser features.</p><p name="8440" id="8440" class="graf--p"><a href="http://jquery.com/" data-href="http://jquery.com/" class="markup--anchor markup--p-anchor" rel="nofollow">jQuery</a> started a revolution with abstracting the aforementioned browser features and making DOM manipulation easy while also bringing quite a few utilities to the table.</p><p name="e020" id="e020" class="graf--p">Nowadays, it's quite easy to manipulate the DOM with pure JavaScript and there's a <a href=" http://youmightnotneedjquery.com/" data-href="http://youmightnotneedjquery.com/" class="markup--anchor markup--p-anchor" rel="nofollow">very nice cheat sheet just for that purpose</a>. </p><h4 name="f70c" id="f70c" class="graf--h4">Efficiency through frameworks</h4><p name="7883" id="7883" class="graf--p">With the growing complexity of websites and websites growing to web applications, there was a need to address the complex issues of web applications (state handling, data binding, view rendering, etc.). Many frameworks rose to that challenge and two that are probably most popular today are <a href="https://angularjs.org/" data-href="https://angularjs.org/" class="markup--anchor markup--p-anchor" rel="nofollow">AngularJS</a> and <a href="https://facebook.github.io/react/" data-href="https://facebook.github.io/react/" class="markup--anchor markup--p-anchor" rel="nofollow">React</a>.</p><p name="27db" id="27db" class= "graf--p">It's clear that <em class="markup--em markup--p-em">Angular</em> and <em class="markup--em markup--p-em">React </em>gained such traction since the former is backed by Google and the latter by Facebook. While <em class="markup--em markup--p-em">Angular</em> contains the whole MVC paradigm, <em class="markup--em markup--p-em">React</em> is somewhat leaner and mostly considered the V of MVC.</p><p name="396c" id="396c" class="graf--p">New frameworks show up all the time and time will only tell which one will reign supreme (of course, if something like that even happens).</p><h4 name="01ec" id="01ec" class="graf--h4">What's in a name?</h4><p name="4616" id="4616" class="graf--p">There's a good chance that you won't be using <em class="markup--em markup--p-em">JavaScript</em> any more, but any of the languages that transpile to JavaScript like:</p><ul class="postList"><li name="1b9c" id="1b9c" class= "graf--li"><a href="https://github.com/lukehoban/es6features" data-href="https://github.com/lukehoban/es6features" class="markup--anchor markup--li-anchor" rel="nofollow">EcmaScript 6</a>  - the newest spec of JavaScript</li><li name="624e" id="624e" class="graf--li"><a href="http://www.typescriptlang.org/" data-href="http://www.typescriptlang.org/" class="markup--anchor markup--li-anchor" rel="nofollow">TypeScript</a> - Microsoft's superset of JavaScript featuring types</li></ul><p name="b25f" id="b25f" class="graf--p">Apart from just adding new features to a language, there's a good chance you'll be modularising your application by using <a href="http://www.2ality.com/2014/09/es6-modules-final.html" data-href=" http://www.2ality.com/2014/09/es6-modules-final.html" class="markup--anchor markup--p-anchor" rel="nofollow">ES6 native modules</a> or <a href="http://wiki.commonjs.org/wiki/CommonJS" data-href="http://wiki.commonjs.org/wiki/CommonJS" class="markup--anchor markup--p-anchor" rel="nofollow">CommonJS</a> (mostly for <em class="markup--em markup--p-em">Node.js</em> development<em class="markup--em markup--p-em">) </em>or <a href="http://requirejs.org/" data-href="http://requirejs.org/" class="markup--anchor markup--p-anchor" rel="nofollow">RequireJS </a> (async module loading mostly for websites).</p><p name="d22b" id="d22b" class="graf--p">Transpilation and connecting of modularised applications is done via build tools (<em class= "markup--em markup--p-em">Gulp</em> and <em class="markup--em markup--p-em">Grunt</em>, mentioned in detail later), using transpile tools (like <a href="https://babeljs.io/" data-href=" https://babeljs.io/" class="markup--anchor markup--p-anchor" rel="nofollow">Babel</a> or <a href="https://github.com/google/traceur-compiler/" data-href=" https://github.com/google/traceur-compiler/" class="markup--anchor markup--p-anchor" rel="nofollow">Traceur</a>) and module builders (like <a href="http://browserify.org/" data-href=" http://browserify.org/" class="markup--anchor markup--p-anchor" rel="nofollow">Browserify</a> or <a href="https://github.com/webpack/webpack" data-href="https://github.com/webpack/webpack" class="markup--anchor markup--p-anchor" rel="nofollow">Webpack</a>). You'll most likely transpile and build your modules in every aspect of JavaScript development.</p><p name="a7cc" id= "a7cc" class="graf--p graf--last">There is a boatload of tools that weren't mentioned. It is left to the reader to explore them and a good starting place is the <a href=" https://github.com/sindresorhus/awesome#front-end-development" data-href="https://github.com/sindresorhus/awesome#front-end-development" class="markup--anchor markup--p-anchor" rel= "nofollow">awesome list of front-end development</a>.</p></div></div></section><section name="52e6" class=" section--body"><div class="section-divider layoutSingleColumn"><hr class= "section-divider"></div><div class="section-content"><div class="section-inner layoutSingleColumn"><h3 name="b3b6" id="b3b6" class="graf--h3 graf--first">Command line interface (CLI) applications</h3><p name="d55e" id="d55e" class="graf--p">Many developers rely mostly on the CLI in their day-to-day development - be it code linting, task running or starting a server, there's a certain beauty in the efficiency of executing a task purely from the command line.</p><p name="24d1" id="24d1" class="graf--p">CLI applications are written using <a href="https://nodejs.org/" data-href="https://nodejs.org/" class="markup--anchor markup--p-anchor" rel= "nofollow">Node.js</a> (or <em class="markup--em markup--p-em">io.js</em>, a fork of <em class="markup--em markup--p-em">Node.js</em> which is going to be merged back into <em class= "markup--em markup--p-em">Node.js</em> soon). <em class="markup--em markup--p-em">Node.js</em> is an open source, cross-platform runtime environment that allows you to execute your JavaScript code everywhere through Chrome's JavaScript runtime (not just in the browser, like before). In essence, once someone installs <em class="markup--em markup--p-em">Node.js</em> and takes your CLI application (package), it can be executed.</p><h4 name="65a2" id="65a2" class="graf--h4">Package managers</h4><p name="9c72" id="9c72" class="graf--p">It would be really bad if you'd have to write every functionality of every app from scratch. That's where <a href="https://www.npmjs.com/" data-href="https://www.npmjs.com/" class="markup--anchor markup--p-anchor" rel="nofollow">npm</a> steps in. <em class="markup--em markup--p-em">npm</em> is a package manager for <em class="markup--em markup--p-em">Node.js</em> modules and using packages is really simple - install and require them.</p><p name="a887" id="a887" class="graf--p">The CLI application that you write can also be packaged as a <em class="markup--em markup--p-em">Node.js</em> module and distributed via <em class="markup--em markup--p-em">npm</em>. That is the preferred way of getting your CLI application (or Node.js modules for that matter) to other people.</p><p name="09c1" id="09c1" class="graf--p">Many popular libraries and tools have CLI applications for easier use like <em class="markup--em markup--p-em">Gulp </em> or <em class="markup--em markup--p-em">Grunt</em>. There's also a <a href="https://github.com/sindresorhus/awesome-nodejs#command-line-apps" data-href=" https://github.com/sindresorhus/awesome-nodejs#command-line-apps" class="markup--anchor markup--p-anchor" rel="nofollow">list of awesome Node.js CLI apps</a>.</p><h4 name="16a0" id="16a0" class="graf--h4">Build tools</h4><p name="0827" id="0827" class="graf--p">Build tools (and task runners) get a special mention because they're the most basic tools you'll be using no matter what type of application you're building.</p><p name="736b" id="736b" class="graf--p">The most popular build tools nowadays are <a href="http://gruntjs.com/" data-href=" http://gruntjs.com/" class="markup--anchor markup--p-anchor" rel="nofollow">Grunt</a> and <a href="http://gulpjs.com/" data-href="http://gulpjs.com/" class="markup--anchor markup--p-anchor" rel="nofollow">Gulp</a> which make the process of transforming your code to something usable much easier. A typical scenario is to:</p><ul class="postList"><li name= "7b90" id="7b90" class="graf--li">transpile your JavaScript from EcmaScript 6 to EcmaScript 5</li><li name="7c5e" id="7c5e" class="graf--li">compile your SCSS to CSS</li><li name="55ff" id ="55ff" class="graf--li">minify and concatenate the resulting files</li><li name="5607" id="5607" class="graf--li graf--last">copy everything to a distribution folder </li></ul></div></div></section><section name="18fe" class=" section--body"><div class="section-divider layoutSingleColumn"><hr class="section-divider"></div><div class="section-content" ><div class="section-inner layoutSingleColumn"><h3 name="24a5" id="24a5" class="graf--h3 graf--first">Desktop (GUI) applications</h3><figure name="d0c8" id="d0c8" class="graf--figure"><div class="aspectRatioPlaceholder is-locked" ><img class="graf-image" data-image-id="1*Ldv9SmC8DWM6vB4tU2vXaw.png" data-width="1876" data-height="1360" data-action="zoom" data-action-value= "1*Ldv9SmC8DWM6vB4tU2vXaw.png" src="https://cdn-images-2.medium.com/max/1104/1*Ldv9SmC8DWM6vB4tU2vXaw.png" data-scroll="native"></div><figcaption class="imageCaption">Slack </figcaption></figure><p name="0604" id="0604" class="graf--p">Applications are mostly moving to the web or onto mobile devices. Still, desktop applications offer an immersion mostly unavailable to web applications.</p><p name="5e20" id="5e20" class="graf--p">The biggest advantage of writing your desktop applications with JavaScript is abstraction of the platform for which you are coding. Your applications are cross-platform and the modules you use simplify the usage of typical desktop features (such as tray icons, notifications, global keyboard shortcuts, etc.).</p><p name="df92" id="df92" class="graf--p">Having a good project structure allows you a lot of code reuse between your web and desktop application. That in turn leads to easier maintenance.</p><h4 name="e91b" id="e91b" class="graf--h4">Available tools</h4><p name="6ed9" id="6ed9" class="graf--p">There are two popular projects which allow you to write a desktop application via HTML/JS:</p><ul class="postList"><li name="45c6" id="45c6" class="graf--li"><a href="http://nwjs.io/" data-href="http://nwjs.io/" class="markup--anchor markup--li-anchor" rel="nofollow">NW.js</a> - formerly known as node-webkit, it's the most popular way of writing native desktop applications</li><li name="ec75" id="ec75" class="graf--li" ><a href="http://electron.atom.io/" data-href="http://electron.atom.io/" class="markup--anchor markup--li-anchor" rel="nofollow">Electron</a> - a newer contender made by GitHub which already gained big traction in the same space</li></ul><h4 name="47d4" id="47d4" class="graf--h4">Notable applications</h4><p name="e9be" id="e9be" class="graf--p">Both of the mentioned projects are used in quite a few popular desktop applications.</p><p name="4bb0" id="4bb0" class="graf--p graf--last">Notable applications done with <em class="markup--em markup--p-em"> NW.js</em> or <em class="markup--em markup--p-em">Electron</em> include Slack, Game Dev Tycoon, GitHub Atom, WhatsApp Desktop, Facebook Messenger Desktop, Popcorn Time and Microsoft Visual Studio Code. There's an <a href="https://github.com/nwjs/nw.js/wiki/List-of-apps-and-companies-using-nw.js" data-href=" https://github.com/nwjs/nw.js/wiki/List-of-apps-and-companies-using-nw.js" class="markup--anchor markup--p-anchor" rel="nofollow">extensive list of projects</a> made with <em class= "markup--em markup--p-em">NW.js</em> and an <a href="https://github.com/sindresorhus/awesome-electron" data-href="https://github.com/sindresorhus/awesome-electron" class="markup--anchor markup--p-anchor" rel="nofollow">extensive list of projects</a> made with <em class="markup--em markup--p-em">Electron</em> (both containing links to Repositories for learning or contributing purposes).</p></div></div></section><section name="cd2d" class=" section--body"><div class="section-divider layoutSingleColumn"><hr class="section-divider"></div><div class= "section-content"><div class="section-inner layoutSingleColumn"><h3 name="c0a2" id="c0a2" class="graf--h3 graf--first">Mobile applications</h3><figure name="aaa4" id="aaa4" class= "graf--figure"><div class="aspectRatioPlaceholder is-locked" ><div class="aspect-ratio-fill" style="padding-bottom: 91.5%;"></div><img class="graf-image" data-image-id= "1*y-A1AO9g1OsWJFBATHebqw.png" data-width="820" data-height="750" data-action="zoom" data-action-value="1*y-A1AO9g1OsWJFBATHebqw.png" src=" https://cdn-images-2.medium.com/max/820/1*y-A1AO9g1OsWJFBATHebqw.png" data-scroll="native"></div><figcaption class="imageCaption">Facebook Mobile applications made with React Native </figcaption></figure><p name="1296" id="1296" class="graf--p">With such a booming market, it makes sense to develop mobile applications. The JavaScript ecosystem provides a few solutions to developing cross-platform (iOS, Android and Windows Phone) applications. The most popular projects providing cross-platform mobile application include:</p><ul class="postList"><li name= "69f7" id="69f7" class="graf--li"><a href="http://ionicframework.com/" data-href="http://ionicframework.com/" class="markup--anchor markup--li-anchor" rel="nofollow">Ionic</a></li><li name ="2038" id="2038" class="graf--li"><a href="http://facebook.github.io/react-native/" data-href="http://facebook.github.io/react-native/" class="markup--anchor markup--li-anchor" rel= "nofollow">React Native</a></li><li name="4b58" id="4b58" class="graf--li"><a href="http://phonegap.com/" data-href="http://phonegap.com/" class="markup--anchor markup--li-anchor" rel= "nofollow">Phonegap</a></li></ul><p name="639d" id="639d" class="graf--p"><em class="markup--em markup--p-em">Ionic</em> and <em class="markup--em markup--p-em">Phonegap</em> use a browser wrapper around your HTML/JS and provide access to otherwise unavailable features of the platform (camera, various sensors, etc.). <em class="markup--em markup--p-em">Ionic</em> is leveraging the power of <em class="markup--em markup--p-em">Angular</em> to provide a well-tested and stable platform.</p><p name="8a0b" id="8a0b" class="graf--p">Facebook's <em class= "markup--em markup--p-em">React Native</em> has an interesting approach in which they render your written application to higher-level platform-specific components to achieve a truly native look of the app. This means that you'll have to write a separate view layer for each platform but you'll do it in a consistent manner. <a href=" https://code.facebook.com/posts/1014532261909640/react-native-bringing-modern-web-techniques-to-mobile/" data-href=" https://code.facebook.com/posts/1014532261909640/react-native-bringing-modern-web-techniques-to-mobile/" class="markup--anchor markup--p-anchor" rel="nofollow">In the words of Tom Occhino </a>, a software engineer at Facebook, they're trying the approach of "learn once, write anywhere" which is completely in the spirit of such a diverse ecosystem as this one.</p><h4 name= "ad27" id="ad27" class="graf--h4">Notable applications</h4><p name="7125" id="7125" class="graf--p">While <em class="markup--em markup--p-em">React Native</em> doesn't support Android just yet, it's great that Facebook is using it in their own apps already (Facebook Groups and Facebook Ads Manager). Android support should arrive in less than two months.</p><p name= "c87e" id="c87e" class="graf--p graf--last">Mobile applications written in <em class="markup--em markup--p-em">Ionic</em> or <em class="markup--em markup--p-em">Phonegap</em> include popular applications such as Sworkit, Mallzee, Chefsteps, Snowbuddy and Rormix. There are extensive lists of <a href="http://showcase.ionicframework.com/" data-href=" http://showcase.ionicframework.com/" class="markup--anchor markup--p-anchor" rel="nofollow">applications built with <em class="markup--em markup--p-em">Ionic</em></a> and <a href=" http://phonegap.com/app/" data-href="http://phonegap.com/app/" class="markup--anchor markup--p-anchor" rel="nofollow">applications built with <em class="markup--em markup--p-em">Phonegap </em></a>.</p></div></div></section><section name="09e3" class=" section--body"><div class="section-divider layoutSingleColumn"><hr class="section-divider"></div><div class= "section-content"><div class="section-inner layoutSingleColumn"><h3 name="d83b" id="d83b" class="graf--h3 graf--first">Back-end development</h3><p name="8779" id="8779" class="graf--p"><em class="markup--em markup--p-em">Node.js</em> is also the main driving force in back-end development in JavaScript.</p><p name="ab46" id="ab46" class="graf--p">The main advantage of <em class="markup--em markup--p-em">Node.js</em> is it's event-driven, non-blocking I/O model. That said - <em class="markup--em markup--p-em">Node.js</em> is great at handling data-intensive real-time applications with many concurrent requests. <em class="markup--em markup--p-em">Node.js</em> does it by handling all these concurrent requests on a single thread and thereby greatly reducing needed system resources and allowing for great scalability.</p><p name="0cc6" id="0cc6" class="graf--p">A typical example for these benefits are chat applications. They require uninterrupted connections from clients to a chat room (<em class="markup--em markup--p-em">real-time, non-blocking</em>) and notifications of new messages (<em class="markup--em markup--p-em">event-driven</em>) where you're supposed to support large numbers of clients and rooms (<em class="markup--em markup--p-em">data-intensive</em>).</p><p name="cb0f" id="cb0f" class="graf--p">You can also have a fairly decent web server written in JavaScript. The main takeaway here is that its main purpose shouldn't be CPU intensive tasks or connections to a relational database, but a high volume of connections.</p><p name="eb3a" id="eb3a" class="graf--p">The most popular modules associated with back-end development are:</p><ul class= "postList"><li name="5ea7" id="5ea7" class="graf--li"><a href="http://expressjs.com/" data-href="http://expressjs.com/" class="markup--anchor markup--li-anchor" rel="nofollow">express</a>  - simple web framework for Node.js</li><li name="3b99" id="3b99" class="graf--li"><a href="http://socket.io/" data-href="http://socket.io/" class="markup--anchor markup--li-anchor" rel= "nofollow">socket.io</a> - module for building real-time web applications</li><li name="a248" id="a248" class="graf--li"><a href="https://github.com/foreverjs/forever" data-href=" https://github.com/foreverjs/forever" class="markup--anchor markup--li-anchor" rel="nofollow">forever</a> - module for ensuring that a given Node.js script runs continously</li></ul><h4 name="6316" id="6316" class="graf--h4">How these modules fit together</h4><p name="38a6" id="38a6" class="graf--p">First of all, you need a web server which can process typical HTTP request on various routes like <em class="markup--em markup--p-em">http://localhost:3000/about</em>. That's where <em class="markup--em markup--p-em">express</em> comes in.</p><p name= "b071" id="b071" class="graf--p">To have an uninterrupted connection with the server, <em class="markup--em markup--p-em">socket.io</em> is used with a server-side and client-side component of establishing connections.</p><p name="2363" id="2363" class="graf--p">Since <em class="markup--em markup--p-em">express</em> runs on one thread, we must ensure that an exception doesn't stop the process (and server altogether). For that purposes, we use <em class="markup--em markup--p-em">forever.</em></p><p name="2aa7" id="2aa7" class="graf--p graf--last">To learn more about these modules, visit their respective websites which feature many tutorials (<em class="markup--em markup--p-em">socket.io</em> even has you building a chat server and client as a <em class="markup--em markup--p-em">hello world </em>application).</p></div></div></section><section name="f113" class=" section--body"><div class= "section-divider layoutSingleColumn"><hr class="section-divider"></div><div class="section-content"><div class="section-inner layoutSingleColumn"><h3 name="c9b5" id="c9b5" class="graf--h3 graf--first">Any combination of the above</h3><p name="a6c8" id="a6c8" class="graf--p graf--empty"><br></p><figure name="64bc" id="64bc" class="graf--figure"><div class= "aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 421px;"><div class="aspect-ratio-fill" style="padding-bottom: 60.199999999999996%;"></div><img class="graf-image" data-image-id="1*mC4t0Ve7iHoZnfrAC2e2pw.png" data-width="1005" data-height="605" data-action="zoom" data-action-value="1*mC4t0Ve7iHoZnfrAC2e2pw.png" src=" https://cdn-images-2.medium.com/max/1005/1*mC4t0Ve7iHoZnfrAC2e2pw.png" data-scroll="native"></div><figcaption class="imageCaption">Meteor JavaScript app platform</figcaption></figure><p name="9586" id="9586" class="graf--p">It's easy to imagine how all these aspects come together.</p><p name="f19e" id="f19e" class="graf--p">One of the most popular way of combining them is having a full-stack JavaScript framework like <a href="http://mean.io/" data-href="http://mean.io/" class="markup--anchor markup--p-anchor" rel="nofollow">MEAN</a> or <a href=" https://www.meteor.com/" data-href="https://www.meteor.com/" class="markup--anchor markup--p-anchor" rel="nofollow">Meteor</a>.<br><em class="markup--em markup--p-em">MEAN</em> combines <em class="markup--em markup--p-em">express, Angular, Node.js </em>and<em class="markup--em markup--p-em"> MongoDB </em>to offer a web platform whose back-end as well as front-end are written in JavaScript.<br><em class="markup--em markup--p-em">Meteor</em> is a platform offering full-stack web and mobile application development in JavaScript.</p><p name="0b98" id= "0b98" class="graf--p">Another example could be a JavaScript minifier for which you write the base module for <em class="markup--em markup--p-em">Node.js</em> and then use that module in a CLI application, a desktop application, a mobile application and a web application (served by <em class="markup--em markup--p-em">express</em>, of course<em class="markup--em markup--p-em">) - all in JavaScript</em>.</p><p name="4c2f" id="4c2f" class="graf--p graf--last">The possibilities are endless and we're probably just scratching the surface. This ecosystem is exploding with new techniques, frameworks, modules and even language specs being defined all the time. It's really exciting.</p></div></div></section><section name="8941" class=" section--body section--last"><div class="section-divider layoutSingleColumn"><hr class="section-divider"></div><div class="section-content"><div class="section-inner layoutSingleColumn"><h3 name="1ad2" id="1ad2" class="graf--h3 graf--first">Where should I start?</h3><p name="a130" id="a130" class="graf--p">That depends on how familiar with JavaScript you are right now.</p><p name="f774" id="f774" class="graf--p">Should you only be starting out, there are great resources to start with JavaScript (or programming, for that matter) like <a href="https://www.codecademy.com/tracks/javascript" data-href="https://www.codecademy.com/tracks/javascript" class="markup--anchor markup--p-anchor" rel="nofollow">Codecademy</a>, <a href ="http://nodeschool.io/#workshoppers" data-href="http://nodeschool.io/#workshoppers" class="markup--anchor markup--p-anchor" rel="nofollow">Nodeschool</a> or <a href=" https://www.codeschool.com/paths/javascript" data-href="https://www.codeschool.com/paths/javascript" class="markup--anchor markup--p-anchor" rel="nofollow">Codeschool</a> which are all interactive and fun.</p><p name="a04a" id="a04a" class="graf--p">If you've got some <em class="markup--em markup--p-em">jQuery</em> knowledge under your belt and have been dabbling with pure JavaScript, know that no framework or library is ever going to replace a good understanding of core JavaScript. Start with really digging into the nitty-gritty of JavaScript. For that purpose, I can't recommend Kyle Simpson's <a href="https://github.com/getify/You-Dont-Know-JS" data-href="https://github.com/getify/You-Dont-Know-JS" class="markup--anchor markup--p-anchor" rel="nofollow"><em class="markup--em markup--p-em">You don't know JS</em></a> series enough. It's open source and available on GitHub. The open source nature makes it really easy for you to contribute with errors you notice in the books. The books are also available as hard copies if you prefer reading that way with the added benefit of supporting the author.</p><p name="7c24" id="7c24" class="graf--p">With a strong JavaScript core, it would be wise to brush up on <em class="markup--em markup--p-em">Node.js</em>. As you've seen, it's the basis for almost all of the aspects. <em class="markup--em markup--p-em">Node.js</em> promotes asynchronous programming which takes a while to get accustomed to but solves the problem of blocking UI. The aforementioned learning sources (<em class="markup--em markup--p-em">Nodeschool</em> and <em class="markup--em markup--p-em">Codeschool</em>) can also be used here. </p><p name="83d0" id="83d0" class="graf--p graf--last">After that, just follow the path that seems the most interesting. Chances are, you'll fall deeper down the rabbit hole, discover new things and enjoy the experience even more.</p></div></div></section></main>			</div>		<!--=========================			END : POST =============================-->		<!--=========================			START : POST		=============================-->		<div class="post-wrapper">		<h1>JavaScript Not Working? Start with the 10 Most Common JavaScript Mistakes</h1>		<div data-view="content#body" data-subscribe="true" class="content_body"><p>Today, <a href=" http://en.wikipedia.org/wiki/JavaScript" target="_blank">JavaScript</a> is at the core of virtually all modern web applications. The past several years in particular have witnessed the proliferation of a wide array of powerful JavaScript-based libraries and frameworks for <a href="http://en.wikipedia.org/wiki/Single-page_application" target="_blank">single page application (SPA)</a> development, graphics and animation, and even server-side JavaScript platforms.  JavaScript has truly become ubiquitous in the world of web app development and is therefore an increasingly important skill to master.</p><p>At first blush, JavaScript may seem quite simple.  And indeed, to build basic JavaScript functionality into a web page is a fairly straightforward task for any experienced software developer, even if they're new to JavaScript.  Yet the language is significantly more nuanced, powerful, and complex than one would initially be lead to believe.  <strong>Indeed, many of JavaScript's subtleties lead to a number of common problems that keep it from working &ndash; 10 of which we discuss here &ndash; that are important to be aware of and avoid in one's quest to become a <a href="http://www.toptal.com/javascript">master JavaScript developer</a>.</strong></p><h2 id= "common-mistake-1-incorrect-references-to-this">Common Mistake #1: Incorrect references to <code>this</code></h2><p>I once heard a comedian say:</p><blockquote>  <p><em>"I'm not really </em> <strong><em>here</em></strong><em>, because what's</em> <strong><em>here</em></strong><em>, besides</em> <strong><em>there</em></strong><em>, without the</em> <strong><em>‘t' </em></strong><em>?"</em></p></blockquote><p>That joke in many ways characterizes the type of confusion that often exists for developers regarding <a href=" https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/this" target="_blank">JavaScript's <code>this</code> keyword</a>.  I mean, is <code>this</code> really this, or is it something else entirely?  Or is it undefined?</p><p>As JavaScript coding techniques and design patterns have become increasingly sophisticated over the years, there's been a corresponding increase in the proliferation of self-referencing scopes within callbacks and closures, which are a fairly common source of "this/that confusion".</p><p>Consider this example code snippet:</p><pre><code class=" hljs javascript">Game.prototype.restart = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">() </span> {</span>  <span class="hljs-keyword">this</span>.clearLocalStorage();  <span class="hljs-keyword">this</span>.timer = setTimeout(<span class="hljs-function"><span class= "hljs-keyword">function</span><span class="hljs-params">()</span> {</span>    <span class="hljs-keyword">this</span>.clearBoard();    <span class="hljs-comment">// what is "this"?</span> }, <span class="hljs-number">0</span>);};</code></pre><p>Executing the above code results in the following error:</p><pre><code class=" hljs livecodeserver">Uncaught TypeError: undefined is <span class="hljs-operator">not</span> <span class="hljs-operator">a</span> <span class="hljs-function"><span class="hljs-keyword">function</span></span></code></pre><p>Why?</p><p>It's all about context.  The reason you get the above error is because, when you invoke <code>setTimeout()</code>, you are actually invoking <code>window.setTimeout()</code>.  As a result, the anonymous function being passed to <code>setTimeout()</code> is being defined in the context of the <code>window</code> object, which has no <code>clearBoard()</code> method.</p><p>A traditional, old-browser-compliant solution is to simply save your reference to <code>this</code> in a variable that can then be inherited by the closure; e.g.:</p><pre><code class=" hljs javascript">Game.prototype.restart = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> {</span>  <span class="hljs-keyword">this </span>.clearLocalStorage();  <span class="hljs-keyword">var</span> self = <span class="hljs-keyword">this</span>;   <span class="hljs-comment">// save reference to 'this', while it's still this!</span>  <span class="hljs-keyword">this</span>.timer = setTimeout(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span>{ </span>    self.clearBoard();    <span class="hljs-comment">// oh OK, I do know who 'self' is!</span>  }, <span class="hljs-number">0</span>);};</code></pre><p>Alternatively, in newer browsers, you can use the <code>bind()</code> method to pass in the proper reference:</p><pre><code class=" hljs javascript">Game.prototype.restart = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> {</span>  <span class="hljs-keyword">this</span>.clearLocalStorage();  <span class="hljs-keyword">this</span> .timer = setTimeout(<span class="hljs-keyword">this</span>.reset.bind(<span class="hljs-keyword">this</span>), <span class="hljs-number">0</span>);  <span class="hljs-comment">// bind to 'this'</span>};Game.prototype.reset = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span>{</span>    <span class="hljs-keyword">this </span>.clearBoard();    <span class="hljs-comment">// ahhh, back in the context of the right 'this'!</span>};</code></pre><h2 id="common-mistake-2-thinking-there-is-block-level-scope"> Common Mistake #2: Thinking there is block-level scope</h2><p>As discussed in our <a href="http://www.toptal.com/javascript/#hiring-guide">JavaScript Hiring Guide</a>, a common source of confusion among JavaScript developers (and therefore a common source of bugs) is assuming that JavaScript creates a new scope for each code block.  Although this is true in many other languages, it is <em>not</em> true in JavaScript.  Consider, for example, the following code:</p><pre><code class=" hljs r"><span class="hljs-keyword">for</span> (var i = <span class= "hljs-number">0</span>; i &lt; <span class="hljs-number">10</span>; i++) {  /* <span class="hljs-keyword">...</span> */}console.log(i);  // what will this output?</code></pre><p>If you guess that the <code>console.log()</code> call would either output <code>undefined</code> or throw an error, you guessed incorrectly.  Believe it or not, it will output <code>10</code>. Why?</p><p>In most other languages, the code above would lead to an error because the "life" (i.e., scope) of the variable <code>i</code> would be restricted to the <code>for</code> block. In JavaScript, though, this is not the case and the variable <code>i</code> remains in scope even after the <code>for</code> loop has completed, retaining its last value after exiting the loop. (This behavior is known, incidentally, as <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/var#var_hoisting" target="_blank"> variable hoisting</a>).</p><p>It is worth noting, though, that support for block-level scopes <em>is</em> making its way into JavaScript through the <a href=" https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/let" target="_blank">new <code>let</code> keyword</a>. The <code>let</code> keyword is already available in JavaScript 1.7 and is slated to become an officially supported JavaScript keyword as of <a href="https://people.mozilla.org/~jorendorff/es6-draft.html" target="_blank">ECMAScript 6</a>. </p><p>New to JavaScript? Read up on <a href="http://www.toptal.com/javascript/javascript-prototypes-scopes-and-performance-what-you-need-to-know">scopes, prototypes, and more.</a></p><h2 id="common-mistake-3-creating-memory-leaks">Common Mistake #3: Creating memory leaks</h2><p>Memory leaks are almost inevitable JavaScript problems if you're not consciously coding to avoid them.  There are numerous ways for them to occur, so we'll just highlight a couple of their more common occurrences.</p><p><strong>Memory Leak Example 1: Dangling references to defunct objects</strong></p><p>Consider the following code:</p><pre><code class=" hljs javascript"><span class="hljs-keyword">var</span> theThing = <span class="hljs-literal">null</span>; <span class="hljs-keyword">var</span> replaceThing = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> {</span>  <span class= "hljs-keyword">var</span> priorThing = theThing;  <span class="hljs-comment">// hold on to the prior thing</span>  <span class="hljs-keyword">var</span> unused = <span class= "hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> {</span>    <span class="hljs-comment">// 'unused' is the only place where 'priorThing' is referenced,</span>    <span class="hljs-comment">// but 'unused' never gets invoked</span>    <span class="hljs-keyword">if</span> (priorThing) {      console.log(<span class="hljs-string" >"hi"</span>);    }  };  theThing = {    longStr: <span class="hljs-keyword">new</span> <span class="hljs-built_in">Array</span>(<span class="hljs-number">1000000</span>).join(<span class= "hljs-string">'*'</span>),  <span class="hljs-comment">// create a 1MB object</span>    someMethod: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class= "hljs-params">()</span> {</span>      console.log(someMessage);    }  };};setInterval(replaceThing, <span class="hljs-number">1000</span>);    <span class="hljs-comment">// invoke `replaceThing' once every second</span></code></pre><p><em>If you run the above code and monitor memory usage, you'll find that you've got a massive memory leak, leaking a full megabyte per second!</em>  And even a manual GC doesn't help. So it looks like we are leaking <code>longStr</code> every time <code>replaceThing</code> is called.  But why?</p><p>Let's examine things in more detail:</p><p>Each <code>theThing</code> object contains its own 1MB <code>longStr</code> object.  Every second, when we call <code>replaceThing</code>, it holds on to a reference to the prior <code>theThing</code> object in <code>priorThing</code>.  But we still wouldn't think this would be a problem, since each time through, the previously referenced <code>priorThing</code> would be dereferenced (when <code>priorThing</code> is reset via <code>priorThing = theThing;</code>).  And moreover, is only referenced in the main body of <code> replaceThing</code> and in the function <code>unused</code> which is, in fact, never used.</p><p>So again we're left wondering why there is a memory leak here!?</p><p>To understand what's going on, we need to better understand how things are working in JavaScript under the hood.  The typical way that closures are implemented is that every function object has a link to a dictionary-style object representing its lexical scope.  If both functions defined inside <code>replaceThing</code> actually used <code>priorThing</code>, it would be important that they both get the same object, even if <code>priorThing</code> gets assigned to over and over, so both functions share the same lexical environment.  But as soon as a variable is used by any closure, it ends up in the lexical environment shared by all closures in that scope.  And that little nuance is what leads to this gnarly memory leak.  (More detail on this is available <a href="https://www.meteor.com/blog/2013/08/13/an-interesting-kind-of-javascript-memory-leak" target="_blank">here</a>.)</p><p><strong>Memory Leak Example 2: Circular references </strong></p><p>Consider this code fragment:</p><pre><code class=" hljs javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title"> addClickHandler</span><span class="hljs-params">(element)</span> {</span>    element.click = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title" >onClick</span><span class="hljs-params">(e)</span> {</span>        alert(<span class="hljs-string">"Clicked the "</span> + element.nodeName)    }}</code></pre><p>Here, <code>onClick </code> has a closure which keeps a reference to <code>element</code> (via <code>element.nodeName</code>). By also assigning <code>onClick</code> to <code>element.click</code>, the circular reference is created; i.e.: <code>element</code> -&gt; <code>onClick</code> -&gt; <code>element</code> -&gt; <code>onClick</code> -&gt; <code>element</code>…</p><p>Interestingly, even if <code>element</code> is removed from the DOM, the circular self-reference above would prevent <code>element</code> and <code>onClick</code> from being collected, and hence, a memory leak.</p><p><strong>Avoiding Memory Leaks: What you need to know</strong></p><p>JavaScript's memory management (and, in paticular, <a href=" http://en.wikipedia.org/wiki/Garbage_collection_(computer_science)" target="_blank">garbage collection</a>) is largely based on the notion of object <a href=" http://javascript.info/tutorial/memory-leaks#memory-management-in-javascript" target="_blank">reachability</a>.</p><p>The following objects are assumed to be <em>reachable</em> and are known as "roots":</p><ul>  <li>Objects referenced from anywhere in the current <em>call stack</em> (that is, all local variables and parameters in the functions currently being invoked, and all the variables in the closure scope)</li>  <li>All <em>global</em> variables</li></ul><p><em>Objects are kept in memory at least as long as they are accessible from any of the roots through a reference, or a chain of references.</em></p><p>There is a Garbage Collector (GC) in the browser which cleans memory occupied by unreachable objects; i.e., objects will be removed from memory <em>if and only if</em> the GC believes that they are unreachable.  Unfortunately, it's fairly easy to end up with defunct "zombie" objects that are in fact no longer in use but that the GC still thinks are "reachable".</p><h2 id="common-mistake-4-confusion-about-equality">Common Mistake #4: Confusion about equality</h2><p>One of the conveniences in JavaScript is that it will automatically coerce any value being referenced in a boolean context to a boolean value.  But there are cases where this can be as confusing as it is convenient.  Some of the following, for example, have been known to bite many a JavaScript developer:</p><pre><code class=" hljs r">// All of these evaluate to <span class="hljs-string"> 'true'</span>!console.log(false == <span class="hljs-string">'0'</span>);console.log(null == undefined);console.log(<span class="hljs-string">" \t\r\n"</span> == <span class="hljs-number"> 0</span>);console.log(<span class="hljs-string">''</span> == <span class="hljs-number">0</span>);// And these do too!<span class="hljs-keyword">if</span> ({}) // <span class="hljs-keyword" >...</span><span class="hljs-keyword">if</span> ([]) // <span class="hljs-keyword">...</span></code></pre><p>With regard to the last two, despite being empty (which might lead one to believe that they would evaluate to <code>false</code>), both <code>{}</code> and <code>[]</code> are in fact objects and <em>any</em> object will be coerced to a boolean value of <code> true</code> in JavaScript, consistent with the <a href="http://www.ecma-international.org/ecma-262/5.1/#sec-9.2" target="_blank">ECMA-262 specification</a>.</p><p>As these examples demonstrate, the rules of type coercion can sometimes be clear as mud.  Accordingly, unless type coercion is explicitly desired, it's typically best to use <code>===</code> and <code>!== </code> (rather than <code>==</code> and <code>!=</code>), so as to avoid any unintended side-effects of type coercion.  (<code>==</code> and <code>!=</code> automatically perform type conversion when comparing two things, whereas <code>===</code> and <code>!==</code> do the same comparison without type conversion.)</p><p>And completely as a sidepoint &ndash; but since we're talking about type coercion and comparisons &ndash; it's worth mentioning that comparing <code>NaN</code> with <em>anything</em> (even <code>NaN</code>!) will <em>always</em> return <code>false</code>.  <em>You therefore cannot use the equality operators (<code>==</code>, <code>===</code>, <code>!=</code>, <code>!==</code>) to determine whether a value is <code>NaN </code> or not.</em>  Instead, use the built-in global <code>isNaN()</code> function:</p><pre><code class=" hljs javascript">console.log(<span class="hljs-literal">NaN</span> == <span class="hljs-literal">NaN</span>);    <span class="hljs-comment">// false</span>console.log(<span class="hljs-literal">NaN</span> === <span class="hljs-literal">NaN</span>);   <span class= "hljs-comment">// false</span>console.log(<span class="hljs-built_in">isNaN</span>(<span class="hljs-literal">NaN</span>));    <span class="hljs-comment">// true</span></code></pre><h2 id= "common-mistake-5-inefficient-dom-manipulation">Common Mistake #5: Inefficient DOM manipulation</h2><p>JavaScript makes it relatively easy to manipulate the DOM (i.e., add, modify, and remove elements), but does nothing to promote doing so efficiently.</p><p>A common example is code that adds a series of DOM Elements one at a time.  Adding a DOM element is an expensive operation.  Code that adds multiple DOM elements consecutively is inefficient and likely not to work well.</p><p>One effective alternative when multiple DOM elements need to be added is to use <a href="https://developer.mozilla.org/en-US/docs/Web/API/DocumentFragment" target="_blank">document fragments</a> instead, thereby improving both efficiency and performance.</p><p> For example:</p><pre><code class=" hljs coffeescript"><span class="hljs-reserved">var</span> div = <span class="hljs-built_in">document</span>.getElementsByTagName(<span class= "hljs-string">"my_div"</span>);<span class="hljs-reserved">var</span> fragment = <span class="hljs-built_in">document</span>.createDocumentFragment();<span class="hljs-keyword">for</span> (<span class="hljs-reserved">var</span> e = <span class="hljs-number">0</span>; e &lt; elems.length; e++) {  <span class="hljs-regexp">//</span> elems previously set to list <span class= "hljs-keyword">of</span> elements    fragment.appendChild(elems[e]);}div.appendChild(fragment.cloneNode(<span class="hljs-literal">true</span>));</code></pre><p>In addition to the inherently improved efficiency of this approach, creating attached DOM elements is expensive, whereas creating and modifying them while detached and then attaching them yields much better performance.</p><h2 id="common-mistake-6-incorrect-use-of-function-definitions-inside-for-loops">Common Mistake #6: Incorrect use of function definitions inside <code>for</code> loops </h2><p>Consider this code:</p><pre><code class=" hljs coffeescript"><span class="hljs-reserved">var</span> elements = <span class="hljs-built_in">document</span>.getElementsByTagName( <span class="hljs-string">'input'</span>);<span class="hljs-reserved">var</span> n = elements.length;    <span class="hljs-regexp">//</span> assume we have <span class="hljs-number">10 </span> elements <span class="hljs-keyword">for</span> <span class="hljs-keyword">this</span> example<span class="hljs-keyword">for</span> (<span class="hljs-reserved">var</span> i = <span class="hljs-number">0</span>; i &lt; n; i++) {    elements[i].onclick = <span class="hljs-reserved">function</span>() {        <span class="hljs-built_in">console</span>.log(<span class= "hljs-string">"This is element #"</span> + i);    };}</code></pre><p>Based on the above code, if there were 10 input elements, clicking <em>any</em> of them would display "This is element #10"!  This is because, by the time <code>onclick</code> is invoked for <em>any</em> of the elements, the above for loop will have completed and the value of <code>i</code> will already be 10 (for <em>all</em> of them).</p><p>Here's how we can correct the above code problems, though, to achieve the desired behavior:</p><pre><code class=" hljs javascript"><span class= "hljs-keyword">var</span> elements = document.getElementsByTagName(<span class="hljs-string">'input'</span>);<span class="hljs-keyword">var</span> n = elements.length;    <span class= "hljs-comment">// assume we have 10 elements for this example</span><span class="hljs-keyword">var</span> makeHandler = <span class="hljs-function"><span class="hljs-keyword">function </span><span class="hljs-params">(num)</span> {</span>  <span class="hljs-comment">// outer function</span>     <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>   <span class="hljs-comment">// inner function</span>         console.log(<span class="hljs-string">"This is element #"</span> + num);     };};<span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; n; i++) { elements[i].onclick = makeHandler(i+<span class="hljs-number">1</span>);}</code></pre><p>In this revised version of the code, <code>makeHandler</code> is immediately executed each time we pass through the loop, each time receiving the then-current value of <code>i+1</code> and binding it to a scoped <code>num</code> variable.  The outer function returns the inner function (which also uses this scoped <code>num</code> variable) and the element's <code>onclick</code> is set to that inner function.  This ensures that each <code>onclick</code> receives and uses the proper <code>i</code> value (via the scoped <code>num</code> variable).</p><form method="post" data-view="blog_subscribe#subscribe" data-type="text" data-remote="" data-placement= "post" class="embeddable_form for-post" action="/blog/subscribe"><div class="embeddable_form-row is-label"><div class="embeddable_form-label_title">Like what you're reading?</div><div class="embeddable_form-label">Get the latest updates first.</div></div><div class="embeddable_form-row"><input type="text" placeholder="Enter your email address..." name="email" data-role= "email" class="input is-medium" autocomplete="off"></div><div class="embeddable_form-row_wrapper is-footer"><div class="embeddable_form-row is-submit"><input type="submit" value="Get Exclusive Updates" data-role="submit" class="button is-green_candy is-default is-full_width"></div><div class="embeddable_form-row is-privacy"><div class="embeddable_form-privacy"><div class="embeddable_form-privacy_icon"></div><div class="embeddable_form-privacy_text">No spam. Just great engineering posts.</div></div></div></div><div style="display: none;" data-template ="{&quot;html&quot;:&quot;\u003cdiv class=\&quot;embeddable_form-row is-label is-success\&quot;\u003e\u003cdiv class=\&quot;embeddable_form-label_title\&quot;\u003eLike what you\u0026#39;re reading?\u003c/div\u003e\u003cdiv class=\&quot;embeddable_form-label\&quot;\u003eGet the latest updates first.\u003c/div\u003e\u003c/div\u003e\u003cdiv class=\&quot;embeddable_form-row is-success\&quot;\u003e\u003cdiv class=\&quot;embeddable_form-label is-header\&quot;\u003eThank you for subscribing!\u003c/div\u003e\u003c/div\u003e\u003cdiv class=\&quot;embeddable_form-row is-success\&quot;\u003e\u003cdiv class=\&quot;embeddable_form-done\&quot;\u003e\u003cul class=\&quot;blog_follow_us\&quot;\u003e\u003cli class=\&quot;blog_follow_us-source\&quot;\u003e\u003cdiv class=\&quot;fb-like\&quot; data-href=\&quot;http://www.toptal.com/blog\&quot; data-send=\&quot;false\&quot; data-layout=\&quot;button_count\&quot; data-width=\&quot;450\&quot; data-show-faces=\&quot;false\&quot;\u003e\u003c/div\u003e\n\u003c/li\u003e\u003cli class=\&quot;blog_follow_us-source is-twitter\&quot;\u003e\u003ca class=\&quot;twitter-follow-button\&quot; data-show-count=\&quot;true\&quot; href=\&quot; https://twitter.com/toptalllc\&quot;\u003eFollow @toptalllc\u003c/a\u003e\u003c/li\u003e\u003cli class=\&quot;blog_follow_us-source\&quot;\u003e\u003cdiv class=\&quot;g-follow\&quot; data-annotation=\&quot;bubble\&quot; data-height=\&quot;20\&quot; data-href=\&quot;https://plus.google.com/109028009576318848424\&quot; data-rel=\&quot;publisher\&quot;\u003e\u003c/div\u003e\u003cscript type=\&quot;text/javascript\&quot;\u003e(function() {\n  var po = document.createElement('script'); po.type = 'text/javascript'; po.async = true; po.defer = true;\n  po.src = 'https://apis.google.com/js/platform.js'; po.text = '{lang: \&quot;en-US\&quot;}';\n  var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(po, s);\n})();\u003c/script\u003e\u003c/li\u003e\u003c/ul\u003e\u003c/div\u003e\u003c/div\u003e&quot;}" data-role= "success_template" class="embeddable_form-template"></div></form><h2 id="common-mistake-7-failure-to-properly-leverage-prototypal-inheritance">Common Mistake #7: Failure to properly leverage prototypal inheritance</h2><p>A surprisingly high percentage of JavaScript developers fail to fully understand, and therefore to fully leverage, the features of prototypal inheritance.</p><p>Here's a simple example.  Consider this code:</p><pre><code class=" hljs javascript">BaseObject = <span class="hljs-function"><span class="hljs-keyword">function </span><span class="hljs-params">(name)</span> {</span>    <span class="hljs-keyword">if</span>(<span class="hljs-keyword">typeof</span> name !== <span class="hljs-string">"undefined" </span>) {        <span class="hljs-keyword">this</span>.name = name;    } <span class="hljs-keyword">else</span> {        <span class="hljs-keyword">this</span>.name = <span class= "hljs-string">'default'</span>    }};</code></pre><p>Seems fairly straightforward.  If you provide a name, use it, otherwise set the name to ‘default'; e.g.:</p><pre><code class=" hljs coffeescript"><span class="hljs-reserved">var</span> firstObj = <span class="hljs-keyword">new</span> BaseObject();<span class="hljs-reserved">var</span> secondObj = <span class= "hljs-keyword">new</span> BaseObject(<span class="hljs-string">'unique'</span>);<span class="hljs-built_in">console</span>.log(firstObj.name);  <span class="hljs-regexp">//</span><span class="hljs-function"> -&gt;</span> Results <span class="hljs-keyword">in</span> <span class="hljs-string">'default'</span><span class="hljs-built_in">console</span>.log(secondObj.name); <span class="hljs-regexp">//</span><span class="hljs-function"> -&gt;</span> Results <span class="hljs-keyword">in</span> <span class="hljs-string">'unique'</span></code></pre><p>But what if we were to do this:</p><pre><code class=" hljs sql"><span class="hljs-operator"><span class="hljs-keyword">delete</span> secondObj.name;</span></code></pre><p>We'd then get: </p><pre><code class=" hljs coffeescript"><span class="hljs-built_in">console</span>.log(secondObj.name); <span class="hljs-regexp">//</span><span class="hljs-function"> -&gt;</span> Results <span class="hljs-keyword">in</span> <span class="hljs-string">'undefined'</span></code></pre><p>But wouldn't it be nicer for this to revert to ‘default'?  This can easily be done, if we modify the original code to leverage prototypal inheritance, as follows:</p><pre><code class=" hljs javascript">BaseObject = <span class="hljs-function"><span class= "hljs-keyword">function</span> <span class="hljs-params">(name)</span> {</span>    <span class="hljs-keyword">if</span>(<span class="hljs-keyword">typeof</span> name !== <span class= "hljs-string">"undefined"</span>) {        <span class="hljs-keyword">this</span>.name = name;    }};BaseObject.prototype.name = <span class="hljs-string">'default'</span>;</code></pre><p> With this version, <code>BaseObject</code> inherits the <code>name</code> property from its <code>prototype</code> object, where it is set (by default) to <code>'default'</code>.  Thus, if the constructor is called without a name, the name will default to <code>default</code>.  And similarly, if the <code>name</code> property is removed from an instance of <code> BaseObject</code>, the prototype chain will then be searched and the <code>name</code> property will be retrieved from the <code>prototype</code> object where its value is still <code> 'default'</code>.  So now we get:</p><pre><code class=" hljs coffeescript"><span class="hljs-reserved">var</span> thirdObj = <span class="hljs-keyword">new</span> BaseObject(<span class= "hljs-string">'unique'</span>);<span class="hljs-built_in">console</span>.log(thirdObj.name);  <span class="hljs-regexp">//</span><span class="hljs-function"> -&gt;</span> Results <span class="hljs-keyword">in</span> <span class="hljs-string">'unique'</span><span class="hljs-keyword">delete</span> thirdObj.name;<span class="hljs-built_in">console</span> .log(thirdObj.name);  <span class="hljs-regexp">//</span><span class="hljs-function"> -&gt;</span> Results <span class="hljs-keyword">in</span> <span class="hljs-string">'default' </span></code></pre><h2 id="common-mistake-8-creating-incorrect-references-to-instance-methods">Common Mistake #8: Creating incorrect references to instance methods</h2><p>Let's define a simple object, and create and instance of it, as follows:</p><pre><code class=" hljs javascript"><span class="hljs-keyword">var</span> MyObject = <span class="hljs-function"><span class= "hljs-keyword">function</span><span class="hljs-params">()</span> {</span>}MyObject.prototype.whoAmI = <span class="hljs-function"><span class="hljs-keyword">function</span><span class= "hljs-params">()</span> {</span>    console.log(<span class="hljs-keyword">this</span> === window ? <span class="hljs-string">"window"</span> : <span class="hljs-string">"MyObj"</span>);}; <span class="hljs-keyword">var</span> obj = <span class="hljs-keyword">new</span> MyObject();</code></pre><p>Now, for convenience, let's create a reference to the <code>whoAmI</code> method, presumably so we can access it merely by <code>whoAmI()</code> rather than the longer <code>obj.whoAmI()</code>:</p><pre><code class=" hljs fix"><span class="hljs-attribute">var whoAmI </span>=<span class="hljs-string"> obj.whoAmI;</span></code></pre><p>And just to be sure everything looks copacetic, let's print out the value of our new <code>whoAmI</code> variable:</p><pre><code class=" hljs rust">console.<span class="hljs-keyword">log</span>(whoAmI);</code></pre><p>Outputs:</p><pre><code class=" hljs javascript"><span class="hljs-function" ><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> {</span>    console.log(<span class="hljs-keyword">this</span> === window ? <span class="hljs-string"> "window"</span> : <span class="hljs-string">"MyObj"</span>);}</code></pre><p>OK, cool.  Looks fine.</p><p>But now, look at the difference when we invoke <code>obj.whoAmI()</code> vs. our convenience reference <code>whoAmI()</code>:</p><pre><code class=" hljs ruby">obj.whoAmI();  <span class="hljs-regexp">//</span> outputs <span class="hljs-string">"MyObj"</span> (as expected)whoAmI();      <span class="hljs-regexp">//</span> outputs <span class="hljs-string">"window"</span> (uh-oh!)</code></pre><p>What went wrong?</p><p>The headfake here is that, when we did the assignment <code>var whoAmI = obj.whoAmI;</code>, the new variable <code>whoAmI</code> was being defined in the <em>global</em> namespace.  As a result, its value of <code> this</code> is <code>window</code>, <em>not</em> the <code>obj</code> instance of <code>MyObject</code>!</p><p>Thus, if we really need to create a reference to an existing method of an object, we need to be sure to do it within that object's namespace, to preserve the value of <code>this</code>.  One way of doing this would be, for example, as follows:</p><pre><code class=" hljs javascript"><span class="hljs-keyword">var</span> MyObject = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span> }MyObject.prototype.whoAmI = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>    console.log(<span class="hljs-keyword"> this</span> === window ? <span class="hljs-string">"window"</span> : <span class="hljs-string">"MyObj"</span>);};<span class="hljs-keyword">var</span> obj = <span class="hljs-keyword">new </span> MyObject();obj.w = obj.whoAmI;   <span class="hljs-comment">// still in the obj namespace</span>obj.whoAmI();  <span class="hljs-comment">// outputs "MyObj" (as expected)</span> obj.w();       <span class="hljs-comment">// outputs "MyObj" (as expected)</span></code></pre><h2 id= "common-mistake-9-providing-a-string-as-the-first-argument-to-settimeout-or-setinterval">Common Mistake #9: Providing a string as the first argument to <code>setTimeout</code> or <code> setInterval</code></h2><p>For starters, let's be clear on something here:  Providing a string as the first argument to <code>setTimeout</code> or <code>setInterval</code> is <strong>not </strong> itself a mistake per se.  It is perfectly legitimate JavaScript code.  The issue here is more one of performance and efficiency.  What is rarely explained is that, under the hood, if you pass in a string as the first argument to <code>setTimeout</code> or <code>setInterval</code>, it will be passed to the <em>function constructor</em> to be converted into a new function. This process can be slow and inefficient, and is rarely necessary.</p><p>The alternative to passing a string as the first argument to these methods is to instead pass in a <em>function</em>.  Let's take a look at an example.</p><p>Here, then, would be a fairly typical use of <code>setInterval</code> and <code>setTimeout</code>, passing a <em>string</em> as the first parameter:</p><pre><code class=" hljs bash"><span class="hljs-keyword">set</span>Interval(<span class="hljs-string">"logTime()"</span>, <span class="hljs-number">1000</span>); <span class="hljs-keyword">set</span>Timeout(<span class="hljs-string">"logMessage('"</span> + msgValue + <span class="hljs-string">"')"</span>, <span class="hljs-number">1000</span>); </code></pre><p>The better choice would be to pass in a <em>function</em> as the initial argument; e.g.:</p><pre><code class=" hljs lua">setInterval(logTime, <span class="hljs-number">1000 </span>);   // passing the logTime <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">to</span> <span class="hljs-title">setInterval </span><span class="hljs-title">setTimeout</span><span class="hljs-params">(function()</span></span> {       // passing an anonymous <span class="hljs-function"><span class="hljs-keyword"> function</span> <span class="hljs-title">to</span> <span class="hljs-title">setTimeout</span>    <span class="hljs-title">logMessage</span><span class="hljs-params">(msgValue) </span></span>;     // (msgValue is still accessible <span class="hljs-keyword">in</span> this scope)  }, <span class="hljs-number">1000</span>);</code></pre><h2 id= "common-mistake-10-failure-to-use-strict-mode">Common Mistake #10: Failure to use "strict mode"</h2><p>As explained in our <a href="http://www.toptal.com/javascript#hiring-guide"> JavaScript Hiring Guide</a>, "strict mode" (i.e., including <code>'use strict';</code> at the beginning of your JavaScript source files) is a way to voluntarily enforce stricter parsing and error handling on your JavaScript code at runtime, as well as making it more secure.</p><p>While, admittedly, failing to use strict mode is not a "mistake" per se, its use is increasingly being encouraged and its omission is increasingly becoming considered bad form.</p><p>Here are some key benefits of strict mode:</p><ul>  <li><strong>Makes debugging easier. </strong> Code errors that would otherwise have been ignored or would have failed silently will now generate errors or throw exceptions, alerting you sooner to problems in your code and directing you more quickly to their source.</li>  <li><strong>Prevents accidental globals.</strong> Without strict mode, assigning a value to an undeclared variable automatically creates a global variable with that name. This is one of the most common errors in JavaScript. In strict mode, attempting to do so throws an error.</li>  <li><strong>Eliminates <code>this</code> coercion</strong>.  Without strict mode, a reference to a <code>this</code> value of null or undefined is automatically coerced to the global.  This can cause many headfakes and pull-out-your-hair kind of bugs.  In strict mode, referencing a a <code>this</code> value of null or undefined throws an error.</li>  <li><strong>Disallows duplicate property names or parameter values.</strong>  Strict mode throws an error when it detects a duplicate named property in an object (e.g., <code>var object = {foo: "bar", foo: "baz"};</code>) or a duplicate named argument for a function (e.g., <code>function foo(val1, val2, val1){}</code>), thereby catching what is almost certainly a bug in your code that you might otherwise have wasted lots of time tracking down.</li>  <li><strong>Makes eval() safer.</strong>  There are some differences in the way <code>eval()</code> behaves in strict mode and in non-strict mode.  Most significantly, in strict mode, variables and functions declared inside of an <code>eval()</code> statement are <em>not</em> created in the containing scope (they <em>are</em> created in the containing scope in non-strict mode, which can also be a common source of problems).</li>  <li><strong>Throws error on invalid usage of <code>delete</code>.</strong>  The <code>delete </code> operator (used to remove properties from objects) cannot be used on non-configurable properties of the object.  Non-strict code will fail silently when an attempt is made to delete a non-configurable property, whereas strict mode will throw an error in such a case.</li></ul><h2 id="wrap-up">Wrap-up</h2><p>As is true with any technology, the better you understand why and how JavaScript works and doesn't work, the more solid your code will be and the more you'll be able to effectively harness to true power of the language.  Conversely, lack of proper understanding of JavaScript paradigms and concepts is indeed where many JavaScript problems lie.</p><p>Thoroughly familiarizing yourself with the language's nuances and subtleties is the most effective strategy for improving your proficiency and increasing your productivity. Avoiding many common JavaScript mistakes will help when your JavaScript is not working.</p><div class="post-join"><a href="/javascript" class="button is-white_and_green is-default is-full_width">Hiring? Meet the Top 10 JavaScript Developers for Hire in September 2015 </a></div></div>			</div>		<!--=========================			END : POST		=============================-->		<!--=========================			START : POST		=============================-->		<div class="post-wrapper">		<h1>JavaScript Best Practices</h1>		<div class="entry-content">				<p>JavaScript is not only amazing language but also very tricky language. To make correct use of it, you need to follow some best practices to avoid any problems that might come about otherwise. I share some of the best practices you really should be following when writing JavaScript code. Of course this is not an exhaustive list but at the most&nbsp;fundamental&nbsp;level, every programmer should know and adhere to it.</p><h3>1 -NEVER FORGET VAR KEYWORD</h3><p>Most of the developers know about this but yet I wanted to mention this because it may not be clear to some or newbies or people having other programming language background that come to JavaScript.</p><p>Consider the following piece of code:</p><div><div class="syntaxhighlighter  jscript" id= "highlighter_103873"><table cellspacing="0" cellpadding="0" border="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2 </div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="jscript keyword">function</code> <code class="jscript plain">myFunc(){</code></div><div class="line number2 index1 alt1"><code class="jscript keyword">var</code> <code class= "jscript plain">firstName = </code><code class="jscript string">'sarfraz'</code><code class="jscript plain">;</code></div><div class="line number3 index2 alt2"><code class="jscript plain"> lastName = </code><code class="jscript string">'ahmed'</code><code class="jscript plain">;</code></div><div class="line number4 index3 alt1"><code class="jscript plain">} </code></div></div></td></tr></tbody></table></div></div><p>It should be noted that in JS, variables have<strong> function-level</strong> scope which means a variable declared inside a function can not be accessed outside of it. So let's test above two variables:</p><div><div class="syntaxhighlighter  jscript" id="highlighter_252734"><table cellspacing="0" cellpadding= "0" border="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="jscript plain">myFunc();</code></div><div class="line number2 index1 alt1"><code class="jscript plain">console.log(lastName); </code><code class="jscript comments">// ahmed</code></div><div class="line number3 index2 alt2"><code class="jscript plain">console.log(firstName); </code><code class="jscript comments">// undefined</code></div></div></td></tr></tbody></table></div></div><p>As you will notice, we are still able to access <strong>lastName</strong> variable. The reason is that it does not have function-level scope because we forgot to put <strong>var</strong> keyword before it unlike <strong>firstName</strong> variable. Hence, <strong>lastName</strong> variable went into <strong>global</strong> scope and became part of <strong>window </strong>(while inside browser<strong>)</strong> object eg <strong> window.lastName</strong> will output the last name too.</p><p>It is therefore always required to put <strong>var</strong> keyword before variables so that they do not become part of global scope. It has following benefits:</p><ul><li>You save the memory and improve performance</li><li>You don't pollute the global scope</li><li>You mistakenly don't overwrite a global variable that might have the same variable name</li></ul><p>This is a very important concept and JS developers have always been finding solutions to avoid this problem. One of the most popular solution is <a target="_blank" href="http://chrisiona.com/learning-modern-javascript/the-singleton-pattern/">Singleton </a>or <a target="_blank" href=" http://www.adequatelygood.com/2010/3/JavaScript-Module-Pattern-In-Depth">Module Pattern</a> you should check out. By the way, if you want to see other patterns also, take a look at: </p><p><a target="_blank" href="http://addyosmani.com/resources/essentialjsdesignpatterns/book/">Essential JavaScript Design Patterns For Beginners</a></p><h3>2 &ndash;&nbsp;DECLARE VARIABLES ON TOP</h3><p>Another thing that should be followed is that variables should be declared on top of each function because of what is known as <strong>JavaScript Hoisting</strong> . Here is an example:</p><div><div class="syntaxhighlighter  jscript" id="highlighter_467466"><table cellspacing="0" cellpadding="0" border="0"><tbody><tr><td class="gutter"><div class= "line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="jscript keyword">var</code> <code class="jscript plain">name = </code><code class="jscript string">'sarfraz'</code><code class="jscript plain">;</code></div><div class="line number2 index1 alt1">&nbsp;</div><div class="line number3 index2 alt2"><code class="jscript plain">(</code><code class="jscript keyword">function</code><code class="jscript plain">(){</code></div><div class="line number4 index3 alt1"><code class="jscript plain">console.log(name); </code><code class="jscript comments">// undefined</code></div><div class="line number5 index4 alt2"><code class="jscript spaces">&nbsp;&nbsp; &nbsp;&nbsp;</code><code class="jscript keyword">var</code> <code class="jscript plain">name = </code><code class="jscript string">'nawaz'</code><code class="jscript plain">;</code></div><div class="line number6 index5 alt1"><code class="jscript spaces">&nbsp;&nbsp; &nbsp;&nbsp;</code><code class="jscript plain">console.log(name); </code><code class="jscript comments">// nawaz</code></div><div class="line number7 index6 alt2"><code class="jscript plain">})(); </code></div></div></td></tr></tbody></table></div></div><p>Notice that even though <strong>name</strong> variable is outside the scope of function but on the very fist line it gives back <strong>undefined</strong> rather than actual name. The reason for this is that interpreter hoists or moves variables on top of the function, here is how interpreter sees or re-arranges it:</p><div><div class="syntaxhighlighter  jscript" id="highlighter_571826"><table cellspacing="0" cellpadding="0" border="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5 </div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div></td><td class="code"><div class="container" ><div class="line number1 index0 alt2"><code class="jscript keyword">var</code> <code class="jscript plain">name = </code><code class="jscript string">'sarfraz'</code><code class="jscript plain">;</code></div><div class="line number2 index1 alt1">&nbsp;</div><div class="line number3 index2 alt2"><code class="jscript plain">(</code><code class="jscript keyword">function </code><code class="jscript plain">(){</code></div><div class="line number4 index3 alt1"><code class="jscript spaces">&nbsp;&nbsp; &nbsp;&nbsp;</code><code class="jscript keyword">var </code> <code class="jscript plain">name;</code></div><div class="line number5 index4 alt2"><code class="jscript spaces">&nbsp;&nbsp; &nbsp;&nbsp;</code><code class="jscript plain"> console.log(name); </code><code class="jscript comments">// undefined</code></div><div class="line number6 index5 alt1"><code class="jscript spaces">&nbsp;&nbsp; &nbsp;&nbsp;</code><code class="jscript plain">name = </code><code class="jscript string">'nawaz'</code><code class="jscript plain">;</code></div><div class="line number7 index6 alt2"><code class="jscript spaces"> &nbsp;&nbsp; &nbsp;&nbsp;</code><code class="jscript plain">console.log(name); </code><code class="jscript comments">// nawaz</code></div><div class="line number8 index7 alt1"><code class= "jscript plain">})();</code></div></div></td></tr></tbody></table></div></div><p>As can be seen, <strong>name</strong> variable has been hoisted to top and declared there and also <strong> var</strong> keyword has been stripped from it where we assigned the value of ‘<strong>nawaz</strong>‘.</p><p>The same is issue is not only with variables but also <strong>function declarations</strong> but NOT with <strong>function expressions</strong>. You can learn more about the difference between function declaration and function expression here:</p><p><a target ="_blank" href="http://kangax.github.com/nfe/">Named Functions Demystified</a></p><p>The solution to this problem is to always declare <strong>variables and function declarations</strong> on top of container function:</p><div><div class="syntaxhighlighter  jscript" id="highlighter_418408"><table cellspacing="0" cellpadding="0" border="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class= "line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="jscript keyword">function</code> <code class="jscript plain">myFunc(){</code></div><div class="line number2 index1 alt1"><code class="jscript spaces"> &nbsp;&nbsp; &nbsp;&nbsp;</code><code class="jscript keyword">var</code> <code class="jscript plain">foo;</code></div><div class="line number3 index2 alt2"><code class="jscript spaces"> &nbsp;&nbsp; &nbsp;&nbsp;</code><code class="jscript keyword">var</code> <code class="jscript plain">bar;</code></div><div class="line number4 index3 alt1"><code class="jscript spaces"> &nbsp;&nbsp; &nbsp;&nbsp;</code><code class="jscript keyword">var</code> <code class="jscript plain">baz;</code></div><div class="line number5 index4 alt2">&nbsp;</div><div class="line number6 index5 alt1"><code class="jscript spaces">&nbsp;&nbsp; &nbsp;&nbsp;</code><code class="jscript comments">// do something foo, bar, baz</code></div><div class="line number7 index6 alt2"><code class="jscript plain">}</code></div></div></td></tr></tbody></table></div></div><p>The preferred and recommended syntax though that you must follow is to declare all variables in one go by separating them with a comma:</p><div><div class="syntaxhighlighter  jscript" id="highlighter_413003"><table cellspacing="0" cellpadding="0" border="0"><tbody><tr><td class= "gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4 </div><div class="line number5 index4 alt2">5</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="jscript keyword">function</code> <code class="jscript plain">myFunc(){</code></div><div class="line number2 index1 alt1"><code class="jscript spaces">&nbsp;&nbsp; &nbsp;&nbsp;</code><code class="jscript keyword">var</code> <code class="jscript plain">foo, bar, baz;</code></div><div class="line number3 index2 alt2">&nbsp;</div><div class="line number4 index3 alt1"><code class="jscript spaces">&nbsp;&nbsp; &nbsp;&nbsp;</code><code class="jscript comments">// do something foo, bar, baz</code></div><div class="line number5 index4 alt2"><code class="jscript plain">} </code></div></div></td></tr></tbody></table></div></div><h3>3 &ndash; INITIALIZING MULTIPLE VARIABLES</h3><p>Declaring variables on top is good practice but not <em>multiple initialization</em>. Consider:</p><div><div class="syntaxhighlighter  jscript" id="highlighter_581122"><table cellspacing="0" cellpadding="0" border="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div></td><td class="code"><div class="container"><div class= "line number1 index0 alt2"><code class="jscript keyword">function</code> <code class="jscript plain">myFunc(){</code></div><div class="line number2 index1 alt1"><code class="jscript keyword">var</code> <code class="jscript plain">lang = encoding = </code><code class="jscript string">'en'</code><code class="jscript plain">;</code></div><div class="line number3 index2 alt2"><code class="jscript plain">}</code></div></div></td></tr></tbody></table></div></div><p>This is a very common mistake even amongst experienced JS developers where they think they have quickly assigned two variables same scope and same value. Though value for both <strong>lang</strong> and <strong>encoding</strong> variable is some but not the scope. Try it out: </p><div><div class="syntaxhighlighter  jscript" id="highlighter_31908"><table cellspacing="0" cellpadding="0" border="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2" ><code class="jscript plain">myFunc();</code></div><div class="line number2 index1 alt1"><code class="jscript plain">console.log(encoding); </code><code class="jscript comments">// en </code></div><div class="line number3 index2 alt2"><code class="jscript plain">console.log(lang); </code><code class="jscript comments">// undefined </code></div></div></td></tr></tbody></table></div></div><p>Here again, variable <strong>encoding</strong> has gone into global scope. Since <strong>var</strong> keyword is only appears before <strong>lang</strong> variable, that is the one which gets correct functional scope. In short, you should avoid that shorthand initialization unfortunately.</p><h3>4 &ndash; STARTING CURLY BRACE ON THE SAME LINE</h3><p>Consider the following code block where starting curly brace "<strong>{</strong>" is on a new line, this works fine in most situations. </p><div><div class="syntaxhighlighter  jscript" id="highlighter_516876"><table cellspacing="0" cellpadding="0" border="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div></td><td class="code"><div class= "container"><div class="line number1 index0 alt2"><code class="jscript keyword">function</code> <code class="jscript plain">myFunc()</code></div><div class="line number2 index1 alt1"><code class="jscript plain">{</code></div><div class="line number3 index2 alt2"><code class="jscript comments">// some code</code></div><div class="line number4 index3 alt1"><code class= "jscript plain">}</code></div></div></td></tr></tbody></table></div></div><p>However, same convention will not yield expected results if you happen to write:</p><div><div class= "syntaxhighlighter  jscript" id="highlighter_816584"><table cellspacing="0" cellpadding="0" border="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class ="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="jscript keyword">function</code> <code class="jscript plain"> myFunc()</code></div><div class="line number2 index1 alt1"><code class="jscript plain">{</code></div><div class="line number3 index2 alt2"><code class="jscript spaces">&nbsp;&nbsp; &nbsp;&nbsp;</code><code class="jscript keyword">return</code></div><div class="line number4 index3 alt1"><code class="jscript spaces">&nbsp;&nbsp; &nbsp;&nbsp;</code><code class="jscript plain">{</code></div><div class="line number5 index4 alt2"><code class="jscript spaces">&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;</code><code class="jscript plain">name: </code><code class="jscript string">'sarfraz'</code></div><div class="line number6 index5 alt1"><code class="jscript spaces">&nbsp;&nbsp; &nbsp;&nbsp;</code><code class="jscript plain">}; </code></div><div class="line number7 index6 alt2"><code class="jscript plain">}</code></div><div class="line number8 index7 alt1">&nbsp;</div><div class="line number9 index8 alt2"><code class="jscript keyword">var</code> <code class="jscript plain">f = myFunc();</code></div><div class="line number10 index9 alt1"><code class="jscript plain">console.log(f); </code></div></div></td></tr></tbody></table></div></div><p>The result will be <strong>undefined</strong> because behind the scenes, interpreter puts a semicolon ‘<strong>;</strong>‘ after the <strong>return</strong> keyword making it:</p><div><div class="syntaxhighlighter  jscript" id="highlighter_848141"><table cellspacing="0" cellpadding="0" border="0" ><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div></td><td class="code" ><div class="container"><div class="line number1 index0 alt2"><code class="jscript keyword">function</code> <code class="jscript plain">myFunc()</code></div><div class="line number2 index1 alt1"><code class="jscript plain">{</code></div><div class="line number3 index2 alt2"><code class="jscript spaces">&nbsp;&nbsp; &nbsp;&nbsp;</code><code class="jscript keyword"> return</code><code class="jscript plain">; </code><code class="jscript comments">// &lt;----------------</code></div><div class="line number4 index3 alt1"><code class="jscript spaces"> &nbsp;&nbsp; &nbsp;&nbsp;</code><code class="jscript plain">{</code></div><div class="line number5 index4 alt2"><code class="jscript spaces">&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp; </code><code class="jscript plain">name: </code><code class="jscript string">'sarfraz'</code></div><div class="line number6 index5 alt1"><code class="jscript spaces">&nbsp;&nbsp; &nbsp;&nbsp;</code><code class="jscript plain">};</code></div><div class="line number7 index6 alt2"><code class="jscript plain">} </code></div></div></td></tr></tbody></table></div></div><p>To remedy such hard-to-debug issues, it is good practice to always put starting curly brace on the <strong>same</strong> line, this would work fine though:</p><div><div class="syntaxhighlighter  jscript" id="highlighter_329951"><table cellspacing="0" cellpadding="0" border="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class= "line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div></td><td class= "code"><div class="container"><div class="line number1 index0 alt2"><code class="jscript keyword">function</code> <code class="jscript plain">myFunc() {</code></div><div class="line number2 index1 alt1"><code class="jscript spaces">&nbsp;&nbsp; &nbsp;&nbsp;</code><code class="jscript keyword">return</code> <code class="jscript plain">{</code></div><div class="line number3 index2 alt2"><code class="jscript spaces">&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;</code><code class="jscript plain">name: </code><code class="jscript string">'sarfraz' </code></div><div class="line number4 index3 alt1"><code class="jscript spaces">&nbsp;&nbsp; &nbsp;&nbsp;</code><code class="jscript plain">};</code></div><div class="line number5 index4 alt2"><code class="jscript plain">}</code></div><div class="line number6 index5 alt1">&nbsp;</div><div class="line number7 index6 alt2"><code class="jscript keyword">var</code> <code class ="jscript plain">f = myFunc();</code></div><div class="line number8 index7 alt1"><code class="jscript plain">console.log(f.name); </code><code class="jscript comments">// sarfraz </code></div></div></td></tr></tbody></table></div></div><p>And that's a reason why <a target="_blank" href="http://www.crockford.com/">Douglas Crockford</a>&nbsp;in his book "<a target= "_blank" href="http://www.amazon.com/JavaScript-Good-Parts-Douglas-Crockford/dp/0596517742">JavaScript: The Good Parts</a>", advocates this syntax for JS:</p><div><div class= "syntaxhighlighter  jscript" id="highlighter_903727"><table cellspacing="0" cellpadding="0" border="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class ="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="jscript keyword"> function</code> <code class="jscript plain">() {</code></div><div class="line number2 index1 alt1"><code class="jscript spaces">&nbsp;&nbsp; &nbsp;&nbsp;</code><code class="jscript comments">// some code</code></div><div class="line number3 index2 alt2"><code class="jscript plain">}</code></div><div class="line number4 index3 alt1">&nbsp;</div><div class="line number5 index4 alt2"><code class="jscript keyword">if</code> <code class="jscript plain">(expression) {</code></div><div class="line number6 index5 alt1"><code class="jscript spaces"> &nbsp;&nbsp; &nbsp;&nbsp;</code><code class="jscript comments">// do something</code></div><div class="line number7 index6 alt2"><code class="jscript plain">} </code></div></div></td></tr></tbody></table></div></div><p>Go ahead and check out <a target="_blank" href="http://javascript.crockford.com/code.html">JavaScript Coding Style</a> to learn more as well as naming conventions.</p><p>Notice that it is not the <strong>return&nbsp;</strong>keyword affected by automatic semi-colon insertion but all these too:</p><ul><li><strong> var</strong> statement</li><li><strong>empty</strong> statement</li><li><strong>expression</strong> statement</li><li><strong>do-while</strong> statement</li><li><strong>continue</strong> statement</li><li><strong>break</strong> statement</li><li><strong>throw</strong> statement</li></ul><p>Experienced JavaScript developers know pretty well about JavaScript's <em>automatic semi-colon insertion</em> problem and avoid it. The benefit of above coding style however is that you avoid this problem without knowing that this problem exists just by following that coding style.</p><h3>5 &ndash; USE ARRAY LITERAL INSTEAD OF NEW ARRAY()</h3><p>There are two ways you can create arrays in JS:</p><div><div class="syntaxhighlighter  jscript" id= "highlighter_690013"><table cellspacing="0" cellpadding="0" border="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2 </div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="jscript keyword">var</code> <code class="jscript plain">arr1 = </code><code class= "jscript keyword">new</code> <code class="jscript plain">Array(); </code><code class="jscript comments">// array constructor</code></div><div class="line number2 index1 alt1"><code class= "jscript keyword">var</code> <code class="jscript plain">arr2 = []; </code><code class="jscript comments">// array literal</code></div></div></td></tr></tbody></table></div></div><p> Though both serve the purpose of creating arrays but there is important difference between the two.</p><p>In JS, even an array is an object. With first <em>constructor</em> method above, you are telling interpreter to call constructor of the Array and generate an object. The interpreter looks up into the execution context to find the constructor and once found, it calls it and creates the Array object. It seems that it has performance hit too as compared to latter <em>array literal</em> method. With the array literal method, interpreter just creates the array on run-time with no extra processing done.</p><p>Other than that, Array constructor is mis-guiding the way it handles its parameters. Consider:</p><div><div class= "syntaxhighlighter  jscript" id="highlighter_587707"><table cellspacing="0" cellpadding="0" border="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class ="line number2 index1 alt1">2</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="jscript plain">console.log(</code><code class="jscript keyword">new</code> <code class="jscript plain">Array(5)); </code><code class="jscript comments">// [,,,,]</code></div><div class="line number2 index1 alt1"><code class="jscript plain"> console.log(</code><code class="jscript keyword">new</code> <code class="jscript plain">Array(</code><code class="jscript string">'5'</code><code class="jscript plain">)); </code><code class="jscript comments">// ["5"]</code></div></div></td></tr></tbody></table></div></div><p>When one argument is passed to Array and that happens to be a number, a new array is returned with its length property equal to that number passed. The important thing to note here is that Array will be initialized from what number you specified to it, for example:</p><div><div class="syntaxhighlighter  jscript" id="highlighter_303914"><table cellspacing="0" cellpadding="0" border="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class= "line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div></td><td class= "code"><div class="container"><div class="line number1 index0 alt2"><code class="jscript comments">// Array constructor</code></div><div class="line number2 index1 alt1"><code class= "jscript keyword">var</code> <code class="jscript plain">arr = </code><code class="jscript keyword">new</code> <code class="jscript plain">Array(2);</code></div><div class="line number3 index2 alt2"><code class="jscript plain">console.log(arr.length); </code><code class="jscript comments">// 2</code></div><div class="line number4 index3 alt1"><code class="jscript plain"> console.log(arr[0]); </code><code class="jscript comments">// undefined</code></div><div class="line number5 index4 alt2">&nbsp;</div><div class="line number6 index5 alt1"><code class= "jscript comments">// Array literal</code></div><div class="line number7 index6 alt2"><code class="jscript keyword">var</code> <code class="jscript plain">arr = [2];</code></div><div class ="line number8 index7 alt1"><code class="jscript plain">console.log(arr.length); </code><code class="jscript comments">// 1</code></div><div class="line number9 index8 alt2"><code class= "jscript plain">console.log(arr[0]); </code><code class="jscript comments">// 2</code></div></div></td></tr></tbody></table></div></div><p>So the conclusion is to always use array literal notation rather than Array constructor.</p><h3>6 &ndash; USE PROTOTYPE TO SHARE ACROSS</h3><p>The concept of prototypes or prototypal inheritance is rather confusing. I have seen people especially inexperienced JS developers adding class members to parent function which needs to be shared across child classes. Consider the following code:</p><div><div class= "syntaxhighlighter  jscript" id="highlighter_13770"><table cellspacing="0" cellpadding="0" border="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class= "line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="jscript keyword">function</code> <code class="jscript plain">Person(name){</code></div><div class="line number2 index1 alt1"><code class="jscript keyword">this</code><code class="jscript plain"> .name = name;</code></div><div class="line number3 index2 alt2"><code class="jscript plain">}</code></div></div></td></tr></tbody></table></div></div><p>Now let's assume we want to have child classes the ability to display the names some how, one of doing it is putting method directly inside <strong>Person</strong> class:</p><div><div class="syntaxhighlighter  jscript" id ="highlighter_953270"><table cellspacing="0" cellpadding="0" border="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2 </div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6 </div><div class="line number7 index6 alt2">7</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="jscript keyword">function</code> <code class="jscript plain">Person(name){</code></div><div class="line number2 index1 alt1"><code class="jscript spaces">&nbsp;&nbsp; &nbsp;&nbsp;</code><code class="jscript keyword">this </code><code class="jscript plain">.name = name;</code></div><div class="line number3 index2 alt2">&nbsp;</div><div class="line number4 index3 alt1"><code class="jscript spaces"> &nbsp;&nbsp; &nbsp;&nbsp;</code><code class="jscript keyword">this</code><code class="jscript plain">.display = </code><code class="jscript keyword">function</code><code class="jscript plain">(){</code></div><div class="line number5 index4 alt2"><code class="jscript spaces">&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;</code><code class="jscript plain">alert(</code><code class="jscript keyword">this</code><code class="jscript plain">.name);</code></div><div class="line number6 index5 alt1"><code class="jscript spaces">&nbsp;&nbsp; &nbsp;&nbsp;</code><code class="jscript plain">}</code></div><div class="line number7 index6 alt2"><code class="jscript plain">}</code></div></div></td></tr></tbody></table></div></div><p>Other way is to use <strong>prototype</strong>:</p><div><div class="syntaxhighlighter  jscript" id="highlighter_479941"><table cellspacing="0" cellpadding="0" border="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class= "line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="jscript keyword">function</code> <code class="jscript plain">Person(name){</code></div><div class="line number2 index1 alt1"><code class="jscript spaces"> &nbsp;&nbsp; &nbsp;&nbsp;</code><code class="jscript keyword">this</code><code class="jscript plain">.name = name;</code></div><div class="line number3 index2 alt2"><code class="jscript plain">}</code></div><div class="line number4 index3 alt1">&nbsp;</div><div class="line number5 index4 alt2"><code class="jscript plain">Person.prototype.display = </code><code class= "jscript keyword">function</code><code class="jscript plain">(){</code></div><div class="line number6 index5 alt1"><code class="jscript spaces">&nbsp;&nbsp; &nbsp;&nbsp;</code><code class= "jscript plain">alert(</code><code class="jscript keyword">this</code><code class="jscript plain">.name);</code></div><div class="line number7 index6 alt2"><code class="jscript plain">} </code></div></div></td></tr></tbody></table></div></div><p>With both ways, all child classes will be able to use the display method but there is important difference between the two. When you attach any methods or properties via <strong>this</strong> (first way above) to a class then all <em>instances</em> of inheriting child classes will also have these properties or methods <em>within</em> them or their signature. On the other hand, when you use <em>prototype</em> to add members (properties and methods) to parent class, children classes will still inherit all members but it won't be present inside their own functionality or signature, rather they will be borrowing that functionality from their parent class thereby saving <em>memory </em>. For this reason, later approach seems good to follow in most situations.</p><h3>7 &ndash; PUT COMMA BEFORE PROPERTIES</h3><p>When working with objects or arrays, it is always a good idea to put a comma before the variable or object property eg:</p><div><div class="syntaxhighlighter  jscript" id="highlighter_927982"><table cellspacing="0" cellpadding="0" border= "0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="jscript comments">// jQuery - create a new div with some css </code></div><div class="line number2 index1 alt1"><code class="jscript plain">$(</code><code class="jscript string">'&lt;/pre&gt;&lt;/pre&gt;&lt;/pre&gt;</code></div><div class="line number3 index2 alt2"><code class="jscript string">&lt;div&gt;'</code><code class="jscript plain">).attr({&lt;/div&gt;</code></div><div class="line number4 index3 alt1"><code class= "jscript plain">&lt;pre&gt;</code></div><div class="line number5 index4 alt2"><code class="jscript plain">&lt;pre&gt;</code></div><div class="line number6 index5 alt1"><code class= "jscript plain">&lt;pre&gt;</code></div><div class="line number7 index6 alt2"><code class="jscript spaces">&nbsp;</code><code class="jscript string">"id"</code> <code class="jscript plain" >: </code><code class="jscript string">"myId"</code></div><div class="line number8 index7 alt1"><code class="jscript spaces">&nbsp;</code><code class="jscript plain">, </code><code class= "jscript string">"class"</code> <code class="jscript plain">: </code><code class="jscript string">"myClass"</code></div><div class="line number9 index8 alt2"><code class="jscript spaces"> &nbsp;</code><code class="jscript plain">, </code><code class="jscript string">"class"</code> <code class="jscript plain">: </code><code class="jscript string">"myClass"</code></div><div class="line number10 index9 alt1"><code class="jscript spaces">&nbsp;</code><code class="jscript plain">, </code><code class="jscript string">"color"</code> <code class="jscript plain">: </code><code class="jscript string">"green"</code></div><div class="line number11 index10 alt2"><code class="jscript spaces">&nbsp;</code><code class="jscript plain">, </code><code class= "jscript string">"fontWeight"</code> <code class="jscript plain">: </code><code class="jscript string">"bold"</code></div><div class="line number12 index11 alt1"><code class="jscript plain">});</code></div></div></td></tr></tbody></table></div></div><p>In this way, we never add an extra comma or forget one from the <em>last</em> property. The reason why this is good practice is that, in IE, with extra comma at the last property, we do not get expected results sometimes (<strong>ExtJS</strong> developers must have learned this). I do the same with multiple variable declarations or arguments of function. It also makes the code look pretty too as far as I see it.</p><h3>8 &ndash; DON'T MIX JS AND HTML</h3><p>One of the most important best practices is to always <em>separate JS code from HTML</em> and go <a target="_blank" href="http://en.wikipedia.org/wiki/Unobtrusive_JavaScript">unobtrusive</a>. One would often see code like this:</p><div><div class="syntaxhighlighter  xml" id="highlighter_372669"><table cellspacing="0" cellpadding="0" border="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="xml plain">&lt;</code><code class="xml keyword">a</code> <code class="xml color1">href</code><code class="xml plain">=</code><code class="xml string">"#"</code> <code class="xml color1">onclick</code><code class="xml plain">=</code><code class="xml string">"doSomething()"</code><code class="xml plain">&gt;Some Action&lt;/</code><code class="xml keyword">a</code><code class="xml plain">&gt;</code></div><div class="line number2 index1 alt1"><code class="xml plain">&lt;</code><code class="xml keyword">input</code> <code class="xml color1">type</code><code class="xml plain">=</code><code class="xml string">"button"</code> <code class="xml color1">onclick</code><code class="xml plain">=</code><code class="xml string"> "doSomething()"</code> <code class="xml color1">value</code><code class="xml plain">=</code><code class="xml string">"Do Something"</code> <code class="xml plain">/&gt;</code></div><div class="line number3 index2 alt2"><code class="xml plain">&lt;</code><code class="xml keyword">form</code> <code class="xml color1">onsubmit</code><code class="xml plain">=</code><code class="xml string">"doSomething();"</code><code class="xml plain">&gt;...</code></div></div></td></tr></tbody></table></div></div><p>That's a very bad practice in that it is <em>hard to manage and maintain</em>. HTML and JS should not be mixed ever. You could do the same thing like this:</p><div><div class="syntaxhighlighter  xml" id="highlighter_368075"><table cellspacing="0" cellpadding="0" border="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div><div class="line number21 index20 alt2">21</div><div class="line number22 index21 alt1">22</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="xml plain">&lt;</code><code class="xml keyword">a</code> <code class="xml color1">href</code><code class="xml plain">=</code><code class="xml string">"#"</code> <code class="xml color1">id</code><code class="xml plain">=</code><code class="xml string">"link"</code><code class="xml plain">&gt;Some Action&lt;/</code><code class="xml keyword">a</code><code class="xml plain">&gt;</code></div><div class="line number2 index1 alt1"><code class="xml plain">&lt;</code><code class="xml keyword">input</code> <code class="xml color1">type</code><code class="xml plain">=</code><code class="xml string">"button"</code> <code class="xml color1">id</code><code class= "xml plain">=</code><code class="xml string">"button"</code> <code class="xml color1">value</code><code class="xml plain">=</code><code class="xml string">"Do Something"</code> <code class ="xml plain">/&gt;</code></div><div class="line number3 index2 alt2"><code class="xml plain">&lt;</code><code class="xml keyword">form</code> <code class="xml color1">id</code><code class= "xml plain">=</code><code class="xml string">"frm"</code><code class="xml plain">&gt;...</code></div><div class="line number4 index3 alt1">&nbsp;</div><div class="line number5 index4 alt2" ><code class="xml plain">&lt;</code><code class="xml keyword">script</code> <code class="xml color1">type</code><code class="xml plain">=</code><code class="xml string">"text/javascript" </code><code class="xml plain">&gt;</code></div><div class="line number6 index5 alt1"><code class="xml plain">var link = document.getElementById('link'),</code></div><div class="line number7 index6 alt2"><code class="xml spaces">&nbsp;</code><code class="xml plain">btn = document.getElementById('button'),</code></div><div class="line number8 index7 alt1"><code class= "xml spaces">&nbsp;</code><code class="xml plain">frm = document.getElementById('link');</code></div><div class="line number9 index8 alt2">&nbsp;</div><div class="line number10 index9 alt1"><code class="xml plain">link.onclick = function(){</code></div><div class="line number11 index10 alt2"><code class="xml spaces">&nbsp;</code><code class="xml plain">// do something </code></div><div class="line number12 index11 alt1"><code class="xml plain">};</code></div><div class="line number13 index12 alt2">&nbsp;</div><div class="line number14 index13 alt1" ><code class="xml plain">btn.onclick = function(){</code></div><div class="line number15 index14 alt2"><code class="xml spaces">&nbsp;</code><code class="xml plain">// do something </code></div><div class="line number16 index15 alt1"><code class="xml plain">};</code></div><div class="line number17 index16 alt2">&nbsp;</div><div class="line number18 index17 alt1" ><code class="xml plain">frm.onsubmit = function(){</code></div><div class="line number19 index18 alt2"><code class="xml spaces">&nbsp;</code><code class="xml plain">// validate form </code></div><div class="line number20 index19 alt1"><code class="xml plain">};</code></div><div class="line number21 index20 alt2">&nbsp;</div><div class="line number22 index21 alt1" ><code class="xml plain">&lt;/</code><code class="xml keyword">script</code><code class="xml plain">&gt;</code></div></div></td></tr></tbody></table></div></div><p>This way it becomes easy to manage, maintain or enhance both HTML and JavaScript.</p><h3>9 &ndash; PUT SCRIPTS AT BOTTOM</h3><p>Normally scripts are put in <strong>&lt;head&gt;&lt;/head&gt;</strong> tags but this should be avoided. The reason for this is that browser loads your scripts sequentially and by the time they are loading, nothing else is done and website load times slow down (or at least that's how visitors will perceive it) and you see actual output only after those scripts have been loaded by the browser.</p><p>The best practice is that scripts should be put on bottom of page just before closing body tag eg<strong> &lt;/body&gt;</strong>. This way browser will instantly display page and page load time will be better for users who view that page. </p><p>By the way, always put CSS on top in <strong>&lt;head&gt;&lt;/head&gt;</strong> tags because that's something browser reads first and renders page's layout accordingly.</p><p>Read more about this at famous <a target="_blank" href="http://developer.yahoo.com/performance/rules.html">Yahoo's performance article</a>.</p><p>I would also suggest you to use Yahoo's <a target="_blank" href="http://developer.yahoo.com/yslow/">YSlow </a>or Google's <a target="_blank" href="http://code.google.com/speed/page-speed/">PageSpeed</a>&nbsp;add-on (add-ons of <a target="_blank" href="http://getfirebug.com">Firebug</a>) which suggest you a lot of things on how to improve the performance of the page.</p><h3>10 &ndash; NEVER FORGET SEMI-COLON</h3><p> Always end statements and function expressions with a semi-colon:</p><div><div class="syntaxhighlighter  jscript" id="highlighter_698335"><table cellspacing="0" cellpadding="0" border="0" ><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="jscript keyword">var</code> <code class="jscript plain">name = </code><code class="jscript string">'some name'</code><code class="jscript plain">; </code><code class="jscript comments">// &lt;-------------</code></div><div class="line number2 index1 alt1">&nbsp;</div><div class="line number3 index2 alt2"><code class="jscript keyword">var</code> <code class="jscript plain">myFunc = </code><code class="jscript keyword">function</code><code class="jscript plain">(){</code></div><div class="line number4 index3 alt1"><code class= "jscript comments">// some doe</code></div><div class="line number5 index4 alt2">&nbsp;</div><div class="line number6 index5 alt1"><code class="jscript plain">}; </code><code class= "jscript comments">// &lt;------------</code></div></div></td></tr></tbody></table></div></div><p>This is useful when you want to <em>compress</em> the code (for faster load times). If at any place, semi-colon isn't present, you won't be able to compress the code or wouldn't get expected results most likely code-wise. You should always, always use semi-colons.</p><h3>BONUS </h3><p>The good news is that you can solve most of above problems by using <a target="_blank" href="http://www.jshint.com/">JSHint </a>or&nbsp;<a target="_blank" href="http://jslint.com/" >JSLint&nbsp;</a>code quality tool. It will tell you about best-practices and any errors that might exist in your code. Having said that, it is good to improve your JS skills and avoid the need to go to such tools.</p>			</div>			</div>		<!--=========================			END : POST		=============================--> <!--=========================			START : POST		=============================-->		<div class="post-wrapper">		<h1 class="entry-title"><a rel="bookmark" href=" https://sarfraznawaz.wordpress.com/2012/01/26/javascript-self-invoking-functions/">Javascript Self Invoking&nbsp;Functions</a></h1>		<div class="entry-content">				<p>In this article, I will discuss self-executing or self-invoking functions of javascript and their hidden power with real-world example. We will also see why using <strong>setInterval</strong> is bad in <strong>some</strong> situations and should be avoided.&nbsp;Let's explore little used but extremely powerful self-invoking functions of javascript.</p><h3><strong>Self-Invoking Anonymous Function</strong></h3><p>A self-invoking anonymous runs automatically/immediately when you create it and has no name, hence called anonymous. Here is the format of self-executing anonymous function:</p><div><div class="syntaxhighlighter  jscript" id="highlighter_836799"><table cellspacing="0" cellpadding="0" border="0"><tbody><tr><td class="gutter" ><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="jscript plain">(</code><code class="jscript keyword">function</code><code class="jscript plain">(){</code></div><div class="line number2 index1 alt1"><code class="jscript spaces">&nbsp;</code><code class="jscript comments">// some code…</code></div><div class="line number3 index2 alt2"><code class="jscript plain">})(); </code></div></div></td></tr></tbody></table></div></div><p>You must be aware of the fact that javascript functions run immediately when you put<strong>&nbsp;()</strong>&nbsp;after their names eg:</p><div><div class="syntaxhighlighter  jscript" id="highlighter_195846"><table cellspacing="0" cellpadding="0" border="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="jscript plain">doStuff(); </code><code class="jscript comments">// this will run immediately</code></div></div></td></tr></tbody></table></div></div><p>And:</p><div><div class="syntaxhighlighter  jscript" id="highlighter_315963"><table cellspacing="0" cellpadding="0" border="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2" ><code class="jscript plain">doStuff; </code><code class="jscript comments">// this will not run immediately and can be used as callback </code></div></div></td></tr></tbody></table></div></div><p>Now because&nbsp;<strong>()</strong>&nbsp;exist at the end of self-executing anonymous function above, it will run immediately. </p><p>Interestingly, if you look at the&nbsp;<a target="_blank" href="http://code.jquery.com/jquery-1.4.4.js">source code of jQuery</a>, you will see that everything is&nbsp;wrapped in &nbsp;between:</p><div><div class="syntaxhighlighter  jscript" id="highlighter_617450"><table cellspacing="0" cellpadding="0" border="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="jscript plain">(</code><code class="jscript keyword">function</code><code class="jscript plain">( window, undefined ) {</code></div><div class="line number2 index1 alt1"><code class="jscript spaces">&nbsp;</code><code class="jscript comments">// jQuery code</code></div><div class="line number3 index2 alt2"><code class="jscript plain"> })(window);</code></div></div></td></tr></tbody></table></div></div><p>That is as can be seen also a self-executing anonymous function with arguments. A&nbsp;<strong>window&nbsp;</strong> (and&nbsp;<strong>undefined</strong>) argument is created and is mapped with global&nbsp;<strong>window&nbsp;</strong>object at the bottom&nbsp;<strong>(window)</strong>.</p><p>Notice that you can also write self-executing anonymous function like this:</p><div><div class="syntaxhighlighter  jscript" id="highlighter_517359"><table cellspacing="0" cellpadding="0" border= "0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div></td><td class= "code"><div class="container"><div class="line number1 index0 alt2"><code class="jscript plain">(</code><code class="jscript keyword">function</code><code class="jscript plain">(){ </code></div><div class="line number2 index1 alt1"><code class="jscript spaces">&nbsp;</code><code class="jscript comments">// some code…</code></div><div class="line number3 index2 alt2" ><code class="jscript plain">})();</code></div></div></td></tr></tbody></table></div></div><p>Using extra braces like before <strong>function</strong> keyword is simply coding&nbsp; convention&nbsp;and is used even by famous javascript&nbsp;libraries&nbsp;such as&nbsp;<a target="_blank" href="http://jquery.com/">jQuery</a>&nbsp;and also recommended by&nbsp;<a target= "_blank" href="http://www.crockford.com/">Douglas Crockford</a>. If you are confused about that extra pair of braces, here is another easy to remember notation:</p><div><div class= "syntaxhighlighter  jscript" id="highlighter_394293"><table cellspacing="0" cellpadding="0" border="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class ="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="jscript plain">! </code><code class="jscript keyword">function</code><code class="jscript plain">(){</code></div><div class="line number2 index1 alt1"><code class="jscript comments">// some code… </code></div><div class="line number3 index2 alt2"><code class="jscript plain">}();</code></div></div></td></tr></tbody></table></div></div><div>Notice the addition of <strong>! </strong> before <strong>function</strong> keyword, it is essentially same in functionality to previous notation and also recommended (used by twitter too), quoting <a target="_blank" href=" http://www.ecma-international.org/publications/standards/Ecma-262.htm">docs, section 12.4</a>:</div><div></div><div></div><blockquote><div>An&nbsp;<em>ExpressionStatement</em>&nbsp;cannot start with the&nbsp;<code>function</code>&nbsp;keyword because that might make it ambiguous with a&nbsp;<em>FunctionDeclaration</em>.</div></blockquote><div><h3>Self-Executing Function </h3><p>Self-Executing function is a <strong>named</strong> function that runs immediately. Example:</p><div><div class="syntaxhighlighter  jscript" id="highlighter_167032"><table cellspacing="0" cellpadding="0" border="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="jscript plain">(</code><code class="jscript keyword">function</code> <code class="jscript plain">foo(){</code></div><div class="line number2 index1 alt1"><code class="jscript spaces">&nbsp;</code><code class="jscript comments">// some code…</code></div><div class="line number3 index2 alt2"><code class="jscript plain">})()</code></div></div></td></tr></tbody></table></div></div><p>Notice that now that we have named our function <strong>foo </strong>, it is not an anonymous function though it still is self-executing function because of<strong> ()</strong> at the end.</p><h3>How do they run automatically?</h3><p>This can be best explained through an example. Let's say in&nbsp;your webpage&nbsp;you have this&nbsp;javascript code:</p><div><div class="syntaxhighlighter  jscript" id="highlighter_674273"><table cellspacing="0" cellpadding="0" border="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="jscript keyword">function</code> <code class="jscript plain">showUp(){ </code></div><div class="line number2 index1 alt1"><code class="jscript spaces">&nbsp;</code><code class="jscript plain">alert('Hello There');</code></div><div class="line number3 index2 alt2"><code class="jscript plain">}</code></div></div></td></tr></tbody></table></div></div><p>When you visit&nbsp;the page, the showUp function will not get triggered unless you do so by calling the function:</p><div><div class="syntaxhighlighter  jscript" id="highlighter_748509"><table cellspacing="0" cellpadding="0" border="0"><tbody><tr><td class="gutter"><div class= "line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="jscript keyword"> function</code> <code class="jscript plain">showUp(){</code></div><div class="line number2 index1 alt1"><code class="jscript spaces">&nbsp;</code><code class="jscript plain">alert('Hello There');</code></div><div class="line number3 index2 alt2"><code class="jscript plain">}</code></div><div class="line number4 index3 alt1">&nbsp;</div><div class="line number5 index4 alt2" ><code class="jscript comments">// run the function</code></div><div class="line number6 index5 alt1"><code class="jscript plain">showUp(); </code></div></div></td></tr></tbody></table></div></div><p>However, you can make the function auto-run by making it self-executing function like this:</p><div><div class= "syntaxhighlighter  jscript" id="highlighter_144305"><table cellspacing="0" cellpadding="0" border="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class ="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="jscript plain">(</code><code class="jscript keyword">function</code> <code class="jscript plain">showUp(){</code></div><div class="line number2 index1 alt1"><code class="jscript plain"> alert('Hello There');</code></div><div class="line number3 index2 alt2"><code class="jscript plain">})()</code></div></div></td></tr></tbody></table></div></div><div><h3>Where to use self-executing functions?</h3><p>One obvious situation is when you want to auto-run a function like I showed in above example but that is trivial. If you are in a situation where you want to run a piece of code repeatedly like updating something in the database based on user interaction or fetching records from database every 10 seconds or you want to load new stories via ajax similar to how facebook does on its homepage or some other similar situation, one would normally go for setInterval function something like this:</p><div><div class= "syntaxhighlighter  jscript" id="highlighter_928299"><table cellspacing="0" cellpadding="0" border="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="jscript plain">setInterval(doStuff, 10000); </code></div></div></td></tr></tbody></table></div></div><p>Above, doStuff function will get called every 10 seconds. That is the normal approach most developers seem to go with. However, there is a huge problem with that. The setInterval will call doStuff function exactly at specified time of 10 seconds again and again irrespective of whether doStuff function actually finished doing what it is supposed to do. That is bad and will certainly get you into unexpected results.</p><p>That is one example of where <strong>setInterval</strong> is ^bad^ and should be avoided.</p><p>This is exactly where self-executing functions&nbsp;come in handy. We can do the same task with the help of self-executing function along with&nbsp;setTimeout &nbsp;like this:</p><div><div class="syntaxhighlighter  jscript" id="highlighter_249276"><table cellspacing="0" cellpadding="0" border="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="jscript plain">! </code><code class="jscript keyword">function</code> <code class="jscript plain">foo(){</code></div><div class="line number2 index1 alt1"><code class="jscript spaces">&nbsp;</code><code class="jscript comments">// your other code here</code></div><div class="line number3 index2 alt2">&nbsp;</div><div class="line number4 index3 alt1"><code class="jscript plain"> setTimeout(foo, 10000);</code></div><div class="line number5 index4 alt2">&nbsp;</div><div class="line number6 index5 alt1"><code class="jscript plain">}(); </code></div></div></td></tr></tbody></table></div></div><p>This code will also repeat itself again and again with one difference.&nbsp;setTimeout&nbsp;will never get triggered unless doStuff is finished. A much better approach than using <strong>setInterval</strong> in this situation.</p><p><a target="_blank" href="http://jsbin.com/usali4"><strong>You can see the example in action here.</strong></a></p><p>Another more common use of self-invoking functions is <strong>data privacy</strong>, everything wrapped in them is only available within the scope of these functions.</p></div></div>			</div>			</div>		<!--=========================			END : POST		=============================--> <!--=========================			START : POST		=============================-->		<div class="post-wrapper">		<article class="post clear">      <h1 class= "post__title">        Web Components and concepts, ShadowDOM, imports, templates, custom elements      </h1>      <div class="post__meta">        <a href= "//github.com/toddmotto/toddmotto.github.io/blob/master/_posts/2014-07-02-web-components-concepts-shadow-dom-imports-templates-custom-elements.md" class="post__meta-edit">          <i class="fa fa-github"></i>          Edit this page on GitHub        </a>        <p>          July 02, 2014        </p>      </div>      <p>Web Components, the future of the web, inspired from attending <a href="https://twitter.com/toddmotto/status/482624009553465344">Google I/O</a> I decided to pick up Web Components and actually build something. Since learning the basics around a year ago, it's changed and advanced a lot! Thought I'd write a post on it and share <a href="//github.com/toddmotto/fluidvids-polymer">my first web component</a> yesterday (built with Polymer).</p><p>Before I get into Polymer, we'll look at Web Components in this post, what it means for the web and how it completely changes things and our outlook on building for the web platform from today.</p><p>Gone are the days of actually creating HTML structures and "pages" (what're those?). The web is becoming "all about components", and those components are completely up to us thanks to Web Components.</p><p>We aren't really at a stage where we can use Web Components to it's fullest, browser support is still ongoing implementations and IE are <a href="http://status.modern.ie">in consideration</a> of the entire spec (blows a single fanfare). But it's coming together, give it a few years and we'll get there. Or do we have to wait that long?...</p><p>Google are innovating in this area like no tomorrow with <a href="http://www.polymer-project.org">Polymer.js</a>, a polyfill and platform (that provides additional features such as data-binding, event callbacks and much more) for those missing pieces in modern browsers that don't fully support Web Components.</p><h3>Building blocks of Web Components</h3><p>Before we get over excited about this stuff though, let's actually understand what the <a href="http://www.w3.org/TR/components-intro">Web Components spec</a> really means. First thing's first, Web Components are a collection of building blocks, not a single thing. Let's look at each block to see what's up.</p><p>This will be a very high level view, otherwise this post could end up being three days worth of reading!</p><h4>Templates</h4><p>Templates are where we define reusable code, we even get an element for it with <code>&lt; template&gt;</code>. The first time you use it, don't panic - it's invisible in the visible interface output, until you view source you won't know anything is even there. It's merely a declarative element to create a new template for... anything you like.</p><p>An example of a <code>&lt;template&gt;</code> to populate a profile section for a user:</p><div class= "highlight"><pre><code data-lang="html" class="language-html"><span class="nt">&lt;template</span> <span class="na">id=</span><span class="s">"profileTemplate"</span><span class="nt">&gt; </span>  <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"profile"</span><span class="nt">&gt;</span>    <span class="nt">&lt;img</span> <span class="na">src= </span><span class="s">""</span> <span class="na">class=</span><span class="s">"profile__img"</span><span class="nt">&gt;</span>    <span class="nt">&lt;div</span> <span class="na">class= </span><span class="s">"profile__name"</span><span class="nt">&gt;&lt;/div&gt;</span>    <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"profile__social" </span><span class="nt">&gt;&lt;/div&gt;</span>  <span class="nt">&lt;/div&gt;</span><span class="nt">&lt;/template&gt;</span></code></pre></div><p>Sprinkle some JavaScript to populate it, and append it to the <code>&lt;body&gt;</code>:</p><div class="highlight"><pre><code data-lang="javascript" class="language-javascript"><span class="kd">var</span> <span class="nx"> template</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s1"> '#profileTemplate'</span><span class="p">);</span><span class="nx">template</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s1"> '.profile__img'</span><span class="p">).</span><span class="nx">src</span> <span class="o">=</span> <span class="s1">'toddmotto.jpg'</span><span class="p">;</span><span class="nx">template </span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s1">'.profile__name'</span><span class="p">).</span><span class="nx">textContent </span> <span class="o">=</span> <span class="s1">'Todd Motto'</span><span class="p">;</span><span class="nx">template</span><span class="p">.</span><span class="nx">querySelector </span><span class="p">(</span><span class="s1">'.profile__social'</span><span class="p">).</span><span class="nx">textContent</span> <span class="o">=</span> <span class="s1">'Follow me on Twitter'</span><span class="p">;</span><span class="nb">document</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">appendChild </span><span class="p">(</span><span class="nx">template</span><span class="p">);</span></code></pre></div><p>You'll notice that this is just JavaScript, no new APIs or anything confusing. Nice! For me, a <code>&lt;template&gt;</code> is useless without it's good buddy <em>Custom Elements</em>. We need this to do something useful with the tech, things are all global and disgusting as of now.</p><h4>Custom Elements</h4><p>Custom Elements allow us to define (you guessed it), our own element. This can be anything, but before you go crazy, your elements must have a dash, presumably to avoid any potential naming clashes with future HTML implementations - I think that's a good idea as well.</p><p>So, with our custom element, how do we do it? Simple really, we get the <code>&lt;element&gt;</code> element, so meta. Well, we <em>had</em> the <code>&lt;element&gt;</code> element. Read on, as <code>&lt;element&gt; </code> was recently deprecated and thus needs a JavaScript implementation, but this is the older way:</p><div class="highlight"><pre><code data-lang="html" class="language-html"><span class="nt">&lt;element&gt;</span>  <span class="nt">&lt;template</span> <span class="na">id=</span><span class="s">"profileTemplate"</span><span class="nt">&gt;</span>    <span class="nt"> &lt;div</span> <span class="na">class=</span><span class="s">"profile"</span><span class="nt">&gt;</span>      <span class="nt">&lt;img</span> <span class="na">src=</span><span class="s"> ""</span> <span class="na">class=</span><span class="s">"profile__img"</span><span class="nt">&gt;</span>      <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s" >"profile__name"</span><span class="nt">&gt;&lt;/div&gt;</span>      <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"profile__social"</span><span class="nt"> &gt;&lt;/div&gt;</span>    <span class="nt">&lt;/div&gt;</span>  <span class="nt">&lt;/template&gt;</span><span class="nt">&lt;/element&gt;</span></code></pre></div><p>This example is still deprecated but worth showing. We would've given <code>&lt;element&gt;</code> a <code>name=""</code> attribute to define the custom element:</p><div class="highlight"><pre><code data-lang="html" class="language-html"><span class="nt">&lt;element</span> <span class="na">name=</span><span class="s">"user-profile"</span><span class="nt">&gt;</span>  <span class="nt"> &lt;template</span> <span class="na">id=</span><span class="s">"profileTemplate"</span><span class="nt">&gt;</span>    <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"profile"</span><span class="nt">&gt;</span>      <span class="nt">&lt;img</span> <span class="na">src=</span><span class="s">""</span> <span class="na">class=</span><span class= "s">"profile__img"</span><span class="nt">&gt;</span>      <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"profile__name"</span><span class="nt">&gt;&lt;/div &gt;</span>      <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"profile__social"</span><span class="nt">&gt;&lt;/div&gt;</span>    <span class="nt">&lt;/div &gt;</span>  <span class="nt">&lt;/template&gt;</span><span class="nt">&lt;/element&gt;</span>// usage<span class="nt">&lt;user-profile&gt;&lt;/user-profile&gt; </span></code></pre></div><h5>So what's replacing <code>&lt;element&gt;</code>?</h5><p>Use of <code>&lt;element&gt;</code> was <a href=" http://lists.w3.org/Archives/Public/public-webapps/2013JulSep/0287.html">deprecated</a> towards the end of 2013, which means we simply use the JavaScript API instead, which I think offers more flexibility and less bloat on the markup:</p><div class="highlight"><pre><code data-lang="html" class="language-html"><span class="nt">&lt;template</span> <span class="na">id= </span><span class="s">"profileTemplate"</span><span class="nt">&gt;</span>  <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"profile"</span><span class="nt"> &gt;</span>    <span class="nt">&lt;img</span> <span class="na">src=</span><span class="s">""</span> <span class="na">class=</span><span class="s">"profile__img"</span><span class="nt"> &gt;</span>    <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"profile__name"</span><span class="nt">&gt;&lt;/div&gt;</span>    <span class="nt">&lt;div </span> <span class="na">class=</span><span class="s">"profile__social"</span><span class="nt">&gt;&lt;/div&gt;</span>  <span class="nt">&lt;/div&gt;</span><span class="nt">&lt;/template &gt;</span><span class="nt">&lt;script&gt;</span><span class="kd">var</span> <span class="nx">MyElementProto</span> <span class="o">=</span> <span class="nb">Object</span><span class="p">. </span><span class="nx">create</span><span class="p">(</span><span class="nx">HTMLElement</span><span class="p">.</span><span class="nx">prototype</span><span class="p">);</span><span class="nb">window</span><span class="p">.</span><span class="nx">MyElement</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx"> registerElement</span><span class="p">(</span><span class="s1">'user-profile'</span><span class="p">,</span> <span class="p">{</span>  <span class="nx">prototype</span><span class="o">: </span> <span class="nx">MyElementProto</span>  <span class="c1">// other props</span><span class="p">});</span><span class="nt">&lt;/script&gt;</span></code></pre></div><p>New elements must inherit from the <code>HTMLElement.prototype</code>. More on the above setup and callbacks etc <a href=" https://github.com/webcomponents/hello-world-element/blob/master/src/hello-world.html">here</a>, cheers <a href="//twitter.com/zenorocha">Zeno</a>.</p><h5>Extending and inheriting</h5><p> What if we wanted to extend an existing element, such as an <code>&lt;h1&gt;</code> tag? There will be many cases of this, such as riding off an existing element and creating a "special" version of it, rather than a totally new element. We introduce the <code>{ extends: '' }</code> property to declare where what element we're extending. Using an extended element is simple, drop the <code>is=""</code> attribute on an existing element and it'll inherit it's new extension. Pretty simple, I guess.</p><div class="highlight"><pre><code data-lang="html" class="language-html"><span class="nt">&lt;template&gt;</span>  // include random, funky things<span class="nt">&lt;/template&gt;</span><span class="nt">&lt;script&gt;</span><span class= "kd">var</span> <span class="nx">MyElementProto</span> <span class="o">=</span> <span class="nb">Object</span><span class="p">.</span><span class="nx">create</span><span class="p">( </span><span class="nx">HTMLElement</span><span class="p">.</span><span class="nx">prototype</span><span class="p">);</span><span class="nb">window</span><span class="p">.</span><span class="nx">MyElement</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">registerElement</span><span class="p">(</span><span class="s1" >'funky-heading'</span><span class="p">,</span> <span class="p">{</span>  <span class="nx">prototype</span><span class="o">:</span> <span class="nx">MyElementProto</span><span class="p">, </span>  <span class="kr">extends</span><span class="o">:</span> <span class="s1">'h1'</span> <span class="c1">// extends declared here</span><span class="p">});</span><span class="nt"> &lt;/script&gt;</span><span class="nt">&lt;h1</span> <span class="na">is=</span><span class="s">"funky-heading"</span><span class="nt">&gt;</span>  Page title<span class="nt">&lt;/h1&gt; </span></code></pre></div><p>Using <code>extends=""</code> as an attribute on <code>&lt;element&gt;</code> was the way to do it before it was deprecated.</p><p>So what next? Enter the shadows...</p><h4>ShadowDOM</h4><p>ShadowDOM <em>is</em> as cool as it sounds, and provides a DOM encapsulation within DOM. Whaaat? Essentially, nested document fragments, that are shadow-y... In ShadowDOM, we're observing nested DOM trees/hierarchies. Typically in web documents, there is one DOM. Think about DOM hosting DOM, which hosts more DOM. You'll see something like this in Chrome inspector (note <code>#shadow-root</code>, which is completely encapsulated DOM):</p><div class="highlight"><pre><code data-lang="html" class="language-html"> ▾<span class="nt">&lt;user-profile&gt;</span>  ▾#shadow-root (user-agent)  <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"profile"</span><span class="nt"> &gt;</span>    <span class="nt">&lt;img</span> <span class="na">src=</span><span class="s">""</span> <span class="na">class=</span><span class="s">"profile__img"</span><span class="nt"> &gt;</span>    <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"profile__name"</span><span class="nt">&gt;&lt;/div&gt;</span>    <span class="nt">&lt;div </span> <span class="na">class=</span><span class="s">"profile__social"</span><span class="nt">&gt;&lt;/div&gt;</span>  <span class="nt">&lt;/div&gt;</span> <span class="nt">&lt; /user-profile&gt;</span></code></pre></div><p>There are a few different concepts with Shadow DOM, for me, it's that there is no "global" Object, no <code>window</code>, I can create a new document root. The "host" of my this new document root is either referred to as the root or host. We can create new ShadowDOM by invoking <code>.createShadowRoot();</code> on an element. </p><p>ShadowDOM already exists in the wild today though, as soon as you use <code>&lt;input type=range&gt;</code> in the browser, we get a nice input with a slider, guess what - that's ShadowDOM! It's a nested structure that's hidden inside our DOM tree. Now we can create it ourselves, this opens up an entire plethora of opportunities.</p><h5>Why is this <em>really</em> cool?</h5><p>ShadowDOM gives us <em>true</em> encapsulation, with scoped components. CSS is <em>scoped</em> (wow, although we tried this with <code>&lt;style scoped&gt;</code> but Blink have since removed it from the core to make way for Web Components). This means any CSS we write inside ShadowDOM only affects the DOM of that particular ShadowDOM!</p><div class= "highlight"><pre><code data-lang="html" class="language-html"><span class="nt">&lt;template&gt;</span>  <span class="nt">&lt;style&gt;</span>  <span class="nd">:host</span> <span class="p" >{</span>    <span class="k">border</span><span class="o">:</span> <span class="m">1px</span> <span class="k">solid</span> <span class="nb">red</span><span class="p">;</span>  <span class= "p">}</span>  <span class="nt">&lt;/style&gt;</span>  // stuff<span class="nt">&lt;/template&gt;</span><span class="nt">&lt;script&gt;</span><span class="kd">var</span> <span class="nx"> MyElementProto</span> <span class="o">=</span> <span class="nb">Object</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="nx">HTMLElement </span><span class="p">.</span><span class="nx">prototype</span><span class="p">);</span><span class="nb">window</span><span class="p">.</span><span class="nx">MyElement</span> <span class ="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">registerElement</span><span class="p">(</span><span class="s1">'funky-heading'</span><span class="p"> ,</span> <span class="p">{</span>  <span class="nx">prototype</span><span class="o">:</span> <span class="nx">MyElementProto</span><span class="p">,</span>  <span class="kr">extends </span><span class="o">:</span> <span class="s1">'h1'</span><span class="p">});</span><span class="nt">&lt;/script&gt;</span></code></pre></div><p>This also means each document can also have a unique <code>id</code>, and we can avoid crazy naming conventions for scaling our apps/websites (a minor bonus).</p><p>We can also put scripts in there too and talk to the current element:</p><div class="highlight"><pre><code data-lang="html" class="language-html"><span class="nt">&lt;template&gt;</span>  <span class="nt">&lt;style&gt;</span>  <span class="nd">:host </span> <span class="p">{</span>    <span class="k">border</span><span class="o">:</span> <span class="m">1px</span> <span class="k">solid</span> <span class="nb">red</span><span class="p" >;</span>  <span class="p">}</span>  <span class="nt">&lt;/style&gt;</span>  // stuff<span class="nt">&lt;/template&gt;</span><span class="nt">&lt;script&gt;</span><span class="p">( </span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>  <span class="c1">// stuff with JS...</span><span class="p">})();</span><span class="kd">var </span> <span class="nx">MyElementProto</span> <span class="o">=</span> <span class="nb">Object</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="nx">HTMLElement</span><span class="p">.</span><span class="nx">prototype</span><span class="p">);</span><span class="nb">window</span><span class="p">.</span><span class="nx"> MyElement</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">registerElement</span><span class="p">(</span><span class="s1"> 'funky-heading'</span><span class="p">,</span> <span class="p">{</span>  <span class="nx">prototype</span><span class="o">:</span> <span class="nx">MyElementProto</span><span class="p">, </span>  <span class="kr">extends</span><span class="o">:</span> <span class="s1">'h1'</span><span class="p">});</span><span class="nt">&lt;/script&gt;</span></code></pre></div><p> JavaScript events that are fired, also are encapsulated to the ShadowDOM tree.</p><h5>How can I see this ShadowDOM?</h5><p>In true shadow style, you need to enable it via the <code>Show user agent ShadowDOM</code> checkbox inside Chrome Dev Tools. Upon inspecting element, you can see the nested DOM trees. Chrome also allows you to edit the CSS, which is even more awesome. </p><h4>HTML Imports</h4><p>Importing dependencies into our language of choice comes in many shapes and sizes. For CSS, we have <code>@import</code>, for JavaScript in ES6 modules we have <code>import {Module} from './somewhere';</code>, and <em>finally</em>, HTML. We can import HTML components at the top of our document to define which ones we need to use in our app: </p><div class="highlight"><pre><code data-lang="html" class="language-html"><span class="nt">&lt;link</span> <span class="na">rel=</span><span class="s">"import"</span> <span class="na"> href=</span><span class="s">"user-profile.html"</span><span class="nt">&gt;</span><span class="c">&lt;!-- </span><span class="c">  &lt;user-profile&gt; now available, ooo yeah!</span><span class="c">--&gt;</span></code></pre></div><p>This is massive! Encapsulated components all in one file. Out of the box and working. Let's take Google Maps API for example, we need to include the Maps API v3, import the 'Hello world' code and then style a basic map. Wouldn't it be great to just do this:</p><div class="highlight"><pre><code data-lang="html" class= "language-html"><span class="nt">&lt;link</span> <span class="na">rel=</span><span class="s">"import"</span> <span class="na">href=</span><span class="s">"google-map.html"</span><span class="nt">&gt;</span><span class="c">&lt;!-- boom! --&gt;</span><span class="nt">&lt;google-map&gt;&lt;/google-map&gt;</span></code></pre></div><p>All encapsulated, tested, I could just pass in values via attributes and job done:</p><div class="highlight"><pre><code data-lang="html" class="language-html"><span class="nt">&lt;google-map</span> <span class="na">coords= </span><span class="s">"37.2350, 115.8111"</span><span class="nt">&gt;&lt;/google-map&gt;</span></code></pre></div><h4>Decorators</h4><p>Decorators are part of Web Components, but actually have <em>no spec</em> (according to the <a href="http://www.w3.org/TR/components-intro/#decorator-section">spec</a>). Apparently they might look something like this, with their intention to enhance or override the presentation of an existing element. So ignore them for now, I guess <em>(see Addy's comment on Decorators, they might even disappear from Web Components entirely)</em>.</p><div class="highlight"><pre><code data-lang="html" class="language-html"><span class="nt">&lt;decorator</span> <span class="na">id=</span><span class="s"> "details-open"</span><span class="nt">&gt;</span>  <span class="nt">&lt;template&gt;</span>    <span class="nt">&lt;a</span> <span class="na">id=</span><span class="s">"summary" </span><span class="nt">&gt;</span>      <span class="ni">&amp;blacktriangledown;</span>      <span class="nt">&lt;content</span> <span class="na">select=</span><span class="s">"summary" </span><span class="nt">&gt;&lt;/content&gt;</span>    <span class="nt">&lt;/a&gt;</span>    <span class="nt">&lt;content&gt;&lt;/content&gt;</span>  <span class="nt">&lt;/template&gt; </span><span class="nt">&lt;/decorator&gt;</span></code></pre></div><h3>Can I get started now? Enter Polymer.js</h3><p>Yes. Web Components are going to be a little while before fully landing and being the next generation of the web, but they're certainly making fast traction. We can get to grips with the technology and concepts now and start building using a framework such as Polymer - which polyfills things for modern browsers to let us use Web Components now.</p><p>An example of using Polymer to define an element. Here, we simply swap out (<em>was </em>) <code>&lt;element&gt;</code> for <code>&lt;polymer-elememt&gt;</code> and that's it.</p><div class="highlight"><pre><code data-lang="html" class="language-html"><span class="nt"> &lt;polymer-element</span> <span class="na">name=</span><span class="s">"my-element"</span><span class="nt">&gt;</span>  <span class="nt">&lt;template&gt;</span>    // take it away!  <span class="nt">&lt;/template&gt;</span>  <span class="nt">&lt;script&gt;</span>    <span class="nx">Polymer</span><span class="p">(</span><span class="s1">'my-element'</span><span class="p">, </span> <span class="p">{});</span>  <span class="nt">&lt;/script&gt;</span><span class="nt">&lt;/polymer-element&gt;</span><span class="nt">&lt;my-element&gt;&lt;/my-element&gt; </span></code></pre></div><p>Polymer has some really sweet features, such as data-binding (the Angular dev inside me loves this) and a tonne of simple events built in, from new instances of the element, to creation and injection callbacks that make it really simple to creating new elements.</p><h3>Takeaways</h3><p>This post isn't meant to be a full tutorial - these components are vast and best explored individually, but I wanted to provide an eye opener on the rapidly approaching technology that is Web Components.</p><p>For me, one of the biggest selling points of Web Components is to prevent the inclusion of a huge JavaScript file, a huge CSS file and a tonne of HTML to make our website or app. In such cases, we no doubt come back to it a few months later and have forgotten what each thing does and it's painful to get back up to speed again. We don't forget what the <code>&lt;google-map&gt;</code> element does though, or the <code>&lt;fluid-vids&gt;</code> element, they're declarative and self-explanatory, we know exactly where their logic is, and where the styles are.</p><p>The biggest win? Logic is <em>contained</em>. We've all struggled managing logic, markup and styles, and now the web has listened. Encapsulated behaviour and scoping, but a very powerful engine for componentising the web, anything from a navigation to google maps to an image slider.</p><p>Benefits of Web Components are very clear, and I'm interested to see where it takes us in the next few years. This post is by far from exhaustive, but I feel we should all take a dive into what the future of the web will bring us, we'll be there sooner than you think!</p><p>Links to definitely keep an eye on (any others feel free to share below):</p><ul><li><a href="http://webcomponents.org">WebComponents.org</a></li><li><a href="http://www.polymer-project.org"> Polymer</a></li><li><a href="http://customelements.io">customelements.io</a></li><li><a href="http://html5rocks.com">HTML5 Rocks</a></li><li>Eric Bidelman, Google I/O 2013 <a href=" https://www.youtube.com/watch?v=fqULJBBEVQE">Tectonic shift for the web</a></li><li>Eric Bidelman, Google I/O 2014 <a href="https://www.youtube.com/watch?v=8OJ7ih8EE7s">Polymer and Web Components</a></li></ul>    </article>			</div>		<!--=========================			END : POST		=============================--> <!--=========================			START : POST		=============================-->		<div class="post-wrapper"><article class="post clear">      <h1 class="post__title"> Methods to determine if an Object has a given property      </h1>      <div class="post__meta">        <a href= "//github.com/toddmotto/toddmotto.github.io/blob/master/_posts/2014-06-30-methods-to-determine-if-an-object-has-a-given-property.md" class="post__meta-edit">          <i class="fa fa-github"></i>          Edit this page on GitHub        </a>        <p>          June 30, 2014        </p>      </div>      <p>There are multiple ways to detect whether an Object has a property. You'd think it'd be as easy as <code>myObject.hasOwnProperty('prop');</code> - but no, there are a few different ways with their own problems and gotchas. Let's look at the few ways to check property existence, concepts that confuse JavaScript developers, prototype chain lookups and problems JavaScript might provide us.</p><h3>Double bang !! property lookup </h3><p>We've all seen it, probably in something such as Modernizr for simple feature detection, the infamous <code>!!</code> amongst our JS. Important note before we begin this one, it doesn't actually check if an Object has a property "as such", it checks the <em>value</em> of the Object property. Which means if the property value is false, or the object property doesn't even exist, they give the same <code>falsy</code> result - which can be really bad if you use it without knowing what it does and it's limitations.</p><h4>What does it mean? </h4><p>The double-bang is a simple way to typecast something to <code>Boolean</code>. The <code>Boolean</code> will cast <code>true</code> for <em>truthy</em> values. Even things such as <code>undefined</code> and <code>null</code> (both falsy values, <code>!!null</code> is <code>false</code> when cast to <code>Boolean</code>). The <em>absolute key</em> here is that it casts <em>values</em>. I'll say it again, <em>values</em>! This is irrelevant to the shape and size of your Object. We convert truthy and falsy values to Boolean.</p><h4>Examples</h4><p> An empty <code>Array</code> is an example of a <em>truthy</em> value:</p><div class="highlight"><pre><code data-lang="javascript" class="language-javascript"><span class="kd">var</span> <span class="nx">a</span> <span class="o">=</span> <span class="p">[];</span> <span class="c1">// []</span></code></pre></div><p>What if we want to convert it to a <code>Boolean</code> though? It's truthy, so we should expect <code>true</code>:</p><div class="highlight"><pre><code data-lang="javascript" class="language-javascript"><span class="kd">var</span> <span class= "nx">a</span> <span class="o">=</span> <span class="o">!!</span><span class="p">[];</span> <span class="c1">// true</span></code></pre></div><p><code>null</code> is an example of a <em> falsy</em> value:</p><div class="highlight"><pre><code data-lang="javascript" class="language-javascript"><span class="kd">var</span> <span class="nx">a</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span> <span class="c1">// null</span></code></pre></div><p>And the expected output of <code>false</code>:</p><div class="highlight" ><pre><code data-lang="javascript" class="language-javascript"><span class="kd">var</span> <span class="nx">a</span> <span class="o">=</span> <span class="o">!!</span><span class="kc">null </span><span class="p">;</span> <span class="c1">// false</span></code></pre></div><p>This means that we can use it when looking up our Objects!</p><div class="highlight"><pre><code data-lang="javascript" class="language-javascript"><span class="kd">var</span> <span class="nx">toddObject</span> <span class="o">=</span> <span class="p">{</span>  <span class="nx">name </span><span class="o">:</span> <span class="s1">'Todd'</span><span class="p">,</span>  <span class="nx">cool</span><span class="o">:</span> <span class="kc">false</span><span class="p">}; </span><span class="o">!!</span><span class="nx">toddObject</span><span class="p">.</span><span class="nx">name</span> <span class="c1">// true (correct result as it's a truthy value) </span></code></pre></div><p>This method also looks up the Object's <code>prototype</code> chain to see if the property exists, which can cause unintended side effects if naming of properties is the same as a prototypes.</p><div class="highlight"><pre><code data-lang="javascript" class="language-javascript"><span class="c1">// Object.prototype.toString</span><span class="o">!!</span><span class="nx">toddObject</span><span class="p">.</span><span class="nx">toString</span> <span class="c1">// true</span><span class="c1">// !!Array.prototype.forEach </span><span class="o">!!</span><span class="p">[][</span><span class="s1">'forEach'</span><span class="p">]</span> <span class="c1">// true</span></code></pre></div><h4>Gotchas</h4><p> Beware of using it for detecting your own Objects. We often create Objects and defaults such as this:</p><div class="highlight"><pre><code data-lang="javascript" class= "language-javascript"><span class="kd">var</span> <span class="nx">toddObject</span> <span class="o">=</span> <span class="p">{</span>  <span class="nx">name</span><span class="o">:</span> <span class="s1">'Todd'</span><span class="p">,</span>  <span class="nx">favouriteDrink</span><span class="o">:</span> <span class="kc">null</span><span class="p">}; </span></code></pre></div><p>If we're using the double-bang to check if an Object property exists using this method, then it's definitely a silly idea:</p><div class="highlight"><pre><code data-lang="javascript" class="language-javascript"><span class="kd">var</span> <span class="nx">toddObject</span> <span class="o">=</span> <span class="p">{</span>  <span class="nx">name </span><span class="o">:</span> <span class="s1">'Todd'</span><span class="p">,</span>  <span class="nx">favouriteDrink</span><span class="o">:</span> <span class="kc">null</span><span class="p">};</span><span class="k">if</span> <span class="p">(</span><span class="o">!!</span><span class="nx">toddObject</span><span class="p">.</span><span class="nx">favouriteDrink </span><span class="p">)</span> <span class="p">{</span> <span class="c1">// false</span>  <span class="c1">// do something if it exists, I think...</span><span class="p">} </span></code></pre></div><p>That would be naive! The above code (to the new developer or non-double-banger) might say <em>"If toddObject.favouriteDrink exists, do something"</em>. But no, because (I'll say it again...) this casts <em>values</em>, the value is <code>null</code> and falsy - even though the property exists. It's generally not a good idea in this case to use it for checking if a property exists incase it has a falsy value to begin with.</p><h3>hasOwnProperty</h3><p>We went as far as getting a native method for this, but it's not 100% reliable for a few reasons. Let's examine it first.</p><h4>What does it mean?</h4><p>Using <code>myObject.hasOwnProperty('prop')</code> is a great way of accessing the Object's keys directly, which <em>does not</em> look into the Object's <code>prototype</code> - hooray, this is great for specific use cases. <code>hasOwnProperty</code> returns a Boolean for us on whether a property exists.</p><h4>Examples</h4><div class="highlight"><pre><code data-lang="javascript" class="language-javascript"><span class="kd">var</span> <span class="nx">toddObject </span> <span class="o">=</span> <span class="p">{</span>  <span class="nx">name</span><span class="o">:</span> <span class="s1">'Todd'</span><span class="p">,</span>  <span class="nx"> favouriteDrink</span><span class="o">:</span> <span class="kc">null</span><span class="p">};</span><span class="k">if</span> <span class="p">(</span><span class="nx">toddObject</span><span class="p">.</span><span class="nx">hasOwnProperty</span><span class="p">(</span><span class="s1">'favouriteDrink'</span><span class="p">))</span> <span class="p">{</span> <span class="c1" >// true</span>  <span class="c1">// do something if it exists, fo sho</span><span class="p">}</span></code></pre></div><p>But don't be sold on this exact implementation... read below for best practice.</p><h4>Gotchas</h4><p>IE messes up the <code>hasOwnProperty</code> method completely as it's painful with <code>host</code> Objects (host objects don't have the hasOwnProperty method).</p><p>JavaScript also decided not to protect the method's name, so we can infact do this:</p><div class="highlight"><pre><code data-lang="javascript" class= "language-javascript"><span class="kd">var</span> <span class="nx">toddObject</span> <span class="o">=</span> <span class="p">{</span>  <span class="nx">hasOwnProperty</span><span class= "o">:</span> <span class="s1">'hello...'</span><span class="p">};</span></code></pre></div><p>This makes it hard to fully trust it. What we can do however is access the <code> Object.prototype</code> directly to guarantee any <code>hasOwnProperty</code> calls haven't been tampered with or overridden.</p><p>Let's bulletproof the process:</p><div class="highlight" ><pre><code data-lang="javascript" class="language-javascript"><span class="kd">var</span> <span class="nx">toddObject</span> <span class="o">=</span> <span class="p">{</span>  <span class ="nx">name</span><span class="o">:</span> <span class="s1">'Todd'</span><span class="p">,</span>  <span class="nx">favouriteDrink</span><span class="o">:</span> <span class="kc">null </span><span class="p">};</span><span class="k">if</span> <span class="p">(</span><span class="nb">Object</span><span class="p">.</span><span class="nx">prototype</span><span class="p">. </span><span class="nx">hasOwnProperty</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">toddObject</span><span class="p">,</span> <span class="s1">'favouriteDrink'</span><span class="p">))</span> <span class="p">{</span> <span class="c1">// true</span>  <span class="c1">// do something if it exists, fo sho sho!</span><span class="p">}</span></code></pre></div><p>The secret sauce here is <code>.call()</code> to change the context of <code>hasOwnProperty</code> (take that, IE) and ensure we've the exact <code>hasOwnProperty</code> we want from the <code>Object.prototype</code>.</p><p>Obviously you'd want to wrap it inside a helper function or something to save writing out that <code> prototype</code> each time:</p><div class="highlight"><pre><code data-lang="javascript" class="language-javascript"><span class="kd">function</span> <span class="nx">hasProp</span> <span class="p">(</span><span class="nx">obj</span><span class="p">,</span> <span class="nx">prop</span><span class="p">)</span> <span class="p">{</span>  <span class="k">return</span> <span class="nb">Object</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">hasOwnProperty</span><span class="p">.</span><span class="nx">call </span><span class="p">(</span><span class="nx">obj</span><span class="p">,</span> <span class="nx">prop</span><span class="p">);</span><span class="p">}</span><span class="k">if</span> <span class="p">(</span><span class="nx">hasProp</span><span class="p">(</span><span class="nx">toddObject</span><span class="p">,</span> <span class="s1">'favouriteDrink'</span><span class="p">))</span> <span class="p">{}</span></code></pre></div><h3>'prop' in myObject</h3><p>The <code>in</code> operator isn't so widely used as the former methods, but is probably worth using after reading this. It also returns a <code>Boolean</code> much like <code>!!myObject</code>, but <em>does not</em> evaluate the <em>value</em>, it evaluates the <em>existence </em> of the property!. This means if a property has a value of <code>false</code>, we get a correct reading that the property does infact exist.</p><div class="highlight"><pre><code data-lang="javascript" class="language-javascript"><span class="kd">var</span> <span class="nx">toddObject</span> <span class="o">=</span> <span class="p">{</span>  <span class="nx">name </span><span class="o">:</span> <span class="s1">'Todd'</span><span class="p">,</span>  <span class="nx">favouriteDrink</span><span class="o">:</span> <span class="kc">null</span><span class="p">,</span>  <span class="nx">cool</span><span class="o">:</span> <span class="kc">false</span><span class="p">};</span><span class="s1">'cool'</span> <span class="k">in</span> <span class="nx">toddObject</span><span class="p">;</span> <span class="c1">// true</span></code></pre></div><p>The <code>in</code> operator is probably your best friend for checking the existence of a property, it's also pretty concise.</p><h4>Gotchas</h4><p>The <code>in</code> operator also looks up the <code>prototype</code>, which <em>may</em> cause unintended side effects:</p><div class="highlight"><pre><code data-lang="javascript" class="language-javascript"><span class="c1">// inherits Object.prototype.toString</span><span class="s1">'toString' </span> <span class="k">in</span> <span class="nx">toddObject</span><span class="p">;</span> <span class="c1">// true</span></code></pre></div><p>But we should know these property names and not create conflicts, right ;)</p><h3>typeof</h3><p>We can use <code>typeof</code> as well.</p><h4>What does it mean?</h4><p>The standard <code>typeof</code> operator returns a <code> String</code> (<a href="http://toddmotto.com/understanding-javascript-types-and-reliable-type-checking">not a very reliable one</a>), and we can evaluate it against something, such as <code>!== 'undefined'</code> - which indicates it exists.</p><div class="highlight"><pre><code data-lang="javascript" class="language-javascript"><span class="k">if</span> <span class="p"> (</span><span class="k">typeof</span> <span class="nx">toddObject</span><span class="p">.</span><span class="nx">name</span> <span class="o">!==</span> <span class="s1">'undefined' </span><span class="p">)</span> <span class="p">{</span>  <span class="c1">// do something</span><span class="p">}</span></code></pre></div><p>It looks a little ugly, as well as being quite long to write out if we were to make multiple checks using this method. Also, <code>null</code> would fall under this check unless using <code>!= 'undefined'</code> (single <code>= </code>) as <code>null == undefined</code> anyway.</p><h4>Gotchas</h4><p>Only use it <a href="http://toddmotto.com/understanding-javascript-types-and-reliable-type-checking">if you know what you're doing</a> as it's very unreliable for standard type checking.</p><h3>Feature detection</h3><p>I can't recall exactly what was said, but someone (I think) once told me that some  vendor once implemented a feature with a falsy value if it didn't exist (though I'm not even certain that's true, worth a mention though)... and as such the <code>in</code> operator is best for these such cases:</p><div class="highlight"><pre><code data-lang="javascript" class="language-javascript"><span class="c1">// just an example, not the one somebody mentioned... </span><span class="k">if</span> <span class="p">(</span><span class="s1">'draggable'</span> <span class="k">in</span> <span class="nb">document</span><span class="p">.</span><span class= "nx">createElement</span><span class="p">(</span><span class="s1">'div'</span><span class="p">))</span> <span class="p">{</span>  <span class="c1">// do something if prop exists </span><span class="p">}</span></code></pre></div>    </article>			</div>		<!--=========================			END : POST		=============================--> <!--=========================			START : POST		=============================-->		<div class="post-wrapper">		<article class="post clear">      <h1 class= "post__title">        What (function (window, document, undefined) {})(window, document); really means      </h1>      <div class="post__meta">        <a href= "//github.com/toddmotto/toddmotto.github.io/blob/master/_posts/2014-06-03-what-function-window-document-undefined-iife-really-means.md" class="post__meta-edit">          <i class="fa fa-github"></i>          Edit this page on GitHub        </a>        <p>          June 03, 2014        </p>      </div>      <p>Interestingly enough I get asked about the IIFE (immediately-invoked function expression) a lot, which takes the following setup:</p><div class="highlight"><pre><code data-lang="javascript" class="language-javascript"><span class="p">( </span><span class="kd">function</span> <span class="p">(</span><span class="nb">window</span><span class="p">,</span> <span class="nb">document</span><span class="p">,</span> <span class= "kc">undefined</span><span class="p">)</span> <span class="p">{</span>  <span class="c1">// </span><span class="p">})(</span><span class="nb">window</span><span class="p">,</span> <span class="nb">document</span><span class="p">);</span></code></pre></div><p>So why not write a post about it? ;-)</p><p>First, this does a series of different things. From the top:</p><h3> Scope</h3><p>JavaScript has <code>function</code> scope, so first this creates some much needed "private scope". For example:</p><div class="highlight"><pre><code data-lang="javascript" class="language-javascript"><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nb">window</span><span class="p">,</span> <span class="nb"> document</span><span class="p">,</span> <span class="kc">undefined</span><span class="p">)</span> <span class="p">{</span>  <span class="kd">var</span> <span class="nx">name</span> <span class="o">=</span> <span class="s1">'Todd'</span><span class="p">;</span><span class="p">})(</span><span class="nb">window</span><span class="p">,</span> <span class="nb">document </span><span class="p">);</span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">name</span><span class="p">); </span> <span class="c1">// name is not defined, it's in a different scope</span></code></pre></div><p>Simple.</p><h3>How it works</h3><p>A normal function looks like this:</p><div class= "highlight"><pre><code data-lang="javascript" class="language-javascript"><span class="kd">var</span> <span class="nx">logMyName</span> <span class="o">=</span> <span class="kd">function </span> <span class="p">(</span><span class="nx">name</span><span class="p">)</span> <span class="p">{</span>  <span class="nx">console</span><span class="p">.</span><span class="nx">log </span><span class="p">(</span><span class="nx">name</span><span class="p">);</span><span class="p">};</span><span class="nx">logMyName</span><span class="p">(</span><span class="s1"> 'Todd'</span><span class="p">);</span></code></pre></div><p>We get to <em>invoke</em> it by choice, and wherever we want/can scope providing.</p><p>The reason "IIFE" was coined was because they're immediately-invoked function expressions. Which means they're immediately called at runtime - also we can't call them again they run just once like this:</p><div class= "highlight"><pre><code data-lang="javascript" class="language-javascript"><span class="kd">var</span> <span class="nx">logMyName</span> <span class="o">=</span> <span class="p">( </span><span class="kd">function</span> <span class="p">(</span><span class="nx">name</span><span class="p">)</span> <span class="p">{</span>  <span class="nx">console</span><span class= "p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">name</span><span class="p">);</span> <span class="c1">// Todd</span><span class="p">})(</span><span class= "s1">'Todd'</span><span class="p">);</span></code></pre></div><p>The secret sauce here is this, (which I've assigned to a variable in the previous example):</p><div class="highlight" ><pre><code data-lang="javascript" class="language-javascript"><span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span><span class="p"> })();</span></code></pre></div><p>The extra pair of parentheses <em>is</em> necessary as this doesn't work:</p><div class="highlight"><pre><code data-lang="javascript" class= "language-javascript"><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span><span class="p">}();</span></code></pre></div><p>Though several tricks can be done to trick JavaScript into "making it work". These force the JavaScript parser to treat the code following the <code>!</code> character as an expression:</p><div class="highlight"><pre><code data-lang="javascript" class="language-javascript"><span class="o">!</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span><span class="p">}(); </span></code></pre></div><p>There are also other variants:</p><div class="highlight"><pre><code data-lang="javascript" class="language-javascript"><span class="o">+</span><span class="kd" >function</span> <span class="p">()</span> <span class="p">{</span><span class="p">}();</span><span class="o">-</span><span class="kd">function</span> <span class="p">()</span> <span class ="p">{</span><span class="p">}();</span><span class="o">~</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span><span class="p">}(); </span></code></pre></div><p>But I wouldn't use them.</p><h3>Arguments</h3><p>Now we know how it works, we can pass in arguments to our IIFE:</p><div class="highlight"><pre><code data-lang ="javascript" class="language-javascript"><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nb">window</span><span class="p">)</span> <span class="p">{</span><span class="p">})(</span><span class="nb">window</span><span class="p">);</span></code></pre></div><p>How does this work? Remember, the closing <code>(window);</code> is where the function is invoked, and we're passing in the <code>window</code> Object. This then gets passed into the function, which I've named <code>window</code> also. You could argue this is pointless as we should name it something different - but for now we'll use <code>window</code> as well.</p><p>So what else can we do? Pass in all the things! Let's pass in the <code>document</code> Object:</p><div class="highlight"><pre><code data-lang="javascript" class="language-javascript"><span class="p">(</span><span class="kd">function</span> <span class= "p">(</span><span class="nb">window</span><span class="p">,</span> <span class="nb">document</span><span class="p">)</span> <span class="p">{</span>  <span class="c1">// we refer to window and document normally</span><span class="p">})(</span><span class="nb">window</span><span class="p">,</span> <span class="nb">document</span><span class="p">); </span></code></pre></div><p>Local variables are faster to resolve than the global variables, but this is on a huge scale and you'll never notice the speed increase - but also worth considering if we're referencing our globals a lot!</p><h3>What about <code>undefined</code>?</h3><p>In ECMAScript 3, <code>undefined</code> is mutable. Which means it's value could be reassigned, something like <code>undefined = true;</code> for instance, oh my! Thankfully in ECMASCript 5 strict mode (<code>'use strict';</code>) the parser will throw an error telling you you're an idiot. Before this, we started protecting our IIFE's by doing this:</p><div class="highlight"><pre><code data-lang="javascript" class="language-javascript"><span class="p">( </span><span class="kd">function</span> <span class="p">(</span><span class="nb">window</span><span class="p">,</span> <span class="nb">document</span><span class="p">,</span> <span class= "kc">undefined</span><span class="p">)</span> <span class="p">{</span><span class="p">})(</span><span class="nb">window</span><span class="p">,</span> <span class="nb">document</span><span class="p">);</span></code></pre></div><p>Which means if someone came along and did this, we'd be okay:</p><div class="highlight"><pre><code data-lang="javascript" class= "language-javascript"><span class="kc">undefined</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span><span class="p">(</span><span class="kd">function </span> <span class="p">(</span><span class="nb">window</span><span class="p">,</span> <span class="nb">document</span><span class="p">,</span> <span class="kc">undefined</span><span class ="p">)</span> <span class="p">{</span>  <span class="c1">// undefined is a local undefined variable</span><span class="p">})(</span><span class="nb">window</span><span class="p">,</span> <span class="nb">document</span><span class="p">);</span></code></pre></div><h3>Minifying</h3><p>Minifying your local variables is where the IIFE pattern's awesomeness really kicks in. Local variable names aren't really needed if they're passed in, so we can call them what we like.</p><p>Changing this:</p><div class="highlight"><pre><code data-lang="javascript" class= "language-javascript"><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nb">window</span><span class="p">,</span> <span class="nb">document </span><span class="p">,</span> <span class="kc">undefined</span><span class="p">)</span> <span class="p">{</span>  <span class="nx">console</span><span class="p">.</span><span class="nx"> log</span><span class="p">(</span><span class="nb">window</span><span class="p">);</span> <span class="c1">// Object window</span><span class="p">})(</span><span class="nb">window </span><span class="p">,</span> <span class="nb">document</span><span class="p">);</span></code></pre></div><p>To this:</p><div class="highlight"><pre><code data-lang="javascript" class= "language-javascript"><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">a</span><span class="p">,</span> <span class="nx">b</span><span class="p">,</span> <span class="nx">c</span><span class="p">)</span> <span class="p">{</span>  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class ="p">(</span><span class="nx">a</span><span class="p">);</span> <span class="c1">// Object window</span><span class="p">})(</span><span class="nb">window</span><span class="p">,</span> <span class="nb">document</span><span class="p">);</span></code></pre></div><p>Imagine it, all your references to libraries and <code>window</code> and <code>document</code> nicely minified. Of course you don't need to stop there, we can pass in jQuery too or whatever is available in the lexical scope:</p><div class="highlight"><pre><code data-lang="javascript" class ="language-javascript"><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">$</span><span class="p">,</span> <span class="nb">window </span><span class="p">,</span> <span class="nb">document</span><span class="p">,</span> <span class="kc">undefined</span><span class="p">)</span> <span class="p">{</span>  <span class= "c1">// use $ to refer to jQuery</span>  <span class="c1">// $(document).addClass('test');</span><span class="p">})(</span><span class="nx">jQuery</span><span class="p">,</span> <span class="nb">window</span><span class="p">,</span> <span class="nb">document</span><span class="p">);</span><span class="p">(</span><span class="kd">function</span> <span class="p">( </span><span class="nx">a</span><span class="p">,</span> <span class="nx">b</span><span class="p">,</span> <span class="nx">c</span><span class="p">,</span> <span class="nx">d</span><span class="p">)</span> <span class="p">{</span>  <span class="c1">// becomes</span>  <span class="c1">// a(c).addClass('test');</span><span class="p">})(</span><span class="nx">jQuery </span><span class="p">,</span> <span class="nb">window</span><span class="p">,</span> <span class="nb">document</span><span class="p">);</span></code></pre></div><p>This also means you don't need to call <code>jQuery.noConflict();</code> or anything as <code>$</code> is assigned locally to the module. Learning how scopes and global/local variables work will help you even further.</p><p>A good minifier will make sure to rename <code>undefined</code> to <code>c</code> (for example, and only if used) throughout your script too. Important to note, <em> the name undefined is irrelevant</em>. We just need to know that the referencing Object is undefined, as <code>undefined</code> has no special meaning - <code>undefined</code> is the value javascript gives to things that are declared but have no value.</p><h3>Non-browser global environments</h3><p>Due to things such as Node.js, the browser isn't always the global Object which can be a pain if you're trying to create IIFE's that work across multiple environments. For this reason, I tend to stick with this as a base:</p><div class="highlight" ><pre><code data-lang="javascript" class="language-javascript"><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">root</span><span class="p"> )</span> <span class="p">{</span><span class="p">})(</span><span class="k">this</span><span class="p">);</span></code></pre></div><p>In a browser, the global environment <code>this</code> refers to the <code>window</code> Object, so we don't need to pass in <code>window</code> at all, we could always shorten it to <code>this</code>.</p><p>I prefer the name <code>root</code> as it can refer to non-browser environments as well as the root of the browser.</p><p>If you're interested in a universal solution (which I use all the time nowadays when creating open source project modules) is the UMD wrapper:</p><div class="highlight"><pre><code data-lang="javascript" class="language-javascript"><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">root</span><span class="p">,</span> <span class="nx">factory</span><span class="p">)</span> <span class="p">{</span>  <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">define</span> <span class="o">===</span> <span class="s1">'function'</span> <span class="o">&amp;&amp;</span> <span class="nx">define</span><span class="p">.</span><span class="nx">amd</span><span class="p">)</span> <span class="p">{</span>    <span class="nx">define</span><span class="p">(</span><span class="nx">factory</span><span class="p">);</span>  <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">exports</span> <span class="o">===</span> <span class="s1">'object'</span><span class="p">)</span> <span class="p">{</span>    <span class="nx">module</span><span class= "p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="nx">factory</span><span class="p">;</span>  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>    <span class="nx">root</span><span class="p">.</span><span class="nx">MYMODULE</span> <span class="o">=</span> <span class="nx">factory</span><span class="p">(); </span>  <span class="p">}</span><span class="p">})(</span><span class="k">this</span><span class="p">,</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{ </span>  <span class="c1">// </span><span class="p">});</span></code></pre></div><p>This is some sexy stuff. The function is being invoked with another function passed into it. We can then assign it to the relevant environment inside. In the browser, <code>root.MYMODULE = factory();</code> is our IIFE module, elsewhere (such as Node.js) it'll use <code>module.exports </code> or requireJS if <code>typeof define === 'function' &amp;&amp; define.amd</code> resolves true.</p><p>But this stuff is another story, but I insist you check out the <a href=" https://github.com/umdjs/umd">UMD repo</a>.</p>    </article>			</div>		<!--=========================			END : POST		=============================--> <!--=========================			START : POST		=============================-->		<div class="post-wrapper">		<h1>A re-introduction to JavaScript (JS tutorial)</h1> <article id="wikiArticle">                                                      <div><section id="Quick_Links" class="Quick_links"><!-- --></section></div><h2 id="Introduction"> Introduction</h2><p>Why a re-introduction? Because <a href="/en-US/docs/Glossary/JavaScript" class="glossaryLink" title="JavaScript: JavaScript (JS) is a programming language mostly used client-side to dynamically script webpages, but often also server-side.">JavaScript</a> is notorious for being <a href="http://javascript.crockford.com/javascript.html" class="external external-icon">the world's most misunderstood programming language</a>. While it is often derided as a toy, beneath its deceptive simplicity lie some powerful language features. JavaScript &nbsp;is now used by an incredible number of high-profile applications, showing that deeper knowledge of this technology is an important skill for any web or mobile developer.</p><p>It's useful to start with an overview&nbsp;of the language's history. JavaScript was created in 1995 by Brendan Eich, an engineer at Netscape, and first released with Netscape 2 early in 1996. (It was originally going to be called LiveScript, but was renamed in an ill-fated marketing decision in an attempt to capitalize on the popularity of Sun Microsystem's Java language - despite the two having very little in common. This has been a source of confusion ever since.)</p><p>Several months later, Microsoft released JScript, a mostly-compatible JavaScript work-alike, with&nbsp;Internet Explorer 3.&nbsp;Several months after that, Netscape submitted JavaScript&nbsp;to <a href="http://www.ecma-international.org/" class="external external-icon" >Ecma International</a>, a European standards organization, which resulted in the first edition of the <a href="/en-US/docs/Glossary/ECMAScript" class="glossaryLink" title="The definition of that term (ECMAScript) has not been written yet; please consider contributing it!">ECMAScript</a> standard that year. The standard received a significant update as <a href=" http://www.ecma-international.org/publications/standards/Ecma-262.htm" class="external external-icon">ECMAScript edition 3</a> in 1999, and has stayed pretty much stable ever since. The fourth edition was abandoned, due to political differences concerning language complexity. Many parts of the fourth edition formed the basis for&nbsp;ECMAScript edition 5, published in December of 2009, and for the 6th major edition of the standard, published in June of 2015.</p><div class="note"><p><strong>Note</strong>: For familiarity, we will refer to ECMAScript as "JavaScript" from this point on.</p></div><p>Unlike most programming languages, the JavaScript language has no concept of input or output. It is designed to run as a scripting language in a host environment, and it is up to the host environment to provide mechanisms for communicating with the outside world. The most common host environment is the browser, but JavaScript interpreters can also be found in a huge list of other places, including&nbsp;Adobe Acrobat, Adobe Photoshop, SVG images, Yahoo's Widget engine, server-side environments such as <a href=" http://nodejs.org/" class="external external-icon" title="nodejs.org">Node.js</a>, NoSQL databases&nbsp;like the open source <a href="http://couchdb.apache.org/" class="external external-icon">Apache CouchDB</a>, embedded computers, complete desktop environments like <a href="http://www.gnome.org/" class="external external-icon">GNOME</a> (one of the most popular GUIs for GNU/Linux operating systems), and others.</p><h2 id="Overview">Overview</h2><p>JavaScript is an object-oriented dynamic language&nbsp;with&nbsp;types and operators, standard built-in objects, and methods. Its syntax is based on the Java and C languages - so many structures from those languages apply to JavaScript as well. One of the key differences is that JavaScript does not have classes; instead, the class functionality is accomplished by object prototypes. The other main difference is that functions are objects, giving functions the capacity to hold executable code and be passed around like any other object.</p><p>Let's start off by looking at the building blocks of any language: the types. JavaScript programs manipulate values, and those values all belong to a type. JavaScript's types are:</p><ul> <li><a href="/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number" title="The Number JavaScript object is a wrapper object allowing you to work with numerical values. A Number object is created using the Number() constructor."><code>Number</code></a></li> <li><a href= "/en-US/docs/Web/JavaScript/Reference/Global_Objects/String" title="The String global object is a constructor for strings, or a sequence of characters."><code>String</code></a></li> <li><a href="/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean" title="The Boolean object is an object wrapper for a boolean value."><code>Boolean</code></a></li> <li><a href= "/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function" title="The Function constructor creates a new Function object. In JavaScript every function is actually a Function object." ><code>Function</code></a></li> <li><a href="/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object" title="The Object constructor creates an object wrapper."><code>Object </code></a></li> <li><a href="/en-US/docs/Web/JavaScript/Reference/Global_Objects/Symbol" title="A symbol is a unique and immutable data type and may be used as an identifier for object properties. The symbol object is an implicit object wrapper for the symbol primitive data type."><code>Symbol</code></a> (new in Edition 6)</li></ul><p>... oh, and <a href= "/en-US/docs/Web/JavaScript/Reference/Global_Objects/undefined" title="The global undefined property represents the primitive value undefined. It is one of JavaScript's primitive types." ><code>undefined</code></a> and <a href="/en-US/docs/Web/JavaScript/Reference/Global_Objects/null" title="The value null is a JavaScript literal representing null or an &quot;empty&quot; value, i.e. no object value is present. It is one of JavaScript's primitive values."><code>null</code></a>, which are ... slightly odd. And <a href= "/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array" title="The JavaScript Array&nbsp;object is a global object that&nbsp;is used in the&nbsp;construction&nbsp;of&nbsp;arrays; which are high-level, list-like objects."><code>Array</code></a>, which is a special kind of object. And <a href="/en-US/docs/Web/JavaScript/Reference/Global_Objects/Date" title="Creates a JavaScript Date instance that represents a single moment in time. Date objects are based on a time value that is the number of milliseconds since 1 January, 1970 UTC."><code>Date </code></a> and <a href="/en-US/docs/Web/JavaScript/Reference/Global_Objects/RegExp" title="The RegExp constructor creates a regular expression object for matching text with a pattern." ><code>RegExp</code></a>, which are objects that you get for free. And to be technically accurate, functions are just a special type of object. So the type diagram looks more like this: </p><ul> <li><a href="/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number" title="The Number JavaScript object is a wrapper object allowing you to work with numerical values. A Number object is created using the Number() constructor."><code>Number</code></a></li> <li><a href="/en-US/docs/Web/JavaScript/Reference/Global_Objects/String" title="The String global object is a constructor for strings, or a sequence of characters."><code>String</code></a></li> <li><a href="/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean" title="The Boolean object is an object wrapper for a boolean value."><code>Boolean</code></a></li> <li><a href="/en-US/docs/Web/JavaScript/Reference/Global_Objects/Symbol" title="A symbol is a unique and immutable data type and may be used as an identifier for object properties. The symbol object is an implicit object wrapper for the symbol primitive data type."><code>Symbol </code></a> (new in Edition 6)</li> <li><a href="/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object" title="The Object constructor creates an object wrapper."><code>Object </code></a>  <ul>   <li><a href="/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function" title="The Function constructor creates a new Function object. In JavaScript every function is actually a Function object."><code>Function</code></a></li>   <li><a href="/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array" title="The JavaScript Array&nbsp;object is a global object that&nbsp;is used in the&nbsp;construction&nbsp;of&nbsp;arrays; which are high-level, list-like objects."><code>Array</code></a></li>   <li><a href= "/en-US/docs/Web/JavaScript/Reference/Global_Objects/Date" title="Creates a JavaScript Date instance that represents a single moment in time. Date objects are based on a time value that is the number of milliseconds since 1 January, 1970 UTC."><code>Date</code></a></li>   <li><a href="/en-US/docs/Web/JavaScript/Reference/Global_Objects/RegExp" title="The RegExp constructor creates a regular expression object for matching text with a pattern."><code>RegExp</code></a></li>  </ul> </li> <li><a href= "/en-US/docs/Web/JavaScript/Reference/Global_Objects/null" title="The value null is a JavaScript literal representing null or an &quot;empty&quot; value, i.e. no object value is present. It is one of JavaScript's primitive values."><code>null</code></a></li> <li><a href="/en-US/docs/Web/JavaScript/Reference/Global_Objects/undefined" title="The global undefined property represents the primitive value undefined. It is one of JavaScript's primitive types."><code>undefined</code></a></li></ul><p>And there are some built-in <a href= "/en-US/docs/Web/JavaScript/Reference/Global_Objects/Error" title="The Error constructor creates an error object. Instances of Error objects are thrown when runtime errors occur. The Error object can also be used as a base objects for user-defined exceptions. See below for standard built-in error types."><code>Error</code></a> types as well. Things are a lot easier if we stick with the first diagram, however, so we'll discuss the types listed there for now.</p><h2 id="Numbers">Numbers</h2><p>Numbers in JavaScript are "double-precision 64-bit format IEEE 754 values", according to the spec. This has some interesting consequences. There's no such thing as an integer in JavaScript, so you have to be a little careful with your arithmetic if you're used to math in C or Java. Watch out for stuff like:</p><pre class="brush: js  language-js" data-number=""><code class=" language-js"><span class="token number">0.1</span> <span class="token operator">+</span> <span class="token number">0.2</span> <span class="token operator">==</span> <span class="token number">0.30000000000000004</span><div class="line-number" data-start="1" style="top: 0px;"></div></code></pre><p>In practice, integer values are treated as 32-bit ints (and are stored that way in some browser implementations), which can be important for bit-wise operations.</p><p>The standard <a href="/en-US/docs/Web/JavaScript/Reference/Operators#Arithmetic_operators">arithmetic operators</a> are supported, including addition, subtraction, modulus (or remainder) arithmetic and so forth. There's also a built-in object that we forgot to mention earlier called <a href= "/en-US/docs/Web/JavaScript/Reference/Global_Objects/Math" title="Math is a built-in object that has properties and methods for mathematical constants and functions. Not a function object."><code>Math</code></a> that provides advanced mathematical functions and constants:</p><pre class="brush: js  language-js" data-number=""><code class=" language-js">Math<span class ="token punctuation">.</span><span class="token function">sin<span class="token punctuation">(</span></span><span class="token number">3.5</span><span class="token punctuation">) </span><span class="token punctuation">;</span><span class="token keyword">var</span> circumference <span class="token operator">=</span> Math<span class="token punctuation">.</span>PI <span class="token operator">*</span> <span class="token punctuation">(</span>r <span class="token operator">+</span> r<span class="token punctuation">)</span><span class="token punctuation">;</span><div class="line-number" data-start="1" style="top: 0px;"></div><div class="line-number" data-start="2" style="top: 19px;"></div></code></pre><p>You can convert a string to an integer using the built-in <a href="/en-US/docs/Web/JavaScript/Reference/Global_Objects/parseInt" title="The parseInt() function parses a string argument and returns an integer of the specified radix (the base in mathematical numeral systems)."><code>parseInt()</code></a> function. This takes the base for the conversion as an optional second argument, which you should always provide:</p><pre class="brush: js  language-js" data-number=""><code class=" language-js"><span class="token function">parseInt<span class="token punctuation">( </span></span><span class="token string">"123"</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class= "token punctuation">;</span><span class="token comment" spellcheck="true"> // 123</span><span class="token function">parseInt<span class="token punctuation">(</span></span><span class= "token string">"010"</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">; </span><span class="token comment" spellcheck="true"> // 10</span><div class="line-number" data-start="1" style="top: 0px;"></div><div class="line-number" data-start="2" style="top: 19px;" ></div></code></pre><p>If you don't provide the base, you can get surprising results in older browsers (pre-2013):</p><pre class="brush: js  language-js" data-number=""><code class=" language-js"><span class="token function">parseInt<span class="token punctuation">(</span></span><span class="token string">"010"</span><span class="token punctuation">)</span><span class= "token punctuation">;</span><span class="token comment" spellcheck="true"> // 8</span><div class="line-number" data-start="1" style="top: 0px;"></div></code></pre><p>That happened because the <a href="/en-US/docs/Web/JavaScript/Reference/Global_Objects/parseInt" title="The parseInt() function parses a string argument and returns an integer of the specified radix (the base in mathematical numeral systems)."><code>parseInt()</code></a> function decided to treat the string as octal due to the leading 0.</p><p>If you want to convert a binary number to an integer, just change the base:</p><pre class="brush: js  language-js" data-number=""><code class=" language-js"><span class="token function">parseInt<span class="token punctuation">( </span></span><span class="token string">"11"</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true"> // 3</span><div class="line-number" data-start="1" style="top: 0px;"></div></code></pre><p>Similarly, you can parse floating point numbers using the built-in <a href="/en-US/docs/Web/JavaScript/Reference/Global_Objects/parseFloat" title="The parseFloat() function parses a string argument and returns a floating point number."><code>parseFloat()</code></a> function, which unlike its <a href="/en-US/docs/Web/JavaScript/Reference/Global_Objects/parseInt" title="The parseInt() function parses a string argument and returns an integer of the specified radix (the base in mathematical numeral systems)."><code>parseInt()</code></a> cousin always uses base 10.</p><p>You can also use the unary <code>+</code> operator to convert values to numbers:</p><pre class="brush: js  language-js" data-number=""><code class=" language-js"><span class="token operator">+ </span> <span class="token string">"42"</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true"> // 42</span><div class="line-number" data-start="1" style="top: 0px;"></div></code></pre><p>A special value called <a href="/en-US/docs/Web/JavaScript/Reference/Global_Objects/NaN" title="The global NaN property is a value representing Not-A-Number."><code>NaN</code></a> (short for "Not a Number") is returned if the string is non-numeric:</p><pre class="brush: js  language-js" data-number=""><code class=" language-js" ><span class="token function">parseInt<span class="token punctuation">(</span></span><span class="token string">"hello"</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true"> // NaN</span><div class="line-number" data-start="1" style="top: 0px;"></div></code></pre><p><code>NaN</code> is toxic: if you provide it as an input to any mathematical operation the result will also be <code>NaN</code>: </p><pre class="brush: js  language-js" data-number=""><code class=" language-js"><span class="token number">NaN</span> <span class="token operator">+</span> <span class="token number">5 </span><span class="token punctuation">;</span><span class="token comment" spellcheck="true"> // NaN</span><div class="line-number" data-start="1" style="top: 0px;"></div></code></pre><p> You can test for <code>NaN</code> using the built-in <a href="/en-US/docs/Web/JavaScript/Reference/Global_Objects/isNaN" title="The isNaN() function determines whether a value is NaN or not. Note: coercion inside the isNaN function has interesting rules; you may alternatively want to use Number.isNaN(), as defined in ECMAScript 6, or you can use typeof to determine if the value is Not-A-Number."><code>isNaN()</code></a> function:</p><pre class="brush: js  language-js" data-number=""><code class=" language-js"><span class="token function">isNaN<span class="token punctuation">(</span></span><span class="token number">NaN</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true"> // true</span><div class="line-number" data-start="1" style="top: 0px;"></div></code></pre><p>JavaScript also has the special values <a href= "/en-US/docs/Web/JavaScript/Reference/Global_Objects/Infinity" title="The global Infinity property is a numeric value representing infinity."><code>Infinity</code></a> and <code>-Infinity </code>:</p><pre class="brush: js  language-js" data-number=""><code class=" language-js"><span class="token number">1</span> <span class="token operator">/</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true"> //  Infinity</span><span class="token operator">-</span><span class="token number">1 </span> <span class="token operator">/</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true"> // -Infinity </span><div class="line-number" data-start="1" style="top: 0px;"></div><div class="line-number" data-start="2" style="top: 19px;"></div></code></pre><p>You can test for <code>Infinity </code>, <code>-Infinity</code> and <code>NaN</code> values using the built-in <a href="/en-US/docs/Web/JavaScript/Reference/Global_Objects/isFinite" title="The global isFinite() function determines whether the passed value is a finite number. If needed, the parameter is first converted to a number."><code>isFinite()</code></a> function:</p><pre class="brush: js language-js" data-number=""><code class=" language-js"><span class="token function">isFinite<span class="token punctuation">(</span></span><span class="token number">1</span><span class= "token operator">/</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true"> // false</span><span class="token function">isFinite<span class="token punctuation">(</span></span><span class="token operator">-</span><span class="token number">Infinity</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true"> // false</span><span class="token function">isFinite<span class= "token punctuation">(</span></span><span class="token number">NaN</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true"> // false</span><div class="line-number" data-start="1" style="top: 0px;"></div><div class="line-number" data-start="2" style="top: 19px;"></div><div class="line-number" data-start="3" style="top: 38px;"></div></code></pre><div class="note"><strong>Note:</strong> The <a href="/en-US/docs/Web/JavaScript/Reference/Global_Objects/parseInt" title="The parseInt() function parses a string argument and returns an integer of the specified radix (the base in mathematical numeral systems)."><code>parseInt()</code></a> and <a href= "/en-US/docs/Web/JavaScript/Reference/Global_Objects/parseFloat" title="The parseFloat() function parses a string argument and returns a floating point number."><code>parseFloat() </code></a> functions parse a string until they reach a character that isn't valid for the specified number format, then return the number parsed up to that point. However the "+" operator simply converts the string to <code>NaN</code> if there is an invalid character contained within it. Just try parsing the string "10.2abc" with each method by yourself in the console and you'll understand the differences better.</div><h2 id="Strings">Strings</h2><p>Strings in JavaScript are sequences of characters. More accurately, they are sequences of <a href ="/en-US/docs/Web/JavaScript/Guide/Values,_variables,_and_literals#Unicode">Unicode characters</a>, with each character represented by a 16-bit number. This should be welcome news to anyone who has had to deal with internationalization.</p><p>If you want to represent a single character, you just use a string of length 1.</p><p>To find the length of a string, access its <code><a href="/en-US/docs/Web/JavaScript/Reference/Global_Objects/String/length">length</a></code> property:</p><pre class="brush: js  language-js" data-number=""><code class=" language-js"><span class="token string">"hello"</span><span class="token punctuation">.</span>length<span class="token punctuation">;</span><span class="token comment" spellcheck="true"> // 5</span><div class="line-number" data-start="1" style="top: 0px;"></div></code></pre><p>There's our first brush with JavaScript objects! Did we mention that you can use strings like <a href="/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object" title="The Object constructor creates an object wrapper.">objects</a> too? They have <a href= "/en-US/docs/Web/JavaScript/Reference/Global_Objects/String#Methods" title="The String global object is a constructor for strings, or a sequence of characters.">methods</a> as well that allow you to manipulate the string and access information about the string:</p><pre class="brush: js  language-js" data-number=""><code class=" language-js"><span class="token string"> "hello"</span><span class="token punctuation">.</span><span class="token function">charAt<span class="token punctuation">(</span></span><span class="token number">0</span><span class= "token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true"> // "h"</span><span class="token string">"hello, world"</span><span class= "token punctuation">.</span><span class="token function">replace<span class="token punctuation">(</span></span><span class="token string">"hello"</span><span class="token punctuation">, </span> <span class="token string">"goodbye"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true"> // "goodbye, world"</span><span class="token string">"hello"</span><span class="token punctuation">.</span><span class="token function">toUpperCase<span class="token punctuation">( </span></span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true"> // "HELLO"</span><div class="line-number" data-start="1" style="top: 0px;"></div><div class="line-number" data-start="2" style="top: 19px;"></div><div class="line-number" data-start="3" style="top: 38px;"></div></code></pre><h2 id ="Other_types">Other types</h2><p>JavaScript distinguishes between <a href="/en-US/docs/Web/JavaScript/Reference/Global_Objects/null" title="The value null is a JavaScript literal representing null or an &quot;empty&quot; value, i.e. no object value is present. It is one of JavaScript's primitive values."><code>null</code></a>, which is a value that indicates a deliberate non-value (and is only accessible through the <code>null</code> keyword), and <a href="/en-US/docs/Web/JavaScript/Reference/Global_Objects/undefined" title="The global undefined property represents the primitive value undefined. It is one of JavaScript's primitive types."><code>undefined</code></a>, which is a value of type <code>undefined</code> that indicates an uninitialized value - that is, a value hasn't even been assigned yet. We'll talk about variables later, but in JavaScript it is possible to declare a variable without assigning a value to it. If you do this, the variable's type is <code>undefined</code>. <code>undefined</code> is actually a constant.</p><p>JavaScript has a boolean type, with possible values <code>true</code> and <code>false</code> (both of which are keywords.) Any value can be converted to a boolean according to the following rules:</p><ol> <li><code>false</code>, <code>0</code>, empty strings (<code>""</code>), <code>NaN</code>, <code>null</code>, and <code>undefined</code> all become <code>false.</code></li> <li>All other values become <code>true. </code></li></ol><p>You can perform this conversion explicitly using the <code>Boolean()</code> function:</p><pre class="brush: js  language-js" data-number=""><code class=" language-js" ><span class="token function">Boolean<span class="token punctuation">(</span></span><span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true"> // false</span><span class="token function">Boolean<span class="token punctuation">(</span></span><span class="token number">234</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true"> // true</span><div class="line-number" data-start="1" style="top: 0px;"></div><div class="line-number" data-start="2" style="top: 19px;"></div></code></pre><p>However, this is rarely necessary, as JavaScript will silently perform this conversion when it expects a boolean, such as in an <code>if</code> statement (see below.) For this reason, we sometimes speak simply of "true values" and "false values," meaning values that become <code>true</code> and <code>false</code>, respectively, when converted to booleans. Alternatively, such values can be called "truthy" and "falsy", respectively. </p><p>Boolean operations such as <code>&amp;&amp;</code> (logical <em>and</em>), <code>||</code> (logical <em>or</em>), and <code>!</code> (logical <em>not</em>) are supported; see below. </p><h2 id="Variables">Variables</h2><p>New variables in JavaScript are declared using the <code><a href="/en-US/docs/Web/JavaScript/Reference/Statements/var" title= "/en/JavaScript/Reference/Statements/var">var</a></code> keyword:</p><pre class="brush: js  language-js" data-number=""><code class=" language-js"><span class="token keyword">var</span> a <span class="token punctuation">;</span><span class="token keyword">var</span> name <span class="token operator">=</span> <span class="token string">"simon"</span><span class="token punctuation">;</span><div class="line-number" data-start="1" style="top: 0px;"></div><div class="line-number" data-start="2" style="top: 19px;"></div></code></pre><p>If you declare a variable without assigning any value to it, its type is <code>undefined</code>.</p><p>An important difference between JavaScript and other languages like Java is that in JavaScript, blocks do not have scope; only functions have scope. So if a variable is defined using <code>var</code> in a compound statement (for example inside an <code>if</code> control structure), it will be visible to the entire function. However, starting with ECMAScript Edition 6, <code><a href="/en-US/docs/Web/JavaScript/Reference/Statements/let">let</a></code> and <code><a href ="/en-US/docs/Web/JavaScript/Reference/Statements/const">const</a></code> declarations allow you to create block-scoped variables.</p><h2 id="Operators">Operators</h2><p>JavaScript's numeric operators are <code>+</code>, <code>-</code>, <code>*</code>, <code>/</code> and <code>%</code> - which is the remainder operator (<a href= "/en-US/docs/Web/JavaScript/Reference/Operators/Arithmetic_Operators#Remainder_%28%29">which is not the same as modulo</a>.) Values are assigned using <code>=</code>, and there are also compound assignment statements such as <code>+=</code> and <code>-=</code>. These extend out to <code>x = x <em>operator</em> y</code>.</p><pre class="brush: js  language-js" data-number= ""><code class=" language-js">x <span class="token operator">+</span><span class="token operator">=</span> <span class="token number">5</span>x <span class="token operator">=</span> x <span class="token operator">+</span> <span class="token number">5</span><div class="line-number" data-start="1" style="top: 0px;"></div><div class="line-number" data-start="2" style= "top: 19px;"></div></code></pre><p>You can use <code>++</code> and <code>--</code> to increment and decrement respectively. These can be used as prefix or postfix operators.</p><p>The <a href="/en-US/docs/Web/JavaScript/Reference/Operators/Arithmetic_Operators#Addition" title="/en/JavaScript/Reference/Operators/String_Operators"><code>+</code> operator</a> also does string concatenation:</p><pre class="brush: js  language-js" data-number=""><code class=" language-js"><span class="token string">"hello"</span> <span class="token operator">+</span> <span class="token string">" world"</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true"> // "hello world"</span><div class="line-number" data-start="1" style="top: 0px;"></div></code></pre><p>If you add a string to a number (or other value) everything is converted in to a string first. This might catch you up:</p><pre class="brush: js language-js" data-number=""><code class=" language-js"><span class="token string">"3"</span> <span class="token operator">+</span> <span class="token number">4</span> <span class="token operator">+</span> <span class="token number">5</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true"> // "345"</span> <span class="token number">3 </span> <span class="token operator">+</span> <span class="token number">4</span> <span class="token operator">+</span> <span class="token string">"5"</span><span class="token punctuation" >;</span><span class="token comment" spellcheck="true"> // "75"</span><div class="line-number" data-start="1" style="top: 0px;"></div><div class="line-number" data-start="2" style="top: 19px;"></div></code></pre><p>Adding an empty string to something is a useful way of converting it to a string itself.</p><p><a href= "/en-US/docs/Web/JavaScript/Reference/Operators/Comparison_Operators" title="/en/JavaScript/Reference/Operators/Comparison_Operators">Comparisons</a> in JavaScript can be made using <code> &lt;</code>, <code>&gt;</code>, <code>&lt;=</code> and <code>&gt;=</code>. These work for both strings and numbers. Equality is a little less straightforward. The double-equals operator performs type coercion if you give it different types, with sometimes interesting results:</p><pre class="brush: js  language-js" data-number=""><code class=" language-js"><span class= "token number">123</span> <span class="token operator">==</span> <span class="token string">"123"</span><span class="token punctuation">;</span><span class="token comment" spellcheck= "true"> // true</span><span class="token number">1</span> <span class="token operator">==</span> <span class="token keyword">true</span><span class="token punctuation">;</span><span class= "token comment" spellcheck="true"> // true</span><div class="line-number" data-start="1" style="top: 0px;"></div><div class="line-number" data-start="2" style="top: 19px;" ></div></code></pre><p>To avoid type coercion and make sure your comparisons are always accurate, you should always use the triple-equals operator:</p><pre class="brush: js  language-js" data-number=""><code class=" language-js"><span class="token number">123</span> <span class="token operator">===</span> <span class="token string">"123"</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true"> // false</span><span class="token number">1</span> <span class="token operator">===</span> <span class="token keyword"> true</span><span class="token punctuation">;</span>   <span class="token comment" spellcheck="true"> // false</span><div class="line-number" data-start="1" style="top: 0px;"></div><div class="line-number" data-start="2" style="top: 19px;"></div></code></pre><p>There are also <code>!=</code> and <code>!==</code> operators.</p><p>JavaScript also has <a href= "/en-US/docs/Web/JavaScript/Reference/Operators/Bitwise_Operators" title="/en/JavaScript/Reference/Operators/Bitwise_Operators">bitwise operations</a>. If you want to use them, they're there.</p><h2 id="Control_structures">Control structures</h2><p>JavaScript has a similar set of control structures to other languages in the C family. Conditional statements are supported by <code>if</code> and <code>else</code>; you can chain them together if you like:</p><pre class="brush: js  language-js" data-number=""><code class=" language-js"><span class="token keyword">var</span> name <span class="token operator">=</span> <span class="token string">"kittens"</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span>name <span class="token operator">==</span> <span class="token string">"puppies"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  name <span class="token operator">+</span><span class="token operator">=</span> <span class="token string">"!"</span><span class="token punctuation">;</span><span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>name <span class="token operator"> ==</span> <span class="token string">"kittens"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  name <span class="token operator">+</span><span class="token operator">=</span> <span class="token string">"!!"</span><span class="token punctuation">;</span><span class="token punctuation">}</span> <span class="token keyword">else </span> <span class="token punctuation">{</span>  name <span class="token operator">=</span> <span class="token string">"!"</span> <span class="token operator">+</span> name<span class= "token punctuation">;</span><span class="token punctuation">}</span>name <span class="token operator">==</span> <span class="token string">"kittens!!"</span><div class="line-number" data-start="1" style="top: 0px;"></div><div class="line-number" data-start="2" style="top: 19px;"></div><div class="line-number" data-start="3" style="top: 38px;"></div><div class= "line-number" data-start="4" style="top: 57px;"></div><div class="line-number" data-start="5" style="top: 76px;"></div><div class="line-number" data-start="6" style="top: 95px;"></div><div class="line-number" data-start="7" style="top: 114px;"></div><div class="line-number" data-start="8" style="top: 133px;"></div><div class="line-number" data-start="9" style="top: 152px;" ></div></code></pre><p>JavaScript has <code>while</code> loops and <code>do-while</code> loops. The first is good for basic looping; the second for loops where you wish to ensure that the body of the loop is executed at least once:</p><pre class="brush: js  language-js" data-number=""><code class=" language-js"><span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token keyword">true</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment" spellcheck="true"> // an infinite loop!</span><span class="token punctuation">}</span><span class="token keyword">var</span> input<span class="token punctuation">;</span><span class="token keyword">do </span> <span class="token punctuation">{</span>  input <span class="token operator">=</span> <span class="token function">get_input<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span> <span class="token keyword">while</span> <span class="token punctuation"> (</span><span class="token function">inputIsNotValid<span class="token punctuation">(</span></span>input<span class="token punctuation">)</span><span class="token punctuation">)</span><div class="line-number" data-start="1" style="top: 0px;"></div><div class="line-number" data-start="2" style="top: 19px;"></div><div class="line-number" data-start="3" style="top: 38px;" ></div><div class="line-number" data-start="4" style="top: 57px;"></div><div class="line-number" data-start="5" style="top: 76px;"></div><div class="line-number" data-start="6" style= "top: 95px;"></div><div class="line-number" data-start="7" style="top: 114px;"></div><div class="line-number" data-start="8" style="top: 133px;"></div></code></pre><p>JavaScript's <code> for</code> loop is the same as that in C and Java: it lets you provide the control information for your loop on a single line.</p><pre class="brush: js  language-js" data-number=""><code class=" language-js"><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">5</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment" spellcheck="true"> // Will execute 5 times</span><span class="token punctuation">}</span><div class="line-number" data-start="1" style="top: 0px;"></div><div class="line-number" data-start="2" style="top: 19px;"></div><div class="line-number" data-start="3" style="top: 38px;"></div></code></pre><p>The <code>&amp;&amp;</code> and <code>||</code> operators use short-circuit logic, which means whether they will execute their second operand is dependent on the first. This is useful for checking for null objects before accessing their attributes:</p><pre class="brush: js  language-js" data-number=""><code class=" language-js"><span class="token keyword">var</span> name <span class="token operator">=</span> o <span class="token operator">&amp;&amp;</span> o<span class= "token punctuation">.</span><span class="token function">getName<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">; </span><div class="line-number" data-start="1" style="top: 0px;"></div></code></pre><p>Or for setting default values:</p><pre class="brush: js  language-js" data-number=""><code class=" language-js"><span class="token keyword">var</span> name <span class="token operator">=</span> otherName <span class="token operator">||</span> <span class="token string">"default" </span><span class="token punctuation">;</span><div class="line-number" data-start="1" style="top: 0px;"></div></code></pre><p>JavaScript has a ternary operator for conditional expressions:</p><pre class="brush: js  language-js" data-number=""><code class=" language-js"><span class="token keyword">var</span> allowed <span class="token operator">=</span> <span class="token punctuation">(</span>age <span class="token operator">&gt;</span> <span class="token number">18</span><span class="token punctuation">)</span> <span class="token operator">? </span> <span class="token string">"yes"</span> <span class="token punctuation">:</span> <span class="token string">"no"</span><span class="token punctuation">;</span><div class= "line-number" data-start="1" style="top: 0px;"></div></code></pre><p>The <code>switch</code> statement can be used for multiple branches based on a number or string:</p><pre class="brush: js  language-js" data-number=""><code class=" language-js"><span class="token keyword">switch</span><span class="token punctuation">(</span>action<span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token keyword">case</span> <span class="token string">'draw'</span><span class="token punctuation">:</span>    <span class="token function">drawIt<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">break </span><span class="token punctuation">;</span>  <span class="token keyword">case</span> <span class="token string">'eat'</span><span class="token punctuation">:</span>    <span class= "token function">eatIt<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">break </span><span class="token punctuation">;</span>  <span class="token keyword">default</span><span class="token punctuation">:</span>    <span class="token function">doNothing<span class= "token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><div class="line-number" data-start="1" style="top: 0px;"></div><div class="line-number" data-start="2" style="top: 19px;"></div><div class="line-number" data-start="3" style="top: 38px;"></div><div class= "line-number" data-start="4" style="top: 57px;"></div><div class="line-number" data-start="5" style="top: 76px;"></div><div class="line-number" data-start="6" style="top: 95px;"></div><div class="line-number" data-start="7" style="top: 114px;"></div><div class="line-number" data-start="8" style="top: 133px;"></div><div class="line-number" data-start="9" style="top: 152px;" ></div><div class="line-number" data-start="10" style="top: 171px;"></div></code></pre><p>If you don't add a <code>break</code> statement, execution will "fall through" to the next level. This is very rarely what you want - in fact it's worth specifically labeling deliberate fallthrough with a comment if you really meant it to aid debugging:</p><pre class="brush: js language-js" data-number=""><code class=" language-js"><span class="token keyword">switch</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token keyword">case</span> <span class="token number">1</span><span class="token punctuation">:</span><span class="token comment" spellcheck="true"> // fallthrough</span>  <span class="token keyword">case</span> <span class="token number">2</span><span class="token punctuation">:</span>    <span class="token function">eatIt<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">break </span><span class="token punctuation">;</span>  <span class="token keyword">default</span><span class="token punctuation">:</span>    <span class="token function">doNothing<span class= "token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><div class="line-number" data-start="1" style="top: 0px;"></div><div class="line-number" data-start="2" style="top: 19px;"></div><div class="line-number" data-start="3" style="top: 38px;"></div><div class= "line-number" data-start="4" style="top: 57px;"></div><div class="line-number" data-start="5" style="top: 76px;"></div><div class="line-number" data-start="6" style="top: 95px;"></div><div class="line-number" data-start="7" style="top: 114px;"></div><div class="line-number" data-start="8" style="top: 133px;"></div></code></pre><p>The default clause is optional. You can have expressions in both the switch part and the cases if you like; comparisons take place between the two using the <code>===</code> operator:</p><pre class="brush: js  language-js" data-number=""><code class=" language-js"><span class="token keyword">switch</span><span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator"> +</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token keyword">case</span> <span class="token number">2</span> <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">:</span>    <span class="token function">yay<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">break</span><span class="token punctuation">; </span>  <span class="token keyword">default</span><span class="token punctuation">:</span>    <span class="token function">neverhappens<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><div class="line-number" data-start="1" style="top: 0px;"></div><div class="line-number" data-start="2" style="top: 19px;"></div><div class="line-number" data-start="3" style="top: 38px;"></div><div class="line-number" data-start="4" style="top: 57px;" ></div><div class="line-number" data-start="5" style="top: 76px;"></div><div class="line-number" data-start="6" style="top: 95px;"></div><div class="line-number" data-start="7" style= "top: 114px;"></div></code></pre><h2 id="Objects">Objects</h2><p>JavaScript objects can be thought of as simple collections of name-value pairs. As such, they are similar to:</p><ul> <li> Dictionaries in Python.</li> <li>Hashes in Perl and Ruby.</li> <li>Hash tables in C and C++.</li> <li>HashMaps in Java.</li> <li>Associative arrays in PHP.</li></ul><p>The fact that this data structure is so widely used is a testament to its versatility. Since everything (bar core types) in JavaScript is an object, any JavaScript program naturally involves a great deal of hash table lookups. It's a good thing they're so fast!</p><p>The "name" part is a JavaScript string, while the value can be any JavaScript value - including more objects. This allows you to build data structures of arbitrary complexity.</p><p>There are two basic ways to create an empty object:</p><pre class="brush: js  language-js" data-number=""><code class=" language-js" ><span class="token keyword">var</span> obj <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Object</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><div class="line-number" data-start="1" style="top: 0px;"></div></code></pre><p>And: </p><pre class="brush: js  language-js" data-number=""><code class=" language-js"><span class="token keyword">var</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span><div class="line-number" data-start="1" style="top: 0px;"></div></code></pre><p>These are semantically equivalent; the second is called object literal syntax, and is more convenient. This syntax is also the core of JSON format and should be preferred at all times.</p><p> Object literal syntax can be used to initialize an object in its entirety:</p><pre class="brush: js  language-js" data-number=""><code class=" language-js"><span class="token keyword">var </span> obj <span class="token operator">=</span> <span class="token punctuation">{</span>  name<span class="token punctuation">:</span> <span class="token string">"Carrot"</span><span class="token punctuation">,</span>  <span class="token string">"for"</span><span class="token punctuation">:</span> <span class="token string">"Max"</span><span class="token punctuation">, </span>  details<span class="token punctuation">:</span> <span class="token punctuation">{</span>    color<span class="token punctuation">:</span> <span class="token string">"orange" </span><span class="token punctuation">,</span>    size<span class="token punctuation">:</span> <span class="token number">12</span>  <span class="token punctuation">}</span><span class= "token punctuation">}</span><div class="line-number" data-start="1" style="top: 0px;"></div><div class="line-number" data-start="2" style="top: 19px;"></div><div class="line-number" data-start="3" style="top: 38px;"></div><div class="line-number" data-start="4" style="top: 57px;"></div><div class="line-number" data-start="5" style="top: 76px;"></div><div class= "line-number" data-start="6" style="top: 95px;"></div><div class="line-number" data-start="7" style="top: 114px;"></div><div class="line-number" data-start="8" style="top: 133px;" ></div></code></pre><p>Attribute access can be chained together:</p><pre class="brush: js  language-js" data-number=""><code class=" language-js">obj<span class="token punctuation">. </span>details<span class="token punctuation">.</span>color<span class="token punctuation">;</span><span class="token comment" spellcheck="true"> // orange</span>obj<span class="token punctuation">[</span><span class="token string">"details"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"size" </span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true"> // 12</span><div class="line-number" data-start="1" style="top: 0px;"></div><div class="line-number" data-start="2" style="top: 19px;"></div></code></pre><p>The following example creates an object&nbsp;prototype, Person, and instance of that prototype, You.</p><pre class="brush: js  language-js" data-number=""><code class=" language-js"><span class="token keyword">function</span> <span class="token function">Person<span class="token punctuation">(</span></span>name<span class="token punctuation">,</span> age<span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class= "token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>  <span class="token keyword">this </span><span class="token punctuation">.</span>age <span class="token operator">=</span> age<span class="token punctuation">;</span><span class="token punctuation">}</span><span class= "token comment" spellcheck="true">// Define an object</span><span class="token keyword">var</span> You <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token string">"You"</span><span class="token punctuation">,</span> <span class="token number">24 </span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// We are creating a new person named "You" </span><span class="token comment" spellcheck="true">// (that was the first parameter, and the age..)</span><div class="line-number" data-start="1" style="top: 0px;"></div><div class= "line-number" data-start="2" style="top: 19px;"></div><div class="line-number" data-start="3" style="top: 38px;"></div><div class="line-number" data-start="4" style="top: 57px;"></div><div class="line-number" data-start="5" style="top: 76px;"></div><div class="line-number" data-start="6" style="top: 95px;"></div><div class="line-number" data-start="7" style="top: 114px;" ></div><div class="line-number" data-start="8" style="top: 133px;"></div><div class="line-number" data-start="9" style="top: 152px;"></div></code></pre><p>Once created, an object's properties can again be accessed in one of two ways:</p><pre class="brush: js  language-js" data-number=""><code class=" language-js">obj<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">"Simon"</span><span class="token punctuation">;</span><span class="token keyword">var</span> name <span class="token operator">= </span> obj<span class="token punctuation">.</span>name<span class="token punctuation">;</span><div class="line-number" data-start="1" style="top: 0px;"></div><div class="line-number" data-start="2" style="top: 19px;"></div></code></pre><p>And...</p><pre class="brush: js  language-js" data-number=""><code class=" language-js">obj<span class="token punctuation">[ </span><span class="token string">"name"</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"Simon"</span><span class="token punctuation">;</span><span class="token keyword">var</span> name <span class="token operator">=</span> obj<span class="token punctuation">[</span><span class="token string">"name" </span><span class="token punctuation">]</span><span class="token punctuation">;</span><div class="line-number" data-start="1" style="top: 0px;"></div><div class="line-number" data-start= "2" style="top: 19px;"></div></code></pre><p>These are also semantically equivalent. The second method has the advantage that the name of the property is provided as a string, which means it can be calculated at run-time though using this method prevents some JavaScript engine and minifier optimizations being applied. It can also be used to set and get properties with names that are <a href="/en-US/docs/Web/JavaScript/Reference/Lexical_grammar#Keywords" title="/en/JavaScript/Reference/Reserved_Words">reserved words</a>:</p><pre class="brush: js language-js" data-number=""><code class=" language-js">obj<span class="token punctuation">.</span><span class="token keyword">for</span> <span class="token operator">=</span> <span class= "token string">"Simon"</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true"> // Syntax error, because 'for' is a reserved word</span>obj<span class= "token punctuation">[</span><span class="token string">"for"</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"Simon" </span><span class="token punctuation">;</span><span class="token comment" spellcheck="true"> // works fine</span><div class="line-number" data-start="1" style="top: 0px;"></div><div class ="line-number" data-start="2" style="top: 19px;"></div></code></pre><div class="note"><p><span style="color: rgb(34, 34, 34); font-family: verdana,arial,sans-serif; font-size: 12px; line-height: 18px;"><strong>Note:</strong>&nbsp;Starting from EcmaScript 5, reserved words may be used as object property names "in the buff". This means that they don't need to be "clothed" in quotes when defining object literals. See the ES5 <a href="http://es5.github.io/#x7.6.1" class="external external-icon">Spec</a>.</span></p></div><p>For more on objects and prototypes see:&nbsp;<a href="/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/prototype">Object.prototype</a>.</p><h2 id="Arrays">Arrays</h2><p>Arrays in JavaScript are actually a special type of object. They work very much like regular objects (numerical properties can naturally be accessed only using <code>[]</code> syntax) but they have one magic property called '<code>length</code>'. This is always one more than the highest index in the array.</p><p>One way of creating arrays is as follows:</p><pre class="brush: js  language-js" data-number=""><code class=" language-js"><span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Array</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>a<span class="token punctuation">[ </span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"dog"</span><span class="token punctuation">;</span>a<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class= "token string">"cat"</span><span class="token punctuation">;</span>a<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"hen"</span><span class="token punctuation">;</span>a<span class="token punctuation">.</span>length<span class="token punctuation">;</span><span class="token comment" spellcheck="true"> // 3</span><div class="line-number" data-start="1" style="top: 0px;"></div><div class="line-number" data-start="2" style ="top: 19px;"></div><div class="line-number" data-start="3" style="top: 38px;"></div><div class="line-number" data-start="4" style="top: 57px;"></div><div class="line-number" data-start= "5" style="top: 76px;"></div></code></pre><p>A more convenient notation is to use an array literal:</p><pre class="brush: js  language-js" data-number=""><code class=" language-js"><span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"dog"</span><span class="token punctuation">, </span> <span class="token string">"cat"</span><span class="token punctuation">,</span> <span class="token string">"hen"</span><span class="token punctuation">]</span><span class="token punctuation">;</span>a<span class="token punctuation">.</span>length<span class="token punctuation">;</span><span class="token comment" spellcheck="true"> // 3</span><div class= "line-number" data-start="1" style="top: 0px;"></div><div class="line-number" data-start="2" style="top: 19px;"></div></code></pre><p>Note that <code>array.length</code> isn't necessarily the number of items in the array. Consider the following:</p><pre class="brush: js  language-js" data-number=""><code class=" language-js"><span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"dog"</span><span class="token punctuation">,</span> <span class="token string">"cat" </span><span class="token punctuation">,</span> <span class="token string">"hen"</span><span class="token punctuation">]</span><span class="token punctuation">;</span>a<span class="token punctuation">[</span><span class="token number">100</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"fox"</span><span class= "token punctuation">;</span>a<span class="token punctuation">.</span>length<span class="token punctuation">;</span><span class="token comment" spellcheck="true"> // 101</span><div class= "line-number" data-start="1" style="top: 0px;"></div><div class="line-number" data-start="2" style="top: 19px;"></div><div class="line-number" data-start="3" style="top: 38px;" ></div></code></pre><p>Remember - the length of the array is one more than the highest index.</p><p>If you query a non-existent array index, you'll get a value of <code>undefined</code> returned:</p><pre class="brush: js  language-js" data-number=""><code class=" language-js"><span class="token keyword">typeof</span> a<span class="token punctuation">[</span><span class= "token number">90</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true"> // undefined</span><div class= "line-number" data-start="1" style="top: 0px;"></div></code></pre><p>If you take the above into account, you can iterate over an array using the following:</p><pre class="brush: js language-js" data-number=""><code class=" language-js"><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class= "token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> a<span class="token punctuation">.</span> length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment" spellcheck="true"> // Do something with a[i]</span><span class="token punctuation">}</span><div class="line-number" data-start="1" style="top: 0px;"></div><div class="line-number" data-start="2" style="top: 19px;"></div><div class="line-number" data-start="3" style="top: 38px;"></div></code></pre><p>This is slightly inefficient as you are looking up the length property once every loop. An improvement is this:</p><pre class="brush: js  language-js" data-number=""><code class=" language-js"><span class="token keyword">for</span> <span class= "token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> len <span class="token operator">=</span> a<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i <span class="token operator">&lt;</span> len<span class= "token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment" spellcheck ="true"> // Do something with a[i]</span><span class="token punctuation">}</span><div class="line-number" data-start="1" style="top: 0px;"></div><div class="line-number" data-start="2" style="top: 19px;"></div><div class="line-number" data-start="3" style="top: 38px;"></div></code></pre><p>A&nbsp;nicer-looking but limited idiom is:</p><pre class="brush: js  language-js" data-number=""><code class=" language-js"><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> item<span class="token punctuation">;</span> item <span class="token operator">=</span> a <span class="token punctuation">[</span>i<span class="token operator">++</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment" spellcheck="true"> // Do something with item</span><span class="token punctuation">}</span><div class="line-number" data-start="1" style="top: 0px;"></div><div class="line-number" data-start="2" style="top: 19px;"></div><div class="line-number" data-start="3" style="top: 38px;" ></div></code></pre><p>Here we are setting up two variables. The assignment in the middle part of the <code>for</code> loop is also tested for truthfulness - if it succeeds, the loop continues. Since <code>i</code> is incremented each time, items from the array will be assigned to item in sequential order. The loop stops when a "falsy" item is found (such as <code> undefined</code>).</p><p>This trick should only be used for arrays which you know do not contain "falsy" values (arrays of objects or <a href="/en-US/docs/Glossary/DOM" class= "glossaryLink" title="DOM: The DOM (Document Object Model) is an API that represents and interacts with any HTML or XML document. The DOM is a document model loaded in the browser and representing the document as a node tree, where each node represents part of the document (e.g. an element, text string, or comment).">DOM</a> nodes for example). If you are iterating over numeric data that might include a 0 or string data that might include the empty string you should use the <code>i, len</code> idiom instead.</p><p>You can iterate over an array using a&nbsp;<code><a href="/en-US/docs/Web/JavaScript/Reference/Statements/for...in" title="/en/JavaScript/Reference/Statements/for...in">for...in</a></code> loop. Note that if someone added new properties to <code>Array.prototype</code>, they will also be iterated over by this loop. &nbsp;Therefore this method is "not" recommended.</p><p>Another way of iterating over an array that was added with ECMAScript 5 is&nbsp;<a href="/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/forEach">forEach()</a>:</p><pre class="brush: js  language-js" style= "font-size: 14px;" data-number=""><code class=" language-js"><span class="token punctuation">[</span><span class="token string">"dog"</span><span class="token punctuation">,</span> <span class="token string">"cat"</span><span class="token punctuation">,</span> <span class="token string">"hen"</span><span class="token punctuation">]</span><span class="token punctuation">. </span><span class="token function">forEach<span class="token punctuation">(</span></span><span class="token keyword">function</span><span class="token punctuation">(</span>currentValue <span class="token punctuation">,</span> index<span class="token punctuation">,</span> array<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class= "token comment" spellcheck="true"> // Do something with currentValue or array[index]</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class= "token punctuation">;</span><div class="line-number" data-start="1" style="top: 0px;"></div><div class="line-number" data-start="2" style="top: 19px;"></div><div class="line-number" data-start="3" style="top: 38px;"></div></code></pre><p>If you want to append an item to an array simply do it like this:</p><pre class="brush: js  language-js" data-number=""><code class= " language-js">a<span class="token punctuation">.</span><span class="token function">push<span class="token punctuation">(</span></span>item<span class="token punctuation">)</span><span class="token punctuation">;</span><div class="line-number" data-start="1" style="top: 0px;"></div></code></pre><p>Arrays come with a number of methods. See also the <a href= "/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array">full documentation for array methods</a>.</p><table> <thead>  <tr>   <th scope="col">Method name</th>   <th scope="col"> Description</th>  </tr> </thead> <tbody>  <tr>   <td><code>a.toString()</code></td>   <td>Returns a string with the <code>toString()</code> of each element separated by commas.</td>  </tr> <tr>   <td><code>a.toLocaleString()</code></td>   <td>Returns a string with the <code>toLocaleString()</code> of each element separated by commas.</td>  </tr>  <tr>   <td><code> a.concat(item1[, item2[, ...[, itemN]]])</code></td>   <td>Returns a new array with the items added on to it.</td>  </tr>  <tr>   <td><code>a.join(sep)</code></td>   <td>Converts the array to a string - with values delimited by the <code>sep</code> param</td>  </tr>  <tr>   <td><code>a.pop()</code></td>   <td>Removes and returns the last item.</td>  </tr>  <tr> <td><code>a.push(item1, ..., itemN)</code></td>   <td>Adds one or more items to the end.</td>  </tr>  <tr>   <td><code>a.reverse()</code></td>   <td>Reverses the array.</td>  </tr>  <tr> <td><code>a.shift()</code></td>   <td>Removes and returns the first item.</td>  </tr>  <tr>   <td><code>a.slice(start, end)</code></td>   <td>Returns a sub-array.</td>  </tr>  <tr> <td><code>a.sort([cmpfn])</code></td>   <td>Takes an optional comparison function.</td>  </tr>  <tr>   <td><code>a.splice(start, delcount[, item1[, ...[, itemN]]])</code></td>   <td>Lets you modify an array by deleting a section and replacing it with more items.</td>  </tr>  <tr>   <td><code>a.unshift([item])</code></td>   <td>Prepends items to the start of the array.</td> </tr> </tbody></table><h2 id="Functions">Functions</h2><p>Along with objects, functions are the core component in understanding JavaScript. The most basic function couldn't be much simpler:</p><pre class="brush: js  language-js" data-number=""><code class=" language-js"><span class="token keyword">function</span> <span class="token function">add<span class="token punctuation">(</span></span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token keyword">var </span> total <span class="token operator">=</span> x <span class="token operator">+</span> y<span class="token punctuation">;</span>  <span class="token keyword">return</span> total<span class="token punctuation">;</span><span class="token punctuation">}</span><div class="line-number" data-start="1" style="top: 0px;"></div><div class="line-number" data-start="2" style= "top: 19px;"></div><div class="line-number" data-start="3" style="top: 38px;"></div><div class="line-number" data-start="4" style="top: 57px;"></div></code></pre><p>This demonstrates a basic function. A JavaScript function can take 0 or more named parameters. The function body can contain as many statements as you like, and can declare its own variables which are local to that function. The <code>return</code> statement can be used to return a value at any time, terminating the function. If no return statement is used (or an empty return with no value), JavaScript returns <code>undefined</code>.</p><p>The named parameters turn out to be more like guidelines than anything else. You can call a function without passing the parameters it expects, in which case they will be set to <code>undefined</code>.</p><pre class="brush: js  language-js" data-number=""><code class=" language-js"><span class="token function">add<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true"> // NaN </span><span class="token comment" spellcheck="true">// You can't perform addition on undefined</span><div class="line-number" data-start="1" style="top: 0px;"></div><div class="line-number" data-start ="2" style="top: 19px;"></div></code></pre><p>You can also pass in more arguments than the function is expecting:</p><pre class="brush: js  language-js" data-number=""><code class=" language-js"><span class="token function">add<span class="token punctuation">(</span></span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class= "token comment" spellcheck="true"> // 5 </span><span class="token comment" spellcheck="true">// added the first two; 4 was ignored</span><div class="line-number" data-start="1" style= "top: 0px;"></div><div class="line-number" data-start="2" style="top: 19px;"></div></code></pre><p>That may seem a little silly, but functions have access to an additional variable inside their body called <a href="/en-US/docs/Web/JavaScript/Reference/Functions/arguments" title="/en/JavaScript/Reference/Functions_and_function_scope/arguments"><code>arguments</code></a>, which is an array-like object holding all of the values passed to the function. Let's re-write the add function to take as many values as we want:</p><pre class="brush: js  language-js" data-number=""><code class=" language-js"><span class="token keyword">function</span> <span class="token function">add<span class="token punctuation">(</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token keyword">var</span> sum <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">= </span> <span class="token number">0</span><span class="token punctuation">,</span> j <span class="token operator">=</span> arguments<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i <span class="token operator">&lt;</span> j<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    sum <span class="token operator">+</span><span class="token operator">=</span> arguments<span class="token punctuation">[ </span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span>  <span class="token keyword">return</span> sum<span class ="token punctuation">;</span><span class="token punctuation">}</span><span class="token function">add<span class="token punctuation">(</span></span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true"> // 14</span><div class= "line-number" data-start="1" style="top: 0px;"></div><div class="line-number" data-start="2" style="top: 19px;"></div><div class="line-number" data-start="3" style="top: 38px;"></div><div class="line-number" data-start="4" style="top: 57px;"></div><div class="line-number" data-start="5" style="top: 76px;"></div><div class="line-number" data-start="6" style="top: 95px;" ></div><div class="line-number" data-start="7" style="top: 114px;"></div><div class="line-number" data-start="8" style="top: 133px;"></div><div class="line-number" data-start="9" style= "top: 152px;"></div></code></pre><p>That's really not any more useful than writing <code>2 + 3 + 4 + 5</code> though. Let's create an averaging function:</p><pre class="brush: js language-js" data-number=""><code class=" language-js"><span class="token keyword">function</span> <span class="token function">avg<span class="token punctuation">(</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token keyword">var</span> sum <span class="token operator">=</span> <span class="token number">0 </span><span class="token punctuation">;</span>  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> j <span class="token operator">=</span> arguments<span class="token punctuation">.</span> length<span class="token punctuation">;</span> i <span class="token operator">&lt;</span> j<span class="token punctuation">;</span> i<span class="token operator">++</span><span class= "token punctuation">)</span> <span class="token punctuation">{</span>    sum <span class="token operator">+</span><span class="token operator">=</span> arguments<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span>  <span class="token keyword">return</span> sum <span class="token operator">/</span> arguments<span class="token punctuation">.</span>length<span class="token punctuation">;</span><span class="token punctuation">}</span><span class ="token function">avg<span class="token punctuation">(</span></span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">) </span><span class="token punctuation">;</span><span class="token comment" spellcheck="true"> // 3.5</span><div class="line-number" data-start="1" style="top: 0px;"></div><div class= "line-number" data-start="2" style="top: 19px;"></div><div class="line-number" data-start="3" style="top: 38px;"></div><div class="line-number" data-start="4" style="top: 57px;"></div><div class="line-number" data-start="5" style="top: 76px;"></div><div class="line-number" data-start="6" style="top: 95px;"></div><div class="line-number" data-start="7" style="top: 114px;" ></div><div class="line-number" data-start="8" style="top: 133px;"></div><div class="line-number" data-start="9" style="top: 152px;"></div></code></pre><p>This is pretty useful, but introduces a new problem. The <code>avg()</code> function takes a comma separated list of arguments - but what if you want to find the average of an array? You could just rewrite the function as follows:</p><pre class="brush: js  language-js" data-number=""><code class=" language-js"><span class="token keyword">function</span> <span class="token function">avgArray<span class="token punctuation">(</span></span>arr<span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token keyword">var</span> sum <span class= "token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> j <span class="token operator">=</span> arr<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i <span class="token operator">&lt;</span> j<span class="token punctuation">;</span> i<span class ="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    sum <span class="token operator">+</span><span class="token operator">= </span> arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span>  <span class= "token keyword">return</span> sum <span class="token operator">/</span> arr<span class="token punctuation">.</span>length<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token function">avgArray<span class="token punctuation">(</span></span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true"> // 3.5</span><div class="line-number" data-start="1" style="top: 0px;"></div><div class="line-number" data-start="2" style="top: 19px;"></div><div class="line-number" data-start="3" style="top: 38px;"></div><div class="line-number" data-start="4" style="top: 57px;"></div><div class="line-number" data-start="5" style="top: 76px;"></div><div class= "line-number" data-start="6" style="top: 95px;"></div><div class="line-number" data-start="7" style="top: 114px;"></div><div class="line-number" data-start="8" style="top: 133px;" ></div><div class="line-number" data-start="9" style="top: 152px;"></div></code></pre><p>But it would be nice to be able to reuse the function that we've already created. Luckily, JavaScript lets you call a function and call it with an arbitrary array of arguments, using the <a href="/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function/apply" title="The apply() method calls a function with a given this value and arguments provided as an array (or an array-like object)."><code>apply()</code></a> method of any function object.</p><pre class ="brush: js  language-js" data-number=""><code class=" language-js">avg<span class="token punctuation">.</span><span class="token function">apply<span class="token punctuation">( </span></span><span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class= "token number">5</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true" > // 3.5</span><div class="line-number" data-start="1" style="top: 0px;"></div></code></pre><p>The second argument to <code>apply()</code> is the array to use as arguments; the first will be discussed later on. This emphasizes the fact that functions are objects too.</p><p>JavaScript lets you create anonymous functions.</p><pre class="brush: js  language-js" data-number="" ><code class=" language-js"><span class="token keyword">var</span> avg <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">( </span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token keyword">var</span> sum <span class="token operator">=</span> <span class= "token number">0</span><span class="token punctuation">;</span>  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> j <span class="token operator">=</span> arguments<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i <span class="token operator">&lt;</span> j<span class="token punctuation">;</span> i<span class="token operator">++ </span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    sum <span class="token operator">+</span><span class="token operator">=</span> arguments<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span>  <span class="token keyword"> return</span> sum <span class="token operator">/</span> arguments<span class="token punctuation">.</span>length<span class="token punctuation">;</span><span class="token punctuation">} </span><span class="token punctuation">;</span><div class="line-number" data-start="1" style="top: 0px;"></div><div class="line-number" data-start="2" style="top: 19px;"></div><div class= "line-number" data-start="3" style="top: 38px;"></div><div class="line-number" data-start="4" style="top: 57px;"></div><div class="line-number" data-start="5" style="top: 76px;"></div><div class="line-number" data-start="6" style="top: 95px;"></div><div class="line-number" data-start="7" style="top: 114px;"></div></code></pre><p>This is semantically equivalent to the <code> function avg()</code> form. It's extremely powerful, as it lets you put a full function definition anywhere that you would normally put an expression. This enables all sorts of clever tricks. Here's a way of "hiding" some local variables - like block scope in C:</p><pre class="brush: js  language-js" data-number=""><code class=" language-js"><span class="token keyword"> var</span> a <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span><span class="token keyword">var</span> b <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class ="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token keyword">var</span> b <span class="token operator">= </span> <span class="token number">3</span><span class="token punctuation">;</span>  a <span class="token operator">+</span><span class="token operator">=</span> b<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>a<span class="token punctuation">;</span><span class="token comment" spellcheck="true"> // 4</span>b<span class="token punctuation">;</span><span class= "token comment" spellcheck="true"> // 2</span><div class="line-number" data-start="1" style="top: 0px;"></div><div class="line-number" data-start="2" style="top: 19px;"></div><div class= "line-number" data-start="3" style="top: 38px;"></div><div class="line-number" data-start="4" style="top: 57px;"></div><div class="line-number" data-start="5" style="top: 76px;"></div><div class="line-number" data-start="6" style="top: 95px;"></div><div class="line-number" data-start="7" style="top: 114px;"></div><div class="line-number" data-start="8" style="top: 133px;" ></div><div class="line-number" data-start="9" style="top: 152px;"></div><div class="line-number" data-start="10" style="top: 171px;"></div></code></pre><p>JavaScript allows you to call functions recursively. This is particularly useful for dealing with tree structures, such as those found in the browser DOM.</p><pre class="brush: js  language-js" data-number=""><code class=" language-js"><span class="token keyword">function</span> <span class="token function">countChars<span class="token punctuation">(</span></span>elm<span class="token punctuation">) </span> <span class="token punctuation">{</span>  <span class="token keyword">if</span> <span class="token punctuation">(</span>elm<span class="token punctuation">.</span>nodeType <span class="token operator">==</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token comment" spellcheck= "true"> // TEXT_NODE</span>    <span class="token keyword">return</span> elm<span class="token punctuation">.</span>nodeValue<span class="token punctuation">.</span>length<span class= "token punctuation">;</span>  <span class="token punctuation">}</span>  <span class="token keyword">var</span> count <span class="token operator">=</span> <span class="token number">0 </span><span class="token punctuation">;</span>  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> child<span class="token punctuation">;</span> child <span class="token operator">=</span> elm <span class="token punctuation">.</span>childNodes<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span> i<span class= "token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    count <span class="token operator">+</span><span class="token operator">= </span> <span class="token function">countChars<span class="token punctuation">(</span></span>child<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span>  <span class="token keyword">return</span> count<span class="token punctuation">;</span><span class="token punctuation">}</span><div class="line-number" data-start="1" style="top: 0px;"></div><div class="line-number" data-start="2" style="top: 19px;"></div><div class="line-number" data-start="3" style="top: 38px;"></div><div class= "line-number" data-start="4" style="top: 57px;"></div><div class="line-number" data-start="5" style="top: 76px;"></div><div class="line-number" data-start="6" style="top: 95px;"></div><div class="line-number" data-start="7" style="top: 114px;"></div><div class="line-number" data-start="8" style="top: 133px;"></div><div class="line-number" data-start="9" style="top: 152px;" ></div><div class="line-number" data-start="10" style="top: 171px;"></div></code></pre><p>This highlights a potential problem with anonymous functions: how do you call them recursively if they don't have a name? JavaScript lets you name function expressions for this. You can use named IIFEs (Immediately Invoked Function Expressions) as shown below:</p><pre class="brush: js  language-js" data-number=""><code class=" language-js"><span class="token keyword">var</span> charsInBody <span class="token operator">=</span> <span class="token punctuation">( </span><span class="token keyword">function</span> <span class="token function">counter<span class="token punctuation">(</span></span>elm<span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token keyword">if</span> <span class="token punctuation">(</span>elm<span class="token punctuation">.</span>nodeType <span class="token operator">==</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token comment" spellcheck="true"> // TEXT_NODE</span>    <span class="token keyword">return</span> elm<span class="token punctuation">.</span>nodeValue<span class="token punctuation">.</span>length<span class="token punctuation">;</span>  <span class="token punctuation">}</span>  <span class="token keyword">var</span> count <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">= </span> <span class="token number">0</span><span class="token punctuation">,</span> child<span class="token punctuation">;</span> child <span class="token operator">=</span> elm<span class ="token punctuation">.</span>childNodes<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    count <span class="token operator">+</span><span class="token operator">=</span> <span class="token function">counter<span class="token punctuation">(</span></span>child<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class= "token punctuation">}</span>  <span class="token keyword">return</span> count<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation" >)</span><span class="token punctuation">(</span>document<span class="token punctuation">.</span>body<span class="token punctuation">)</span><span class="token punctuation">;</span><div class="line-number" data-start="1" style="top: 0px;"></div><div class="line-number" data-start="2" style="top: 19px;"></div><div class="line-number" data-start="3" style="top: 38px;" ></div><div class="line-number" data-start="4" style="top: 57px;"></div><div class="line-number" data-start="5" style="top: 76px;"></div><div class="line-number" data-start="6" style= "top: 95px;"></div><div class="line-number" data-start="7" style="top: 114px;"></div><div class="line-number" data-start="8" style="top: 133px;"></div><div class="line-number" data-start= "9" style="top: 152px;"></div><div class="line-number" data-start="10" style="top: 171px;"></div></code></pre><p>The name provided to a function expression as above is only available to the function's own scope. This allows more optimizations to be done by the engine and results in more readable code. The name also shows up in the debugger and some stack traces, which can save you time when debugging.</p><p>Note that JavaScript functions are themselves objects - like everything else in JavaScript - and you can add or change properties on them just like we've saw earlier in the Objects section.</p><h2 id="Custom_objects">Custom objects</h2><div class="note"><strong>Note:</strong> For a more detailed discussion of object-oriented programming in JavaScript, see <a href="/en-US/docs/Web/JavaScript/Introduction_to_Object-Oriented_JavaScript" title=" https://developer.mozilla.org/en/Introduction_to_Object-Oriented_JavaScript">Introduction to Object Oriented JavaScript</a>.</div><p>In classic Object Oriented Programming, objects are collections of data and methods that operate on that data. JavaScript is a prototype-based language that contains no class statement, as you'd find in C++ or Java (this is sometimes confusing for programmers accustomed to languages with a class statement.) Instead, JavaScript uses functions as classes. Let's consider a person object with first and last name fields. There are two ways in which the name might be displayed: as "first last" or as "last, first". Using the functions and objects that we've discussed previously, we could display the data like this:</p><pre class="example-bad brush: js  language-js" data-number=""><code class=" language-js"><span class="token keyword">function</span> <span class="token function">makePerson <span class="token punctuation">(</span></span>first<span class="token punctuation">,</span> last<span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token keyword">return</span> <span class="token punctuation">{</span>    first<span class="token punctuation">:</span> first<span class="token punctuation">,</span>    last<span class="token punctuation">:</span> last  <span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword" >function</span> <span class="token function">personFullName<span class="token punctuation">(</span></span>person<span class="token punctuation">)</span> <span class="token punctuation">{ </span>  <span class="token keyword">return</span> person<span class="token punctuation">.</span>first <span class="token operator">+</span> <span class="token string">' '</span> <span class="token operator">+</span> person<span class="token punctuation">.</span>last<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">function</span> <span class="token function">personFullNameReversed<span class="token punctuation">(</span></span>person<span class="token punctuation">)</span> <span class= "token punctuation">{</span>  <span class="token keyword">return</span> person<span class="token punctuation">.</span>last <span class="token operator">+</span> <span class="token string"> ', '</span> <span class="token operator">+</span> person<span class="token punctuation">.</span>first<span class="token punctuation">;</span><span class="token punctuation">}</span>s <span class="token operator">=</span> <span class="token function">makePerson<span class="token punctuation">(</span></span><span class="token string">"Simon"</span><span class="token punctuation">,</span> <span class="token string">"Willison"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function"> personFullName<span class="token punctuation">(</span></span>s<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true"> // "Simon Willison"</span><span class="token function">personFullNameReversed<span class="token punctuation">(</span></span>s<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token string">"Willison, Simon"</span><div class="line-number" data-start="1" style="top: 0px;"></div><div class="line-number" data-start="2" style= "top: 19px;"></div><div class="line-number" data-start="3" style="top: 38px;"></div><div class="line-number" data-start="4" style="top: 57px;"></div><div class="line-number" data-start="5" style="top: 76px;"></div><div class="line-number" data-start="6" style="top: 95px;"></div><div class="line-number" data-start="7" style="top: 114px;"></div><div class="line-number" data-start="8" style="top: 133px;"></div><div class="line-number" data-start="9" style="top: 152px;"></div><div class="line-number" data-start="10" style="top: 171px;"></div><div class= "line-number" data-start="11" style="top: 190px;"></div><div class="line-number" data-start="12" style="top: 209px;"></div><div class="line-number" data-start="13" style="top: 228px;" ></div><div class="line-number" data-start="14" style="top: 247px;"></div><div class="line-number" data-start="15" style="top: 266px;"></div><div class="line-number" data-start="16" style= "top: 285px;"></div></code></pre><p>This works, but it's pretty ugly. You end up with dozens of functions in your global namespace. What we really need is a way to attach a function to an object. Since functions are objects, this is easy:</p><pre class="brush: js  language-js" data-number=""><code class=" language-js"><span class="token keyword">function</span> <span class= "token function">makePerson<span class="token punctuation">(</span></span>first<span class="token punctuation">,</span> last<span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token keyword">return</span> <span class="token punctuation">{</span>    first<span class="token punctuation">:</span> first<span class="token punctuation">,</span>    last<span class="token punctuation">:</span> last<span class="token punctuation">,</span>    fullName<span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>      <span class="token keyword">return </span> <span class="token keyword">this</span><span class="token punctuation">.</span>first <span class="token operator">+</span> <span class="token string">' '</span> <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>last<span class="token punctuation">;</span>    <span class="token punctuation">} </span><span class="token punctuation">,</span>    fullNameReversed<span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">( </span><span class="token punctuation">)</span> <span class="token punctuation">{</span>      <span class="token keyword">return</span> <span class="token keyword">this</span><span class= "token punctuation">.</span>last <span class="token operator">+</span> <span class="token string">', '</span> <span class="token operator">+</span> <span class="token keyword">this </span><span class="token punctuation">.</span>first<span class="token punctuation">;</span>    <span class="token punctuation">}</span>  <span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token punctuation">}</span>s <span class="token operator">=</span> <span class="token function">makePerson<span class="token punctuation">( </span></span><span class="token string">"Simon"</span><span class="token punctuation">,</span> <span class="token string">"Willison"</span><span class="token punctuation">)</span>s<span class="token punctuation">.</span><span class="token function">fullName<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true"> // "Simon Willison"</span>s<span class="token punctuation">.</span><span class="token function">fullNameReversed<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true"> // "Willison, Simon" </span><div class="line-number" data-start="1" style="top: 0px;"></div><div class="line-number" data-start="2" style="top: 19px;"></div><div class="line-number" data-start="3" style="top: 38px;"></div><div class="line-number" data-start="4" style="top: 57px;"></div><div class="line-number" data-start="5" style="top: 76px;"></div><div class="line-number" data-start="6" style ="top: 95px;"></div><div class="line-number" data-start="7" style="top: 114px;"></div><div class="line-number" data-start="8" style="top: 133px;"></div><div class="line-number" data-start= "9" style="top: 152px;"></div><div class="line-number" data-start="10" style="top: 171px;"></div><div class="line-number" data-start="11" style="top: 190px;"></div><div class="line-number" data-start="12" style="top: 209px;"></div><div class="line-number" data-start="13" style="top: 228px;"></div><div class="line-number" data-start="14" style="top: 247px;"></div><div class= "line-number" data-start="15" style="top: 266px;"></div><div class="line-number" data-start="16" style="top: 285px;"></div></code></pre><p>There's something here we haven't seen before: the <code><a href="/en-US/docs/Web/JavaScript/Reference/Operators/this" title="/en/JavaScript/Reference/Operators/this">this</a></code> keyword. Used inside a function, <code>this</code> refers to the current object. What that actually means is specified by the way in which you called that function. If you called it using <a href= "/en-US/docs/Web/JavaScript/Reference/Operators/Object_initializer#Accessing_properties" title="/en/JavaScript/Reference/Operators/Member_Operators">dot notation or bracket notation</a> on an object, that object becomes <code>this</code>. If dot notation wasn't used for the call, <code>this</code> refers to the global object.</p><p>Note that <code>this</code> is a frequent cause of mistakes. For example:</p><pre class="brush: js  language-js" data-number=""><code class=" language-js">s <span class="token operator">=</span> <span class="token function">makePerson<span class="token punctuation">(</span></span><span class="token string">"Simon"</span><span class="token punctuation">,</span> <span class="token string">"Willison" </span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">var</span> fullName <span class="token operator">=</span> s<span class= "token punctuation">.</span>fullName<span class="token punctuation">;</span><span class="token function">fullName<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true"> // undefined undefined</span><div class="line-number" data-start="1" style= "top: 0px;"></div><div class="line-number" data-start="2" style="top: 19px;"></div><div class="line-number" data-start="3" style="top: 38px;"></div></code></pre><p>When we call <code> fullName()</code> alone, without using <code>s.fullName()</code>, <code>this</code> is bound to the global object. Since there are no global variables called <code>first</code> or <code> last</code> we get <code>undefined</code> for each one.</p><p>We can take advantage of the <code>this</code> keyword to improve our <code>makePerson</code> function:</p><pre class="brush: js  language-js" data-number=""><code class=" language-js"><span class="token keyword">function</span> <span class="token function">Person<span class="token punctuation">(</span></span> first<span class="token punctuation">,</span> last<span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token keyword">this</span><span class= "token punctuation">.</span>first <span class="token operator">=</span> first<span class="token punctuation">;</span>  <span class="token keyword">this</span><span class="token punctuation">.</span>last <span class="token operator">=</span> last<span class="token punctuation">;</span>  <span class="token keyword">this</span><span class="token punctuation">. </span>fullName <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>first <span class="token operator">+</span> <span class="token string">' '</span> <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>last<span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">;</span>  <span class="token keyword">this</span><span class="token punctuation" >.</span>fullNameReversed <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>last <span class= "token operator">+</span> <span class="token string">', '</span> <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>first <span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">var</span> s <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token string">"Simon"</span><span class="token punctuation">,</span> <span class="token string">"Willison"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><div class="line-number" data-start="1" style="top: 0px;"></div><div class="line-number" data-start="2" style="top: 19px;"></div><div class="line-number" data-start= "3" style="top: 38px;"></div><div class="line-number" data-start="4" style="top: 57px;"></div><div class="line-number" data-start="5" style="top: 76px;"></div><div class="line-number" data-start="6" style="top: 95px;"></div><div class="line-number" data-start="7" style="top: 114px;"></div><div class="line-number" data-start="8" style="top: 133px;"></div><div class= "line-number" data-start="9" style="top: 152px;"></div><div class="line-number" data-start="10" style="top: 171px;"></div><div class="line-number" data-start="11" style="top: 190px;" ></div></code></pre><p>We have introduced another keyword: <code><a href="/en-US/docs/Web/JavaScript/Reference/Operators/new" title="/en/JavaScript/Reference/Operators/new">new</a></code> . <code>new</code> is strongly related to <code>this</code>. It creates a brand new empty object, and then calls the function specified, with <code>this</code> set to that new object. Notice though that the function specified with <code>this</code> does not return a value but merely modifies the <code>this</code> object. It's <code><code> </code>new</code> that returns the <code>this</code> object to the calling site. Functions that are designed to be called by <code>new</code> are called constructor functions. Common practice is to capitalize these functions as a reminder to call them with <code>new</code>.</p><p>The improved function still has the same pitfall with calling <code>fullName()</code> alone.</p><p>Our person objects are getting better, but there are still some ugly edges to them. Every time we create a person object we are creating two brand new function objects within it - wouldn't it be better if this code was shared?</p><pre class="brush: js  language-js" data-number=""><code class=" language-js"><span class="token keyword">function</span> <span class="token function">personFullName <span class="token punctuation">(</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token keyword">return</span> <span class= "token keyword">this</span><span class="token punctuation">.</span>first <span class="token operator">+</span> <span class="token string">' '</span> <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>last<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">function</span> <span class="token function">personFullNameReversed<span class="token punctuation">(</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>last <span class="token operator">+</span> <span class="token string">', '</span> <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>first<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">function</span> <span class="token function">Person<span class="token punctuation">(</span></span> first<span class="token punctuation">,</span> last<span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token keyword">this</span><span class= "token punctuation">.</span>first <span class="token operator">=</span> first<span class="token punctuation">;</span>  <span class="token keyword">this</span><span class="token punctuation">.</span>last <span class="token operator">=</span> last<span class="token punctuation">;</span>  <span class="token keyword">this</span><span class="token punctuation">. </span>fullName <span class="token operator">=</span> personFullName<span class="token punctuation">;</span>  <span class="token keyword">this</span><span class="token punctuation">. </span>fullNameReversed <span class="token operator">=</span> personFullNameReversed<span class="token punctuation">;</span><span class="token punctuation">}</span><div class="line-number" data-start="1" style="top: 0px;"></div><div class="line-number" data-start="2" style="top: 19px;"></div><div class="line-number" data-start="3" style="top: 38px;"></div><div class= "line-number" data-start="4" style="top: 57px;"></div><div class="line-number" data-start="5" style="top: 76px;"></div><div class="line-number" data-start="6" style="top: 95px;"></div><div class="line-number" data-start="7" style="top: 114px;"></div><div class="line-number" data-start="8" style="top: 133px;"></div><div class="line-number" data-start="9" style="top: 152px;" ></div><div class="line-number" data-start="10" style="top: 171px;"></div><div class="line-number" data-start="11" style="top: 190px;"></div><div class="line-number" data-start="12" style= "top: 209px;"></div></code></pre><p>That's better: we are creating the method functions only once, and assigning references to them inside the constructor. Can we do any better than that? The answer is yes:</p><pre class="brush: js  language-js" data-number=""><code class=" language-js"><span class="token keyword">function</span> <span class="token function">Person<span class="token punctuation">(</span></span>first<span class="token punctuation">,</span> last<span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class= "token keyword">this</span><span class="token punctuation">.</span>first <span class="token operator">=</span> first<span class="token punctuation">;</span>  <span class="token keyword"> this</span><span class="token punctuation">.</span>last <span class="token operator">=</span> last<span class="token punctuation">;</span><span class="token punctuation">}</span>Person <span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>fullName <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token function">fullName<span class="token punctuation">(</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token keyword" >return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>first <span class="token operator">+</span> <span class="token string">' '</span> <span class= "token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>last<span class="token punctuation">;</span><span class="token punctuation">} </span><span class="token punctuation">;</span>Person<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>fullNameReversed <span class="token operator"> =</span> <span class="token keyword">function</span> <span class="token function">fullNameReversed<span class="token punctuation">(</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>last <span class="token operator">+</span> <span class="token string">', '</span> <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>first<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">;</span><div class="line-number" data-start="1" style="top: 0px;"></div><div class ="line-number" data-start="2" style="top: 19px;"></div><div class="line-number" data-start="3" style="top: 38px;"></div><div class="line-number" data-start="4" style="top: 57px;" ></div><div class="line-number" data-start="5" style="top: 76px;"></div><div class="line-number" data-start="6" style="top: 95px;"></div><div class="line-number" data-start="7" style= "top: 114px;"></div><div class="line-number" data-start="8" style="top: 133px;"></div><div class="line-number" data-start="9" style="top: 152px;"></div><div class="line-number" data-start= "10" style="top: 171px;"></div></code></pre><p><code>Person.prototype</code> is an object shared by all instances of <code>Person</code>. It forms part of a lookup chain (that has a special name, "prototype chain"): any time you attempt to access a property of <code>Person</code> that isn't set, JavaScript will check <code>Person.prototype</code> to see if that property exists there instead. As a result, anything assigned to <code>Person.prototype</code> becomes available to all instances of that constructor via the <code>this</code> object. </p><p>This is an incredibly powerful tool. JavaScript lets you modify something's prototype at any time in your program, which means you can add extra methods to existing objects at runtime:</p><pre class="brush: js  language-js" data-number=""><code class=" language-js">s <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token string">"Simon"</span><span class="token punctuation">,</span> <span class="token string">"Willison" </span><span class="token punctuation">)</span><span class="token punctuation">;</span>s<span class="token punctuation">.</span><span class="token function">firstNameCaps<span class= "token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true"> // TypeError on line 1: s.firstNameCaps is not a function</span>Person<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>firstNameCaps <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token function">firstNameCaps<span class="token punctuation">(</span></span><span class="token punctuation">)</span> <span class= "token punctuation">{</span>  <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>first<span class="token punctuation"> .</span><span class="token function">toUpperCase<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class= "token punctuation">;</span>s<span class="token punctuation">.</span><span class="token function">firstNameCaps<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true"> // "SIMON"</span><div class="line-number" data-start="1" style="top: 0px;" ></div><div class="line-number" data-start="2" style="top: 19px;"></div><div class="line-number" data-start="3" style="top: 38px;"></div><div class="line-number" data-start="4" style= "top: 57px;"></div><div class="line-number" data-start="5" style="top: 76px;"></div><div class="line-number" data-start="6" style="top: 95px;"></div><div class="line-number" data-start="7" style="top: 114px;"></div></code></pre><p>Interestingly, you can also add things to the prototype of built-in JavaScript objects. Let's add a method to <code>String</code> that returns that string in reverse:</p><pre class="brush: js  language-js" data-number=""><code class=" language-js"><span class="token keyword">var</span> s <span class="token operator">=</span> <span class="token string">"Simon"</span><span class="token punctuation">;</span>s<span class="token punctuation">.</span><span class="token function">reversed<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true"> // TypeError on line 1: s.reversed is not a function</span>String<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>reversed <span class="token operator">=</span> <span class ="token keyword">function</span> <span class="token function">reversed<span class="token punctuation">(</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token keyword">var</span> r <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token keyword">this </span><span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class= "token operator">&gt;=</span> <span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">--</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    r <span class="token operator">+</span><span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span>  <span class="token keyword">return</span> r<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">;</span>s<span class="token punctuation">.</span><span class="token function">reversed<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck= "true"> // nomiS</span><div class="line-number" data-start="1" style="top: 0px;"></div><div class="line-number" data-start="2" style="top: 19px;"></div><div class="line-number" data-start= "3" style="top: 38px;"></div><div class="line-number" data-start="4" style="top: 57px;"></div><div class="line-number" data-start="5" style="top: 76px;"></div><div class="line-number" data-start="6" style="top: 95px;"></div><div class="line-number" data-start="7" style="top: 114px;"></div><div class="line-number" data-start="8" style="top: 133px;"></div><div class= "line-number" data-start="9" style="top: 152px;"></div><div class="line-number" data-start="10" style="top: 171px;"></div><div class="line-number" data-start="11" style="top: 190px;" ></div><div class="line-number" data-start="12" style="top: 209px;"></div></code></pre><p>Our new method even works on string literals!</p><pre class="brush: js  language-js" data-number= ""><code class=" language-js"><span class="token string">"This can now be reversed"</span><span class="token punctuation">.</span><span class="token function">reversed<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true"> // desrever eb won nac sihT </span><div class="line-number" data-start="1" style="top: 0px;"></div></code></pre><p>As I mentioned before, the prototype forms part of a chain. The root of that chain is <code> Object.prototype</code>, whose methods include <code>toString()</code> - it is this method that is called when you try to represent an object as a string. This is useful for debugging our <code>Person</code> objects:</p><pre class="brush: js  language-js" data-number=""><code class=" language-js"><span class="token keyword">var</span> s <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token string">"Simon"</span><span class="token punctuation">,</span> <span class="token string">"Willison"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>s<span class="token punctuation">; </span><span class="token comment" spellcheck="true"> // [object Object]</span>Person<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>toString <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation" >{</span>  <span class="token keyword">return</span> <span class="token string">'&lt;Person: '</span> <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">fullName<span class="token punctuation">(</span></span><span class="token punctuation">)</span> <span class="token operator"> +</span> <span class="token string">'&gt;'</span><span class="token punctuation">;</span><span class="token punctuation">}</span>s<span class="token punctuation">.</span><span class= "token function">toString<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true"> // "&lt;Person: Simon Willison&gt;"</span><div class="line-number" data-start="1" style="top: 0px;"></div><div class="line-number" data-start="2" style="top: 19px;" ></div><div class="line-number" data-start="3" style="top: 38px;"></div><div class="line-number" data-start="4" style="top: 57px;"></div><div class="line-number" data-start="5" style= "top: 76px;"></div><div class="line-number" data-start="6" style="top: 95px;"></div><div class="line-number" data-start="7" style="top: 114px;"></div><div class="line-number" data-start= "8" style="top: 133px;"></div></code></pre><p>Remember how <code>avg.apply()</code> had a null first argument? We can revisit that now. The first argument to <code>apply()</code> is the object that should be treated as '<code>this</code>'. For example, here's a trivial implementation of <code>new</code>:</p><pre class="brush: js  language-js" data-number=""><code class=" language-js"><span class="token keyword">function</span> <span class="token function">trivialNew<span class="token punctuation">(</span></span>constructor<span class="token punctuation">, </span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>args<span class="token punctuation">)</span> <span class= "token punctuation">{</span>  <span class="token keyword">var</span> o <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">} </span><span class="token punctuation">;</span><span class="token comment" spellcheck="true"> // Create an object</span>  constructor<span class="token punctuation">.</span><span class= "token function">apply<span class="token punctuation">(</span></span>o<span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">; </span>  <span class="token keyword">return</span> o<span class="token punctuation">;</span><span class="token punctuation">}</span><div class="line-number" data-start="1" style="top: 0px;"></div><div class="line-number" data-start="2" style="top: 19px;"></div><div class="line-number" data-start="3" style="top: 38px;"></div><div class="line-number" data-start="4" style= "top: 57px;"></div><div class="line-number" data-start="5" style="top: 76px;"></div></code></pre><p>This isn't an exact replica of <code>new</code> as it doesn't set up the prototype chain (it would be difficult to illustrate). This is not something you use very often, but it's useful to know about. In this snippet, <code>...args</code> (including the ellipsis) is called the "<a href="/en-US/docs/Web/JavaScript/Reference/Functions/rest_parameters">rest arguments</a>" - as the name implies, this contains the rest of the arguments.</p><p>Calling </p><pre class="brush: js  language-js" data-number=""><code class=" language-js"><span class="token keyword">var</span> bill <span class="token operator">=</span> <span class="token function">trivialNew<span class="token punctuation">(</span></span>Person<span class="token punctuation">,</span> <span class="token string">"William"</span><span class="token punctuation" >,</span> <span class="token string">"Orange"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><div class="line-number" data-start="1" style="top: 0px;"></div></code></pre><p>is therefore almost equivalent to</p><pre class="brush: js  language-js" data-number=""><code class=" language-js"><span class="token keyword">var</span> bill <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token string"> "William"</span><span class="token punctuation">,</span> <span class="token string">"Orange"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><div class="line-number" data-start="1" style="top: 0px;"></div></code></pre><p><code>apply()</code> has a sister function named <a href= "/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function/call" title="/en/JavaScript/Reference/Global_Objects/Function/call"><code>call</code></a>, which again lets you set <code>this </code> but takes an expanded argument list as opposed to an array.</p><pre class="brush: js  language-js" data-number=""><code class=" language-js"><span class="token keyword">function </span> <span class="token function">lastNameCaps<span class="token punctuation">(</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>last<span class="token punctuation">.</span><span class="token function"> toUpperCase<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">var</span> s <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation"> (</span><span class="token string">"Simon"</span><span class="token punctuation">,</span> <span class="token string">"Willison"</span><span class="token punctuation">)</span><span class= "token punctuation">;</span>lastNameCaps<span class="token punctuation">.</span><span class="token function">call<span class="token punctuation">(</span></span>s<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// Is the same as:</span>s<span class="token punctuation">.</span>lastNameCaps <span class="token operator">=</span> lastNameCaps<span class="token punctuation">;</span>s<span class="token punctuation">.</span><span class="token function">lastNameCaps<span class= "token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span><div class="line-number" data-start="1" style="top: 0px;"></div><div class="line-number" data-start="2" style="top: 19px;"></div><div class="line-number" data-start="3" style="top: 38px;"></div><div class="line-number" data-start="4" style="top: 57px;" ></div><div class="line-number" data-start="5" style="top: 76px;"></div><div class="line-number" data-start="6" style="top: 95px;"></div><div class="line-number" data-start="7" style= "top: 114px;"></div><div class="line-number" data-start="8" style="top: 133px;"></div></code></pre><h3 id="Inner_functions">Inner functions</h3><p>JavaScript function declarations are allowed inside other functions. We've seen this once before, with an earlier <code>makePerson()</code> function. An important detail of nested functions in JavaScript is that they can access variables in their parent function's scope:</p><pre class="brush: js  language-js" data-number=""><code class=" language-js"><span class="token keyword">function</span> <span class= "token function">betterExampleNeeded<span class="token punctuation">(</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>  <span class="token keyword">function</span> <span class="token function">oneMoreThanA<span class="token punctuation">(</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">return</span> a <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span>  <span class="token keyword">return</span> <span class="token function">oneMoreThanA<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><div class="line-number" data-start="1" style="top: 0px;"></div><div class="line-number" data-start="2" style="top: 19px;" ></div><div class="line-number" data-start="3" style="top: 38px;"></div><div class="line-number" data-start="4" style="top: 57px;"></div><div class="line-number" data-start="5" style= "top: 76px;"></div><div class="line-number" data-start="6" style="top: 95px;"></div><div class="line-number" data-start="7" style="top: 114px;"></div></code></pre><p>This provides a great deal of utility in writing more maintainable code. If a function relies on one or two other functions that are not useful to any other part of your code, you can nest those utility functions inside the function that will be called from elsewhere. This keeps the number of functions that are in the global scope down, which is always a good thing.</p><p>This is also a great counter to the lure of global variables. When writing complex code it is often tempting to use global variables to share values between multiple functions - which leads to code that is hard to maintain. Nested functions can share variables in their parent, so you can use that mechanism to couple functions together when it makes sense without polluting your global namespace - 'local globals' if you like. This technique should be used with caution, but it's a useful ability to have.</p><h2 id="Closures">Closures</h2><p>This leads us to one of the most powerful abstractions that JavaScript has to offer - but also the most potentially confusing. What does this do?</p><pre class="brush: js  language-js" data-number=""><code class=" language-js"><span class="token keyword">function</span> <span class="token function">makeAdder<span class="token punctuation">(</span></span>a<span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token keyword">return</span> <span class="token keyword">function</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">return</span> a <span class="token operator">+</span> b<span class="token punctuation">; </span>  <span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">var</span> x <span class= "token operator">=</span> <span class="token function">makeAdder<span class="token punctuation">(</span></span><span class="token number">5</span><span class="token punctuation">) </span><span class="token punctuation">;</span><span class="token keyword">var</span> y <span class="token operator">=</span> <span class="token function">makeAdder<span class="token punctuation">(</span></span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">x<span class= "token punctuation">(</span></span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck ="true"> // ?</span><span class="token function">y<span class="token punctuation">(</span></span><span class="token number">7</span><span class="token punctuation">)</span><span class= "token punctuation">;</span><span class="token comment" spellcheck="true"> // ?</span><div class="line-number" data-start="1" style="top: 0px;"></div><div class="line-number" data-start= "2" style="top: 19px;"></div><div class="line-number" data-start="3" style="top: 38px;"></div><div class="line-number" data-start="4" style="top: 57px;"></div><div class="line-number" data-start="5" style="top: 76px;"></div><div class="line-number" data-start="6" style="top: 95px;"></div><div class="line-number" data-start="7" style="top: 114px;"></div><div class= "line-number" data-start="8" style="top: 133px;"></div><div class="line-number" data-start="9" style="top: 152px;"></div></code></pre><p>The name of the <code>makeAdder</code> function should give it away: it creates a new 'adder' functions, which when called with one argument adds it to the argument that they were created with.</p><p>What's happening here is pretty much the same as was happening with the inner functions earlier on: a function defined inside another function has access to the outer function's variables. The only difference here is that the outer function has returned, and hence common sense would seem to dictate that its local variables no longer exist. But they <em>do</em> still exist - otherwise the adder functions would be unable to work. What's more, there are two different "copies" of <code>makeAdder</code>'s local variables - one in which <code>a</code> is 5 and one in which <code>a </code> is 20. So the result of those function calls is as follows:</p><pre class="brush: js  language-js" data-number=""><code class=" language-js"><span class="token function">x<span class="token punctuation">(</span></span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true"> // returns 11</span><span class="token function">y<span class="token punctuation">(</span></span><span class="token number">7</span><span class="token punctuation">) </span><span class="token punctuation">;</span><span class="token comment" spellcheck="true"> // returns 27</span><div class="line-number" data-start="1" style="top: 0px;"></div><div class ="line-number" data-start="2" style="top: 19px;"></div></code></pre><p>Here's what's actually happening. Whenever JavaScript executes a function, a 'scope' object is created to hold the local variables created within that function. It is initialised with any variables passed in as function parameters. This is similar to the global object that all global variables and functions live in, but with a couple of important differences: firstly, a brand new scope object is created every time a function starts executing, and secondly, unlike the global object (which is accessible as <code>this</code> and in browsers as <code>window</code>) these scope objects cannot be directly accessed from your JavaScript code. There is no mechanism for iterating over the properties of the current scope object, for example.</p><p>So when <code>makeAdder</code> is called, a scope object is created with one property: <code>a</code>, which is the argument passed to the <code>makeAdder</code> function. <code>makeAdder</code> then returns a newly created function. Normally JavaScript's garbage collector would clean up the scope object created for <code>makeAdder</code> at this point, but the returned function maintains a reference back to that scope object. As a result, the scope object will not be garbage collected until there are no more references to the function object that <code>makeAdder</code> returned.</p><p>Scope objects form a chain called the scope chain, similar to the prototype chain used by JavaScript's object system.</p><p>A <strong>closure</strong> is the combination of a function and the scope object in which it was created.</p><p>Closures let you save state - as such, they can often be used in place of objects. You can find <a href="http://stackoverflow.com/questions/111102/how-do-javascript-closures-work" class="external external-icon"> several excellent introductions to closures</a>.</p><h3 id="Memory_leaks">Memory leaks</h3><p>An unfortunate side effect of closures is that they make it trivially easy to leak memory in Internet Explorer. JavaScript is a garbage collected language - objects are allocated memory upon their creation and that memory is reclaimed by the browser when no references to an object remain. Objects provided by the host environment are handled by that environment.</p><p>Browser hosts need to manage a large number of objects representing the HTML page being presented - the objects of the DOM. It is up to the browser to manage the allocation and recovery of these.</p><p>Internet Explorer uses its own garbage collection scheme for this, separate from the mechanism used for JavaScript. It is the interaction between the two that can cause memory leaks.</p><p>A memory leak in IE occurs any time a circular reference is formed between a JavaScript object and a native object. Consider the following:</p><pre class="example-bad brush: js  language-js" data-number=""><code class=" language-js"><span class= "token keyword">function</span> <span class="token function">leakMemory<span class="token punctuation">(</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token keyword">var</span> el <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function"> getElementById<span class="token punctuation">(</span></span><span class="token string">'el'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">var</span> o <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token string">'el'</span><span class="token punctuation">: </span> el <span class="token punctuation">}</span><span class="token punctuation">;</span>  el<span class="token punctuation">.</span>o <span class="token operator">=</span> o<span class= "token punctuation">;</span><span class="token punctuation">}</span><div class="line-number" data-start="1" style="top: 0px;"></div><div class="line-number" data-start="2" style="top: 19px;"></div><div class="line-number" data-start="3" style="top: 38px;"></div><div class="line-number" data-start="4" style="top: 57px;"></div><div class="line-number" data-start="5" style ="top: 76px;"></div></code></pre><p>The circular reference formed above creates a memory leak; IE will not free the memory used by <code>el</code> and <code>o</code> until the browser is completely restarted.</p><p>The above case is likely to go unnoticed; memory leaks only become a real concern in long running applications or applications that leak large amounts of memory due to large data structures or leak patterns within loops.</p><p>Leaks are rarely this obvious - often the leaked data structure can have many layers of references, obscuring the circular reference.</p><p>Closures make it easy to create a memory leak without meaning to. Consider this:</p><pre class="example-bad brush: js  language-js" data-number=""><code class=" language-js"><span class="token keyword">function</span> <span class="token function">addHandler<span class="token punctuation">(</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token keyword">var</span> el <span class="token operator">=</span> document<span class="token punctuation">.</span><span class= "token function">getElementById<span class="token punctuation">(</span></span><span class="token string">'el'</span><span class="token punctuation">)</span><span class="token punctuation"> ;</span>  el<span class="token punctuation">.</span>onclick <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    el<span class="token punctuation">.</span>style<span class="token punctuation">.</span>backgroundColor <span class="token operator">=</span> <span class="token string">'red'</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">; </span><span class="token punctuation">}</span><div class="line-number" data-start="1" style="top: 0px;"></div><div class="line-number" data-start="2" style="top: 19px;"></div><div class= "line-number" data-start="3" style="top: 38px;"></div><div class="line-number" data-start="4" style="top: 57px;"></div><div class="line-number" data-start="5" style="top: 76px;"></div><div class="line-number" data-start="6" style="top: 95px;"></div></code></pre><p>The above code sets up the element to turn red when it is clicked. It also creates a memory leak. Why? Because the reference to <code>el</code> is inadvertently caught in the closure created for the anonymous inner function. This creates a circular reference between a JavaScript object (the function) and a native object (<code>el</code>).</p><p>There are a number of workarounds for this problem. The simplest is not to use the <code>el</code> variable:</p><pre class= "example-good brush: js  language-js" data-number=""><code class=" language-js"><span class="token keyword">function</span> <span class="token function">addHandler<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">{</span>  document<span class="token punctuation">.</span><span class="token function"> getElementById<span class="token punctuation">(</span></span><span class="token string">'el'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>onclick <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">this</span><span class="token punctuation">.</span>style<span class="token punctuation">.</span>backgroundColor <span class="token operator">=</span> <span class="token string">'red'</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token punctuation">}</span><div class="line-number" data-start="1" style="top: 0px;"></div><div class="line-number" data-start="2" style="top: 19px;"></div><div class="line-number" data-start="3" style="top: 38px;"></div><div class="line-number" data-start="4" style="top: 57px;"></div><div class="line-number" data-start="5" style="top: 76px;"></div></code></pre><p> Surprisingly, one trick for breaking circular references introduced by a closure is to add another closure:</p><pre class="brush: js  language-js" data-number=""><code class=" language-js" ><span class="token keyword">function</span> <span class="token function">addHandler<span class="token punctuation">(</span></span><span class="token punctuation">)</span> <span class= "token punctuation">{</span>  <span class="token keyword">var</span> clickHandler <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">this</span><span class="token punctuation">.</span> style<span class="token punctuation">.</span>backgroundColor <span class="token operator">=</span> <span class="token string">'red'</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">;</span>  <span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">var</span> el <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById<span class="token punctuation">(</span></span><span class="token string">'el'</span><span class= "token punctuation">)</span><span class="token punctuation">;</span>    el<span class="token punctuation">.</span>onclick <span class="token operator">=</span> clickHandler<span class= "token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">) </span><span class="token punctuation">;</span><span class="token punctuation">}</span><div class="line-number" data-start="1" style="top: 0px;"></div><div class="line-number" data-start= "2" style="top: 19px;"></div><div class="line-number" data-start="3" style="top: 38px;"></div><div class="line-number" data-start="4" style="top: 57px;"></div><div class="line-number" data-start="5" style="top: 76px;"></div><div class="line-number" data-start="6" style="top: 95px;"></div><div class="line-number" data-start="7" style="top: 114px;"></div><div class= "line-number" data-start="8" style="top: 133px;"></div><div class="line-number" data-start="9" style="top: 152px;"></div></code></pre><p>The inner function is executed straight away, and hides its contents from the closure created with <code>clickHandler</code>.</p><p>Another good trick for avoiding closures is breaking circular references during the <code>window.onunload </code> event. Many event libraries will do this for you. Note that doing so disables the <a href="/en-US/docs/Working_with_BFCache" title="En/Using_Firefox_1.5_caching">back-forward cache in Firefox</a>, so you should not register an <code>unload</code> listener in Firefox, unless you have other reasons to do so.</p> </article>			</div>		<!--=========================			END : POST		=============================-->		<!--=========================			START : POST =============================-->		<div class="post-wrapper">		<article class="post"><header><h2 class="title">Different Ways of Defining Functions in JavaScript (This Is Madness!)</h2><div class="meta date"><time datetime="2011-06-24T00:00:00-07:00" pubdate="" data-updated="true">Jun 24<span>th</span>, 2011</time></div></header><div class="entry-content" ><h3 id="this-is-madness-this8230-is8230-javascript">This is madness! This… is… JavaScript!</h3><p>In JavaScript, there's many different ways of doing something. This is both a good thing and a bad thing. To the newcomer this is definitely a bad thing, as it means not only more things to learn, but more little caveats and more places to go wrong. And so it is with declaring functions!</p><p>The aim of this is just an accessible tour of the landscape, just so you know what's out there and what the basic differences are. Do be sure to check out the "further reading" section as well! Much of this is based on <a href="http://kangax.github.com/nfe/">Juriy "kangax" Zaytsev's article</a>, which goes into more depth. But I found that there wasn't just one reference to show all the different variable declarations.</p><p>How about ways to execute functions? That opens up another can of worms, and incidentally opens up the possibility for a future post on that topic. :)</p><h3 id="overview-different-ways-of-declaring-functions">Overview: different ways of declaring functions</h3><div><table class= "CodeRay"><tbody><tr><td class="line-numbers"><pre><a href="#n1" name="n1">1</a><a href="#n2" name="n2">2</a><a href="#n3" name="n3">3</a><a href="#n4" name="n4">4</a><a href="#n5" name= "n5">5</a><a href="#n6" name="n6">6</a><a href="#n7" name="n7">7</a><a href="#n8" name="n8">8</a><a href="#n9" name="n9">9</a></pre></td><td class="code"><pre><span class="keyword"> function</span> <span class="function">A</span>(){};             <span class="comment">// function declaration</span><span class="keyword">var</span> <span class="function">B</span> = <span class="keyword">function</span>(){};       <span class="comment">// function expression</span><span class="keyword">var</span> C = (<span class="keyword">function</span>(){}); <span class="comment">// function expression with grouping operators</span><span class="keyword">var</span> <span class="function">D</span> = <span class="keyword">function</span> <span class="function">foo</span>(){};   <span class="comment">// named function expression</span><span class="keyword">var</span> E = (<span class="keyword">function</span>(){        <span class="comment">// immediately-invoked function expression (IIFE) that returns a function</span>  <span class="keyword">return</span> <span class="keyword">function</span>(){}})();<span class="keyword">var</span> F = <span class="keyword">new</span> Function();     <span class="comment">// Function constructor</span><span class="keyword">var</span> G = <span class= "keyword">new</span> <span class="keyword">function</span>(){};   <span class="comment">// special case: object constructor</span></pre></td></tr></tbody></table></div><h3 id= "function-declarations-function-a">Function declarations: function A(){};</h3><p>Function declarations are probably the most familiar and oldest way of doing things in JavaScript land. This creates a variable A which is accessible in the current scope. Scope is a separate topic, so well do everything in the global scope for all these examples (something you want to avoid usually).</p><h4 id="hoisting">1. Hoisting</h4><p>The interesting thing about these is that they are "hoisted" to the top of their scope, which means this code:</p><div><table class= "CodeRay"><tbody><tr><td class="line-numbers"><pre><a href="#n1" name="n1">1</a><a href="#n2" name="n2">2</a><a href="#n3" name="n3">3</a><a href="#n4" name="n4">4</a></pre></td><td class= "code"><pre>A();<span class="keyword">function</span> <span class="function">A</span>(){  console.log(<span class="string"><span class="delimiter">'</span><span class="content">foo </span><span class="delimiter">'</span></span>);};</pre></td></tr></tbody></table></div><p>Gets executed as this code:</p><div><table class="CodeRay"><tbody><tr><td class="line-numbers" ><pre><a href="#n1" name="n1">1</a><a href="#n2" name="n2">2</a><a href="#n3" name="n3">3</a><a href="#n4" name="n4">4</a></pre></td><td class="code"><pre><span class="keyword">function </span> <span class="function">A</span>(){  console.log(<span class="string"><span class="delimiter">'</span><span class="content">foo</span><span class="delimiter">'</span></span>);};A(); </pre></td></tr></tbody></table></div><p>Which practically means that, yes, you can call the functions before they're written in your code. It won't matter, because the entire function gets hoisted to the top of its containing scope. (This is contrasted with variables, which only have their declaration hoisted, not their contents, as we'll see in the next section). </p><h4 id="no-function-declarations-in-if-statements-or-loops-etch4">2. No function declarations in <code>if</code> statements (or loops, etc)&lt;/h4&gt;</h4><p>You can't define functions this way in expressions, for example <code>if</code> statements, which is common if we want to define different versions of a function for different circumstances, usually to address browser inconsistencies. Well, you <em>can</em> in some implementations, but the way the code is processed is inconsistent (kangax has documented the inconsistencies <a href=" http://kangax.github.com/nfe/">here</a>). If you want to use this pattern, use function expressions instead.</p><h4 id="functions-declarations-must-have-names">3. Functions declarations must have names</h4><p>This method doesn't allow you to create anonymous functions, meaning that you always have to give it an identifier (in this case we've used "A").</p><h3 id= "function-expressions-var-b--function">Function expressions: var B = function(){};</h3><p>A function expression looks similar to function declarations, except that the function is assigned to a variable name. Though functions are not primitive values in JavaScript, this is the way they can be utilized to their full effect in this functional language. Functions are " <a href="http://en.wikipedia.org/wiki/First-class_function">first class</a>":</p><blockquote><p>"[JavaScript] supports passing functions as arguments to other functions, returning them as the values from other functions, and assigning them to variables or storing them in data structures"</p></blockquote><h4 id="anonymous-functions-they-dont-need-names">1. Anonymous functions (they don't need names)</h4><p>The function name is optional in function expressions, and we call these anonymous. Here we're setting the variable B equal to an anonymous function:</p><div><table class="CodeRay"><tbody><tr><td class="line-numbers"><pre><a href="#n1" name="n1">1</a></pre></td><td class="code"><pre><span class="keyword">var</span> <span class ="function">B</span> = <span class="keyword">function</span>(){};</pre></td></tr></tbody></table></div><h4 id="variable-declaration-hoisting">2. Variable declaration hoisting</h4><p> Variable declarations are hoisted to the top of their scope, somewhat similarly to function hoisting <em>except</em> the contents of the variable are not hoisted as well. This happens with all variables, and it means it's now happening with our functions, now that we're assigning them to variables.</p><p>This code:</p><div><table class="CodeRay"><tbody><tr><td class= "line-numbers"><pre><a href="#n1" name="n1">1</a><a href="#n2" name="n2">2</a><a href="#n3" name="n3">3</a></pre></td><td class="code"><pre><span class="keyword">var</span> <span class= "function">A</span> = <span class="keyword">function</span>(){};<span class="keyword">var</span> <span class="function">B</span> = <span class="keyword">function</span>(){};<span class= "keyword">var</span> <span class="function">C</span> = <span class="keyword">function</span>(){};</pre></td></tr></tbody></table></div><p>Will be executed as this:</p><div><table class= "CodeRay"><tbody><tr><td class="line-numbers"><pre><a href="#n1" name="n1">1</a><a href="#n2" name="n2">2</a><a href="#n3" name="n3">3</a><a href="#n4" name="n4">4</a></pre></td><td class= "code"><pre><span class="keyword">var</span> A, B, C;  <span class="comment">// variable declarations are hoisted</span><span class="function">A</span> = <span class="keyword">function </span>(){};<span class="function">B</span> = <span class="keyword">function</span>(){};<span class="function">C</span> = <span class="keyword">function</span>(){}; </pre></td></tr></tbody></table></div><p>Therefore the order of setting and calling this type of function is important:</p><div><table class="CodeRay"><tbody><tr><td class="line-numbers" ><pre><a href="#n1" name="n1">1</a><a href="#n2" name="n2">2</a><a href="#n3" name="n3">3</a><a href="#n4" name="n4">4</a><a href="#n5" name="n5">5</a><a href="#n6" name="n6">6</a><a href= "#n7" name="n7">7</a></pre></td><td class="code"><pre><span class="comment">// this works</span><span class="keyword">var</span> <span class="function">B</span> = <span class="keyword"> function</span>(){};B();<span class="comment">// this doesn't work</span>B2();  <span class="comment">// TypeError (B2 is undefined)</span><span class="keyword">var</span> <span class= "function">B2</span> = <span class="keyword">function</span>(){};</pre></td></tr></tbody></table></div><p>The second example gives us an error because only the variable B2's declaration is hoisted, but not its definition, thus the "undefined" error.</p><h3 id="function-expressions-with-grouping-operators-var-c--function">Function expressions with grouping operators: var C = (function(){});</h3><p>These really aren't different from plain old function expressions and aren't really seen in the wild (so maybe they're just good for JavaScript quizzes?). Recently this way of declaring functions was brought up in <a href="http://ironjs.wordpress.com/2011/06/22/my-gripes-with-javascript/">this article</a> and confused some folks including myself.</p><p>Here's a good way to see what's happening:</p><div><table class="CodeRay"><tbody><tr><td class="line-numbers"><pre><a href="#n1" name="n1">1</a><a href="#n2" name="n2">2 </a></pre></td><td class="code"><pre><span class="keyword">function</span>(){};  <span class="comment">// SyntaxError</span>(<span class="keyword">function</span>(){}); </pre></td></tr></tbody></table></div><p>Why does one work and the other doesn't? The first example is a function declaration, and we learned above that we can't declare them anonymously - that is, they must have a name. That's why we're getting the syntax error.</p><p>The second example is using parenthesis - grouping operators - and is therefore evaluated differently, as a function expression. The grouping operators are the things we use to help show what should be evaluated first, as in mathematical problems. We're saying "evaluate this first, then take the result and do something with it":</p><div><table class="CodeRay"><tbody><tr><td class="line-numbers"><pre><a href="#n1" name="n1">1</a><a href="#n2" name="n2">2</a></pre></td><td class="code"><pre>(<span class="integer">1</span> + <span class="integer">2</span>) * <span class="integer">3</span>;  <span class="comment">// 9</span><span class="integer">1</span> + ( <span class="integer">2</span> * <span class="integer">3</span>);  <span class="comment">// 7</span></pre></td></tr></tbody></table></div><p>In the first example we're saying "first add 1 and 2, then take the result and multiply by 3", whereas in the second example we're saying "first multiply 2 and 3, then take the result and add 1".</p><p>Because functions are first class, we can use similar grouping operators. Here's a facetious example, but it shows how we can essentially drop in a function in the same way:</p><div><table class="CodeRay" ><tbody><tr><td class="line-numbers"><pre><a href="#n1" name="n1">1</a></pre></td><td class="code"><pre>(<span class="keyword">function</span>(){} + <span class="integer">1</span>);  <span class="comment">// function(){}1</span></pre></td></tr></tbody></table></div><p>The result is a string (because toString is being called on the function, then added/appended with 1), but you get the idea I hope.</p><p>When the JavaScript engine encounters the opening parenthesis here, we're essentially saying "ok, start grouping this together with something else". Using our technical terms, we're telling the engine that we're not making a function declaration, but instead a function expression. And then we can assign the result to a variable: </p><div><table class="CodeRay"><tbody><tr><td class="line-numbers"><pre><a href="#n1" name="n1">1</a><a href="#n2" name="n2">2</a><a href="#n3" name="n3">3</a></pre></td><td class="code" ><pre>(<span class="keyword">function</span>(){});           <span class="comment">// resulting function not assigned</span><span class="keyword">var</span> foo = (<span class="keyword"> function</span>(){}); <span class="comment">// resulting function assigned to foo</span><span class="keyword">var</span> <span class="function">bar</span> = <span class="keyword">function </span>(){};   <span class="comment">// resulting function assigned to bar</span></pre></td></tr></tbody></table></div><p>Here we can see that foo and bar are really just the same, because in foo we're not grouping the function together with anything but itself.</p><h3 id="named-function-expression-var-d--function-foo">Named function expression: var D = function foo(){};</h3><p>Here we have our same old friend, the function expression. But instead of assigning the variable to an anonymous function, we're assigning it to a named function (with the name foo).</p><h4 id="the-function-name-is-only-accessible-within-the-function">1. The function name is only accessible within the function</h4><p>We haven't exposed the function name (foo) to the enclosing scope (in this case the global scope):</p><div><table class="CodeRay"><tbody><tr><td class="line-numbers"><pre><a href="#n1" name="n1">1</a><a href="#n2" name="n2">2 </a><a href="#n3" name="n3">3</a><a href="#n4" name="n4">4</a><a href="#n5" name="n5">5</a></pre></td><td class="code"><pre><span class="keyword">var</span> <span class="function">D</span> = <span class="keyword">function</span> <span class="function">foo</span>(){  console.log(<span class="keyword">typeof</span> foo);};D();                       <span class="comment">// function</span>console.log(<span class="keyword">typeof</span> foo);   <span class="comment">// undefined</span></pre></td></tr></tbody></table></div><h4 id="useful-for-recursion">2. Useful for recursion</h4><p>Because the function's name is accessible in the function itself, this turns out to be useful for recursive functions, much more useful than the plain old anonymous function.</p><p>Here's a trivial recursive function to illustrate calling itself from within the named function expression:</p><div><table class="CodeRay"><tbody><tr><td class= "line-numbers"><pre><a href="#n1" name="n1">1</a><a href="#n2" name="n2">2</a><a href="#n3" name="n3">3</a><a href="#n4" name="n4">4</a><a href="#n5" name="n5">5</a><a href="#n6" name="n6" >6</a><a href="#n7" name="n7">7</a><a href="#n8" name="n8">8</a></pre></td><td class="code"><pre><span class="keyword">var</span> <span class="function">countdown</span> = <span class= "keyword">function</span> <span class="function">a</span>(count){  <span class="keyword">if</span>(count &gt; <span class="integer">0</span>) {    count--;    <span class="keyword">return </span> a(count);  <span class="comment">// we can also do this: a(--count), which is less clear</span>  }  console.log(<span class="string"><span class="delimiter">'</span><span class= "content">end of recursive function</span><span class="delimiter">'</span></span>);}countdown(<span class="integer">5</span>);</pre></td></tr></tbody></table></div><h4 id= "useful-for-debugging">3. Useful for debugging</h4><p>As a <a href="http://kangax.github.com/nfe/">few</a> <a href=" http://javascriptweblog.wordpress.com/2010/07/06/function-declarations-vs-function-expressions/">have</a> pointed out, giving previously anonymous functions names helps in debugging, since the function name shows up on the call stack.</p><h4 id="quirks-jscripts-bad-implementation">4. Quirks: JScript's bad implementation</h4><p><a href="http://kangax.github.com/nfe/"> kangax</a> points out that named function expressions are basically poison to JScript, Internet Explorer's implementation of JavaScript.</p><p>The named function becomes a global variable, is hoisted like a function declaration, and actually ends up creating multiple instances of the same function.</p><h3 id= "immediately-invoked-function-expressions-iife-var-e--functionreturn-function">Immediately-invoked function expressions (IIFE): var E = (function(){return function(){}})();</h3><p> "Execute this function, whose return value is another function, and assign that to the variable E". This may seem like magic, but it's actually quite simple, and the pattern is powerful and has useful applications, the most famous of which is the <a href="http://www.klauskomenda.com/code/javascript-programming-patterns/#module">module pattern</a>.</p><p>First we'll use an example that doesn't look like magic:</p><div><table class="CodeRay"><tbody><tr><td class="line-numbers"><pre><a href="#n1" name="n1">1</a><a href="#n2" name="n2">2</a><a href="#n3" name="n3">3</a><a href="#n4" name="n4">4</a><a href="#n5" name="n5">5</a></pre></td><td class="code"><pre><span class="keyword">var</span> <span class="function">foo</span> = <span class= "keyword">function</span>(){  <span class="keyword">return</span> <span class="string"><span class="delimiter">'</span><span class="content">bar</span><span class="delimiter">' </span></span>;};<span class="keyword">var</span> output = foo();console.log(output);  <span class="comment">// 'bar'</span></pre></td></tr></tbody></table></div><p>We already learned about grouping operators above, so you should feel comfortable with saying this is equivalent:</p><div><table class="CodeRay"><tbody><tr><td class="line-numbers"><pre><a href="#n1" name= "n1">1</a><a href="#n2" name="n2">2</a><a href="#n3" name="n3">3</a><a href="#n4" name="n4">4</a><a href="#n5" name="n5">5</a></pre></td><td class="code"><pre><span class="keyword">var </span> <span class="function">foo</span> = <span class="keyword">function</span>(){  <span class="keyword">return</span> <span class="string"><span class="delimiter">'</span><span class= "content">bar</span><span class="delimiter">'</span></span>;};<span class="keyword">var</span> output = (foo)(); <span class="comment">// note the extra grouping operators</span> console.log(output);  <span class="comment">// 'bar'</span></pre></td></tr></tbody></table></div><p>Since foo is pointing to our function expression, we know that we can simply refrain from using the variable "foo" and drop in the entire function as an anonymous function (since functions are first class, after all!):</p><div><table class="CodeRay"><tbody><tr><td class= "line-numbers"><pre><a href="#n1" name="n1">1</a><a href="#n2" name="n2">2</a><a href="#n3" name="n3">3</a><a href="#n4" name="n4">4</a></pre></td><td class="code"><pre><span class= "keyword">var</span> output = (<span class="keyword">function</span>(){  <span class="keyword">return</span> <span class="string"><span class="delimiter">'</span><span class="content">bar </span><span class="delimiter">'</span></span>;})();console.log(output);  <span class="comment">// 'bar'</span></pre></td></tr></tbody></table></div><p>Hey wait, we just arrived at the magical resulting function! It turns out to be not so magical after all, once we break it down and see it for what it is. It's simply shorthand for the code we wrote originally, where we defined a function, executed it, and defined output to be its return value.</p><p>I've included this method on the list of declaring functions because we can assign the return value to itself be a function:</p><div><table class="CodeRay"><tbody><tr><td class="line-numbers"><pre><a href="#n1" name="n1">1</a><a href="#n2" name="n2">2</a><a href="#n3" name="n3">3 </a></pre></td><td class="code"><pre><span class="keyword">var</span> E = (<span class="keyword">function</span>(){  <span class="keyword">return</span> <span class="keyword">function </span>(){}})();</pre></td></tr></tbody></table></div><h4 id="applications">Applications</h4><p>There are good applications for this, including information hiding using in the module pattern, (<a href="http://ejohn.org/blog/partial-functions-in-javascript/">partial application</a>, for example), and other clever uses of it. It's definitely not a trivial pattern.</p><h3 id="function-constructor-var-f--new-function">Function constructor: var F = new Function();</h3><p>This method is extremely old and it's not recommended to be used. You pass in an unlimited number of arguments in the front, then the actual function body appears as a string in the last argument (because it's a string, it's effectively the equivalent of eval(), and isn't recommended).</p><h4 id="defining-the-function">1. Defining the function</h4><p>You can create a function like this:</p><div><table class="CodeRay"><tbody><tr><td class= "line-numbers"><pre><a href="#n1" name="n1">1</a><a href="#n2" name="n2">2</a></pre></td><td class="code"><pre><span class="keyword">var</span> F = <span class="keyword">new</span> Function(<span class="string"><span class="delimiter">'</span><span class="content">arg1</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">' </span><span class="content">arg2</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">console.log(arg1 + ", " + arg2) </span><span class="delimiter">'</span></span>);F(<span class="string"><span class="delimiter">'</span><span class="content">foo</span><span class="delimiter">'</span></span>, <span class= "string"><span class="delimiter">'</span><span class="content">bar</span><span class="delimiter">'</span></span>);  <span class="comment">// 'foo, bar' </span></pre></td></tr></tbody></table></div><h4 id="you-dont-need-the-new-operatorh4">2. You don't need the <code>new</code> operator&lt;/h4&gt;</h4><p>You can simply write <code>var F = Function();</code> to get the same result.</p><h4 id="quirks">3. Quirks</h4><p>The <a href=" https://developer.mozilla.org/en/JavaScript/Reference/Functions_and_function_scope#Function_constructor_vs._function_declaration_vs._function_expression">MDN docs</a> have some good examples of the quirks, including the fact that functions declared with the Function constructor don't inherit their current scope properly (i.e. a closure isn't formed).</p><p>What this means is that they don't have access to variables in their enclosing scope, which isn't particularly useful:</p><div><table class="CodeRay"><tbody><tr><td class="line-numbers"><pre><a href ="#n1" name="n1">1</a><a href="#n2" name="n2">2</a><a href="#n3" name="n3">3</a><a href="#n4" name="n4">4</a><a href="#n5" name="n5">5</a><a href="#n6" name="n6">6</a><a href="#n7" name= "n7">7</a><a href="#n8" name="n8">8</a><a href="#n9" name="n9">9</a><strong><a href="#n10" name="n10">10</a></strong><a href="#n11" name="n11">11</a><a href="#n12" name="n12">12 </a></pre></td><td class="code"><pre><span class="keyword">function</span> <span class="function">foo</span>(){  <span class="keyword">var</span> bar = <span class="string"><span class= "delimiter">'</span><span class="content">blah</span><span class="delimiter">'</span></span>;  <span class="keyword">var</span> first = <span class="keyword">new</span> Function(<span class="string"><span class="delimiter">'</span><span class="content">console.log(typeof bar)</span><span class="delimiter">'</span></span>);  first();   <span class="comment">// undefined </span>  <span class="keyword">var</span> <span class="function">second</span> = <span class="keyword">function</span>(){    console.log(<span class="keyword">typeof</span> bar);  } second();  <span class="comment">// string</span>}foo();</pre></td></tr></tbody></table></div><p>In the function "first", we're using the Function constructor, so it doesn't have access to the variable bar. However, if we use the function "second", which is a function expression, it does in fact have access to variables defined in its enclosing scope (via closure).</p><p> In other words, <em>don't use the Function constructor</em>.</p><h3 id="special-case---object-constructor-var-g--new-function-foo">Special case - object constructor: var G = new function foo(){};</h3><p>I saved this for last because we're not really defining a function, though we are using the function keyword, so it's worth noting at least.</p><p><code>new function(){}; </code> creates a new object and invokes the anonymous function as its constructor. If an object is returned from the function, that becomes the resulting object, otherwise a new object is created from scratch and function is executed in the context of that new function (let's save the details for another post!).</p><p>It's a bit unusual to see it in this form. Let's do it the proper way:</p><div><table class="CodeRay"><tbody><tr><td class="line-numbers"><pre><a href="#n1" name="n1">1</a><a href="#n2" name="n2">2</a><a href="#n3" name="n3">3</a><a href= "#n4" name="n4">4</a></pre></td><td class="code"><pre><span class="keyword">var</span> <span class="function">Person</span> = <span class="keyword">function</span>(){  console.log(<span class="local-variable">this</span>);  <span class="comment">// Person</span>}<span class="keyword">var</span> joe = <span class="keyword">new</span> Person(); </pre></td></tr></tbody></table></div><p>So really with the new operator, we are giving it a new ‘this' context and then executing the given function with that new context. Much different than the function definitions we've been dealing with above! This does into a whole new topic, and we'll save that for later!</p><h3 id="further-reading">Further reading</h3><p><a href=" http://kangax.github.com/nfe/">Named function expressions demystified</a> (kangax)</p><p><a href="http://benalman.com/news/2010/11/immediately-invoked-function-expression/"> Immediately-Invoked Function Expression (IIFE) (Ben Alman)</a></p><p><a href="https://developer.mozilla.org/en/JavaScript/Reference/Functions_and_function_scope">Functions and function scope</a> (Mozilla Developer Network - MDN)</p><p><a href="http://stackoverflow.com/questions/1140089/how-does-an-anonymous-function-in-javascript-work">How does an anonymous function in JavaScript work? (StackOverflow)</a></p><p><a href="http://javascriptweblog.wordpress.com/2010/07/06/function-declarations-vs-function-expressions/">Function Declarations vs. Function Expressions (JavaScript, JavaScript by Angus Croll)</a></p><p><a href="http://www.amazon.com/gp/product/0596805527/">JavaScript: The Definitive Guide</a> (classic book by David Flanagan) </p></div></article>			</div>		<!--=========================			END : POST		=============================-->		<!--=========================			START : POST		=============================-->		<div class="post-wrapper">		<h1 class="entry-title">Function Declarations vs. Function Expressions</h1>		<div class= "entry-content">		<p>Lets start with a short quiz. What is alerted in each case?:</p><p>Question 1:</p><div><div id="highlighter_720230" class="syntaxhighlighter  jscript"><table border ="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div></td><td class="code"><div class= "container"><div class="line number1 index0 alt2"><code class="jscript keyword">function</code> <code class="jscript plain">foo(){</code></div><div class="line number2 index1 alt1"><code class="jscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript keyword">function</code> <code class="jscript plain">bar() {</code></div><div class="line number3 index2 alt2" ><code class="jscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript keyword">return</code> <code class="jscript plain">3;</code></div><div class= "line number4 index3 alt1"><code class="jscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript plain">}</code></div><div class="line number5 index4 alt2"><code class="jscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript keyword">return</code> <code class="jscript plain">bar();</code></div><div class="line number6 index5 alt1"><code class= "jscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript keyword">function</code> <code class="jscript plain">bar() {</code></div><div class="line number7 index6 alt2"><code class="jscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript keyword">return</code> <code class="jscript plain">8;</code></div><div class="line number8 index7 alt1"><code class="jscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript plain">}</code></div><div class="line number9 index8 alt2"><code class="jscript plain" >}</code></div><div class="line number10 index9 alt1"><code class="jscript plain">alert(foo());</code></div></div></td></tr></tbody></table></div></div><p>Question 2:</p><div><div id= "highlighter_876545" class="syntaxhighlighter  jscript"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class= "line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="jscript keyword">function</code> <code class="jscript plain"> foo(){</code></div><div class="line number2 index1 alt1"><code class="jscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript keyword">var</code> <code class="jscript plain"> bar = </code><code class="jscript keyword">function</code><code class="jscript plain">() {</code></div><div class="line number3 index2 alt2"><code class="jscript spaces"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript keyword">return</code> <code class="jscript plain">3;</code></div><div class="line number4 index3 alt1"><code class="jscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript plain">};</code></div><div class="line number5 index4 alt2"><code class="jscript spaces">&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="jscript keyword">return</code> <code class="jscript plain">bar();</code></div><div class="line number6 index5 alt1"><code class="jscript spaces"> &nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript keyword">var</code> <code class="jscript plain">bar = </code><code class="jscript keyword">function</code><code class="jscript plain"> () {</code></div><div class="line number7 index6 alt2"><code class="jscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript keyword">return</code> <code class="jscript plain">8;</code></div><div class="line number8 index7 alt1"><code class="jscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript plain">};</code></div><div class="line number9 index8 alt2"><code class="jscript plain">}</code></div><div class="line number10 index9 alt1"><code class="jscript plain">alert(foo()); </code></div></div></td></tr></tbody></table></div></div><p>Question 3:</p><div><div id="highlighter_234852" class="syntaxhighlighter  jscript"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class= "line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="jscript plain">alert(foo());</code></div><div class="line number2 index1 alt1"><code class="jscript keyword">function</code> <code class="jscript plain"> foo(){</code></div><div class="line number3 index2 alt2"><code class="jscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript keyword">var</code> <code class="jscript plain"> bar = </code><code class="jscript keyword">function</code><code class="jscript plain">() {</code></div><div class="line number4 index3 alt1"><code class="jscript spaces"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript keyword">return</code> <code class="jscript plain">3;</code></div><div class="line number5 index4 alt2"><code class="jscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript plain">};</code></div><div class="line number6 index5 alt1"><code class="jscript spaces">&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="jscript keyword">return</code> <code class="jscript plain">bar();</code></div><div class="line number7 index6 alt2"><code class="jscript spaces"> &nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript keyword">var</code> <code class="jscript plain">bar = </code><code class="jscript keyword">function</code><code class="jscript plain"> () {</code></div><div class="line number8 index7 alt1"><code class="jscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript keyword">return</code> <code class="jscript plain">8;</code></div><div class="line number9 index8 alt2"><code class="jscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript plain">};</code></div><div class="line number10 index9 alt1"><code class="jscript plain">}</code></div></div></td></tr></tbody></table></div></div><p>Question 4:</p><div><div id="highlighter_551003" class= "syntaxhighlighter  jscript"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6 </div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10 </div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="jscript keyword">function</code> <code class="jscript plain">foo(){</code></div><div class="line number2 index1 alt1"><code class="jscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript keyword">return</code> <code class="jscript plain">bar();</code></div><div class="line number3 index2 alt2"><code class="jscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript keyword">var</code> <code class="jscript plain">bar = </code><code class= "jscript keyword">function</code><code class="jscript plain">() {</code></div><div class="line number4 index3 alt1"><code class="jscript spaces"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript keyword">return</code> <code class="jscript plain">3;</code></div><div class="line number5 index4 alt2"><code class="jscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript plain">};</code></div><div class="line number6 index5 alt1"><code class="jscript spaces">&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="jscript keyword">var</code> <code class="jscript plain">bar = </code><code class="jscript keyword">function</code><code class="jscript plain">() {</code></div><div class="line number7 index6 alt2"><code class="jscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript keyword">return</code> <code class="jscript plain" >8;</code></div><div class="line number8 index7 alt1"><code class="jscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript plain">};</code></div><div class="line number9 index8 alt2"><code class="jscript plain">}</code></div><div class="line number10 index9 alt1"><code class="jscript plain">alert(foo()); </code></div></div></td></tr></tbody></table></div></div><p>If you didn't answer 8, 3, 3 and [Type Error: bar is not a function] respectively, read on… (actually read on anyway <span class ="wp-smiley wp-emoji wp-emoji-wink" title=";-)">;-)</span> )</p><p><strong><span id="more-787"></span></strong></p><p><strong>What is a Function Declaration?</strong></p><p>A Function Declaration defines a named function variable without requiring variable assignment. Function Declarations occur as standalone constructs and cannot be nested within non-function blocks. It's helpful to think of them as siblings of Variable Declarations. Just as Variable Declarations must start with "var", Function Declarations must begin with "function".</p><p>e.g. </p><div><div id="highlighter_502171" class="syntaxhighlighter  jscript"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2" ><code class="jscript keyword">function</code> <code class="jscript plain">bar() {</code></div><div class="line number2 index1 alt1"><code class="jscript spaces">&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="jscript keyword">return</code> <code class="jscript plain">3;</code></div><div class="line number3 index2 alt2"><code class="jscript plain">} </code></div></div></td></tr></tbody></table></div></div><p>ECMA 5 (13.0) defines the syntax as<br><strong>function</strong> <em>Identifier</em> ( <em>FormalParameterList</em><sub>opt </sub> ) { <em>FunctionBody</em> }</p><p>The function name is visible within it's scope and the scope of it's parent (which is good because otherwise it would be unreachable)</p><div><div id="highlighter_218052" class="syntaxhighlighter  jscript"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class= "line number6 index5 alt1">6</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="jscript keyword">function</code> <code class="jscript plain">bar() {</code></div><div class="line number2 index1 alt1"><code class="jscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript keyword">return</code> <code class= "jscript plain">3;</code></div><div class="line number3 index2 alt2"><code class="jscript plain">}</code></div><div class="line number4 index3 alt1">&nbsp;</div><div class="line number5 index4 alt2"><code class="jscript plain">bar() </code><code class="jscript comments">//3</code></div><div class="line number6 index5 alt1"><code class="jscript plain">bar&nbsp; </code><code class="jscript comments">//function</code></div></div></td></tr></tbody></table></div></div><p><strong>What is a Function Expression?</strong></p><p>A Function Expression defines a function as a part of a larger expression syntax (typically a variable assignment  ). Functions defined via Functions Expressions can be named or anonymous. Function Expressions must not start with "function" (hence the parentheses around the self invoking example below)</p><p>e.g.</p><div><div id="highlighter_545334" class="syntaxhighlighter  jscript"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="jscript comments">//anonymous function expression</code></div><div class="line number2 index1 alt1"><code class= "jscript keyword">var</code> <code class="jscript plain">a = </code><code class="jscript keyword">function</code><code class="jscript plain">() {</code></div><div class="line number3 index2 alt2"><code class="jscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript keyword">return</code> <code class="jscript plain">3;</code></div><div class="line number4 index3 alt1"><code class="jscript plain">}</code></div><div class="line number5 index4 alt2">&nbsp;</div><div class="line number6 index5 alt1"><code class="jscript comments">//named function expression</code></div><div class="line number7 index6 alt2"><code class="jscript keyword">var</code> <code class="jscript plain">a = </code><code class="jscript keyword">function </code> <code class="jscript plain">bar() {</code></div><div class="line number8 index7 alt1"><code class="jscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript keyword"> return</code> <code class="jscript plain">3;</code></div><div class="line number9 index8 alt2"><code class="jscript plain">}</code></div><div class="line number10 index9 alt1">&nbsp; </div><div class="line number11 index10 alt2"><code class="jscript comments">//self invoking function expression</code></div><div class="line number12 index11 alt1"><code class="jscript plain">(</code><code class="jscript keyword">function</code> <code class="jscript plain">sayHello() {</code></div><div class="line number13 index12 alt2"><code class="jscript spaces"> &nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript plain">alert(</code><code class="jscript string">"hello!"</code><code class="jscript plain">);</code></div><div class="line number14 index13 alt1"><code class="jscript plain">})();</code></div></div></td></tr></tbody></table></div></div><p>ECMA 5 (13.0) defines the syntax as<br><strong>function</strong> <em>Identifier </em><sub>opt</sub> ( <em>FormalParameterList</em><sub>opt</sub> ) { <em>FunctionBody</em> }</p><p>(though this feels incomplete since it omits the requirement that the containing syntax be an expression and not start with "function")</p><p>The function name (if any) is not visible outside of it's scope (contrast with Function Declarations).</p><p><strong>So what's a Function Statement?</strong></p><p>Its sometimes just a pseudonym for a Function Declaration. However as <a href="http://yura.thinkweb2.com/named-function-expressions/#function-statements" target="_blank">kangax</a> pointed out, in mozilla a Function Statement is an extension of Function Declaration allowing the Function Declaration syntax to be used anywhere a statement is allowed.&nbsp; It's as yet non standard so not recommended for production development</p><p><strong>About that quiz….care to explain?</strong></p><p>OK so Question 1 uses function declarations which means they get hoisted…</p><p><strong>Wait, what's Hoisting?</strong></p><p>To quote <a href="http://www.adequatelygood.com/2010/2/JavaScript-Scoping-and-Hoisting" target="_blank">Ben Cherry's excellent article</a>: "Function declarations and function variables are always moved (‘hoisted') to  the top of their JavaScript scope by the JavaScript interpreter".</p><p>When a function declaration is hoisted the entire function body is lifted with it, so after the interpreter has finished with the code in Question 1 it runs more like this:</p><div><div id="highlighter_154411" class="syntaxhighlighter  jscript"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9 </div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2" >13</div><div class="line number14 index13 alt1">14</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="jscript comments">//**Simulated processing sequence for Question 1**</code></div><div class="line number2 index1 alt1"><code class="jscript keyword">function</code> <code class="jscript plain">foo(){</code></div><div class="line number3 index2 alt2"><code class="jscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript comments">//define bar once</code></div><div class="line number4 index3 alt1"><code class="jscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript keyword">function</code> <code class="jscript plain">bar() {</code></div><div class="line number5 index4 alt2"><code class="jscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript keyword">return</code> <code class="jscript plain">3;</code></div><div class="line number6 index5 alt1"><code class="jscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript plain">}</code></div><div class="line number7 index6 alt2"><code class= "jscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript comments">//redefine it</code></div><div class="line number8 index7 alt1"><code class="jscript spaces"> &nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript keyword">function</code> <code class="jscript plain">bar() {</code></div><div class="line number9 index8 alt2"><code class="jscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript keyword">return</code> <code class="jscript plain">8;</code></div><div class="line number10 index9 alt1" ><code class="jscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript plain">}</code></div><div class="line number11 index10 alt2"><code class="jscript spaces"> &nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript comments">//return its invocation</code></div><div class="line number12 index11 alt1"><code class="jscript spaces"> &nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript keyword">return</code> <code class="jscript plain">bar(); </code><code class="jscript comments">//8</code></div><div class="line number13 index12 alt2"><code class="jscript plain">}</code></div><div class="line number14 index13 alt1"><code class="jscript plain">alert(foo()); </code></div></div></td></tr></tbody></table></div></div><p><strong>But…but…we were always taught that code after the return statement is unreachable</strong></p><p>In JavaScript execution there is Context (which ECMA 5 breaks into LexicalEnvironment, VariableEnvironment and ThisBinding) and Process (a set of statements to be invoked in sequence). Declarations contribute to the VariableEnvironment when the execution scope is entered. They are distinct from Statements (such as <strong>return</strong>) and are not subject to their rules of process.</p><p><strong>Do Function Expressions get Hoisted too?</strong></p><p>That depends on the expression. Let's look at the first expression  in Question 2:</p><div><div id= "highlighter_48492" class="syntaxhighlighter  jscript"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class= "jscript keyword">var</code> <code class="jscript plain">bar = </code><code class="jscript keyword">function</code><code class="jscript plain">() {</code></div><div class="line number2 index1 alt1"><code class="jscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript keyword">return</code> <code class="jscript plain">3;</code></div><div class="line number3 index2 alt2"><code class="jscript plain">};</code></div></div></td></tr></tbody></table></div></div><p>The left hand side (<em>var bar</em>) is a Variable Declaration. Variable Declarations get hoisted but their Assignment Expressions don't. So when <strong>bar</strong> is hoisted the interpreter initially sets <em>var bar = undefined</em>. The function definition itself is not hoisted.</p><p>(ECMA 5 12.2 A variable with an <em>initialzier</em> is assigned the value of its <em>AssignmentExpression</em> when the <em>VariableStatement</em> is executed, not when the variable is created.)</p><p>Thus the code in Question 2 runs in a more intuitive sequence:</p><div><div id="highlighter_361027" class="syntaxhighlighter  jscript" ><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div></td><td class="code" ><div class="container"><div class="line number1 index0 alt2"><code class="jscript comments">//**Simulated processing sequence for Question 2**</code></div><div class="line number2 index1 alt1"><code class="jscript keyword">function</code> <code class="jscript plain">foo(){</code></div><div class="line number3 index2 alt2"><code class="jscript spaces"> &nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript comments">//a declaration for each function expression</code></div><div class="line number4 index3 alt1"><code class="jscript spaces"> &nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript keyword">var</code> <code class="jscript plain">bar = undefined;</code></div><div class="line number5 index4 alt2"><code class="jscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript keyword">var</code> <code class="jscript plain">bar = undefined;</code></div><div class="line number6 index5 alt1"><code class= "jscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript comments">//first Function Expression is executed</code></div><div class="line number7 index6 alt2"><code class= "jscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript plain">bar = </code><code class="jscript keyword">function</code><code class="jscript plain">() {</code></div><div class="line number8 index7 alt1"><code class="jscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript keyword">return</code> <code class="jscript plain" >3;</code></div><div class="line number9 index8 alt2"><code class="jscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript plain">};</code></div><div class="line number10 index9 alt1"><code class="jscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript comments">// Function created by first Function Expression is invoked</code></div><div class= "line number11 index10 alt2"><code class="jscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript keyword">return</code> <code class="jscript plain">bar();</code></div><div class="line number12 index11 alt1"><code class="jscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript comments">// second Function Expression unreachable</code></div><div class="line number13 index12 alt2"><code class="jscript plain">}</code></div><div class="line number14 index13 alt1"><code class="jscript plain">alert(foo()); </code><code class="jscript comments">//3</code></div></div></td></tr></tbody></table></div></div><p><strong>Ok I think that makes sense. By the way, you're wrong about Question 3. I ran it in Firebug and got an error</strong></p><p>Try saving it in an HTML file and running it over Firefox. Or run it in IE8, Chrome or Safari consoles. Apparently the Firebug console does not practice function hoisting when it runs in its "global" scope (which is actually not global but a special "Firebug" scope – try running "this == window" in the Firebug console).</p><p>Question 3 is based on similar logic to Question 1. This time it is the <strong>foo</strong> function that gets hoisted.</p><p><strong>Now Question 4 seems easy. No function hoisting here…</strong></p><p> Almost. If there were no hoisting at all, the TypeError would be "bar not defined" and not "bar not a function". There's no function hoisting, however there <em>is</em> variable hoisting. Thus <strong>bar</strong> gets declared up front but its value is not defined. Everything else runs to order.</p><div><div id="highlighter_257123" class="syntaxhighlighter  jscript"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="jscript comments">//**Simulated processing sequence for Question 4**</code></div><div class="line number2 index1 alt1"><code class="jscript keyword">function</code> <code class="jscript plain">foo(){</code></div><div class="line number3 index2 alt2"><code class="jscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript comments">//a declaration for each function expression</code></div><div class="line number4 index3 alt1"><code class="jscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript keyword">var </code> <code class="jscript plain">bar = undefined;</code></div><div class="line number5 index4 alt2"><code class="jscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript keyword">var</code> <code class="jscript plain">bar = undefined;</code></div><div class="line number6 index5 alt1"><code class="jscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class= "jscript keyword">return</code> <code class="jscript plain">bar(); </code><code class="jscript comments">//TypeError: "bar not defined"</code></div><div class="line number7 index6 alt2" ><code class="jscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript comments">//neither Function Expression is reached</code></div><div class="line number8 index7 alt1"><code class="jscript plain">}</code></div><div class="line number9 index8 alt2"><code class="jscript plain">alert(foo());</code></div></div></td></tr></tbody></table></div></div><p><strong> What else should I watch out for?</strong></p><p>Function Declarations are officially prohibited within non-function blocks (such as if) . However all browsers allow them and interpret them in different ways.</p><p>For example the following code snippet in Firefox 3.6 throws an error because it interprets the Function Declaration as a Function Statement (see above) so x is not defined. However in IE8, Chrome 5 and Safari 5 the function x is returned (as expected with standard Function Declarations).</p><div><div id="highlighter_803373" class= "syntaxhighlighter  jscript"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6 </div><div class="line number7 index6 alt2">7</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="jscript keyword">function</code> <code class="jscript plain">foo() {</code></div><div class="line number2 index1 alt1"><code class="jscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript keyword">if</code><code class="jscript plain">(</code><code class="jscript keyword">false</code><code class="jscript plain">) {</code></div><div class="line number3 index2 alt2"><code class="jscript spaces"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript keyword">function</code> <code class="jscript plain">x() {};</code></div><div class="line number4 index3 alt1" ><code class="jscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript plain">}</code></div><div class="line number5 index4 alt2"><code class="jscript spaces"> &nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript keyword">return</code> <code class="jscript plain">x;</code></div><div class="line number6 index5 alt1"><code class="jscript plain">} </code></div><div class="line number7 index6 alt2"><code class="jscript plain">alert(foo());</code></div></div></td></tr></tbody></table></div></div><p><strong> I can see how using Function Declarations can cause confusion but are there any benefits? </strong></p><p>Well you could argue that Function Declarations are forgiving – if you try to use a function before it is declared, hoisting fixes the order and the function gets called without mishap. But that kind of forgiveness does not encourage tight coding and in the long run is probably more likely to promote surprises than prevent them. After all, programmers arrange their statements in a particular sequence for a reason.</p><p><strong> And there are other reasons to favour Function Expressions? </strong></p><p>How did you guess?</p><p>a) Function Declarations feel like they were intended to mimic Java style method declarations but Java methods are very different animals. In JavaScript functions are living objects with values. Java methods are just metadata storage. Both the following snippets define functions but only the Function Expression suggests that we are creating an object.</p><div><div id="highlighter_651274" class="syntaxhighlighter  jscript"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1" >4</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="jscript comments">//Function Declaration</code></div><div class="line number2 index1 alt1"><code class="jscript keyword">function</code> <code class="jscript plain">add(a,b) {</code><code class="jscript keyword">return</code> <code class="jscript plain">a + b}; </code></div><div class="line number3 index2 alt2"><code class="jscript comments">//Function Expression</code></div><div class="line number4 index3 alt1"><code class="jscript keyword">var </code> <code class="jscript plain">add = </code><code class="jscript keyword">function</code><code class="jscript plain">(a,b) {</code><code class="jscript keyword">return</code> <code class="jscript plain">a + b};</code></div></div></td></tr></tbody></table></div></div><p>b) Function Expressions are more versatile. A Function Declaration can only exist as a "statement" in isolation. All it can do is create an object variable parented by its current scope. In contrast a Function Expression (by definition) is part of a larger construct. If you want to create an anonymous function or assign a function to a prototype or as a property of some other object you need a Function Expression. Whenever you create a new function using a high order application such as <a href="https://javascriptweblog.wordpress.com/2010/04/05/curry-cooking-up-tastier-functions/" target="_blank">curry</a> or <a href=" https://javascriptweblog.wordpress.com/2010/04/14/compose-functions-as-building-blocks/" target="_blank">compose</a> you are using a Function Expression. Function Expressions and Functional Programming are inseparable.</p><div><div id="highlighter_445599" class="syntaxhighlighter  jscript"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class= "gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="jscript comments">//Function Expression</code></div><div class="line number2 index1 alt1"><code class="jscript keyword">var</code> <code class="jscript plain">sayHello = alert.curry(</code><code class="jscript string">"hello!"</code><code class="jscript plain">);</code></div></div></td></tr></tbody></table></div></div><p><strong> Do Function Expressions have any drawbacks? </strong></p><p>Typically functions created by Function Expressions are unnamed. For instance the following function is anonymous, <em>today</em> is just a reference to an unnamed function:</p><div><div id="highlighter_115633" class="syntaxhighlighter  jscript"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class= "line number1 index0 alt2">1</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="jscript keyword">var</code> <code class="jscript plain"> today = </code><code class="jscript keyword">function</code><code class="jscript plain">() {</code><code class="jscript keyword">return</code> <code class="jscript keyword">new</code> <code class="jscript plain">Date()}</code></div></div></td></tr></tbody></table></div></div><p>Does this really matter? Mostly it doesn't, but as <a href="http://fitzgeraldnick.com/weblog/ " target="_blank">Nick Fitzgerald</a> has pointed out debugging with anonymous functions can be frustrating. He suggests using Named Function Expressions (NFEs) as a workaround: </p><div><div id="highlighter_951398" class="syntaxhighlighter  jscript"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="jscript keyword">var</code> <code class="jscript plain">today = </code><code class="jscript keyword">function</code> <code class="jscript plain">today() {</code><code class="jscript keyword">return</code> <code class="jscript keyword">new</code> <code class= "jscript plain">Date()}</code></div></div></td></tr></tbody></table></div></div><p>However as Asen Bozhilov points out (and Kangax <a href=" http://yura.thinkweb2.com/named-function-expressions/#jscript-bugs" target="_blank">documents</a>) NFEs do not work correctly in IE &lt; 9</p><p><strong>Conclusions?</strong></p><p>Badly placed Function Declarations are misleading and there are few (if any) situations where you can't use a Function Expression assigned to a variable instead. However if you must use Function Declarations, it will minimize confusion if you place them at the top of the scope to which they belong. I would never place a Function Declarations in an <strong>if</strong> statement.</p><p>Having said all this you may well find yourself in situations where it makes sense to use a Function Declaration. That's fine. Slavish adherance to rules is dangerous and often results in tortuous code. Much more important is that you understand the concepts so that you can make your own informed decisions. I hope this article helps in that regard.</p><p> Comments are very welcome. Please let me know if you feel anything I've said is incorrect or if you have something to add.</p><p>See also <a href="http://es5.github.com/" target="_blank"> ECMA-262 5th Edition</a> sections 10.5, 12.2, 13.0, 13.2</p>					</div>			</div>		<!--=========================			END : POST =============================-->		<!--=========================			START : POST		=============================-->		<div class="post-wrapper">		<h1 class= "title" id="page-title">Every Possible Way to Define a Javascript Function</h1>		<div class="field-item even" property="content:encoded"><p>One small thing that confused me as I was learning Javascript was the many different kinds of ways to define a Javascript function. I could never seem to find one place that showed all of them, and explained why you might use each one.</p><p>That is the aim of this post. So without further ado, here are ALL the ways to define a Javascript function.</p><h3>Function Declarations:</h3><table class="codetable" ><thead><tr><th scope="col">Type</th><th scope="col">Example</th><th scope="col">Explanation</th></tr></thead><tbody><tr><td>Named Function Declaration</td><td><pre><code>function sum(num1,num2){  return num1 + num2;}</code></pre></td><td>The "classic" declaration, which works well for simple uses. Functions declared like this are "hoisted", meaning, the javascript engine reads all these declarations first before executing any of the rest of the code. The declaration statement stands alone, and cannot be combined with other expressions. Also, notice that this declaration does not need to be followed with a semicolon.</td></tr></tbody></table><h3>Function Expressions:</h3><p><small>Function expressions are very flexible, and can used in many contexts. This list aims to demonstrate that flexibility, and show use-cases for each example. Also:&nbsp;<a href="http://kangax.github.io/nfe/#expr-vs-decl">here's a great article on the differences between function declarations and expressions</a>.</small></p><table class="codetable"><thead><tr><th scope="col">Type</th><th scope="col">Example</th><th scope= "col">Explanation</th></tr></thead><tbody><tr><td>Variable Assignment</td><td><pre><code>// Namedvar sum = function add(num1,num2){  return num1 + num2;};// Anonymousvar sum = function(num1, num2){  return num1 + num2;};</code></pre></td><td><p>This is functionally equivalent to the Function Declaration above, except this variation is NOT hoisted. The name of our function (add) cannot be called directly (see below), but it can come in handy when debugging:</p><pre><code>sum(1,1);// returns 2add(1,1);// "add is not defined" </code></pre></td></tr><tr><td>Immediately invoked</td><td><pre><code>// Named(function sum(num1, num2){  return num1 + num2;}(1, 2));// Anonymous(function(num1, num2){  return num1 + num2;}(1, 2));</code></pre></td><td>This function is immediately invoked, meaning that it is defined and called at the same time. The function's name is only available within its execution scope (defined by the parentheses), so it cannot be called later in the program.<pre><code>sum(1,1);// "sum is not defined"</code></pre><p> Immediately invoked functions can be used to encapsulate a program, preventing it from polluting the global namespace (<a href="http://stackoverflow.com/questions/3597087/javascript-encapsulation">here's a simple example of that</a>).</p></td></tr><tr><td>Assigned and Invoked</td><td><pre><code>// Namedvar sum = function add(num1, num2){  return num1 + num2;}(1, 2);// Anonymousvar sum = function(num1, num2){  return num1 + num2;}(1, 2);</code></pre></td><td>This is a combination of the variable assignment expression and the immediately invoked function (both demonstrated above). One neat application for the named variety of this is to make recursive functions more readable, by <a href="http://fitzgeraldnick.com/weblog/27/">substituting arguments.callee with your function name</a>.</td></tr><tr><td>Property Assignment</td><td><pre><code>// Namedvar obj1 = {  sum: function add(num1, num2) {    return num1 + num2  }};// Anonymousvar obj2 = {  sum: function(num1, num2) {    return num1 + num2  }};</code></pre></td><td><p>By assigning functions (either named or unnamed) to properties of objects, we define methods on those objects. This has many applications in object oriented programming. We can also use this to namespace our functions, and keep them out of the global scope.</p><p>Here's how we would call the methods defined in the examples:</p><pre><code>obj1.sum(1, 2);// returns 3obj2.sum(1, 2);// returns 3</code></pre></td></tr><tr><td>Passed as Argument</td><td><pre><code>// Namedwindow.setTimeout(<strong>function add(){  alert(1 + 2);}</strong>, 500);// Anonymouswindow.setTimeout(<strong>function(){  alert(1 + 2);}</strong>, 500);</code></pre></td><td><p> Function names in ECMAScript are nothing more than variables, meaning we can pass them around like variables. Many methods (like setTimeout()) take functions as arguments. This is a common pattern for defining callbacks.</p><p>In these examples, we define them in line, but we could also pass in predefined functions.</p></td></tr><tr><td>Returned (closure) </td><td><pre>// Namedfunction counter() {    var count = 0;    <strong>return function c() {        alert(count++);    }</strong>}// Anonymousfunction counter() {    var count = 0; <strong>return function() {        alert(count++);    }</strong>}</pre></td><td><p>Functions can be returned from other functions. This lets us do clever things like the following (picking up from the example):</p><pre><code>var bob = {}, rob = {};bob.count = counter();rob.count = counter();bob.count(); // alerts "0"bob.count(); // alerts "1"rob.count(); // alerts "0"rob.count(); // alerts "1"</code></pre><p>Each person can increment their own count variable despite the fact that it originated outside the scope of the count() function. This is called a closure. <a href="http://stackoverflow.com/questions/111102/how-do-javascript-closures-work">Here's some more information on Javascript closures</a>, if you're curious. </p></td></tr><tr><td>Arrow Functions</td><td><pre style="overflow: auto; width: 300px;"><code>// There is no "named" form of this function.// Anonymousvar sum = (num1, num2) =&gt; {return num1 + num2};// Anonymous w/out optional bracketed returnvar sum = (num1, num2) =&gt; num1 + num2;</code></pre></td><td><p>Arrow (or "fat-arrow") functions are newly introduced as <a href="http://wiki.ecmascript.org/doku.php?id=harmony:arrow_function_syntax">part of the ES6 specification</a>. As such, they are only implemented in the most modern browsers (check <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Functions/Arrow_functions#Browser_compatibility">a compatibility table</a> for specifics). This example:</p><pre style="overflow: auto; width: 300px;"><code>var sum = (num1, num2) =&gt; {return num1 + num2};</code></pre><p>is functionally equivalent to:</p><pre><code>var sum = function(num1, num2) {  return num1 + num2;};</code></pre><p>Arrow functions are function expressions, and as such, they are usable in all the contexts shown above (variable assignment, passed as an argument, etc.). You may see slight syntactical variations across uses (as shown with in the example with optional brackets). <a href=" http://www.nczonline.net/blog/2013/09/10/understanding-ecmascript-6-arrow-functions/">Here's a good blog post</a> that explains the syntax and it's variations. </p></td></tr></tbody></table><h3>Function Constructor</h3><table class="codetable"><thead><tr><th scope="col">Type</th><th scope="col">Example</th><th scope="col">Explanation </th></tr></thead><tbody><tr><td>Function Constructor</td><td><pre style="overflow: auto; width: 400px;"><code>var sum = new Function("num1", "num2", "return num1 + num2"); </code></pre></td><td>Defining functions with the Function constructor is less performant than the other methods, so I wouldn't recommend this option. However, it is useful in demonstrating that in Javascript, functions are "just objects."</td></tr><tr><td>Constructor w/<code>apply()</code></td><td><pre style="overflow: auto; width: 400px;"><code>var sum = Function.apply(this, ['num1', 'num2', 'return num1 + num2']);</code></pre></td><td>This uses the <code>apply()</code> method to call the constructor of the Function object and create a function. The function can then be run with <code>sum(1,2);</code>. Hard to think of a practical application for this one, but it could be used in rare cases.</td></tr><tr><td>Immediately Invoked Constructor w/<code>apply()</code></td><td><pre style="overflow: auto; width: 400px;"><code>Function.apply(this, ['num1', 'num2', 'return num1 + num2']).apply(this, [1,2]); </code></pre></td><td>This uses the <code>apply()</code> method with the constructor of the Function object to immediately invoke the function we defined. Again, it's hard to think of a practical application for this one, but hey, it works as expected.</td></tr></tbody></table><h2>Conclusion</h2><p>Conclusion</p><p>I think that's all of them, but if you know of any others that I'm not aware of, (or have other suggestions to make), let me know in the comments below.</p><p>If you want to see patterns and techniques for declaring functions using the methods I described above, check out <a href="http://addyosmani.com/resources/essentialjsdesignpatterns/book/" title="Javascript Design Patterns">Addy Osmani's book, "Javascript Design Patterns"</a>. It is Creative Common licensed, published online, and freely available to read.</p><hr><p><small>Also, a big thanks to Nicholas Zakas' book "<a href=" http://www.amazon.com/Professional-JavaScript-Developers-Nicholas-Zakas/dp/1118026691">Professional Javascript for Web Developers</a>", which brought a lot of this together for me. </small></p><p><small><strong>Update 1:</strong></small></p><p><small>Based on feedback in the comments, I reorganized the table in order to more accurately classify the function declarations and expressions. I also tweaked the examples to (hopefully) be a bit less confusing.</small></p></div>			</div>		<!--=========================			END : POST		=============================-->		<!--=========================			START : POST		=============================-->		<div class="post-wrapper">		<h1> An overview of Javascript's try-catch</h1>		<div class="field-item even" property="content:encoded"><p>Javascript has a pattern called try-catch that can be a bit confusing if you aren't used to it. I just finished a fantastic javascript book, which covered the topic well, so I thought I'd share what I learned.</p><h2>What is try-catch?</h2><p>Try-catch is a code block, similar to an if conditional. It looks like this:</p><pre><code>try {    // put some code here} catch (err) {    // put more code herefinally {    // put more code here} </code></pre><p>The purpose of a try-catch block is to handle errors gracefully. And when I say errors, I don't mean bugs or missing semicolons. I mean big, nasty, capital E errors.</p><p> You see, sometimes in your program you'll come across a situation that you know is capable of throwing an error, and there's nothing you can do about it. The best example is when you are getting data from an external API. That API might go down, and when it does, your program is going to try to connect to it, fail, and throw a error. If that error is Fatal, your application will immediately stop, resulting in a broken experience for your users.</p><p>When you put something into the "try" braces, you are effectively saying, "I know that this code could result in a nasty error, but instead of letting it break the application, I want to intercept (or "catch") the error, prevent it from breaking the program, and define what I want to happen next." Not too complicated right? That's "try".</p><p>The "catch" braces contains the code that you want to run when that error occurs (aka when it is "caught"). In the case of the API failure, you might want to try to reconnect to the API or provide a human readable error message. The code in "catch" only runs if an error is found in the "try" code.</p><p>The "finally" braces, contains any code that you want to run "no matter what." It will run if an error was caught, and it will run if there was no error at all. In fact, if you include a finally block there is nothing you or anybody can do to prevent the code in the finally block from running. Of course, the finally block is optional.</p><h2>A couple examples</h2><p>We can test this out by creating our own artificial errors using the 'throw' statement, like so:</p><pre><code>try {&nbsp;&nbsp;&nbsp; throw new Error("My custom error message");} catch (err) {&nbsp;&nbsp;&nbsp; // Print the error message to the console.&nbsp;&nbsp;&nbsp; console.log(err.message);}</code></pre><p>As you can see the "catch" block references a javascript object that we've named `err`. This object contains information about the error that was returned, like the error message (stored in `err.message`).</p><p>Let's make a few changes to our example to bring all these concepts together.</p><pre><code>try {&nbsp;&nbsp;&nbsp; console.log('This is the first "try" message');&nbsp;&nbsp;&nbsp; throw new Error("My custom error message");&nbsp;&nbsp;&nbsp; console.log('This is the second "try" message');} catch (e) {&nbsp;&nbsp;&nbsp; console.log('This is the "catch" message: ' + e.message);} finally { &nbsp;&nbsp;&nbsp; console.log('This is the "finally" message');}console.log('This is an additional message, after try-catch-finally');</code></pre><p>Running this code results in the following messages in the console:</p><pre><code>This is the first "try" messageThis is the "catch" message: My custom error messageThis is the "finally" messageThis is an additional message, after try-catch-finally</code></pre><p>As you can see, the second "try" message is skipped because code execution moves to the catch block as soon as our error is encountered. You can also see that our additional message (placed after the try-catch-finally block) runs as well. By "catching" our error, the program can continue running even if it would have otherwise fatally stopped.</p><h2>Tell me more</h2><p>If you want more information on try-catch (including when and when not to use it) here are a few good links:</p><ul><li><a href=" https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/try...catch">Mozilla Reference: try...catch</a></li><li><a href=" http://programmers.stackexchange.com/questions/144326/try-catch-in-javascript-isnt-it-a-good-practice">Is try-catch a good practice?</a></li><li><a href=" http://javascript.info/tutorial/exceptions">Javascript Exceptions</a></li></ul></div>			</div>		<!--=========================			END : POST =============================-->		<!--=========================			START : POST		=============================-->		<div class="post-wrapper"><article class="post clear">      <h1 class="post__title">        Simple forEach implementation for Objects/NodeLists/Arrays      </h1>      <div class="post__meta">        <a href= "//github.com/toddmotto/toddmotto.github.io/blob/master/_posts/2014-05-14-simple-foreach-implementation-for-objects-nodelists-arrays-with-automatic-type-looping.md" class="post__meta-edit" >          <i class="fa fa-github"></i>          Edit this page on GitHub        </a>        <p>          May 14, 2014        </p>      </div>      <p>Looping Objects is easy. Looping Arrays is also easy. Looping NodeLists is easy. They can be a little repetitive though and often take time to construct each loop and pass in the index, property, element or whatever... </p><p>There is no "standard" way of iterating over everything. We can use <code>Array.prototype.forEach</code> to loop over Arrays (or the regular <code>for</code> loop), a <code>for in </code> loop for Objects, and a regular <code>for</code> loop again for NodeLists or HTML collections. No, you're not going to use that <code>forEach.call(NodeList)</code> <a href= "//toddmotto.com/ditch-the-array-foreach-call-nodelist-hack">hack</a>.</p><p>Wouldn't it be nice to just forget about what type of collection we're looping, forget about browser support and write a nice little function that handles everything for us. Yes.</p><p>So I did...</p><div class="download-box">  <a onclick="_gaq.push(['_trackEvent', 'Click', 'Download foreach', 'Download foreach']);" href="//github.com/toddmotto/foreach/archive/master.zip">Download</a>  <a onclick="_gaq.push(['_trackEvent', 'Click', 'Fork foreach', 'foreach Fork']);" href= "//github.com/toddmotto/foreach">Fork on GitHub</a></div><h3>forEach.js</h3><p><code>forEach.js</code> is a simple script, it's not part of a library or even a module, it's just a function, here's it's syntax and a quick example using an <code>Array</code>:</p><div class="highlight"><pre><code data-lang="javascript" class="language-javascript"><span class="c1">// syntax</span><span class="nx">forEach</span><span class="p">(</span><span class="nx">collection</span><span class="p">[,</span> <span class="nx">callback</span><span class="p">[,</span> <span class="nx">context</span><span class="p">]]);</span><span class="c1">// example</span><span class="kd">var</span> <span class="nx">myArray</span> <span class="o">=</span> <span class ="p">[</span><span class="s1">'A'</span><span class="p">,</span> <span class="s1">'B'</span><span class="p">,</span> <span class="s1">'C'</span><span class="p">,</span> <span class="s1"> 'D'</span><span class="p">];</span><span class="nx">forEach</span><span class="p">(</span><span class="nx">myArray</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">value</span><span class="p">,</span> <span class="nx">index</span><span class="p">)</span> <span class="p">{</span>    <span class="c1">// `this` will reference myArray: []</span><span class="p">},</span> <span class="nx">myArray</span><span class="p">);</span> <span class="c1">// note third param changing execution context </span></code></pre></div><h4>forEach() for Arrays/NodeLists</h4><p>You can loop over an Array or NodeList using a standard <code>for</code> loop, however, NodeLists cannot be used in conjunction with the newer ECMAScript 5 <code>Array.prototype.forEach</code>. This script takes care of that in the same way it loops over an <code>Array</code>, you'll get the same stuff passed back:</p><div class="highlight"><pre><code data-lang="javascript" class="language-javascript"><span class="c1">// Array:</span><span class="nx">forEach</span><span class="p">([ </span><span class="s1">'A'</span><span class="p">,</span> <span class="s1">'B'</span><span class="p">,</span> <span class="s1">'C'</span><span class="p">,</span> <span class="s1">'D' </span><span class="p">],</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">value</span><span class="p">,</span> <span class="nx">index</span><span class="p" >)</span> <span class="p">{</span>    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">index</span><span class="p" >);</span> <span class="c1">// 0, 1, 2, 3</span>    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">value </span><span class="p">);</span> <span class="c1">// A, B, C, D</span><span class="p">});</span><span class="c1">// NodeList:</span><span class="nx">forEach</span><span class="p">( </span><span class="nb">document</span><span class="p">.</span><span class="nx">querySelectorAll</span><span class="p">(</span><span class="s1">'div'</span><span class="p">),</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">value</span><span class="p">,</span> <span class="nx">index</span><span class="p">)</span> <span class="p">{</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">index</span><span class="p">);</span> <span class="c1">// 0, 1, 2, 3</span>    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">value</span><span class="p">);</span> <span class= "c1">// &lt;div&gt;, &lt;div&gt;, &lt;div&gt;...</span><span class="p">});</span></code></pre></div><h4>forEach() for Objects</h4><p>Object iteration is usually done via a <code>for in </code> loop, we can wrap this up by passing back values which makes our loops cleaner and easier to manage:</p><div class="highlight"><pre><code data-lang="javascript" class= "language-javascript"><span class="c1">// Object:</span><span class="nx">forEach</span><span class="p">({</span> <span class="nx">name</span><span class="o">:</span> <span class="s1"> 'Todd'</span><span class="p">,</span> <span class="nx">location</span><span class="o">:</span> <span class="s1">'UK'</span> <span class="p">},</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">value</span><span class="p">,</span> <span class="nx">prop</span><span class="p">,</span> <span class="nx">obj</span><span class="p">)</span> <span class="p">{</span>    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">value</span><span class="p">);</span> <span class="c1">// Todd, UK</span>    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">prop</span><span class="p">); </span> <span class="c1">// name, location</span>  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">obj </span><span class="p">);</span> <span class="c1">// { name: 'Todd', location: 'UK' }, { name: 'Todd', location: 'UK' }</span><span class="p">});</span></code></pre></div><h5>collection </h5><p>Type: <code>Array|Object|NodeList</code></p><p>Collection of items to iterate, could be an <code>Array</code>, <code>Object</code> or <code>NodeList</code>.</p><h5>callback</h5><p> Type: <code>Function</code></p><p>Callback function for each iteration.</p><h5>context</h5><p>Type: <code>Array|Object|NodeList</code> Default: <code>null</code></p><p> Object/NodeList/Array that <code>forEach</code> is iterating over, to use as the <code>this</code> value when executing callback.</p><h3>Code</h3><p>For those interested, check out the code below, the latest version is available <a href="//github.com/toddmotto/foreach">on GitHub</a>.</p><div class="highlight"><pre><code data-lang="javascript" class="language-javascript" ><span class="kd">var</span> <span class="nx">forEach</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">collection</span><span class ="p">,</span> <span class="nx">callback</span><span class="p">,</span> <span class="nx">scope</span><span class="p">)</span> <span class="p">{</span>  <span class="k">if</span> <span class ="p">(</span><span class="nb">Object</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">toString</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">collection</span><span class="p">)</span> <span class="o">===</span> <span class="s1">'[object Object]'</span><span class="p" >)</span> <span class="p">{</span>    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">prop</span> <span class="k">in</span> <span class="nx" >collection</span><span class="p">)</span> <span class="p">{</span>      <span class="k">if</span> <span class="p">(</span><span class="nb">Object</span><span class="p">.</span><span class ="nx">prototype</span><span class="p">.</span><span class="nx">hasOwnProperty</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">collection </span><span class="p">,</span> <span class="nx">prop</span><span class="p">))</span> <span class="p">{</span>        <span class="nx">callback</span><span class="p">.</span><span class= "nx">call</span><span class="p">(</span><span class="nx">scope</span><span class="p">,</span> <span class="nx">collection</span><span class="p">[</span><span class="nx">prop</span><span class="p">],</span> <span class="nx">prop</span><span class="p">,</span> <span class="nx">collection</span><span class="p">);</span>      <span class="p">}</span>    <span class="p">} </span>  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i </span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">collection</span><span class="p">. </span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>      <span class="nx"> callback</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">scope</span><span class="p">,</span> <span class="nx">collection</span><span class="p">[</span><span class="nx">i</span><span class="p">],</span> <span class="nx">i</span><span class="p">,</span> <span class="nx">collection</span><span class="p">);</span>    <span class="p">}</span>  <span class="p">}</span><span class="p">};</span></code></pre></div>    </article>			</div>		<!--=========================			END : POST =============================-->		<!--=========================			START : POST		=============================-->		<div class="post-wrapper">		<article class= "post clear">      <h1 class="post__title">        Understanding the "this" keyword in JavaScript      </h1>      <p>It's safe to say that the <code>this</code> keyword is probably one of the misunderstood parts of JavaScript. Admittedly, I used to throw the <code>this</code> keyword around until my script worked and it confused the hell out of me (and still does many other JS developers) around the world. Only when I learned about lexical scope, how functions are invoked, scope context, a few context changing methods - I really understood it.</p><p> Before you dive into this article, here's a few very important points to takeaway and remember about the <code>this</code> keyword:</p><ul><li>The <code>this</code> keyword's value has nothing to do with the function itself, how the function is called determines the <code>this</code> value</li><li>It can be dynamic, based on how the function is called</li><li>You can change the <code>this</code> context through <code>.call()</code>, <code>.apply()</code> and <code>.bind()</code></li></ul><h3>Default <code>this</code> context</h3><p>There are a few different ways the <code>this</code> value changes, and as we know it's usually the call-site that creates the context.</p><h4>Window Object, global scope</h4><p>Let's take a quick example at how simply calling regular functions binds the <code>this</code> value differently:</p><div class="highlight"><pre><code data-lang="javascript" class="language-javascript"><span class="c1">// define a function</span><span class="kd">var</span> <span class="nx">myFunction</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="k">this</span><span class="p">); </span><span class="p">};</span><span class="c1">// call it</span><span class="nx">myFunction</span><span class="p">();</span></code></pre></div><p>What can we expect the <code>this</code> value to be? By default, this should always be the <code>window</code> Object, which refers to the root - the global scope. So when we <code>console.log(this);</code> from our function, as it's invoked by the window (simply just called), we should expect the <code>this</code> value to be our <code>window</code> Object:</p><div class="highlight"><pre><code data-lang= "javascript" class="language-javascript"><span class="c1">// define a function</span><span class="kd">var</span> <span class="nx">myFunction</span> <span class="o">=</span> <span class= "kd">function</span> <span class="p">()</span> <span class="p">{</span>  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="k">this</span><span class="p">);</span> <span class="c1">// [object Window]</span><span class="p">};</span><span class="c1">// call it</span><span class="nx">myFunction</span><span class="p">();</span></code></pre></div><h4>Object literals</h4><p>Inside Object literals, the <code>this</code> value will always refer to it's own Object. Nice and simple to remember. That is good news when invoking our functions, and one of the reasons I adopt patterns such as the module pattern for organising my objects.</p><p>Here's how that might look:</p><div class ="highlight"><pre><code data-lang="javascript" class="language-javascript"><span class="c1">// create an object</span><span class="kd">var</span> <span class="nx">myObject</span> <span class="o">=</span> <span class="p">{};</span><span class="c1">// create a method on our object</span><span class="nx">myObject</span><span class="p">.</span><span class="nx">someMethod </span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>  <span class="nx">console</span><span class="p">.</span><span class= "nx">log</span><span class="p">(</span><span class="k">this</span><span class="p">);</span><span class="p">};</span><span class="c1">// call our method</span><span class="nx">myObject </span><span class="p">.</span><span class="nx">someMethod</span><span class="p">();</span></code></pre></div><p>Here, our <code>window</code> Object didn't invoke the function - our Object did, so <code>this</code> will refer to the Object that called it:</p><div class="highlight"><pre><code data-lang="javascript" class="language-javascript"><span class="c1">// create an object</span><span class="kd">var</span> <span class="nx">myObject</span> <span class="o">=</span> <span class="p">{};</span><span class="c1">// create a method on our object </span><span class="nx">myObject</span><span class="p">.</span><span class="nx">someMethod</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="k">this</span><span class="p">);</span> <span class="c1">// myObject</span><span class="p">};</span><span class="c1">// call our method</span><span class="nx">myObject</span><span class="p">.</span><span class="nx">someMethod </span><span class="p">();</span></code></pre></div><h4>Prototypes and Constructors</h4><p>The same applies with Constructors:</p><div class="highlight"><pre><code data-lang="javascript" class="language-javascript"><span class="kd">var</span> <span class="nx">myConstructor</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>    <span class="k">this</span><span class="p">.</span><span class="nx">someMethod</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">() </span> <span class="p">{</span>        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="k">this</span><span class="p" >);</span>    <span class="p">};</span><span class="p">};</span><span class="kd">var</span> <span class="nx">a</span> <span class="o">=</span> <span class="k">new</span> <span class="nx"> myConstructor</span><span class="p">();</span><span class="nx">a</span><span class="p">.</span><span class="nx">someMethod</span><span class="p">();</span></code></pre></div><p>And we can add a Prototype Object as well:</p><div class="highlight"><pre><code data-lang="javascript" class="language-javascript"><span class="kd">var</span> <span class="nx">myConstructor</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>    <span class="k">this</span><span class="p">.</span><span class="nx"> someMethod</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>        <span class="nx">console</span><span class="p">. </span><span class="nx">log</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>    <span class="p">};</span><span class="p">};</span><span class="nx"> myConstructor</span><span class="p">.</span><span class="nx">prototype</span> <span class="o">=</span> <span class="p">{</span>    <span class="nx">somePrototypeMethod</span><span class= "o">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>        <span class="nx">console</span><span class="p">.</span><span class="nx">log </span><span class="p">(</span><span class="k">this</span><span class="p">);</span>    <span class="p">}</span><span class="p">};</span><span class="kd">var</span> <span class="nx">a </span> <span class="o">=</span> <span class="k">new</span> <span class="nx">myConstructor</span><span class="p">();</span><span class="nx">a</span><span class="p">.</span><span class="nx" >someMethod</span><span class="p">();</span><span class="nx">a</span><span class="p">.</span><span class="nx">somePrototypeMethod</span><span class="p">();</span></code></pre></div><p> Interestingly, in both cases the <code>this</code> value will refer to the Constructor object, which will be <code>myConstructor</code>.</p><h4>Events</h4><p>When we bind events, the same rule applies, the <code>this</code> value points to the owner. The owner in the following example would be the element.</p><div class="highlight"><pre><code data-lang="javascript" class= "language-javascript"><span class="c1">// let's assume .elem is &lt;div class="elem"&gt;&lt;/div&gt;</span><span class="kd">var</span> <span class="nx">element</span> <span class="o">= </span> <span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s1">'.elem'</span><span class="p">);</span><span class="kd">var</span> <span class="nx">someMethod</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>  <span class="nx"> console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="k">this</span><span class="p">);</span><span class="p">};</span><span class="nx"> element</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s1">'click'</span><span class="p">,</span> <span class="nx">someMethod </span><span class="p">,</span> <span class="kc">false</span><span class="p">);</span></code></pre></div><p>Here, <code>this</code> would refer to <code>&lt;div class="elem"&gt;&lt;/div &gt;</code>.</p><h3>Dynamic <code>this</code></h3><p>The second point I made in the intro paragraph was that <code>this</code> is dynamic, which means the value could change. Here's a real simple example to show that:</p><div class="highlight"><pre><code data-lang="javascript" class="language-javascript"><span class="c1">// let's assume .elem is &lt;div class="elem" &gt;&lt;/div&gt;</span><span class="kd">var</span> <span class="nx">element</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx"> querySelector</span><span class="p">(</span><span class="s1">'.elem'</span><span class="p">);</span><span class="c1">// our function</span><span class="kd">var</span> <span class="nx"> someMethod</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="k">this</span><span class="p">);</span><span class="p">};</span><span class="c1">// when clicked, `this` will become the element </span><span class="nx">element</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s1">'click'</span><span class="p">,</span> <span class="nx">someMethod</span><span class="p">,</span> <span class="kc">false</span><span class="p">);</span> <span class="c1">// &lt;div&gt;</span><span class="c1">// if we just invoke the function, `this` becomes the window object</span><span class="nx">someMethod</span><span class="p">();</span> <span class="c1">// [object Window]</span></code></pre></div><h3>Changing <code>this</code> context</h3><p>There are often many reasons why we need to change the context of a function, and thankfully we have a few methods at our disposal, these being <code> .call()</code>, <code>.apply()</code> and <code>.bind()</code>.</p><p>Using any of the above will allow you to change the context of a function, which in effect will change the <code>this </code> value. You'll use this when you want <code>this</code> to refer to something different than the scope it's in.</p><h4>Using <code>.call()</code>, <code>.apply()</code> and <code> .bind()</code></h4><p>"Functions are first class Objects" you'll often hear, this means they can also have their own methods!</p><p>The <code>.call()</code> method allows you to change the scope with a specific syntax <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function/call">ref</a>:</p><div class="highlight"><pre><code data-lang="javascript" class="language-javascript"><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">thisArg</span><span class="p">[,</span> <span class="nx">arg1</span><span class="p">[,</span> <span class="nx">arg2</span><span class="p">[,</span> <span class="p">...]]]);</span></code></pre></div><p>Usage would look something like this:</p><div class="highlight"><pre><code data-lang="javascript" class="language-javascript"><span class="nx">someMethod</span><span class="p">.</span><span class="nx">call </span><span class="p">(</span><span class="nx">anotherScope</span><span class="p">,</span> <span class="nx">arg1</span><span class="p">,</span> <span class="nx">arg1</span><span class="p" >);</span></code></pre></div><p>You'll notice further arguments are all comma separated - this is the only difference between <code>.call()</code> and <code>.apply()</code>:</p><div class= "highlight"><pre><code data-lang="javascript" class="language-javascript"><span class="nx">someMethod</span><span class="p">.</span><span class="nx">call</span><span class="p">( </span><span class="nx">anotherScope</span><span class="p">,</span> <span class="nx">arg1</span><span class="p">,</span> <span class="nx">arg1</span><span class="p">);</span> <span class= "c1">// commas</span><span class="nx">someMethod</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="nx">anotherScope</span><span class="p">, </span> <span class="p">[</span><span class="nx">arg1</span><span class="p">,</span> <span class="nx">arg1</span><span class="p">]);</span> <span class="c1">// array </span></code></pre></div><p>With any of the above, they immediately invoke the function. Here's an example:</p><div class="highlight"><pre><code data-lang="javascript" class= "language-javascript"><span class="kd">var</span> <span class="nx">myFunction</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{ </span>  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="k">this</span><span class="p">);</span><span class="p">}; </span><span class="nx">myFunction</span><span class="p">.</span><span class="nx">call</span><span class="p">();</span></code></pre></div><p>Without any arguments, the function is just invoked and <code>this</code> will remain as the <code>window</code> Object.</p><p>Here's a more practical usage, this script will always refer to the <code>window</code> Object:</p><div class="highlight"><pre><code data-lang="javascript" class="language-javascript"><span class="kd">var</span> <span class="nx">numbers</span> <span class="o">=</span> <span class="p">[{ </span>  <span class="nx">name</span><span class="o">:</span> <span class="s1">'Mark'</span><span class="p">},{</span>  <span class="nx">name</span><span class="o">:</span> <span class= "s1">'Tom'</span><span class="p">},{</span>  <span class="nx">name</span><span class="o">:</span> <span class="s1">'Travis'</span><span class="p">}];</span><span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class= "o">&lt;</span> <span class="nx">numbers</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class= "p">)</span> <span class="p">{</span>  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="k">this</span><span class="p"> );</span> <span class="c1">// window</span><span class="p">}</span></code></pre></div><p>The <code>forEach</code> method also has the same effect, it's a function so it creates new scope: </p><div class="highlight"><pre><code data-lang="javascript" class="language-javascript"><span class="kd">var</span> <span class="nx">numbers</span> <span class="o">=</span> <span class= "p">[{</span>  <span class="nx">name</span><span class="o">:</span> <span class="s1">'Mark'</span><span class="p">},{</span>  <span class="nx">name</span><span class="o">:</span> <span class="s1">'Tom'</span><span class="p">},{</span>  <span class="nx">name</span><span class="o">:</span> <span class="s1">'Travis'</span><span class="p">}];</span><span class="nx">numbers </span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>  <span class="nx"> console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="k">this</span><span class="p">);</span> <span class="c1">// window</span><span class= "p">});</span></code></pre></div><p>We could change each iteration's scope to the current element's value inside a regular <code>for</code> loop as well, and use <code>this</code> to access object properties:</p><div class="highlight"><pre><code data-lang="javascript" class="language-javascript"><span class="kd">var</span> <span class="nx">numbers</span> <span class= "o">=</span> <span class="p">[{</span>  <span class="nx">name</span><span class="o">:</span> <span class="s1">'Mark'</span><span class="p">},{</span>  <span class="nx">name</span><span class="o">:</span> <span class="s1">'Tom'</span><span class="p">},{</span>  <span class="nx">name</span><span class="o">:</span> <span class="s1">'Travis'</span><span class="p">}]; </span><span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">numbers</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i </span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>  <span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{ </span>    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx"> name</span><span class="p">);</span> <span class="c1">// Mark, Tom, Travis</span>  <span class="p">}).</span><span class="nx">call</span><span class="p">(</span><span class="nx">numbers </span><span class="p">[</span><span class="nx">i</span><span class="p">]);</span><span class="p">}</span></code></pre></div><p>This is especially extensible when passing around other Objects that you might want to run through the exact same functions.</p><h5>forEach scoping</h5><p>Not many developers using <code>forEach</code> know that you can change the initial scope context via the second argument:</p><div class="highlight"><pre><code data-lang="javascript" class="language-javascript"><span class="nx">numbers</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>  <span class="nx">console</span><span class="p">. </span><span class="nx">log</span><span class="p">(</span><span class="k">this</span><span class="p">);</span> <span class="c1">// this = Array [{ name: 'Mark' },{ name: 'Tom' },{ name: 'Travis' }]</span><span class="p">},</span> <span class="nx">numbers</span><span class="p">);</span> <span class="c1">// BOOM, scope change!</span></code></pre></div><p>Of course the above example doesn't change the scope to how we want it, as it changes the functions scope for every iteration, not each individual one - though it has use cases for sure!</p><p>To get the <em>ideal</em> setup, we need:</p><div class="highlight"><pre><code data-lang="javascript" class="language-javascript"><span class="kd">var</span> <span class="nx">numbers</span> <span class="o">=</span> <span class="p">[{</span>  <span class="nx">name</span><span class="o">:</span> <span class="s1">'Mark'</span><span class="p">},{</span>  <span class="nx">name </span><span class="o">:</span> <span class="s1">'Tom'</span><span class="p">},{</span>  <span class="nx">name</span><span class="o">:</span> <span class="s1">'Travis'</span><span class= "p">}];</span><span class="nx">numbers</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">item</span><span class="p">)</span> <span class="p">{</span>  <span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">name </span><span class="p">);</span> <span class="c1">// Mark, Tom, Travis</span>  <span class="p">}).</span><span class="nx">call</span><span class="p">(</span><span class="nx">item </span><span class="p">);</span><span class="p">});</span></code></pre></div><h4><code>.bind()</code></h4><p>Using <code>.bind()</code> is an ECMAScript 5 addition to JavaScript, which means it's not supported in all browsers (but can be polyfilled so you're all good if you need it). Bind has the same effect as <code>.call()</code>, but instead binds the function's context <em>prior</em> to being invoked, this is essential to understand the difference. Using <code>.bind()</code> <em>will not</em> invoke the function, it just "sets it up".</p><p> Here's a really quick example of how you'd setup the context for a function, I've used <code>.bind()</code> to change the context of the function, which by default the <code>this</code> value would be the window Object.</p><div class="highlight"><pre><code data-lang="javascript" class="language-javascript"><span class="kd">var</span> <span class="nx">obj</span> <span class="o">=</span> <span class="p">{};</span><span class="kd">var</span> <span class="nx">someMethod</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">() </span> <span class="p">{</span>  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="k">this</span><span class="p">); </span> <span class="c1">// this = obj</span><span class="p">}.</span><span class="nx">bind</span><span class="p">(</span><span class="nx">obj</span><span class="p">);</span><span class= "nx">someMethod</span><span class="p">();</span></code></pre></div><p>This is a really simple use case, they can also be used in event handlers as well to pass in some extra information without a needless anonymous function:</p><div class="highlight"><pre><code data-lang="javascript" class="language-javascript"><span class="kd">var</span> <span class="nx">obj</span> <span class="o">=</span> <span class="p">{};</span><span class="kd">var</span> <span class="nx">element</span> <span class="o">=</span> <span class="nb">document</span><span class="p">. </span><span class="nx">querySelector</span><span class="p">(</span><span class="s1">'.elem'</span><span class="p">);</span><span class="kd">var</span> <span class="nx">someMethod</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>  <span class="nx">console</span><span class="p">.</span><span class="nx">log </span><span class="p">(</span><span class="k">this</span><span class="p">);</span><span class="p">};</span><span class="nx">element</span><span class="p">.</span><span class="nx"> addEventListener</span><span class="p">(</span><span class="s1">'click'</span><span class="p">,</span> <span class="nx">someMethod</span><span class="p">.</span><span class="nx">bind </span><span class="p">(</span><span class="nx">obj</span><span class="p">),</span> <span class="kc">false</span><span class="p">);</span> <span class="c1">// bind </span></code></pre></div><h3>"Jumping scope"</h3><p>I call this jumping scope, but essentially it's just some slang for accessing a lexical scope reference (also a bit easier to remember...).</p><p>There are many times when we need to access lexical scope. Lexical scope is where variables and functions are still accessible to us in parent scopes.</p><div class= "highlight"><pre><code data-lang="javascript" class="language-javascript"><span class="kd">var</span> <span class="nx">obj</span> <span class="o">=</span> <span class="p">{};</span><span class="nx">obj</span><span class="p">.</span><span class="nx">myMethod</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="k">this</span><span class="p">);</span> <span class="c1">// this = `obj`</span><span class="p">};</span><span class="nx">obj</span><span class="p">.</span><span class="nx">myMethod</span><span class="p">();</span></code></pre></div><p>In the above scenario, <code>this</code> binds perfectly, but what happens when we introduce another function. How many times have you encountered a scope challenge when using a function such as <code> setTimeout</code> inside another function? It totally screws up any <code>this</code> reference:</p><div class="highlight"><pre><code data-lang="javascript" class="language-javascript" ><span class="kd">var</span> <span class="nx">obj</span> <span class="o">=</span> <span class="p">{};</span><span class="nx">obj</span><span class="p">.</span><span class="nx">myMethod </span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>  <span class="nx">console</span><span class="p">.</span><span class= "nx">log</span><span class="p">(</span><span class="k">this</span><span class="p">);</span> <span class="c1">// this = obj</span>    <span class="nx">setTimeout</span><span class="p">( </span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="k">this</span><span class="p">);</span> <span class="c1">// window object :O!!!</span>    <span class="p">},</span> <span class="mi">100</span><span class= "p">);</span><span class="p">};</span><span class="nx">obj</span><span class="p">.</span><span class="nx">myMethod</span><span class="p">();</span></code></pre></div><p>So what happened there? As we know, <a href="/everything-you-wanted-to-know-about-javascript-scope">functions create scope</a>, and <code>setTimeout</code> will be invoked by itself, defaulting to the <code>window</code> Object, and thus making the <code>this</code> value a bit strange inside that function.</p><h5>Important note: <code>this</code> and the <code>arguments</code> Object are the only objects that <em>don't</em> follow the rules of lexical scope.</h5><p>How can we fix it? There are a few options! If we're using <code>.bind()</code>, it's an easy fix, note the usage on the end of the function:</p><div class="highlight"><pre><code data-lang="javascript" class="language-javascript"><span class="kd">var</span> <span class="nx">obj</span> <span class="o">=</span> <span class="p">{};</span><span class="nx">obj</span><span class="p">.</span><span class="nx">myMethod</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="k">this </span><span class="p">);</span> <span class="c1">// this = obj</span>    <span class="nx">setTimeout</span><span class="p">(</span><span class="kd">function</span> <span class="p">() </span> <span class="p">{</span>        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="k">this</span><span class="p" >);</span> <span class="c1">// this = obj</span>    <span class="p">}.</span><span class="nx">bind</span><span class="p">(</span><span class="k">this</span><span class="p">),</span> <span class="mi">100</span><span class="p">);</span> <span class="c1">// .bind() #ftw</span><span class="p">};</span><span class="nx">obj</span><span class="p">.</span><span class="nx">myMethod </span><span class="p">();</span></code></pre></div><p>We can also use the jumping scope trick, <code>var that = this;</code>:</p><div class="highlight"><pre><code data-lang="javascript" class="language-javascript"><span class="kd">var</span> <span class="nx">obj</span> <span class="o">=</span> <span class="p">{};</span><span class="nx">obj</span><span class="p">. </span><span class="nx">myMethod</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>  <span class="kd">var</span> <span class="nx">that</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="k">this</span><span class="p">);</span> <span class="c1">// this = obj</span>    <span class="nx">setTimeout</span><span class="p">(</span><span class="kd"> function</span> <span class="p">()</span> <span class="p">{</span>        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">that</span><span class="p">);</span> <span class="c1">// that (this) = obj</span>    <span class="p">},</span> <span class="mi">100</span><span class="p">);</span><span class= "p">};</span><span class="nx">obj</span><span class="p">.</span><span class="nx">myMethod</span><span class="p">();</span></code></pre></div><p>We've cut the <code>this</code> short and just simply pushed a reference of the scope into the new scope. It's kind of cheating, but works wonders for "jumping scope". With newcomers such as <code>.bind()</code>, this technique is sometimes frowned upon if used and abused.</p><p>One thing I dislike about <code>.bind()</code> is that you could end up with something like this:</p><div class="highlight"><pre><code data-lang="javascript" class="language-javascript"><span class="kd">var</span> <span class="nx">obj</span> <span class="o">=</span> <span class="p">{};</span><span class="nx">obj </span><span class="p">.</span><span class="nx">myMethod</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>  <span class= "nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>    <span class="nx">setTimeout </span><span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>        <span class="nx">console</span><span class="p">.</span><span class ="nx">log</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>        <span class="nx">setTimeout</span><span class="p">(</span><span class="kd">function </span> <span class="p">()</span> <span class="p">{</span>            <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class= "k">this</span><span class="p">);</span>            <span class="nx">setTimeout</span><span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{ </span>                <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="k">this</span><span class="p">);</span> <span class="nx">setTimeout</span><span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>                    <span class ="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>                <span class="p">}. </span><span class="nx">bind</span><span class="p">(</span><span class="k">this</span><span class="p">),</span> <span class="mi">100</span><span class="p">);</span> <span class="c1">// bind</span>            <span class="p">}.</span><span class="nx">bind</span><span class="p">(</span><span class="k">this</span><span class="p">),</span> <span class="mi">100</span><span class="p">);</span> <span class="c1">// bind</span>        <span class="p">}.</span><span class="nx">bind</span><span class="p">(</span><span class="k">this</span><span class="p">),</span> <span class="mi">100</span><span class="p">);</span> <span class="c1">// bind</span>    <span class="p">}.</span><span class="nx">bind</span><span class="p">(</span><span class="k">this </span><span class="p">),</span> <span class="mi">100</span><span class="p">);</span> <span class="c1">// bind</span><span class="p">};</span><span class="nx">obj</span><span class="p">. </span><span class="nx">myMethod</span><span class="p">();</span></code></pre></div><p>A tonne of <code>.bind()</code> calls, which look totally stupid. Of course this is an exaggerated issue, but it can happen very easily when switching scopes. In my opinion this would be easier - it will also be tonnes quicker as we're saving lots of function calls:</p><div class= "highlight"><pre><code data-lang="javascript" class="language-javascript"><span class="kd">var</span> <span class="nx">obj</span> <span class="o">=</span> <span class="p">{};</span><span class="nx">obj</span><span class="p">.</span><span class="nx">myMethod</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span> <span class="kd">var</span> <span class="nx">that</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span> <span class="c1">// one declaration of that = this, no fn calls</span>  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>    <span class="nx">setTimeout</span><span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>        <span class="nx">console</span><span class= "p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">that</span><span class="p">);</span>        <span class="nx">setTimeout</span><span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>            <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">( </span><span class="nx">that</span><span class="p">);</span>            <span class="nx">setTimeout</span><span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>                <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">that</span><span class= "p">);</span>                <span class="nx">setTimeout</span><span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">that</span><span class="p">);</span> <span class="p">},</span> <span class="mi">100</span><span class="p">);</span>            <span class="p">},</span> <span class="mi">100</span><span class="p">);</span> <span class="p">},</span> <span class="mi">100</span><span class="p">);</span>    <span class="p">},</span> <span class="mi">100</span><span class="p">);</span><span class="p">}; </span><span class="nx">obj</span><span class="p">.</span><span class="nx">myMethod</span><span class="p">();</span></code></pre></div><p>Do what makes sense!</p><h4>jQuery $(this)</h4><p> Yes, the same applies, don't use <code>$(this)</code> unless you actually know what it's doing. What it <em>is</em> doing is passing the normal <code>this</code> value into a new jQuery Object, which will then inherit all of jQuery's prototypal methods (such as addClass), so you can instantly do this:</p><div class="highlight"><pre><code data-lang="javascript" class= "language-javascript"><span class="nx">$</span><span class="p">(</span><span class="s1">'.elem'</span><span class="p">).</span><span class="nx">on</span><span class="p">(</span><span class ="s1">'click'</span><span class="p">,</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>  <span class="nx">$</span><span class="p">(</span><span class="k">this</span><span class="p">).</span><span class="nx">addClass</span><span class="p">(</span><span class="s1">'active'</span><span class="p">);</span><span class="p">}); </span></code></pre></div><p>Happy scoping ;)</p>    </article>			</div>		<!--=========================			END : POST		=============================--> <!--=========================			START : POST		=============================-->		<div class="post-wrapper">		<h1 class="entry-title">A fresh look at JavaScript Mixins</h1>		<div class="entry-content">		<p>(<a href="http://habrahabr.ru/post/147901/" target="_blank">Russian</a>, <a href="http://d.hatena.ne.jp/kitokitoki/20111030/p1" target= "_blank">Japanese</a>)</p><p>In this article I'll explore JavaScript mixins in detail, and introduce a less conventional, but to my mind more natural mixin strategy that I hope you'll find useful. I'll finish up with a <a href="https://javascriptweblog.files.wordpress.com/2011/05/screen-shot-2011-05-30-at-5-24-15-pm.png" target="_blank">profiler matrix</a> summarizing the performance impact of each technique. [A big Thank You to the brilliant <a href="https://twitter.com/kitcambridge" target="_blank">@kitcambridge</a> for reviewing and improving the code on which this blog is based!]<br><strong><span id="more-2613"></span></strong><br><span style="font-weight:bold;font-size:18px;">Re-using Functions</span></p><p>In JavaScript, every object references a prototype object from which it can inherit properties. Prototypes are great instruments for re-use: a single prototype instance can define properties for an infinite number of dependent instances. Prototypes may also inherit from other prototypes, thus forming prototype chains which more-or-less mimic the inheritance hierarchies of classical languages like Java and C++. Multi-tiered inheritance hierarchies are occasionally useful for describing the natural order of objects but if the primary motivation is function re-use they can quickly become gnarly labyrinths of meaningless subtypes, frustrating redundancies and unmanageable logic (“is a button a rectangle or is it a control? tell you what, lets make Button inherit from Rectangle, and Rectangle can inherit from Control…wait a minute….”).</p><p>Fortunately, when it comes to function re-use, JavaScript offers viable alternatives. In contrast to more rigidly structured languages, JavaScript objects can invoke any public function regardless of lineage. The most straightforward approach is delegation – any public function can be invoked directly via <code>call</code> or <code>apply</code>. It's a powerful feature and I use it extensively. However delegation is so convenient that sometimes it actually works against structural discipline in your code; moreover the syntax can get a little wordy. Mixins are a great compromise, allowing entire functional units to be borrowed and accessed with minimal syntax and they play very well with prototypes. They offer the descriptive prowess of hierarchical inheritance without the brain-cracking issues associated with multi-tiered, single-rooted ancestry.<br><br><span style="font-weight:bold;font-size:18px;"> The Basics </span></p><p>In general computer science, a mixin is a class that defines a set of functions relating to a type (e.g. Person, Circle, Observer). Mixins classes are usually considered abstract in that they will not themselves be instantiated – instead their functions are copied (or ‘borrowed') by concrete classes as a means of ‘inheriting' behaviour without entering into a formal relationship with the behaviour provider. </p><p>OK but this is JavaScript, and we have no classes. This is actually a good thing because it means we can use objects (instances) instead, which offer clarity and flexibility: our mixin can be a regular object, a prototype, a function – whatever, and the mixin process becomes transparent and obvious.<br><br><span style="font-weight:bold;font-size:18px;"> The Use Case </span></p><p>I'm going to discuss a number of mixin techniques but all the coding examples are directed towards one use case: creating circular, oval or rectangular buttons. Here's a schematic representation (rendered using the latest high tech gadgetry). Square boxes represent mixin objects, rounded boxes represent the actual buttons… </p><p><img src=" https://javascriptweblog.files.wordpress.com/2011/05/mixin3.jpg?w=660" alt="" title="mixin" class="alignnone size-full wp-image-2644" style="border:none;margin:0;padding:0;"><br>&nbsp; <br><br><span style="font-weight:bold;font-size:18px;">1. Classic Mixins</span></p><p>Scanning the first two pages returned from a google search for “javascript mixin” I noticed the majority of authors define the mixin object as full-blown constructor type with its function-set defined in the prototoype. This could be seen as a natural progression – early mixins were classes and this is the closest thing JavaScript has to a class. Here's a circle mixin modeled after that style:</p><div><div id="highlighter_452789" class="syntaxhighlighter  jscript" ><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="jscript keyword">var </code> <code class="jscript plain">Circle = </code><code class="jscript keyword">function</code><code class="jscript plain">() {};</code></div><div class="line number2 index1 alt1"><code class="jscript plain">Circle.prototype = {</code></div><div class="line number3 index2 alt2"><code class="jscript spaces">&nbsp;&nbsp;</code><code class="jscript plain">area: </code><code class="jscript keyword">function</code><code class="jscript plain">() {</code></div><div class="line number4 index3 alt1"><code class="jscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript keyword">return</code> <code class="jscript plain">Math.PI * </code><code class="jscript keyword">this</code><code class="jscript plain">.radius * </code><code class= "jscript keyword">this</code><code class="jscript plain">.radius;</code></div><div class="line number5 index4 alt2"><code class="jscript spaces">&nbsp;&nbsp;</code><code class="jscript plain">},</code></div><div class="line number6 index5 alt1"><code class="jscript spaces">&nbsp;&nbsp;</code><code class="jscript plain">grow: </code><code class="jscript keyword">function </code><code class="jscript plain">() {</code></div><div class="line number7 index6 alt2"><code class="jscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript keyword">this </code><code class="jscript plain">.radius++;</code></div><div class="line number8 index7 alt1"><code class="jscript spaces">&nbsp;&nbsp;</code><code class="jscript plain">}, </code></div><div class="line number9 index8 alt2"><code class="jscript spaces">&nbsp;&nbsp;</code><code class="jscript plain">shrink: </code><code class="jscript keyword">function </code><code class="jscript plain">() {</code></div><div class="line number10 index9 alt1"><code class="jscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript keyword">this </code><code class="jscript plain">.radius--;</code></div><div class="line number11 index10 alt2"><code class="jscript spaces">&nbsp;&nbsp;</code><code class="jscript plain">} </code></div><div class="line number12 index11 alt1"><code class="jscript plain">};&nbsp;&nbsp;&nbsp; </code></div></div></td></tr></tbody></table></div></div><p>&nbsp;<br>In practice, however, such a heavyweight mixin is unnecessary. A simple object literal will suffice:</p><div><div id="highlighter_687044" class="syntaxhighlighter  jscript"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7 </div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11 </div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="jscript keyword">var</code> <code class="jscript plain">circleFns = {</code></div><div class="line number2 index1 alt1"><code class="jscript spaces">&nbsp;&nbsp;</code><code class="jscript plain">area: </code><code class="jscript keyword">function</code><code class= "jscript plain">() {</code></div><div class="line number3 index2 alt2"><code class="jscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript keyword">return</code> <code class= "jscript plain">Math.PI * </code><code class="jscript keyword">this</code><code class="jscript plain">.radius * </code><code class="jscript keyword">this</code><code class="jscript plain"> .radius;</code></div><div class="line number4 index3 alt1"><code class="jscript spaces">&nbsp;&nbsp;</code><code class="jscript plain">},</code></div><div class="line number5 index4 alt2" ><code class="jscript spaces">&nbsp;&nbsp;</code><code class="jscript plain">grow: </code><code class="jscript keyword">function</code><code class="jscript plain">() {</code></div><div class="line number6 index5 alt1"><code class="jscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript keyword">this</code><code class="jscript plain">.radius++; </code></div><div class="line number7 index6 alt2"><code class="jscript spaces">&nbsp;&nbsp;</code><code class="jscript plain">},</code></div><div class="line number8 index7 alt1"><code class="jscript spaces">&nbsp;&nbsp;</code><code class="jscript plain">shrink: </code><code class="jscript keyword">function</code><code class="jscript plain">() {</code></div><div class= "line number9 index8 alt2"><code class="jscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript keyword">this</code><code class="jscript plain">.radius--;</code></div><div class="line number10 index9 alt1"><code class="jscript spaces">&nbsp;&nbsp;</code><code class="jscript plain">}</code></div><div class="line number11 index10 alt2"><code class="jscript plain">};&nbsp;&nbsp;&nbsp; </code></div></div></td></tr></tbody></table></div></div><p>&nbsp;<br><span style="font-weight:bold;font-size:16px;">the extend function</span></p><p>And how does such a mixin object get mixed into your object? By means of an <code>extend</code> function (sometimes known as <code>augment</code>). Usually <code>extend</code> simply copies (not clones) the mixin's functions into the receiving object. A quick survey reveals some minor variations in this implementation. For example Prototype.js omits a <code>hasOwnProperty</code> check (suggesting the mixin will have no enumerable properties in its prototype chain) while other versions assume you want to only copy the mixin's prototype object. Here's a version that is both safe and flexible…</p><div><div id="highlighter_496085" class="syntaxhighlighter  jscript"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class= "line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div></td><td class= "code"><div class="container"><div class="line number1 index0 alt2"><code class="jscript keyword">function</code> <code class="jscript plain">extend(destination, source) {</code></div><div class="line number2 index1 alt1"><code class="jscript spaces">&nbsp;&nbsp;</code><code class="jscript keyword">for</code> <code class="jscript plain">(</code><code class="jscript keyword" >var</code> <code class="jscript plain">k </code><code class="jscript keyword">in</code> <code class="jscript plain">source) {</code></div><div class="line number3 index2 alt2"><code class ="jscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript keyword">if</code> <code class="jscript plain">(source.hasOwnProperty(k)) {</code></div><div class="line number4 index3 alt1"><code class="jscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript plain">destination[k] = source[k];</code></div><div class="line number5 index4 alt2"><code class="jscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript plain">}</code></div><div class="line number6 index5 alt1"><code class="jscript spaces">&nbsp;&nbsp; </code><code class="jscript plain">}</code></div><div class="line number7 index6 alt2"><code class="jscript spaces">&nbsp;&nbsp;</code><code class="jscript keyword">return</code> <code class="jscript plain">destination; </code></div><div class="line number8 index7 alt1"><code class="jscript plain">}</code></div></div></td></tr></tbody></table></div></div><p>&nbsp;<br> …which we can call to extend our prototype…</p><div><div id="highlighter_484216" class="syntaxhighlighter  jscript"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class= "gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4 </div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8 </div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="jscript keyword">var</code> <code class="jscript plain">RoundButton = </code><code class="jscript keyword">function</code><code class="jscript plain">(radius, label) {</code></div><div class="line number2 index1 alt1"><code class="jscript spaces">&nbsp;&nbsp;</code><code class="jscript keyword">this</code><code class="jscript plain">.radius = radius;</code></div><div class="line number3 index2 alt2"><code class="jscript spaces">&nbsp;&nbsp;</code><code class="jscript keyword">this</code><code class="jscript plain">.label = label;</code></div><div class="line number4 index3 alt1"><code class="jscript plain">};</code></div><div class= "line number5 index4 alt2">&nbsp;</div><div class="line number6 index5 alt1"><code class="jscript plain">extend(RoundButton.prototype, circleFns);</code></div><div class="line number7 index6 alt2"><code class="jscript plain">extend(RoundButton.prototype, buttonFns);</code></div><div class="line number8 index7 alt1"><code class="jscript comments">//etc. ... </code></div></div></td></tr></tbody></table></div></div><p>&nbsp;<br><span style="font-weight:bold;font-size:18px;">2. Functional Mixins</span></p><p>If the functions defined by mixins are intended solely for the use of other objects, why bother creating mixins as regular objects at all? Put another way, a mixin should be a process not an object. The logical conclusion is to make our mixins into functions into which consumer objects inject themselves by delegation, thus cutting out the middle guy (the <code>extend</code> function) entirely.</p><div><div id="highlighter_391456" class="syntaxhighlighter  jscript"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class= "line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class= "line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class= "jscript keyword">var</code> <code class="jscript plain">asCircle = </code><code class="jscript keyword">function</code><code class="jscript plain">() {</code></div><div class="line number2 index1 alt1"><code class="jscript spaces">&nbsp;&nbsp;</code><code class="jscript keyword">this</code><code class="jscript plain">.area = </code><code class="jscript keyword"> function</code><code class="jscript plain">() {</code></div><div class="line number3 index2 alt2"><code class="jscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript keyword"> return</code> <code class="jscript plain">Math.PI * </code><code class="jscript keyword">this</code><code class="jscript plain">.radius * </code><code class="jscript keyword">this </code><code class="jscript plain">.radius;</code></div><div class="line number4 index3 alt1"><code class="jscript spaces">&nbsp;&nbsp;</code><code class="jscript plain">}; </code></div><div class="line number5 index4 alt2"><code class="jscript spaces">&nbsp;&nbsp;</code><code class="jscript keyword">this</code><code class="jscript plain">.grow = </code><code class="jscript keyword">function</code><code class="jscript plain">() {</code></div><div class="line number6 index5 alt1"><code class="jscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript keyword">this</code><code class="jscript plain">.radius++;</code></div><div class="line number7 index6 alt2"><code class="jscript spaces">&nbsp;&nbsp;</code><code class= "jscript plain">};</code></div><div class="line number8 index7 alt1"><code class="jscript spaces">&nbsp;&nbsp;</code><code class="jscript keyword">this</code><code class="jscript plain"> .shrink = </code><code class="jscript keyword">function</code><code class="jscript plain">() {</code></div><div class="line number9 index8 alt2"><code class="jscript spaces"> &nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript keyword">this</code><code class="jscript plain">.radius--;</code></div><div class="line number10 index9 alt1"><code class="jscript spaces">&nbsp;&nbsp;</code><code class="jscript plain">};</code></div><div class="line number11 index10 alt2"><code class="jscript spaces">&nbsp;&nbsp;</code><code class="jscript keyword"> return</code> <code class="jscript keyword">this</code><code class="jscript plain">;</code></div><div class="line number12 index11 alt1"><code class="jscript plain">};</code></div><div class="line number13 index12 alt2">&nbsp;</div><div class="line number14 index13 alt1"><code class="jscript keyword">var</code> <code class="jscript plain">Circle = </code><code class= "jscript keyword">function</code><code class="jscript plain">(radius) {</code></div><div class="line number15 index14 alt2"><code class="jscript spaces">&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="jscript keyword">this</code><code class="jscript plain">.radius = radius;</code></div><div class="line number16 index15 alt1"><code class="jscript plain">}; </code></div><div class="line number17 index16 alt2"><code class="jscript plain">asCircle.call(Circle.prototype);</code></div><div class="line number18 index17 alt1"><code class="jscript keyword">var</code> <code class="jscript plain">circle1 = </code><code class="jscript keyword">new</code> <code class="jscript plain">Circle(5);</code></div><div class="line number19 index18 alt2"><code class="jscript plain">circle1.area(); </code><code class="jscript comments">//78.54</code></div></div></td></tr></tbody></table></div></div><p>&nbsp;<br>This approach feels right. Mixins as verbs instead of nouns; lightweight one stop function shops.  There are other things to like here too – the programming style is natural and concise: <code>this </code> always refers to the receiver of the function set, instead of an abstract object we don't need and will never use; moreover, in contrast to the traditional approach, we don't have to protect against inadvertent copying of inherited properties and (for what its worth) functions are now cloned instead of copied.</p><p>Now here's a mixin for the button functions… </p><div><div id="highlighter_958233" class="syntaxhighlighter  jscript"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5 </div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9 </div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div></td><td class="code"><div class= "container"><div class="line number1 index0 alt2"><code class="jscript keyword">var</code> <code class="jscript plain">asButton = </code><code class="jscript keyword">function</code><code class="jscript plain">() {</code></div><div class="line number2 index1 alt1"><code class="jscript spaces">&nbsp;&nbsp;</code><code class="jscript keyword">this</code><code class="jscript plain">.hover = </code><code class="jscript keyword">function</code><code class="jscript plain">(bool) {</code></div><div class="line number3 index2 alt2"><code class="jscript spaces"> &nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript plain">bool ? mylib.appendClass(</code><code class="jscript string">'hover'</code><code class="jscript plain">) : mylib.removeClass( </code><code class="jscript string">'hover'</code><code class="jscript plain">);</code></div><div class="line number4 index3 alt1"><code class="jscript spaces">&nbsp;&nbsp;</code><code class="jscript plain">};</code></div><div class="line number5 index4 alt2"><code class="jscript spaces">&nbsp;&nbsp;</code><code class="jscript keyword">this</code><code class="jscript plain">.press = </code><code class="jscript keyword">function</code><code class="jscript plain">(bool) {</code></div><div class="line number6 index5 alt1"><code class="jscript spaces"> &nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript plain">bool ? mylib.appendClass(</code><code class="jscript string">'pressed'</code><code class="jscript plain">) : mylib.removeClass( </code><code class="jscript string">'pressed'</code><code class="jscript plain">);</code></div><div class="line number7 index6 alt2"><code class="jscript spaces">&nbsp;&nbsp;</code><code class="jscript plain">};</code></div><div class="line number8 index7 alt1"><code class="jscript spaces">&nbsp;&nbsp;</code><code class="jscript keyword">this</code><code class="jscript plain">.fire = </code><code class="jscript keyword">function</code><code class="jscript plain">() {</code></div><div class="line number9 index8 alt2"><code class="jscript spaces"> &nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript keyword">return</code> <code class="jscript keyword">this</code><code class="jscript plain">.action();</code></div><div class="line number10 index9 alt1"><code class="jscript spaces">&nbsp;&nbsp;</code><code class="jscript plain">};</code></div><div class="line number11 index10 alt2"><code class="jscript spaces"> &nbsp;&nbsp;</code><code class="jscript keyword">return</code> <code class="jscript keyword">this</code><code class="jscript plain">;</code></div><div class="line number12 index11 alt1" ><code class="jscript plain">}; </code></div></div></td></tr></tbody></table></div></div><p>&nbsp;<br>Put the two mixins together and we've got round buttons: </p><div><div id= "highlighter_840168" class="syntaxhighlighter  jscript"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class= "line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="jscript keyword">var</code> <code class="jscript plain">RoundButton = </code><code class="jscript keyword">function</code><code class="jscript plain">(radius, label, action) {</code></div><div class="line number2 index1 alt1"><code class="jscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript keyword">this</code><code class="jscript plain">.radius = radius; </code></div><div class="line number3 index2 alt2"><code class="jscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript keyword">this</code><code class="jscript plain">.label = label;</code></div><div class="line number4 index3 alt1"><code class="jscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript keyword">this</code><code class="jscript plain"> .action = action;</code></div><div class="line number5 index4 alt2"><code class="jscript plain">};</code></div><div class="line number6 index5 alt1">&nbsp;</div><div class="line number7 index6 alt2"><code class="jscript plain">asButton.call(RoundButton.prototype);</code></div><div class="line number8 index7 alt1"><code class="jscript plain"> asCircle.call(RoundButton.prototype);</code></div><div class="line number9 index8 alt2">&nbsp;</div><div class="line number10 index9 alt1"><code class="jscript keyword">var</code> <code class="jscript plain">button1 = </code><code class="jscript keyword">new</code> <code class="jscript plain">RoundButton(4, </code><code class="jscript string">'yes!'</code><code class= "jscript plain">, </code><code class="jscript keyword">function</code><code class="jscript plain">() {</code><code class="jscript keyword">return</code> <code class="jscript string">'you said yes!'</code><code class="jscript plain">});</code></div><div class="line number11 index10 alt2"><code class="jscript plain">button1.fire(); </code><code class="jscript comments"> //'you said yes!'</code></div></div></td></tr></tbody></table></div></div><p>&nbsp;<br><span style="font-weight:bold;font-size:18px;">3. Adding Options</span></p><p>This functional strategy also allows the borrowed behaviours to be parameterized by means of an options argument. Let's see this in action by creating an <code>asOval</code> mixin with a custom grow and shrink factor:</p><div><div id="highlighter_423863" class="syntaxhighlighter  jscript"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div><div class= "line number21 index20 alt2">21</div><div class="line number22 index21 alt1">22</div><div class="line number23 index22 alt2">23</div><div class="line number24 index23 alt1">24</div><div class="line number25 index24 alt2">25</div><div class="line number26 index25 alt1">26</div><div class="line number27 index26 alt2">27</div><div class="line number28 index27 alt1">28 </div><div class="line number29 index28 alt2">29</div><div class="line number30 index29 alt1">30</div><div class="line number31 index30 alt2">31</div><div class="line number32 index31 alt1">32</div><div class="line number33 index32 alt2">33</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="jscript keyword">var</code> <code class="jscript plain">asOval = </code><code class="jscript keyword">function</code><code class="jscript plain">(options) {</code></div><div class="line number2 index1 alt1"><code class="jscript spaces">&nbsp;&nbsp;</code><code class="jscript keyword">this</code><code class="jscript plain">.area = </code><code class="jscript keyword">function</code><code class= "jscript plain">() {</code></div><div class="line number3 index2 alt2"><code class="jscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript keyword">return</code> <code class= "jscript plain">Math.PI * </code><code class="jscript keyword">this</code><code class="jscript plain">.longRadius * </code><code class="jscript keyword">this</code><code class="jscript plain">.shortRadius;</code></div><div class="line number4 index3 alt1"><code class="jscript spaces">&nbsp;&nbsp;</code><code class="jscript plain">};</code></div><div class="line number5 index4 alt2"><code class="jscript spaces">&nbsp;&nbsp;</code><code class="jscript keyword">this</code><code class="jscript plain">.ratio = </code><code class="jscript keyword">function </code><code class="jscript plain">() {</code></div><div class="line number6 index5 alt1"><code class="jscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript keyword">return </code> <code class="jscript keyword">this</code><code class="jscript plain">.longRadius/</code><code class="jscript keyword">this</code><code class="jscript plain">.shortRadius; </code></div><div class="line number7 index6 alt2"><code class="jscript spaces">&nbsp;&nbsp;</code><code class="jscript plain">};</code></div><div class="line number8 index7 alt1"><code class="jscript spaces">&nbsp;&nbsp;</code><code class="jscript keyword">this</code><code class="jscript plain">.grow = </code><code class="jscript keyword">function</code><code class= "jscript plain">() {</code></div><div class="line number9 index8 alt2"><code class="jscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript keyword">this</code><code class= "jscript plain">.shortRadius += (options.growBy/</code><code class="jscript keyword">this</code><code class="jscript plain">.ratio());</code></div><div class="line number10 index9 alt1" ><code class="jscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript keyword">this</code><code class="jscript plain">.longRadius += options.growBy;</code></div><div class= "line number11 index10 alt2"><code class="jscript spaces">&nbsp;&nbsp;</code><code class="jscript plain">};</code></div><div class="line number12 index11 alt1"><code class="jscript spaces" >&nbsp;&nbsp;</code><code class="jscript keyword">this</code><code class="jscript plain">.shrink = </code><code class="jscript keyword">function</code><code class="jscript plain">() { </code></div><div class="line number13 index12 alt2"><code class="jscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript keyword">this</code><code class="jscript plain"> .shortRadius -= (options.shrinkBy/</code><code class="jscript keyword">this</code><code class="jscript plain">.ratio());</code></div><div class="line number14 index13 alt1"><code class= "jscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript keyword">this</code><code class="jscript plain">.longRadius -= options.shrinkBy;</code></div><div class="line number15 index14 alt2"><code class="jscript spaces">&nbsp;&nbsp;</code><code class="jscript plain">};</code></div><div class="line number16 index15 alt1"><code class="jscript spaces">&nbsp;&nbsp; </code><code class="jscript keyword">return</code> <code class="jscript keyword">this</code><code class="jscript plain">;</code></div><div class="line number17 index16 alt2"><code class= "jscript plain">}</code></div><div class="line number18 index17 alt1">&nbsp;</div><div class="line number19 index18 alt2"><code class="jscript keyword">var</code> <code class="jscript plain">OvalButton = </code><code class="jscript keyword">function</code><code class="jscript plain">(longRadius, shortRadius, label, action) {</code></div><div class="line number20 index19 alt1"><code class="jscript spaces">&nbsp;&nbsp;</code><code class="jscript keyword">this</code><code class="jscript plain">.longRadius = longRadius;</code></div><div class="line number21 index20 alt2"><code class="jscript spaces">&nbsp;&nbsp;</code><code class="jscript keyword">this</code><code class="jscript plain">.shortRadius = shortRadius;</code></div><div class="line number22 index21 alt1"><code class="jscript spaces">&nbsp;&nbsp;</code><code class="jscript keyword">this</code><code class="jscript plain">.label = label;</code></div><div class="line number23 index22 alt2"><code class="jscript spaces">&nbsp;&nbsp;</code><code class="jscript keyword">this</code><code class="jscript plain">.action = action;</code></div><div class="line number24 index23 alt1"><code class="jscript plain">};</code></div><div class="line number25 index24 alt2">&nbsp;</div><div class="line number26 index25 alt1"><code class= "jscript plain">asButton.call(OvalButton.prototype);</code></div><div class="line number27 index26 alt2"><code class="jscript plain">asOval.call(OvalButton.prototype, {growBy: 2, shrinkBy: 2});</code></div><div class="line number28 index27 alt1">&nbsp;</div><div class="line number29 index28 alt2"><code class="jscript keyword">var</code> <code class="jscript plain"> button2 = </code><code class="jscript keyword">new</code> <code class="jscript plain">OvalButton(3, 2, </code><code class="jscript string">'send'</code><code class="jscript plain">, </code><code class="jscript keyword">function</code><code class="jscript plain">() {</code><code class="jscript keyword">return</code> <code class="jscript string">'message sent' </code><code class="jscript plain">});</code></div><div class="line number30 index29 alt1"><code class="jscript plain">button2.area(); </code><code class="jscript comments"> //18.84955592153876</code></div><div class="line number31 index30 alt2"><code class="jscript plain">button2.grow();</code></div><div class="line number32 index31 alt1"><code class= "jscript plain">button2.area(); </code><code class="jscript comments">//52.35987755982988 </code></div><div class="line number33 index32 alt2"><code class="jscript plain">button2.fire(); </code><code class="jscript comments">//'message sent'</code></div></div></td></tr></tbody></table></div></div><p>&nbsp;<br><span style="font-weight:bold;font-size:18px;">4. Adding Caching </span></p><p>So maybe you're concerned that this approach creates additional performance overhead because we're redefining the same functions on every call. With the help of the excellent <a href="http://jsperf.com" target="_blank">jsperf.com</a> I ran metrics on every mixin strategy over 4 browsers (you can see the results at the end of this article). Surprisingly Chrome 12 performs significantly better using the functional approach, for the other browsers the functional mixin runs about half as fast as the classic mixin. Given that these mixins are likely to be invoked just once per type definition (as opposed to once per instance creation) the time difference should not cause too much worry, especially since we're still talking 26,000 mixins per second even in IE8!  </p><p>However just in case rates like that are keeping your manager up at night, there is a solution. By forming a closure around the mixins we can cache the results of the initial definition run and the performance implications are outstanding. Functional mixins now easily outperform classic mixins in every browser (in my tests by a factor of 20 in Chrome and a factor of 13 in Firefox 4). Again it doesn't matter much either way but it leaves a nice feeling <span class="wp-smiley wp-emoji wp-emoji-wink" title=";-)">;-)</span>  </p><p>Here's a version of the <code>asRectangle</code> with caching added…</p><div><div id="highlighter_402471" class="syntaxhighlighter  jscript"><table border= "0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7 </div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11 </div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div><div class="line number21 index20 alt2">21</div><div class="line number22 index21 alt1">22</div><div class="line number23 index22 alt2">23</div><div class="line number24 index23 alt1">24</div><div class="line number25 index24 alt2">25</div><div class="line number26 index25 alt1">26</div><div class= "line number27 index26 alt2">27</div><div class="line number28 index27 alt1">28</div><div class="line number29 index28 alt2">29</div><div class="line number30 index29 alt1">30</div><div class="line number31 index30 alt2">31</div><div class="line number32 index31 alt1">32</div><div class="line number33 index32 alt2">33</div><div class="line number34 index33 alt1">34 </div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="jscript keyword">var</code> <code class="jscript plain">asRectangle = (</code><code class="jscript keyword">function</code><code class="jscript plain">() {</code></div><div class="line number2 index1 alt1"><code class="jscript spaces">&nbsp;&nbsp;</code><code class= "jscript keyword">function</code> <code class="jscript plain">area() {</code></div><div class="line number3 index2 alt2"><code class="jscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript keyword">return</code> <code class="jscript keyword">this</code><code class="jscript plain">.length * </code><code class="jscript keyword">this</code><code class="jscript plain">.width;</code></div><div class="line number4 index3 alt1"><code class="jscript spaces">&nbsp;&nbsp;</code><code class="jscript plain">}</code></div><div class="line number5 index4 alt2"><code class="jscript spaces">&nbsp;&nbsp;</code><code class="jscript keyword">function</code> <code class="jscript plain">grow() {</code></div><div class="line number6 index5 alt1" ><code class="jscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript keyword">this</code><code class="jscript plain">.length++, </code><code class="jscript keyword">this </code><code class="jscript plain">.width++;</code></div><div class="line number7 index6 alt2"><code class="jscript spaces">&nbsp;&nbsp;</code><code class="jscript plain">} </code></div><div class="line number8 index7 alt1"><code class="jscript spaces">&nbsp;&nbsp;</code><code class="jscript keyword">function</code> <code class="jscript plain">shrink() { </code></div><div class="line number9 index8 alt2"><code class="jscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript keyword">this</code><code class="jscript plain"> .length--, </code><code class="jscript keyword">this</code><code class="jscript plain">.width--;</code></div><div class="line number10 index9 alt1"><code class="jscript spaces"> &nbsp;&nbsp;</code><code class="jscript plain">}</code></div><div class="line number11 index10 alt2"><code class="jscript spaces">&nbsp;&nbsp;</code><code class="jscript keyword">return </code> <code class="jscript keyword">function</code><code class="jscript plain">() {</code></div><div class="line number12 index11 alt1"><code class="jscript spaces"> &nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript keyword">this</code><code class="jscript plain">.area = area;</code></div><div class="line number13 index12 alt2"><code class="jscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript keyword">this</code><code class="jscript plain">.grow = grow;</code></div><div class="line number14 index13 alt1"><code class= "jscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript keyword">this</code><code class="jscript plain">.shrink = shrink;</code></div><div class="line number15 index14 alt2" ><code class="jscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript keyword">return</code> <code class="jscript keyword">this</code><code class="jscript plain">; </code></div><div class="line number16 index15 alt1"><code class="jscript spaces">&nbsp;&nbsp;</code><code class="jscript plain">};</code></div><div class="line number17 index16 alt2" ><code class="jscript plain">})();</code></div><div class="line number18 index17 alt1">&nbsp;</div><div class="line number19 index18 alt2"><code class="jscript keyword">var</code> <code class="jscript plain">RectangularButton = </code><code class="jscript keyword">function</code><code class="jscript plain">(length, width, label, action) {</code></div><div class="line number20 index19 alt1"><code class="jscript spaces">&nbsp;&nbsp;</code><code class="jscript keyword">this</code><code class="jscript plain">.length = length;</code></div><div class="line number21 index20 alt2"><code class="jscript spaces">&nbsp;&nbsp;</code><code class="jscript keyword">this</code><code class="jscript plain">.width = width;</code></div><div class="line number22 index21 alt1"><code class="jscript spaces">&nbsp;&nbsp;</code><code class="jscript keyword">this</code><code class="jscript plain">.label = label;</code></div><div class="line number23 index22 alt2"><code class="jscript spaces">&nbsp;&nbsp;</code><code class="jscript keyword">this</code><code class="jscript plain">.action = action;</code></div><div class="line number24 index23 alt1"><code class="jscript plain">}</code></div><div class="line number25 index24 alt2">&nbsp;</div><div class="line number26 index25 alt1"><code class="jscript plain"> asButton.call(RectangularButton.prototype);</code></div><div class="line number27 index26 alt2"><code class="jscript plain">asRectangle.call(RectangularButton.prototype);</code></div><div class="line number28 index27 alt1">&nbsp;</div><div class="line number29 index28 alt2"><code class="jscript keyword">var</code> <code class="jscript plain">button3 = </code></div><div class="line number30 index29 alt1"><code class="jscript spaces">&nbsp;&nbsp;</code><code class="jscript keyword">new</code> <code class="jscript plain">RectangularButton(4, 2, </code><code class="jscript string">'delete'</code><code class="jscript plain">, </code><code class="jscript keyword">function</code><code class="jscript plain">() {</code><code class="jscript keyword">return</code> <code class="jscript string">'deleted'</code><code class="jscript plain">});</code></div><div class="line number31 index30 alt2"><code class="jscript plain"> button3.area(); </code><code class="jscript comments">//8</code></div><div class="line number32 index31 alt1"><code class="jscript plain">button3.grow();</code></div><div class="line number33 index32 alt2"><code class="jscript plain">button3.area(); </code><code class="jscript comments">//15</code></div><div class="line number34 index33 alt1"><code class="jscript plain">button3.fire(); </code><code class="jscript comments">//'deleted'</code></div></div></td></tr></tbody></table></div></div><p>&nbsp;<br><span style="font-weight:bold;font-size:18px;" >5. Adding Curry </span></p><p>Everything in life is a trade off and the aforementioned caching enhancement is no exception. We've now lost the ability to create true clones for every mixin, furthermore we can no longer customize our borrowed functions by passing option arguments to the mixin. The latter problem can be fixed up by running a <a href=" https://javascriptweblog.wordpress.com/2010/04/05/curry-cooking-up-tastier-functions/" target="_blank">curry</a> function over each cached function, thereby pre-assigning custom options to subsequent function calls. </p><p>Here's the <code>asRectangle</code> mixin with functions appropriately curried to allow parameterization of the grow and shrink increments. </p><div><div id="highlighter_575352" class="syntaxhighlighter  jscript"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5 </div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9 </div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2" >13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div><div class="line number21 index20 alt2">21</div><div class="line number22 index21 alt1">22</div><div class="line number23 index22 alt2">23</div><div class="line number24 index23 alt1">24</div><div class="line number25 index24 alt2">25</div><div class="line number26 index25 alt1">26</div><div class="line number27 index26 alt2">27</div><div class="line number28 index27 alt1">28</div><div class= "line number29 index28 alt2">29</div><div class="line number30 index29 alt1">30</div><div class="line number31 index30 alt2">31</div><div class="line number32 index31 alt1">32</div><div class="line number33 index32 alt2">33</div><div class="line number34 index33 alt1">34</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class= "jscript plain">Function.prototype.curry = </code><code class="jscript keyword">function</code><code class="jscript plain">() {</code></div><div class="line number2 index1 alt1"><code class="jscript spaces">&nbsp;&nbsp;</code><code class="jscript keyword">var</code> <code class="jscript plain">fn = </code><code class="jscript keyword">this</code><code class="jscript plain">;</code></div><div class="line number3 index2 alt2"><code class="jscript spaces">&nbsp;&nbsp;</code><code class="jscript keyword">var</code> <code class="jscript plain">args = [].slice.call(arguments, 0);</code></div><div class="line number4 index3 alt1"><code class="jscript spaces">&nbsp;&nbsp;</code><code class="jscript keyword">return</code> <code class= "jscript keyword">function</code><code class="jscript plain">() {</code></div><div class="line number5 index4 alt2"><code class="jscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class= "jscript keyword">return</code> <code class="jscript plain">fn.apply(</code><code class="jscript keyword">this</code><code class="jscript plain">, args.concat([].slice.call(arguments, 0)));</code></div><div class="line number6 index5 alt1"><code class="jscript spaces">&nbsp;&nbsp;</code><code class="jscript plain">};</code></div><div class="line number7 index6 alt2" ><code class="jscript plain">}</code></div><div class="line number8 index7 alt1">&nbsp;</div><div class="line number9 index8 alt2"><code class="jscript keyword">var</code> <code class= "jscript plain">asRectangle = (</code><code class="jscript keyword">function</code><code class="jscript plain">() {</code></div><div class="line number10 index9 alt1"><code class="jscript spaces">&nbsp;&nbsp;</code><code class="jscript keyword">function</code> <code class="jscript plain">area() {</code></div><div class="line number11 index10 alt2"><code class="jscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript keyword">return</code> <code class="jscript keyword">this</code><code class="jscript plain">.length * </code><code class= "jscript keyword">this</code><code class="jscript plain">.width;</code></div><div class="line number12 index11 alt1"><code class="jscript spaces">&nbsp;&nbsp;</code><code class="jscript plain">}</code></div><div class="line number13 index12 alt2"><code class="jscript spaces">&nbsp;&nbsp;</code><code class="jscript keyword">function</code> <code class="jscript plain"> grow(growBy) {</code></div><div class="line number14 index13 alt1"><code class="jscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript keyword">this</code><code class= "jscript plain">.length += growBy, </code><code class="jscript keyword">this</code><code class="jscript plain">.width +=growBy;</code></div><div class="line number15 index14 alt2"><code class="jscript spaces">&nbsp;&nbsp;</code><code class="jscript plain">}</code></div><div class="line number16 index15 alt1"><code class="jscript spaces">&nbsp;&nbsp;</code><code class= "jscript keyword">function</code> <code class="jscript plain">shrink(shrinkBy) {</code></div><div class="line number17 index16 alt2"><code class="jscript spaces">&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="jscript keyword">this</code><code class="jscript plain">.length -= shrinkBy, </code><code class="jscript keyword">this</code><code class="jscript plain">.width -= shrinkBy;</code></div><div class="line number18 index17 alt1"><code class="jscript spaces">&nbsp;&nbsp;</code><code class="jscript plain">}</code></div><div class="line number19 index18 alt2"><code class="jscript spaces">&nbsp;&nbsp;</code><code class="jscript keyword">return</code> <code class="jscript keyword">function</code><code class="jscript plain">(options) { </code></div><div class="line number20 index19 alt1"><code class="jscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript keyword">this</code><code class="jscript plain">.area = area;</code></div><div class="line number21 index20 alt2"><code class="jscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript keyword">this</code><code class="jscript plain" >.grow = grow.curry(options[</code><code class="jscript string">'growBy'</code><code class="jscript plain">]);</code></div><div class="line number22 index21 alt1"><code class="jscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript keyword">this</code><code class="jscript plain">.shrink = shrink.curry(options[</code><code class="jscript string">'shrinkBy' </code><code class="jscript plain">]);</code></div><div class="line number23 index22 alt2"><code class="jscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript keyword">return </code> <code class="jscript keyword">this</code><code class="jscript plain">;</code></div><div class="line number24 index23 alt1"><code class="jscript spaces">&nbsp;&nbsp;</code><code class="jscript plain">};</code></div><div class="line number25 index24 alt2"><code class="jscript plain">})();</code></div><div class="line number26 index25 alt1">&nbsp;</div><div class= "line number27 index26 alt2"><code class="jscript plain">asButton.call(RectangularButton.prototype);</code></div><div class="line number28 index27 alt1"><code class="jscript plain"> asRectangle.call(RectangularButton.prototype, {growBy: 2, shrinkBy: 2});</code></div><div class="line number29 index28 alt2">&nbsp;</div><div class="line number30 index29 alt1"><code class ="jscript keyword">var</code> <code class="jscript plain">button4 = </code><code class="jscript keyword">new</code> <code class="jscript plain">RectangularButton(2, 1, </code><code class= "jscript string">'add'</code><code class="jscript plain">, </code><code class="jscript keyword">function</code><code class="jscript plain">() {</code><code class="jscript keyword">return </code> <code class="jscript string">'added'</code><code class="jscript plain">});</code></div><div class="line number31 index30 alt2"><code class="jscript plain">button4.area(); </code><code class="jscript comments">//2</code></div><div class="line number32 index31 alt1"><code class="jscript plain">button4.grow();</code></div><div class="line number33 index32 alt2"><code class="jscript plain">button4.area(); </code><code class="jscript comments">//12</code></div><div class="line number34 index33 alt1"><code class="jscript plain"> button4.fire(); </code><code class="jscript comments">//'added'</code></div></div></td></tr></tbody></table></div></div><p>&nbsp;<br><span style="font-weight:bold;font-size:18px;"> Performance Metrics</span></p><p>As promised, here's a summary of my <a href="http://jsperf.com/mixin-fun/2" target="_blank">jsperf tests</a>, matrixed by technique and browser.<br> Remember the results are in thousands of operations per second, so high numbers are good.</p><p><img src=" https://javascriptweblog.files.wordpress.com/2011/05/screen-shot-2011-05-30-at-5-24-15-pm.png?w=660" alt="" title="Screen shot 2011-05-30 at 5.24.15 PM" class="alignnone size-full wp-image-2667" style="border:none;margin:0;padding:0;"><br>&nbsp;<br><br><span style="font-weight:bold;font-size:18px;">Wrap Up</span></p><p>JavaScript is an amalgam of function and state. State is generally specific to instances, while functions will almost certainly be shared across instances.  Maybe it's in our interest to separate these two most basic concerns and maybe mixins can help us do this. </p><p>In particular the functional mixin pattern offers a clear delineation. Objects are state while functions are organized in bunches like fruit on a tree, ripe for picking. In fact the strategy can be extended beyond pure mixins – functional sets can act as repositories for any object…</p><div><div id="highlighter_633373" class= "syntaxhighlighter  jscript"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="jscript keyword">var</code> <code class="jscript plain">myCircle = asCircle.call({radius:25});</code></div><div class="line number2 index1 alt1"><code class="jscript plain">myCircle.area(); </code><code class="jscript comments">//1963.50 </code></div></div></td></tr></tbody></table></div></div><p>Have fun exploring mixins, and as always please let me know of corrections and other feedback!</p>					</div> </div>		<!--=========================			END : POST		=============================-->		<!--=========================			START : POST =============================-->		<div class="post-wrapper">		<h1 class="entry-title">Curry: cooking up tastier functions</h1>		<div class="entry-content">		<p>Currying allows you to easily create custom functions by partially invoking an existing function. Here's a simple example:</p><div><div id="highlighter_228587" class="syntaxhighlighter  jscript" ><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div></td><td class="code" ><div class="container"><div class="line number1 index0 alt2"><code class="jscript keyword">var</code> <code class="jscript plain">add = </code><code class="jscript keyword">function </code><code class="jscript plain">(a,b) {</code></div><div class="line number2 index1 alt1"><code class="jscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript keyword"> return</code> <code class="jscript plain">a + b;</code></div><div class="line number3 index2 alt2"><code class="jscript plain">}</code></div><div class="line number4 index3 alt1">&nbsp; </div><div class="line number5 index4 alt2"><code class="jscript keyword">var</code> <code class="jscript plain">addTen = add.curry(10); </code><code class="jscript comments">//create function that returns 10 + argument</code></div><div class="line number6 index5 alt1"><code class="jscript plain">addTen(20); </code><code class="jscript comments">//30 </code></div></div></td></tr></tbody></table></div></div><p>Generally, curry returns a copy of the invoking function, with its first n arguments pre-assigned with the arguments passed by the curry invocation.</p><p><strong><span id="more-129"></span></strong>The curry function does not exist in native JavaScript, but it's easy to write your own. Here I'm augmenting function's prototype with an implementation based on the Prototype framework. (Notice I'm also throwing in a toArray function for convenience. This is because function's arguments property is not a true array, and we need it to work with array's concat function)</p><div><div id="highlighter_415405" class="syntaxhighlighter  jscript"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class= "line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class= "line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div></td><td class="code"><div class="container"><div class ="line number1 index0 alt2"><code class="jscript keyword">function</code> <code class="jscript plain">toArray(</code><code class="jscript keyword">enum</code><code class="jscript plain">) {</code></div><div class="line number2 index1 alt1"><code class="jscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript keyword">return</code> <code class="jscript plain"> Array.prototype.slice.call(</code><code class="jscript keyword">enum</code><code class="jscript plain">);</code></div><div class="line number3 index2 alt2"><code class="jscript plain">} </code></div><div class="line number4 index3 alt1">&nbsp;</div><div class="line number5 index4 alt2"><code class="jscript plain">Function.prototype.curry = </code><code class="jscript keyword">function</code><code class="jscript plain">() {</code></div><div class="line number6 index5 alt1"><code class="jscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript keyword">if</code> <code class="jscript plain">(arguments.length&lt;1) {</code></div><div class="line number7 index6 alt2"><code class="jscript spaces"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript keyword">return</code> <code class="jscript keyword">this</code><code class="jscript plain">; </code><code class ="jscript comments">//nothing to curry with - return function</code></div><div class="line number8 index7 alt1"><code class="jscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class= "jscript plain">}</code></div><div class="line number9 index8 alt2"><code class="jscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript keyword">var</code> <code class= "jscript plain">__method = </code><code class="jscript keyword">this</code><code class="jscript plain">;</code></div><div class="line number10 index9 alt1"><code class="jscript spaces"> &nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript keyword">var</code> <code class="jscript plain">args = toArray(arguments);</code></div><div class="line number11 index10 alt2"><code class="jscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript keyword">return</code> <code class="jscript keyword">function</code><code class="jscript plain">() { </code></div><div class="line number12 index11 alt1"><code class="jscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript keyword">return</code> <code class="jscript plain">__method.apply(</code><code class="jscript keyword">this</code><code class="jscript plain">, args.concat(toArray(arguments)));</code></div><div class="line number13 index12 alt2"><code class="jscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript plain">}</code></div><div class="line number14 index13 alt1"><code class="jscript plain">} </code></div></div></td></tr></tbody></table></div></div><p>The returned function expects to be invoked with additional argument(s) which it will concatenate with the argument(s) it got from the curry function.</p><p>In case you were wondering: we could provide the curry function with <em>all </em>the arguments required by the calling function:</p><div><div id= "highlighter_544848" class="syntaxhighlighter  jscript"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class= "line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="jscript comments">//not very useful example</code></div><div class="line number2 index1 alt1"><code class="jscript keyword">var</code> <code class="jscript plain">make5 = add.curry(2,3); </code></div><div class="line number3 index2 alt2"><code class="jscript plain">make5(); </code><code class="jscript comments">//5</code></div><div class="line number4 index3 alt1">&nbsp; </div><div class="line number5 index4 alt2"><code class="jscript comments">//better example</code></div><div class="line number6 index5 alt1"><code class="jscript keyword">var</code> <code class="jscript plain">sayHello = alert.curry(</code><code class="jscript string">"Hello!"</code><code class="jscript plain">);</code></div><div class="line number7 index6 alt2"><code class="jscript plain">friendlyDiv.onmouseover = sayHello;</code></div></div></td></tr></tbody></table></div></div><p>The add function is very basic, but as the logic of a function gets more complex, the value of re-applying that logic to distinct parameters becomes more apparent.</p><p>Consider a function that returns the RGB index (in hex) for the color that falls at a given point in the transition between two given colors (specified either by name named or RGB hex)</p><div><div id="highlighter_680102" class="syntaxhighlighter  jscript"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2" ><code class="jscript keyword">var</code> <code class="jscript plain">getColorBetween = </code><code class="jscript keyword">function</code><code class="jscript plain">(transitionFactor, color1, color2) {</code></div><div class="line number2 index1 alt1"><code class="jscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript comments">//..</code></div><div class= "line number3 index2 alt2"><code class="jscript plain">}</code></div><div class="line number4 index3 alt1">&nbsp;</div><div class="line number5 index4 alt2"><code class="jscript plain"> getColorBetween(0.5, </code><code class="jscript string">"red"</code><code class="jscript plain">, </code><code class="jscript string">"green"</code><code class="jscript plain">); </code><code class="jscript comments">//&lt;span style="color:#7f4000;"&gt;"#7f4000"&lt;/span&gt;</code></div></div></td></tr></tbody></table></div></div><p>If we want to create a series of fall colors, we could experiment by creating a function that returns colors that fall (no pun) 25% of the way between orange and the given color:</p><div><div id="highlighter_343650" class="syntaxhighlighter  jscript"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div></td><td class="code"><div class= "container"><div class="line number1 index0 alt2"><code class="jscript keyword">var</code> <code class="jscript plain">getFallColor = getColorBetween.curry(0.25, </code><code class= "jscript string">"#ff8000"</code><code class="jscript plain">);</code></div><div class="line number2 index1 alt1">&nbsp;</div><div class="line number3 index2 alt2"><code class="jscript plain">reddishFallColor = getFallColor(</code><code class="jscript string">"red"</code><code class="jscript plain">); </code><code class="jscript comments">//&lt;span style="color:#ff6000;"&gt;"#ff6000"&lt;/span&gt;</code></div><div class="line number4 index3 alt1"><code class="jscript plain">yellowishFallColor = getFallColor(</code><code class= "jscript string">"yellow"</code><code class="jscript plain">); </code><code class="jscript comments">//&lt;span style="color:#ff9b00;"&gt;"#ff9b00"&lt;/span&gt;</code></div><div class= "line number5 index4 alt2"><code class="jscript plain">brownishFallColor = getFallColor(</code><code class="jscript string">"#800000"</code><code class="jscript plain">); </code><code class="jscript comments">//&lt;span style="color:#df7000;"&gt;"#df7000"&lt;/span&gt;</code></div></div></td></tr></tbody></table></div></div><p>Here's another example that generates various conversion functions</p><div><div id="highlighter_73796" class="syntaxhighlighter  jscript"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class= "line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="jscript keyword">var</code> <code class="jscript plain"> converter = </code><code class="jscript keyword">function</code><code class="jscript plain">(ratio, symbol, input) {</code></div><div class="line number2 index1 alt1"><code class="jscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript keyword">return</code> <code class="jscript plain">[(input*ratio).toFixed(1),symbol].join(</code><code class="jscript string">" "</code><code class="jscript plain">);</code></div><div class="line number3 index2 alt2"><code class="jscript plain">}</code></div><div class="line number4 index3 alt1">&nbsp;</div><div class="line number5 index4 alt2"><code class="jscript keyword">var</code> <code class="jscript plain">kilosToPounds = converter.curry(2.2,</code><code class="jscript string">"lbs" </code><code class="jscript plain">);</code></div><div class="line number6 index5 alt1"><code class="jscript keyword">var</code> <code class="jscript plain">litersToUKPints = converter.curry(1.75, </code><code class="jscript string">"imperial pints"</code><code class="jscript plain">);</code></div><div class="line number7 index6 alt2"><code class="jscript keyword">var</code> <code class="jscript plain">litersToUSPints = converter.curry(1.98, </code><code class="jscript string">"US pints"</code><code class="jscript plain">);</code></div><div class="line number8 index7 alt1"><code class="jscript keyword">var</code> <code class="jscript plain">milesToKilometers = converter.curry(1.62, </code><code class="jscript string">"km" </code><code class="jscript plain">);</code></div><div class="line number9 index8 alt2">&nbsp;</div><div class="line number10 index9 alt1"><code class="jscript plain">kilosToPounds(4); </code><code class="jscript comments">//8.8 lbs</code></div><div class="line number11 index10 alt2"><code class="jscript plain">litersToUKPints(2.4); </code><code class="jscript comments"> //4.2 imperial pints</code></div><div class="line number12 index11 alt1"><code class="jscript plain">litersToUSPints(2.4); </code><code class="jscript comments">//4.8 US pints </code></div><div class="line number13 index12 alt2"><code class="jscript plain">milesToKilometers(34); </code><code class="jscript comments">//55.1 km </code></div></div></td></tr></tbody></table></div></div><p>Now, go forth and curry.</p>					</div>			</div>		<!--=========================			END : POST		=============================-->		<!--=========================			START : POST		=============================-->		<div class="post-wrapper">		<h1 class="entry-title">Five ways to create objects – part 2:&nbsp;Inheritance</h1>		<div class="entry-content">		<p>Let me start by saying I think inheritance is somewhat overrated in JavaScript. A lot of the inheritance you are going to need is already created for you: Function, String, Number etc. all inherit Object via its prototype.</p><p>I actually wonder if more energy goes into intellectual exercises around JavaScript inheritance than into using inheritance for real time solutions. Yes, JavaScript has an excellent inheritance mechanism but lets face it all those examples with furry animals, hierarchies of wheeled vehicles and the like have little real world application in client side coding.</p><p>How often do your new objects really need to inherit from other new objects you have created? By its nature the client object modelling is essentially flat (like your monitor). If you find yourself in JavaScript creating complex java-style object models with layers of inheritance then you might want to ask yourself why. Ajax allowed us to defer to the server where we used to have to clone our business/server logic on the client. I'd argue such complex data structures are best left to the server, because they perform better, are more easily distributed across subsystems and are probably more suited to classical OOP.</p><p>With that said, JavaScript does offer a very nifty inheritance strategy – there are no classes – objects inherit from objects. Period. It's clean and its simple.</p><p><em>So here goes..</em></p><p><strong><em><span id="more-25"></span></em></strong>Last time I demonstrated five ways to create objects in JavaScript. Now, as promised here's how to apply inheritance in each case. Clearly some cases are more useful than others.</p><p>Lets say our notepad from last week's example might need to inherit some properties from a more generic “panel” component.</p><p><em>1. Simple Object Literal</em></p><pre style="font-size:12px;background-color:#eaf5ff;">var myApp = {};<span class= "skimlinks-unlinked">myApp.panel</span> = {};<span class="skimlinks-unlinked">myApp.panel.toggleDisplay</span> = function() {    this.displayed = (this.displayed==="none")? "" : "none";} <span class="skimlinks-unlinked">myApp.panel.defaultWidth</span> = 300;myApp.notepad = {};myApp.notepad.writeable = true;<span class="skimlinks-unlinked">myApp.notepad.font</span> = 'helvetica';myApp.notepad.setFont = function(theFont) {    <span class="skimlinks-unlinked">myApp.notepad.font</span> = theFont;}//OK not inheritance at all. But best we can do, since notepad has no relation to panel.<span class="skimlinks-unlinked">myApp.panel.toggleDisplay.call(myApp.notepad</span>);myApp.notepad.defaultWidth = <span class="skimlinks-unlinked"> myApp.panel.defaultWidth</span>;</pre><p><em>2. Nested Object Literal</em></p><pre style="font-size:12px;background-color:#eaf5ff;">var myApp = {};<span class="skimlinks-unlinked"> myApp.panel</span> = {    toggleDisplay : function() {        this.displayed = (this.displayed==="none") ? "" : "none";    },    defaultWidth : 300};myApp.notepad = {    writeable: true,    font: 'helvetica',    setFont: function(theFont) {        <span class="skimlinks-unlinked">this.font</span> = theFont;    }};//Same brute-force inheritance as example (1)<span class="skimlinks-unlinked">myApp.panel.toggleDisplay.call(myApp.notepad</span>);myApp.notepad.defaultWidth = <span class="skimlinks-unlinked">myApp.panel.defaultWidth</span>;</pre><p><em> 3. Constructor using Object Literal (courtesy of <a href="http://www.crockford.com/">Douglas Crockford</a>)</em></p><pre style="font-size:12px;background-color:#eaf5ff;">var myApp = {}; <span class="skimlinks-unlinked">myApp.Panel</span> = function(defaultWidth ) {    var that = {};    that.defaultWidth = defaultWidth ;    that.toggleDisplay = function() { that.displayed = (that.displayed==="none") ? "" : "none";    }    return that;}myApp.Notepad = function(defaultFont, width) {    var that = <span class="skimlinks-unlinked">myApp.Panel(300 </span>);    that.writeable = true;    <span class="skimlinks-unlinked">that.font</span> = defaultFont;    that.setFont = function(theFont) {        <span class="skimlinks-unlinked"> that.font</span> = theFont;    }    return that;}//true inheritance without using new or prototype (courtesy of <em>Douglas Crockford</em>)myApp.notepad1 = myApp.Notepad('helvetica',300);myApp.notepad1.defaultWidth;</pre><p><em>4. Simple Constructor for new</em></p><pre style="font-size:12px;background-color:#eaf5ff;">var myApp = {};<span class="skimlinks-unlinked">myApp.Panel</span> = function(defaultWidth) {    this.defaultWidth=defaultWidth ;    this.toggleDisplay = function() {        this.displayed = (this.displayed==="none") ? "" : "none";    }}myApp.Notepad = function(defaultFont) {    this.writeable = true;    <span class="skimlinks-unlinked">this.font</span> = defaultFont; this.setFont = function(theFont) {        <span class="skimlinks-unlinked">this.font</span> = theFont;    }}myApp.notepad1 = new myApp.Notepad('helvetica');//Without prototype we can only kluge inheritance here. Example (5) will fix it.myApp.notepad1.defaultWidth; //undefined</pre><p><em>5. Prototype with Constructor for new</em></p><pre style= "font-size:12px;background-color:#eaf5ff;">//utility functionfunction deepClone(obj) {    var clone = {};    for(var i in obj) {        if(typeof(obj[i])==="object") {            clone[i] = deepClone(obj[i]);        } else {            clone[i] = obj[i];        }    }    return clone;} myApp = {};<span class="skimlinks-unlinked">myApp.Panel</span> = function(defaultWidth) {    this.defaultWidth = defaultWidth;}<span class="skimlinks-unlinked">myApp.Panel.prototype.toggleDisplay</span> = function() {    this.displayed = (this.displayed==="none") ? '' : "none";    alert('display = ' + (this.displayed ? 'on' : 'off'));}myApp.Notepad = function(defaultFont,defaultWidth) {    <span class="skimlinks-unlinked"> myApp.Panel.call(this,defaultWidth</span>); //inject self into Panel constructor    <span class="skimlinks-unlinked">this.font</span> = defaultFont;}//inherit from Panel....//better to simply grab Panel's prototype rather than create new instance of PanelmyApp.Notepad.prototype = deepClone(<span class="skimlinks-unlinked">myApp.Panel.prototype</span> );myApp.Notepad.prototype.writeable = true;myApp.Notepad.prototype.setFont = function(theFont) {    <span class="skimlinks-unlinked">this.font</span> = theFont;}//true inheritance - this time using prototypemyApp.notepad1 = new myApp.Notepad('helvetica',300);myApp.notepad1.defaultWidth; //300</pre>					</div>			</div> <!--=========================			END : POST		=============================-->		<!--=========================			START : POST =============================-->		<div class="post-wrapper">		<h1 class="entry-title">The JavaScript arguments object…and beyond</h1>		<div class="entry-content">		<p> Spare a thought for JavaScript's <code>arguments</code> object. It wants so desperately to be an array. It walks like an array, quacks like an array but flies like a turkey. During the early years of the language Brendan Eich came close to rewriting <code>arguments</code> as an array until ECMA came along and clipped its wings forever.</p><p>In spite of all this (or maybe because of it) we love the <code>arguments</code> object. In this article I'll explore its niftyness and its quirkiness and I'll finish up by looking at the likely successors: <code> rest</code> and <code>spread</code>…<br><span id="more-1990"></span><br><span style="font-weight:bold;font-size:18px;">The arguments object</span><br>When control enters the execution context of a function an <code>arguments</code> object is created. The <code>arguments</code> object has an array-like structure with an indexed property for each passed argument and a <code>length</code> property equal to the total number of parameters supplied by the caller. Thus the <code>length</code> of the <code>arguments</code> object can be greater than, less than or equal to the number of formal parameters in the function definition (which we can get by querying the function's length property):</p><div><div id="highlighter_377206" class= "syntaxhighlighter  jscript"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6 </div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10 </div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="jscript keyword">function</code> <code class="jscript plain">echoArgs(a,b) { </code></div><div class="line number2 index1 alt1"><code class="jscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript keyword">return</code> <code class="jscript plain"> arguments;</code></div><div class="line number3 index2 alt2"><code class="jscript plain">}</code></div><div class="line number4 index3 alt1">&nbsp;</div><div class="line number5 index4 alt2"><code class="jscript comments">//number of formal parameters...</code></div><div class="line number6 index5 alt1"><code class="jscript plain">echoArgs.length; </code><code class= "jscript comments">//2</code></div><div class="line number7 index6 alt2">&nbsp;</div><div class="line number8 index7 alt1"><code class="jscript comments">//length of argument object... </code></div><div class="line number9 index8 alt2"><code class="jscript plain">echoArgs().length; </code><code class="jscript comments">//0</code></div><div class="line number10 index9 alt1"><code class="jscript plain">echoArgs(5,7,8).length; </code><code class="jscript comments">//3</code></div></div></td></tr></tbody></table></div></div><p>&nbsp;<br><b>Binding with named function parameters</b><br>Each member of the <code>arguments</code> object shares its value with the corresponding named parameter of the function – so long as its index is less than the number of formal parameters in the function.</p><p><a href="http://ecma262-5.com/ELS5_HTML.htm#Section_10.6" target="_blank">ES5 clause 10.6 (note 1)</a> puts it like this: </p><blockquote><p>For non-strict mode functions the array index […] named data properties of an arguments object whose numeric name values are less than the number of formal parameters of the corresponding function object initially share their values with the corresponding argument bindings in the function's execution context. <b>This means that changing the property changes the corresponding value of the argument binding and vice-versa</b></p></blockquote><div><div id="highlighter_938106" class="syntaxhighlighter  jscript"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7 </div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11 </div><div class="line number12 index11 alt1">12</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="jscript plain">(</code><code class= "jscript keyword">function</code><code class="jscript plain">(a) {</code></div><div class="line number2 index1 alt1"><code class="jscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class ="jscript plain">console.log(arguments[0] === a); </code><code class="jscript comments">//true</code></div><div class="line number3 index2 alt2"><code class="jscript spaces"> &nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript plain">console.log(a); </code><code class="jscript comments">//1</code></div><div class="line number4 index3 alt1"><code class="jscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code>&nbsp;</div><div class="line number5 index4 alt2"><code class="jscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript comments"> //modify argument property</code></div><div class="line number6 index5 alt1"><code class="jscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript plain">arguments[0] = 10; </code></div><div class="line number7 index6 alt2"><code class="jscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript plain">console.log(a); </code><code class="jscript comments">//10</code></div><div class="line number8 index7 alt1">&nbsp;</div><div class="line number9 index8 alt2"><code class="jscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class= "jscript comments">//modify named parameter variable</code></div><div class="line number10 index9 alt1"><code class="jscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript plain">a = 20;</code></div><div class="line number11 index10 alt2"><code class="jscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript plain">console.log(arguments[0]); </code><code class="jscript comments">//20</code></div><div class="line number12 index11 alt1"><code class="jscript plain">})(1,2) </code></div></div></td></tr></tbody></table></div></div><p>&nbsp;<br>Argument properties whose index is greater than or equal to the number of formal parameters (i.e. additional arguments which do not correspond to named parameters) are not bound to any named parameter value. Similarly if a function call does not supply an argument for every named parameter, the unfilled parameters should not be bound to the <code>arguments</code> object and their values cannot be updated by modifying the <code>arguments</code> objects…  </p><div><div id= "highlighter_958292" class="syntaxhighlighter  jscript"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class= "line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class= "line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class= "jscript comments">//Invoke a three argument function but only pass two arguments </code></div><div class="line number2 index1 alt1"><code class="jscript plain">(</code><code class= "jscript keyword">function</code><code class="jscript plain">(a, b, c) {</code></div><div class="line number3 index2 alt2"><code class="jscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript comments">//'arguments' has two members</code></div><div class="line number4 index3 alt1"><code class="jscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript plain">console.log(arguments.length); </code><code class="jscript comments">//2</code></div><div class="line number5 index4 alt2"><code class="jscript spaces">&nbsp;&nbsp;&nbsp;&nbsp; </code>&nbsp;</div><div class="line number6 index5 alt1"><code class="jscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript comments">//Updating arguments[2] should do not modify named param</code></div><div class="line number7 index6 alt2"><code class="jscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript plain">arguments[2] = 10; </code></div><div class="line number8 index7 alt1"><code class="jscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript plain">console.log(c); </code><code class="jscript comments">//undefined </code></div><div class="line number9 index8 alt2"><code class="jscript plain">})(1,2);&nbsp;&nbsp;&nbsp; </code></div><div class="line number10 index9 alt1">&nbsp; </div><div class="line number11 index10 alt2"><code class="jscript plain">(</code><code class="jscript keyword">function</code><code class="jscript plain">(a, b, c) {</code></div><div class="line number12 index11 alt1"><code class="jscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript comments">//Assigning to 'c' should not populate 'arguments' object </code></div><div class="line number13 index12 alt2"><code class="jscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript plain">c = 10;</code></div><div class="line number14 index13 alt1"><code class="jscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript plain">console.log(</code><code class="jscript string">'2'</code> <code class="jscript keyword">in</code> <code class="jscript plain">arguments); </code><code class="jscript comments">//false </code></div><div class="line number15 index14 alt2"><code class="jscript plain"> })(1,2) </code></div></div></td></tr></tbody></table></div></div><p>&nbsp;<br>…well according to the ES5 spec at least. Unfortunately the Chrome browser doesn't comply. It creates an <code>arguments</code> member for every named parameter, regardless of whether the argument was actually passed (this is a known <a href=" http://code.google.com/p/chromium/issues/detail?id=36350" target="_blank">issue</a>)</p><div><div id="highlighter_91024" class="syntaxhighlighter  jscript"><table border="0" cellpadding= "0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3 </div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7 </div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11 </div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2" ><code class="jscript comments">//CHROME BROWSER ONLY...</code></div><div class="line number2 index1 alt1"><code class="jscript spaces">&nbsp;</code>&nbsp;</div><div class="line number3 index2 alt2"><code class="jscript plain">(</code><code class="jscript keyword">function</code><code class="jscript plain">(a, b, c) {</code></div><div class="line number4 index3 alt1" ><code class="jscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript comments">//Updating arguments[2] should do not modify named param</code></div><div class="line number5 index4 alt2"><code class="jscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript plain">arguments[2] = 10;</code></div><div class="line number6 index5 alt1"><code class= "jscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript plain">console.log(c); </code><code class="jscript comments">//10!!</code></div><div class="line number7 index6 alt2" ><code class="jscript plain">})(1,2);&nbsp;&nbsp;&nbsp; </code></div><div class="line number8 index7 alt1">&nbsp;</div><div class="line number9 index8 alt2"><code class="jscript plain">( </code><code class="jscript keyword">function</code><code class="jscript plain">(a, b, c) {</code></div><div class="line number10 index9 alt1"><code class="jscript spaces"> &nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript comments">//Assigning to 'c' should not populate 'arguments' object</code></div><div class="line number11 index10 alt2"><code class= "jscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript plain">c = 10;</code></div><div class="line number12 index11 alt1"><code class="jscript spaces"> &nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript plain">console.log(</code><code class="jscript string">'2'</code> <code class="jscript keyword">in</code> <code class="jscript plain"> arguments); </code><code class="jscript comments">//true!! </code></div><div class="line number13 index12 alt2"><code class="jscript plain">})(1,2) </code></div></div></td></tr></tbody></table></div></div><p>&nbsp;<br>There's another <a href="http://code.google.com/p/chromium/issues/detail?id=32184" target="_blank">bug</a> related to Chrome's over-reaching <code>arguments</code> object. Deleting supposedly non-existent members of the <code>arguments</code> object will cause the corresponding named (but not passed) parameter value to be wiped out: </p><div><div id="highlighter_330392" class="syntaxhighlighter  jscript"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter" ><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class= "line number9 index8 alt2">9</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="jscript keyword">var</code> <code class="jscript plain"> cParam = (</code><code class="jscript keyword">function</code><code class="jscript plain">(a, b, c) {</code></div><div class="line number2 index1 alt1"><code class="jscript spaces"> &nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript plain">c = 3;&nbsp;&nbsp;&nbsp; </code></div><div class="line number3 index2 alt2"><code class="jscript spaces">&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="jscript keyword">delete</code> <code class="jscript plain">arguments[2];</code></div><div class="line number4 index3 alt1"><code class="jscript spaces"> &nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript keyword">return</code> <code class="jscript plain">c;</code></div><div class="line number5 index4 alt2"><code class="jscript plain"> })(1,2);</code></div><div class="line number6 index5 alt1">&nbsp;</div><div class="line number7 index6 alt2"><code class="jscript plain">cParam;</code></div><div class="line number8 index7 alt1"><code class="jscript comments">// Chrome -&gt; undefined</code></div><div class="line number9 index8 alt2"><code class="jscript comments">// Other browsers -&gt; 3 </code></div></div></td></tr></tbody></table></div></div><p>&nbsp;<br><b>arguments.callee</b><br>Every instance of <code>arguments</code> has a <code>callee</code> property which references the currently invoking function. The strict mode of ES5 disallows access to <code>arguments.callee</code> </p><p><b>arguments.caller</b><br>In supported implementations, every instance of <code>arguments</code> has a <code>caller</code> property which references the function (if any) from which the current function was invoked. There is only patchy vendor support for <code>arguments.caller</code> and it is not standardized by ECMA except to explicitly disallow access in the strict mode.</p><p><b>More quirkiness</b><br>1) An <code>arguments </code> object will not be created if <em>arguments</em> is the name of a formal parameter or is used as a variable or function declaration within the function body:</p><div><div id= "highlighter_835953" class="syntaxhighlighter  jscript"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class= "line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="jscript keyword">function</code> <code class="jscript plain">foo(a, arguments) {</code></div><div class="line number2 index1 alt1"><code class="jscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript keyword">return</code> <code class="jscript plain">arguments;</code></div><div class="line number3 index2 alt2"><code class= "jscript plain">};</code></div><div class="line number4 index3 alt1">&nbsp;</div><div class="line number5 index4 alt2"><code class="jscript plain">foo(1); </code><code class="jscript comments">//undefined</code></div><div class="line number6 index5 alt1">&nbsp;</div><div class="line number7 index6 alt2"><code class="jscript keyword">function</code> <code class= "jscript plain">foo(a, b) {</code></div><div class="line number8 index7 alt1"><code class="jscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript keyword">var</code> <code class="jscript plain">arguments = 43;</code></div><div class="line number9 index8 alt2"><code class="jscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript keyword">return </code> <code class="jscript plain">arguments</code></div><div class="line number10 index9 alt1"><code class="jscript plain">};</code></div><div class="line number11 index10 alt2">&nbsp; </div><div class="line number12 index11 alt1"><code class="jscript plain">foo(1, 2); </code><code class="jscript comments">//43</code></div></div></td></tr></tbody></table></div></div><p> &nbsp;<br>2) The SpiderMonkey engine (used by Firefox) supplies a secret value at <code>arguments[0]</code> when invoking <code>valueOf</code>. The value will be “number” if the object is to be coerced to a number, otherwise undefined. </p><p>Thanks to <a href="http://webreflection.blogspot.com/2009/06/javascript-arguments-weridness.html" target="_blank">Andrea Giammarchi </a> for the following example</p><div><div id="highlighter_319137" class="syntaxhighlighter  jscript"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class= "line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div></td><td class="code"><div class="container"><div class= "line number1 index0 alt2"><code class="jscript comments">//FIREFOX BROWSER ONLY...</code></div><div class="line number2 index1 alt1">&nbsp;</div><div class="line number3 index2 alt2" ><code class="jscript keyword">var</code> <code class="jscript plain">o = {</code></div><div class="line number4 index3 alt1"><code class="jscript spaces">&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="jscript plain">push:[].push,</code></div><div class="line number5 index4 alt2"><code class="jscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript plain"> length:0,</code></div><div class="line number6 index5 alt1"><code class="jscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript plain">toString:[].join,</code></div><div class ="line number7 index6 alt2"><code class="jscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript plain">valueOf:</code><code class="jscript keyword">function</code><code class= "jscript plain">(){</code></div><div class="line number8 index7 alt1"><code class="jscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript keyword"> return</code> <code class="jscript plain">arguments[0] == </code><code class="jscript string">"number"</code> <code class="jscript plain">? </code><code class="jscript keyword">this </code><code class="jscript plain">.length : </code><code class="jscript keyword">this</code><code class="jscript plain">.toString();</code></div><div class="line number9 index8 alt2" ><code class="jscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript plain">}</code></div><div class="line number10 index9 alt1"><code class="jscript plain">}; </code></div><div class="line number11 index10 alt2">&nbsp;</div><div class="line number12 index11 alt1"><code class="jscript plain">o.push(1, 2, 3);</code></div><div class="line number13 index12 alt2">&nbsp;</div><div class="line number14 index13 alt1"><code class="jscript plain">o.toString(); </code><code class="jscript comments">// "1,2,3"</code></div><div class="line number15 index14 alt2"><code class="jscript plain">(o*1).toString(); </code><code class="jscript comments">// 3</code></div></div></td></tr></tbody></table></div></div><p>&nbsp;<br><span style="font-weight:bold;font-size:18px;">Arrays vs. arguments</span><br>As noted, the <code>arguments</code> object is not an array. It is not a product of the Array constructor and it lacks all of the standard methods of Array. Moreover changing the length of <code>arguments</code> has no effect on its indexed properties:  </p><div><div id="highlighter_5320" class= "syntaxhighlighter  jscript"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6 </div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10 </div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div></td><td class="code"><div class= "container"><div class="line number1 index0 alt2"><code class="jscript keyword">var</code> <code class="jscript plain">arr = [1,2,3];</code></div><div class="line number2 index1 alt1" ><code class="jscript keyword">var</code> <code class="jscript plain">args = echoArgs(1,2,3);</code></div><div class="line number3 index2 alt2">&nbsp;</div><div class="line number4 index3 alt1"><code class="jscript plain">Object.prototype.toString.apply(arr); </code><code class="jscript comments">//[object Array]</code></div><div class="line number5 index4 alt2"><code class ="jscript plain">Object.prototype.toString.apply(args); </code><code class="jscript comments">//[object Object]</code></div><div class="line number6 index5 alt1">&nbsp;</div><div class= "line number7 index6 alt2"><code class="jscript plain">arr.push(4); </code><code class="jscript comments">//4</code></div><div class="line number8 index7 alt1"><code class="jscript plain"> args.push(4); </code><code class="jscript comments">//TypeError: args.push is not a function</code></div><div class="line number9 index8 alt2">&nbsp;</div><div class="line number10 index9 alt1"><code class="jscript plain">arr.length = 1;</code></div><div class="line number11 index10 alt2"><code class="jscript plain">arr[2]; </code><code class="jscript comments">//undefined </code></div><div class="line number12 index11 alt1"><code class="jscript plain">args.length = 1;</code></div><div class="line number13 index12 alt2"><code class="jscript plain">args[2]; </code><code class="jscript comments">//3</code></div></div></td></tr></tbody></table></div></div><p>&nbsp;<br><b>Leveraging methods of <em>Array.prototype</em></b><br>Since all the methods of <code>Array.prototype</code> are designed to be generic they can be easily applied to the array-compatible <code>arguments</code> object:</p><div><div id="highlighter_828162" class="syntaxhighlighter  jscript"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="jscript keyword">var</code> <code class="jscript plain">args = echoArgs(1,2,3);</code></div><div class="line number2 index1 alt1">&nbsp;</div><div class="line number3 index2 alt2"><code class="jscript plain"> [].push.apply(args,[4,5]);</code></div><div class="line number4 index3 alt1"><code class="jscript plain">args[4]; </code><code class="jscript comments">//5</code></div><div class="line number5 index4 alt2">&nbsp;</div><div class="line number6 index5 alt1"><code class="jscript keyword">var</code> <code class="jscript plain">mapped = [].map.call(args, </code><code class= "jscript keyword">function</code><code class="jscript plain">(s) {</code><code class="jscript keyword">return</code> <code class="jscript plain">s/100});</code></div><div class="line number7 index6 alt2"><code class="jscript plain">mapped[2]; </code><code class="jscript comments">//0.03</code></div></div></td></tr></tbody></table></div></div><p>&nbsp;<br>A common approach is to go one better by using <code>Array.prototype.slice</code> to copy the entire <code>arguments</code> object into a real array:</p><div><div id="highlighter_645440" class= "syntaxhighlighter  jscript"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6 </div><div class="line number7 index6 alt2">7</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="jscript keyword">var</code> <code class= "jscript plain">argsArray = [].slice.apply(echoArgs(1,2,3));</code></div><div class="line number2 index1 alt1">&nbsp;</div><div class="line number3 index2 alt2"><code class="jscript plain" >argsArray.push(4,5);</code></div><div class="line number4 index3 alt1"><code class="jscript plain">argsArray[4]; </code><code class="jscript comments">//5</code></div><div class="line number5 index4 alt2">&nbsp;</div><div class="line number6 index5 alt1"><code class="jscript keyword">var</code> <code class="jscript plain">mapped = argsArray.map(</code><code class= "jscript keyword">function</code><code class="jscript plain">(s) {</code><code class="jscript keyword">return</code> <code class="jscript plain">s/100});</code></div><div class="line number7 index6 alt2"><code class="jscript plain">mapped[2]; </code><code class="jscript comments">//0.03</code></div></div></td></tr></tbody></table></div></div><p>&nbsp;<br><span style= "font-weight:bold;font-size:18px;">Practical Applications</span></p><p><b>1. Functions that take unlimited arguments</b></p><div><div id="highlighter_358119" class="syntaxhighlighter jscript"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class= "line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="jscript keyword">var</code> <code class="jscript plain">average = </code><code class="jscript keyword">function</code><code class="jscript plain">(</code><code class="jscript comments">/*numbers*/ </code><code class="jscript plain">) {</code></div><div class="line number2 index1 alt1"><code class="jscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript keyword">for </code> <code class="jscript plain">(</code><code class="jscript keyword">var</code> <code class="jscript plain">i=0, total = 0, len=arguments.length; i&lt;len; i++) {</code></div><div class="line number3 index2 alt2"><code class="jscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript plain">total += arguments[i]; </code></div><div class="line number4 index3 alt1"><code class="jscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript plain">} </code></div><div class="line number5 index4 alt2"><code class= "jscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript keyword">return</code> <code class="jscript plain">total / arguments.length;</code></div><div class="line number6 index5 alt1"><code class="jscript plain">} </code></div><div class="line number7 index6 alt2">&nbsp;</div><div class="line number8 index7 alt1"><code class="jscript plain">average(50, 6, 5, -1); </code><code class="jscript comments">//15</code></div></div></td></tr></tbody></table></div></div><p>&nbsp;<br><b>2. Verifying all named arguments are supplied</b><br> JavaScript's liberal attitude to parameter passing is appealing but some functions will break if all named arguments are not supplied. We could write a function wrapper to enforce this when necessary: </p><div><div id="highlighter_874205" class="syntaxhighlighter  jscript"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="jscript keyword">var</code> <code class="jscript plain"> requireAllArgs= </code><code class="jscript keyword">function</code><code class="jscript plain">(fn) {</code></div><div class="line number2 index1 alt1"><code class="jscript spaces"> &nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript keyword">return</code> <code class="jscript keyword">function</code><code class="jscript plain">() {</code></div><div class="line number3 index2 alt2"><code class="jscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript keyword">if</code> <code class="jscript plain"> (arguments.length &lt; fn.length) {</code></div><div class="line number4 index3 alt1"><code class="jscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="jscript keyword">throw</code><code class="jscript plain">([</code><code class="jscript string">"Expected"</code><code class="jscript plain">, fn.length, </code><code class="jscript string">"arguments, got"</code><code class="jscript plain">, arguments.length].join(</code><code class="jscript string">" "</code><code class="jscript plain">)); </code></div><div class="line number5 index4 alt2"><code class="jscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript plain">}</code></div><div class= "line number6 index5 alt1"><code class="jscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript keyword">return</code> <code class="jscript plain"> fn.apply(</code><code class="jscript keyword">this</code><code class="jscript plain">, arguments);</code></div><div class="line number7 index6 alt2"><code class="jscript spaces"> &nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript plain">}&nbsp;&nbsp; </code></div><div class="line number8 index7 alt1"><code class="jscript plain">} </code></div><div class="line number9 index8 alt2">&nbsp;</div><div class="line number10 index9 alt1"><code class="jscript keyword">var</code> <code class="jscript plain">divide = requireAllArgs(</code><code class= "jscript keyword">function</code><code class="jscript plain">(a, b) {</code><code class="jscript keyword">return</code> <code class="jscript plain">a/b});</code></div><div class="line number11 index10 alt2">&nbsp;</div><div class="line number12 index11 alt1"><code class="jscript plain">divide(2/5); </code><code class="jscript comments">//"Expected 2 arguments, got 1" </code></div><div class="line number13 index12 alt2"><code class="jscript plain">divide(2,5); </code><code class="jscript comments">//0.4 </code></div></div></td></tr></tbody></table></div></div><p>&nbsp;<br><b>3. A string formatter</b><br>(based on Dean Edwards' <a href="http://code.google.com/p/base2/" target="_blank"> Base 2 library</a>)</p><div><div id="highlighter_767375" class="syntaxhighlighter  jscript"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class= "line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="jscript keyword">function </code> <code class="jscript plain">format(string) {&nbsp; </code></div><div class="line number2 index1 alt1"><code class="jscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class= "jscript keyword">var</code> <code class="jscript plain">args = arguments;&nbsp; </code></div><div class="line number3 index2 alt2"><code class="jscript spaces">&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="jscript keyword">var</code> <code class="jscript plain">pattern = RegExp(</code><code class="jscript string">"%([1-"</code> <code class="jscript plain">+ (arguments.length-1) + </code><code class="jscript string">"])"</code><code class="jscript plain">, </code><code class="jscript string">"g"</code><code class="jscript plain">); </code></div><div class="line number4 index3 alt1"><code class="jscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript keyword">return</code> <code class="jscript plain"> string.replace(pattern, </code><code class="jscript keyword">function</code><code class="jscript plain">(match, index) {&nbsp; </code></div><div class="line number5 index4 alt2"><code class="jscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript keyword">return</code> <code class="jscript plain">args[index];&nbsp; </code></div><div class="line number6 index5 alt1"><code class="jscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript plain">});&nbsp; </code></div><div class="line number7 index6 alt2"><code class="jscript plain">}; </code></div><div class="line number8 index7 alt1">&nbsp;</div><div class="line number9 index8 alt2"><code class="jscript plain">format(</code><code class= "jscript string">"a %1 and a %2"</code><code class="jscript plain">, </code><code class="jscript string">"cat"</code><code class="jscript plain">, </code><code class="jscript string">"dog" </code><code class="jscript plain">);</code></div><div class="line number10 index9 alt1"><code class="jscript comments">//"a cat and a dog" </code></div></div></td></tr></tbody></table></div></div><p>&nbsp;<br><b>4. Partial function application</b><br>The typical JavaScript implementations of <a href=" https://javascriptweblog.wordpress.com/2010/04/05/curry-cooking-up-tastier-functions/" target="_blank">curry</a>, <a href=" https://javascriptweblog.wordpress.com/2010/05/17/partial-currys-flashy-cousin/" target="_blank">partial</a> and <a href=" https://javascriptweblog.wordpress.com/2010/04/14/compose-functions-as-building-blocks/" target="_blank">compose</a> store the <code>arguments</code> object for later concatenation with the runtime arguments of the inner function.</p><div><div id="highlighter_822474" class="syntaxhighlighter  jscript"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class= "gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4 </div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8 </div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12 </div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="jscript plain">Function.prototype.curry = </code><code class="jscript keyword">function</code><code class="jscript plain">() {</code></div><div class="line number2 index1 alt1"><code class="jscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript keyword">if</code> <code class="jscript plain">(arguments.length&lt;1) {</code></div><div class="line number3 index2 alt2"><code class="jscript spaces"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript keyword">return</code> <code class="jscript keyword">this</code><code class="jscript plain">; </code><code class ="jscript comments">//nothing to curry with - return function</code></div><div class="line number4 index3 alt1"><code class="jscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class= "jscript plain">}</code></div><div class="line number5 index4 alt2"><code class="jscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript keyword">var</code> <code class= "jscript plain">__method = </code><code class="jscript keyword">this</code><code class="jscript plain">;</code></div><div class="line number6 index5 alt1"><code class="jscript spaces"> &nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript keyword">var</code> <code class="jscript plain">args = [].slice.apply(arguments);</code></div><div class="line number7 index6 alt2" ><code class="jscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript keyword">return</code> <code class="jscript keyword">function</code><code class="jscript plain">() { </code></div><div class="line number8 index7 alt1"><code class="jscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript keyword">return</code> <code class="jscript plain">__method.apply(</code><code class="jscript keyword">this</code><code class="jscript plain">, args.concat([].slice.apply(arguments)));</code></div><div class="line number9 index8 alt2"><code class="jscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript plain">}</code></div><div class="line number10 index9 alt1"><code class="jscript plain">}</code></div><div class="line number11 index10 alt2">&nbsp;</div><div class="line number12 index11 alt1"><code class="jscript keyword">var</code> <code class="jscript plain"> converter = </code><code class="jscript keyword">function</code><code class="jscript plain">(ratio, symbol, input) {</code></div><div class="line number13 index12 alt2"><code class= "jscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript keyword">return</code> <code class="jscript plain">[(input*ratio).toFixed(1),symbol].join(</code><code class="jscript string">" "</code><code class="jscript plain">);</code></div><div class="line number14 index13 alt1"><code class="jscript plain">}</code></div><div class="line number15 index14 alt2"> &nbsp;</div><div class="line number16 index15 alt1"><code class="jscript keyword">var</code> <code class="jscript plain">kilosToPounds = converter.curry(2.2,</code><code class="jscript string">"lbs"</code><code class="jscript plain">);</code></div><div class="line number17 index16 alt2"><code class="jscript keyword">var</code> <code class="jscript plain"> milesToKilometers = converter.curry(1.62, </code><code class="jscript string">"km"</code><code class="jscript plain">);</code></div><div class="line number18 index17 alt1">&nbsp;</div><div class="line number19 index18 alt2"><code class="jscript plain">kilosToPounds(4); </code><code class="jscript comments">//8.8 lbs</code></div><div class="line number20 index19 alt1"><code class="jscript plain">milesToKilometers(34); </code><code class="jscript comments">//55.1 km</code></div></div></td></tr></tbody></table></div></div><p>&nbsp;<br><span style= "font-weight:bold;font-size:18px;">The Future…</span><br>Brendan Eich has stated that the <code>arguments</code> object will gradually disappear from JavaScript. In this fascinating <a href="http://www.aminutewithbrendan.com/pages/20101115" target="_blank">“minute with Brendan” excerpt</a> he ponders the future of arguments handling. Here's my take away:</p><p><b>rest parameters</b><br>Harmony (the next scheduled specification of ECMAScript) has already penciled in the design for a likely successor known as a <a href=" http://wiki.ecmascript.org/doku.php?id=harmony:rest_parameters" target="_blank">rest parameter</a> and it's scheduled to be prototyped in Firefox later this year (ActionScript already supports a similar feature).</p><p>The idea of behind the <code>rest</code> parameter is disarmingly simple. If you prefix the last (or only) formal parameter name with ‘…', that parameter gets created as an array (a genuine array) which acts as a bucket for all passed arguments that do not match any of the other named parameters.</p><p>Here's a simple example… </p><div><div id="highlighter_236844" class="syntaxhighlighter  jscript"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5 </div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="jscript comments">//Proposed syntax....</code></div><div class="line number2 index1 alt1">&nbsp;</div><div class="line number3 index2 alt2"><code class="jscript keyword">var</code> <code class="jscript plain">callMe(fn, ...args) {</code></div><div class="line number4 index3 alt1"><code class="jscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript keyword">return</code> <code class="jscript plain">fn.apply(args);</code></div><div class="line number5 index4 alt2"><code class="jscript plain">}</code></div><div class="line number6 index5 alt1">&nbsp;</div><div class="line number7 index6 alt2"><code class="jscript plain">callMe(Math.max, 4, 7, 6); </code><code class="jscript comments">//7 </code></div></div></td></tr></tbody></table></div></div><p>&nbsp;<br>…and here's our curry function rewritten using <code>rest</code> arguments. This time there is no need to copy the outer <code>arguments</code> object, instead we make it a <code>rest</code> parameter with a unique name so that the inner function can simply reference it by closure. Also no need to apply array methods to either of our <code>rest</code> arguments. </p><div><div id="highlighter_301197" class="syntaxhighlighter  jscript"><table border="0" cellpadding="0" cellspacing="0" ><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="jscript comments">//Proposed syntax....</code></div><div class="line number2 index1 alt1">&nbsp;</div><div class="line number3 index2 alt2"><code class="jscript plain">Function.prototype.curry = </code><code class="jscript keyword">function</code><code class="jscript plain">(...curryArgs) { </code></div><div class="line number4 index3 alt1"><code class="jscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript keyword">if</code> <code class="jscript plain"> (curryArgs.length &lt; 1) {</code></div><div class="line number5 index4 alt2"><code class="jscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript keyword">return</code> <code class="jscript keyword">this</code><code class="jscript plain">; </code><code class="jscript comments">//nothing to curry with - return function </code></div><div class="line number6 index5 alt1"><code class="jscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript plain">}</code></div><div class="line number7 index6 alt2"><code class="jscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript keyword">var</code> <code class="jscript plain">__method = </code><code class="jscript keyword">this </code><code class="jscript plain">;</code></div><div class="line number8 index7 alt1"><code class="jscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript keyword">return </code> <code class="jscript keyword">function</code><code class="jscript plain">(...args) {</code></div><div class="line number9 index8 alt2"><code class="jscript spaces"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript keyword">return</code> <code class="jscript plain">__method.apply(</code><code class="jscript keyword">this </code><code class="jscript plain">, curryArgs.concat(args);</code></div><div class="line number10 index9 alt1"><code class="jscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class= "jscript plain">}</code></div><div class="line number11 index10 alt2"><code class="jscript plain">}</code></div></div></td></tr></tbody></table></div></div><p>&nbsp;<br><b>spread</b><br> Similar to Ruby's <code>splat</code> operator, <code>spread</code> will unpack an array into a formal argument list. Amongst other things this allows the members of a  <code>rest</code> parameter to be passed as a set of formal arguments to another function:</p><div><div id="highlighter_579224" class="syntaxhighlighter  jscript"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class= "line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class= "line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class= "jscript comments">//Possible future syntax....</code></div><div class="line number2 index1 alt1">&nbsp;</div><div class="line number3 index2 alt2"><code class="jscript keyword">var</code> <code class="jscript plain">stats = </code><code class="jscript keyword">function</code><code class="jscript plain">(...numbers) {</code></div><div class="line number4 index3 alt1"><code class="jscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript keyword">for</code> <code class="jscript plain">(</code><code class="jscript keyword">var</code> <code class= "jscript plain">i=0, total = 0, len=numbers.length; i&lt;len; i++) {</code></div><div class="line number5 index4 alt2"><code class="jscript spaces"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript plain">total += numbers[i]; </code></div><div class="line number6 index5 alt1"><code class="jscript spaces"> &nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript plain">} </code></div><div class="line number7 index6 alt2"><code class="jscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class= "jscript keyword">return</code> <code class="jscript plain">{</code></div><div class="line number8 index7 alt1"><code class="jscript spaces"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript plain">average: total / arguments.length,</code></div><div class="line number9 index8 alt2"><code class= "jscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript plain">max: Math.max(numbers); </code><code class="jscript comments">//spread array into formal params</code></div><div class="line number10 index9 alt1"><code class="jscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript plain">} </code></div><div class="line number11 index10 alt2"><code class="jscript plain">} </code></div><div class="line number12 index11 alt1">&nbsp;</div><div class="line number13 index12 alt2"><code class="jscript plain"> stats(5, 6, 8, 5); </code><code class="jscript comments">//{average: 6, max: 8}</code></div></div></td></tr></tbody></table></div></div><p>&nbsp;<br>Notice that I'm assuming that there will be no need for a formal <code>spread</code> operator and that <code>spread</code> just describes the process of automatic coercion from an array into listed parameters. </p><p>For the above example we could have fallen back on the traditional <code>Math.max.apply(numbers)</code> instead, but unlike <code>apply</code> spread will also work with constructors and with multiple array arguments.</p><p>A Brave New (JavaScript) World awaits…enjoy!</p>					</div>			</div>		<!--=========================			END : POST =============================-->		<!--=========================			START : POST		=============================-->		<div class="post-wrapper">		<h1>The Module Pattern, A Little More Detail</h1>		<div class="body"><p><em>Once you've read this, <a href="http://macwright.org/2013/01/22/javascript-module-pattern-memory-and-closures.html">read the update which has more detailed information about the module pattern's performance profile!</a></em></p><p>This is an article on the <em>module pattern</em> for Javascript, and some ofits neat properties when used for instances.I've been using it recently for projects like<a href="http://mapbox.com/mapbox.js/api/">mapbox.js</a>, and thinkit's a neat way to structure code and avoid some of the less likable partsof the language.</p><div class="shutter-300"><img src="http://farm8.staticflickr.com/7078/7174033128_698c1abccb_z.jpg"></div><p>For those already doing Javascript: here's why you should care.</p><ol><li>You can mostly avoid the problem of tracking the meaning of Javascript'spesky <a href=" http://www.quirksmode.org/js/this.html"><code>this</code></a> keyword, and the associatedproblem of <a href=" https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Function/bind">rebinding functions</a>to another <code>this</code> value.</li><li>You can keep truly internal 'states' of your code private whileexposing minimal APIs that you know will stay stable.</li><li>Often this yields code that's more friendly to Javascript compression,like I wrote about in <a href= "http://macwright.org/2011/10/06/javascript.html">Writing Javascript For Size</a></li><li>You can avoid the sneaky problems of users forgetting the <code>new</code>keyword, and the <a href ="http://ejohn.org/blog/simple-class-instantiation/">workarounds people use to dodge them</a></li></ol><p>For those starting to learn Javascript.</p><ol><li>Once you understand scopes, you understand this pattern.</li><li>Impress your friends.</li></ol><h2 id="let-39-s-begin">Let's Begin</h2><p>To be clear, I adopted the style of the module patternused by <a href=" http://bost.ocks.org/">Mike Bostock</a>, who presumably got itfrom earlier figures, and so on. Usually the variable-containingand scope-control bits of this pattern get the most attention -this sheds some light on other benefits that touch <em>browser</em>and <em>async</em> code as well.</p><h4 id="javascript-with-classical-objects">Javascript with Classical Objects </h4><div class="highlight"><pre><code data-lang="js" class="language-js"><span class="kd">function</span> <span class="nx">Car</span><span class="p">()</span> <span class="p">{</span> <span class="k">this</span><span class="p">.</span><span class="nx">direction</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span><span class="p">}</span><span class="nx">Car</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">turn</span> <span class="o">=</span> <span class="kd">function </span><span class="p">(</span><span class="nx">angle</span><span class="p">)</span> <span class="p">{</span> <span class="k">this</span><span class="p">.</span><span class="nx">direction </span> <span class="o">+=</span> <span class="nx">angle</span><span class="p">;</span> <span class="p">};</span><span class="kd">var</span> <span class="nx">c</span> <span class="o">= </span> <span class="k">new</span> <span class="nx">Car</span><span class="p">();</span></code></pre></div><p>In which you're using <a href=" http://yehudakatz.com/2011/08/12/understanding-prototypes-in-javascript/">Javascript's prototypes</a>to create a Javascript class, and using <code>this</code> to referto 'this instantiated object'.</p><h4 id="javascript-with-module-pattern">Javascript with Module Pattern</h4><div class="highlight"><pre><code data-lang="js" class="language-js"><span class="kd"> function</span> <span class="nx">Car</span><span class="p">()</span> <span class="p">{</span>    <span class="kd">var</span> <span class="nx">car</span> <span class="o">=</span> <span class="p">{},</span>        <span class="nx">direction</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>    <span class="nx">car</span><span class="p">. </span><span class="nx">turn</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">angle</span><span class="p">)</span> <span class="p">{ </span> <span class="nx">direction</span> <span class="o">+=</span> <span class="nx">angle</span><span class="p">;</span> <span class="p">};</span>    <span class="k">return</span> <span class="nx">car</span><span class="p">;</span><span class="p">}</span><span class="kd">var</span> <span class="nx">c</span> <span class="o">=</span> <span class="nx">Car</span><span class= "p">();</span></code></pre></div><p>Here, you're creating a new Javascript object literalevery time that you call <code>Car()</code>. Notice that, unlike the <code>prototype</code>method, there's no <code>new</code> operator.</p><h2 id="a-quick-summary">A Quick Summary</h2><p>What are the essential bits?</p><div class="highlight"><pre><code data-lang="js" class= "language-js"><span class="c1">// a plain function. I prefer downcase because only true</span><span class="c1">// Javascript classes should be uppercase (like Date or Math)</span><span class="c1">// and this isn't a class, it's a factory</span><span class="kd">function</span> <span class="nx">thing</span><span class="p">()</span> <span class="p">{</span>    <span class= "c1">// The first thing in the function is a bunch of scoped</span>    <span class="c1">// variables. One of these scoped variables is always an empty</span>    <span class="c1">// object to which you'll assign properties and methods</span>    <span class="c1">// before it goes out the door as the value this function</span>    <span class="c1">// returns.</span>    <span class="c1">// This is that object. It could also be named 'thing'</span>    <span class="c1">// but that would be shadowing the function 'thing'</span>    <span class="c1">// and that's not a good thing to do.</span>    <span class="kd">var</span> <span class="nx">t</span> <span class="o">=</span> <span class="p">{},</span>        <span class="c1">// Now any variables that represent the state and data</span>        <span class="c1">// of this object, thing. These are not attached to</span>        <span class="c1">// the t object, they're attached to the scope it can</span>        <span class="c1">// access - the scope of this thing() function.</span>        <span class="nx">count</span> <span class="o">=</span> <span class="mi">0 </span><span class="p">;</span>    <span class="c1">// You can also create functions here that are scoped</span>    <span class="c1">// and use them as callbacks, and they'll have access to</span>    <span class="c1">// this t object's scoped variables.</span>    <span class="c1">//</span>    <span class="c1">// Functions that aren't attached to t are just like</span> <span class="c1">// the scoped variables above - they aren't accessible to</span>    <span class="c1">// the API user. This is kind of like the private keyword</span>    <span class="c1"> // elsewhere</span>    <span class="kd">function</span> <span class="nx">handler</span><span class="p">()</span> <span class="p">{</span>        <span class="nx">count</span><span class= "o">++</span><span class="p">;</span>    <span class="p">}</span>    <span class="c1">// Now you make the decision of the set of methods on t.</span>    <span class="c1">// These have access to all of the scoped variables as well.</span>    <span class="nx">t</span><span class="p">.</span><span class="nx">talk</span> <span class="o">=</span> <span class="kd">function </span><span class="p">(</span><span class="nx">x</span><span class="p">)</span> <span class="p">{</span>        <span class="nx">alert</span><span class="p">(</span><span class="nx">x </span><span class="p">);</span>    <span class="p">};</span>    <span class="c1">// Finally, when you're done with t, return it.</span>    <span class="k">return</span> <span class="nx">t </span><span class="p">;</span>    <span class="c1">// In terms of the idea of a 'closure', this is how you</span>    <span class="c1">// 'close over' the scope of the object. Someone who calls</span>    <span class="c1">// thing() gets a copy of t to play around with, but that</span>    <span class="c1">// t will always refer to the scoped variables we just</span>    <span class="c1">// defined.</span><span class="p">}</span></code></pre></div><h2 id="1-no-more-this">1. No More This</h2><p>The most common annoyance with <code>this</code> is in event handlers, because they<a href="http://www.sitepoint.com/javascript-this-event-handlers/">turn this into the element that's the source of the event</a>.</p><p>So let's say that you're creating a simple counter, that attachesto a <a href="http://en.wikipedia.org/wiki/Document_Object_Model">DOM</a>element being clicked. The classical version might look like</p><div class= "highlight"><pre><code data-lang="js" class="language-js"><span class="kd">function</span> <span class="nx">Counter</span><span class="p">()</span> <span class="p">{</span> <span class="k" >this</span><span class="p">.</span><span class="nx">count</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="p">}</span><span class="nx"> Counter</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">increment</span> <span class="o">=</span> <span class="kd">function </span><span class="p">()</span> <span class="p">{</span> <span class="k">this</span><span class="p">.</span><span class="nx">count</span><span class="o">++</span><span class="p">;</span> <span class="p">};</span><span class="nx">Counter</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">countClicks</span> <span class="o" >=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">element</span><span class="p">)</span> <span class="p">{</span>    <span class="nx">element</span><span class="p">.</span><span class="nx">onclick</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">increment</span><span class="p">;</span><span class="p">};</span><span class="kd">var</span> <span class="nx">c</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Counter</span><span class="p">();</span><span class="nx">c</span><span class="p">.</span><span class="nx">countClicks</span><span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nx"> getElementById</span><span class="p">(</span><span class="s1">'increment'</span><span class="p">));</span><span class="nb">document</span><span class="p">.</span><span class="nx"> getElementById</span><span class="p">(</span><span class="s1">'tell'</span><span class="p">).</span><span class="nx">onclick</span> <span class="o">=</span> <span class="kd">function </span><span class="p">()</span> <span class="p">{</span>    <span class="nx">alert</span><span class="p">(</span><span class="nx">c</span><span class="p">.</span><span class="nx">count </span><span class="p">);</span><span class="p">};</span></code></pre></div><p>This looks valid, but isn't. Clicking on <code>increment</code> repeatedly and then on'tell' will tell you that Counter's value is still 0. Why? Because<code>Counter.prototype.increment</code> runs, but the value of <code>this</code> in thatcontext is the DOM element of the <code>increment </code> button, not counter.</p><p>A typical fix to this is to change the line to include <code>bind</code>, a functionthat changes the value of <code>this</code> in a function for any time that it runsin the future. Since this isn't IE-safe, it's more popular to use<a href="http://underscorejs.org/#bind"><code>_.bind</code></a> from underscore.js or<a href=" http://api.jquery.com/jQuery.proxy/"><code>jQuery.proxy()</code></a> in the placeof the standard Javascript function.</p><div class="highlight"><pre><code data-lang="js" class= "language-js"><span class="nx">Counter</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">countClicks</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">element</span><span class="p">)</span> <span class="p">{</span>    <span class="nx">element</span><span class="p">. </span><span class="nx">onclick</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">increment</span><span class="p">.</span><span class="nx" >bind</span><span class="p">(</span><span class="k">this</span><span class="p">);</span><span class="p">};</span></code></pre></div><p>This is fine, and more serious Javascript environments like<a href="http://documentcloud.github.com/backbone/">Backbone</a> provideconvenience methods like <code>bindAll</code> that let you rebind a wholebunch of functions at one time, so you can totally forget aboutthe <code>this</code> problem. But it's still there, and when your code leavesthat land, it's a valid annoyance.</p><p>Here's the other way to do this functionality:</p><div class="highlight"><pre><code data-lang="js" class="language-js"><span class="kd">function</span> <span class="nx">Counter</span><span class="p">()</span> <span class ="p">{</span>    <span class="kd">var</span> <span class="nx">count</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>        <span class="nx">c</span> <span class="o">=</span> <span class="p">{};</span>    <span class="kd">function</span> <span class="nx">increment</span><span class="p">()</span> <span class="p">{</span> <span class="nx"> count</span><span class="o">++</span><span class="p">;</span> <span class="p">}</span>    <span class="nx">c</span><span class="p">.</span><span class="nx">countClicks</span> <span class= "o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">element</span><span class="p">)</span> <span class="p">{</span>        <span class="nx">element </span><span class="p">.</span><span class="nx">onclick</span> <span class="o">=</span> <span class="nx">increment</span><span class="p">;</span>    <span class="p">};</span>    <span class="nx">c</span><span class="p">.</span><span class="nx">clicks</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span> <span class="k">return</span> <span class="nx">count</span><span class="p">;</span> <span class="p">}</span>    <span class="k">return</span> <span class="nx">c</span><span class="p">; </span><span class="p">}</span><span class="kd">var</span> <span class="nx">c</span> <span class="o">=</span> <span class="nx">Counter</span><span class="p">();</span><span class="nx">c </span><span class="p">.</span><span class="nx">countClicks</span><span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById </span><span class="p">(</span><span class="s1">'increment'</span><span class="p">));</span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById </span><span class="p">(</span><span class="s1">'tell'</span><span class="p">).</span><span class="nx">onclick</span> <span class="o">=</span> <span class="kd">function</span><span class= "p">()</span> <span class="p">{</span>    <span class="nx">alert</span><span class="p">(</span><span class="nx">c</span><span class="p">.</span><span class="nx">clicks</span><span class= "p">());</span><span class="p">};</span></code></pre></div><h2 id="2-internal-and-external-states">2. Internal And External States</h2><p>This is a mixed bag, but there are some good examples of whyit's awesome. Let's say you have a library that <a href="https://github.com/mapbox/markers.js">manages aset of markers on a map</a>.</p><p>Of course, this will require the functionality of adding a markerto the map. With a classical object, in most cases an uninformedor adventurous user could see that <code>.markers</code> is exposed and just<code> .markers.push(newmarker)</code> it into the object.</p><p>The literal pattern lets you be much more paranoid, with a setup like</p><div class="highlight"><pre><code data-lang="js" class= "language-js"><span class="kd">function</span> <span class="nx">mmg</span><span class="p">()</span> <span class="p">{</span>    <span class="kd">var</span> <span class="nx">m</span> <span class="o">=</span> <span class="p">{},</span>        <span class="nx">markers</span> <span class="o">=</span> <span class="p">[];</span>    <span class="nx">m</span><span class="p">. </span><span class="nx">add_marker</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">x</span><span class="p">)</span> <span class="p" >{</span>        <span class="c1">// do various things to x, adjust its style,</span>        <span class="c1">// validate it,</span>        <span class="c1">// add event handlers, and then...</span>        <span class="nx">markers</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">x</span><span class="p">);</span>    <span class="p">}</span>    <span class="nx">m</span><span class="p">.</span><span class="nx">markers</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>        <span class="c1">// And then give the user read-only access</span>        <span class="c1">// to the internal markers array.</span>        <span class="k"> return</span> <span class="nx">markers</span><span class="p">.</span><span class="nx">splice</span><span class="p">();</span>    <span class="p">}</span>    <span class="k">return</span> <span class="nx">m</span><span class="p">;</span><span class="p">}</span></code></pre></div><h2 id="3-compression">3. Compression</h2><p>On this note, mostly just read <a href=" http://macwright.org/2011/10/06/javascript.html">Writing Javascript For Size</a>.The public/private split allows compression to 'mangle' more namesthat they know will not be accessible to the global scope.</p><p>For instance, the code</p><div class="highlight"><pre><code data-lang="js" class="language-js"><span class="kd">function</span> <span class="nx">thing</span><span class="p">()</span> <span class="p">{</span>    <span class="kd">var</span> <span class="nx">t</span> <span class="o">=</span> <span class="p">{};</span>    <span class="kd">function </span> <span class="nx">internalFunction</span><span class="p">()</span> <span class="p">{</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">'foo'</span><span class="p">);</span> <span class="p">}</span>    <span class="kd">function</span> <span class="nx">internalFunctionTwo</span><span class ="p">()</span> <span class="p">{</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">'foo'</span><span class= "p">);</span> <span class="p">}</span>    <span class="nx">t</span><span class="p">.</span><span class="k">do</span> <span class="o">=</span> <span class="kd">function</span><span class= "p">()</span> <span class="p">{</span>        <span class="nx">internalFunctionTwo</span><span class="p">();</span>        <span class="nx">internalFunction</span><span class="p">(); </span>    <span class="p">}</span><span class="p">};</span></code></pre></div><p>Allows a Javascript compressor like <a href="https://github.com/mishoo/UglifyJS">UglifyJS</a>to shorten the names of <code>internalFunction</code> and <code>internalFunctionTwo</code> tosingle-letter names - there's no way that you'll be able to access them, sothe names can change. By contrast, after minifying the code:</p><div class="highlight"><pre><code data-lang="js" class="language-js"><span class="kd">function</span> <span class="nx">thing</span><span class="p">() </span> <span class="p">{</span> <span class="p">}</span><span class="nx">thing</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx"> internalFunction</span><span class="p">()</span> <span class="p">{</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">'foo'</span><span class="p">);</span> <span class="p">};</span><span class="nx">thing</span><span class="p">.</span><span class="nx">prototype</span><span class="p">. </span><span class="nx">internalFunctionTwo</span><span class="p">()</span> <span class="p">{</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">'foo'</span><span class="p">);</span> <span class="p">};</span><span class="nx">thing</span><span class="p">.</span><span class="nx">prototype </span><span class="p">.</span><span class="k">do</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>    <span class="nx"> internalFunctionTwo</span><span class="p">();</span>    <span class="nx">internalFunction</span><span class="p">();</span><span class="p">};</span></code></pre></div><p>The long function names <code>internalFunction</code> and <code>internalFunctionTwo</code> willremain in their entirety.</p><h2 id="disadvantages">Disadvantages</h2><ol><li><strike>This method is slower for certain cases</strike></li><li>The power to have private methods and variables can be abused</li><li>Extending objects is unclear</li><li>Object identities is unclear - <code> instanceof</code> doesn't work.</li><li><strike>This may have higher memory usage, because creating newobjects can create new copies of their members.</strike></li></ol><p>As far as <strong>speed</strong>. Creating object literals is faster than instantiatingobjects with constructors in most browsers, as <a href="http://jsperf.com/prototype-vs-literal">this jsperf test from Mike Bostock</a>shows. <strike>But dispatching method calls on those objects is slower.</strike></p><p>But unless you're doing some very serious, millions-of-iterationscomputation, Javascript engine level optimizations probably aren'tthe biggest worry. <strike>In V8, small, prototype-based objects tend to out-performliteral objects created with the module pattern - good insights canbe found in <a href="http://youtu.be/hWhMKalEicY?t=48s">this bit of Lars Bak's talk on the subject</a></strike>and the aha moment for objects versus arrays came from reading<a href="https://github.com/deanm/pre3d/blob/master/pre3d.js#L32">this bit of pre3d.js</a>.</p><p><em>Update:</em> <a href=" http://code.google.com/p/v8/">V8</a>'s<a href="https://developers.google.com/v8/design">hidden classes</a>don't actually correspond to 'classes', and don't provide a performanceboost to prototype-oriented code.</p><p>As far as the <strong>abusable power to do private members</strong>. There can bethe feeling that you start off with an object like</p><div class="highlight" ><pre><code data-lang="js" class="language-js"><span class="kd">function</span> <span class="nx">beautifulworld</span><span class="p">()</span> <span class="p">{</span>    <span class="kd" >var</span> <span class="nx">bw</span><span class="p">,</span>        <span class="nx">a</span><span class="p">,</span> <span class="nx">b</span><span class="p">,</span> <span class="nx">c </span><span class="p">;</span>    <span class="nx">bw</span><span class="p">.</span><span class="nx">setthings</span> <span class="o">=</span> <span class="kd">function</span><span class= "p">(</span><span class="nx">x</span><span class="p">)</span> <span class="p">{</span>        <span class="nx">a</span> <span class="o">=</span> <span class="nx">x</span> <span class="o">* </span> <span class="mi">10</span><span class="p">;</span>        <span class="nx">b</span> <span class="o">=</span> <span class="nx">x</span> <span class="o">*</span> <span class="mi">20 </span><span class="p">;</span>        <span class="nx">c</span> <span class="o">=</span> <span class="nx">x</span> <span class="o">*</span> <span class="mi">30</span><span class="p">; </span>    <span class="p">};</span>    <span class="k">return</span> <span class="nx">bw</span><span class="p">;</span><span class="p">}</span></code></pre></div><p>And end up exposing a, b, and c, after realizing that private thingscouldn't be private. So, if nothing else, this method requiresan extra thought process to consider the level of encapsulationneeded.</p><h3 id="extending-classes">Extending Classes</h3><p>I rarely encounter the problem of really <strong>extending classes</strong>.Ben Cherry's linked article has one possibility, and you can also just use an objectthat uses another object internally - like how <a href="http://mapbox.com/wax/">Wax's</a><a href=" https://github.com/mapbox/wax/blob/master/control/lib/interaction.js">interaction lib</a> isused in <a href="https://github.com/mapbox/wax/blob/master/control/mm/interaction.js"> specialized API-specific controls</a>which 'customize' the object internally. This is the idea of using<a href="http://en.wikipedia.org/wiki/Composition_over_inheritance">composition over inheritance</a>.</p><h3 id="instanceof">instanceof</h3><p>As far as the <code>instanceof</code> problem - with classical objects, when youcall <code>var x = new baseballbat()</code>, then <code>x instanceof baseballbat</code> returns<code>true</code>, and <code>x instanceof foo</code> returns <code>false</code>. Every once in a bluemoon this is handy, but it often runs into the same problems as strongly-typedlanguages, in which direct class-equivalence isn't all that importanceand it's more likely you want to ask whether the object has methods orproperties you need in your code, not its origin.</p><p>For instance, in a large-scale project like <a href="http://mapbox.com/carto/">Carto</a>,which required object identities, a chain of inheritance meant that theonly sensible way to do identity was to add a <code>.is</code> member with a flagtelling what the value should be interpreted as. Except in the most extremecases, I don't see much <code>instanceof</code> use in the wild.</p><h3 id="memory">Memory</h3><p>As far as the last possible disadvantage, higher memory usage -memory in Javascript has been a bit of an uncertain, given limiteddeveloper tools and the variability between Javascript engines.</p><p>For objects that you'll want thousands of, it might be a better optionto either go with <em>literal objects</em> - for instance, the data typesin <a href="http://modestmaps.com/">Modest Maps</a> would probably becomesimple arrays and their methods could easily become part of a singletonobject. <a href="http://jfire.io/">John Firebaugh</a> confirmed this with a <a href="https://gist.github.com/3961693">test that shows</a> that for objects with many functionst that are initialized manytimes, there's a serious (5x) difference in memory usage, dueto more heap closures. So, it makes sense to use the module patternfor smaller objects, like UI widgets, map objects, and so on, whileother techniques work well for atomic data, like pixel measures ornodes in a tree.</p><h2 id="see-also">See Also </h2><ul><li><a href="http://www.adequatelygood.com/2010/3/JavaScript-Module-Pattern-In-Depth">JavaScript Module Pattern: In-Depth</a> by Ben Cherry</li><li><a href=" http://bost.ocks.org/mike/chart/">Towards Reusable Charts</a> by Mike Bostock</li><li><a href="http://viswaug.wordpress.com/2008/11/19/writing-better-javascript-part-5/">Vish Uma switched to the module pattern</a> and<a href="http://viswaug.wordpress.com/2011/03/02/moving-away-from-the-javascript-module-pattern/">from it back to classical objects</a>. Hiswriting reminded me of the possible memory issue, so that section was added.</li><li><a href="http://addyosmani.com/resources/essentialjsdesignpatterns/book/">Learning JavaScript Design Patterns</a>by <a href="http://addyosmani.com/blog/">Addy Osmani</a> covers this and many other patterns.</li></ul><p>Have more ideas on this subject? Let me know over email or by tweeting at<code>@tmcw </code>.</p></div>			</div>		<!--=========================			END : POST		=============================-->		<!--=========================			START : POST		=============================-->		<div class="post-wrapper">		<h1>JavaScript Constructor Functions vs Factory Functions</h1>		<div class="entry_post"> <p>My previous blog post, <a href="http://ericleads.com/2012/09/stop-using-constructor-functions-in-javascript/">Stop Using Constructor Functions in JavaScript</a> has been a bit controversial, so I decided to break down the benefits vs drawbacks (or pros and cons if you prefer). Since everybody is already familiar with constructors, we'll start there.</p><p>If you need more information and examples about factory functions, click the link above. There are also a lot more examples of factory function use in the <a href=" https://github.com/dilvie/fluentjs1/blob/master/fluent-javascript.js">source code</a> from my talk, <a href="http://ericleads.com/2012/06/fluent-javascript-part-1-prototypal-oo/">Fluent JavaScript Part One: Prototypal OO</a>. I hope this sheds more light on the subject.</p><h2>What is a Constructor?</h2><p>Before we go any further, it'll probably help to review the basics of the constructor function. </p><p>They're pretty simple:</p><p></p> <div style="margin-top: 12px; margin-bottom: 12px; font-size: 12px ! important; line-height: 15px ! important; height: auto;" data-settings=" minimize scroll-mouseover" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" id= "crayon-544327cdb7772677743020"><div class="crayon-plain-wrap"><textarea wrap="soft" style="-moz-tab-size: 2; font-size: 12px ! important; line-height: 15px ! important; opacity: 0; overflow: hidden; z-index: 0;" readonly="" data-settings="dblclick" class="crayon-plain print-no">function Foo() {  this.bar = 'baz';}</textarea></div><div style="position: relative; z-index: 1; overflow: hidden;" class="crayon-main"><table class="crayon-table" style=""><tbody><tr class="crayon-row"><td data-settings="show" class="crayon-nums "><div style="font-size: 12px !important; line-height: 15px !important;" class="crayon-nums-content"><div data-line="crayon-544327cdb7772677743020-1" class="crayon-num">1</div><div data-line= "crayon-544327cdb7772677743020-2" class="crayon-num crayon-striped-num">2</div><div data-line="crayon-544327cdb7772677743020-3" class="crayon-num">3</div></div></td><td class="crayon-code" ><div style="font-size: 12px !important; line-height: 15px !important;" class="crayon-pre"><div id="crayon-544327cdb7772677743020-1" class="crayon-line"><span class="crayon-t">function </span><span class="crayon-h"> </span><span class="crayon-e">Foo</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class= "crayon-sy">{</span></div><div id="crayon-544327cdb7772677743020-2" class="crayon-line crayon-striped-line"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-r">this </span><span class="crayon-sy">.</span><span class="crayon-v">bar</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s"> 'baz'</span><span class="crayon-sy">;</span></div><div id="crayon-544327cdb7772677743020-3" class="crayon-line"><span class="crayon-sy">} </span></div></div></td></tr></tbody></table></div></div><p></p><p>The call signature looks something like this:</p><p><code>myFoo = new Foo();</code></p><p>The capital letter doesn't have any meaning to JavaScript. It's just there to alert you that you're calling a constructor, so you don't forget <code>new</code> and break something. The special keyword, <code>new </code> is what matters. It sets the context of <code>this</code> to mean the newly created object (an instance of <code>Foo()</code>). </p><p>That is what <code>this</code> is all about. (See what I did there?)</p><p>Other than that, the constructor is just like any other function. Almost. If you return something falsy you'll get back a new, empty instance of <code>Foo() </code> instead of the value you returned. However, if you return any object, including a function or array, you'll get back whatever you returned. (Hat tip: Chris Hernandez)</p><p>The point is, you can return any arbitrary object you want, just like you can with a factory function. Try it out:</p><p></p> <div style="margin-top: 12px; margin-bottom: 12px; font-size: 12px ! important; line-height: 15px ! important; height: auto;" data-settings=" minimize scroll-mouseover" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" id="crayon-544327cdb778d343794084"><div class="crayon-plain-wrap"><textarea wrap="soft" style="-moz-tab-size: 2; font-size: 12px ! important; line-height: 15px ! important; opacity: 0; overflow: hidden; z-index: 0;" readonly="" data-settings="dblclick" class="crayon-plain print-no">function Foo() {  this.bar = 'baz';  return { baz: 'bif' };}console.log(new Foo()); // Object {baz: "bif"}</textarea></div><div style="position: relative; z-index: 1; overflow: hidden;" class="crayon-main"><table class="crayon-table" style="" ><tbody><tr class="crayon-row"><td data-settings="show" class="crayon-nums "><div style="font-size: 12px !important; line-height: 15px !important;" class="crayon-nums-content"><div data-line="crayon-544327cdb778d343794084-1" class="crayon-num">1</div><div data-line="crayon-544327cdb778d343794084-2" class="crayon-num crayon-striped-num">2</div><div data-line= "crayon-544327cdb778d343794084-3" class="crayon-num">3</div><div data-line="crayon-544327cdb778d343794084-4" class="crayon-num crayon-striped-num">4</div><div data-line= "crayon-544327cdb778d343794084-5" class="crayon-num">5</div><div data-line="crayon-544327cdb778d343794084-6" class="crayon-num crayon-striped-num">6</div></div></td><td class="crayon-code" ><div style="font-size: 12px !important; line-height: 15px !important;" class="crayon-pre"><div id="crayon-544327cdb778d343794084-1" class="crayon-line"><span class="crayon-t">function </span><span class="crayon-h"> </span><span class="crayon-e">Foo</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class= "crayon-sy">{</span></div><div id="crayon-544327cdb778d343794084-2" class="crayon-line crayon-striped-line"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-r">this </span><span class="crayon-sy">.</span><span class="crayon-v">bar</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s"> 'baz'</span><span class="crayon-sy">;</span></div><div id="crayon-544327cdb778d343794084-3" class="crayon-line"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-st">return </span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-h"> </span><span class="crayon-v">baz</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">'bif'</span><span class="crayon-h"> </span><span class="crayon-sy">}</span><span class="crayon-sy">;</span></div><div id="crayon-544327cdb778d343794084-4" class="crayon-line crayon-striped-line"><span class="crayon-sy">}</span></div><div id="crayon-544327cdb778d343794084-5" class="crayon-line">&nbsp;</div><div id= "crayon-544327cdb778d343794084-6" class="crayon-line crayon-striped-line"><span class="crayon-v">console</span><span class="crayon-sy">.</span><span class="crayon-e">log</span><span class= "crayon-sy">(</span><span class="crayon-r">new</span><span class="crayon-h"> </span><span class="crayon-e">Foo</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-c">// Object {baz: "bif"} </span></div></div></td></tr></tbody></table></div></div><p></p><p>Notice how it returns the object literal instead of <code>this</code>? Cool, huh? A constructor is just a factory function with <code>this</code> glued to the new object for your “convenience”. In other words, <strong>it's a less flexible subset of a factory function</strong>.</p><p>The problem is, it's not really convenient. Read on!</p><h2>Benefits of using constructors</h2><ul><li><p>Most books teach you to use constructors and <code>new</code></p></li><li><p><code>this</code> refers to the new object</p></li><li><p>Some people like the way <code>var myFoo = new Foo();</code> reads.</p></li></ul><h2>Drawbacks</h2><ul><li><p>Details of instantiation get leaked into the calling API (via the <code>new</code> requirement), so all callers are tightly coupled to the constructor implementation. If you ever need the additional flexibility of the factory, you'll have to refactor all callers (admittedly the exceptional case, rather than the rule).</p></li><li><p>Forgetting <code>new</code> is such a common bug, you should strongly consider adding a boilerplate check to ensure that the constructor is called correctly ( <code>if (!(this instanceof Foo)) { return new Foo() }</code> ).</p></li><li><p>If you do the <code>instanceof</code> check, it leaves ambiguity as to whether or not <code>new</code> is required. In my opinion, it shouldn't be. You've effectively short circuited the <code>new </code> requirement, which means you could erase drawback #1. But then <strong>you've just got a factory function in all but name</strong>, with additional boilerplate, a capital letter, and less flexible <code>this</code> context.</p></li></ul><h2>What is a factory?</h2><p>Simple &ndash; just a regular function that returns a new object. It behaves just like any other function would:</p><p></p> <div style="margin-top: 12px; margin-bottom: 12px; font-size: 12px ! important; line-height: 15px ! important; height: auto;" data-settings=" minimize scroll-mouseover" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" id="crayon-544327cdb77a4557282015"><div class="crayon-plain-wrap" ><textarea wrap="soft" style="-moz-tab-size: 2; font-size: 12px ! important; line-height: 15px ! important; opacity: 0; overflow: hidden; z-index: 0;" readonly="" data-settings="dblclick" class="crayon-plain print-no">function foo() {  return { bar: 'baz' };}</textarea></div><div style="position: relative; z-index: 1; overflow: hidden;" class="crayon-main"><table class= "crayon-table" style=""><tbody><tr class="crayon-row"><td data-settings="show" class="crayon-nums "><div style="font-size: 12px !important; line-height: 15px !important;" class= "crayon-nums-content"><div data-line="crayon-544327cdb77a4557282015-1" class="crayon-num">1</div><div data-line="crayon-544327cdb77a4557282015-2" class="crayon-num crayon-striped-num">2 </div><div data-line="crayon-544327cdb77a4557282015-3" class="crayon-num">3</div></div></td><td class="crayon-code"><div style="font-size: 12px !important; line-height: 15px !important;" class="crayon-pre"><div id="crayon-544327cdb77a4557282015-1" class="crayon-line"><span class="crayon-t">function</span><span class="crayon-h"> </span><span class="crayon-e">foo</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div id="crayon-544327cdb77a4557282015-2" class= "crayon-line crayon-striped-line"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class= "crayon-h"> </span><span class="crayon-v">bar</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">'baz'</span><span class="crayon-h"> </span><span class="crayon-sy">}</span><span class="crayon-sy">;</span></div><div id="crayon-544327cdb77a4557282015-3" class="crayon-line"><span class="crayon-sy">} </span></div></div></td></tr></tbody></table></div></div><p></p><p>For more examples, check out the <a href="https://github.com/dilvie/fluentjs1/blob/master/fluent-javascript.js"> Prototypal OO source code</a> mentioned already.</p><h2>Benefits of using factories</h2><ul><li><p>Less code &ndash; no boilerplate required.</p></li><li><p>You can return any arbitrary object, and use any arbitrary prototype &ndash; giving you more flexibility to create various types of objects which implement the same API. For example, a media player that can create instances of both HTML5 and flash players, or an event library which can emit DOM events or web socket events.</p></li><li><p>You'd never have a need to convert from a factory to a constructor, so refactoring will never be an issue.</p></li><li><p>No ambiguity about using <code>new</code>. Don't. (It will make <code>this</code> behave badly, see next point). </p></li><li><p><code>this</code> behaves as it normally would &ndash; so you can use it to access the parent object (for example, inside <code>player.create()</code>, <code>this</code> refers to <code>player</code>, just like any other method invocation would. <code>call</code> and <code>apply</code> also reassign <code>this</code>, as expected. If you store prototypes on the parent object, that can be a great way to dynamically swap out functionality, and enable very flexible polymorphism for your object instantiation.</p></li><li><p>No ambiguity about whether or not to capitalize. Don't. Lint tools will complain, and then you'll be tempted to try to use <code>new</code>, and then you'll undo the benefit described above.</p></li><li><p> Some people like the way <code>var myFoo = foo();</code> or <code>var myFoo = foo.create();</code> reads.</p></li></ul><h2>Drawbacks</h2><ul><li><p><code>new</code> doesn't behave as expected (see above). Solution: don't use it.</p></li><li><p><code>this</code> doesn't refer to the new object (instead, if the constructor is invoked with dot notation or square bracket notation, e.g. foo.bar() &ndash; <code>this</code> refers to <code>foo</code> &ndash; just like every other JavaScript method &mdash; see benefits).</p></li></ul><h2>Conclusion</h2><p><a href="http://ericleads.com/2012/09/stop-using-constructor-functions-in-javascript/">Stop Using Constructor Functions in JavaScript</a></p></div>			</div> <!--=========================			END : POST		=============================-->		<!--=========================			START : POST =============================-->		<div class="post-wrapper">		<h1>How to Use Javascript Singleton Design Pattern with an Example</h1>		<div itemprop="articleBody" class= "post_content"><p>Design pattern generally solves few typical programming challenges and makes it more scalable, reusable and meaningful.</p><p>It provides a generalized solution for frequently encountered problems, which typically tends to increase the total number of lines of code a program has to write.</p><p>The following are few benefits of understanding and using Design Patterns:<br><span id="more-15949"></span></p><ul><li>Modular code</li><li>Reusable code</li><li>Increased readability</li><li>More meaningful code from semantic perspective </li><li>Avoid time consuming problems implicitly</li><li>Reduce repetition of code</li><li>Highly scalable code</li><li>Supports object-oriented approach</li></ul><p>Lets take Javascript and discuss design patterns in javascript to understand it better.</p><p>According to dimensions of code, on which a design pattern impacts, it can be categorized as follows:</p><ol><li> Creational Design Pattern</li><li>Behavioral Design Pattern</li><li>Structural Design Pattern</li></ol><p>Lets take one type of pattern and see how design pattern solves the problem. </p><h3>Creational Design Pattern</h3><p>Creational design pattern basically deals with the way of creating objects in a way suitable to our requirements.</p><p>Different Creational design patterns can be used in different ways of creating objects as per our requirement. The basic ways of creating objects may not be suitable to all situations.</p><p>Lets discuss a good example of creational design pattern called “Singleton Pattern”</p><h3>Singleton Pattern</h3><p>This pattern ensure that, there is not, more than one instance of the class, ever created in the memory.</p><p>Whenever, you have to use same class with some initialization again and again we can make it as a singleton.</p><p>The object of this class should not be having the values being manipulated and changed over the time, because it is going be used several times at different fragment of time, in your code.</p><p>The script below implements Singleton Pattern:</p><pre>var Person = (function(){  // Self calling function  // Private property for holding the only existing instance  var personInstance;  var createPerson = function(){    // Private property initializing default pull capacity.    var canPullWeight = 3;    // Private method for increasing the value of canPullWeight.    var canPull = function( kg ){        canPullWeight = kg;       };    // Private method for passing increased value.     var increaseEnergy = function( newVal ){      canPull( newVal );    };    //  Private method for returning value of return canPullWeight,    //  at any point of time, from the one and only existing instance.    var pullCapacity = function(){      return canPullWeight; };    return {      // returns increaseEnergy method which is a       // closure with access to private properties.      increaseEnergy: increaseEnergy,      getPullCapacity: pullCapacity    };  };  return {    // Method for creating instance of Person.    getInstance: function(){      // Condition checking existence of instance if(!personInstance){          personInstance = createPerson();      }      // If instance already existing returning the same.      return personInstance;    }  };})( );// Creating firstPerson instance.var  firstPerson = Person.getInstance( );// alerts default value 3.alert(firstPerson.getPullCapacity());// Creating secondPerson instance (Same instance is used)var secondPerson = Person.getInstance();// Same output. Alerts default value 3.alert(secondPerson.getPullCapacity());// Calling increaseEnergy Method of firstPerson with newVal as 20.// Note: we are not going to call increaseEnergy method of secondPerson.firstPerson.increaseEnergy( 20 );// alerts new value which is 20.alert(firstPerson.getPullCapacity());// It also alerts new value which is 20, as same instance is usedalert(secondPerson.getPullCapacity());</pre><p>Keep the following in mind when you are reviewing the above code:</p><ul><li>There is one and only one instance existing at any point of time during execution of code.</li><li>firstPerson and secondPerson are using same instance of Person returned.</li><li>Manipulating the value of firstPerson is impacting secondPerson also and vice-versa.</li><li>More than one instance of Person class cannot be created because of condition check.</li></ul><p>Singleton pattern can be used in the following cases:</p><ol><li>To have some properties to be initialized with some default values in the script.</li><li>To have a single instance for a frequently accessed static value through out the script.</li><li>Singleton pattern is also used for NameSpacing in javascript.</li><li>Initializing database connection input parameters.</li><li> Keeping package dependency list statically.</li><li>Having single point of access for a frequently changing value, at any instant of time.</li></ol>				</div>			</div> <!--=========================			END : POST		=============================-->		<!--=========================			START : POST =============================-->		<div class="post-wrapper">		<section aria-selected="true" class="cover"><h1>JavaScript 101</h1><div class="toc well"><ul class="nav nav-list" ><li class="nav-header">Table of contents</li><li><a href="#history">History</a></li><li><a href="#definition-amp-properties">Definition &amp; properties</a></li><li><a href="#usages"> Usages</a></li><li><a href="#basic-syntax">Basic syntax</a></li><li><a href="#variables-amp-types">Variables &amp; Types</a></li><li><a href="#arrays">Arrays</a></li><li><a href= "#operators">Operators</a></li><li><a href="#type-conversions">Type conversions</a></li><li><a href="#statements">Statements</a></li><li><a href="#simple-functions">Simple functions </a></li><li><a href="#variable-scope">Variable scope</a></li><li><a href="#browser-environment">Browser environment</a></li><li><a href="#tools">Tools</a></li><li><a href="#compatibility" >Compatibility</a></li><li><a href="#documentation-amp-links">Documentation &amp; links</a></li></ul></div></section><section class="introduction"><h4>I know JavaScript - Show me!</h4><p class="list incremental">JavaScript is a <strong>real language</strong>. Building a modern dynamic website without knowing it is nonsense. A lot of people working on web applications and web sites learnt the language on the job. Code written is often hard to understand and hard to maintain. It doesn't follow best practices or standard rules which provoke strange behaviours and bugs. Taking time to understand the fundamentals is really important! By doing so you can stop being <strong>a normal human</strong> and become <strong>a true web developer </strong>.</p></section><section class="cover"><h2 id="history">History</h2><p>JavaScript was introduced by Brendan Eich in 1995 for Netscape Communications. It was submitted few months later to Ecma International for consideration as an industry standard. The result standard version is ECMAScript.</p><p>Even if the name comes from a partnership between Netscape and Sun Microsystems (distributor of Java) JavaScript is not a "light" version of Java.</p><ul class="useful-links"><li><a href="http://brendaneich.com/2010/07/a-brief-history-of-javascript/">A Brief History of JavaScript by Brendan Eich (video)</a></li></ul></section><section><h2 id="definition-amp-properties">Definition &amp; properties</h2><p>JavaScript is a scripting language that supports multiple programming styles. It differs from other languages such as C++, Java or PHP with its dynamic behaviour, its first-class functions and its prototype-based inheritance.</p><p>JavaScript lovers consider these features as the force of the language. It's very common for people who try to write JavaScript like they write code in other languages to hate it. Don't make this mistake!</p><ul class="incremental"><li><a href="http://en.wikipedia.org/wiki/Dynamic_language">Dynamic</a></li><li><a href=" http://en.wikipedia.org/wiki/Weak_typing">Weakly typed</a></li><li><a href="http://en.wikipedia.org/wiki/Multi-paradigm#Multi-paradigm_programming_language">Multi-paradigm</a></li><li><a href="http://en.wikipedia.org/wiki/Imperative_programming">Imperative</a></li><li><a href="http://en.wikipedia.org/wiki/Functional_programming">Functional</a></li><li><a href=" http://en.wikipedia.org/wiki/Object-oriented_programming">Object-oriented</a></li><li><a href="http://en.wikipedia.org/wiki/First-class_function">First-class functions</a></li><li><a href= "http://en.wikipedia.org/wiki/Prototype-based_programming">Prototype-based</a></li></ul></section><section><h2 id="usages">Usages</h2><p class="list incremental">Even if it was originally designed to work in a <strong>browser environment</strong>, JavaScript is now used on several <strong>different platforms</strong>. Here are a few examples :</p><ul class="incremental" ><li>Web server</li><li>Browser addons/extensions</li><li>Mobile applications</li><li>Databases consoles</li><li>OpenOffice scripts/macros</li><li>Java applications</li></ul><ul class= "useful-links"><li><a href="http://nodejs.org/">node.js</a></li><li><a href="https://developer.mozilla.org/en/Building_an_Extension">Building and extension for Firefox</a></li><li><a href= "http://code.google.com/chrome/extensions/getstarted.html">Get started with Chrome extension development</a></li><li><a href="http://www.phonegap.com/">PhoneGap</a></li><li><a href=" http://www.mongodb.org/">MongoDB</a></li><li><a href="http://www.mozilla.org/rhino/">Mozilla Rhino</a></li></ul></section><section><h2 id="basic-syntax">Basic syntax</h2><p class="list incremental">JavaScript is <strong>case-sensitive</strong>. <strong>Lines end by semicolon <code>;</code></strong>. <strong>Block are delimited curly brackets by <code>{ }</code></strong> . Comments are between <strong><code>/* */</code> for multiple lines</strong> or after <strong><code>//</code> for one line</strong>.</p></section><section><h2 id="variables-amp-types"> Variables &amp; Types</h2><p class="list incremental">In JavaScript, <strong>Typing is dynamic</strong>. Therefore, there is <strong>NO type declaration</strong> before variable names. Instead we use a <strong>unique keyword : <code>var</code></strong>. Note that a variable <strong>can be declared several times</strong>. If it's non-declared, the variable is <strong> automatically allocated at the first use</strong>.</p></section><section><h3>Number</h3><p>Numbers like in any other languages are really important. Don't forget that a computer is primarly a super calculator. Integers and floats have the same type : <code>Number</code>. Of course, a variable can only be identified as type <code>Number</code> at execution time.. </p><p>If you want to manipulate numbers, the objects <code>Number</code> and <code>Math</code> has lots of useful properties and methods. The other useful way to manipulate them is operators of course. See reference for more details.</p><pre data-language="javascript" class="incremental"><code class="language-javascript"><span class="comment">// Integer</span><span class="keyword">var</span> i;            <span class="comment">// first declaration of i (type is undefined)</span>i = <span class="number">2</span>;            <span class="comment">// i is now a integer (type is number)</span></code></pre><p>In this example we see that floats can have strange behaviour, don't forget the internals of the float storage. It's stored as <a href="http://en.wikipedia.org/wiki/IEEE_floating_point">IEEE 754</a>.</p><pre data-language="javascript" class="incremental"><code class="language-javascript"><span class="comment">// Float</span><span class="keyword">var</span> i = -<span class="number">5.01</span>;    <span class="comment">// second declaration of i as a float (type is number)</span>j = <span class= "number">2</span>;            <span class="comment">// j was not declared, automatic assignement to 2</span>j = i + <span class="number">1.12</span>;     <span class="comment">// j is now a float equal to 3.12 (still number)</span><span class="comment">// Be careful</span><span class="keyword">var</span> k = <span class="number">0.1</span> + <span class="number">0.2</span> <span class="comment">// k =&gt; 0.30000000000000004</span></code></pre><pre data-language="javascript" class="incremental"><code class="language-javascript"><span class="keyword">var </span> l = <span class="keyword">new</span> Number(<span class="number">7</span>);    <span class="comment">// DO NOT USE : type is object and not number</span></code></pre><pre data-language="javascript" class="incremental"><code class="language-javascript"><span class="comment">// Specials</span><span class="keyword">var</span> a = <span class="number">10</span> / <span class="number">0</span>;           <span class="comment">// =&gt; Infinity</span><span class="keyword">var</span> b = -<span class="number">10</span> / <span class="number">0 </span>;          <span class="comment">// =&gt; -Infinity</span><span class="keyword">var</span> c = Math.sqrt(-<span class="number">1</span>);    <span class="comment">// =&gt; NaN : Not a Number</span></code></pre><ul class="useful-links"><li><a href="https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Number">Number reference (MDN)</a></li><li><a href="https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Math">Math reference (MDN)</a></li><li><a href=" http://stackoverflow.com/questions/369220/why-should-you-not-use-number-as-a-constructor">Why should you not use Number as a constructor? (stack overflow)</a></li><li><a href=" http://www.hunlock.com/blogs/The_Complete_JavaScript_Number_Reference#quickIDX8">The_Complete_JavaScript_Number_Reference, usage of new Number(2) (hunlock) </a></li></ul></section><section><h3>String</h3><p>Strings are really simple. Quotes or double quotes, no differences, some text in it and you're done. The most important property of a String when it comes to manipulation is <code>length</code>. It's not the only one, the <code>String</code> object contains a lot of useful properties and methods, see reference for more details.</p><p>The other way a good programer should manipulate string is regular expressions and as expected, JavaScript provides a regex engine and a <code>RegExp</code> object. Regex can be complicated to master, but the game is worth it since it's a multi language concept. See reference for more details.</p><pre data-language="javascript" class="incremental"><code class="language-javascript"><span class="keyword">var</span> a = <span class="string">""</span>; <span class="comment">// The empty string: it has zero characters</span><span class= "keyword">var</span> b = <span class="string">'There is no spoon.'</span>;<span class="keyword">var</span> c = <span class="string">"Only human."</span>;<span class="keyword">var</span> d = <span class="string">'pill="red"'</span>;<span class="keyword">var</span> e = <span class="string">"Free your mind."</span>;<span class="keyword">var</span> f = <span class="string"> "You're empty.\nSo are you."</span>; <span class="comment">// Type of all variables is string</span></code></pre><pre data-language="javascript" class="incremental"><code class= "language-javascript"><span class="keyword">var</span> g = <span class="keyword">new</span> String(<span class="string">"Welcome to the real world."</span>);<span class="comment">// DO NOT USE : type is object and not string</span></code></pre><ul class="useful-links"><li><a href="https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/String">String reference (MDN)</a></li><li><a href="https://developer.mozilla.org/en/JavaScript/Guide/Regular_Expressions">Regex reference (MDN)</a></li><li><a href="http://www.regular-expressions.info/" >regular-expressions.info</a></li><li><a href="http://gskinner.com/RegExr/">Online testing tool (gskinner.com)</a></li></ul></section><section><h3>Boolean</h3><p>Nothing fancy here, <code> true</code> of <code>false</code>. You'll see later that other types of variables (Number, String...) can by evaluated as booleans according to some rules.</p><pre data-language= "javascript" class="incremental"><code class="language-javascript"><span class="keyword">var</span> realWorld = <span class="literal">false</span>;<span class="keyword">var</span> matrix = <span class="literal">true</span>;         <span class="comment">// Type of all variables is boolean</span></code></pre><pre data-language="javascript" class="incremental"><code class= "language-javascript"><span class="keyword">var</span> a = <span class="keyword">new</span> Boolean(<span class="literal">true</span>); <span class="comment">// DO NOT USE : type is object and not boolean</span></code></pre><ul class="useful-links"><li><a href="https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Boolean">Boolean reference (MDN) </a></li></ul></section><section><h3>null and undefined</h3><p class="list incremental">Both <code>null</code> and <code>undefined</code> are used for <strong>absence of a value</strong>. One is used when the variable <strong>has been initialiazed : <code>null</code></strong>. The other one is used when the variable <strong>has not been initialized : <code>undefined </code></strong>. It can be returned by <strong>function that have no <code>return</code> statement</strong>.</p><pre data-language="javascript" class="incremental"><code class= "language-javascript"><span class="keyword">var</span> neo;      <span class="comment">// Type is undefined</span>neo = <span class="literal">null</span>;   <span class="comment">// Type is object</span></code></pre><ul class="useful-links"><li><a href="https://developer.mozilla.org/en/JavaScript/Reference/Operators/Special/typeof">Typeof null is object (MDN) </a></li><li><a href="https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/undefined">undefined reference (MDN)</a></li></ul></section><section class="cover"><h2 id= "arrays">Arrays</h2><p>An array is an ordered colleciton of values. Values can be of different types. Each value is called an element and is positioned in the array with a numeric index starting at zero.</p><p>The <code>Array</code> object has several properties and methods. The most important property is <code>length</code>, it contains the size of the array. See reference for more details.</p><ul class="useful-links"><li><a href="https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Array">Array reference (MDN) </a></li></ul></section><section><h3>Creating</h3><p>The easiest way to create an array is with square brackets and comma separated values in it. Note that you can create an array with 4 undefined elements, length will be 4.</p><pre data-language="javascript"><code class="language-javascript"><span class="keyword">var</span> a = [];                         <span class= "comment">// no elements</span><span class="keyword">var</span> b = <span class="keyword">new</span> Array();                <span class="comment">// equivalent to a</span><span class= "keyword">var</span> c = [,,,,];                     <span class="comment">// 4 elements, all undefined.</span><span class="keyword">var</span> d = <span class="keyword">new</span> Array( <span class="number">4</span>);               <span class="comment">// equivalent to c</span><span class="keyword">var</span> e = [<span class="string">"the"</span>, <span class="number">1 </span>, <span class="literal">true</span>];           <span class="comment">// 3 elements of different types</span><span class="keyword">var</span> f = <span class="keyword">new</span> Array(<span class="string">"the"</span>, <span class="number">1</span>, <span class="literal">true</span>);  <span class="comment">// equivalent to e </span></code></pre></section><section><h3>Reading and writing</h3><p>Reading and writing in arrays is done with brackets and equal assignment operator. Note that reading from and index that haven't been initialized doesn't generate any errors, it returns <code>undefined</code>.</p><p>You can insert values in non consecutive indexes, it create a what's called a "sparse array". The length is updated to maximum index + 1.</p><pre data-language="javascript" class="incremental"><code class="language-javascript"><span class="keyword">var</span> a = [<span class="string">"white"</span>];    <span class="comment">// Start with a one-element array</span></code></pre><pre data-language="javascript" class="incremental"><code class= "language-javascript"><span class="keyword">var</span> b = a[<span class="number">0</span>];         <span class="comment">// b =&gt; "white"</span><span class="keyword">var</span> c = a[ <span class="number">100</span>];       <span class="comment">// c =&gt; undefined (no error)</span></code></pre><pre data-language="javascript" class="incremental"><code class= "language-javascript">a[<span class="number">1</span>] = <span class="number">3.14</span>;          <span class="comment">// a =&gt; ["white", 3.14]</span><span class="keyword">var</span> i = <span class="number">2</span>;a[i] = <span class="number">3</span>;             <span class="comment">// a =&gt; ["white", 3.14, 3]</span>a[i + <span class="number">1</span>] = <span class="string">"rabbit"</span>;  <span class="comment">// a =&gt; ["white", 3.14, 3, "rabbit"]</span>a[a[i]] = a[<span class="number">0</span>];       <span class="comment">// a =&gt; ["white", 3.14, 3, "white"]</span></code></pre><pre data-language="javascript" class="incremental"><code class="language-javascript"><span class="keyword">var</span> d = a.length; <span class="comment">// d =&gt; 4</span></code></pre></section><section><h3>Adding and deleting</h3><p>To add and delete elements from an array, you can use the methods from the <code> Array</code> object. There's a lot of useful ones, from simple <code>pop</code> and <code>push</code> to more complex ones like <code>splice</code>. See reference for more details.</p><pre data-language="javascript" class="incremental"><code class="language-javascript"><span class="keyword">var</span> a = [<span class="string">"follow"</span>, <span class="string">"the" </span>, <span class="string">"white"</span>, <span class="string">"rabbit"</span>];</code></pre><pre data-language="javascript" class="incremental"><code class="language-javascript"><span class="keyword">var</span> b = a.pop();             <span class="comment">// a =&gt; ["follow", "the", "white"]</span>                             <span class="comment">// b =&gt; "rabbit"</span><span class="keyword">var</span> c = a.push(<span class="string">"RABBIT"</span>);    <span class="comment">// a =&gt; ["follow", "the", "white", "RABBIT"]</span> <span class="comment">// c =&gt; 4 (new length)</span></code></pre><pre data-language="javascript" class="incremental"><code class="language-javascript"><span class="keyword">var</span> d = a.shift();           <span class="comment">// a =&gt; ["the", "white", "RABBIT"]</span>                             <span class="comment">// d =&gt; "follow" </span><span class="keyword">var</span> e = a.unshift(<span class="string">"FOLLOW"</span>); <span class="comment">// a =&gt; ["FOLLOW", "the", "white", "RABBIT"]</span> <span class="comment">// e =&gt; 4 (new length)</span></code></pre><pre data-language="javascript" class="incremental"><code class="language-javascript"><span class="keyword">var</span> f = a.splice(<span class="number">2</span>, <span class="number">1</span>);       <span class="comment">// a =&gt; ["FOLLOW", "the", "RABBIT"]</span> <span class="comment">// f =&gt; "white"</span><span class="keyword">var</span> g = a.splice(<span class="number">1</span>, <span class="number">2</span>, <span class="string">"ME"</span>); <span class="comment">// a =&gt; ["FOLLOW", "ME"]</span>                              <span class="comment">// g =&gt; ["the", "RABBIT"] </span></code></pre></section><section class="cover"><h2 id="operators">Operators</h2><p>Operators are really powerful in JavaScript. Unlike in some other languages like C, operators are not only used to do maths, they are also very useful with strings.</p><ul class="useful-links"><li><a href=" https://developer.mozilla.org/en/JavaScript/Reference/operators/operator_precedence">Operator Precedence reference (MDN)</a></li></ul></section><section><h3>Arithmetics</h3><p>Arithmetics operators work the same way as a lot of other programming languages. Note that <code>+</code> is used to concatenate strings.</p><pre data-language="javascript" class="incremental"><code class="language-javascript"><span class="keyword">var</span> a = <span class="number">6</span> + <span class="number">4</span>;                    <span class="comment">// a =&gt; 10 </span><span class="keyword">var</span> b = -a;                       <span class="comment">// b =&gt; -10</span><span class="keyword">var</span> c = <span class="number">6</span> - <span class="number">4</span>;                    <span class="comment">// c =&gt; 2</span></code></pre><pre data-language="javascript" class="incremental"><code class="language-javascript" ><span class="keyword">var</span> d = <span class="number">1</span>, e = ++d;               <span class="comment">// d and e are both 2</span><span class="keyword">var</span> f = <span class="number">1</span>, g = f++;               <span class="comment">// f is 2, g is 1</span><span class="keyword">var</span> h = <span class="number">7</span>, i = --h; <span class="comment">// h and i are both 6</span><span class="keyword">var</span> j = <span class="number">7</span>, k = j--;               <span class="comment">// j is 6, k is 7 </span></code></pre><pre data-language="javascript" class="incremental"><code class="language-javascript"><span class="keyword">var</span> l = <span class="number">3</span> * <span class= "number">3</span>                     <span class="comment">// l =&gt; 9</span><span class="keyword">var</span> m = <span class="number">10</span> / <span class="number">3</span> <span class="comment">// m =&gt; 3.3333333333333335</span><span class="keyword">var</span> n = <span class="number">10</span> % <span class="number">3</span> <span class="comment">// n =&gt; 1</span></code></pre><pre data-language="javascript" class="incremental"><code class="language-javascript"><span class="keyword">var </span> o = <span class="string">"Dodge"</span> + <span class="string">" "</span> + <span class="string">"this."</span>   <span class="comment">// o =&gt; "Dodge this."; </span></code></pre><ul class="useful-links"><li><a href="https://developer.mozilla.org/en/JavaScript/Reference/Operators/Arithmetic_Operators">Arithmetics operators reference (MDN) </a></li></ul></section><section><h3>Equality</h3><p>A particularity of JavaScript is the two kinds of equality comparison : strict and type-converting. Just remember that strict equal <code>===</code> compares both types and values and type-converting equal <code>==</code> converts one type to the other and just compares values.</p><p>Best practice is to always use the strict equality. It prevents a lot of mistakes.</p><pre data-language="javascript" class="incremental"><code class="language-javascript"><span class="comment">// Equality</span><span class ="keyword">var</span> a = <span class="string">"2"</span> == <span class="number">2</span>;    <span class="comment">// a =&gt; true</span><span class="keyword">var</span> b = <span class= "string">"2"</span> != <span class="number">2</span>;    <span class="comment">// b =&gt; false</span></code></pre><pre data-language="javascript" class="incremental"><code class= "language-javascript"><span class="comment">// Strict equality</span><span class="keyword">var</span> c = <span class="string">"2"</span> === <span class="number">2</span>;   <span class= "comment">// c =&gt; false</span><span class="keyword">var</span> d = <span class="string">"2"</span> !== <span class="number">2</span>;   <span class="comment">// d =&gt; true </span></code></pre><ul class="useful-links"><li><a href="https://developer.mozilla.org/en/JavaScript/Reference/Operators/Comparison_Operators">Comparison operators reference (MDN) </a></li></ul></section><section><h3>Comparison</h3><p>Like arithmetics, comparison operators work the same way as a lot of other programming languages. Note that these operators can be used to compare string.</p><pre data-language="javascript" class="incremental"><code class="language-javascript"><span class="keyword">var</span> a = <span class="number">2</span> &gt; <span class="number">2</span>;          <span class="comment">// a =&gt; false</span><span class="keyword">var</span> b = <span class="number">2</span> &lt;= <span class="number">2</span> ;         <span class="comment">// b =&gt; true</span><span class="keyword">var</span> c = <span class="string">"2"</span> &gt;= <span class="number">2</span>;       <span class="comment"> // c =&gt; true</span><span class="keyword">var</span> d = <span class="number">2</span> &lt; <span class="number">2</span>;          <span class="comment">// d =&gt; false</span><span class="keyword">var</span> e = <span class="number">2</span> &lt;= <span class="number">2</span>;         <span class="comment">// e =&gt; true</span></code></pre><pre data-language= "javascript" class="incremental"><code class="language-javascript"><span class="keyword">var</span> f = <span class="string">'abc'</span> &lt; <span class="string">'def'</span>   <span class="comment">// f =&gt; true</span></code></pre><ul class="useful-links"><li><a href="https://developer.mozilla.org/en/JavaScript/Reference/Operators/Comparison_Operators">Comparison operators reference (MDN)</a></li></ul></section><section><h3>Logical</h3><pre data-language="javascript"><code class="language-javascript"><span class="keyword">var</span> a = <span class ="literal">true</span> &amp;&amp; <span class="literal">false</span>;  <span class="comment">// a =&gt; false</span><span class="keyword">var</span> b = <span class="literal">true</span> || <span class="literal">false</span>;  <span class="comment">// b =&gt; true</span><span class="keyword">var</span> c = !<span class="literal">true</span>;          <span class="comment"> // c =&gt; false</span></code></pre><ul class="useful-links"><li><a href="https://developer.mozilla.org/en/JavaScript/Reference/Operators/Logical_Operators">Logical operators reference (MDN)</a></li></ul></section><section><h3>Bitwise</h3><p>Bitwise operators help programmers to use numbers like sequences of 32 bits (zeros and ones). It's not always easy to understand what's going on but it's very useful, for example if you're implementing bitmasks.</p><pre data-language="javascript"><code class="language-javascript"><span class="keyword">var</span> a = <span class="number">42</span> &amp; <span class="number">2</span>   <span class="comment">// a =&gt;          2  (AND)</span><span class="keyword">var</span> b =  <span class="number">7 </span> | <span class="number">2</span>   <span class="comment">// b =&gt;          2  (OR)</span><span class="keyword">var</span> c =  <span class="number">7</span> ^ <span class="number" >2</span>   <span class="comment">// c =&gt;          7  (XOR)</span><span class="keyword">var</span> d = ~<span class="number">8</span>       <span class="comment">// d =&gt;         -7 (NOT)</span><span class="keyword">var</span> e =  <span class="number">1</span> &lt;&lt; <span class="number">3</span>  <span class="comment">// e =&gt;          8  (Shift left) </span><span class="keyword">var</span> f =  <span class="number">8</span> &gt;&gt; <span class="number">2</span>  <span class="comment">// f =&gt;          2  (Shift right)</span><span class="keyword">var</span> g = -<span class="number">1</span> &gt;&gt;  <span class="number">2</span> <span class="comment">// g =&gt;         -1</span><span class="keyword">var</span> h = -<span class="number">1</span> &gt;&gt;&gt; <span class="number">2</span> <span class="comment">// h =&gt; 1073741823  (Shift right with zero fill)</span></code></pre><ul class= "useful-links"><li><a href="https://developer.mozilla.org/en/JavaScript/Reference/Operators/Bitwise_Operators">Bitwise operators reference (MDN)</a></li></ul></section><section><h3> Assignement</h3><p>Assignement operators saves you some place and can improve code readability. Use them carefuly!</p><pre data-language="javascript"><code class="language-javascript" ><span class="keyword">var</span> a = <span class="number">1</span>, b = <span class="number">0</span>;a += b    <span class="comment">// a = a + b</span>a -= b    <span class="comment"> // a = a - b</span>a *= b    <span class="comment">// a = a * b</span>a /= b    <span class="comment">// a = a / b</span>a %= b    <span class="comment">// a = a % b</span>a &lt;&lt;= b <span class="comment">// a = a &lt;&lt; b</span>a &gt;&gt;= b   <span class="comment">// a = a &gt;&gt; b</span>a &gt;&gt;&gt;= b  <span class="comment">// a = a &gt;&gt;&gt; b</span>a &amp;= b    <span class="comment">// a = a &amp; b</span>a |= b    <span class="comment">// a = a | b</span>a ^= b    <span class="comment">// a = a ^ b</span></code></pre><ul class= "useful-links"><li><a href="https://developer.mozilla.org/en/JavaScript/Reference/Operators/Assignment_Operators">Assignment operators reference (MDN) </a></li></ul></section><section><h3><code>in</code></h3><p>The <code>in</code> operator is used to verify if a property is specified on an object. Be careful when you use it.</p><pre data-language="javascript"><code class="language-javascript"><span class="keyword">var</span> a = [<span class="number">1</span>,<span class="number">9</span>,<span class="number">4</span> ];<span class="keyword">var</span> b = (<span class="number">2</span> <span class="keyword">in</span> a);          <span class="comment">// b =&gt; true</span><span class="keyword">var </span> c = (<span class="number">9</span> <span class="keyword">in</span> a);          <span class="comment">// c =&gt; false</span><span class="keyword">var</span> d = (length <span class="keyword">in</span> a);     <span class="comment">// d =&gt; true</span></code></pre><ul class="useful-links"><li><a href=" https://developer.mozilla.org/en/JavaScript/Reference/Operators/Special/in">in operator reference (MDN)</a></li></ul></section><section><h3><code>typeof</code></h3><p><code>typeof</code> is used at compilation time to verify the type of a variable.</p><pre data-language="javascript"><code class="language-javascript"><span class="keyword">var</span> a = <span class="number" >3</span>;<span class="keyword">var</span> b = <span class="keyword">typeof</span> a;   <span class="comment">// b =&gt; "number"</span><span class="keyword">var</span> c = <span class= "string">""</span>;<span class="keyword">var</span> d = <span class="keyword">typeof</span> c;   <span class="comment">// d =&gt; "string"</span><span class="keyword">var</span> e = <span class="literal">true</span>;<span class="keyword">var</span> f = <span class="keyword">typeof</span> e;   <span class="comment">// f =&gt; "boolean"</span></code></pre><ul class= "useful-links"><li><a href="https://developer.mozilla.org/en/JavaScript/Reference/Operators/Special/in">in operator reference (MDN)</a></li></ul></section><section class="cover"><h2 id= "type-conversions">Type conversions</h2><p>JavaScript is not statically typed but you can determine the type of a variable at execution time. Conversion from one type to another can be done explicitly or implicitly. It's really important to understand implicit ones, they can help you to avoid strange behaviours and bugs.</p></section><section><h3>Explicit</h3><p> Explicit conversions can for example help you to convert a string to a number. Note that even if integers and floats are both number, using <code>parseInt</code> on a float removes the decimals and makes it by definition an integer.</p><pre data-language="javascript" class="incremental"><code class="language-javascript"><span class="comment">// to Number</span><span class="keyword">var</span> a = Number(<span class="string">"10"</span>);         <span class="comment">// a =&gt; 10</span><span class="keyword">var</span> b = Number(<span class="literal" >false</span>);        <span class="comment">// b =&gt;  0</span><span class="keyword">var</span> c = parseInt(<span class="string">"10"</span>, <span class="number">10</span>);   <span class="comment">// c =&gt; 10</span><span class="keyword">var</span> d = parseInt(<span class="number">10.2</span>);       <span class="comment">// d =&gt; 10</span><span class="keyword"> var</span> e = parseFloat(<span class="string">"10.2"</span>);   <span class="comment">// e =&gt; 10.2</span></code></pre><pre data-language="javascript" class="incremental"><code class= "language-javascript"><span class="comment">// to String</span><span class="keyword">var</span> a = String(<span class="literal">false</span>);        <span class="comment">// a =&gt; "false"</span><span class="keyword">var</span> b = String(<span class="number">10</span>);           <span class="comment">// b =&gt; "10"</span><span class="keyword">var</span> c = String(<span class="number">10.2</span>);         <span class="comment">// c =&gt; "10.2"</span><span class="keyword">var</span> d = (<span class="number">10</span>).toString();      <span class="comment">// d =&gt; "10"</span></code></pre><pre data-language="javascript" class="incremental"><code class="language-javascript"><span class="comment">// to Boolean</span><span class="keyword">var</span> a = Boolean(<span class="number">10</span>);          <span class="comment">// a =&gt; true</span><span class="keyword">var</span> b = Boolean(<span class= "number">0</span>);           <span class="comment">// b =&gt; false</span><span class="keyword">var</span> c = Boolean(<span class="number">0.3</span>);         <span class="comment">// c =&gt; true</span><span class="keyword">var</span> d = Boolean(<span class="string">"true"</span>);      <span class="comment">// d =&gt; true</span></code></pre></section><section><h3> Implicit</h3><p>There's a lot of ways to convert a string to a number. Performances can differ a lot depending on the technique used and the plateform. A shorter syntax is often prefered for bandwith uses.</p><p>Look carefully how the <code>+</code> operator behaves with strings and numbers.</p><pre data-language="javascript" class="incremental"><code class= "language-javascript"><span class="comment">// to Number</span><span class="keyword">var</span> a = +<span class="string">"10"</span>;            <span class="comment">// a =&gt; 10 </span><span class="keyword">var</span> b = <span class="string">"10"</span> &gt;&gt; <span class="number">0</span>;        <span class="comment">// b =&gt; 10</span><span class="keyword"> var</span> c = <span class="string">"10"</span> * <span class="number">1</span>;         <span class="comment">// c =&gt; 10</span><span class="keyword">var</span> d = ~~<span class= "string">"10"</span>;           <span class="comment">// d =&gt; 10</span><span class="keyword">var</span> e = <span class="string">"2"</span> * <span class="string">"5"</span>; <span class="comment">// e =&gt; 10 (both strings converts to number)</span></code></pre><pre data-language="javascript" class="incremental"><code class="language-javascript"><span class= "comment">// to String</span><span class="keyword">var</span> a = <span class="number">10</span> + <span class="string">"10"</span>;             <span class="comment">// a =&gt; "1010" </span><span class="keyword">var</span> b = <span class="string">"10"</span> + <span class="string">"10"</span>;           <span class="comment">// b =&gt; "1010"</span><span class= "keyword">var</span> c = <span class="number">10</span> + <span class="string">" agents"</span>;        <span class="comment">// c =&gt; "10 agents"</span><span class="keyword">var</span> d = <span class="number">10</span> + <span class="number">10</span> + <span class="string">" agents"</span>;   <span class="comment">// d =&gt; "20 agents"</span></code></pre><pre data-language="javascript" class="incremental"><code class="language-javascript"><span class="comment">// to Boolean</span><span class="keyword">var</span> a = !!<span class="string"> 'morpheus'</span>;     <span class="comment">// a =&gt; true</span><span class="keyword">var</span> b = !!<span class="string">''</span>;             <span class="comment">// b =&gt; false </span><span class="keyword">var</span> c = !!<span class="string">'0'</span>;            <span class="comment">// c =&gt; true</span><span class="keyword">var</span> d = !!<span class= "string">'1'</span>;            <span class="comment">// d =&gt; true</span></code></pre><ul class="useful-links"><li><a href="http://jsperf.com/number-vs-parseint-vs-plus/3">String to number comparison (jsperf.com)</a></li></ul></section><section><h3>Summary</h3><p>Here's a little summary of conversions results. Pay attention especially to "anything to boolean" conversions, it can save you some time when used in <code>if</code> conditions.</p><table class="incremental table table-bordered table-striped">  <thead>    <tr><th> Value                            </th><th>String             </th><th>Number  </th><th>Boolean  </th></tr></thead>  <tbody>      <tr><td>undefined                      </td><td> "undefined"        </td><td>NaN     </td><td>false      </td></tr><tr><td>null                           </td><td>"null"             </td><td>0       </td><td>false  </td></tr></tbody> <tbody>      <tr><td>true                           </td><td>"true"             </td><td>1       </td><td>      </td></tr><tr><td>false                          </td><td> "false"            </td><td>0       </td><td>  </td></tr></tbody>  <tbody>      <tr><td>"" (empty string)              </td><td>                   </td><td>0       </td><td>false </td></tr><tr><td>"1.2" (nonempty, numeric)      </td><td>                   </td><td>1.2     </td><td>true      </td></tr><tr><td>"one" (nonempty, non-numeric)  </td><td> </td><td>NaN     </td><td>true  </td></tr></tbody>  <tbody>      <tr><td>0                              </td><td>"0"                </td><td>        </td><td>false </td></tr><tr><td>-0                             </td><td>"0"                </td><td>        </td><td>false      </td></tr><tr><td>NaN                            </td><td> "NaN"              </td><td>        </td><td>false      </td></tr><tr><td>Infinity                       </td><td>"Infinity"         </td><td>        </td><td>true      </td></tr><tr><td> -Infinity                      </td><td>"-Infinity"        </td><td>        </td><td>true      </td></tr><tr><td>1 (finite, non-zero)           </td><td>"1"                </td><td> </td><td>true  </td></tr></tbody>  <tbody>      <tr><td>[] (empty array)               </td><td>""                 </td><td>0       </td><td>true      </td></tr><tr><td>[9] (1 numeric elt)            </td><td>"9"                </td><td>9       </td><td>true      </td></tr><tr><td>['a'] (any other array)        </td><td>use join() method  </td><td>NaN </td><td>true  </td></tr></tbody></table></section><section class="cover"><h2 id="statements">Statements</h2></section><section><h3>Conditionnal</h3><p>In JavaScript, conditionnal statements behaves pretty much like in other common languages.</p><p>Note that the conditional ternary operator should only be used in simple cases. It is often use for variable assignment and its usage is synonym of shorter syntax and readability. If you think it doesn't make your code better, use a classic <code>if</code>.</p><h4>if/else</h4><p>In this case, normal equality is handy, used with <code>null</code>, it can test null || <code>undefined</code>.</p><pre data-language="javascript" class="incremental"><code class="language-javascript" ><span class="keyword">if</span> (username == <span class="literal">null</span>) {  <span class="comment">// if username is null or undefined,</span>  username = <span class="string"> "Trinity"</span>;  <span class="comment">// define it</span>}</code></pre><pre data-language="javascript" class="incremental"><code class="language-javascript"><span class="keyword">if </span> (bulletCount === <span class="number">1</span>) {  bulletCount += <span class="string">' bullet'</span>;} <span class="keyword">else</span> {  bulletCount += <span class="string"> ' bullets'</span>;}</code></pre><pre data-language="javascript" class="incremental"><code class="language-javascript"><span class="keyword">var</span> user = (name == <span class="literal" >null</span>) ? <span class="string">'default user'</span> : name;</code></pre><ul class="useful-links"><li><a href=" https://developer.mozilla.org/en/JavaScript/Reference/Statements/if...else">If...else reference (MDN)</a></li></ul></section><section><h4>switch</h4><p>Switch usage is often advised when you have too much if statements. Don't forget the <code>break</code> keyword. Note that you can use string unlike some other languages.</p><pre data-language="javascript"><code class= "language-javascript"><span class="keyword">var</span> quote;<span class="keyword">switch</span> (characterName) {  <span class="keyword">case</span> <span class="string">'Smith'</span> :    quote = <span class="string">'Goodbye, Mr. Anderson...'</span>;    <span class="keyword">break</span>;  <span class="keyword">case</span> <span class="string">'Neo'</span>:    quote = <span class="string">'I know kung fu.'</span>;    <span class="keyword">break</span>;  <span class="keyword">default</span>:    quote = <span class="string">'What is the Matrix?'</span> ;    <span class="keyword">break</span>;}</code></pre><ul class="useful-links"><li><a href="https://developer.mozilla.org/en/JavaScript/Reference/Statements/switch">Switch reference (MDN) </a></li></ul></section><section><h3>loops</h3><pre data-language="javascript" class="incremental"><code class="language-javascript"><span class="keyword">for</span> (<span class="keyword" >var</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++) {  doSomething();}</code></pre><pre data-language="javascript" class="incremental"><code class= "language-javascript"><span class="keyword">var</span> count = <span class="number">0</span>;<span class="keyword">while</span> (count &lt; <span class="number">10</span>) { doSomething();  count++;}</code></pre><pre data-language="javascript" class="incremental"><code class="language-javascript"><span class="keyword">var</span> count = <span class="number"> 100</span>;<span class="keyword">do</span> {  doSomething();} <span class="keyword">while</span> (--count &gt; <span class="number">0</span>);</code></pre><ul class="useful-links"><li><a href="https://developer.mozilla.org/en/JavaScript/Guide/Statements#Loop_Statements">Loops reference (MDN)</a></li></ul></section><section><h4>for...in loops</h4><p>for..in loops are used to iterate over properties of an object.</p><p>Array indexes are just enumerable properties with integer names. Therefore, for...in loops could be used to enumerate elements of an array. </p><p>Because of performance issues and in order to avoid bugs, use classic for loops instead of for..in with arrays.</p><pre data-language="javascript"><code class="language-javascript" ><span class="keyword">var</span> a = [<span class="number">123</span>, <span class="number">456</span>, <span class="number">789</span>];<span class="keyword">for</span> (<span class= "keyword">var</span> i <span class="keyword">in</span> a) {      <span class="comment">// DO NOT use with arrays</span>  doSomething(a[i]);}</code></pre><p class="list incremental warning" >Because of <strong>performance issues</strong> and in order to avoid <strong>"bugs" and "strange behaviours"</strong>, <strong>use classic for loops instead</strong> of for..in with arrays.</p><ul class="useful-links"><li><a href="https://developer.mozilla.org/en/JavaScript/Reference/Statements/for...in">for...in loops reference (MDN)</a></li><li><a href=" http://jsperf.com/for-vs-for-in">for vs. for..in (JSperf.com)</a></li></ul></section><section><h2 id="simple-functions">Simple functions</h2><p>Functions are declared with the <code> function</code> keyword. There's no return type and no variable type for the arguments.</p><pre data-language="javascript" class="incremental"><code class="language-javascript"><span class ="function"><span class="keyword">function</span> <span class="title">functionName</span><span class="params">(var1, var2, var3)</span> {</span> <span class="comment">// no variable types </span>  <span class="comment">/*    Some code here  */</span>  <span class="keyword">return</span> returnVal;                       <span class="comment">// optional</span>} </code></pre><pre data-language="javascript" class="incremental"><code class="language-javascript"><span class="function"><span class="keyword">function</span> <span class="title">useArgs </span><span class="params">(var1, var2, var3)</span> {</span>  <span class="keyword">var</span> a = arguments.length;       <span class="comment">// array containing all the arguments </span>  <span class="keyword">var</span> result = <span class="string">""</span>;  <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; a; i++) {    result += <span class="string">" "</span> + arguments[i];  }  <span class="keyword">return</span> result;}<span class="keyword">var</span> b = useArgs(<span class= "string">"Déjà"</span>, <span class="string">"vu"</span>);    <span class="comment">// b =&gt; " Déjà vu", var3 = undefined</span></code></pre><ul class="useful-links"><li><a href=" https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Function">Function reference (MDN)</a></li></ul></section><section class="cover"><h2 id="variable-scope">Variable scope </h2><p>The scope of a variable is the region of your code in which it is defined. JavaScript has a very specific way of handling scope. Scope can be altered by <code>function</code>s and the <code>var</code> keyword.</p><p>Note that statements like <code>if</code>, <code>for</code>... doesn't change scope of variables. See reference for more details.</p><ul class= "useful-links"><li><a href="https://developer.mozilla.org/en/JavaScript/Guide/Values,_Variables,_and_Literals#Variable_Scope">Variable scope (MDN)</a></li></ul></section><section><h3> Global  vs. local</h3><p>Variables declared outside of any function are defined everywhere in your code. They are considered global.</p><p>Variables declared inside a function are defined only within the function body. They are considered local to the function.</p><pre data-language="javascript"><code class="language-javascript"><span class="keyword">var</span> name = <span class="string">"Andy"</span>;             <span class="comment">// not in a function =&gt; variable is global</span><span class="function"><span class="keyword">function</span> <span class="title">foo</span><span class="params">()</span> {</span>  <span class="keyword">var</span> lastName = <span class="string">"WACHOWSKI"</span>;   <span class="comment">// inside a function =&gt; variable is local</span>  <span class="keyword">return</span> name + <span class="string">' '</span> + lastname; <span class="comment">// can access global variable "name" </span>}foo();<span class="keyword">var</span> a = lastName;           <span class="comment">// ReferenceError lastName is not defined</span>                            <span class= "comment">// can not access local variable "lastName"</span></code></pre></section><section><h3>Don't forget <code>var</code></h3><p>If you ommit the <code>var</code> keyword inside a function, the variable is automatically considered global. It can have serious side effects. It's considered bad practice, you shouldn't use this.</p><pre data-language="javascript" class= "incremental"><code class="language-javascript"><span class="keyword">var</span> i = <span class="number">1</span>;<span class="function"><span class="keyword">function</span> <span class= "title">foo</span><span class="params">()</span> {</span>  <span class="keyword">var</span> i = <span class="number">3</span>;}foo();<span class="keyword">var</span> a = i;        <span class="comment">// a =&gt; 1</span></code></pre><pre data-language="javascript" class="incremental"><code class="language-javascript"><span class="keyword">var</span> i = <span class= "number">1</span>;<span class="function"><span class="keyword">function</span> <span class="title">foo</span><span class="params">()</span> {</span>  i = <span class="number">3</span> ;          <span class="comment">// no var keyword !!! :-(</span>  j = <span class="number">4</span>;          <span class="comment">// no var keyword !!! :-(</span>}foo();<span class= "keyword">var</span> a = i;        <span class="comment">// a =&gt; 3</span><span class="keyword">var</span> b = j;        <span class="comment">// b =&gt; 4 </span></code></pre></section><section class="cover"><h2 id="browser-environment">Browser environment</h2></section><section><h3>Integration</h3><p>The best way to integrate JavaScript in a web page is through a JavaScript file and a link to it in your HTML page. The link can be placed in <code>head</code> or <code>body</code> it really depends on the situation.</p><pre data-language="html5"><code class="language-html5"><span class="doctype">&lt;!DOCTYPE html&gt;</span><span class="tag">&lt;<span class="title">html</span>&gt;</span>  <span class="tag"> &lt;<span class="title">head</span>&gt;</span>    <span class="tag">&lt;<span class="title">script</span> <span class="attribute">src</span>=<span class="value">"myscript1.js"</span>&gt; </span><span class="javascript"></span><span class="tag">&lt;/<span class="title">script</span>&gt;</span>   <span class="comment">&lt;!-- unobstrusive JS --&gt;</span>    <span class= "tag">&lt;<span class="title">script</span>&gt;</span><span class="javascript"> <span class="comment">// some code </span></span><span class="tag">&lt;/<span class="title">script</span> &gt;</span>        <span class="comment">&lt;!-- REALLY BAD PRACTICE --&gt;</span>  <span class="tag">&lt;/<span class="title">head</span>&gt;</span>  <span class="tag">&lt;<span class= "title">body</span>&gt;</span>    <span class="tag">&lt;<span class="title">script</span> <span class="attribute">src</span>=<span class="value">"myscript2.js"</span>&gt;</span><span class ="javascript"></span><span class="tag">&lt;/<span class="title">script</span>&gt;</span>   <span class="comment">&lt;!-- better unobstrusive JS --&gt;</span>  <span class="tag">&lt;/<span class="title">body</span>&gt;</span><span class="tag">&lt;/<span class="title">html</span>&gt;</span></code></pre><p class="list incremental warning"><strong>Avoid direct JavaScript in HTML documents</strong>, it's a bad practice. It <strong>breaks the structure/behaviour separation</strong>. <strong>Code can't be reused on other pages</strong>. It also prevents you from having a changeable and maintenable code.</p><p>Putting your scripts at the just before the <code>&lt;/body&gt;</code> is a good practice. We'll see that in details in performances lesson.</p><ul class="useful-links"><li><a href="http://labs.adobe.com/technologies/spry/articles/best_practices/separating_behavior.html">Unobstrusive JavaScript (labs.adobe.com) </a></li><li><a href="http://robertnyman.com/2008/11/20/why-inline-css-and-javascript-code-is-such-a-bad-thing/">Why Inline CSS And JavaScript Code Is Such A Bad Thing (</a><a href=" http://robertnyman.com/">http://robertnyman.com/</a>)</li><li><a href="http://robertnyman.com/2008/04/23/where-to-include-javascript-files-in-a-document/">Where To Include JavaScript Files In A Document</a></li></ul></section><section><h3>Browser objects</h3><p>Every JavaScript plateform/environment adds objects with global scope. They're meant to provide helpful features to developers. In web browsers the most important ones are : <code>document</code> and <code>window</code>.</p><p>Another object is present but only in modern browsers : <code> console</code>. Since it's not standard, implementations may differ, see references for more details. Remember that older browsers don't support it, so don't let <code>console.log('foo') </code> etc... in production code.</p><pre data-language="javascript" class="incremental"><code class="language-javascript"><span class="keyword">var</span> title = document.title;<span class="keyword">var</span> href = window.location.href;<span class="keyword">var</span> userAgent = window.navigator.userAgent;</code></pre><pre data-language="javascript" class= "incremental"><code class="language-javascript">window.alert(<span class="string">'Never send a human to do a machine\'s job.'</span>);<span class="keyword">var</span> bluePill = confirm( <span class="string">'Take the blue pill?'</span>);<span class="keyword">var</span> name = prompt(<span class="string">'What is your name?'</span>);</code></pre><pre data-language= "javascript" class="incremental"><code class="language-javascript">console.log(<span class="string">'Perhaps we are asking the wrong questions.'</span>);console.error(<span class="string"> 'Nothing. Just had a little déjà vu.'</span>);console.info(<span class="string">'A déjà vu is usually a glitch in the Matrix.'</span>);console.warn(<span class="string">'The Matrix is a system, Neo. That system is our enemy.'</span>);</code></pre><ul class="useful-links"><li><a href="https://developer.mozilla.org/en/DOM/document">document reference (MDN)</a></li><li><a href="https://developer.mozilla.org/en/DOM/window">window reference (MDN)</a></li><li><a href="https://developer.mozilla.org/en/Using_the_Web_Console">Firefox web console (MDN) </a></li><li><a href="http://code.google.com/chrome/devtools/docs/console.html">Chrome web console</a></li><li><a href="http://msdn.microsoft.com/en-us/library/ie/gg589507.aspx">IE web console</a></li><li><a href="http://www.opera.com/dragonfly/documentation/console/">Opera web console</a></li><li><a href=" http://developer.apple.com/library/safari/%23documentation/AppleApplications/Conceptual/Safari%20Developer%20Guide/DebuggingYourWebsite/DebuggingYourWebsite.html#/apple_ref/doc/uid/TP400078 74-CH8-SW17">Safari web console</a></li></ul></section><section><h2 id="tools">Tools</h2><p>Your browser should have two very useful tools to work with JavaScript :</p><ul><li>JavaScript Debugger</li><li>JavaScript Console</li></ul><p>There's also great tools on the web :</p><ul><li><a href="http://jsfiddle.net/">JSfiddle (online playground)</a></li><li><a href=" http://jsbin.com/">JS Bin (online playground)</a></li><li><a href="http://codepen.io/">Codepen (online playground)</a></li><li><a href="http://tinkerbin.com/">tinkerbin (online playground) </a></li><li><a href="http://jsperf.com/">JSperf (online benchmarking tool)</a></li></ul></section><section><h2 id="compatibility">Compatibility</h2><p class="list incremental">Even if JavaScript has been standardized to ECMAScript, each platform doesn't always support all the latest features. You should <strong>always read documentation</strong> and <strong>look up if it's supported</strong>. You should also <strong>test your code over the different browsers</strong> of your audience.</p><p>There's often two (or more) ways to do the same thing in JavaScript. It's not because two browsers have feature X and Y that they implemented it the same way. Performances can be very different. As always : read documentation and test... </p></section>			</div>		<!--=========================			END : POST		=============================-->		<!--=========================			START : POST		=============================-->		<div class="post-wrapper"><h1>JS101: Primitive Values and Objects</h1><section class="postbody">      <h3 id="backtobasics">Back to Basics</h3><p>When people talk to me about DailyJS they often ask for more beginner's articles.  Therefore, we're starting the <strong>JS101</strong> series on DailyJS.  These are intended to be short guides on fundamental topics that shouldn't take more than about 10 minutes to read.</p><p>I really believe learning JavaScript comes down to understanding <code> Object</code>, so what better place to start?</p><h3 id="typesofvalues">Types of Values</h3><p>In JavaScript, the humble <code>Object</code> underlies many of the language's strengths. To understand JavaScript objects, let's consider what types of values we have at our disposal.  Take a look at the following example:</p><pre class="prettyprint prettyprinted" style="" ><code class="language-javascript"><span class="kwd">var</span><span class="pln"> one </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pln" >    </span><span class="pun">,</span><span class="pln"> oneObject </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">Number</span><span class="pun">(</span><span class="lit">1</span><span class="pun">);</span><span class="pln">log</span><span class="pun">(</span><span class="pln">one </span><span class="pun">===</span><span class="pln"> oneObject</span><span class="pun">);</span><span class="pln">  log</span><span class="pun">(</span><span class="kwd">typeof </span><span class="pun">(</span><span class="pln">one</span><span class="pun">),</span><span class="pln"> </span><span class="kwd">typeof</span><span class="pun">(</span><span class="pln" >oneObject</span><span class="pun">));</span><span class="pln">  </span></code></pre><p>I've made an interactive version of this example that you can experiment with here: <a href=" http://jsfiddle.net/uWup3/">http://jsfiddle.net/uWup3/</a>.</p><p>This uses the <em>strict equals operator</em> to compare the value <code>1</code> with the object <code>new Number(1) </code>, and <code>false</code> is returned.  The reason for this is <code>1</code> is a <a href="http://es5.github.com/#x4.3.2">primitive value</a>, and is not an object.  The number created with <code>new Number</code> is an object, as shown by the value returned by <code>typeof</code>.</p><p>There are other primitive values: Undefined, Null, Boolean, Number, and String.  Another interesting point relates to <code>Undefined</code> and how it's a type whose sole value is <code>undefined</code>.</p><h3 id="creatingobjects">Creating Objects</h3><p> When working in JavaScript, we mostly concern ourselves with objects.  There's a reason why JSON is so popular and powerful, and it comes down to the flexibility of objects.  The main difference between objects and primitive values is objects are clearly comprised of multiple items:</p><pre class="prettyprint prettyprinted" style=""><code class="language-javascript" ><span class="kwd">var</span><span class="pln"> javascript </span><span class="pun">=</span><span class="pln"> </span><span class="pun">{</span><span class="pln">    influences</span><span class="pun">:</span><span class="pln"> </span><span class="pun">[</span><span class="str">'C'</span><span class="pun">,</span><span class="pln"> </span><span class="str">'Java' </span><span class="pun">,</span><span class="pln"> </span><span class="str">'Scheme'</span><span class="pun">]</span><span class="pln"></span><span class="pun">,</span><span class="pln"> designer</span><span class="pun">:</span><span class="pln"> </span><span class="str">'Brendan Eich'</span><span class="pln"></span><span class="pun">,</span><span class="pln"> created </span><span class="pun">:</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">Date</span><span class="pun">(</span><span class="lit"> 1995</span><span class="pun">,</span><span class="pln"> </span><span class="lit">0</span><span class="pun">,</span><span class="pln"> </span><span class="lit">1</span><span class="pun">) </span><span class="pln"></span><span class="pun">};</span></code></pre><p>The 'items' in this object -- <code>influences</code>, <code>designer</code>, and <code>created</code> -- are known as <em>properties</em>.  While it's difficult to imagine breaking down <code>10</code> or <code>true</code> into their constituent parts, this object can easily be broken down. Notice how each value can be a different type -- both primitive values and objects can be combined together in an object.</p><p>Now consider this:</p><pre class="prettyprint prettyprinted" style=""><code class="language-javascript"><span class="kwd">var</span><span class="pln"> javascript </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new </span><span class="pln"> </span><span class="typ">Object</span><span class="pun">({</span><span class="pln">    influences</span><span class="pun">:</span><span class="pln"> </span><span class="pun">[</span><span class="str">'C'</span><span class="pun">,</span><span class="pln"> </span><span class="str">'Java'</span><span class="pun">,</span><span class="pln"> </span><span class="str">'Scheme'</span><span class="pun">]</span><span class="pln"></span><span class="pun">,</span><span class="pln"> designer</span><span class="pun">:</span><span class="pln"> </span><span class="str">'Brendan Eich'</span><span class="pln"></span><span class="pun">,</span><span class="pln"> created</span><span class="pun">:</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">Date</span><span class="pun">(</span><span class="lit">1995</span><span class="pun">,</span><span class="pln"> </span><span class="lit">0</span><span class="pun">,</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"></span><span class="pun">}); </span></code></pre><p>I've used <code>new Object</code> to create a new instance.  According to the language specification, under <a href="http://es5.github.com/#x11.1.5">Object Initialiser</a>, these forms are equivalent -- creating objects with an object literal will return a new object as if <code>new Object()</code> was used.  Similarly, the array literal <code>['C', 'Java', 'Scheme']</code> will create a new object as if <code>new Array()</code> had been called.</p><p>The important thing to notice is the use of a constructor.  In this case the constructor is <code>new Object</code>, but there are other built-in constructors.  I also sneaked in <code>new Date</code> which creates a <code>Date</code> object.</p><h3 id= "constructors">Constructors</h3><p>The previous example looks more like a data record than a reusable piece of code.  We can make it more reusable by creating a <em>constructor</em> -- a function that knows how to initialise a certain flavour of object.</p><pre class="prettyprint prettyprinted" style=""><code class="language-javascript"><span class="kwd">function </span><span class="pln"> </span><span class="typ">Language</span><span class="pun">(</span><span class="pln">designer</span><span class="pun">,</span><span class="pln"> created </span><span class="pun">,</span><span class="pln"> influences</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">    </span><span class= "kwd">this</span><span class="pun">.</span><span class="pln">designer </span><span class="pun">=</span><span class="pln"> designer</span><span class="pun">;</span><span class="pln"> </span><span class="kwd">this</span><span class="pun">.</span><span class="pln">created </span><span class="pun">=</span><span class="pln"> created</span><span class="pun">;</span><span class="pln">  </span><span class="kwd">this</span><span class="pun">.</span><span class="pln">influences </span><span class="pun">=</span><span class="pln"> influences</span><span class= "pun">;</span><span class="pln"></span><span class="pun">}</span><span class="pln"></span><span class="kwd">var</span><span class="pln"> javascript </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">Language</span><span class="pun">(</span><span class="pln">    </span><span class="str"> 'Brendan Eich'</span><span class="pln"></span><span class="pun">,</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">Date</span><span class="pun">(</span><span class="lit">1995</span><span class="pun">,</span><span class="pln"> </span><span class="lit">0</span><span class="pun">,</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"></span><span class="pun">,</span><span class="pln"> </span><span class="pun">[</span><span class="str">'C'</span><span class ="pun">,</span><span class="pln"> </span><span class="str">'Java'</span><span class="pun">,</span><span class="pln"> </span><span class="str">'Scheme'</span><span class="pun">]</span><span class="pln"></span><span class="pun">);</span></code></pre><p>Now I can make other programming languages:</p><pre class="prettyprint prettyprinted" style=""><code class= "language-javascript"><span class="kwd">var</span><span class="pln"> c </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">Language</span><span class="pun">(</span><span class="pln">    </span><span class="str">'Dennis Ritchie'</span><span class="pln"></span><span class="pun">, </span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">Date</span><span class="pun">(</span><span class="lit">1972</span><span class="pun" >,</span><span class="pln"> </span><span class="lit">0</span><span class="pun">,</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln" ></span><span class="pun">,</span><span class="pln"> </span><span class="pun">[</span><span class="str">'B'</span><span class="pun">,</span><span class="pln"> </span><span class="str"> 'ALGOL'</span><span class="pun">]</span><span class="pln"></span><span class="pun">);</span></code></pre><p>The constructor can be accessed using the <code>constructor</code> property, like this: <code>c.constructor</code>.  In this case it'll return <code>Language</code>.  Play around with it here: <a href="http://jsfiddle.net/zYzER/6/">http://jsfiddle.net/zYzER/6/</a>. </p><p>In the ES5 specification under <a href="http://es5.github.com/#x15.2.4">Properties of the Object Prototype Object</a>, other properties of objects are mentioned.  For example, we also get <code>toString</code>, and some stranger sounding methods like <code>hasOwnProperty</code>.</p><h3 id="next">Next</h3><p>I'm going to continue this series of back to basics JavaScript each Monday.  Think of it as learning JavaScript in bite-sized chunks.  Next week I'll talk about prototypes.</p>    </section>			</div> <!--=========================			END : POST		=============================-->		<!--=========================			START : POST =============================-->		<div class="post-wrapper">		<h1>JS101: __proto__</h1>		<section class="postbody">      <p>When I originally wrote about prototypes in <a href="http://dailyjs.com/2012/05/21/js101-prototype/">JS101: Prototypes</a> a few people were confused that I didn't mention the <code>__proto__</code> property.  One reason I didn't mention it is I was sticking to standard ECMAScript for the most part, using the <a href="http://es5.github.com/">Annotated ECMAScript 5.1</a> site as a reference.  It's actually hard to talk about prototypes without referring to <code>__proto__</code>, though, because it serves a very specific and useful purpose.</p><p>Recall that objects are created using constructors: </p><pre class="prettyprint prettyprinted" style=""><code class="language-javascript"><span class="kwd">function</span><span class="pln"> </span><span class="typ">User</span><span class= "pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">  </span><span class="pun">}</span><span class="pln"></span><span class="kwd">var</span><span class= "pln"> user </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">User</span><span class="pun">();</span><span class="pln">  </span></code></pre><p>The <code>prototype</code> property can be used to add properties to instances of <code>User</code>:</p><pre class="prettyprint prettyprinted" style="" ><code class="language-javascript"><span class="kwd">function</span><span class="pln"> </span><span class="typ">User</span><span class="pun">()</span><span class="pln"> </span><span class= "pun">{</span><span class="pln">  </span><span class="pun">}</span><span class="pln"></span><span class="typ">User</span><span class="pun">.</span><span class="pln">prototype</span><span class="pun">.</span><span class="pln">greet </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">function</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">    </span><span class="kwd">return</span><span class="pln"> </span><span class="str">'hello'</span><span class="pun">;</span><span class ="pln"></span><span class="pun">};</span><span class="pln"></span><span class="kwd">var</span><span class="pln"> user </span><span class="pun">=</span><span class="pln"> </span><span class ="kwd">new</span><span class="pln"> </span><span class="typ">User</span><span class="pun">();</span><span class="pln">  user</span><span class="pun">.</span><span class="pln">greet </span><span class="pun">();</span><span class="pln">  </span></code></pre><p>So far so good.  The original constructor can be referenced using the <code>constructor</code> property on an instance:</p><pre class="prettyprint prettyprinted" style=""><code class="language-javascript"><span class="pln">assert</span><span class="pun">.</span><span class="pln">equal</span><span class="pun">(</span><span class="pln">user</span><span class="pun">.</span><span class="pln">constructor</span><span class="pun">,</span><span class="pln"> </span><span class="typ">User </span><span class="pun">);</span><span class="pln">  </span></code></pre><p>However, <code>user.prototype</code> is not the same as <code>User.prototype</code>.  What if we wanted to get hold of the original prototype where the <code>greet</code> method was defined based on an instance of a <code>User</code>?</p><p>That's where <code>__proto__</code> comes in.  Given that fact, we now know the following two statements to be true:</p><pre class="prettyprint prettyprinted" style=""><code class="language-javascript"><span class="pln">assert</span><span class= "pun">.</span><span class="pln">equal</span><span class="pun">(</span><span class="pln">user</span><span class="pun">.</span><span class="pln">constructor</span><span class="pun">, </span><span class="pln"> </span><span class="typ">User</span><span class="pun">);</span><span class="pln">  assert</span><span class="pun">.</span><span class="pln">equal</span><span class="pun">(</span><span class="pln">user</span><span class="pun">.</span><span class="pln">__proto__</span><span class="pun">,</span><span class="pln"> </span><span class="typ">User </span><span class="pun">.</span><span class="pln">prototype</span><span class="pun">);</span><span class="pln">  </span></code></pre><p>Unfortunately, <code>__proto__</code> doesn't appear in ECMAScript 5 -- so where does it come from?  As noted by the <a href="https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Object/proto">documentation on MDN</a> it's a non-standard property.   Or is it?  It's included in <a href=" http://wiki.ecmascript.org/doku.php?id=harmony:specification_drafts#draft_specification_for_es.next_ecma-262_edition_6">Ecma-262 Edition 6</a>, which means whether it's standard or not depends on the version of ECMAScript that you're using.</p><p>It follows that an instance's constructor should contain a reference to the constructor's prototype.  If this is true, then we can test it using these assertions:</p><pre class="prettyprint prettyprinted" style=""><code class="language-javascript"><span class="pln">assert</span><span class="pun">.</span><span class="pln">equal</span><span class="pun">(</span><span class="pln">user</span><span class="pun">.</span><span class="pln">constructor</span><span class="pun">.</span><span class="pln"> prototype</span><span class="pun">,</span><span class="pln"> </span><span class="typ">User</span><span class="pun">.</span><span class="pln">prototype</span><span class="pun">); </span><span class="pln">  assert</span><span class="pun">.</span><span class="pln">equal</span><span class="pun">(</span><span class="pln">user</span><span class="pun">.</span><span class ="pln">constructor</span><span class="pun">.</span><span class="pln">prototype</span><span class="pun">,</span><span class="pln"> user</span><span class="pun">.</span><span class="pln"> __proto__</span><span class="pun">);</span><span class="pln">  </span></code></pre><p>The standards also define <a href="http://es5.github.com/#x15.2.3.2">Object.getPrototypeOf</a> -- this returns the <em>internal property</em> of an object.  That means we can use it to access the constructor's prototype:</p><pre class="prettyprint prettyprinted" style=""><code class= "language-javascript"><span class="pln">assert</span><span class="pun">.</span><span class="pln">equal</span><span class="pun">(</span><span class="typ">Object</span><span class="pun">. </span><span class="pln">getPrototypeOf</span><span class="pun">(</span><span class="pln">user</span><span class="pun">),</span><span class="pln"> </span><span class="typ">User</span><span class="pun">.</span><span class="pln">prototype</span><span class="pun">);</span><span class="pln">  </span></code></pre><p>Putting all of this together gives this script which will pass in Node and Chrome (given a suitable assertion library):</p><pre class="prettyprint prettyprinted" style=""><code class="language-javascript"><span class="kwd">var</span><span class="pln"> assert </span><span class="pun">=</span><span class="pln"> require</span><span class="pun">(</span><span class="str">'assert'</span><span class="pun">);</span><span class="pln" ></span><span class="kwd">function</span><span class="pln"> </span><span class="typ">User</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class= "pln">  </span><span class="pun">}</span><span class="pln"></span><span class="kwd">var</span><span class="pln"> user </span><span class="pun">=</span><span class="pln"> </span><span class ="kwd">new</span><span class="pln"> </span><span class="typ">User</span><span class="pun">();</span><span class="pln">assert</span><span class="pun">.</span><span class="pln">equal </span><span class="pun">(</span><span class="pln">user</span><span class="pun">.</span><span class="pln">__proto__</span><span class="pun">,</span><span class="pln"> </span><span class= "typ">User</span><span class="pun">.</span><span class="pln">prototype</span><span class="pun">);</span><span class="pln">  assert</span><span class="pun">.</span><span class="pln">equal </span><span class="pun">(</span><span class="pln">user</span><span class="pun">.</span><span class="pln">constructor</span><span class="pun">,</span><span class="pln"> </span><span class= "typ">User</span><span class="pun">);</span><span class="pln">  assert</span><span class="pun">.</span><span class="pln">equal</span><span class="pun">(</span><span class="pln">user </span><span class="pun">.</span><span class="pln">constructor</span><span class="pun">.</span><span class="pln">prototype</span><span class="pun">,</span><span class="pln"> </span><span class="typ">User</span><span class="pun">.</span><span class="pln">prototype</span><span class="pun">);</span><span class="pln">  assert</span><span class="pun">.</span><span class="pln"> equal</span><span class="pun">(</span><span class="pln">user</span><span class="pun">.</span><span class="pln">constructor</span><span class="pun">.</span><span class="pln">prototype </span><span class="pun">,</span><span class="pln"> user</span><span class="pun">.</span><span class="pln">__proto__</span><span class="pun">);</span><span class="pln">  assert</span><span class="pun">.</span><span class="pln">equal</span><span class="pun">(</span><span class="typ">Object</span><span class="pun">.</span><span class="pln">getPrototypeOf</span><span class= "pun">(</span><span class="pln">user</span><span class="pun">),</span><span class="pln"> </span><span class="typ">User</span><span class="pun">.</span><span class="pln">prototype </span><span class="pun">);</span><span class="pln">  </span></code></pre><h3 id="internalprototype">Internal Prototype</h3><p>The confusion around <code>__proto__</code> arises because of the term <strong>internal prototype</strong>:</p><blockquote>  <p>All objects have an internal property called [[Prototype]]. The value of this property is either <code>null</code> or an object and is used for implementing inheritance.</p></blockquote><p>Internally there <em>has</em> to be a way to access the constructor's prototype to correctly implement inheritance -- whether or not this is available to us is another matter.  Why is accessing it useful to us?  In the wild you'll occasionally see people setting an object's <code>__proto__</code> property to make objects look like they inherit from another object.  This <a href="https://github.com/joyent/node/blob/b207e24bcd168a5ca538476ee0b3b0960cdc6759/lib/assert.js">used to be the case in Node's assertion module</a>, but Node's <code>util.inherits</code> method is a more idiomatic way to do it:</p><pre class="prettyprint prettyprinted" style=""><code class= "language-javascript"><span class="com">// Compare to: assert.AssertionError.__proto__ = Error.prototype;</span><span class="pln">util</span><span class="pun">.</span><span class="pln"> inherits</span><span class="pun">(</span><span class="pln">assert</span><span class="pun">.</span><span class="typ">AssertionError</span><span class="pun">,</span><span class="pln"> </span><span class="typ">Error</span><span class="pun">);</span><span class="pln">  </span></code></pre><p>This was changed in <a href=" https://github.com/joyent/node/commit/9eddaebb79ff1954b7ecdb209587d7db6554580d">assert: remove unnecessary use of __proto__</a>.</p><h3 id="theconstructorsprototype">The Constructor's Prototype</h3><p>The <code>User</code> example's internal prototype is set to <code>Function.prototype</code>:</p><pre class="prettyprint prettyprinted" style=""><code class= "language-javascript"><span class="pln">assert</span><span class="pun">.</span><span class="pln">equal</span><span class="pun">(</span><span class="typ">User</span><span class="pun">. </span><span class="pln">__proto__</span><span class="pun">,</span><span class="pln"> </span><span class="typ">Function</span><span class="pun">.</span><span class="pln">prototype </span><span class="pun">);</span><span class="pln">  </span></code></pre><p>If you're about to put on your hat, pick up your briefcase, and walk right out the door: hold on a minute. You're coming to the end of the chain -- the prototype chain that is:</p><pre class="prettyprint prettyprinted" style=""><code class="language-javascript"><span class="pln">assert </span><span class="pun">.</span><span class="pln">equal</span><span class="pun">(</span><span class="typ">User</span><span class="pun">.</span><span class="pln">__proto__</span><span class="pun">,</span><span class="pln"> </span><span class="typ">Function</span><span class="pun">.</span><span class="pln">prototype</span><span class="pun">);</span><span class="pln"> assert</span><span class="pun">.</span><span class="pln">equal</span><span class="pun">(</span><span class="typ">Function</span><span class="pun">.</span><span class="pln">prototype </span><span class="pun">.</span><span class="pln">__proto__</span><span class="pun">,</span><span class="pln"> </span><span class="typ">Object</span><span class="pun">.</span><span class= "pln">prototype</span><span class="pun">);</span><span class="pln">  assert</span><span class="pun">.</span><span class="pln">equal</span><span class="pun">(</span><span class="typ">Object </span><span class="pun">.</span><span class="pln">prototype</span><span class="pun">.</span><span class="pln">__proto__</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">null</span><span class="pun">);</span><span class="pln">  </span></code></pre><p>Remember that the <code>__proto__</code> property is the <em>internal prototype</em> -- this is how JavaScript's inheritance chain is implemented.  Every <code>User</code> inherits from <code>Function.prototype</code> which in turn inherits from <code>Object.prototype</code>, and <code>Object.prototype</code>'s internal prototype is <code>null</code> which allows the inheritance algorithm to know it has reached the end of the chain.</p><p>Therefore, adding a method to <code>Object.prototype</code> will make it available to every object.  <a href="http://es5.github.com/#x15.2.4">Properties of the Object Prototype Object</a> include <code> toString</code>, <code>valueOf</code>, and <code>hasOwnProperty</code>.  That means instances of the <code>User</code> constructor in the previous example will have these methods.</p><h3 id="pithyclosingremark">Pithy Closing Remark</h3><p>JavaScript's inheritance model is not class-based.  Joost Diepenmaat's post, <a href=" http://joost.zeekat.nl/constructors-considered-mildly-confusing.html">Constructors considered mildly confusing</a>, summarises this as follows:</p><blockquote>  <p>In a class-based object system, typically classes inherit from each other, and objects are instances of those classes. ... constructors do nothing like this: in fact constructors have their own [[Prototype]] chain completely separate from the [[Prototype]] chain of objects they initialize.</p></blockquote><p>Rather than visualising JavaScript objects as "classes", try to think in terms of two parallel lines of <em>prototype chains</em>: one for constructors, and one for initialised objects.</p><h3 id="references">References</h3><ul><li><a href="https://github.com/joyent/node"> Node's source</a></li><li><a href="http://es5.github.com/#x15.2.4">Annotated ECMAScript 5.1</a></li><li><a href=" http://wiki.ecmascript.org/doku.php?id=harmony:specification_drafts#draft_specification_for_es.next_ecma-262_edition_6">Ecma-262 Edition 6</a></li><li></li><li><a href=" http://joost.zeekat.nl/constructors-considered-mildly-confusing.html">Constructors considered mildly confusing</a></li></ul>    </section>			</div> <!--=========================			END : POST		=============================-->		<!--=========================			START : POST =============================-->		<div class="post-wrapper">			<h1 class="post-title">Object literals and prototypes in JavaScript</h1>
	<section class="post-content">
            <p>You think you know JavaScript and then little things like this happen...</p>

<p>My co-worker <a href="https://twitter.com/aaronbushnell">Aaron</a> who is a Visual Design Engineer  is in the process of learning JavaScript and he asked me to have a look at a Fiddle.</p>

<p>The contents of the fiddle looked like this...</p>

<pre><code class="prettyprint lang-js prettyprinted" style=""><span class="kwd">function</span><span class="pln"> </span><span class="typ">Pizza</span><span class="pln"> </span><span class="pun">(</span><span class="pln">type</span><span class="pun">,</span><span class="pln"> slices</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    </span><span class="kwd">this</span><span class="pun">.</span><span class="pln">type </span><span class="pun">=</span><span class="pln"> type</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">this</span><span class="pun">.</span><span class="pln">slices </span><span class="pun">=</span><span class="pln"> slices</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

</span><span class="com">// Using this method of adding to the prototype doesn't log out the constructor correctly on lines 21-22...</span><span class="pln">
</span><span class="typ">Pizza</span><span class="pun">.</span><span class="pln">prototype </span><span class="pun">=</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
  divvyUp</span><span class="pun">:</span><span class="pln"> </span><span class="kwd">function</span><span class="pln"> </span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    alert</span><span class="pun">(</span><span class="str">"The "</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="kwd">this</span><span class="pun">.</span><span class="pln">type </span><span class="pun">+</span><span class="pln"> </span><span class="str">" pizza has been divvied up!"</span><span class="pun">);</span><span class="pln">
  </span><span class="pun">}</span><span class="pln">
</span><span class="pun">};</span><span class="pln">

</span><span class="com">// ...but this does.</span><span class="pln">
</span><span class="com">// Pizza.prototype.divvyUp = function () {</span><span class="pln">
</span><span class="com">//     alert("The " + this.type + " pizza has been divvied up!");</span><span class="pln">
</span><span class="com">// };</span><span class="pln">

</span><span class="kwd">var</span><span class="pln"> sausagePizza </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">Pizza</span><span class="pun">(</span><span class="str">"sausage"</span><span class="pun">,</span><span class="pln"> </span><span class="lit">8</span><span class="pun">);</span><span class="pln">

console</span><span class="pun">.</span><span class="pln">log</span><span class="pun">(</span><span class="pln">sausagePizza</span><span class="pun">);</span><span class="pln">
console</span><span class="pun">.</span><span class="pln">log</span><span class="pun">(</span><span class="pln">sausagePizza</span><span class="pun">.</span><span class="pln">constructor</span><span class="pun">.</span><span class="pln">prototype</span><span class="pun">);</span><span class="pln">
console</span><span class="pun">.</span><span class="pln">log</span><span class="pun">(</span><span class="pln">sausagePizza</span><span class="pun">.</span><span class="pln">constructor</span><span class="pun">.</span><span class="pln">prototype</span><span class="pun">.</span><span class="pln">divvyUp</span><span class="pun">);</span><span class="pln">  </span></code></pre>

<p>He was pointing out to me the fact that when he assigns the <code>Pizza.prototype</code> to an object, the console doesn't show what he expects to see.</p>

<p>Sure enough even at first I was like, wut?</p>

<p><img alt="" src="http://d.pr/i/YBGT+"></p>

<p>Then I stopped to think about it a bit further.</p>

<p>Whenever I usually work with assigning things to the prototype, I will either do like his second example...</p>

<pre><code class="prettyprint lang-js prettyprinted" style=""><span class="typ">Pizza</span><span class="pun">.</span><span class="pln">prototype</span><span class="pun">.</span><span class="pln">divvyUp </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">function</span><span class="pln"> </span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
     alert</span><span class="pun">(</span><span class="str">"The "</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="kwd">this</span><span class="pun">.</span><span class="pln">type </span><span class="pun">+</span><span class="pln"> </span><span class="str">" pizza has been divvied up!"</span><span class="pun">);</span><span class="pln">
</span><span class="pun">};</span></code></pre>

<p>Or use jQuery or underscore's extend method...</p>

<pre><code class="prettyprint lang-js prettyprinted" style=""><span class="pln">_</span><span class="pun">.</span><span class="pln">extend</span><span class="pun">(</span><span class="typ">Pizza</span><span class="pun">.</span><span class="pln">prototype</span><span class="pun">,</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
   divvyUp</span><span class="pun">:</span><span class="pln"> </span><span class="kwd">function</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{}</span><span class="pln">
</span><span class="pun">});</span></code></pre>

<p>These two methods usually work just fine.</p>

<p>So, why was his example all funkyfied? Well, by assigning an object to the prototype, he decoupled the prototype chain. Now all the sudden <code>Pizza.prototype.constructor</code> actually points to the <code>Object</code> constructor rather than the <code>Pizza</code> constructor.</p>

<p>You can see this is the case by logging the instance...</p>

<pre><code class="prettyprint lang-js prettyprinted" style=""><span class="pln">console</span><span class="pun">.</span><span class="pln">log</span><span class="pun">(</span><span class="pln">sausagePizza</span><span class="pun">.</span><span class="pln">constructor </span><span class="pun">===</span><span class="pln"> </span><span class="typ">Object</span><span class="pun">);</span><span class="pln"> </span><span class="com">// true  </span></code></pre>

<p>When you assign a prototype to an object you've changed the prototypical inheritance of that object. The prototype of the object will no longer have the original constructor function!</p>

<p>If you really wanted to use an object literal in this way you can fix it by...</p>

<pre><code class="prettyprint lang-js prettyprinted" style=""><span class="typ">Pizza</span><span class="pun">.</span><span class="pln">prototype</span><span class="pun">.</span><span class="pln">constructor </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Pizza</span><span class="pun">;</span><span class="pln">  </span></code></pre>

<p>Or you could just use the <code>$.extend</code> or <code>_.extend</code> if you really had your heart set on using an object literal for setting the prototype chain up.</p>

<p>Helping people understand JavaScript is one of the best ways to make sure YOU fully understand JavaScript.</p>
        </section></div>		<!--=========================			END : POST		=============================-->
		<!--=========================			START : POST		=============================-->
		<div class="post-wrapper">
		<h1 class="entry-title">A Plain English Guide to JavaScript Prototypes</h1>
		<div class="entry-content"><p>When I first started learning about JavaScript object model my reaction was of horror and disbelief. I was totally puzzled by its prototype nature as it was my first encounter with a prototype based language. I didn’t help that JavaScript has a unique take on prototypes as it adds the concept of <strong>function constructors</strong>. I bet that many of you have had similar experience.</p>

<p>But as I used JavaScript more I didn’t just learn to understand its object model but also started love parts of it. Thanks to JavaScript I have find out the elegance and flexibility of prototypes languages. I am now quite fond of prototype languages because they have a simpler and more flexible object model than class based languages.</p>

<h2>Prototypes in Javascript</h2>

<p>Most guides / tutorials start explaining JavaScript objects by going directly to ‘<strong>constructor functions</strong>’, I think this is a mistake, as they introduce a fairly complex concept early on making Javascript look difficult and confusing from the start. Let’s leave this for later. First let’s start with the basics of prototypes.</p>

<h2>Prototype chains (aka prototype inheritance)</h2>

<p>Every object in Javascript has a <strong>prototype</strong>. When a messages reaches an object, JavaScript will attempt to find a property in that object first, if it cannot find it then the message will be sent to the object’s prototype and so on. This works just like single parent inheritance in a class based language.</p>

<p><img src="https://docs.google.com/drawings/d/1NdiIkHd9Cg2j6W4QcJ1X3DEhGXD2gacMXRuURcoE5T4/pub?w=960&amp;h=720"></p>

<p>Prototype inheritance chains can go as long as you want. But in general it is not a good idea to make long chains as your code can get difficult to understand and maintain.</p>

<h2>The __proto__ object</h2>

<p>To understand prototype chains in JavaScript there is nothing as simple as the <strong>__proto__</strong> property. Unfortunately <strong>__proto__</strong> is not part of the standard interface of JavaScript, not at least until ES6. So you shouldn’t use it in production code. But anyway it makes explaining prototypes easy.</p>

<figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tbody><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
<span class="line-number">10</span>
<span class="line-number">11</span>
<span class="line-number">12</span>
<span class="line-number">13</span>
<span class="line-number">14</span>
<span class="line-number">15</span>
<span class="line-number">16</span>
<span class="line-number">17</span>
<span class="line-number">18</span>
<span class="line-number">19</span>
<span class="line-number">20</span>
<span class="line-number">21</span>
<span class="line-number">22</span>
<span class="line-number">23</span>
<span class="line-number">24</span>
<span class="line-number">25</span>
</pre></td><td class="code"><pre><code class="js"><span class="line"><span class="c1">// let's create an alien object</span>
</span><span class="line"><span class="kd">var</span> <span class="nx">alien</span> <span class="o">=</span> <span class="p">{</span>
</span><span class="line">  <span class="nx">kind</span><span class="o">:</span> <span class="s1">'alien'</span>
</span><span class="line"><span class="p">}</span>
</span><span class="line">
</span><span class="line"><span class="c1">// and a person object</span>
</span><span class="line"><span class="kd">var</span> <span class="nx">person</span> <span class="o">=</span> <span class="p">{</span>
</span><span class="line">  <span class="nx">kind</span><span class="o">:</span> <span class="s1">'person'</span>
</span><span class="line"><span class="p">}</span>
</span><span class="line">
</span><span class="line"><span class="c1">// and an object called 'zack'</span>
</span><span class="line"><span class="kd">var</span> <span class="nx">zack</span> <span class="o">=</span> <span class="p">{};</span>
</span><span class="line">
</span><span class="line"><span class="c1">// assign alien as the prototype of zack</span>
</span><span class="line"><span class="nx">zack</span><span class="p">.</span><span class="nx">__proto__</span> <span class="o">=</span> <span class="nx">alien</span>
</span><span class="line">
</span><span class="line"><span class="c1">// zack is now linked to alien</span>
</span><span class="line"><span class="c1">// it 'inherits' the properties of alien</span>
</span><span class="line"><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">zack</span><span class="p">.</span><span class="nx">kind</span><span class="p">);</span> <span class="c1">//=&gt; ‘alien’</span>
</span><span class="line">
</span><span class="line"><span class="c1">// assign person as the prototype of zack</span>
</span><span class="line"><span class="nx">zack</span><span class="p">.</span><span class="nx">__proto__</span> <span class="o">=</span> <span class="nx">person</span>
</span><span class="line">
</span><span class="line"><span class="c1">// and now zack is linked to person</span>
</span><span class="line"><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">zack</span><span class="p">.</span><span class="nx">kind</span><span class="p">);</span> <span class="c1">//=&gt; ‘person’</span>
</span></code></pre></td></tr></tbody></table></div></figure>


<p>As you can see the <strong>__proto__</strong> property is very straightforward to understand and use. Even if we shouldn’t use <strong>__proto__</strong> in production code, I think that these examples give the best foundation to understand the JavaScript object model.</p>

<p>You can check that one object is the prototype of another by doing:</p>

<figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tbody><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
</pre></td><td class="code"><pre><code class="js"><span class="line"><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">alien</span><span class="p">.</span><span class="nx">isPrototypeOf</span><span class="p">(</span><span class="nx">zack</span><span class="p">))</span>
</span><span class="line"><span class="c1">//=&gt; true</span>
</span></code></pre></td></tr></tbody></table></div></figure>


<h3>Prototype lookups are dynamic</h3>

<p>You can add properties to the prototype of an object at any time, the prototype chain lookup will find the new  property as expected.</p>

<figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tbody><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
<span class="line-number">10</span>
<span class="line-number">11</span>
<span class="line-number">12</span>
<span class="line-number">13</span>
<span class="line-number">14</span>
</pre></td><td class="code"><pre><code class="js"><span class="line"><span class="kd">var</span> <span class="nx">person</span> <span class="o">=</span> <span class="p">{}</span>
</span><span class="line">
</span><span class="line"><span class="kd">var</span> <span class="nx">zack</span> <span class="o">=</span> <span class="p">{}</span>
</span><span class="line"><span class="nx">zack</span><span class="p">.</span><span class="nx">__proto__</span> <span class="o">=</span> <span class="nx">person</span>
</span><span class="line">
</span><span class="line"><span class="c1">// zack doesn't respond to kind at this point</span>
</span><span class="line"><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">zack</span><span class="p">.</span><span class="nx">kind</span><span class="p">);</span> <span class="c1">//=&gt; undefined</span>
</span><span class="line">
</span><span class="line"><span class="c1">// let's add kind to person</span>
</span><span class="line"><span class="nx">person</span><span class="p">.</span><span class="nx">kind</span> <span class="o">=</span> <span class="s1">'person'</span>
</span><span class="line">
</span><span class="line"><span class="c1">// now zack responds to kind</span>
</span><span class="line"><span class="c1">// because it finds 'kind' in person</span>
</span><span class="line"><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">zack</span><span class="p">.</span><span class="nx">kind</span><span class="p">);</span> <span class="c1">//=&gt; 'person'</span>
</span></code></pre></td></tr></tbody></table></div></figure>


<h3>New / updated properties are assigned to the object, not to the prototype</h3>

<p>What happens if you update a property that already exists in the prototype? Let’s see:</p>

<figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tbody><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
<span class="line-number">10</span>
<span class="line-number">11</span>
<span class="line-number">12</span>
<span class="line-number">13</span>
<span class="line-number">14</span>
</pre></td><td class="code"><pre><code class="js"><span class="line"><span class="kd">var</span> <span class="nx">person</span> <span class="o">=</span> <span class="p">{</span>
</span><span class="line">  <span class="nx">kind</span><span class="o">:</span> <span class="s1">'person'</span>
</span><span class="line"><span class="p">}</span>
</span><span class="line">
</span><span class="line"><span class="kd">var</span> <span class="nx">zack</span> <span class="o">=</span> <span class="p">{}</span>
</span><span class="line"><span class="nx">zack</span><span class="p">.</span><span class="nx">__proto__</span> <span class="o">=</span> <span class="nx">person</span>
</span><span class="line">
</span><span class="line"><span class="nx">zack</span><span class="p">.</span><span class="nx">kind</span> <span class="o">=</span> <span class="s1">'zack'</span>
</span><span class="line">
</span><span class="line"><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">zack</span><span class="p">.</span><span class="nx">kind</span><span class="p">);</span> <span class="c1">//=&gt; 'zack'</span>
</span><span class="line"><span class="c1">// zack now has a 'kind' property</span>
</span><span class="line">
</span><span class="line"><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">person</span><span class="p">.</span><span class="nx">kind</span><span class="p">);</span> <span class="c1">//=&gt; 'person'</span>
</span><span class="line"><span class="c1">// person has not being modified</span>
</span></code></pre></td></tr></tbody></table></div></figure>


<p>Note that the property ‘kind’ now exists in both person and zack.</p>

<h2>Object.create</h2>

<p>As explained before <strong>__proto__</strong> is not a well supported way of assigning prototypes to objects. So the next simplest way is using <strong>Object.create()</strong>. This is available in ES5, but old browsers / engines can be shimmed using this <a href="https://github.com/kriskowal/es5-shim">es5-shim</a>.</p>

<figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tbody><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
</pre></td><td class="code"><pre><code class="js"><span class="line"><span class="kd">var</span> <span class="nx">person</span> <span class="o">=</span> <span class="p">{</span>
</span><span class="line">  <span class="nx">kind</span><span class="o">:</span> <span class="s1">'person'</span>
</span><span class="line"><span class="p">}</span>
</span><span class="line">
</span><span class="line"><span class="c1">// creates a new object which prototype is person</span>
</span><span class="line"><span class="kd">var</span> <span class="nx">zack</span> <span class="o">=</span> <span class="nb">Object</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="nx">person</span><span class="p">);</span>
</span><span class="line">
</span><span class="line"><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">zack</span><span class="p">.</span><span class="nx">kind</span><span class="p">);</span> <span class="c1">// =&gt; ‘person’</span>
</span></code></pre></td></tr></tbody></table></div></figure>


<p>You can pass an object to Object.create to add specific properties for the new object</p>

<figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tbody><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
</pre></td><td class="code"><pre><code class="js"><span class="line"><span class="kd">var</span> <span class="nx">zack</span> <span class="o">=</span> <span class="nb">Object</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="nx">person</span><span class="p">,</span> <span class="p">{</span><span class="nx">age</span><span class="o">:</span> <span class="p">{</span><span class="nx">value</span><span class="o">:</span>  <span class="mi">13</span><span class="p">}</span> <span class="p">});</span>
</span><span class="line"><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">zack</span><span class="p">.</span><span class="nx">age</span><span class="p">);</span> <span class="c1">// =&gt; ‘13’</span>
</span></code></pre></td></tr></tbody></table></div></figure>


<p>Yes, the object you need to pass is a bit convoluted, but that is the way it is. See the docs <a href="https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Object/create">here</a>.</p>

<h3>Object.getPrototype</h3>

<p>You can get the prototype of an object using Object.getPrototypeOf</p>

<figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tbody><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
</pre></td><td class="code"><pre><code class="js"><span class="line"><span class="kd">var</span> <span class="nx">zack</span> <span class="o">=</span> <span class="nb">Object</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="nx">person</span><span class="p">);</span>
</span><span class="line"><span class="nb">Object</span><span class="p">.</span><span class="nx">getPrototypeOf</span><span class="p">(</span><span class="nx">zack</span><span class="p">);</span> <span class="c1">//=&gt; person</span>
</span></code></pre></td></tr></tbody></table></div></figure>


<p>There is no such thing as Object.setPrototype.</p>

<h2>Constructor Functions</h2>

<p><strong>Constructor functions</strong> are the most used way in JavaScript to construct prototype chains. The popularity of <strong>constructor functions</strong> comes from the fact that this was the only original way for constructing types. It is also an important consideration the fact that many engines are highly optimized for constructor functions.</p>

<p>Unfortunately they can get confusing, they are in my opinion one of the main reasons why new comers find JavaScript puzzling, but they are a big part of the language and we need to understand them well.</p>

<h3>Functions as constructors</h3>

<p>In JavaScript you create an instance of a function like this:</p>

<figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tbody><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
</pre></td><td class="code"><pre><code class="js"><span class="line"><span class="kd">function</span> <span class="nx">Foo</span><span class="p">(){}</span>
</span><span class="line">
</span><span class="line"><span class="kd">var</span> <span class="nx">foo</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Foo</span><span class="p">();</span>
</span><span class="line">
</span><span class="line"><span class="c1">//foo is now an instance of Foo</span>
</span><span class="line"><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">foo</span> <span class="k">instanceof</span> <span class="nx">Foo</span> <span class="p">)</span> <span class="c1">//=&gt; true</span>
</span></code></pre></td></tr></tbody></table></div></figure>


<p>In essence functions when used with the keyword <strong>new</strong> behave like factories, meaning that they create new objects. The new object they create is linked to the function by its prototype, more on this later. So in JavaScript we call this an <strong>instance</strong> of the function.</p>

<h3>‘this’ is assigned implicitly</h3>

<p>When we use ‘<strong>new</strong>’, JavaScript injects an implicit reference to the new object being created in the form of the ‘<strong>this</strong>’ keyword. It also returns this reference implicitly at the end of the function.</p>

<p>When we do this:</p>

<figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tbody><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
</pre></td><td class="code"><pre><code class="js"><span class="line"><span class="kd">function</span> <span class="nx">Foo</span><span class="p">()</span> <span class="p">{</span>
</span><span class="line">  <span class="k">this</span><span class="p">.</span><span class="nx">kind</span> <span class="o">=</span> <span class="err">‘</span><span class="nx">foo</span><span class="err">’</span>
</span><span class="line"><span class="p">}</span>
</span><span class="line">
</span><span class="line"><span class="kd">var</span> <span class="nx">foo</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Foo</span><span class="p">();</span>
</span><span class="line"><span class="nx">foo</span><span class="p">.</span><span class="nx">kind</span> <span class="c1">//=&gt; ‘foo’</span>
</span></code></pre></td></tr></tbody></table></div></figure>


<p>Behind the scenes it is like doing something like this:</p>

<figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tbody><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
</pre></td><td class="code"><pre><code class="js"><span class="line"><span class="kd">function</span> <span class="nx">Foo</span><span class="p">()</span> <span class="p">{</span>
</span><span class="line">  <span class="kd">var</span> <span class="k">this</span> <span class="o">=</span> <span class="p">{};</span> <span class="c1">// this is not valid, just for illustration</span>
</span><span class="line">  <span class="k">this</span><span class="p">.</span><span class="nx">__proto__</span> <span class="o">=</span> <span class="nx">Foo</span><span class="p">.</span><span class="nx">prototype</span><span class="p">;</span>
</span><span class="line">
</span><span class="line">  <span class="k">this</span><span class="p">.</span><span class="nx">kind</span> <span class="o">=</span> <span class="err">‘</span><span class="nx">foo</span><span class="err">’</span>
</span><span class="line">
</span><span class="line">  <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
</span><span class="line"><span class="p">}</span>
</span></code></pre></td></tr></tbody></table></div></figure>


<p>But keep in mind that the implicit ‘<strong>this</strong>’ is only assigned to a new object when using ‘<strong>new</strong>’. If you forget ‘<strong>new</strong>’ keyword then ‘<strong>this</strong>’ will be the global object. Of course forgetting <strong>new</strong> is a cause of multiple bugs, so don’t forget <strong>new</strong>.</p>

<p>One convention that I like is capitalizing the first letter of a function when it is intented to be used as a function constructor, so you now straightaway to you are missing the <strong>new</strong> keyword.</p>

<h3>The ‘function prototype’</h3>

<p>Every function in JavaScript has a special property called ‘<strong>prototype</strong>’.</p>

<figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tbody><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
</pre></td><td class="code"><pre><code class="js"><span class="line"><span class="kd">function</span> <span class="nx">Foo</span><span class="p">(){</span>
</span><span class="line"><span class="p">}</span>
</span><span class="line">
</span><span class="line"><span class="nx">Foo</span><span class="p">.</span><span class="nx">prototype</span>
</span></code></pre></td></tr></tbody></table></div></figure>


<p>As confusing as it may sound, this ‘<strong>prototype</strong>’ property is not the real prototype (<strong>__proto__</strong>) of the function.</p>

<figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tbody><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
</pre></td><td class="code"><pre><code class="js"><span class="line"><span class="nx">Foo</span><span class="p">.</span><span class="nx">__proto__</span> <span class="o">===</span> <span class="nx">Foo</span><span class="p">.</span><span class="nx">prototype</span> <span class="c1">//=&gt; false</span>
</span></code></pre></td></tr></tbody></table></div></figure>


<p>This of course generates a lot of confusion as people use the term ‘<strong>prototype</strong>’ to refer to different things. I think that a good clarification is to always refer to the special ‘<strong>prototype</strong>’ property of functions as ‘<strong>the function prototype</strong>’, never just ‘<strong>prototype</strong>’.</p>

<p>The ‘<strong>prototype</strong>’ property points to the object that will be asigned as the prototype of instances created with that function when using ‘<strong>new</strong>’. Confusing? This is easier to explain with an example:</p>

<figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tbody><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
<span class="line-number">10</span>
<span class="line-number">11</span>
<span class="line-number">12</span>
<span class="line-number">13</span>
<span class="line-number">14</span>
<span class="line-number">15</span>
<span class="line-number">16</span>
</pre></td><td class="code"><pre><code class="js"><span class="line"><span class="kd">function</span> <span class="nx">Person</span><span class="p">(</span><span class="nx">name</span><span class="p">)</span> <span class="p">{</span>
</span><span class="line">  <span class="k">this</span><span class="p">.</span><span class="nx">name</span> <span class="o">=</span> <span class="nx">name</span><span class="p">;</span>
</span><span class="line"><span class="p">}</span>
</span><span class="line">
</span><span class="line"><span class="c1">// the function person has a prototype property</span>
</span><span class="line"><span class="c1">// we can add properties to this function prototype</span>
</span><span class="line"><span class="nx">Person</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">kind</span> <span class="o">=</span> <span class="err">‘</span><span class="nx">person</span><span class="err">’</span>
</span><span class="line">
</span><span class="line"><span class="c1">// when we create a new object using new</span>
</span><span class="line"><span class="kd">var</span> <span class="nx">zack</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Person</span><span class="p">(</span><span class="err">‘</span><span class="nx">Zack</span><span class="err">’</span><span class="p">);</span>
</span><span class="line">
</span><span class="line"><span class="c1">// the prototype of the new object points to person.prototype</span>
</span><span class="line"><span class="nx">zack</span><span class="p">.</span><span class="nx">__proto__</span> <span class="o">==</span> <span class="nx">Person</span><span class="p">.</span><span class="nx">prototype</span> <span class="c1">//=&gt; true</span>
</span><span class="line">
</span><span class="line"><span class="c1">// in the new object we have access to properties defined in Person.prototype</span>
</span><span class="line"><span class="nx">zack</span><span class="p">.</span><span class="nx">kind</span> <span class="c1">//=&gt; person</span>
</span></code></pre></td></tr></tbody></table></div></figure>


<p>That is mostly everything there is to know about the JavaScript object model. Understanding how <strong>__proto__</strong> and <strong>function.prototype</strong> are related will give you countless hours of joy and satisfaction, or maybe not.</p>

<p>Mistakes, confusing? Let me know.</p>
</div>
			</div>
			<!--========================= END : POST		=============================-->
			<!--=========================			START : POST		=============================-->
		<div class="post-wrapper">
		<h1>JavaScript constructors, prototypes, and the `new` keyword</h1>
		<div class="post-4729 post type-post status-publish format-standard has-post-thumbnail hentry category-labs channel-labs channel-pivotal-labs">
								<p>Are you baffled by the <code>new</code> operator in JavaScript?  Wonder what the difference between a function and a constructor is?  Or what the heck a prototype is used for?</p>
<p>I’m going to lay it out straight.</p>
<p>Now, there’s been a lot of talk for a long time about so-called “pseudo-classical” JavaScript.  Mostly, the new guard of JavaScript folk don’t like to use the <code>new</code> keyword.  It was written into the language to act more like Java, and its use is a little confusing.  I’m not going to take sides here.  I’m just going to explain how it works.  It’s a tool; use it if it’s practical.</p>
<h3>What is a constructor?</h3>
<p>A constructor is any function which is used as a constructor.  The language doesn’t make a distinction.  A function can be written to be used as a constructor or to be called as a normal function, or to be used either way.</p>
<p>A constructor is used with the <code>new</code> keyword:</p>
<pre style="word-wrap: break-word; border: 1px solid rgb(221, 221, 221); padding: 10px; background: rgb(246, 246, 246);"><code>var Vehicle = function Vehicle() {
  // ...
}

var vehicle = new Vehicle();
</code></pre>
<h3>What happens when a constructor is called?</h3>
<p>When <code>new Vehicle()</code> is called, JavaScript does four things:</p>
<ol>
<li>It creates a new object.</li>
<li>It sets the <code>constructor</code> property of the object to <code>Vehicle</code>.</li>
<li>It sets up the object to delegate to <code>Vehicle.prototype</code>.</li>
<li>It calls <code>Vehicle()</code> in the context of the new object.</li>
</ol>
<p>The result of <code>new Vehicle()</code> is this new object.</p>
<h4>1. It creates the new object.</h4>
<p>This is nothing special, just a fresh, new object: <code>{}</code>.</p>
<h4>2. It sets the <code>constructor</code> property of the object to <code>Vehicle</code>.</h4>
<p>This means two things:</p>
<pre style="word-wrap: break-word; border: 1px solid rgb(221, 221, 221); padding: 10px; background: rgb(246, 246, 246);"><code>vehicle.constructor == Vehicle  // true
vehicle instanceof Vehicle      // true
</code></pre>
<p>This isn’t an ordinary property.  It won’t show up if you enumerate the properties of the object.  Also, you can try to set <code>constructor</code>, but you’ll just set a normal property on top of this special one.  To wit:</p>
<pre style="word-wrap: break-word; border: 1px solid rgb(221, 221, 221); padding: 10px; background: rgb(246, 246, 246);"><code>vehicle;                          // {}

var FuzzyBear = function FuzzyBear() { };
vehicle.constructor = FuzzyBear;

vehicle;                          // { constructor: function FuzzyBear() }
vehicle.constructor == FuzzyBear; // true
vehicle instanceof FuzzyBear      // false
vehicle instanceof Vehicle        // true
</code></pre>
<p>The underlying, built in <code>constructor</code> property is something you can’t set manually.  It can only be set for you, as part of construction with the <code>new</code> keyword.</p>
<h4>3. It sets up the object to delegate to <code>Vehicle.prototype</code>.</h4>
<p>Now it gets interesting.</p>
<p>A function is just a special kind of object, and like any object a function can have properties.  Functions automatically get a property called <code>prototype</code>, which is just an empty object.  This object gets some special treatment.</p>
<p>When an object is constructed, <strong>it inherits all of the properties of its constructor’s prototype</strong>.  I know, it’s a brainful.  Here.</p>
<pre style="word-wrap: break-word; border: 1px solid rgb(221, 221, 221); padding: 10px; background: rgb(246, 246, 246);"><code>Vehicle.prototype.wheelCount = 4;
var vehicle = new Vehicle;
vehicle.wheelCount;         // 4
</code></pre>
<p>The Vehicle instance picked up the <code>wheelCount</code> from <code>Vehicle</code>‘s prototype</p>
<p>Now this “inheritance” is more than simply copying properties to the new objects.  The object is set up to <em>delegate</em> any properties which haven’t been explicitly set up to its constructor’s prototype.  That means that we can change the prototype later, and still see the changes in the instance.</p>
<pre style="word-wrap: break-word; border: 1px solid rgb(221, 221, 221); padding: 10px; background: rgb(246, 246, 246);"><code>Vehicle.prototype.wheelCount = 6;
vehicle.wheelCount;         // 6
</code></pre>
<p>But if we like, we can always override it.</p>
<pre style="word-wrap: break-word; border: 1px solid rgb(221, 221, 221); padding: 10px; background: rgb(246, 246, 246);"><code>vehicle.wheelCount = 8;
vehicle.wheelCount          // 8
(new Vehicle()).wheelCount  // 6;
</code></pre>
<p>We can do the same thing with methods.  After all, a method is just a function assigned to a property.  Check it.</p>
<pre style="word-wrap: break-word; border: 1px solid rgb(221, 221, 221); padding: 10px; background: rgb(246, 246, 246);"><code>Vehicle.prototype.go = function go() { return "Vroom!" };
vehicle.go();                              // "Vroom!"
</code></pre>
<h4>4. It calls <code>Vehicle()</code> in the context of the new object.</h4>
<p>Finally, the constructor function itself is called.  Inside the function, <code>this</code> is set to the object we’re constructing.  (Why?  Because that’s what Java does.)  So,</p>
<pre style="word-wrap: break-word; border: 1px solid rgb(221, 221, 221); padding: 10px; background: rgb(246, 246, 246);"><code>var Vehicle = function Vehicle(color) {
  this.constructor;       // function Vehicle()
  this.color = color;
}

(new Vehicle("tan")).color;   // "tan"
</code></pre>
<blockquote>
<p><em>Side note</em>: Above, I said the use of the <code>new</code> keyword returned the constructed object.  This is correct <em>unless</em> the constructor returns something explicitly.  Then <em>that</em> object is returned, and the constructed object is just dropped.  But really.  JavaScript slaves over a hot CPU to create this object for you and then you just throw it away?  Rude.  And confusing to people who use your constructor.  So unless you have a really good reason, don’t return anything from constructor functions.</p>
</blockquote>
<h3>Putting it all together</h3>
<p>Given this tool, here’s one way (the intended way, but not the only way) to implement something like classes in JavaScript.</p>
<pre style="word-wrap: break-word; border: 1px solid rgb(221, 221, 221); padding: 10px; background: rgb(246, 246, 246);"><code>// Class definition / constructor
var Vehicle = function Vehicle(color) {
  // Initialization
  this.color = color;
}

// Instance methods
Vehicle.prototype = {
  go: function go() {
    return "Vroom!";
  }
}
</code></pre>
<h3>“Subclassing”</h3>
<p>This “pseudoclassical” style doesn’t have an exact way to make subclasses, but it comes close.  We can set the prototype of our “subclass” to an instance of the “superclass”.</p>
<pre style="word-wrap: break-word; border: 1px solid rgb(221, 221, 221); padding: 10px; background: rgb(246, 246, 246);"><code>var Car = function Car() {};
Car.prototype = new Vehicle("tan");
Car.prototype.honk = function honk() { return "BEEP!" };
var car = new Car();
car.honk();             // "BEEP!"
car.go();               // "Vroom!"
car.color;              // "tan"
car instanceof Car;     // true
car instanceof Vehicle; // true
</code></pre>
<p>Now, there’s a problem here.  The <code>Vehicle</code> constructor only gets called once, to set up <code>Car</code>‘s prototype.  We need to give it a color there.  We can’t make different cars have different colors, which is not ideal.  Some JavaScript frameworks have gotten around this by defining their own implementations of classes.</p>
<h3>And for my last trick…</h3>
<p>Sometimes you don’t want a notion of classes.  Sometimes you just want one object to inherit the properties of another (but be able to override them).  This is how most prototype-based languages work, but not JavaScript.  At least, not without a little massaging.</p>
<p>This function lets us accomplish it.  It’s been tossed around for a long time and is sometimes called “<code>create</code>” and sometimes “<code>clone</code>” and sometimes other things.</p>
<pre style="word-wrap: break-word; border: 1px solid rgb(221, 221, 221); padding: 10px; background: rgb(246, 246, 246);"><code>function create(parent) {
  var F = function() {};
  F.prototype = parent;
  return new F();
}

var masterObject = {a: "masterObject value"}

var object1 = create(masterObject);
var object2 = create(masterObject);
var object3 = create(masterObject);
var object3.a = "overridden value";

object1.a; // "masterObject value"
object2.a; // "masterObject value"
object3.a; // "overridden value"

masterObject.a = "new masterObject value"

object1.a; // "new masterObject value"
object2.a; // "new masterObject value"
object3.a; // "overridden value"
</code></pre>
<h3>You said a mouthful.</h3>
<p>The JavaScript prototype chain is a little different than how most languages work, so it can be tricky understand.  It doesn’t make it any easier when JavaScript gets syntax that makes it looks more like other languages, like inheriting Java’s <code>new</code> operator.  But if you know what you’re doing, you can do some crazy-cool things with it.</p>
							</div>
			</div>
			<!--========================= END : POST		=============================-->
			<!--=========================			START : POST		=============================-->
		<div class="post-wrapper">
		<h1>Decoupling JS from the DOM</h1>
		<div class="post-26084 post type-post status-publish format-standard has-post-thumbnail hentry category-labs tag-architecture tag-html tag-javascript channel-labs channel-pivotal-labs">
								<p>There has been a big shift in the last few years toward javascript frameworks that dictate how we deal with the DOM. In this series I want to highlight the value in “progressive enhancement” style patterns when it comes to interacting with the DOM. Don’t get me wrong, I’m not saying the new ways are bad. There are still some takeaways from the, older, progressive enhancement style approach.</p>
<p>I have always appreciated the separation of concerns afforded by the “progressive enhancement” approach. Separating structure, behavior, and presentation makes sense from an organizational standpoint. The “progressive enhancement” approach of DOM scripting lends itself well to this. Ideally, the CSS and JS tend to have knowledge of the markup, but the markup does not have knowledge of the JS or CSS.</p>
<p>In the spirit of maintaining the separation I try to make my Javascript widgets HTML agnostic. For some this is overkill, but I want to underscore this approach as I have found it useful for many years. To achieve this just inject all the selectors needed by the component. jQuery plugins, Backbone views, etc. do this already for the base element. Taking that approach a step further is simple, just pass in the additional selectors needed for the widget to do its job.</p>
<p>Example:</p>
<pre style="word-wrap: break-word; border: 1px solid rgb(221, 221, 221); padding: 10px; background: rgb(246, 246, 246);"><code>
  var $form = $('form');
  var selectableList = new $.SelectableList($form, {
    $submitElement: $form.find('input[type="submit"]'),
    $titleElement: $form.find('h2'),
    checkboxSelector: 'input[type="checkbox"]',
    $checkboxElements: $form.find('input[type="checkbox"]')
  });
</code></pre>
<p>This buys the developer a couple things:</p>
<p>1. It forces diligence around how many selectors, DOM elements, etc. are used by the widget.<br>
2. It allows a component to be shared across interfaces with different markup.<br>
3. It makes testing easier as it allows the simplest possible HTML fixture data.</p>
<p>Below is an example implementation and test file (there is a dependency on jQuery):</p>
<pre style="word-wrap: break-word; border: 1px solid rgb(221, 221, 221); padding: 10px; background: rgb(246, 246, 246);"><code>
(function($){
  $.SelectableList = function(el, options){
    var base = this;

    base.$el = $(el);
    base.el = el;
    base.options = options;

    base.init = function(){
      base.toggleSubmit(false);
      base.bindEvents();
    };

    base.bindEvents = function() {
      base.$el.on('change', base.options.checkboxSelector, base.handleCheck);
    };

    base.handleCheck = function(e) {
      var count = base.getSelectedItemsCount()
      base.updateTitle(count);
      base.toggleSubmit(count);
    };

    base.toggleSubmit = function(enabled) {
      base.options.$submitElement.prop('disabled', !enabled);
    };

    base.updateTitle = function(count) {
      base.options.$titleElement.html(count + ' members selected')
    };

    base.getSelectedItemsCount = function() {
      return base.options.$checkboxElements.filter(':checked').length;
    };
  };
})(jQuery);
</code></pre>
<pre style="word-wrap: break-word; border: 1px solid rgb(221, 221, 221); padding: 10px; background: rgb(246, 246, 246);"><code>
describe("$.SelectableList", function() {
  var selectableList,
      $titleElement,
      $submitInput

  beforeEach(function() {
    var fixtureHTML = "&lt;form id='test_form'&gt;" +
      "&lt;h2&gt;Select Tribe members&lt;/h2&gt;" +
      "&lt;ul&gt;" +
        "&lt;li&gt;&lt;input type='checkbox' /&gt;Phife&lt;/li&gt;" +
        "&lt;li&gt;&lt;input type='checkbox' /&gt;Q-tip&lt;/li&gt;" +
        "&lt;li&gt;&lt;input type='checkbox' /&gt;Ali&lt;/li&gt;" +
        "&lt;li&gt;&lt;input type='checkbox' /&gt;Jarobi&lt;/li&gt;" +
      "&lt;/ul&gt;" +
      "&lt;input type='submit' value='Delete selected tribe members' /&gt;"
    "&lt;/form&gt;";

    $('body').append(fixtureHTML);

    $titleElement = $('#test_form h2');
    $submitInput = $('input[type="submit"]')

    var $form = $('form#test_form');
    selectableList = new $.SelectableList($form, {
      $titleElement: $form.find('h2'),
      $submitElement: $form.find('input[type="submit"]'),
      $checkboxElements: $form.find('input[type="checkbox"]'),
      checkboxSelector: 'input[type="checkbox"]'
    });
  });

  afterEach(function() {
    $('#test_form').remove();
  });

  describe('#init', function() {
    beforeEach(function() {
      selectableList.init();
    });

    it('disables the submit element', function() {
      expect($submitInput.is(':disabled')).toBe(true)
    });
  });

  describe('when more than one item has been selected', function() {
    beforeEach(function() {
      selectableList.init();
      $('ul li:first-child input').prop('checked', true).change();
      $('ul li:last-child input').prop('checked', true).change();
    });

    it('updates the title', function() {
      expect($titleElement.text()).toEqual('2 members selected');
    });

    it('enables the submit element', function() {
      expect($submitInput.is(':disabled')).toEqual(false);
    });
  });
});
</code></pre>

							</div>
			</div>
			<!--========================= END : POST		=============================-->
			<!--=========================			START : POST		=============================-->
		<div class="post-wrapper">
		<h1>JavaScript inheritance patterns			</h1>
		<h2>An overview and comparison</h2>
		<div class="section-inner layoutSingleColumn"><h2 name="1a99" id="1a99" class="graf--h2 graf--first">JavaScript inheritance patterns</h2><h3 name="70bc" id="70bc" class="graf--h3">An overview and comparison</h3><p name="647c" id="647c" class="graf--p graf--empty"><br></p><p name="b210" id="b210" class="graf--p">JavaScript is a very powerful language. So powerful, in fact, that there are multiple different ways of designing prototypes and instantiating objects. There are tradeoffs when using each different method, and I aim to assist newcomers to the language by clearing up the mess. This is a follow-up to my previous post, <a href="https://medium.com/@PitaJ/stop-classifying-javascript-4cc823dfbedf" data-href="https://medium.com/@PitaJ/stop-classifying-javascript-4cc823dfbedf" class="markup--anchor markup--p-anchor">Stop Classifying JavaScript</a>. I received many comments and responses asking for code examples, so here they are.</p><h4 name="4ed4" id="4ed4" class="graf--h4"><strong class="markup--strong markup--h4-strong">JavaScript has <em class="markup--em markup--h4-em">Prototypal Inheritance</em></strong></h4><p name="df44" id="df44" class="graf--p graf--empty"><br></p><p name="89a3" id="89a3" class="graf--p">This means that, in JavaScript, objects inherit from other objects. Basic objects in JavaScript, created with the <em class="markup--em markup--p-em">{ }</em> curly braces, have only one prototype: <em class="markup--em markup--p-em">Object.prototype. Object.prototype </em>is, in itself, an object, and all members of <em class="markup--em markup--p-em">Object.prototype</em> are accessible from all objects.</p><p name="f70c" id="f70c" class="graf--p">Basic arrays, created with the <em class="markup--em markup--p-em">[ ]</em> square brackets, have multiple prototypes, including <em class="markup--em markup--p-em">Object.prototype </em>and <em class="markup--em markup--p-em">Array.prototype. </em>This means that all members of <em class="markup--em markup--p-em">Object.prototype </em>and all members of <em class="markup--em markup--p-em">Array.prototype</em> are accessible as members of arrays. Any members that overlap, like&nbsp;<em class="markup--em markup--p-em">.valueOf </em>and&nbsp;<em class="markup--em markup--p-em">.toString, </em>are overridden by the closest prototype, <em class="markup--em markup--p-em">Array.prototype</em> in this case.</p><h4 name="c9f7" id="c9f7" class="graf--h4"><strong class="markup--strong markup--h4-strong">Prototype definitions and object instantiation</strong></h4><p name="ab81" id="ab81" class="graf--p graf--empty"><br></p><p name="471e" id="471e" class="graf--p"><strong class="markup--strong markup--p-strong">Method 1: Constructor pattern</strong></p><p name="ff05" id="ff05" class="graf--p">JavaScript has a special type of function called constructor functions, which act similarly to constructors in other languages. The are called mandatorily with the <em class="markup--em markup--p-em">new</em> keyword and bind the <em class="markup--em markup--p-em">this</em> keyword to the object being created by the constructor function. A typical constructor may look like this:</p><pre name="282c" id="282c" class="graf--pre">function Animal(type){<br>  this.type = type;<br>}<br>Animal.isAnimal = function(obj, type){<br>  if(!Animal.prototype.isPrototypeOf(obj)){<br>    return false;<br>  }<br>  return type ? obj.type === type : true;<br>};</pre><pre name="5f70" id="5f70" class="graf--pre">function Dog(name, breed){<br>  Animal.call(this, "dog");<br>  this.name = name;<br>  this.breed = breed;<br>}<br>Object.setPrototypeOf(Dog.prototype, Animal.prototype);<br>Dog.prototype.bark = function(){<br>  console.log("ruff, ruff");<br>};<br>Dog.prototype.print = function(){<br>  console.log("The dog " + this.name + " is a " + this.breed);<br>};</pre><pre name="5b26" id="5b26" class="graf--pre">Dog.isDog = function(obj){<br>  return Animal.isAnimal(obj, "dog");<br>};</pre><p name="e0d6" id="e0d6" class="graf--p">The usage of this constructor looks like instantiation in other languages:</p><pre name="1519" id="1519" class="graf--pre">var sparkie = new Dog("Sparkie", "Border Collie");</pre><pre name="869d" id="869d" class="graf--pre">sparkie.name;    // "Sparkie"<br>sparkie.breed;   // "Border Collie"<br>sparkie.bark();  // console: "ruff, ruff"<br>sparkie.print(); // console: "The dog Sparkie is a Border Collie"</pre><pre name="3ca8" id="3ca8" class="graf--pre">Dog.isDog(sparkie); // true</pre><p name="e73e" id="e73e" class="graf--p"><em class="markup--em markup--p-em">bark</em> and <em class="markup--em markup--p-em">print</em> are prototype methods which apply to all dogs. The <em class="markup--em markup--p-em">name </em>and <em class="markup--em markup--p-em">breed</em> properties are own properties that are set by the constructor. Usually, all methods are set in the prototype and all properties are set by the constructor.</p><p name="e07f" id="e07f" class="graf--p"><strong class="markup--strong markup--p-strong">Method 2: ES2015 (ES6) Class definitions</strong></p><p name="2b2a" id="2b2a" class="graf--p"><em class="markup--em markup--p-em">class</em> has been a reserved keyword in JavaScript since the beginning, and now there is finally a use for it. Class definitions in JavaScript look a lot like they do in other languages.</p><pre name="993b" id="993b" class="graf--pre">class Animal {<br>  constructor(type){<br>    this.type = type;<br>  }<br>  static isAnimal(obj, type){<br>    if(!Animal.prototype.isPrototypeOf(obj)){<br>      return false;<br>    }<br>    return type ? obj.type === type : true;<br>  }<br>}</pre><pre name="83a9" id="83a9" class="graf--pre">class Dog extends Animal {<br>  constructor(name, breed){<br>    super("dog");<br>    this.name = name;<br>    this.breed = breed;<br>  }<br>  bark(){<br>    console.log("ruff, ruff");<br>  }<br>  print(){<br>    console.log("The dog " + this.name + " is a " + this.breed);<br>  }<br>  static isDog(obj){<br>    return Animal.isAnimal(obj, "dog");<br>  }<br>}</pre><p name="4807" id="4807" class="graf--p">A lot of people like this syntax because it combines the constructor, static, and the prototype method declarations into one nice block. The usage is exactly the same as the Constructor method.</p><pre name="d005" id="d005" class="graf--pre">var sparkie = new Dog("Sparkie", "Border Collie");</pre><p name="f76b" id="f76b" class="graf--p"><strong class="markup--strong markup--p-strong">Method 3: Explicit prototype declaration, Object.create, method factory</strong></p><p name="fd7c" id="fd7c" class="graf--p">This method really displays the prototypal inheritance behind the workings of the <em class="markup--em markup--p-em">class </em>syntax, and allows for the omittance of the <em class="markup--em markup--p-em">new </em>keyword.</p><pre name="ead7" id="ead7" class="graf--pre">var Animal = {<br>  create(type){<br>    var animal = Object.create(Animal.prototype);<br>    animal.type = type;<br>    return animal;<br>  },<br>  isAnimal(obj, type){<br>    if(!Animal.prototype.isPrototypeOf(obj)){<br>      return false;<br>    }<br>    return type ? obj.type === type : true;<br>  },<br>  prototype: {}<br>};</pre><pre name="85fc" id="85fc" class="graf--pre">var Dog = {<br>  create(name, breed){<br>    var dog = Object.create(Dog.prototype); <br>    Object.assign(dog, Animal.create("dog"));<br>    dog.name = name;<br>    dog.breed = breed;<br>    return dog;<br>  },<br>  isDog(obj){<br>    return Animal.isAnimal(obj, "dog");<br>  },<br>  prototype: {<br>    bark(){<br>      console.log("ruff, ruff");<br>    },<br>    print(){<br>      console.log("The dog " + this.name + " is a " + this.breed);<br>    }<br>  }<br>};</pre><pre name="4a03" id="4a03" class="graf--pre">Object.setPrototypeOf(Dog.prototype, Animal.prototype);</pre><p name="d6fb" id="d6fb" class="graf--p">This syntax is nice because the prototypes are very explicitly defined. It is very clear exactly which are members of the prototype and which are members of the object. <em class="markup--em markup--p-em">Object.create</em> is nice because it allows the creation of an object with a specific prototype. The&nbsp;<em class="markup--em markup--p-em">.isPrototypeOf</em> check still works in both cases. The usage is different, but not incredible different:</p><pre name="50c3" id="50c3" class="graf--pre">var sparkie = Dog.create("Sparkie", "Border Collie");</pre><pre name="5187" id="5187" class="graf--pre">sparkie.name;    // "Sparkie"<br>sparkie.breed;   // "Border Collie"<br>sparkie.bark();  // console: "ruff, ruff"<br>sparkie.print(); // console: "The dog Sparkie is a Border Collie"</pre><pre name="9168" id="9168" class="graf--pre">Dog.isDog(sparkie); // true</pre><p name="2865" id="2865" class="graf--p"><strong class="markup--strong markup--p-strong">Method 4: Object.create, top-level factory, prototype post-declaration</strong></p><p name="c8e4" id="c8e4" class="graf--p">This method is a slight variation of Method 3, where the factory is the class, versus the class being an object with a factory method. It looks like the constructor example (Method 1), but uses factories and <em class="markup--em markup--p-em">Object.create</em> instead.</p><pre name="1caf" id="1caf" class="graf--pre">function Animal(type){<br>  var animal = Object.create(Animal.prototype);<br>  animal.type = type;<br>  return animal;<br>}<br>Animal.isAnimal = function(obj, type){<br>  if(!Animal.prototype.isPrototypeOf(obj)){<br>    return false;<br>  }<br>  return type ? obj.type === type : true;<br>};<br>Animal.prototype = {};</pre><pre name="c621" id="c621" class="graf--pre">function Dog(name, breed){<br>  var dog = Object.create(Dog.prototype);<br>  Object.assign(dog, Animal("dog"));<br>  dog.<span class="markup--quote markup--pre-quote is-other" name="anon_7db36c88c84" data-creator-ids="anon">name </span>= name;<br>  dog.breed = breed;<br>  return dog;<br>}<br>Dog.isDog = function(obj){<br>  return Animal.isAnimal(obj, "dog");<br>};<br>Dog.prototype = {<br>  bark(){<br>    console.log("ruff, ruff");<br>  },<br>  print(){<br>    console.log("The dog " + this.name + " is a " + this.breed);<br>  }<br>};</pre><pre name="853e" id="853e" class="graf--pre">Object.setPrototypeOf(Dog.prototype, Animal.prototype);</pre><p name="6187" id="6187" class="graf--p">This method is nice because it’s usage looks like Method 1, but does not require the <em class="markup--em markup--p-em">new</em> keyword and works with <em class="markup--em markup--p-em">instanceof. </em>The usage is the same as the first method, but without the <em class="markup--em markup--p-em">new:</em></p><pre name="59cd" id="59cd" class="graf--pre">var sparkie = Dog("Sparkie", "Border Collie");</pre><pre name="fcd6" id="fcd6" class="graf--pre">sparkie.name;    // "Sparkie"<br>sparkie.breed;   // "Border Collie"<br>sparkie.bark();  // console: "ruff, ruff"<br>sparkie.print(); // console: "The dog Sparkie is a Border Collie"</pre><pre name="2f05" id="2f05" class="graf--pre">Dog.isDog(sparkie); // true</pre><h4 name="f06c" id="f06c" class="graf--h4">Comparison</h4><p name="f0cf" id="f0cf" class="graf--p graf--empty"><br></p><p name="a0e7" id="a0e7" class="graf--p"><strong class="markup--strong markup--p-strong">Method 1 vs Method 4</strong></p><p name="de1c" id="de1c" class="graf--p">There is very little reason to use Method 1 over Method 4. Method 1 requires either the use of <em class="markup--em markup--p-em">new</em> in your code or a check like this in the constructor:</p><pre name="0c76" id="0c76" class="graf--pre">if(!(this instanceof Foo)){ <br>  return new Foo(a, b, c);<br>}</pre><p name="1898" id="1898" class="graf--p">At which point you may as well just use <em class="markup--em markup--p-em">Object.create </em>in a factory. You also can’t use <em class="markup--em markup--p-em">Function#call </em>or <em class="markup--em markup--p-em">Function#apply </em>on constructor functions, because they mess up <em class="markup--em markup--p-em">this</em>. The check above could remedy that issue as well, but if you want to use an unknown amount of arguments, you have to use a factory.</p><p name="15bb" id="15bb" class="graf--p"><strong class="markup--strong markup--p-strong">Method 2 vs Method 3</strong></p><p name="89c1" id="89c1" class="graf--p">The same arguments about constructors and <em class="markup--em markup--p-em">new</em> that applied above apply to this as well. The <em class="markup--em markup--p-em">instanceof </em>check is necessary for using the <em class="markup--em markup--p-em">class</em> syntax without <em class="markup--em markup--p-em">new </em>or with <em class="markup--em markup--p-em">Function#apply </em>and <em class="markup--em markup--p-em">Function#call</em>.</p><h4 name="233e" id="233e" class="graf--h4">My opinion</h4><p name="8aeb" id="8aeb" class="graf--p graf--empty"><br></p><p name="f593" id="f593" class="graf--p">A programmer should strive for code clarity. Method 3's explicit syntax very clearly shows exactly what is going on. It also allows for easy multiple inheritance and concatenative inheritance. Since using the <em class="markup--em markup--p-em">new</em> keyword violates the open-closed principle due to incompatibility with <em class="markup--em markup--p-em">apply </em>or <em class="markup--em markup--p-em">call, </em>it should be avoided. The <em class="markup--em markup--p-em">class</em> keyword hides the prototypal nature of JavaScript’s inheritance behind the guise of a classical system.</p><blockquote name="8383" id="8383" class="graf--blockquote graf--startsWithDoubleQuote">“Simple is better than clever,” and using classical syntax because it is considered to be more “sophisticated” is just unnecessary, technical overhead.</blockquote><p name="0614" id="0614" class="graf--p"><em class="markup--em markup--p-em">Object.create</em> is more expressive and clearer than a bound <em class="markup--em markup--p-em">this</em> variable and <em class="markup--em markup--p-em">new</em>. Also, the prototype is stored in an object possibly outside the scope of the factory itself, so it can be modified and improved more easily and with <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Functions/Method_definitions" data-href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Functions/Method_definitions" class="markup--anchor markup--p-anchor" rel="nofollow"><em class="markup--em markup--p-em">method definition</em></a><em class="markup--em markup--p-em"> </em>syntax, just like ES6 classes.</p><blockquote name="4bf8" id="4bf8" class="graf--blockquote">The class keyword will probably be the most harmful feature in JavaScript. I have enormous respect for the brilliant and hard-working people who have been involved in the standardization effort, but even brilliant people occasionally do the wrong thing. - Eric Elliott</blockquote><p name="9902" id="9902" class="graf--p">Adding something which is unnecessary, possibly damaging, and counter to the very nature of the language is a bad move.</p><p name="d96d" id="d96d" class="graf--p">If you choose to use <em class="markup--em markup--p-em">class, </em>I hope I never have to try to maintain your code. In my opinion, developers should avoid the use of constructors<em class="markup--em markup--p-em">, class, </em>and <em class="markup--em markup--p-em">new, </em>and use methods of inheritance which more closely follow the language architecture.</p><h4 name="beac" id="beac" class="graf--h4">Glossary</h4><p name="85db" id="85db" class="graf--p graf--empty"><br></p><p name="9b4d" id="9b4d" class="graf--p"><em class="markup--em markup--p-em">Object.assign(a, b) </em>copies all enumerable properties of object <em class="markup--em markup--p-em">b </em>onto object <em class="markup--em markup--p-em">a </em>and then returns object <em class="markup--em markup--p-em">a</em></p><p name="e4aa" id="e4aa" class="graf--p"><em class="markup--em markup--p-em">Object.create(proto) </em>creates a new bare object with the prototype <em class="markup--em markup--p-em">proto</em></p><p name="b858" id="b858" class="graf--p graf--last"><em class="markup--em markup--p-em">Object.setPrototypeOf(obj, proto) </em>sets the internal <em class="markup--em markup--p-em">[[Prototype]] </em>property of <em class="markup--em markup--p-em">obj</em> to <em class="markup--em markup--p-em">proto</em></p></div>
			</div>
			<!--========================= END : POST		=============================-->
			<!--=========================			START : POST		=============================-->
		<div class="post-wrapper">
		<h1>Method Chaining in JavaScript</h1>
		<section><p>Method chaining is a common pattern in the JavaScript world. This tutorial will provide a brief explanation of what method chaining is, give a real world example of how jQuery uses method chaining, and teach you how to add method chaining to your own classes. Let's get started.</p><h2 id="what-is-method-chaining-">What is Method Chaining?</h2><p>Method chaining is a technique that can be used to simplify code in scenarios that involve calling multiple functions on the same object consecutively. This is an example of how you can use method chaining when using jQuery.</p><pre><code class="lang-javascript"><div class="highlight"><pre><span class="cm">/** Example of method chaining in jQuery */</span>


<span class="c1">//////////////////////////</span>
<span class="c1">// WITHOUT METHOD CHAINING</span>

<span class="kd">var</span> <span class="nx">$div</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="s1">'#my-div'</span><span class="p">);</span>         <span class="c1">// assign to var</span>

<span class="nx">$div</span><span class="p">.</span><span class="nx">css</span><span class="p">(</span><span class="s1">'background'</span><span class="p">,</span> <span class="s1">'blue'</span><span class="p">);</span>  <span class="c1">// set BG</span>
<span class="nx">$div</span><span class="p">.</span><span class="nx">height</span><span class="p">(</span><span class="mi">100</span><span class="p">);</span>                <span class="c1">// set height</span>
<span class="nx">$div</span><span class="p">.</span><span class="nx">fadeIn</span><span class="p">(</span><span class="mi">200</span><span class="p">);</span>                <span class="c1">// show element</span>


<span class="c1">///////////////////////</span>
<span class="c1">// WITH METHOD CHAINING</span>

<span class="nx">$</span><span class="p">(</span><span class="s1">'#my-div'</span><span class="p">).</span><span class="nx">css</span><span class="p">(</span><span class="s1">'background'</span><span class="p">,</span> <span class="s1">'blue'</span><span class="p">).</span><span class="nx">height</span><span class="p">(</span><span class="mi">100</span><span class="p">).</span><span class="nx">fadeIn</span><span class="p">(</span><span class="mi">200</span><span class="p">);</span>

<span class="c1">// often broken to multiple lines:</span>
<span class="nx">$</span><span class="p">(</span><span class="s1">'#my-div'</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">css</span><span class="p">(</span><span class="s1">'background'</span><span class="p">,</span> <span class="s1">'blue'</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">height</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">fadeIn</span><span class="p">(</span><span class="mi">200</span><span class="p">);</span>
</pre></div>

</code></pre><p>As you can see, using method chaining can tidy up code quite a bit, however some developers dislike the visual style of method chaining and choose not to use it.</p><h2 id="understanding-method-chaining">Understanding Method Chaining</h2><p>For our example, we will define a custom class with a few methods to call. Let's create a <code>Kitten</code> class:</p><pre><code class="lang-javascript"><div class="highlight"><pre><span class="c1">// define the class</span>
<span class="kd">var</span> <span class="nx">Kitten</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">name</span> <span class="o">=</span> <span class="s1">'Garfield'</span><span class="p">;</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">color</span> <span class="o">=</span> <span class="s1">'brown'</span><span class="p">;</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">gender</span> <span class="o">=</span> <span class="s1">'male'</span><span class="p">;</span>
<span class="p">};</span>

<span class="nx">Kitten</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">setName</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">name</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">name</span> <span class="o">=</span> <span class="nx">name</span><span class="p">;</span>
<span class="p">};</span>

<span class="nx">Kitten</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">setColor</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">color</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">color</span> <span class="o">=</span> <span class="nx">color</span><span class="p">;</span>
<span class="p">};</span>

<span class="nx">Kitten</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">setGender</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">gender</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">gender</span> <span class="o">=</span> <span class="nx">gender</span><span class="p">;</span>
<span class="p">};</span>

<span class="nx">Kitten</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">save</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span>
    <span class="s1">'saving '</span> <span class="o">+</span> <span class="k">this</span><span class="p">.</span><span class="nx">name</span> <span class="o">+</span> <span class="s1">', the '</span> <span class="o">+</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">color</span> <span class="o">+</span> <span class="s1">' '</span> <span class="o">+</span> <span class="k">this</span><span class="p">.</span><span class="nx">gender</span> <span class="o">+</span> <span class="s1">' kitten...'</span>
  <span class="p">);</span>

  <span class="c1">// save to database here...</span>
<span class="p">};</span>
</pre></div>

</code></pre><p>Now, let's instantiate a kitten object from our class and call its methods.</p><pre><code class="lang-javascript"><div class="highlight"><pre><span class="kd">var</span> <span class="nx">bob</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Kitten</span><span class="p">();</span>

<span class="nx">bob</span><span class="p">.</span><span class="nx">setName</span><span class="p">(</span><span class="s1">'Bob'</span><span class="p">);</span>
<span class="nx">bob</span><span class="p">.</span><span class="nx">setColor</span><span class="p">(</span><span class="s1">'black'</span><span class="p">);</span>
<span class="nx">bob</span><span class="p">.</span><span class="nx">setGender</span><span class="p">(</span><span class="s1">'male'</span><span class="p">);</span>

<span class="nx">bob</span><span class="p">.</span><span class="nx">save</span><span class="p">();</span>

<span class="c1">// OUTPUT:</span>
<span class="c1">// &gt; saving Bob, the black male kitten...</span>
</pre></div>

</code></pre><p>Wouldn't it be better if we could get rid of some of this repetition? Method chaining would be perfect for this. The only problem is that currently this won't work. Here is why:</p><pre><code class="lang-javascript"><div class="highlight"><pre><span class="kd">var</span> <span class="nx">bob</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Kitten</span><span class="p">();</span>

<span class="nx">bob</span><span class="p">.</span><span class="nx">setName</span><span class="p">(</span><span class="s1">'Bob'</span><span class="p">).</span><span class="nx">setColor</span><span class="p">(</span><span class="s1">'black'</span><span class="p">);</span>

<span class="c1">// ERROR:</span>
<span class="c1">// &gt; Uncaught TypeError: Cannot call method 'setColor' of undefined</span>
</pre></div>

</code></pre><p>To better understand why this doesn't work, we will rearrange the code above slightly.</p><pre><code class="lang-javascript"><div class="highlight"><pre><span class="kd">var</span> <span class="nx">bob</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Kitten</span><span class="p">();</span>

<span class="kd">var</span> <span class="nx">tmp</span> <span class="o">=</span> <span class="nx">bob</span><span class="p">.</span><span class="nx">setName</span><span class="p">(</span><span class="s1">'Bob'</span><span class="p">);</span>
<span class="nx">tmp</span><span class="p">.</span><span class="nx">setColor</span><span class="p">(</span><span class="s1">'black'</span><span class="p">);</span>

<span class="c1">// ERROR:</span>
<span class="c1">// &gt; Uncaught TypeError: Cannot call method 'setColor' of undefined</span>
</pre></div>

</code></pre><p>This returns the same error. This is because the <code>setName()</code> function doesn't return a value, so <code>tmp</code> is assigned the value of <code>undefined</code>. The typical way to enable method chaining is to return the current object at the end of every function.</p><h2 id="implementing-method-chaining">Implementing Method Chaining</h2><p>Let's rewrite the <code>Kitten</code> class with the ability to chain methods.</p><pre><code class="lang-javascript"><div class="highlight"><pre><span class="c1">// define the class</span>
<span class="kd">var</span> <span class="nx">Kitten</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">name</span> <span class="o">=</span> <span class="s1">'Garfield'</span><span class="p">;</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">color</span> <span class="o">=</span> <span class="s1">'brown'</span><span class="p">;</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">gender</span> <span class="o">=</span> <span class="s1">'male'</span><span class="p">;</span>
<span class="p">};</span>

<span class="nx">Kitten</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">setName</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">name</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">name</span> <span class="o">=</span> <span class="nx">name</span><span class="p">;</span>
  <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
<span class="p">};</span>

<span class="nx">Kitten</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">setColor</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">color</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">color</span> <span class="o">=</span> <span class="nx">color</span><span class="p">;</span>
  <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
<span class="p">};</span>

<span class="nx">Kitten</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">setGender</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">gender</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">gender</span> <span class="o">=</span> <span class="nx">gender</span><span class="p">;</span>
  <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
<span class="p">};</span>

<span class="nx">Kitten</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">save</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span>
    <span class="s1">'saving '</span> <span class="o">+</span> <span class="k">this</span><span class="p">.</span><span class="nx">name</span> <span class="o">+</span> <span class="s1">', the '</span> <span class="o">+</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">color</span> <span class="o">+</span> <span class="s1">' '</span> <span class="o">+</span> <span class="k">this</span><span class="p">.</span><span class="nx">gender</span> <span class="o">+</span> <span class="s1">' kitten...'</span>
  <span class="p">);</span>

  <span class="c1">// save to database here...</span>

  <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>

</code></pre><p>Now, if we rerun the previous snippet, the variable <code>tmp</code> will reference the same object as the variable <code>bob</code>, like so:</p><pre><code class="lang-javascript"><div class="highlight"><pre><span class="kd">var</span> <span class="nx">bob</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Kitten</span><span class="p">();</span>

<span class="kd">var</span> <span class="nx">tmp</span> <span class="o">=</span> <span class="nx">bob</span><span class="p">.</span><span class="nx">setName</span><span class="p">(</span><span class="s1">'Bob'</span><span class="p">);</span>
<span class="nx">tmp</span><span class="p">.</span><span class="nx">setColor</span><span class="p">(</span><span class="s1">'black'</span><span class="p">);</span>

<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">tmp</span> <span class="o">===</span> <span class="nx">bob</span><span class="p">);</span>

<span class="c1">// OUTPUT:</span>
<span class="c1">// &gt; true</span>
</pre></div>

</code></pre><p>To shorten this even more, we do not even need to create the variable <code>bob</code>. Here are two examples with and without method chaining on our new class:</p><pre><code class="lang-javascript"><div class="highlight"><pre><span class="c1">///////////////////</span>
<span class="c1">// WITHOUT CHAINING</span>

<span class="kd">var</span> <span class="nx">bob</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Kitten</span><span class="p">();</span>

<span class="nx">bob</span><span class="p">.</span><span class="nx">setName</span><span class="p">(</span><span class="s1">'Bob'</span><span class="p">);</span>
<span class="nx">bob</span><span class="p">.</span><span class="nx">setColor</span><span class="p">(</span><span class="s1">'black'</span><span class="p">);</span>
<span class="nx">bob</span><span class="p">.</span><span class="nx">setGender</span><span class="p">(</span><span class="s1">'male'</span><span class="p">);</span>

<span class="nx">bob</span><span class="p">.</span><span class="nx">save</span><span class="p">();</span>

<span class="c1">// OUTPUT:</span>
<span class="c1">// &gt; saving Bob, the black male kitten...</span>


<span class="c1">///////////////////</span>
<span class="c1">// WITH CHAINING</span>

<span class="k">new</span> <span class="nx">Kitten</span><span class="p">()</span>
  <span class="p">.</span><span class="nx">setName</span><span class="p">(</span><span class="s1">'Bob'</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">setColor</span><span class="p">(</span><span class="s1">'black'</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">setGender</span><span class="p">(</span><span class="s1">'male'</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">save</span><span class="p">();</span>

<span class="c1">// OUTPUT:</span>
<span class="c1">// &gt; saving Bob, the black male kitten...</span>
</pre></div>

</code></pre><p>By using method chaining we end up with much cleaner code that is easier to understand.</p><h2 id="conclusion">Conclusion</h2><p>That's it! Method chaining can be a very useful technique to have in your bag of programming tools. If you have any questions, let me know in the comments below.</p><hr><p><em><a href="https://plus.google.com/116591626596369246536/posts">Martin Mauchauffée</a> and <a href="https://plus.google.com/u/0/105471318664923408342">Manu Delgado Diaz</a> pointed out that this is also known as the <a href="http://en.wikipedia.org/wiki/Fluent_interface">Fluent Interface</a> pattern.</em></p><p><em><a href="https://plus.google.com/u/0/+%D0%AE%D1%80%D0%B8%D0%B9%D0%A2%D0%B0%D1%80%D0%B0%D0%B1%D0%B0%D0%BD%D1%8C%D0%BA%D0%BE/posts">Юрий Тарабанько</a> came up with a great way to automate the addition of <code>return this;</code>. Check out his <code>chainify()</code> function in this <a href="http://jsfiddle.net/tarabyte/4C4Lu/">Fiddle</a></em></p></section>
			</div>
			<!--========================= END : POST		=============================-->
			<!--=========================			START : POST		=============================-->
		<div class="post-wrapper">
		<div class="post-inner group">
					
					<h1 class="post-title">JavaScript Objects and Arrays Useful Methods</h1>
					
					
										
					
					
					<div class="entry">	
						<div class="entry-inner">
							<p>JavaScript Objects and Arrays have many use-ful meth-ods that can help you write clean and main-tain-able code. In this post we will talk about fol-low-ing methods:</p>
<ul>
<li><code>Object.keys()</code></li>
<li><code>Array.prototype.forEach()</code> </li>
<li><code>Array.prototype.map()</code> <span class="amp">&amp;</span> <code>Array.prototype.reduce()</code></li>
<li><code>Array.prototype.push()</code> <span class="amp">&amp;</span> <code>Array.prototype.shift()</code></li>
</ul>
<p>We will first see a few quick exam-ples of each of the above meth-ods and even-tu-ally we will solve a real world interview-style prob-lem using these methods.</p>
<hr>
<h4>Object.keys()</h4>
<p>It returns an array of enu-mer-able prop-er-ties of an object. The advan-tage of using <code>Object.keys()</code> over <code>for ... in</code> is that, it does not look up in the pro-to-typ-i-cal inher-i-tance chain of the given object.</p>
<h5>Syn-tax : Object.keys(obj)</h5>
<h5>Input : valid JavaScript Object (either array or&nbsp;<span class="caps">JSON</span>)</h5>
<h5>Out-put : an&nbsp;array</h5>
<script src="https://gist.github.com/51a89cde8b6097bea242.js?file=keys.js"></script><link rel="stylesheet" href="https://assets-cdn.github.com/assets/gist/embed-3313cb70789df61d3bb75cd878325a1266ccab50b6aac9b80f1691ae0694a216.css"><div id="gist26068146" class="gist">
    <div class="gist-file">
      <div class="gist-data">
        <div class="js-gist-file-update-container js-task-list-container file-box">
  <div id="file-keys-js" class="file">
    

  <div class="blob-wrapper data type-javascript">
      <table class="highlight tab-size js-file-line-container" data-tab-size="8">
      <tbody><tr>
        <td id="file-keys-js-L1" class="blob-num js-line-number" data-line-number="1"></td>
        <td id="file-keys-js-LC1" class="blob-code blob-code-inner js-file-line"><span class="pl-k">var</span> obj <span class="pl-k">=</span> { <span class="pl-s"><span class="pl-pds">'</span>skill<span class="pl-pds">'</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>javascript<span class="pl-pds">'</span></span>,</td>
      </tr>
      <tr class="alt">
        <td id="file-keys-js-L2" class="blob-num js-line-number" data-line-number="2"></td>
        <td id="file-keys-js-LC2" class="blob-code blob-code-inner js-file-line">            <span class="pl-s"><span class="pl-pds">'</span>user<span class="pl-pds">'</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>Bill<span class="pl-pds">'</span></span></td>
      </tr>
      <tr>
        <td id="file-keys-js-L3" class="blob-num js-line-number" data-line-number="3"></td>
        <td id="file-keys-js-LC3" class="blob-code blob-code-inner js-file-line">          };</td>
      </tr>
      <tr class="alt">
        <td id="file-keys-js-L4" class="blob-num js-line-number" data-line-number="4"></td>
        <td id="file-keys-js-LC4" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-keys-js-L5" class="blob-num js-line-number" data-line-number="5"></td>
        <td id="file-keys-js-LC5" class="blob-code blob-code-inner js-file-line"><span class="pl-en">console</span><span class="pl-c1">.log</span>(<span class="pl-c1">Object</span>.keys(obj)); <span class="pl-c">// ["skill", "user"]</span></td>
      </tr>
</tbody></table>

  </div>

  </div>
  
</div>

      </div>
      <div class="gist-meta">
        <a href="https://gist.github.com/kavitshah8/51a89cde8b6097bea242/raw/ee13c4b804acb1c36cd182c84ca032e4f463a727/keys.js" style="float:right">view raw</a>
        <a href="https://gist.github.com/kavitshah8/51a89cde8b6097bea242#file-keys-js">keys.js</a>
        hosted with ❤ by <a href="https://github.com">GitHub</a>
      </div>
    </div>
</div>

<hr>
<h4>Array.prototype.forEach()</h4>
<p>This meth-ods calls the call-back for each valid ele-ment in the array. The call-back has the access to the index vari-able which can be used to access the index of the ele-ment in the&nbsp;array.</p>
<h5>Syn-tax : arr.forEach(callback)</h5>
<script src="https://gist.github.com/51a89cde8b6097bea242.js?file=forEach.js"></script><link rel="stylesheet" href="https://assets-cdn.github.com/assets/gist/embed-3313cb70789df61d3bb75cd878325a1266ccab50b6aac9b80f1691ae0694a216.css"><div id="gist26068146" class="gist">
    <div class="gist-file">
      <div class="gist-data">
        <div class="js-gist-file-update-container js-task-list-container file-box">
  <div id="file-foreach-js" class="file">
    

  <div class="blob-wrapper data type-javascript">
      <table class="highlight tab-size js-file-line-container" data-tab-size="8">
      <tbody><tr class="alt">
        <td id="file-foreach-js-L1" class="blob-num js-line-number" data-line-number="1"></td>
        <td id="file-foreach-js-LC1" class="blob-code blob-code-inner js-file-line"><span class="pl-k">var</span> arr <span class="pl-k">=</span> [<span class="pl-s"><span class="pl-pds">'</span>javascript<span class="pl-pds">'</span></span>,<span class="pl-s"><span class="pl-pds">'</span>css<span class="pl-pds">'</span></span>,<span class="pl-s"><span class="pl-pds">'</span>html<span class="pl-pds">'</span></span>];</td>
      </tr>
      <tr>
        <td id="file-foreach-js-L2" class="blob-num js-line-number" data-line-number="2"></td>
        <td id="file-foreach-js-LC2" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr class="alt">
        <td id="file-foreach-js-L3" class="blob-num js-line-number" data-line-number="3"></td>
        <td id="file-foreach-js-LC3" class="blob-code blob-code-inner js-file-line"><span class="pl-k">function</span> <span class="pl-en">printSkill</span>(<span class="pl-smi">element</span>, <span class="pl-smi">index</span>) {</td>
      </tr>
      <tr>
        <td id="file-foreach-js-L4" class="blob-num js-line-number" data-line-number="4"></td>
        <td id="file-foreach-js-LC4" class="blob-code blob-code-inner js-file-line">	<span class="pl-en">console</span><span class="pl-c1">.log</span>(element <span class="pl-k">+</span> <span class="pl-s"><span class="pl-pds">'</span> is the <span class="pl-pds">'</span></span> <span class="pl-k">+</span> index <span class="pl-k">+</span> <span class="pl-s"><span class="pl-pds">'</span> element in the array<span class="pl-pds">'</span></span>);</td>
      </tr>
      <tr class="alt">
        <td id="file-foreach-js-L5" class="blob-num js-line-number" data-line-number="5"></td>
        <td id="file-foreach-js-LC5" class="blob-code blob-code-inner js-file-line">}</td>
      </tr>
      <tr>
        <td id="file-foreach-js-L6" class="blob-num js-line-number" data-line-number="6"></td>
        <td id="file-foreach-js-LC6" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr class="alt">
        <td id="file-foreach-js-L7" class="blob-num js-line-number" data-line-number="7"></td>
        <td id="file-foreach-js-LC7" class="blob-code blob-code-inner js-file-line">arr.forEach(printSkill);</td>
      </tr>
</tbody></table>

  </div>

  </div>
  
</div>

      </div>
      <div class="gist-meta">
        <a href="https://gist.github.com/kavitshah8/51a89cde8b6097bea242/raw/ee13c4b804acb1c36cd182c84ca032e4f463a727/forEach.js" style="float:right">view raw</a>
        <a href="https://gist.github.com/kavitshah8/51a89cde8b6097bea242#file-foreach-js">forEach.js</a>
        hosted with ❤ by <a href="https://github.com">GitHub</a>
      </div>
    </div>
</div>

<hr>
<h4>Array.prototype.map()</h4>
<p>It calls the call-back on each valid ele-ment of an array and returns a new result-ing&nbsp;array.</p>
<h5>Syn-tax : arr.map(callback)</h5>
<h5>Out-put :&nbsp;array</h5>
<script src="https://gist.github.com/51a89cde8b6097bea242.js?file=map.js"></script><link rel="stylesheet" href="https://assets-cdn.github.com/assets/gist/embed-3313cb70789df61d3bb75cd878325a1266ccab50b6aac9b80f1691ae0694a216.css"><div id="gist26068146" class="gist">
    <div class="gist-file">
      <div class="gist-data">
        <div class="js-gist-file-update-container js-task-list-container file-box">
  <div id="file-map-js" class="file">
    

  <div class="blob-wrapper data type-javascript">
      <table class="highlight tab-size js-file-line-container" data-tab-size="8">
      <tbody><tr>
        <td id="file-map-js-L1" class="blob-num js-line-number" data-line-number="1"></td>
        <td id="file-map-js-LC1" class="blob-code blob-code-inner js-file-line"><span class="pl-k">var</span> arr <span class="pl-k">=</span> [<span class="pl-s"><span class="pl-pds">'</span>10<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>20<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>30<span class="pl-pds">'</span></span>];</td>
      </tr>
      <tr class="alt">
        <td id="file-map-js-L2" class="blob-num js-line-number" data-line-number="2"></td>
        <td id="file-map-js-LC2" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-map-js-L3" class="blob-num js-line-number" data-line-number="3"></td>
        <td id="file-map-js-LC3" class="blob-code blob-code-inner js-file-line"><span class="pl-k">function</span> <span class="pl-en">returnCube</span>(<span class="pl-smi">ele</span>) {</td>
      </tr>
      <tr class="alt">
        <td id="file-map-js-L4" class="blob-num js-line-number" data-line-number="4"></td>
        <td id="file-map-js-LC4" class="blob-code blob-code-inner js-file-line">     <span class="pl-k">return</span> ele <span class="pl-k">*</span> ele <span class="pl-k">*</span> ele;</td>
      </tr>
      <tr>
        <td id="file-map-js-L5" class="blob-num js-line-number" data-line-number="5"></td>
        <td id="file-map-js-LC5" class="blob-code blob-code-inner js-file-line">}</td>
      </tr>
      <tr class="alt">
        <td id="file-map-js-L6" class="blob-num js-line-number" data-line-number="6"></td>
        <td id="file-map-js-LC6" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-map-js-L7" class="blob-num js-line-number" data-line-number="7"></td>
        <td id="file-map-js-LC7" class="blob-code blob-code-inner js-file-line"><span class="pl-k">var</span> intArr <span class="pl-k">=</span> arr.map(returnCube); <span class="pl-c">// [1000, 8000, 27000]</span></td>
      </tr>
</tbody></table>

  </div>

  </div>
  
</div>

      </div>
      <div class="gist-meta">
        <a href="https://gist.github.com/kavitshah8/51a89cde8b6097bea242/raw/ee13c4b804acb1c36cd182c84ca032e4f463a727/map.js" style="float:right">view raw</a>
        <a href="https://gist.github.com/kavitshah8/51a89cde8b6097bea242#file-map-js">map.js</a>
        hosted with ❤ by <a href="https://github.com">GitHub</a>
      </div>
    </div>
</div>

<h4>Array.prototype.reduce()</h4>
<p>It calls the call-back on each valid ele-ment of an array and returns a sin-gle result-ing&nbsp;value.</p>
<h5>Syn-tax : arr.reduce(callback)</h5>
<h5>Out-put : sin-gle&nbsp;value</h5>
<script src="https://gist.github.com/51a89cde8b6097bea242.js?file=reduce.js"></script><link rel="stylesheet" href="https://assets-cdn.github.com/assets/gist/embed-3313cb70789df61d3bb75cd878325a1266ccab50b6aac9b80f1691ae0694a216.css"><div id="gist26068146" class="gist">
    <div class="gist-file">
      <div class="gist-data">
        <div class="js-gist-file-update-container js-task-list-container file-box">
  <div id="file-reduce-js" class="file">
    

  <div class="blob-wrapper data type-javascript">
      <table class="highlight tab-size js-file-line-container" data-tab-size="8">
      <tbody><tr class="alt">
        <td id="file-reduce-js-L1" class="blob-num js-line-number" data-line-number="1"></td>
        <td id="file-reduce-js-LC1" class="blob-code blob-code-inner js-file-line"><span class="pl-k">function</span> <span class="pl-en">returnSum</span>(<span class="pl-smi">previousValue</span>, <span class="pl-smi">currentValue</span>) {</td>
      </tr>
      <tr>
        <td id="file-reduce-js-L2" class="blob-num js-line-number" data-line-number="2"></td>
        <td id="file-reduce-js-LC2" class="blob-code blob-code-inner js-file-line">  <span class="pl-k">return</span> previousValue <span class="pl-k">+</span> currentValue;</td>
      </tr>
      <tr class="alt">
        <td id="file-reduce-js-L3" class="blob-num js-line-number" data-line-number="3"></td>
        <td id="file-reduce-js-LC3" class="blob-code blob-code-inner js-file-line">}</td>
      </tr>
      <tr>
        <td id="file-reduce-js-L4" class="blob-num js-line-number" data-line-number="4"></td>
        <td id="file-reduce-js-LC4" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr class="alt">
        <td id="file-reduce-js-L5" class="blob-num js-line-number" data-line-number="5"></td>
        <td id="file-reduce-js-LC5" class="blob-code blob-code-inner js-file-line"><span class="pl-k">var</span> sum <span class="pl-k">=</span> [<span class="pl-c1">0</span>, <span class="pl-c1">1</span>, <span class="pl-c1">2</span>, <span class="pl-c1">3</span>, <span class="pl-c1">4</span>].reduce(returnSum); </td>
      </tr>
      <tr>
        <td id="file-reduce-js-L6" class="blob-num js-line-number" data-line-number="6"></td>
        <td id="file-reduce-js-LC6" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr class="alt">
        <td id="file-reduce-js-L7" class="blob-num js-line-number" data-line-number="7"></td>
        <td id="file-reduce-js-LC7" class="blob-code blob-code-inner js-file-line"><span class="pl-en">console</span><span class="pl-c1">.log</span>(sum); <span class="pl-c">// 10</span></td>
      </tr>
</tbody></table>

  </div>

  </div>
  
</div>

      </div>
      <div class="gist-meta">
        <a href="https://gist.github.com/kavitshah8/51a89cde8b6097bea242/raw/ee13c4b804acb1c36cd182c84ca032e4f463a727/reduce.js" style="float:right">view raw</a>
        <a href="https://gist.github.com/kavitshah8/51a89cde8b6097bea242#file-reduce-js">reduce.js</a>
        hosted with ❤ by <a href="https://github.com">GitHub</a>
      </div>
    </div>
</div>

<hr>
<h4>Array.prototype.push()</h4>
<p>It returns the length of the new array and it adds the ele-ment at the end of the&nbsp;array.</p>
<h5>Syn-tax : arr.push(e1 ‚…,&nbsp;eN)</h5>
<h5>Out-put :&nbsp;array</h5>
<script src="https://gist.github.com/51a89cde8b6097bea242.js?file=push.js"></script><link rel="stylesheet" href="https://assets-cdn.github.com/assets/gist/embed-3313cb70789df61d3bb75cd878325a1266ccab50b6aac9b80f1691ae0694a216.css"><div id="gist26068146" class="gist">
    <div class="gist-file">
      <div class="gist-data">
        <div class="js-gist-file-update-container js-task-list-container file-box">
  <div id="file-push-js" class="file">
    

  <div class="blob-wrapper data type-javascript">
      <table class="highlight tab-size js-file-line-container" data-tab-size="8">
      <tbody><tr>
        <td id="file-push-js-L1" class="blob-num js-line-number" data-line-number="1"></td>
        <td id="file-push-js-LC1" class="blob-code blob-code-inner js-file-line"><span class="pl-k">var</span> arr <span class="pl-k">=</span> [<span class="pl-s"><span class="pl-pds">'</span>Bill<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>Chad<span class="pl-pds">'</span></span>];</td>
      </tr>
      <tr class="alt">
        <td id="file-push-js-L2" class="blob-num js-line-number" data-line-number="2"></td>
        <td id="file-push-js-LC2" class="blob-code blob-code-inner js-file-line">arr.<span class="pl-c1">push</span>(<span class="pl-s"><span class="pl-pds">'</span>Sue<span class="pl-pds">'</span></span>); <span class="pl-c">// 4</span></td>
      </tr>
      <tr>
        <td id="file-push-js-L3" class="blob-num js-line-number" data-line-number="3"></td>
        <td id="file-push-js-LC3" class="blob-code blob-code-inner js-file-line"><span class="pl-en">console</span><span class="pl-c1">.log</span>(arr); <span class="pl-c">// ["Bill", "Chad", "Sue"]</span></td>
      </tr>
</tbody></table>

  </div>

  </div>
  
</div>

      </div>
      <div class="gist-meta">
        <a href="https://gist.github.com/kavitshah8/51a89cde8b6097bea242/raw/ee13c4b804acb1c36cd182c84ca032e4f463a727/push.js" style="float:right">view raw</a>
        <a href="https://gist.github.com/kavitshah8/51a89cde8b6097bea242#file-push-js">push.js</a>
        hosted with ❤ by <a href="https://github.com">GitHub</a>
      </div>
    </div>
</div>

<h4>Array.prototype.shift()</h4>
<p>It returns the first removed ele-ment from an array and it removes the first ele-ment from the orig-i-nal&nbsp;array.</p>
<h5>Syn-tax : arr.shift()</h5>
<h5>Out-put : first removed ele-ment from an&nbsp;array</h5>
<script src="https://gist.github.com/51a89cde8b6097bea242.js?file=shift.js"></script><link rel="stylesheet" href="https://assets-cdn.github.com/assets/gist/embed-3313cb70789df61d3bb75cd878325a1266ccab50b6aac9b80f1691ae0694a216.css"><div id="gist26068146" class="gist">
    <div class="gist-file">
      <div class="gist-data">
        <div class="js-gist-file-update-container js-task-list-container file-box">
  <div id="file-shift-js" class="file">
    

  <div class="blob-wrapper data type-javascript">
      <table class="highlight tab-size js-file-line-container" data-tab-size="8">
      <tbody><tr class="alt">
        <td id="file-shift-js-L1" class="blob-num js-line-number" data-line-number="1"></td>
        <td id="file-shift-js-LC1" class="blob-code blob-code-inner js-file-line"><span class="pl-k">var</span> arr <span class="pl-k">=</span> [<span class="pl-s"><span class="pl-pds">'</span>Bill<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>Chad<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>Sue<span class="pl-pds">'</span></span>];</td>
      </tr>
      <tr>
        <td id="file-shift-js-L2" class="blob-num js-line-number" data-line-number="2"></td>
        <td id="file-shift-js-LC2" class="blob-code blob-code-inner js-file-line"><span class="pl-k">var</span> shiftedArr <span class="pl-k">=</span> arr.<span class="pl-c1">shift</span>(); <span class="pl-c">// "Bill"</span></td>
      </tr>
      <tr class="alt">
        <td id="file-shift-js-L3" class="blob-num js-line-number" data-line-number="3"></td>
        <td id="file-shift-js-LC3" class="blob-code blob-code-inner js-file-line"><span class="pl-en">console</span><span class="pl-c1">.log</span>(arr); <span class="pl-c">// ["Chad", "Sue"]</span></td>
      </tr>
</tbody></table>

  </div>

  </div>
  
</div>

      </div>
      <div class="gist-meta">
        <a href="https://gist.github.com/kavitshah8/51a89cde8b6097bea242/raw/ee13c4b804acb1c36cd182c84ca032e4f463a727/shift.js" style="float:right">view raw</a>
        <a href="https://gist.github.com/kavitshah8/51a89cde8b6097bea242#file-shift-js">shift.js</a>
        hosted with ❤ by <a href="https://github.com">GitHub</a>
      </div>
    </div>
</div>

<hr>
<p>The exam-ple shown below uses all the meth-ods we just talked about and solves a real world prob-lem using these methods.</p>
<script src="https://gist.github.com/51a89cde8b6097bea242.js?file=transform.js"></script><link rel="stylesheet" href="https://assets-cdn.github.com/assets/gist/embed-3313cb70789df61d3bb75cd878325a1266ccab50b6aac9b80f1691ae0694a216.css"><div id="gist26068146" class="gist">
    <div class="gist-file">
      <div class="gist-data">
        <div class="js-gist-file-update-container js-task-list-container file-box">
  <div id="file-transform-js" class="file">
    

  <div class="blob-wrapper data type-javascript">
      <table class="highlight tab-size js-file-line-container" data-tab-size="8">
      <tbody><tr>
        <td id="file-transform-js-L1" class="blob-num js-line-number" data-line-number="1"></td>
        <td id="file-transform-js-LC1" class="blob-code blob-code-inner js-file-line"><span class="pl-c">// Given an endorsment array with objects containing skill and user keys </span></td>
      </tr>
      <tr class="alt">
        <td id="file-transform-js-L2" class="blob-num js-line-number" data-line-number="2"></td>
        <td id="file-transform-js-LC2" class="blob-code blob-code-inner js-file-line"><span class="pl-k">var</span> endorsements <span class="pl-k">=</span> [</td>
      </tr>
      <tr>
        <td id="file-transform-js-L3" class="blob-num js-line-number" data-line-number="3"></td>
        <td id="file-transform-js-LC3" class="blob-code blob-code-inner js-file-line">  { skill<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>javascript<span class="pl-pds">'</span></span>, user<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>Chad<span class="pl-pds">'</span></span> },</td>
      </tr>
      <tr class="alt">
        <td id="file-transform-js-L4" class="blob-num js-line-number" data-line-number="4"></td>
        <td id="file-transform-js-LC4" class="blob-code blob-code-inner js-file-line">  { skill<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>javascript<span class="pl-pds">'</span></span>, user<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>Bill<span class="pl-pds">'</span></span> },</td>
      </tr>
      <tr>
        <td id="file-transform-js-L5" class="blob-num js-line-number" data-line-number="5"></td>
        <td id="file-transform-js-LC5" class="blob-code blob-code-inner js-file-line">  { skill<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>javascript<span class="pl-pds">'</span></span>, user<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>Sue<span class="pl-pds">'</span></span> },</td>
      </tr>
      <tr class="alt">
        <td id="file-transform-js-L6" class="blob-num js-line-number" data-line-number="6"></td>
        <td id="file-transform-js-LC6" class="blob-code blob-code-inner js-file-line">  { skill<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>html<span class="pl-pds">'</span></span>, user<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>Sue HTML<span class="pl-pds">'</span></span> },</td>
      </tr>
      <tr>
        <td id="file-transform-js-L7" class="blob-num js-line-number" data-line-number="7"></td>
        <td id="file-transform-js-LC7" class="blob-code blob-code-inner js-file-line">  { skill<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>css<span class="pl-pds">'</span></span>, user<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>Sue CSS<span class="pl-pds">'</span></span> },</td>
      </tr>
      <tr class="alt">
        <td id="file-transform-js-L8" class="blob-num js-line-number" data-line-number="8"></td>
        <td id="file-transform-js-LC8" class="blob-code blob-code-inner js-file-line">  { skill<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>css<span class="pl-pds">'</span></span>, user<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>Bill CSS<span class="pl-pds">'</span></span> }</td>
      </tr>
      <tr>
        <td id="file-transform-js-L9" class="blob-num js-line-number" data-line-number="9"></td>
        <td id="file-transform-js-LC9" class="blob-code blob-code-inner js-file-line">];</td>
      </tr>
      <tr class="alt">
        <td id="file-transform-js-L10" class="blob-num js-line-number" data-line-number="10"></td>
        <td id="file-transform-js-LC10" class="blob-code blob-code-inner js-file-line"> </td>
      </tr>
      <tr>
        <td id="file-transform-js-L11" class="blob-num js-line-number" data-line-number="11"></td>
        <td id="file-transform-js-LC11" class="blob-code blob-code-inner js-file-line"><span class="pl-c">// And we want to transform an given endorsment array with an array which is a collection of objects with key skill and users</span></td>
      </tr>
      <tr class="alt">
        <td id="file-transform-js-L12" class="blob-num js-line-number" data-line-number="12"></td>
        <td id="file-transform-js-LC12" class="blob-code blob-code-inner js-file-line"><span class="pl-c">// But user key is an array containing all the users with that particular skill</span></td>
      </tr>
      <tr>
        <td id="file-transform-js-L13" class="blob-num js-line-number" data-line-number="13"></td>
        <td id="file-transform-js-LC13" class="blob-code blob-code-inner js-file-line">[</td>
      </tr>
      <tr class="alt">
        <td id="file-transform-js-L14" class="blob-num js-line-number" data-line-number="14"></td>
        <td id="file-transform-js-LC14" class="blob-code blob-code-inner js-file-line">  { skill<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>javascript<span class="pl-pds">'</span></span>, user<span class="pl-k">:</span> [ <span class="pl-s"><span class="pl-pds">'</span>Chad<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>Bill<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>Sue<span class="pl-pds">'</span></span> ], count<span class="pl-k">:</span> <span class="pl-c1">3</span> },</td>
      </tr>
      <tr>
        <td id="file-transform-js-L15" class="blob-num js-line-number" data-line-number="15"></td>
        <td id="file-transform-js-LC15" class="blob-code blob-code-inner js-file-line">  { skill<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>css<span class="pl-pds">'</span></span>, user<span class="pl-k">:</span> [ <span class="pl-s"><span class="pl-pds">'</span>Sue<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>Bill<span class="pl-pds">'</span></span> ], count<span class="pl-k">:</span> <span class="pl-c1">2</span> },</td>
      </tr>
      <tr class="alt">
        <td id="file-transform-js-L16" class="blob-num js-line-number" data-line-number="16"></td>
        <td id="file-transform-js-LC16" class="blob-code blob-code-inner js-file-line">  { skill<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>html<span class="pl-pds">'</span></span>, user<span class="pl-k">:</span> [ <span class="pl-s"><span class="pl-pds">'</span>Sue<span class="pl-pds">'</span></span> ], count<span class="pl-k">:</span> <span class="pl-c1">1</span> } </td>
      </tr>
      <tr>
        <td id="file-transform-js-L17" class="blob-num js-line-number" data-line-number="17"></td>
        <td id="file-transform-js-LC17" class="blob-code blob-code-inner js-file-line">]; </td>
      </tr>
      <tr class="alt">
        <td id="file-transform-js-L18" class="blob-num js-line-number" data-line-number="18"></td>
        <td id="file-transform-js-LC18" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-transform-js-L19" class="blob-num js-line-number" data-line-number="19"></td>
        <td id="file-transform-js-LC19" class="blob-code blob-code-inner js-file-line"><span class="pl-c">// Array methods: forEach(), map(), push()</span></td>
      </tr>
      <tr class="alt">
        <td id="file-transform-js-L20" class="blob-num js-line-number" data-line-number="20"></td>
        <td id="file-transform-js-LC20" class="blob-code blob-code-inner js-file-line"><span class="pl-c">// Object methods: Object.keys()</span></td>
      </tr>
      <tr>
        <td id="file-transform-js-L21" class="blob-num js-line-number" data-line-number="21"></td>
        <td id="file-transform-js-LC21" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr class="alt">
        <td id="file-transform-js-L22" class="blob-num js-line-number" data-line-number="22"></td>
        <td id="file-transform-js-LC22" class="blob-code blob-code-inner js-file-line"><span class="pl-k">function</span> <span class="pl-en">transformData</span> (<span class="pl-smi">endo</span>) {</td>
      </tr>
      <tr>
        <td id="file-transform-js-L23" class="blob-num js-line-number" data-line-number="23"></td>
        <td id="file-transform-js-LC23" class="blob-code blob-code-inner js-file-line">    </td>
      </tr>
      <tr class="alt">
        <td id="file-transform-js-L24" class="blob-num js-line-number" data-line-number="24"></td>
        <td id="file-transform-js-LC24" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">var</span> tra <span class="pl-k">=</span> {};</td>
      </tr>
      <tr>
        <td id="file-transform-js-L25" class="blob-num js-line-number" data-line-number="25"></td>
        <td id="file-transform-js-LC25" class="blob-code blob-code-inner js-file-line">    </td>
      </tr>
      <tr class="alt">
        <td id="file-transform-js-L26" class="blob-num js-line-number" data-line-number="26"></td>
        <td id="file-transform-js-LC26" class="blob-code blob-code-inner js-file-line">    endo.forEach(<span class="pl-k">function</span>(<span class="pl-smi">el</span>) {</td>
      </tr>
      <tr>
        <td id="file-transform-js-L27" class="blob-num js-line-number" data-line-number="27"></td>
        <td id="file-transform-js-LC27" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">if</span> (tra[el.skill]) {</td>
      </tr>
      <tr class="alt">
        <td id="file-transform-js-L28" class="blob-num js-line-number" data-line-number="28"></td>
        <td id="file-transform-js-LC28" class="blob-code blob-code-inner js-file-line">          tra[el.skill].<span class="pl-c1">push</span>(el.user);</td>
      </tr>
      <tr>
        <td id="file-transform-js-L29" class="blob-num js-line-number" data-line-number="29"></td>
        <td id="file-transform-js-LC29" class="blob-code blob-code-inner js-file-line">        } <span class="pl-k">else</span> {</td>
      </tr>
      <tr class="alt">
        <td id="file-transform-js-L30" class="blob-num js-line-number" data-line-number="30"></td>
        <td id="file-transform-js-LC30" class="blob-code blob-code-inner js-file-line">          tra[el.skill] <span class="pl-k">=</span> [];</td>
      </tr>
      <tr>
        <td id="file-transform-js-L31" class="blob-num js-line-number" data-line-number="31"></td>
        <td id="file-transform-js-LC31" class="blob-code blob-code-inner js-file-line">          tra[el.skill].<span class="pl-c1">push</span>(el.user);</td>
      </tr>
      <tr class="alt">
        <td id="file-transform-js-L32" class="blob-num js-line-number" data-line-number="32"></td>
        <td id="file-transform-js-LC32" class="blob-code blob-code-inner js-file-line">        }</td>
      </tr>
      <tr>
        <td id="file-transform-js-L33" class="blob-num js-line-number" data-line-number="33"></td>
        <td id="file-transform-js-LC33" class="blob-code blob-code-inner js-file-line">    });	</td>
      </tr>
      <tr class="alt">
        <td id="file-transform-js-L34" class="blob-num js-line-number" data-line-number="34"></td>
        <td id="file-transform-js-LC34" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-transform-js-L35" class="blob-num js-line-number" data-line-number="35"></td>
        <td id="file-transform-js-LC35" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">var</span> res <span class="pl-k">=</span> <span class="pl-c1">Object</span>.keys(tra).map(<span class="pl-k">function</span>(<span class="pl-smi">key</span>) {    	</td>
      </tr>
      <tr class="alt">
        <td id="file-transform-js-L36" class="blob-num js-line-number" data-line-number="36"></td>
        <td id="file-transform-js-LC36" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">var</span> obj <span class="pl-k">=</span> {};</td>
      </tr>
      <tr>
        <td id="file-transform-js-L37" class="blob-num js-line-number" data-line-number="37"></td>
        <td id="file-transform-js-LC37" class="blob-code blob-code-inner js-file-line">        obj[<span class="pl-s"><span class="pl-pds">'</span>skills<span class="pl-pds">'</span></span>] <span class="pl-k">=</span> key;</td>
      </tr>
      <tr class="alt">
        <td id="file-transform-js-L38" class="blob-num js-line-number" data-line-number="38"></td>
        <td id="file-transform-js-LC38" class="blob-code blob-code-inner js-file-line">        obj[<span class="pl-s"><span class="pl-pds">'</span>values<span class="pl-pds">'</span></span>] <span class="pl-k">=</span> tra[key];</td>
      </tr>
      <tr>
        <td id="file-transform-js-L39" class="blob-num js-line-number" data-line-number="39"></td>
        <td id="file-transform-js-LC39" class="blob-code blob-code-inner js-file-line">      	<span class="pl-k">return</span> obj;</td>
      </tr>
      <tr class="alt">
        <td id="file-transform-js-L40" class="blob-num js-line-number" data-line-number="40"></td>
        <td id="file-transform-js-LC40" class="blob-code blob-code-inner js-file-line">    });</td>
      </tr>
      <tr>
        <td id="file-transform-js-L41" class="blob-num js-line-number" data-line-number="41"></td>
        <td id="file-transform-js-LC41" class="blob-code blob-code-inner js-file-line">    </td>
      </tr>
      <tr class="alt">
        <td id="file-transform-js-L42" class="blob-num js-line-number" data-line-number="42"></td>
        <td id="file-transform-js-LC42" class="blob-code blob-code-inner js-file-line">    <span class="pl-en">console</span><span class="pl-c1">.log</span>(res);</td>
      </tr>
      <tr>
        <td id="file-transform-js-L43" class="blob-num js-line-number" data-line-number="43"></td>
        <td id="file-transform-js-LC43" class="blob-code blob-code-inner js-file-line">}</td>
      </tr>
      <tr class="alt">
        <td id="file-transform-js-L44" class="blob-num js-line-number" data-line-number="44"></td>
        <td id="file-transform-js-LC44" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-transform-js-L45" class="blob-num js-line-number" data-line-number="45"></td>
        <td id="file-transform-js-LC45" class="blob-code blob-code-inner js-file-line">transformData(endorsements);</td>
      </tr>
</tbody></table>

  </div>

  </div>
  
</div>

      </div>
      <div class="gist-meta">
        <a href="https://gist.github.com/kavitshah8/51a89cde8b6097bea242/raw/ee13c4b804acb1c36cd182c84ca032e4f463a727/transform.js" style="float:right">view raw</a>
        <a href="https://gist.github.com/kavitshah8/51a89cde8b6097bea242#file-transform-js">transform.js</a>
        hosted with ❤ by <a href="https://github.com">GitHub</a>
      </div>
    </div>
</div>

<blockquote><p>
  <span class="caps">PS</span>: I like vis-it-ing my old code and refac-tor-ing it with some of the new meth-ods intro-duced in the lan-guage. And then includ-ing those lan-guage fea-tures in day to day pro-gram-ming. This exam-ple is one demon-stra-tion of&nbsp;it.
</p></blockquote>
													</div>
						<div class="clear"></div>				
					</div><!--/.entry-->
					
				</div>
			</div>
			<!--========================= END : POST		=============================-->
			<!--=========================			START : POST		=============================-->
		<div class="post-wrapper">
		<div class="post-inner group">
					
					<h1 class="post-title">The JavaScript Prototype Property — Visualized</h1>
					
					
										
					
					
					<div class="entry">	
						<div class="entry-inner">
							<p>One of the more (controversially)interesting con­cepts in JavaScript is that of the pro­to­type prop­erty. If you are for­tu­nate, you get it at first sight. If not, you will find your­self learn­ing and relearn­ing about it every-time you come across it.</p>
<p>To avoid this vicious cir­cle of relearn­ing, we cre­ated that neat lit­tle dia­gram that you saw on top that you can visu­al­ize when­ever you are try­ing to under­stand what is hap­pen­ing in the code before your&nbsp;eyes.</p>
<p>When you think about pro­to­type prop­erty, just keep 4 things in&nbsp;mind.</p>
<p><span id="more-48"></span></p>
<ol>
<li>Only func­tions have a pro­to­type property.</li>
<li>Every object in javascript has a hid­den prop­erty called ‘<strong>proto</strong>’ that con­nects it to the pro­to­type prop­erty of its con­struct­ing function.</li>
<li>An object only has read­Only access to its constructor’s prototype.</li>
<li>If you try to get a prop­erty on an object and the object does not have it, it will be looked up in the pro­to­type of the object’s con­struc­tor. If found there, its value will be returned. If not found, it will be looked up at the Con­struc­tor of this con­struc­tor. (Since func­tions are also objects in JavaScript, even they have a con­struc­tor). This is called the pro­to­type chain. You might need to come back to this point when read­ing the snip­pets that follow.</li>
</ol>
<p>That said, look at fol­low­ing code snip­pets and see the diagram.</p>
<div class="highlight highlight-js">
<pre><span class="c1">// Create a function</span>
<span class="kd">function</span> <span class="nx">Car</span><span class="p">(){}</span>

<span class="c1">// Create properties on the prototype</span>
<span class="nx">Car</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">wheels</span> <span class="o">=</span> <span class="mi">4</span><span class="p">;</span>
<span class="nx">Car</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">steeringWheel</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
<span class="nx">Car</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">color</span> <span class="o">=</span> <span class="s1">'metallic'</span><span class="p">;</span>

<span class="c1">// Create objects</span>
<span class="kd">var</span> <span class="nx">car1</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Car</span><span class="p">();</span>
<span class="kd">var</span> <span class="nx">car2</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Car</span><span class="p">();</span>

<span class="c1">// Car is now the constructor function for 'car1' and 'car2'</span>

<span class="c1">// We didn't define any properties on car1 and car2</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">car1</span><span class="p">.</span><span class="nx">stereo</span><span class="p">)</span> <span class="p">;</span> <span class="c1">// Prints undefined</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">car2</span><span class="p">.</span><span class="nx">gps</span><span class="p">)</span> <span class="p">;</span> <span class="c1">// Prints 'undefined'</span>

<span class="c1">// In spite of that, it seems that both car1 and car2 can 'see' the properties defined on its constructor's prototype (See point 4 about the prototype chain)</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">car1</span><span class="p">.</span><span class="nx">wheels</span><span class="p">);</span> <span class="c1">// Prints 4</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">car2</span><span class="p">.</span><span class="nx">wheels</span><span class="p">);</span> <span class="c1">// Prints 4</span>

<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">car1</span><span class="p">.</span><span class="nx">steeringWheel</span><span class="p">);</span> <span class="c1">// Prints 1</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">car2</span><span class="p">.</span><span class="nx">steeringWheel</span><span class="p">);</span> <span class="c1">// Prints 1</span>

<span class="c1">// Remember, they can only 'see' the parent property. If they try to overwrite it, a property of the same name is created on the object itself which shadows the property on the prototype</span>
<span class="nx">car1</span><span class="p">.</span><span class="nx">wheels</span><span class="o">=</span><span class="mi">3</span><span class="p">;</span> <span class="c1">// Thats a strange car indeed!</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">car1</span><span class="p">.</span><span class="nx">wheels</span><span class="p">);</span> <span class="c1">// Prints 3</span>

<span class="c1">// To prove that the prototype still has the property intact</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">car2</span><span class="p">.</span><span class="nx">wheels</span><span class="p">)</span> <span class="p">;</span> <span class="c1">// Still prints 4</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">Car</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">wheels</span><span class="p">)</span> <span class="p">;</span> <span class="c1">// Checking directly at the Constructor. Prints 4</span>

<span class="nx">To</span> <span class="nx">change</span> <span class="nx">the</span> <span class="nx">value</span> <span class="nx">of</span> <span class="nx">the</span> <span class="nx">prototype</span> <span class="nx">property</span><span class="p">,</span> <span class="nx">you</span> <span class="nx">gotta</span> <span class="nx">change</span> <span class="nx">it</span> <span class="nx">directly</span> <span class="nx">at</span> <span class="nx">the</span> <span class="nx">constructor</span><span class="p">.</span>

<span class="nx">Car</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">wheels</span> <span class="o">=</span> <span class="mi">5</span><span class="p">;</span>

<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">car2</span><span class="p">.</span><span class="nx">wheels</span><span class="p">);</span> <span class="c1">// Prints 5</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">car1</span><span class="p">.</span><span class="nx">wheels</span><span class="p">);</span> <span class="c1">// Prints 3 since it has its own 'wheels' property</span>

<span class="c1">// In the same way, if you look at the diagram, since we overwrite the color property in car1 and car2</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">car1</span><span class="p">.</span><span class="nx">color</span><span class="p">);</span> <span class="c1">// Prints blue - its own property hides the prototype property</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">car2</span><span class="p">.</span><span class="nx">color</span><span class="p">);</span> <span class="c1">// Prints red - its own property hides the prototype property</span>

<span class="c1">// whereas</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">car1</span><span class="p">.</span><span class="nx">steeringWheel</span><span class="p">);</span> <span class="c1">// Prints 1- from the prototype chain</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">car2</span><span class="p">.</span><span class="nx">steeringWheel</span><span class="p">);</span> <span class="c1">// Prints 1- from the prototype chain</span>
</pre>
</div>
<p>To explain point 4 more in a more fun way, think about an object as a child. If you ask it some­thing, and it does not know about it, I will ask its mom. And if she does not know, she will ask hers. And this goes on until either an answer is found or there are no more moms in the ances­try. How­ever, if the child knows an answer, it ends right&nbsp;there.</p>
<p>A good side effect of the pro­to­type prop­erty is that you can cre­ate prop­er­ties on the func­tion pro­to­type and they will automag­i­cally become avail­able to all of the instances cre­ated from that function.</p>
<p>And that, my friend, is the pro­to­type prop­erty for you, in a nutshell.</p>
													</div>
						<div class="clear"></div>				
					</div><!--/.entry-->
					
				</div>
			</div>
			<!--========================= END : POST		=============================-->
			<!--=========================			START : POST		=============================-->
		<div class="post-wrapper">
		<div class="post-inner group">
					
					<h1 class="post-title">JavaScript Promises — Visualized</h1>
					
					
										
					
					
					<div class="entry">	
						<div class="entry-inner">
							<p>When you work with javascript, you will often find that call­backs are all over the place. They are in your front end code, in your mid­dle­ware, and in case you use it to inter­face with your data­base, you would have it in your back end code too. Heck, they even come to haunt you in your dreams. One of the clever­est ways to avoid this hell is by using promises. Promises are a rel­a­tively new con­cept in javascript require you to think about your code in a slightly dif­fer­ent, yet inter­est­ing&nbsp;way.</p>
<p><span id="more-29"></span></p>
<p>I recently had the oppor­tu­nity to mess around with promises a lot. In this post, I will just touch upon some of ways I ended up using promises and pro­vide those snip­pets for quick&nbsp;reuse.</p>
<p>Look at the fol­low­ing visu­al­iza­tion now, and then look at it again at the end of this post. It explains how the func­tions are asso­ci­ated when you cre­ate new promise obejcts.</p>
<p align="center">
<a href="https://camo.githubusercontent.com/87eeaf90bf51aea228fd0e0c14fd9807cc76bd9e/687474703a2f2f7279616e73756b616c652e636f6d2f76697a2f50726f6d6973652e706e67" target="_blank"><img src="https://camo.githubusercontent.com/87eeaf90bf51aea228fd0e0c14fd9807cc76bd9e/687474703a2f2f7279616e73756b616c652e636f6d2f76697a2f50726f6d6973652e706e67" alt="Promises Visualized"></a></p>
<p>I am not going to go into detail of what promises are and its dif­fer­ent use cases. You can always read <a href="http://www.html5rocks.com/en/tutorials/es6/promises/">this</a> amaz­ingly long arti­cle on html5rocks for that. How­ever, if you dont have the time, this arti­cle should at least help you to address the mat­ter at&nbsp;hand.</p>
<p>So, how do you cre­ate a promise?</p>
<div class="highlight highlight-js">
<pre><span class="kd">var</span> <span class="nx">getData</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Promise</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">resolve</span><span class="p">,</span> <span class="nx">reject</span><span class="p">){</span>

    <span class="c1">// Do something asynchronous and pass it a callback</span>
    <span class="nx">getDataFromAMillionMilesAway</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">data</span><span class="p">){</span>

        <span class="k">if</span><span class="p">(</span><span class="nx">data</span><span class="p">){</span>
            <span class="nx">resolve</span><span class="p">(</span><span class="nx">data</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">else</span> <span class="p">{</span>
            <span class="nx">reject</span><span class="p">(</span><span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="s2">"Thats too far away"</span><span class="p">));</span>
        <span class="p">}</span>

    <span class="p">});</span> 

<span class="p">});</span>

<span class="c1">// And here's how you'd use it</span>

<span class="nx">getData</span><span class="p">().</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">data</span><span class="p">){</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">'Got Some Data! '</span><span class="p">,</span> <span class="nx">data</span><span class="p">);</span>
<span class="p">});</span>
</pre>
</div>
<p>As you can see above, the first func­tion passed to the then() func­tion receives the value that you pass to the resolve() func­tion. So what hap­pens to the error case? Well, we didnt cap­ture it in the above exam­ple. But just like the promise con­struc­tor, the then func­tion can take two func­tions are argu­ments. The first func­tion is invoked upon call­ing resolve, and the sec­ond one is invoked upon call­ing reject with the cor­re­spond­ing parameters.</p>
<div class="highlight highlight-js">
<pre><span class="nx">getData</span><span class="p">().</span><span class="nx">then</span><span class="p">(</span>
    <span class="kd">function</span><span class="p">(</span><span class="nx">data</span><span class="p">){</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">'Got Some Data! '</span><span class="p">,</span> <span class="nx">data</span><span class="p">);</span>
    <span class="p">},</span>
    <span class="kd">function</span><span class="p">(</span><span class="nx">error</span><span class="p">){</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">'Something really bad happened :( '</span><span class="p">,</span> <span class="nx">data</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">);</span>
</pre>
</div>
<p>So that takes care of the prob­lem of func­tions. You might won­der what good is the promise if you need to call the get­DataFro­mAMil­lion­Mile­sAway func­tion with a para­me­ter. Well, clo­sures to the rescue.</p>
<div class="highlight highlight-js">
<pre><span class="kd">var</span> <span class="nx">getData</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">config</span><span class="p">){</span>

    <span class="k">return</span> <span class="k">new</span> <span class="nx">Promise</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">resolve</span><span class="p">,</span> <span class="nx">reject</span><span class="p">){</span>

        <span class="c1">// Do something asynchronous and pass it a callback</span>
        <span class="nx">getDataFromAMillionMilesAway</span><span class="p">(</span><span class="nx">config</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">data</span><span class="p">){</span>

            <span class="k">if</span><span class="p">(</span><span class="nx">data</span><span class="p">){</span>
                <span class="nx">resolve</span><span class="p">(</span><span class="nx">data</span><span class="p">);</span>
            <span class="p">}</span>
            <span class="k">else</span> <span class="p">{</span>
                <span class="nx">reject</span><span class="p">(</span><span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="s2">"Thats too far away"</span><span class="p">));</span>
            <span class="p">}</span>

        <span class="p">});</span> 

    <span class="p">});</span>

<span class="p">}</span>
</pre>
</div>
<p>Note that in this case, we are return­ing the new Promise from the get­Data func­tion. This effec­tively makes get­Data a promise which retains the value of the ‘con­fig’ in a clo­sure using which you can call the then func­tion just like before.</p>
<p>One might argue that this is just a sug­ar­coat on call­backs because as you can see, we are not avoid­ing call­backs alto­gether. In fact, they are they most impor­tant part that lead to either the res­o­lu­tion or rejec­tion of a promise. How­ever, by encap­su­lat­ing the call­back logic in a sin­gle place you can now write much cleaner code like&nbsp;this.</p>
<div class="highlight highlight-js">
<pre>getData(config1)
  .then(<span class="pl-k">function</span> () {
    <span class="pl-k">return</span> getData(config2);
  })
  .then(<span class="pl-k">function</span> ()  {
    <span class="pl-k">return</span> getData(config3);
  })
  .then(<span class="pl-k">function</span>(){
    <span class="pl-en">console</span><span class="pl-c1">.log</span>(<span class="pl-s"><span class="pl-pds">'</span>All the data was fetched sequentially.<span class="pl-pds">'</span></span>);
  });</pre>
</div>
<p>That looks much more like plain Eng­lish, doesn’t it? You might have just delayed your inevitable bald­ness by a few years.<br>
And that is why promises are so awe­some. They save your&nbsp;hair.</p>
<p>The other impor­tant thing about promises is that you can return a value from a func­tion to resolve a promise with that value. For exam­ple, the fol­low­ing code works per­fectly fine</p>
<div class="highlight highlight-js">
<pre><span class="nx">getData</span><span class="p">(</span><span class="nx">config</span><span class="p">).</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">data</span><span class="p">){</span>
     <span class="nx">data</span> <span class="o">=</span> <span class="nx">_</span><span class="p">.</span><span class="nx">extend</span><span class="p">({},</span> <span class="nx">data</span><span class="p">,</span> <span class="p">{</span><span class="s1">'key'</span><span class="p">,</span><span class="s1">'valye'</span><span class="p">});</span>
     <span class="k">return</span> <span class="nx">data</span><span class="p">;</span>
<span class="p">}).</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">modifiedData</span><span class="p">){</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">modifiedData</span><span class="p">);</span>
<span class="p">});</span>
</pre>
</div>
<p>Since all you need is to return a value to resolve a promise, any func­tion that returns a sin­gle value can be used as an argu­ment to the then() func­tion. E.g. Here’s what I&nbsp;mean</p>
<div class="highlight highlight-js">
<pre><span class="nx">getData</span><span class="p">(</span><span class="nx">config</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">data</span><span class="p">){</span>
        <span class="k">return</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="nx">data</span><span class="p">);</span>
    <span class="p">})</span>
    <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">parsedData</span><span class="p">){</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">parsedData</span><span class="p">);</span>
    <span class="p">});</span>

<span class="c1">//is equivalent to</span>

<span class="nx">getData</span><span class="p">(</span><span class="nx">config</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="nx">JSON</span><span class="p">.</span><span class="nx">parse</span><span class="p">)</span>
        <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">parsedData</span><span class="p">){</span>
            <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">parsedData</span><span class="p">);</span>
    <span class="p">});</span>
</pre>
</div>
<p>Once you get a taste of it, I promise you, you will not want to call&nbsp;back <img src="http://javascript.tutorialhorizon.com/wp-includes/images/smilies/icon_wink.gif" alt=";)" class="wp-smiley"></p>
													</div>
						<div class="clear"></div>				
					</div><!--/.entry-->
					
				</div>
			</div>
			<!--========================= END : POST		=============================-->
			<!--=========================			START : POST		=============================-->
		<div class="post-wrapper">
		<div class="post-inner group">
					
					<h1 class="post-title">Promise javascript examples</h1>
					<p class="post-byline">by <a href="http://javascript.tutorialhorizon.com/author/kavit/" title="Posts by kavit" rel="author">kavit</a> · August 7, 2015</p>
					
										
					<div class="clear"></div>
					
					<div class="entry">	
						<div class="entry-inner">
							<p>Promises are becom­ing a fun­da­men­tal part of javascript. Hence, it is nec­es­sary to under­stand promises thor­oughly. When I was learn­ing promises, I could not find many exam­ples which I could run in the browser’s con­sole. The aim of this arti­cle is&nbsp;to</p>
<ul>
<li>Pro­vide sim­ple exam­ples which you can run in your browser’s console</li>
<li>Demon­strate the flow of promise execution</li>
</ul>
<p>Before we jump into the exam­ples, let’s quickly review the basics of promises.</p>
<hr>
<h4>3 states of a promise</h4>
<p>A Promise will always be in one of three states:</p>
<ul>
<li><strong>pend­ing</strong>: This is the ini­tial state when it is just created.</li>
<li><strong>ful­filled</strong>: This indi­cates that the oper­a­tion that the promised wrapped com­pleted successfully</li>
<li><strong>rejected</strong>: This indi­cates that the oper­a­tion that the promise wrapped had failed</li>
</ul>
<p>If a promise is resolved/fulfilled the suc­cess call­back will be called and if it’s rejected, the fail­ure call­back will be called. If you are curi­ous about how call­backs work read <a href="http://javascript.tutorialhorizon.com/2015/07/03/callback-function-javascript-tutorial/">this arti­cle</a>.</p>
<p>Now let’s under­stand what hap­pens when promises get resolved or rejected.</p>
<hr>
<h4>Promise.resolve</h4>
<p>In the exam­ples of this sec­tion, we will sim­u­late a resolved promise using the <code>Promise.resolve()</code> method. You can eas­ily replace it with any promise based ajax calls in your own&nbsp;code.</p>
<script src="https://gist.github.com/e22dea9b95b0cbbc4261.js?file=promise-1.js"></script><link rel="stylesheet" href="https://assets-cdn.github.com/assets/gist/embed-3313cb70789df61d3bb75cd878325a1266ccab50b6aac9b80f1691ae0694a216.css"><div id="gist25056955" class="gist">
    <div class="gist-file">
      <div class="gist-data">
        <div class="js-gist-file-update-container js-task-list-container file-box">
  <div id="file-promise-1-js" class="file">
    

  <div class="blob-wrapper data type-javascript">
      <table class="highlight tab-size js-file-line-container" data-tab-size="8">
      <tbody><tr>
        <td id="file-promise-1-js-L1" class="blob-num js-line-number" data-line-number="1"></td>
        <td id="file-promise-1-js-LC1" class="blob-code blob-code-inner js-file-line"><span class="pl-k">var</span> p <span class="pl-k">=</span> Promise.resolve().then(<span class="pl-k">function</span>() {</td>
      </tr>
      <tr class="alt">
        <td id="file-promise-1-js-L2" class="blob-num js-line-number" data-line-number="2"></td>
        <td id="file-promise-1-js-LC2" class="blob-code blob-code-inner js-file-line">                <span class="pl-en">console</span><span class="pl-c1">.log</span>(<span class="pl-s"><span class="pl-pds">'</span>Promise resolve callback<span class="pl-pds">'</span></span>);  <span class="pl-c">// Prints Promise resolve callback</span></td>
      </tr>
      <tr>
        <td id="file-promise-1-js-L3" class="blob-num js-line-number" data-line-number="3"></td>
        <td id="file-promise-1-js-LC3" class="blob-code blob-code-inner js-file-line">        }, <span class="pl-k">function</span>() {</td>
      </tr>
      <tr class="alt">
        <td id="file-promise-1-js-L4" class="blob-num js-line-number" data-line-number="4"></td>
        <td id="file-promise-1-js-LC4" class="blob-code blob-code-inner js-file-line">                <span class="pl-en">console</span><span class="pl-c1">.log</span>(<span class="pl-s"><span class="pl-pds">'</span>Promise reject callback<span class="pl-pds">'</span></span>);</td>
      </tr>
      <tr>
        <td id="file-promise-1-js-L5" class="blob-num js-line-number" data-line-number="5"></td>
        <td id="file-promise-1-js-LC5" class="blob-code blob-code-inner js-file-line">        });</td>
      </tr>
</tbody></table>

  </div>

  </div>
  
</div>

      </div>
      <div class="gist-meta">
        <a href="https://gist.github.com/kavitshah8/e22dea9b95b0cbbc4261/raw/168b2976d3879207c43505e9f31d1c32c499b786/promise-1.js" style="float:right">view raw</a>
        <a href="https://gist.github.com/kavitshah8/e22dea9b95b0cbbc4261#file-promise-1-js">promise-1.js</a>
        hosted with ❤ by <a href="https://github.com">GitHub</a>
      </div>
    </div>
</div>

<script src="https://gist.github.com/e22dea9b95b0cbbc4261.js?file=promise-2.js"></script><link rel="stylesheet" href="https://assets-cdn.github.com/assets/gist/embed-3313cb70789df61d3bb75cd878325a1266ccab50b6aac9b80f1691ae0694a216.css"><div id="gist25056955" class="gist">
    <div class="gist-file">
      <div class="gist-data">
        <div class="js-gist-file-update-container js-task-list-container file-box">
  <div id="file-promise-2-js" class="file">
    

  <div class="blob-wrapper data type-javascript">
      <table class="highlight tab-size js-file-line-container" data-tab-size="8">
      <tbody><tr class="alt">
        <td id="file-promise-2-js-L1" class="blob-num js-line-number" data-line-number="1"></td>
        <td id="file-promise-2-js-LC1" class="blob-code blob-code-inner js-file-line"><span class="pl-k">var</span> p <span class="pl-k">=</span> Promise.reject().then(<span class="pl-k">function</span>() {</td>
      </tr>
      <tr>
        <td id="file-promise-2-js-L2" class="blob-num js-line-number" data-line-number="2"></td>
        <td id="file-promise-2-js-LC2" class="blob-code blob-code-inner js-file-line">                <span class="pl-en">console</span><span class="pl-c1">.log</span>(<span class="pl-s"><span class="pl-pds">'</span>Promise resolve callback<span class="pl-pds">'</span></span>);</td>
      </tr>
      <tr class="alt">
        <td id="file-promise-2-js-L3" class="blob-num js-line-number" data-line-number="3"></td>
        <td id="file-promise-2-js-LC3" class="blob-code blob-code-inner js-file-line">        }, <span class="pl-k">function</span>() {</td>
      </tr>
      <tr>
        <td id="file-promise-2-js-L4" class="blob-num js-line-number" data-line-number="4"></td>
        <td id="file-promise-2-js-LC4" class="blob-code blob-code-inner js-file-line">                <span class="pl-en">console</span><span class="pl-c1">.log</span>(<span class="pl-s"><span class="pl-pds">'</span>Promise reject callback<span class="pl-pds">'</span></span>); <span class="pl-c">// Prints Promise reject callback</span></td>
      </tr>
      <tr class="alt">
        <td id="file-promise-2-js-L5" class="blob-num js-line-number" data-line-number="5"></td>
        <td id="file-promise-2-js-LC5" class="blob-code blob-code-inner js-file-line">        });</td>
      </tr>
</tbody></table>

  </div>

  </div>
  
</div>

      </div>
      <div class="gist-meta">
        <a href="https://gist.github.com/kavitshah8/e22dea9b95b0cbbc4261/raw/168b2976d3879207c43505e9f31d1c32c499b786/promise-2.js" style="float:right">view raw</a>
        <a href="https://gist.github.com/kavitshah8/e22dea9b95b0cbbc4261#file-promise-2-js">promise-2.js</a>
        hosted with ❤ by <a href="https://github.com">GitHub</a>
      </div>
    </div>
</div>

<p>Exam­ples of <code>Promise.resolve()</code> with return statements</p>
<p>That was pretty straight­for­ward. But promises also sup­port chain­ing. You can pass a value to the next func­tion in the promise chain using return state­ments. This is prob­a­bly how you will find your­self using promises a lot in your own projects.</p>
<script src="https://gist.github.com/e22dea9b95b0cbbc4261.js?file=promise-3.js"></script><link rel="stylesheet" href="https://assets-cdn.github.com/assets/gist/embed-3313cb70789df61d3bb75cd878325a1266ccab50b6aac9b80f1691ae0694a216.css"><div id="gist25056955" class="gist">
    <div class="gist-file">
      <div class="gist-data">
        <div class="js-gist-file-update-container js-task-list-container file-box">
  <div id="file-promise-3-js" class="file">
    

  <div class="blob-wrapper data type-javascript">
      <table class="highlight tab-size js-file-line-container" data-tab-size="8">
      <tbody><tr>
        <td id="file-promise-3-js-L1" class="blob-num js-line-number" data-line-number="1"></td>
        <td id="file-promise-3-js-LC1" class="blob-code blob-code-inner js-file-line"><span class="pl-k">var</span> p <span class="pl-k">=</span> Promise.resolve(<span class="pl-c1">1</span>).then(<span class="pl-k">function</span>(<span class="pl-smi">value</span>) {</td>
      </tr>
      <tr class="alt">
        <td id="file-promise-3-js-L2" class="blob-num js-line-number" data-line-number="2"></td>
        <td id="file-promise-3-js-LC2" class="blob-code blob-code-inner js-file-line">            <span class="pl-en">console</span><span class="pl-c1">.log</span>(value); <span class="pl-c">// Prints 1</span></td>
      </tr>
      <tr>
        <td id="file-promise-3-js-L3" class="blob-num js-line-number" data-line-number="3"></td>
        <td id="file-promise-3-js-LC3" class="blob-code blob-code-inner js-file-line">            <span class="pl-k">return</span> <span class="pl-c1">2</span>;</td>
      </tr>
      <tr class="alt">
        <td id="file-promise-3-js-L4" class="blob-num js-line-number" data-line-number="4"></td>
        <td id="file-promise-3-js-LC4" class="blob-code blob-code-inner js-file-line">      })</td>
      </tr>
      <tr>
        <td id="file-promise-3-js-L5" class="blob-num js-line-number" data-line-number="5"></td>
        <td id="file-promise-3-js-LC5" class="blob-code blob-code-inner js-file-line">      .then(<span class="pl-k">function</span>(<span class="pl-smi">value</span>) {</td>
      </tr>
      <tr class="alt">
        <td id="file-promise-3-js-L6" class="blob-num js-line-number" data-line-number="6"></td>
        <td id="file-promise-3-js-LC6" class="blob-code blob-code-inner js-file-line">            <span class="pl-en">console</span><span class="pl-c1">.log</span>(value); <span class="pl-c">// Prints 2</span></td>
      </tr>
      <tr>
        <td id="file-promise-3-js-L7" class="blob-num js-line-number" data-line-number="7"></td>
        <td id="file-promise-3-js-LC7" class="blob-code blob-code-inner js-file-line">      });</td>
      </tr>
</tbody></table>

  </div>

  </div>
  
</div>

      </div>
      <div class="gist-meta">
        <a href="https://gist.github.com/kavitshah8/e22dea9b95b0cbbc4261/raw/168b2976d3879207c43505e9f31d1c32c499b786/promise-3.js" style="float:right">view raw</a>
        <a href="https://gist.github.com/kavitshah8/e22dea9b95b0cbbc4261#file-promise-3-js">promise-3.js</a>
        hosted with ❤ by <a href="https://github.com">GitHub</a>
      </div>
    </div>
</div>

<script src="https://gist.github.com/e22dea9b95b0cbbc4261.js?file=promise-4.js"></script><link rel="stylesheet" href="https://assets-cdn.github.com/assets/gist/embed-3313cb70789df61d3bb75cd878325a1266ccab50b6aac9b80f1691ae0694a216.css"><div id="gist25056955" class="gist">
    <div class="gist-file">
      <div class="gist-data">
        <div class="js-gist-file-update-container js-task-list-container file-box">
  <div id="file-promise-4-js" class="file">
    

  <div class="blob-wrapper data type-javascript">
      <table class="highlight tab-size js-file-line-container" data-tab-size="8">
      <tbody><tr class="alt">
        <td id="file-promise-4-js-L1" class="blob-num js-line-number" data-line-number="1"></td>
        <td id="file-promise-4-js-LC1" class="blob-code blob-code-inner js-file-line"><span class="pl-k">var</span> p <span class="pl-k">=</span> Promise.resolve().then(<span class="pl-k">function</span>(<span class="pl-smi">value</span>) {</td>
      </tr>
      <tr>
        <td id="file-promise-4-js-L2" class="blob-num js-line-number" data-line-number="2"></td>
        <td id="file-promise-4-js-LC2" class="blob-code blob-code-inner js-file-line">  	  <span class="pl-en">console</span><span class="pl-c1">.log</span>(value); <span class="pl-c">// Prints undefined			</span></td>
      </tr>
      <tr class="alt">
        <td id="file-promise-4-js-L3" class="blob-num js-line-number" data-line-number="3"></td>
        <td id="file-promise-4-js-LC3" class="blob-code blob-code-inner js-file-line">	  <span class="pl-k">return</span> <span class="pl-c1">1</span>;			</td>
      </tr>
      <tr>
        <td id="file-promise-4-js-L4" class="blob-num js-line-number" data-line-number="4"></td>
        <td id="file-promise-4-js-LC4" class="blob-code blob-code-inner js-file-line">	})			</td>
      </tr>
      <tr class="alt">
        <td id="file-promise-4-js-L5" class="blob-num js-line-number" data-line-number="5"></td>
        <td id="file-promise-4-js-LC5" class="blob-code blob-code-inner js-file-line">	.then(<span class="pl-k">function</span>(<span class="pl-smi">value</span>) {			</td>
      </tr>
      <tr>
        <td id="file-promise-4-js-L6" class="blob-num js-line-number" data-line-number="6"></td>
        <td id="file-promise-4-js-LC6" class="blob-code blob-code-inner js-file-line">	  <span class="pl-en">console</span><span class="pl-c1">.log</span>(value); <span class="pl-c">// Prints 1			</span></td>
      </tr>
      <tr class="alt">
        <td id="file-promise-4-js-L7" class="blob-num js-line-number" data-line-number="7"></td>
        <td id="file-promise-4-js-LC7" class="blob-code blob-code-inner js-file-line">	});</td>
      </tr>
</tbody></table>

  </div>

  </div>
  
</div>

      </div>
      <div class="gist-meta">
        <a href="https://gist.github.com/kavitshah8/e22dea9b95b0cbbc4261/raw/168b2976d3879207c43505e9f31d1c32c499b786/promise-4.js" style="float:right">view raw</a>
        <a href="https://gist.github.com/kavitshah8/e22dea9b95b0cbbc4261#file-promise-4-js">promise-4.js</a>
        hosted with ❤ by <a href="https://github.com">GitHub</a>
      </div>
    </div>
</div>

<script src="https://gist.github.com/e22dea9b95b0cbbc4261.js?file=promise-5.js"></script><link rel="stylesheet" href="https://assets-cdn.github.com/assets/gist/embed-3313cb70789df61d3bb75cd878325a1266ccab50b6aac9b80f1691ae0694a216.css"><div id="gist25056955" class="gist">
    <div class="gist-file">
      <div class="gist-data">
        <div class="js-gist-file-update-container js-task-list-container file-box">
  <div id="file-promise-5-js" class="file">
    

  <div class="blob-wrapper data type-javascript">
      <table class="highlight tab-size js-file-line-container" data-tab-size="8">
      <tbody><tr>
        <td id="file-promise-5-js-L1" class="blob-num js-line-number" data-line-number="1"></td>
        <td id="file-promise-5-js-LC1" class="blob-code blob-code-inner js-file-line"><span class="pl-k">var</span> p <span class="pl-k">=</span> Promise.resolve().then(<span class="pl-k">function</span>(<span class="pl-smi">value</span>) {			</td>
      </tr>
      <tr class="alt">
        <td id="file-promise-5-js-L2" class="blob-num js-line-number" data-line-number="2"></td>
        <td id="file-promise-5-js-LC2" class="blob-code blob-code-inner js-file-line">	  <span class="pl-k">return</span> <span class="pl-c1">1</span>;			</td>
      </tr>
      <tr>
        <td id="file-promise-5-js-L3" class="blob-num js-line-number" data-line-number="3"></td>
        <td id="file-promise-5-js-LC3" class="blob-code blob-code-inner js-file-line">	})			</td>
      </tr>
      <tr class="alt">
        <td id="file-promise-5-js-L4" class="blob-num js-line-number" data-line-number="4"></td>
        <td id="file-promise-5-js-LC4" class="blob-code blob-code-inner js-file-line">	.then(<span class="pl-k">function</span>(<span class="pl-smi">value</span>) {			</td>
      </tr>
      <tr>
        <td id="file-promise-5-js-L5" class="blob-num js-line-number" data-line-number="5"></td>
        <td id="file-promise-5-js-LC5" class="blob-code blob-code-inner js-file-line">	  <span class="pl-en">console</span><span class="pl-c1">.log</span>(<span class="pl-s"><span class="pl-pds">'</span>One<span class="pl-pds">'</span></span>, value); <span class="pl-c">// Prints One, 1			</span></td>
      </tr>
      <tr class="alt">
        <td id="file-promise-5-js-L6" class="blob-num js-line-number" data-line-number="6"></td>
        <td id="file-promise-5-js-LC6" class="blob-code blob-code-inner js-file-line">	})			</td>
      </tr>
      <tr>
        <td id="file-promise-5-js-L7" class="blob-num js-line-number" data-line-number="7"></td>
        <td id="file-promise-5-js-LC7" class="blob-code blob-code-inner js-file-line">	.then(<span class="pl-k">function</span>(<span class="pl-smi">value</span>) {			</td>
      </tr>
      <tr class="alt">
        <td id="file-promise-5-js-L8" class="blob-num js-line-number" data-line-number="8"></td>
        <td id="file-promise-5-js-LC8" class="blob-code blob-code-inner js-file-line">	  <span class="pl-en">console</span><span class="pl-c1">.log</span>(<span class="pl-s"><span class="pl-pds">'</span>Two<span class="pl-pds">'</span></span>, value); <span class="pl-c">// Prints Two, undefined			</span></td>
      </tr>
      <tr>
        <td id="file-promise-5-js-L9" class="blob-num js-line-number" data-line-number="9"></td>
        <td id="file-promise-5-js-LC9" class="blob-code blob-code-inner js-file-line">	});</td>
      </tr>
</tbody></table>

  </div>

  </div>
  
</div>

      </div>
      <div class="gist-meta">
        <a href="https://gist.github.com/kavitshah8/e22dea9b95b0cbbc4261/raw/168b2976d3879207c43505e9f31d1c32c499b786/promise-5.js" style="float:right">view raw</a>
        <a href="https://gist.github.com/kavitshah8/e22dea9b95b0cbbc4261#file-promise-5-js">promise-5.js</a>
        hosted with ❤ by <a href="https://github.com">GitHub</a>
      </div>
    </div>
</div>

<p>Things become a lit­tle more inter­est­ing when you return promises from within promises.<br>
<script src="https://gist.github.com/e22dea9b95b0cbbc4261.js?file=promise-6.js"></script><link rel="stylesheet" href="https://assets-cdn.github.com/assets/gist/embed-3313cb70789df61d3bb75cd878325a1266ccab50b6aac9b80f1691ae0694a216.css"></p><div id="gist25056955" class="gist">
    <div class="gist-file">
      <div class="gist-data">
        <div class="js-gist-file-update-container js-task-list-container file-box">
  <div id="file-promise-6-js" class="file">
    

  <div class="blob-wrapper data type-javascript">
      <table class="highlight tab-size js-file-line-container" data-tab-size="8">
      <tbody><tr class="alt">
        <td id="file-promise-6-js-L1" class="blob-num js-line-number" data-line-number="1"></td>
        <td id="file-promise-6-js-LC1" class="blob-code blob-code-inner js-file-line"><span class="pl-k">var</span> p <span class="pl-k">=</span> Promise.resolve(<span class="pl-c1">1</span>).then(<span class="pl-k">function</span>(<span class="pl-smi">value</span>) {			</td>
      </tr>
      <tr>
        <td id="file-promise-6-js-L2" class="blob-num js-line-number" data-line-number="2"></td>
        <td id="file-promise-6-js-LC2" class="blob-code blob-code-inner js-file-line">	  <span class="pl-en">console</span><span class="pl-c1">.log</span>(value); <span class="pl-c">// Prints 1			</span></td>
      </tr>
      <tr class="alt">
        <td id="file-promise-6-js-L3" class="blob-num js-line-number" data-line-number="3"></td>
        <td id="file-promise-6-js-LC3" class="blob-code blob-code-inner js-file-line">	  <span class="pl-k">return</span> Promise.resolve(<span class="pl-c1">2</span>);			</td>
      </tr>
      <tr>
        <td id="file-promise-6-js-L4" class="blob-num js-line-number" data-line-number="4"></td>
        <td id="file-promise-6-js-LC4" class="blob-code blob-code-inner js-file-line">	}).then(<span class="pl-k">function</span>(<span class="pl-smi">value</span>) {			</td>
      </tr>
      <tr class="alt">
        <td id="file-promise-6-js-L5" class="blob-num js-line-number" data-line-number="5"></td>
        <td id="file-promise-6-js-LC5" class="blob-code blob-code-inner js-file-line">	  <span class="pl-en">console</span><span class="pl-c1">.log</span>(value); <span class="pl-c">// Prints 2			</span></td>
      </tr>
      <tr>
        <td id="file-promise-6-js-L6" class="blob-num js-line-number" data-line-number="6"></td>
        <td id="file-promise-6-js-LC6" class="blob-code blob-code-inner js-file-line">	});</td>
      </tr>
</tbody></table>

  </div>

  </div>
  
</div>

      </div>
      <div class="gist-meta">
        <a href="https://gist.github.com/kavitshah8/e22dea9b95b0cbbc4261/raw/168b2976d3879207c43505e9f31d1c32c499b786/promise-6.js" style="float:right">view raw</a>
        <a href="https://gist.github.com/kavitshah8/e22dea9b95b0cbbc4261#file-promise-6-js">promise-6.js</a>
        hosted with ❤ by <a href="https://github.com">GitHub</a>
      </div>
    </div>
</div>
<p></p>
<p>In the above case, the inner promise of the first then block must get resolved before the suc­cess han­dler of the last then block can execute.</p>
<hr>
<h4>Promise.reject</h4>
<p>Repeat the sim­i­lar exer­cise for <code>Promise.reject()</code> call­back flows. I would encour­age you to try the exer­cise with <code>Promise.reject()</code> on your own and observe the behav­ior and come back to this arti­cle to com­pare your exercise.</p>
<script src="https://gist.github.com/e22dea9b95b0cbbc4261.js?file=promise-9.js"></script><link rel="stylesheet" href="https://assets-cdn.github.com/assets/gist/embed-3313cb70789df61d3bb75cd878325a1266ccab50b6aac9b80f1691ae0694a216.css"><div id="gist25056955" class="gist">
    <div class="gist-file">
      <div class="gist-data">
        <div class="js-gist-file-update-container js-task-list-container file-box">
  <div id="file-promise-9-js" class="file">
    

  <div class="blob-wrapper data type-javascript">
      <table class="highlight tab-size js-file-line-container" data-tab-size="8">
      <tbody><tr class="alt">
        <td id="file-promise-9-js-L1" class="blob-num js-line-number" data-line-number="1"></td>
        <td id="file-promise-9-js-LC1" class="blob-code blob-code-inner js-file-line"><span class="pl-k">var</span> p <span class="pl-k">=</span> Promise.reject().then(<span class="pl-k">function</span>() {			</td>
      </tr>
      <tr>
        <td id="file-promise-9-js-L2" class="blob-num js-line-number" data-line-number="2"></td>
        <td id="file-promise-9-js-LC2" class="blob-code blob-code-inner js-file-line">      	  <span class="pl-en">console</span><span class="pl-c1">.log</span>(<span class="pl-s"><span class="pl-pds">'</span>resolve1<span class="pl-pds">'</span></span>);	<span class="pl-c">// This does not get invoked		</span></td>
      </tr>
      <tr class="alt">
        <td id="file-promise-9-js-L3" class="blob-num js-line-number" data-line-number="3"></td>
        <td id="file-promise-9-js-LC3" class="blob-code blob-code-inner js-file-line">      	}, <span class="pl-k">function</span>() {			</td>
      </tr>
      <tr>
        <td id="file-promise-9-js-L4" class="blob-num js-line-number" data-line-number="4"></td>
        <td id="file-promise-9-js-LC4" class="blob-code blob-code-inner js-file-line">      	  <span class="pl-en">console</span><span class="pl-c1">.error</span>(<span class="pl-s"><span class="pl-pds">'</span>reject1<span class="pl-pds">'</span></span>);  <span class="pl-c">// Prints reject1			</span></td>
      </tr>
      <tr class="alt">
        <td id="file-promise-9-js-L5" class="blob-num js-line-number" data-line-number="5"></td>
        <td id="file-promise-9-js-LC5" class="blob-code blob-code-inner js-file-line">      	})			</td>
      </tr>
      <tr>
        <td id="file-promise-9-js-L6" class="blob-num js-line-number" data-line-number="6"></td>
        <td id="file-promise-9-js-LC6" class="blob-code blob-code-inner js-file-line">      	.catch(<span class="pl-k">function</span>() {			</td>
      </tr>
      <tr class="alt">
        <td id="file-promise-9-js-L7" class="blob-num js-line-number" data-line-number="7"></td>
        <td id="file-promise-9-js-LC7" class="blob-code blob-code-inner js-file-line">      	  <span class="pl-en">console</span><span class="pl-c1">.error</span>(<span class="pl-s"><span class="pl-pds">'</span>catch<span class="pl-pds">'</span></span>); 			</td>
      </tr>
      <tr>
        <td id="file-promise-9-js-L8" class="blob-num js-line-number" data-line-number="8"></td>
        <td id="file-promise-9-js-LC8" class="blob-code blob-code-inner js-file-line">      	});			</td>
      </tr>
</tbody></table>

  </div>

  </div>
  
</div>

      </div>
      <div class="gist-meta">
        <a href="https://gist.github.com/kavitshah8/e22dea9b95b0cbbc4261/raw/168b2976d3879207c43505e9f31d1c32c499b786/promise-9.js" style="float:right">view raw</a>
        <a href="https://gist.github.com/kavitshah8/e22dea9b95b0cbbc4261#file-promise-9-js">promise-9.js</a>
        hosted with ❤ by <a href="https://github.com">GitHub</a>
      </div>
    </div>
</div>

<p>When a promise is rejected and there is no error han­dler, none of the con­sec­u­tive suc­cess han­dlers in the chain are invoked <strong>until</strong> a fail­ure han­dler is encountered.</p>
<script src="https://gist.github.com/e22dea9b95b0cbbc4261.js?file=promise-10.js"></script><link rel="stylesheet" href="https://assets-cdn.github.com/assets/gist/embed-3313cb70789df61d3bb75cd878325a1266ccab50b6aac9b80f1691ae0694a216.css"><div id="gist25056955" class="gist">
    <div class="gist-file">
      <div class="gist-data">
        <div class="js-gist-file-update-container js-task-list-container file-box">
  <div id="file-promise-10-js" class="file">
    

  <div class="blob-wrapper data type-javascript">
      <table class="highlight tab-size js-file-line-container" data-tab-size="8">
      <tbody><tr class="alt">
        <td id="file-promise-10-js-L1" class="blob-num js-line-number" data-line-number="1"></td>
        <td id="file-promise-10-js-LC1" class="blob-code blob-code-inner js-file-line"><span class="pl-k">var</span> p <span class="pl-k">=</span> Promise.reject().then(<span class="pl-k">function</span> () {			</td>
      </tr>
      <tr>
        <td id="file-promise-10-js-L2" class="blob-num js-line-number" data-line-number="2"></td>
        <td id="file-promise-10-js-LC2" class="blob-code blob-code-inner js-file-line">            <span class="pl-en">console</span><span class="pl-c1">.log</span>(<span class="pl-s"><span class="pl-pds">'</span>resolve1<span class="pl-pds">'</span></span>);  <span class="pl-c">// This gets skipped due to rejection		</span></td>
      </tr>
      <tr class="alt">
        <td id="file-promise-10-js-L3" class="blob-num js-line-number" data-line-number="3"></td>
        <td id="file-promise-10-js-LC3" class="blob-code blob-code-inner js-file-line">	})			</td>
      </tr>
      <tr>
        <td id="file-promise-10-js-L4" class="blob-num js-line-number" data-line-number="4"></td>
        <td id="file-promise-10-js-LC4" class="blob-code blob-code-inner js-file-line">	.then(<span class="pl-k">function</span> () {			</td>
      </tr>
      <tr class="alt">
        <td id="file-promise-10-js-L5" class="blob-num js-line-number" data-line-number="5"></td>
        <td id="file-promise-10-js-LC5" class="blob-code blob-code-inner js-file-line">	      <span class="pl-en">console</span><span class="pl-c1">.log</span>(<span class="pl-s"><span class="pl-pds">'</span>resolve2<span class="pl-pds">'</span></span>);  <span class="pl-c">// This also gets skipped</span></td>
      </tr>
      <tr>
        <td id="file-promise-10-js-L6" class="blob-num js-line-number" data-line-number="6"></td>
        <td id="file-promise-10-js-LC6" class="blob-code blob-code-inner js-file-line">	}, <span class="pl-k">function</span> () {			</td>
      </tr>
      <tr class="alt">
        <td id="file-promise-10-js-L7" class="blob-num js-line-number" data-line-number="7"></td>
        <td id="file-promise-10-js-LC7" class="blob-code blob-code-inner js-file-line">	      <span class="pl-en">console</span><span class="pl-c1">.error</span>(<span class="pl-s"><span class="pl-pds">'</span>reject2<span class="pl-pds">'</span></span>); <span class="pl-c">// Prints reject2			</span></td>
      </tr>
      <tr>
        <td id="file-promise-10-js-L8" class="blob-num js-line-number" data-line-number="8"></td>
        <td id="file-promise-10-js-LC8" class="blob-code blob-code-inner js-file-line">	})			</td>
      </tr>
      <tr class="alt">
        <td id="file-promise-10-js-L9" class="blob-num js-line-number" data-line-number="9"></td>
        <td id="file-promise-10-js-LC9" class="blob-code blob-code-inner js-file-line">	.catch(<span class="pl-k">function</span> () {		</td>
      </tr>
      <tr>
        <td id="file-promise-10-js-L10" class="blob-num js-line-number" data-line-number="10"></td>
        <td id="file-promise-10-js-LC10" class="blob-code blob-code-inner js-file-line">            <span class="pl-c">// This gets skipped because a previous error handler caught the failed promise</span></td>
      </tr>
      <tr class="alt">
        <td id="file-promise-10-js-L11" class="blob-num js-line-number" data-line-number="11"></td>
        <td id="file-promise-10-js-LC11" class="blob-code blob-code-inner js-file-line">	      <span class="pl-en">console</span><span class="pl-c1">.error</span>(<span class="pl-s"><span class="pl-pds">'</span>catch<span class="pl-pds">'</span></span>);		</td>
      </tr>
      <tr>
        <td id="file-promise-10-js-L12" class="blob-num js-line-number" data-line-number="12"></td>
        <td id="file-promise-10-js-LC12" class="blob-code blob-code-inner js-file-line">	});</td>
      </tr>
</tbody></table>

  </div>

  </div>
  
</div>

      </div>
      <div class="gist-meta">
        <a href="https://gist.github.com/kavitshah8/e22dea9b95b0cbbc4261/raw/168b2976d3879207c43505e9f31d1c32c499b786/promise-10.js" style="float:right">view raw</a>
        <a href="https://gist.github.com/kavitshah8/e22dea9b95b0cbbc4261#file-promise-10-js">promise-10.js</a>
        hosted with ❤ by <a href="https://github.com">GitHub</a>
      </div>
    </div>
</div>

<p>Here’s another exam­ple where you just have a catch func­tion at the end of the chain. This behaves very sim­i­lar to a finally clause.</p>
<script src="https://gist.github.com/e22dea9b95b0cbbc4261.js?file=promise-11.js"></script><link rel="stylesheet" href="https://assets-cdn.github.com/assets/gist/embed-3313cb70789df61d3bb75cd878325a1266ccab50b6aac9b80f1691ae0694a216.css"><div id="gist25056955" class="gist">
    <div class="gist-file">
      <div class="gist-data">
        <div class="js-gist-file-update-container js-task-list-container file-box">
  <div id="file-promise-11-js" class="file">
    

  <div class="blob-wrapper data type-javascript">
      <table class="highlight tab-size js-file-line-container" data-tab-size="8">
      <tbody><tr class="alt">
        <td id="file-promise-11-js-L1" class="blob-num js-line-number" data-line-number="1"></td>
        <td id="file-promise-11-js-LC1" class="blob-code blob-code-inner js-file-line"><span class="pl-k">var</span> p <span class="pl-k">=</span> Promise.reject().then(<span class="pl-k">function</span> () {			</td>
      </tr>
      <tr>
        <td id="file-promise-11-js-L2" class="blob-num js-line-number" data-line-number="2"></td>
        <td id="file-promise-11-js-LC2" class="blob-code blob-code-inner js-file-line">      	      <span class="pl-en">console</span><span class="pl-c1">.log</span>(<span class="pl-s"><span class="pl-pds">'</span>resolve1<span class="pl-pds">'</span></span>);			</td>
      </tr>
      <tr class="alt">
        <td id="file-promise-11-js-L3" class="blob-num js-line-number" data-line-number="3"></td>
        <td id="file-promise-11-js-LC3" class="blob-code blob-code-inner js-file-line">      	})			</td>
      </tr>
      <tr>
        <td id="file-promise-11-js-L4" class="blob-num js-line-number" data-line-number="4"></td>
        <td id="file-promise-11-js-LC4" class="blob-code blob-code-inner js-file-line">      	.then(<span class="pl-k">function</span> () {			</td>
      </tr>
      <tr class="alt">
        <td id="file-promise-11-js-L5" class="blob-num js-line-number" data-line-number="5"></td>
        <td id="file-promise-11-js-LC5" class="blob-code blob-code-inner js-file-line">                  <span class="pl-en">console</span><span class="pl-c1">.log</span>(<span class="pl-s"><span class="pl-pds">'</span>resolve2<span class="pl-pds">'</span></span>);			</td>
      </tr>
      <tr>
        <td id="file-promise-11-js-L6" class="blob-num js-line-number" data-line-number="6"></td>
        <td id="file-promise-11-js-LC6" class="blob-code blob-code-inner js-file-line">      	})			</td>
      </tr>
      <tr class="alt">
        <td id="file-promise-11-js-L7" class="blob-num js-line-number" data-line-number="7"></td>
        <td id="file-promise-11-js-LC7" class="blob-code blob-code-inner js-file-line">      	.then(<span class="pl-k">function</span> () {			</td>
      </tr>
      <tr>
        <td id="file-promise-11-js-L8" class="blob-num js-line-number" data-line-number="8"></td>
        <td id="file-promise-11-js-LC8" class="blob-code blob-code-inner js-file-line">      	      <span class="pl-en">console</span><span class="pl-c1">.log</span>(<span class="pl-s"><span class="pl-pds">'</span>resolve3<span class="pl-pds">'</span></span>);			</td>
      </tr>
      <tr class="alt">
        <td id="file-promise-11-js-L9" class="blob-num js-line-number" data-line-number="9"></td>
        <td id="file-promise-11-js-LC9" class="blob-code blob-code-inner js-file-line">      	})			</td>
      </tr>
      <tr>
        <td id="file-promise-11-js-L10" class="blob-num js-line-number" data-line-number="10"></td>
        <td id="file-promise-11-js-LC10" class="blob-code blob-code-inner js-file-line">      	.catch(<span class="pl-k">function</span> () {			</td>
      </tr>
      <tr class="alt">
        <td id="file-promise-11-js-L11" class="blob-num js-line-number" data-line-number="11"></td>
        <td id="file-promise-11-js-LC11" class="blob-code blob-code-inner js-file-line">      	      <span class="pl-en">console</span><span class="pl-c1">.log</span>(<span class="pl-s"><span class="pl-pds">'</span>catch<span class="pl-pds">'</span></span>); <span class="pl-c">// Prints catch			</span></td>
      </tr>
      <tr>
        <td id="file-promise-11-js-L12" class="blob-num js-line-number" data-line-number="12"></td>
        <td id="file-promise-11-js-LC12" class="blob-code blob-code-inner js-file-line">      	});		</td>
      </tr>
</tbody></table>

  </div>

  </div>
  
</div>

      </div>
      <div class="gist-meta">
        <a href="https://gist.github.com/kavitshah8/e22dea9b95b0cbbc4261/raw/168b2976d3879207c43505e9f31d1c32c499b786/promise-11.js" style="float:right">view raw</a>
        <a href="https://gist.github.com/kavitshah8/e22dea9b95b0cbbc4261#file-promise-11-js">promise-11.js</a>
        hosted with ❤ by <a href="https://github.com">GitHub</a>
      </div>
    </div>
</div>

<p>Once a promise fail­ure is han­dled, sub­se­quence items in the chain can pro­ceed as nor­mal. For example</p>
<script src="https://gist.github.com/e22dea9b95b0cbbc4261.js?file=promise-12.js"></script><link rel="stylesheet" href="https://assets-cdn.github.com/assets/gist/embed-3313cb70789df61d3bb75cd878325a1266ccab50b6aac9b80f1691ae0694a216.css"><div id="gist25056955" class="gist">
    <div class="gist-file">
      <div class="gist-data">
        <div class="js-gist-file-update-container js-task-list-container file-box">
  <div id="file-promise-12-js" class="file">
    

  <div class="blob-wrapper data type-javascript">
      <table class="highlight tab-size js-file-line-container" data-tab-size="8">
      <tbody><tr class="alt">
        <td id="file-promise-12-js-L1" class="blob-num js-line-number" data-line-number="1"></td>
        <td id="file-promise-12-js-LC1" class="blob-code blob-code-inner js-file-line"><span class="pl-k">var</span> p <span class="pl-k">=</span> Promise.reject()			</td>
      </tr>
      <tr>
        <td id="file-promise-12-js-L2" class="blob-num js-line-number" data-line-number="2"></td>
        <td id="file-promise-12-js-LC2" class="blob-code blob-code-inner js-file-line">      	.then(<span class="pl-k">function</span> () {			</td>
      </tr>
      <tr class="alt">
        <td id="file-promise-12-js-L3" class="blob-num js-line-number" data-line-number="3"></td>
        <td id="file-promise-12-js-LC3" class="blob-code blob-code-inner js-file-line">      	      <span class="pl-en">console</span><span class="pl-c1">.log</span>(<span class="pl-s"><span class="pl-pds">'</span>resolve1<span class="pl-pds">'</span></span>);			</td>
      </tr>
      <tr>
        <td id="file-promise-12-js-L4" class="blob-num js-line-number" data-line-number="4"></td>
        <td id="file-promise-12-js-LC4" class="blob-code blob-code-inner js-file-line">      	}, <span class="pl-k">function</span> () {			</td>
      </tr>
      <tr class="alt">
        <td id="file-promise-12-js-L5" class="blob-num js-line-number" data-line-number="5"></td>
        <td id="file-promise-12-js-LC5" class="blob-code blob-code-inner js-file-line">      	      <span class="pl-en">console</span><span class="pl-c1">.log</span>(<span class="pl-s"><span class="pl-pds">'</span>reject1<span class="pl-pds">'</span></span>); <span class="pl-c">// Prints reject1			</span></td>
      </tr>
      <tr>
        <td id="file-promise-12-js-L6" class="blob-num js-line-number" data-line-number="6"></td>
        <td id="file-promise-12-js-LC6" class="blob-code blob-code-inner js-file-line">      	})			</td>
      </tr>
      <tr class="alt">
        <td id="file-promise-12-js-L7" class="blob-num js-line-number" data-line-number="7"></td>
        <td id="file-promise-12-js-LC7" class="blob-code blob-code-inner js-file-line">      	.then(<span class="pl-k">function</span> () {			</td>
      </tr>
      <tr>
        <td id="file-promise-12-js-L8" class="blob-num js-line-number" data-line-number="8"></td>
        <td id="file-promise-12-js-LC8" class="blob-code blob-code-inner js-file-line">      	      <span class="pl-en">console</span><span class="pl-c1">.log</span>(<span class="pl-s"><span class="pl-pds">'</span>resolve2<span class="pl-pds">'</span></span>); <span class="pl-c">// Prints resolve2			</span></td>
      </tr>
      <tr class="alt">
        <td id="file-promise-12-js-L9" class="blob-num js-line-number" data-line-number="9"></td>
        <td id="file-promise-12-js-LC9" class="blob-code blob-code-inner js-file-line">      	}, <span class="pl-k">function</span> () {			</td>
      </tr>
      <tr>
        <td id="file-promise-12-js-L10" class="blob-num js-line-number" data-line-number="10"></td>
        <td id="file-promise-12-js-LC10" class="blob-code blob-code-inner js-file-line">      	      <span class="pl-en">console</span><span class="pl-c1">.log</span>(<span class="pl-s"><span class="pl-pds">'</span>reject2<span class="pl-pds">'</span></span>);			</td>
      </tr>
      <tr class="alt">
        <td id="file-promise-12-js-L11" class="blob-num js-line-number" data-line-number="11"></td>
        <td id="file-promise-12-js-LC11" class="blob-code blob-code-inner js-file-line">      	})			</td>
      </tr>
      <tr>
        <td id="file-promise-12-js-L12" class="blob-num js-line-number" data-line-number="12"></td>
        <td id="file-promise-12-js-LC12" class="blob-code blob-code-inner js-file-line">      	.catch(<span class="pl-k">function</span> () {			</td>
      </tr>
      <tr class="alt">
        <td id="file-promise-12-js-L13" class="blob-num js-line-number" data-line-number="13"></td>
        <td id="file-promise-12-js-LC13" class="blob-code blob-code-inner js-file-line">      	      <span class="pl-en">console</span><span class="pl-c1">.log</span>(<span class="pl-s"><span class="pl-pds">'</span>catch<span class="pl-pds">'</span></span>);			</td>
      </tr>
      <tr>
        <td id="file-promise-12-js-L14" class="blob-num js-line-number" data-line-number="14"></td>
        <td id="file-promise-12-js-LC14" class="blob-code blob-code-inner js-file-line">      	});</td>
      </tr>
</tbody></table>

  </div>

  </div>
  
</div>

      </div>
      <div class="gist-meta">
        <a href="https://gist.github.com/kavitshah8/e22dea9b95b0cbbc4261/raw/168b2976d3879207c43505e9f31d1c32c499b786/promise-12.js" style="float:right">view raw</a>
        <a href="https://gist.github.com/kavitshah8/e22dea9b95b0cbbc4261#file-promise-12-js">promise-12.js</a>
        hosted with ❤ by <a href="https://github.com">GitHub</a>
      </div>
    </div>
</div>

<hr>
<h4>Spe­cial&nbsp;Case</h4>
<p>In the exam­ples above, you’ve seen that when you return some­thing from within a then block, the next suc­cess han­dler receives that value. There is only one spe­cial case under which this fact does not hold true, and that is when the argu­ment to then is null. In such cases, the first then block in the promise chain that has a func­tion as a han­dler receives the&nbsp;value.</p>
<p>Nor­mally, this is what happens</p>
<script src="https://gist.github.com/e22dea9b95b0cbbc4261.js?file=promise-7.js"></script><link rel="stylesheet" href="https://assets-cdn.github.com/assets/gist/embed-3313cb70789df61d3bb75cd878325a1266ccab50b6aac9b80f1691ae0694a216.css"><div id="gist25056955" class="gist">
    <div class="gist-file">
      <div class="gist-data">
        <div class="js-gist-file-update-container js-task-list-container file-box">
  <div id="file-promise-7-js" class="file">
    

  <div class="blob-wrapper data type-javascript">
      <table class="highlight tab-size js-file-line-container" data-tab-size="8">
      <tbody><tr class="alt">
        <td id="file-promise-7-js-L1" class="blob-num js-line-number" data-line-number="1"></td>
        <td id="file-promise-7-js-LC1" class="blob-code blob-code-inner js-file-line"><span class="pl-k">var</span> p <span class="pl-k">=</span> Promise.resolve(<span class="pl-c1">1</span>).then(<span class="pl-k">function</span>(<span class="pl-smi">value</span>) {			</td>
      </tr>
      <tr>
        <td id="file-promise-7-js-L2" class="blob-num js-line-number" data-line-number="2"></td>
        <td id="file-promise-7-js-LC2" class="blob-code blob-code-inner js-file-line">	  <span class="pl-en">console</span><span class="pl-c1">.log</span>(value); <span class="pl-c">// Prints 1						</span></td>
      </tr>
      <tr class="alt">
        <td id="file-promise-7-js-L3" class="blob-num js-line-number" data-line-number="3"></td>
        <td id="file-promise-7-js-LC3" class="blob-code blob-code-inner js-file-line">	}).then(<span class="pl-k">function</span>(<span class="pl-smi">value</span>) {			</td>
      </tr>
      <tr>
        <td id="file-promise-7-js-L4" class="blob-num js-line-number" data-line-number="4"></td>
        <td id="file-promise-7-js-LC4" class="blob-code blob-code-inner js-file-line">         <span class="pl-c">// Prints undefined because nothing was returned in the previous promise</span></td>
      </tr>
      <tr class="alt">
        <td id="file-promise-7-js-L5" class="blob-num js-line-number" data-line-number="5"></td>
        <td id="file-promise-7-js-LC5" class="blob-code blob-code-inner js-file-line">	  <span class="pl-en">console</span><span class="pl-c1">.log</span>(value);</td>
      </tr>
      <tr>
        <td id="file-promise-7-js-L6" class="blob-num js-line-number" data-line-number="6"></td>
        <td id="file-promise-7-js-LC6" class="blob-code blob-code-inner js-file-line">	});</td>
      </tr>
</tbody></table>

  </div>

  </div>
  
</div>

      </div>
      <div class="gist-meta">
        <a href="https://gist.github.com/kavitshah8/e22dea9b95b0cbbc4261/raw/168b2976d3879207c43505e9f31d1c32c499b786/promise-7.js" style="float:right">view raw</a>
        <a href="https://gist.github.com/kavitshah8/e22dea9b95b0cbbc4261#file-promise-7-js">promise-7.js</a>
        hosted with ❤ by <a href="https://github.com">GitHub</a>
      </div>
    </div>
</div>

<p>But when you inter­leave then’s with null call­backs, the behav­iour changes slightly</p>
<script src="https://gist.github.com/e22dea9b95b0cbbc4261.js?file=promise-8.js"></script><link rel="stylesheet" href="https://assets-cdn.github.com/assets/gist/embed-3313cb70789df61d3bb75cd878325a1266ccab50b6aac9b80f1691ae0694a216.css"><div id="gist25056955" class="gist">
    <div class="gist-file">
      <div class="gist-data">
        <div class="js-gist-file-update-container js-task-list-container file-box">
  <div id="file-promise-8-js" class="file">
    

  <div class="blob-wrapper data type-javascript">
      <table class="highlight tab-size js-file-line-container" data-tab-size="8">
      <tbody><tr class="alt">
        <td id="file-promise-8-js-L1" class="blob-num js-line-number" data-line-number="1"></td>
        <td id="file-promise-8-js-LC1" class="blob-code blob-code-inner js-file-line"><span class="pl-k">var</span> p <span class="pl-k">=</span> Promise.resolve(<span class="pl-c1">1</span>)		</td>
      </tr>
      <tr>
        <td id="file-promise-8-js-L2" class="blob-num js-line-number" data-line-number="2"></td>
        <td id="file-promise-8-js-LC2" class="blob-code blob-code-inner js-file-line">	.then(<span class="pl-c1">null</span>)			</td>
      </tr>
      <tr class="alt">
        <td id="file-promise-8-js-L3" class="blob-num js-line-number" data-line-number="3"></td>
        <td id="file-promise-8-js-LC3" class="blob-code blob-code-inner js-file-line">	.then(<span class="pl-c1">null</span>)			</td>
      </tr>
      <tr>
        <td id="file-promise-8-js-L4" class="blob-num js-line-number" data-line-number="4"></td>
        <td id="file-promise-8-js-LC4" class="blob-code blob-code-inner js-file-line">	.then(<span class="pl-k">function</span>(<span class="pl-smi">value</span>) {			</td>
      </tr>
      <tr class="alt">
        <td id="file-promise-8-js-L5" class="blob-num js-line-number" data-line-number="5"></td>
        <td id="file-promise-8-js-LC5" class="blob-code blob-code-inner js-file-line">	  <span class="pl-en">console</span><span class="pl-c1">.log</span>(value); <span class="pl-c">// Prints 1			</span></td>
      </tr>
      <tr>
        <td id="file-promise-8-js-L6" class="blob-num js-line-number" data-line-number="6"></td>
        <td id="file-promise-8-js-LC6" class="blob-code blob-code-inner js-file-line">	})</td>
      </tr>
      <tr class="alt">
        <td id="file-promise-8-js-L7" class="blob-num js-line-number" data-line-number="7"></td>
        <td id="file-promise-8-js-LC7" class="blob-code blob-code-inner js-file-line">	.then(<span class="pl-k">function</span>(<span class="pl-smi">value</span>) {			</td>
      </tr>
      <tr>
        <td id="file-promise-8-js-L8" class="blob-num js-line-number" data-line-number="8"></td>
        <td id="file-promise-8-js-LC8" class="blob-code blob-code-inner js-file-line">	  <span class="pl-en">console</span><span class="pl-c1">.log</span>(value); <span class="pl-c">// Prints undefined			</span></td>
      </tr>
      <tr class="alt">
        <td id="file-promise-8-js-L9" class="blob-num js-line-number" data-line-number="9"></td>
        <td id="file-promise-8-js-LC9" class="blob-code blob-code-inner js-file-line">	});</td>
      </tr>
</tbody></table>

  </div>

  </div>
  
</div>

      </div>
      
    </div>
</div>

<hr>
													</div>
						<div class="clear"></div>				
					</div><!--/.entry-->
					
				</div>
			</div>
			<!--========================= END : POST		=============================-->
			<!--=========================			START : POST		=============================-->
		<div class="post-wrapper">
			</div>
			<!--========================= END : POST		=============================-->
			<!--=========================			START : POST		=============================-->
		<div class="post-wrapper">
			</div>
			<!--========================= END : POST		=============================-->
			<!--=========================			START : POST		=============================-->
		<div class="post-wrapper">
			</div>
			<!--========================= END : POST		=============================-->
			<!--=========================			START : POST		=============================-->
		<div class="post-wrapper">
			</div>
			<!--========================= END : POST		=============================-->
			</body></html>