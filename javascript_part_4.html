<html><head>
		<meta charset="utf-8">
		<title>Javascript Book :: Part 4</title>
		<meta name="title" content="">
		<meta name="description" content="">
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<!--<link href='https://fonts.googleapis.com/css?family=Open+Sans:400,600,700' rel='stylesheet' type='text/css'>
		<link href="https://fonts.googleapis.com/css?family=PT+Sans:400,400i,700,700i|PT+Serif:400,700" rel="stylesheet">-->
		<style>
* { box-sizing: border-box; }
body { 
	font-family: 'Open Sans', Arial, sans-serif;
	font-size: 14px;
	line-height: 1.7;
	padding: 0.5em;
	font-family: 'PT Sans', Arial, sans-serif;
	
}
em, strong { font-weight: bold; }
h1 { font-size: 1.6em; font-family: 'PT Serif', Arial, serif; padding: 10px 0; margin: 0; }
h2, h3, h6 { 
	font-size: 1.3em;
	font-family: 'PT Serif', Arial, serif;
	padding-left: 1em;
	border-left: 2px solid #868686; 
}
img { display: block; margin: 0 auto; max-width: 100%; }
pre { 
	border: 1px dashed #333; 
	padding: 1em 2em; 
	font-family: Consolas,monospace; 
	background-color: #EEE; 
	overflow-x: scroll; 
	font-size: 14px;  
	white-space: pre-wrap; 
	word-wrap: break-word; 
}
pre {
    -moz-box-sizing: border-box;
    box-sizing: border-box;
    margin: 1em auto;
    border: 1px dashed #333;
    width: 100%;
    padding: 1em 1.5em;
    font-family: Inconsolata, Consolas, monospace, sans-serif;
    font-size: 1em;
	line-height: 1.5;
    overflow: auto;
    background: #F7FAFB;
    border-radius: 3px;
	position:relative;
}
code { 
	background-color: #EEE;
    font-family: Consolas,monospace;
    border: solid 1px #CCC;
    padding: 0 8px;
    border-radius: 3px;
    display: inline-block;
    font-size: 14px;
}
pre code { background-color: transparent; padding: 0; display: block; border: 0px solid; }
pre:after {
	content: "<CODE>";
	position: absolute;
	top:0;
	right: 0;
	padding: 5px 15px;
	background: #999;
	color: #FFF;
}

.home-screen { border: 1px solid #777; padding: 4em 0; margin: 2em 0; }
.home-screen * { font-family: 'PT Sans', Arial, sans-serif; font-size: 3em; font-weight: normal; }

/* = Index
-------------------------------*/
.tutorial-index {
	counter-reset: section;
}
.tutorial-index h1:before {
    /*counter-increment: section;
    content: counter(section) " : ";*/
}
.tutorial-index h1 {font-size: 1.2em; padding: 5px 0; font-family: 'Open Sans', Arial, sans-serif; line-height: normal;}
.tutorial-index a { display: block; float: left; width: 50%;}
.tutorial-index a { text-decoration: none; }


/* = Main
-------------------------------*/
.main { counter-reset: mainsection; }
.main h1 { font-size: 1.6em; border-bottom: 2px solid #000; font-family: 'PT Serif', Arial, serif; padding: 10px 0; margin: 0; }
.main h1:before {
    /*counter-increment: mainsection;
    content: counter(mainsection) " : ";
	*/
}

/* = ClearFix
-------------------------------*/
.cf:before,
.cf:after {
    content: " ";
    display: table;
}
.cf:after {
    clear: both;
}
.tc { text-align: center}

/* = TABLE
-------------------------------*/
table { width: 100%; max-width: 100%; margin: 1em 0; border-collapse: collapse;}
table td, table th { border: 1px solid #cdcfd0; padding: 10px; font-size: 14px; }
table th { border-bottom-width: 2px; background-color: #e8e9ea; }
table tr:nth-of-type(odd) {
    background-color: #f9f9f9;
}
@media print {
    .main article h1 { 
		page-break-before: always; 
	}
	pre, code, pre code, pre span, code span, pre code span {
		/*page-break-inside: avoid;
		-webkit-column-break-inside : avoid;*/
	}
}
		</style>
	</head>
	<body>
		<div class="links tc"><a href="javascript_part_3.html">Part 3</a> | <a href="javascript_part_4.html">Part 4</a> | <a href="javascript_part_5.html">Part 5</a> | <a href="ES6-javascript_part_6.html">Part 6</a></div>
	
		<div class="home-screen tc">
			<h1>JavaScript Tutorials</h1>
			<h4>- Part 4 -</h4>
		</div>
		<!--================= START :: Tutorial Index =================-->
<div class="tutorial-index cf">
	<a href="#t-01"><h1>01 : Functional Concepts For JavaScript Developers: Currying</h1></a>
	<a href="#t-02"><h1>02 : Currying vs partial application</h1></a>
	<a href="#t-03"><h1>03 : Binding objects to functions</h1></a>
	<a href="#t-04"><h1>04 : Currying vs Partial Application</h1></a>
	<a href="#t-05"><h1>05 : What's the difference between Currying and Partial Application?</h1></a>
	<a href="#t-06"><h1>06 : Approaches to currying in JavaScript</h1></a>
	<a href="#t-07"><h1>07 : 7 Essential JavaScript Functions</h1></a>
	<a href="#t-08"><h1>08 : Collection of useful JavaScript functions and patterns</h1></a>
	<a href="#t-09"><h1>09 : My todays top 10 most useful Javascript Functions</h1></a>
	<a href="#t-10"><h1>10 : 12 Extremely Useful Hacks for JavaScript</h1></a>
	<a href="#t-11"><h1>11 : 45 Useful JavaScript Tips, Tricks and Best Practices</h1></a>
	<a href="#t-12"><h1>12 : JavaScript Architecture for the 23rd Century</h1></a>
	<a href="#t-13"><h1>13 : 9 New Array Functions in ES6</h1></a>
	<a href="#t-14"><h1>14 : Implementing EventEmitter in ES6</h1></a>
	<a href="#t-15"><h1>15 : Getting Functional with Javascript (Part 1)</h1></a>
	<a href="#t-16"><h1>16 : Getting Functional with Javascript (Part 2)</h1></a>
	<a href="#t-17"><h1>17 : Understanding Prototypes, Delegation &amp; Composition</h1></a>
	<a href="#t-18"><h1>18 : Some jQuery Functions And Their JavaScript Equivalents</h1></a>
	<a href="#t-19"><h1>19 : Is everything in JavaScript an Object?</h1></a>
	<a href="#t-20"><h1>20 : Partial Application with Function#bind</h1></a>
	<a href="#t-21"><h1>21 : Partial Application in JavaScript</h1></a>
	<a href="#t-22"><h1>22 : Composing Functions in JavaScript</h1></a>
	<a href="#t-23"><h1>23 : A JavaScript Invoke Function</h1></a>
	<a href="#t-24"><h1>24 : YOU MIGHT NOT NEED JQUERY</h1></a>
	<a href="#t-25"><h1>25 : The JavaScript Bind Function</h1></a>
	<a href="#t-26"><h1>26 : Forcing Function Arity in JavaScript</h1></a>
	<a href="#t-27"><h1>27 : Wrapping JavaScript Functions</h1></a>
	<a href="#t-28"><h1>28 : Javascript : Basic Scope</h1></a>
	<a href="#t-29"><h1>29 : Part 2 : Functions</h1></a>
	<a href="#t-30"><h1>30 : Part 3 : .map, .reduce &amp; .filter, Oh My!</h1></a>
	<a href="#t-31"><h1>31 : Part 4 : Object-ively Javascript</h1></a>
	<a href="#t-32"><h1>32 : Chapter 4: Currying</h1></a>
	<a href="#t-33"><h1>33 : Chapter 5: Coding by Composing</h1></a>
	<a href="#t-34"><h1>34 : Functional Mixins in ECMAScript 2015</h1></a>
	<a href="#t-35"><h1>35 : JavaScript Mixins, Subclass Factories, and Method Advice</h1></a>
	<a href="#t-36"><h1>36 : Compose me That: Function Composition in JavaScript</h1></a>
	<a href="#t-37"><h1>37 : Curry me This: Partial Application in JavaScript</h1></a>
	<a href="#t-38"><h1>38 : Functional Data Structures in JavaScript: The Basics</h1></a>
	<a href="#t-39"><h1>39 : Model-View-Controller (MVC) with JavaScript</h1></a>
	<a href="#t-40"><h1>40 : JavaScript Function Memoization</h1></a>
	<a href="#t-41"><h1>41 : Javascript Memoization</h1></a>
	<a href="#t-42"><h1>42 : Hello World : A "Hello World"-like example of Javascript using the MVC pattern.</h1></a>
	<a href="#t-43"><h1>43 : JavaScript's Magical Tips Every Developer Should Remember</h1></a>
	<a href="#t-44"><h1>44 : 5 Features You Can Use in ES6 Today</h1></a>
	<a href="#t-45"><h1>45 : Asynchronous in the Browser</h1></a>
	<a href="#t-46"><h1>46 : The Basics of DOM Manipulation in Vanilla JavaScript (No jQuery)</h1></a>
	<a href="#t-47"><h1>47 : Functional Programming Jargon</h1></a>
	<a href="#t-48"><h1>48 : ES6 Object Destructuring</h1></a>
	<a href="#t-49"><h1>49 : ECMAScript 6 equivalents in ES5</h1></a>
	<a href="#t-50"><h1>50 : JavaScript Inheritance Done Right</h1></a>
	<a href="#t-51"><h1>51 : Javascript Inheritance Done Right</h1></a>
	<a href="#t-52"><h1>52 : Basic Inheritance with JavaScript Constructors</h1></a>
	<a href="#t-53"><h1>53 : Call and Apply for Beginners</h1></a>
	<a href="#t-54"><h1>54 : Understanding JavaScript Constructors</h1></a>
	<a href="#t-55"><h1>55 : Functions as First Class Citizens in Javascript</h1></a>
	<a href="#t-56"><h1>56 : Quick Tip: How JavaScript References Work</h1></a>
	<a href="#t-57"><h1>57 : JavaScript. The core.</h1></a>
	<a href="#t-58"><h1>58 : Understanding Scopes</h1></a>	
	<a href="#t-59"><h1>59 : Monkey-Patching, Overriding, and Decorating Methods in JavaScript</h1></a>
	
	<a href="#t-60"><h1>60 : Functional Programming in JavaScript</h1></a>
	<a href="#t-61"><h1>61 : Design Patterns - The Adapter Pattern in JavaScript</h1></a>
	<a href="#t-62"><h1>62 : Design Patterns - The Factory Pattern in JavaScript</h1></a>
	<a href="#t-63"><h1>63 : Demystifying JavaScript Variable Scope and Hoisting</h1></a>
	<a href="#t-64"><h1>64 : A Plain English Guide to JavaScript Prototypes</h1></a>
	<a href="#t-65"><h1>65 : The Intuitive Proto Object in JavaScript</h1></a>
	<a href="#t-66"><h1>66 : Understanding the JavaScript Prototype Chain & Inheritance</h1></a>
	<a href="#t-67"><h1>67 : Explaining JavaScript Closure & Scope Chain with Examples</h1></a>
	<a href="#t-68"><h1>68 : JavaScript: Why Understanding Scope And Closures Matter</h1></a>	
	<a href="#t-69"><h1>69 : Prototype and Prototypal Inheritance</h1></a>
	<a href="#t-70"><h1>70 : JavaScript Algorithms : Singly Linked List</h1></a>	
	<a href="#t-71"><h1>71 : Call, Apply and Bind</h1></a>
	<a href="#t-72"><h1>72 : JavaScript constructors, prototypes, and the `new` keyword</h1></a>
	<a href="#t-73"><h1>73 : Understanding the prototype property in JavaScript</h1></a>
	<a href="#t-74"><h1>74 : Prototypal Object-Oriented Programming using JavaScrip</h1></a>
	<a href="#t-75"><h1>75 : A Deeper Look at Objects in JavaScript</h1></a>
	<a href="#t-76"><h1>76 : Javascript Promises</h1></a>
	<a href="#t-77"><h1>77 : About null and undefined</h1></a>
	<a href="#t-78"><h1>78 : How to avoid infinite nesting callbacks</h1></a>
	<a href="#t-79"><h1>79 : Should I use === or == equality comparison operator in JavaScript?</h1></a>
	
	<a href="#t-80"><h1>80 : Prototypes are Objects (and why that matters)</h1></a>
	<a href="#t-81"><h1>81 : Introduction to the Principles of Object-Oriented Design. Classes</h1></a>
	<a href="#t-82"><h1>82 : Object-oriented JavaScript for C# Developers</h1></a>
	<a href="#t-83"><h1>83 : The Basic Ingredients of JavaScript-Mancy: An Introduction to JavaScript and ES 6 for C# Developers</h1></a>
	<a href="#t-84"><h1>84 : Mastering the Arcane Art of JavaScript-mancy for C# Developers - Chapter 1: The Many a One JavaScript Quirks</h1></a>
	<a href="#t-85"><h1>85 : Summoning Fundamentals: A Three Part Introduction to OOP in JavaScript - Encapsulation</h1></a>
	<a href="#t-86"><h1>86 : Summoning Fundamentals: A Three Part Introduction to OOP in JavaScript - II - Prototypical Inheritance</h1></a>
	<a href="#t-87"><h1>87 : Summoning Fundamentals: A Three Part Introduction to OOP in JavaScript for C# Developers - III - Polymorphism</h1></a>
	<a href="#t-88"><h1>88 : White Tower Summoning: Mimicking C# Classical Inheritance in JavaScript</h1></a>
	<a href="#t-89"><h1>89 : White Tower Summoning Enhanced: The Marvels of ES6 Classes</h1></a>
	<a href="#t-90"><h1>90 : Black Tower Summoning: Object Composition With Mixins</h1></a>
	<a href="#t-91"><h1>91 : Mastering the Arcane Art of JavaScript-Mancy for C# Developers - Chapter 2: The Basics of JavaScript Functions</h1></a>
	<a href="#t-92"><h1>92 : Mastering the Arcane Art of JavaScript-mancy for C Sharp Developers - Chapter 3: Useful Function Patterns - Default Arguments</h1></a>
	<a href="#t-93"><h1>93 : Mastering the Arcane Art of JavaScript-mancy for C# Developers - Chapter 4: More Useful Function Patterns - Multiple Arguments</h1></a>
	<a href="#t-94"><h1>94 : Mastering the Arcane Art of Javascript-mancy for C# Developers - Chapter 5: Even More Useful Function Patterns - Function Overloading</h1></a>
	<a href="#t-95"><h1>95 : Object-Oriented JavaScript</h1></a>
	<a href="#t-96"><h1>96 : The Basics of Object-Oriented JavaScript</h1></a>
	<a href="#t-97"><h1>97 : Object-Oriented programming with JavaScript</h1></a>
	<a href="#t-98"><h1>98 : JavaScript 101: Objects and Functions</h1></a>
	<a href="#t-99"><h1>99 : Javascript Async Control Flow</h1></a>
	
</div>
		<!--================= END :: Tutorial Index =================-->
		
		<main class="main">
			
			<section class="section__one">
			
				<!--================= START :: Tutorial =================-->
				<article>
					<a id="t-01" name="t-01"></a><h1>01 : Functional Concepts For JavaScript Developers: Currying</h1>
					<div class="tutorial__content">
<span>https://blog.simpleblend.net/functional-javascript-concepts-currying/</span>
<p>Before I understood the concept of currying, I was always filled with anxiety when hearing other developers describe it. They always made it seem so complicated and difficult to understand; as if an ominous thundercloud arrived every time the topic was mentioned. Well I assure you that the concept of currying, at least applied to programming, is not hard to understand at all. It's actually quite easy to grasp and once you do, opens the door to a powerful functional programming technique.</p>
<h2>The Core Idea</h2>
<p>Let's first start with a definition from the great book by <a href="https://twitter.com/drboolean">Brian Lonsdorf</a></p>
<blockquote><p>"The concept is simple: You can call a function with fewer arguments than it expects. It returns a function that takes the remaining arguments."</p></blockquote>
<p>In other words, a curry function takes and provides additional arguments over time. It does this by returning additional functions to do the work for us.<span class="citation-num" data-citation-num="1">1</span> In order to see how this works, let's take a normal function and curry it.</p>
<pre><code class="language-javascript">var add = function(x, y) {
  return x + y;
}

add(10, 20); // 30
</code></pre>
<p>Here we have a function that takes two numbers and returns the sum. Simple. Let's curry it.</p>
<pre><code class="language-javascript">var add = function(x) {
  return function(y) {
    return x + y;
  }
}

var addFifty = add(50);

addFifty(10); // 60
</code></pre>
<p>Instead of returning the immediate result, we're returning a function that acts as a closure over variable x. This allows us to keep a reference to that value when we execute the returned function <b>addFifty</b> at a later time. Finally, our returned function provides us with the summation of both numbers. In this example we would say the add function is "curried".</p>
<h2>Why is Currying useful?</h2>
<p>Curry functions are useful for many reasons. From a functional programming perspective, they allow your program to become "pure". I'll be writing more about pure functions at a later time but suffice it to say for now, pure functions allow your application to be better understood by yourself and other team members.</p>
<p>A more applicable reason can be shown by demonstrating a less contrived example. While adding two numbers together is great for explaining a new concept, it doesn't immediately highlight the enormous benefits of using it within the context of a larger application. Let's do that now.</p>
<p>Let's assume we're working with a list of animals like the below:</p>
<pre><code class="language-javascript">const animals = [
  {
    id: 1,
    name: "Tails",
    type: "Cat",
    adoptable: false
  },
  {
    id: 2,
    name: "Soul",
    type: "Cat",
    adoptable: true
  },
  {
    id: 3,
    name: "Fred",
    type: "Dog",
    adoptable: true
  },
  {
    id: 4,
    name: "Fury",
    type: "Lion",
    adoptable: true
  }
];
</code></pre>
<p>We need a way to filter down these animals based on type. We could do something like this:</p>
<pre><code class="language-javascript">animals.filter(animal =&gt;
   animal.type === "Cat"
);

/*
[{
   adoptable: false,
   id: 1,
   name: "Tails",
   type: "Cat"
 },
 {
   adoptable: true,
   id: 2,
   name: "Soul",
   type: "Cat"
 }];
*/
</code></pre>
<p>Looks pretty good. This grabs all of the cats in the list. However there's a better way to write the same thing.</p>
<p>One major drawback to the above code is that the <em>type</em> of animal is tightly coupled to <em>the act filtering itself</em>. This prevents reusability and encourages the cultivation of our worst enemy: state.</p>
<p>Let's see if we can do better.</p>
<pre><code class="language-javascript">const isAnimal = 
   type =&gt; 
     animal =&gt;
       animal.type === type

animals.filter(isAnimal("Cat"));
 
/*
 [{
   adoptable: false,
   id: 1,
   name: "Tails",
   type: "Cat"
 },
 {
   adoptable: true,
   id: 2,
   name: "Soul",
   type: "Cat"
 }];
 */
</code></pre>
<p>Much cleaner. Let's break this down into steps.</p>
<ul>
<li>isAnimal expects one argument, the type</li>
<li>isAnimal then returns a whole new function</li>
<li>The returned function is used as the callback to .filter()</li>
<li>Closure then allows our returned function to access the <strong>type</strong> variable which finally allows us to perform our equality comparison</li>
</ul>
<p>Again, why is this better than the previous example? As an application grows in size, it becomes harder to understand what functions are doing what and where they're coming from within the codebase. Striving to write pure functions like in our solution eliminates the state chase, and makes our entire app more testable by breaking things into single responsibilities.</p>
<h2>Conclusion &amp; Resources</h2>
<p>I hope this inspired you to see the powerful nature behind curry functions. I've personally found them very useful and really inspired me to learn more about functional programming concepts.</p>
<p>If you're interested in further learning, I encourage you to checkout functional libraries like <a href="http://ramdajs.com/0.21.0/docs/#curry">Ramda.js</a> or <a href="https://lodash.com/docs#curry">lodash</a> which contain general curry functions that can help build some really exciting functionality.</p>
					</div>
				</article>
				<!--================= END :: Tutorial =================-->
				
				<!--================= START :: Tutorial =================-->
				<article>
					<a id="t-02" name="t-02"></a><h1>02 : Currying vs partial application</h1>
					<span>http://www.jstips.co/en/javascript/curry-vs-partial-application/</span>
					<div class="tutorial__content">


<div class="post-content" itemprop="articleBody">
    <p><strong>Currying</strong></p>

<p>Currying takes a function</p>

<p>f: X * Y -&gt; R</p>

<p>and turns it into a function</p>

<p>f': X -&gt; (Y -&gt; R)</p>

<p>Instead of calling f with two arguments, we invoke f' with the first argument. The result is a function that we then call with the second argument to produce the result.</p>

<p>Thus, if the uncurried f is invoked as</p>

<p>f(3,5)</p>

<p>then the curried f' is invoked as</p>

<p>f(3)(5)</p>

<p>For example:
Uncurried add()</p>

<div class="language-javascript highlighter-rouge"><pre><code>
function add(x, y) {
  return x + y;
}

add(3, 5);   // returns 8
</code></pre>
</div>

<p>Curried add()</p>

<div class="language-javascript highlighter-rouge"><pre><code>function addC(x) {
  return function (y) {
    return x + y;
  }
}

addC(3)(5);   // returns 8
</code></pre>
</div>

<p><strong>The algorithm for currying.</strong></p>

<p>Curry takes a binary function and returns a unary function that returns a unary function.</p>

<p>curry: (X × Y → R) → (X → (Y → R))</p>

<p>Javascript Code:</p>

<div class="language-javascript highlighter-rouge"><pre><code>function curry(f) {
  return function(x) {
    return function(y) {
      return f(x, y);
    }
  }
}
</code></pre>
</div>

<p><strong>Partial application</strong></p>

<p>Partial application takes a function</p>

<p>f: X * Y -&gt; R</p>

<p>and a fixed value for the first argument to produce a new function</p>

<p>f`: Y -&gt; R</p>

<p>f' does the same as f, but only has to fill in the second parameter which is why its arity is one less than the arity of f.</p>

<p>For example: Binding the first argument of function add to 5 produces the function plus5.</p>

<div class="language-javascript highlighter-rouge"><pre><code>function plus5(y) {
  return 5 + y;
}

plus5(3);  // returns 8
</code></pre>
</div>

<p><strong>The algorithm of partial application.</strong>*</p>

<p>partApply takes a binary function and a value and produces a unary function.</p>

<p>partApply : ((X × Y → R) × X) → (Y → R)</p>

<p>Javascript Code:</p>

<div class="language-javascript highlighter-rouge"><pre><code>function partApply(f, x) {
  return function(y) {
    return f(x, y);
  }
}
</code></pre>
</div>

    
  </div>
					</div>
				</article>
				<!--================= END :: Tutorial =================-->
				
				<!--================= START :: Tutorial =================-->
				<article>
					<a id="t-03" name="t-03"></a><h1>03 : Binding objects to functions</h1>
					<span>http://www.jstips.co/en/javascript/binding-objects-to-functions/</span>
					<div class="tutorial__content">


<div class="post-content" itemprop="articleBody">
    <p>More than often, we need to bind an object to a function's this object. JS uses the bind method when this is specified explicitly and we need to invoke desired method.</p>

<h3 id="bind-syntax">Bind syntax</h3>

<div class="language-js highlighter-rouge"><pre><code>fun.bind(thisArg[, arg1[, arg2[, ...]]])
</code></pre>
</div>

<h2 id="parameters">Parameters</h2>
<p><strong>thisArg</strong></p>

<p><code class="highlighter-rouge">this</code> parameter value to be passed to target function while calling the <code class="highlighter-rouge">bound</code> function.</p>

<p><strong>arg1, arg2, …</strong></p>

<p>Prepended arguments to be passed to the <code class="highlighter-rouge">bound</code> function while invoking the target function.</p>

<p><strong>Return value</strong></p>

<p>A copy of the given function along with the specified <code class="highlighter-rouge">this</code> value and initial arguments.</p>

<h3 id="bind-method-in-action-in-js">Bind method in action in JS</h3>

<div class="language-js highlighter-rouge"><pre><code>const myCar = {
 brand: 'Ford',
 type: 'Sedan'
 Color: 'Red'
};

const getBrand = () =&gt; {
 console.log(this.brand);
};

const getType = () =&gt; {
 console.log(this.type);
};

const getColor = () =&gt; {
 console.log(this.color);
};

getBrand(); // object not bind,undefined

getBrand(myCar); // object not bind,undefined

getType.bind(myCar)(); // Sedan

getColor.bind(myCar); // Red

</code></pre>
</div>

    
  </div>
					</div>
				</article>
				<!--================= END :: Tutorial =================-->
				
				<!--================= START :: Tutorial =================-->
				<article>
					<a id="t-04" name="t-04"></a><h1>04 : Currying vs Partial Application</h1>
					<span>http://www.datchley.name/currying-vs-partial-application/</span>
					<div class="tutorial__content">


 <p>In this post we'll cover a couple techniques in Javascript that are common among functional languages: <em>currying</em> and <em>partial application</em>.  You don't need a background in functional programming to understand these, so don't worry. </p>

<h2 id="aquickreviewaboutfunctions">A quick review about functions...</h2>

<p>So, I'll assume you have a basic understanding of functions in Javascript, including <a href="http://eloquentjavascript.net/05_higher_order.html">higher-order functions</a>, <a href="http://www.datchley.name/basic-scope/">closures</a> and <a href="http://www.datchley.name/functions/"><code>call</code> &amp; <code>apply</code></a>; if not, go review those topics quickly and come back. </p>

<p>Now that you're back, let's review a couple of important points before moving ahead.</p>

<blockquote>
  <p><strong>Arity</strong> refers to the number of arguments a function can accept. This might be none, one (<em>unary</em>), two (<em>binary</em>) or more (<em>polyadic</em>). You can also have functions that take a variable number of arguments, (<em>variadic functions</em>).</p>
</blockquote>

<p>Functions allow you to access their arity via the <code>.length</code> property of the function.  The <code>.length</code> of a function never changes - it always matches the number of declared arguments for the function.</p>

<pre><code class="language-javascript">function howMany(a,b,c) {  
    console.log(howmany.length);
}

howMany(1,2);      // 3  
howMany(1,2,3,4);  // 3  
</code></pre>

<p>Obviously, it's up to you and your function to properly handle the cases of too few and too many arguments.</p>

<blockquote>
  <p><strong>Variadic Functions</strong> are those functions which take a variable number of arguments.  </p>
</blockquote>

<p>Javascript allows us to access all the arguments passed to a function via the  <code>arguments</code> variable made available inside a function's scope.  This variable contains an <em>array-like</em> list of all the arguments pass to the function when it was called.  </p>

<p>I say, <em>array-like</em>, because even though it's a list, it only has a <code>.length</code> and none of the other properties you'd expect of a real Array.  You can access it via indexing <code>[]</code>, get the <code>.length</code> and iterate over it using a loop construct - and that's about it.</p>

<p>But we can convert this into a 'real' array which will make the arguments list much more useful to us:</p>

<pre><code class="language-javascript">function showArgs() {  
   var args = [].slice.call(arguments);
}
</code></pre>

<p>The <code>[].slice.call(arguments)</code> is a short-handed way of doing <code>Array.prototype.slice.call(arguments)</code>, we just take advantage of the use of an array literal. </p>

<p>In ES6 we can access and '<em>unpack</em>' our arguments even more easily with the help of the spread/gather operator:</p>

<pre><code class="language-javascript">function howMany(...args) {  
   console.log("args:", args, ", length:", args.length);
}
howMany(1,2,3,4);  // args: [1,2,3,4], length: 4   (a "real" array)!  
</code></pre>

<p>With all that out of the way -- which I'm sure you knew already -- we can move on to our main topic!</p>

<h2 id="currying">Currying</h2>

<blockquote>
  <p><strong>Currying</strong> is the process of taking a function that accepts <em>N</em> arguments and turning it into a chained series of <em>N</em> functions each taking <em>1</em> argument. </p>
</blockquote>

<p>If we had an <code>add()</code> function that accepted 3 arguments and returned the sum,</p>

<pre><code class="language-javascript">function add(a,b,c) { return a+b+c; }  
</code></pre>

<p>we can turn it into a curried function as follows:  </p>

<pre><code class="language-javascript">function curriedAdd(a) {  
   return function(b) {
     return function(c) {
       return a+b+c;
     }
   }
}
</code></pre>

<p>How does currying work? It works by nesting functions for each possible argument, using the natural closure created by the nested functions to retain access to each of the successive arguments.</p>

<p><img src="http://www.datchley.name/content/images/2015/07/curry-function-closures.png" alt="">
What we want is a way to easily convert an existing function that takes <em>N</em> arguments into its curried version without having to write-out each curried version of a function as we did with <code>curriedAdd()</code>.  </p>

<p>Let's see if we can decompose this and build something useful.</p>

<h3 id="writingagenericcurry">Writing a generic <code>curry()</code></h3>

<p>Ideally, this is the <code>curry()</code> function interface we'd like to design:</p>

<pre><code class="language-javascript">function foo(a,b,c){ return a+b+c; }  
var curriedFoo = curry(foo);

curriedFoo(1,2,3);   // 6  
curriedFoo(1)(2,3);  // 6  
curriedFoo(1)(2)(3); // 6  
curriedFoo(1,2)(3);  // 6  
</code></pre>

<p>Our <code>curry()</code> returns a new function that allows us to call it with one or more arguments, which it will then partially apply; up until it receives the last argument (<em>based on the original function's arity</em>) at which point it will return the evaluation of invoking the original function with all the arguments.</p>

<p>We know we can access the <em>arity</em> of a function using the <code>.length</code> property of the function.  We can use this knowledge to allow us to know how many chained sequences of that function we need to call.</p>

<p>And, we'll need to store the original function passed in as well, so that once we have all the required arguments we can call the original function with the proper arguments and return its results.</p>

<p>Here's our first attempt:</p>

<pre><code class="language-javascript linenumbers">function curry(fn) {  
  return function curried() {                           
    var args = [].slice.call(arguments);
    return args.length &gt;= fn.length ?
      fn.apply(null, args) :
      function () {
        var rest = [].slice.call(arguments);
          return curried.apply(null, args.concat(rest));
      };
  };
}
</code></pre>

<p>Let's break this down in detail...</p>

<ul>
<li><strong>line 2</strong> our <code>curry</code> function returns a new function, in this case a named function expression called <code>curried()</code>.</li>
<li><strong>line 3</strong> every time this function is called, we store the arguments passed to it in <code>args</code></li>
<li><strong>line 4</strong> if the number of arguments is equal to the arity of the original function, we have them all, so</li>
<li><strong>line 5</strong> return the invocation of the original function with all the arguments</li>
<li><strong>line 6</strong> otherwise, return a function that will accept more arguments that, when called, will call our <code>curried</code> function again with the original arguments passed previously combined with the arguments passed to the newly returned function.</li>
</ul>

<p>Let's give this a try with our original <code>add</code> function from before.</p>

<pre><code class="language-javascript">var curriedAdd = curry(add);  
curriedAdd(1)(2)(3);  
// 6
curriedAdd(1)(2,3);  
// 6
</code></pre>

<p>Excellent!  This seems to do exactly what we want it to do. However, suppose we had an object with functions that depended on the proper object being set to the calling context (<code>this</code>) of the function.  Can we use our <code>curry</code> function to curry an object method?</p>

<pre><code class="language-javascript">var border = {  
  style: 'border',
  generate: function(length, measure, type, color) {
    return [this.style + ':', length + measure, type, color].join(' ') +';';
  }
};

border.curriedGenerate = curry(border.generate);

border.curriedGenerate(2)('px')('solid')('#369')  
// =&gt; "undefined: 2px solid #369;"
</code></pre>

<p>Uh oh. That's not what we wanted.  </p>

<p>Using our <code>curry()</code> function as a method decorator<sup id="fnref:1"><a href="#fn:1" rel="footnote">1</a></sup> seems to break the object context expected by the method. We'll have to retain the original context and be sure and pass it along to successive calls to the returned <code>curried</code> function.</p>

<pre><code class="language-javascript">function curry(fn) {  
    return function curried() {
        var args = toArray(arguments), 
            context = this;

        return args.length &gt;= fn.length ?
            fn.apply(context, args) :
            function () {
                var rest = toArray(arguments);
                return curried.apply(context, args.concat(rest));
            };
    }
}
</code></pre>

<p>Let's try it again.</p>

<pre><code class="language-javascript">border.curriedGenerate(2)('px')('solid')('#369')  
// =&gt; "border: 2px solid #369;"
</code></pre>

<p>Got it!  Now our <code>curry()</code> function is context aware and can be used in any number of situations as a function decorator.</p>

<h3 id="curryingvariadicfunctions">Currying Variadic Functions?</h3>

<p>So our current solution works and correctly retains the context when called, as long as those functions being curried only accept exactly the number of arguments they declare - no more, no less.  This doesn't help us if we want to curry a function that has optional declared arguments or a variable number of arguments (<em>variadic functions</em>).</p>

<p>With variable argument functions, we need a way to tell our <code>curry()</code> function <em>when</em> it has enough arguments to evaluate the original function that it's currying.  </p>

<p>Take the following functions</p>

<pre><code class="language-javascript">function max(/* variable arguments */) {  
  var args = [].slice.call(arguments);
  return Math.max.apply(Math, args);
}

function  range(start, end, step) {  
  var stop = Math.max(start, end),
      start = Math.min(start, end),
      set = [];

  // step is optional
  step = typeof step !== 'undefined' ? step : 1;

  for (var i=start; i &lt;=stop; i+=step) {
      set.push(i);
  }  
  return set;
}
</code></pre>

<p>In the above, if we tried to use <code>curry(max)(1)(2)(3)</code> it evaluates too soon and we get a <code>TypeError</code>. </p>

<p>If we try to use <code>curry(range)(1)(10)</code> it never evaluates and simply stops by returning us a function that is still expecting another argument.</p>

<p>There is no feasible implementation of <code>curry</code> which will suffice for the example of our <code>max()</code> function which can take any number of arguments. Without an arity or a minimum number of arguments, there's no efficient way to determine when we should evaluate the original function with the arguments up to that point.</p>

<p>However, we can try to handle the case of optional, trailing arguments as in our <code>range()</code> example; and with minimal changes to our original <code>curry()</code> implementation.  </p>

<p>We can modify our original <code>curry()</code> function to take an optional second argument which is the minimum number of arguments to curry.</p>

<pre><code class="language-javascript">function curry(fn, n) {  
  var arity = n || fn.length;
  return function curried() {
      var args = toArray(arguments), 
          context = this;

      return args.length &gt;= arity ?
          fn.apply(context, args) :
          function () {
              var rest = toArray(arguments);
              return curried.apply(context, args.concat(rest));
          };
  };
}
</code></pre>

<p>Now, we can call <code>curry(range, 2)(1)(10)</code> as well as <code>curry(range, 2)(1)(10,2)</code>. Unfortunately, though, we can't call it as <code>curry(range, 2)(1)(10)(2)</code>, because as soon as it sees the minimum number of arguments, 2 in this case, it will return the results of evaluating the curried function.</p>

<h2 id="whattodoaboutcurryingthen">What to do about Currying then?</h2>

<p>It's clear from our examination above that currying in Javascript is definitely possible and useful. However, because Javascript allows any function to be variadic by nature, it becomes inefficient to implement a <code>curry()</code> function that can handle all possible cases.</p>

<p><strong>Solution</strong>: If you're writing in a functional style, with unary and/or binary functions; and those functions take specific arguments that are declared, take advantage of currying. Otherwise, using our original implementation of <code>curry()</code> with the understanding that there are limitations surrounding functions with optional or variable arguments might be the best approach. </p>

<h2 id="partialapplication">Partial Application</h2>

<p>That was a lot of talking about currying; so, what is <em>partial application</em>?  </p>

<blockquote>
  <p><strong>Partial application</strong> means taking a function and <em>paritally</em> applying it to one or more of its arguments, but not all, creating a new function in the process.</p>
</blockquote>

<p>Javascript already lets you do this with <code>Function.prototype.bind()</code></p>

<pre><code class="language-javascript">function add3(a, b, c) { return a+b+c; }  
add3(2,4,8);  // 14

var add6 = add3.bind(this, 2, 4);  
add6(8);  // 14  
</code></pre>

<p>But, that sounds a lot like what our <code>curry()</code> function does internally. If you have <code>curry()</code>, you also have partial application!<sup id="fnref:2"><a href="#fn:2" rel="footnote">2</a></sup></p>

<pre><code class="language-javascript">var add6 = curry(add3)(2)(4);  
add6(8); // 14  
</code></pre>

<p>The primary difference is in how you use them.  We can implement a partial application function fairly easily (<em>this is applying arguments from left to right</em>)</p>

<pre><code class="language-javascript">// Apply left arbitrary number of arguments
function apply(fn /* partial arguments... */) {  
    var args = [].slice.call(arguments, 1);
    return function() {
        var _args = [].slice.call(arguments);
        return fn.apply(this, args.concat(_args));
    }
}
</code></pre>

<p>And we can call this, much like <code>bind</code> but without the initial context argument, like <code>var add6 = apply(add3, 2, 4)</code>.</p>

<h2 id="es6curryandapplyimplementations">ES6 <code>curry</code> and <code>apply</code> implementations</h2>

<p>To wrap things up, I promised to cover the ES6 implementations as well, so here is <code>curry()</code>,</p>

<pre><code class="language-javascript">function curry(fn) {  
    return function curried(...args) {
        return args.length &gt;= fn.length ?
            fn.call(this, ...args) :
            (...rest) =&gt; {
                return curried.call(this, ...args, ...rest);
            };
    };
}
</code></pre>

<p>and here's our <code>apply()</code> function in ES6 as well.</p>

<pre><code class="language-javascript">// Apply left arbitrary number of arguments
function apply(fn, ...args) {  
    return (..._args) =&gt; {
        return fn(...args, ..._args);
    };
}
</code></pre>

<p>The <code>...</code>(spread/gather) operator and <code>=&gt;</code> fat arrow functions simplify the amount of code we need to implement our previous ES5 versions of <code>curry</code> and <code>apply</code>; and, I think they make the implementation more clear and understandable as well.<sup id="fnref:3"><a href="#fn:3" rel="footnote">3</a></sup></p>
					</div>
				</article>
				<!--================= END :: Tutorial =================-->
				
				<!--================= START :: Tutorial =================-->
				<article>
					<a id="t-05" name="t-05"></a><h1>05 : What's the difference between Currying and Partial Application?</h1>
					<span>http://raganwald.com/2013/03/07/currying-and-partial-application.html</span>
					<div class="tutorial__content">

<section id="main_content">
          <p>I was participating in <a href="http://wrocloverb.com">wroc_love.rb</a> last week-end, and <a href="http://steveklabnik.com">Steve Klabnik</a> put up a slide mentioning <a href="https://en.wikipedia.org/wiki/Partial_application">partial application</a> and <a href="https://en.wikipedia.org/wiki/Currying">currying</a>. "The difference between them is not important right now," he said, pressing on. And it wasn't.</p>

<p>But here we are, it's a brand new day, and we've already read five different explanations of <code class="highlighter-rouge">this</code> and closures this week, but only three or four about currying, so let's get into it.</p>

<h3 id="arity">arity</h3>

<p>Before we jump in, let's get some terminology straight. Functions have <em>arity</em>, meaning the number of arguments they accept. A "unary" function accepts one argument, a "polyadic" function takes more than one argument. There are specialized terms we can use: A "binary" function accepts two, a "ternary" function accepts three, and you can rustle about with greek or latin words and invent names for functions that accept more than three arguments.</p>

<p>Some functions accept a variable number of arguments, we call them <em>variadic</em>, although variadic functions and functions taking no arguments aren't our primary focus in this essay.</p>

<h3 id="partial-application">partial application</h3>

<p>Partial application is straightforward. We could start with addition or some such completely trivial example, but if you don't mind we'll have a look at something from the <a href="http://allong.es">allong.es</a> JavaScript library that is of actual use in daily programming.</p>

<p>As a preamble, let's make ourselves a <code class="highlighter-rouge">map</code> function that maps another function over a list:</p>

<pre><code>var __map = [].map;

function map (list, unaryFn) {
  return __map.call(list, unaryFn);
};

function square (n) {
  return n * n;
};

map([1, 2, 3], square);
  //=&gt; [1, 4, 9]
</code></pre>

<p><code class="highlighter-rouge">map</code> is obviously a binary function, <code class="highlighter-rouge">square</code> is a unary function. When we called <code class="highlighter-rouge">map</code> with arguments <code class="highlighter-rouge">[1, 2, 3]</code> and <code class="highlighter-rouge">square</code>, we <em>applied</em> the arguments to the function and got our result.</p>

<p>Since <code class="highlighter-rouge">map</code> takes two arguments, and we supplied two arguments, we <em>fully applied</em> the arguments to the function. So what's partial application? Supplying fewer arguments. Like supplying one argument to <code class="highlighter-rouge">map</code>.</p>

<p>Now what happens if we supply one argument to <code class="highlighter-rouge">map</code>? We can't get a result without the other argument, so what we get back is a unary function that takes the other argument and produces the result we want.</p>

<p>If we're going to apply one argument to <code class="highlighter-rouge">map</code>, let's make it the <code class="highlighter-rouge">unaryFn</code>. We'll start with the end result and work backwards. First thing we do, is set up a wrapper around map:</p>

<pre><code>function mapWrapper (list, unaryFn) {
  return map(list, unaryFn);
};
</code></pre>

<p>Next we'll break our binary wrapper function into two nested unary functions:</p>

<pre><code>function mapWrapper (unaryFn) {
  return function (list) {
    return map(list, unaryFn);
  };
};
</code></pre>

<p>Now we can supply our arguments one at a time:</p>

<pre><code>mapWrapper(square)([1, 2, 3]);
  //=&gt; [1, 4, 9]
</code></pre>

<p>Instead of a binary <code class="highlighter-rouge">map</code> function that returns our result, we now have a unary function that returns a unary function that returns our result. So where's the partial application? Let's get our hands on the second unary function:</p>

<pre><code>var squareAll = mapWrapper(square);
  //=&gt; [function]

squareAll([1, 2, 3]);
  //=&gt; [1, 4, 9]
squareAll([5, 7, 5]);
  //=&gt; [25, 49, 25]
</code></pre>

<p>We've just partially applied the value <code class="highlighter-rouge">square</code> to the function <code class="highlighter-rouge">map</code>. We got back a unary function, <code class="highlighter-rouge">squareAll</code>, that we could use as we liked. Partially applying <code class="highlighter-rouge">map</code> in this fashion is handy, so much so that the <a href="http://allong.es">allong.es</a> library includes a function called <code class="highlighter-rouge">mapWith</code> that does this exact thing.</p>

<p>If we had to physically write ourselves a wrapper function every time we want to do some partial application, we'd never bother. Being programmers though, we can automate this. There are two ways to do it.</p>

<h3 id="currying">currying</h3>

<p>First up, we can write a function that returns a wrapper function. Sticking with binary function, we start with this:</p>

<pre><code>function wrapper (unaryFn) {
  return function (list) {
    return map(list, unaryFn);
  };
};
</code></pre>

<p>Rename <code class="highlighter-rouge">map</code> and the two arguments:</p>

<pre><code>function wrapper (secondArg) {
  return function (firstArg) {
    return binaryFn(firstArg, secondArg);
  };
};
</code></pre>

<p>And now we can wrap the whole thing in a function that takes <code class="highlighter-rouge">binaryFn</code> as an argument:</p>

<pre><code>function rightmostCurry (binaryFn) {
  return function (secondArg) {
    return function (firstArg) {
      return binaryFn(firstArg, secondArg);
    };
  };
};
</code></pre>

<p>So now we've 'abstracted' our little pattern. We can use it like this:</p>

<pre><code>var rightmostCurriedMap = rightmostCurry(map);

var squareAll = rightmostCurriedMap(square);

squareAll([1, 4, 9]);
  //=&gt; [1, 4, 9]
squareAll([5, 7, 5]);
  //=&gt; [25, 49, 25]
</code></pre>

<p>Converting a polyadic function into a nested series of unary functions is called <strong>currying</strong>, after Haskell Curry, who popularized the technique. He actually rediscovered the combinatory logic work of <a href="https://en.wikipedia.org/wiki/Moses_Schönfinkel">Moses Schönfinkel</a>, so we could easily call it "schönfinkeling."<sup id="fnref:birds"><a href="#fn:birds" class="footnote">1</a></sup></p>

<p>Our <code class="highlighter-rouge">rightmostCurry</code> function curries any binary function into a chain of unary functions starting with the second argument. This is a "rightmost" curry because it starts at the right.</p>

<p>The opposite order would be a "leftmost" curry. Most logicians work with leftmost currying, so when we write a leftmost curry, most people just call it "curry:"</p>

<pre><code>function curry (binaryFn) {
  return function (firstArg) {
    return function (secondArg) {
      return binaryFn(firstArg, secondArg);
    };
  };
};

var curriedMap = curry(map),
    double = function (n) { return n + n; };

var oneToThreeEach = curriedMap([1, 2, 3]);

oneToThreeEach(square);
  //=&gt; [1, 4, 9]
oneToThreeEach(double);
  //=&gt; [2, 4, 6]
</code></pre>

<p>When would you use a regular curry and when would you use a rightmost curry? It really depends on your usage. In our binary function example, we're emulating a kind of subject-object grammar. The first argument we want to use is going to be the subject, the second is going to be the object.</p>

<p>So when we use a rightmost curry on <code class="highlighter-rouge">map</code>, we are setting up a "sentence" that makes the mapping function the subject.</p>

<p>So we read <code class="highlighter-rouge">squareAll([1, 2, 3])</code> as "square all the elements of the array [1, 2, 3]." By using a rightmost curry, we made "squaring" the subject and the list the object. Whereas when we used a regular curry, the list became the subject and the mapper function became the object.</p>

<p>Another way to look at it that is a little more like "patterns and programming" is to think about what you want to name and/or reuse. Having both kinds of currying lets you name and/or reuse either the mapping function or the list.</p>

<h3 id="partial-application-1">partial application</h3>

<p>So many words about currying! What about "partial application?" Well, if you have currying you don't need partial application. And conversely, if you have partial application you don't need currying. So when you write this kind of essay, it's easy to spend a lot of words describing one of these two things and then explain everything else on top of what you already have.</p>

<p>Let's look at our rightmost curry again:</p>

<pre><code>function rightmostCurry (binaryFn) {
  return function (secondArg) {
    return function (firstArg) {
      return binaryFn(firstArg, secondArg);
    };
  };
};
</code></pre>

<p>You might find yourself writing code like this over and over again:</p>

<pre><code>var squareAll = rightmostCurry(map)(square),
    doubleAll = rightmostCurry(map)(double);
</code></pre>

<p>This business of making a rightmost curry and then immediately applying an argument to it is extremely common, and when something's common we humans like to name it. And it has a name, it's called a <em>rightmost unary partial application of the map function</em>.</p>

<p>What a mouthful. Let's take it step by step:</p>

<ol>
  <li>rightmost: From the right.</li>
  <li>unary: One argument.</li>
  <li>partial application: Not applying all of the arguments.</li>
  <li>map: To the map function.</li>
</ol>

<p>So what we're really doing is applying one argument to the map function. It's a binary function, so that means what we're left with is a unary function. Again, functional languages and libraries almost always include a first-class function to do this for us.</p>

<p>We <em>could</em> build one out of a rightmost curry:</p>

<pre><code>function rightmostUnaryPartialApplication (binaryFn, secondArg) {
  return rightmostCurry(binaryFn)(secondArg);
};
</code></pre>

<p>However it is usually implemented in more direct fashion:<sup id="fnref:caveat"><a href="#fn:caveat" class="footnote">2</a></sup></p>

<pre><code>function rightmostUnaryPartialApplication (binaryFn, secondArg) {
  return function (firstArg) {
    return binaryFn(firstArg, secondArg);
  };
};
</code></pre>

<p><code class="highlighter-rouge">rightmostUnaryPartialApplication</code> is a bit much, so we'll alias it <code class="highlighter-rouge">applyLast</code>:</p>

<pre><code>var applyLast = rightmostUnaryPartialApplication;
</code></pre>

<p>And here're our <code class="highlighter-rouge">squareAll</code> and <code class="highlighter-rouge">doubleAll</code> functions built with <code class="highlighter-rouge">applyLast</code>:</p>

<pre><code>var squareAll = applyLast(map, square),
    doubleAll = applyLast(map, double);
</code></pre>

<p>You can also make an <code class="highlighter-rouge">applyFirst</code> function (we'll skip calling it "leftmostUnaryPartialApplication"):</p>

<pre><code>function applyFirst (binaryFn, firstArg) {
  return function (secondArg) {
    return binaryFn(firstArg, secondArg);
  };
};
</code></pre>

<p>As with leftmost and rightmost currying, you want to have both in your toolbox so that you can choose what you are naming and/or reusing.</p>

<h3 id="so-whats-the-difference-between-currying-and-partial-application">so what's the difference between currying and partial application?</h3>

<p>"Currying is the decomposition of a polyadic function into a chain of nested unary functions. Thus decomposed, you can partially apply one or more arguments,<sup id="fnref:also"><a href="#fn:also" class="footnote">3</a></sup> although the curry operation itself does not apply any arguments to the function."</p>

<p>"Partial application is the conversion of a polyadic function into a function taking fewer arguments arguments by providing one or more arguments in advance."</p>

<h3 id="is-that-all-there-is">is that all there is?</h3>

<p>Yes. And no. Here are some further directions to explore on your own:</p>

<ol>
  <li>We saw how to use currying to implement partial application. Is it possible to use partial application to implement currying? Why? Why not?<sup id="fnref:tao"><a href="#fn:tao" class="footnote">4</a></sup></li>
  <li>All of our examples of partial application have concerned converting binary functions into unary functions by providing one argument. Write more general versions of <code class="highlighter-rouge">applyFirst</code> and <code class="highlighter-rouge">applyLast</code> that provide one argument to any polyadic function. For example, if you have a function that takes four arguments, <code class="highlighter-rouge">applyFirst</code> should return a function taking three arguments.</li>
  <li>When you have <code class="highlighter-rouge">applyFirst</code> and <code class="highlighter-rouge">applyLast</code> working with all polyadic functions, try implementing <code class="highlighter-rouge">applyLeft</code> and <code class="highlighter-rouge">applyRight</code>: <code class="highlighter-rouge">applyLeft</code> takes a polyadic function and one <em>or more</em> arguments and leftmost partially applies them. So if you provide it with a ternary function and two arguments, it should return a unary function. <code class="highlighter-rouge">applyRight</code> does the same with rightmost application.</li>
  <li>Rewrite curry and rightmostCurry to accept any polyadic function. So just as a binary function curries into two nested unary functions, a ternary function should curry into three nested unary functions and so on.</li>
  <li>Review the source code for <a href="http://allong.es">allong.es</a>, the functional programming library extracted from <a href="http://leanpub.com/javascriptallongesix">JavaScript Allongé</a>, especially <a href="https://github.com/raganwald/allong.es/blob/master/lib/partial_application.js">partial_application.js</a>.</li>
</ol>

<p>Thanks for reading, if you discover a bug in the code, please either <a href="https://github.com/raganwald/raganwald.github.com">fork the repo</a> and submit a pull request, or <a href="https://github.com/raganwald/raganwald.github.com/issues">submit an issue on Github</a>.</p>

        </section>
					</div>
				</article>
				<!--================= END :: Tutorial =================-->
				
				<!--================= START :: Tutorial =================-->
				<article>
					<a id="t-06" name="t-06"></a><h1>06 : Approaches to currying in JavaScript</h1>
					<span>http://extralogical.net/articles/currying-javascript.html</span>
					<div class="tutorial__content">


<article>
    
    
    
    
    <p>JavaScript's dynamic nature makes it hard to straightforwardly apply many functional programming idioms. One example of this is <a href="http://en.wikipedia.org/wiki/Currying">currying</a>: any function may be passed an arbitrary number of arguments, making it impossible to write a truly general currying function.</p>
<p>To recap, currying is a technique for transforming a function which accepts <em>n</em> parameters into a nest of partially applicable functions. Consider the function <em>f = λxyz.M</em>, which has three parameters, <em>x</em>, <em>y</em> and <em>z</em>. By currying, we obtain a new function <em>f* = λx.(λy.(λz.M))</em>.</p>
<p>One simple example is currying an <code>add</code> function which accepts 2 parameters and returns the result of adding them together.</p>
<pre><code>var add = function(a, b) {
    return a + b;
};

var curriedAdd = function(a) {
    return function(b) {
        return a + b;
    };
};</code></pre>
<p>A function which returns the result of evaluating a quadratic expression demonstrates more clearly the 'nesting' of functions which currying produces.</p>
<pre><code>var quadratic = function(a, b, c, x) {
    return a * x * x + b * x + c;
};

var curriedQuadratic = function(a) {
    return function(b) {
        return function(c) {
            return function(x) {
                return a * x * x + b * x + c;
            };
        };
    };
};</code></pre>
<p>Given a pattern like this, the obvious question is how to generalise it. Ideally, we would write a <code>curry</code> function to automatically transform functions like <code>quadratic</code> into ones like <code>curriedQuadratic</code>. The simplest approach is to make curried functions always return a single wrapping function:</p>
<pre><code>var naiveCurry = function(f) {
    var args = Array.prototype.slice.call(arguments, 1);
    
    return function() {
        var largs = Array.prototype.slice.call(arguments, 0);
        return f.apply(this, args.concat(largs));
    };
};</code></pre>
<p>Clearly this is not true currying, except for functions of arity 2. We cannot use it to perform the transformation from <code>quadratic</code> to <code>curriedQuadratic</code>.</p>
<p>A cleverer approach would be to detect the arity of the function we wish to curry. To do this, we can use the length property of the function, which returns the number of named arguments the function accepts. <code>Math.tan.length</code> is 1, while <code>parseInt.length</code> is 2.</p>
<pre><code>var curryByLength = function(f) {
    var arity = f.length,
        args  = Array.prototype.slice.call(arguments, 1),
    
    accumulator = function() {
        var largs = args;
        
        if (arguments.length &gt; 0) {
            // We must be careful to copy the `args` array with `concat` rather
            // than mutate it; otherwise, executing curried functions can have
            // strange non-local effects on other curried functions.
            largs = largs.concat(Array.prototype.slice.call(arguments, 0));
        }
        
        if (largs.length &gt;= arity) {
            return f.apply(this, largs);
        } else {
            return curryByLength.apply(this, [f].concat(largs));
        }
    };
    
    return args.length &gt;= arity ? accumulator() : accumulator;
};</code></pre>
<p>However, the length property of any given JavaScript function can easily mislead. To begin with, we often find it useful to define functions with optional parameters.</p>
<pre><code>var someFunction = function(a, flag) {
    if (flag) {
        // Some computation involving a
    } else {
        // Some other computation involving a
    }
};</code></pre>
<p>Now consider a variadic function, like <code>Math.max</code>, which returns the largest number amongst its arguments. Despite the fact that it can in fact be called with any number of arguments, including 0 and 1, it has a length property of 2. Consequently, our 'smarter' curry function will only work with <code>Math.max</code> up to a point. This will throw a type error, even though <code>Math.max</code> will accept three arguments quite happily:</p>
<pre><code>curryByLength(Math.max)(1)(2)(3);</code></pre>
<p>Currying <code>Math.max</code> limits its utility to discriminating between two numbers, not <em>n</em> numbers. We can easily think of similar examples—other variadic functions, functions with optional arguments, and similarly clever abuses of JavaScript's dynamic arguments to create complex APIs. jQuery's <code>bind</code> method could be considered <a href="http://api.jquery.com/bind/">an example</a> of this: the event handler can be passed to the method as either the second or the third argument, depending on whether the user wishes to use the optional <code>eventData</code> parameter or not.</p>
<p>It is easy to see that there is no general way of resolving this issue: currying is essentially at odds with variadic functions and the ability to change the number of arguments a function accepts at runtime. However, one's choices are not limited simply to the approaches discussed above; there are alternatives, even if they do not fully dispose of the problem of dynamic arity.</p>
<p>Firstly, one can simply leave things as they are, with the <code>curry</code> function having a known limitation around functions with dynamic arity. The burden is placed on the user to ensure they take care when currying.</p>
<p>Alternatively, one could make the arity an explicit component of the <code>curry</code> function. This differs from the implicit detection of the arity via the curried function's length property (however, the implementation is almost identical).</p>
<pre><code>var curryWithExplicitArity = function(f, n) {
    var args = Array.prototype.slice.call(arguments, 2),
    
    accumulator = function() {
        var largs = args;
        
        if (arguments.length &gt; 0) {
            largs = largs.concat(Array.prototype.slice.call(arguments, 0));
        }
        
        if (largs.length &gt;= n) {
            return f.apply(this, largs);
        } else {
            return curryByLength.apply(this, [f].concat(largs));
        }
    };
    
    return args.length &gt;= n ? accumulator() : accumulator;
};</code></pre>
<p>Finally, one could have entirely different <code>curry</code> functions for each arity. This has the benefit of being explicit, and while it doesn't solve the problem of functions with dynamic arity, it does mean that one doesn't have to specify the arity of the function one wishes to curry each time as an additional parameter. Instead of writing <code>curry(f, 3)</code>, one can simply write <code>curry3(f)</code>.</p>
<p>In fact, there is a way to combine these last two approaches, by writing a function which generates curry functions for any given arity.</p>
<pre><code>var ncurry = function(n) {
    var _curry = function(f) {
        var args = Array.prototype.slice.call(arguments, 1),
        
        return function() {
            var largs = args.concat(Array.prototype.slice.call(arguments, 0));
            
            if (largs.length &lt; n) {
                largs.unshift(f);
                return _curry.apply(null, largs);
            } else {
                return f.apply(null, largs);
            }
        };
    };
    
    return _curry;
};</code></pre>
<p>For common use cases such as functions which accept 2 or 3 arguments, one can write simple aliases using <code>ncurry</code>, while one can always use <code>ncurry</code> 'inline' where necessary.</p>
<pre><code>var curry  = ncurry(2),
    curry3 = ncurry(3);

// Presumably `f7` is a function which accepts 7 arguments
var fc7 = ncurry(7)(f7);</code></pre>
<p>However, oftentimes something along the lines of <code>curryByLength</code> is preferable. If the library of functions one is working with consists of a set of functions with well-defined lists of parameters, then implicit rather than explicit conversion can be more convenient and more natural; it is, after all, rather nicer to be able to write <code>curry(f)</code> than <code>curry(f, n)</code> or even <code>ncurry(n)(f)</code>.</p>
<p>Ultimately which approach one decides to take must be based on understanding of the properties of the functions one is working with. A choice of currying function will then arise naturally—and after all, one can always use several. Both of these approaches are <a href="../projects/udon">available in Udon</a>, my library for functional programming in JavaScript, as <code>Udon.curry</code> and <code>Udon.ncurry</code>.</p>

</article>
					</div>
				</article>
				<!--================= END :: Tutorial =================-->
				
				<!--================= START :: Tutorial =================-->
				<article>
					<a id="t-07" name="t-07"></a><h1>07 : 7 Essential JavaScript Functions</h1>
					<div class="tutorial__content">
<span>https://davidwalsh.name/essential-javascript-functions</span>
<p>I remember the early days of JavaScript where you needed a simple function for just about everything because the browser vendors implemented features differently, and not just edge features, basic features, like <code>addEventListener</code> and <code>attachEvent</code>.  Times have changed but there are still a few functions each developer should have in their arsenal, for performance for functional ease purposes.</p>

<h2><a href="https://davidwalsh.name/javascript-debounce-function"><code>debounce</code></a></h2>

<p>The debounce function can be a game-changer when it comes to event-fueled performance.  If you aren't using a debouncing function with a <code>scroll</code>, <code>resize</code>, <code>key*</code> event, you're probably doing it wrong.  Here's a <code>debounce</code> function to keep your code efficient:</p>

<pre class="js">// Returns a function, that, as long as it continues to be invoked, will not
// be triggered. The function will be called after it stops being called for
// N milliseconds. If `immediate` is passed, trigger the function on the
// leading edge, instead of the trailing.
function debounce(func, wait, immediate) {
	var timeout;
	return function() {
		var context = this, args = arguments;
		var later = function() {
			timeout = null;
			if (!immediate) func.apply(context, args);
		};
		var callNow = immediate &amp;&amp; !timeout;
		clearTimeout(timeout);
		timeout = setTimeout(later, wait);
		if (callNow) func.apply(context, args);
	};
};

// Usage
var myEfficientFn = debounce(function() {
	// All the taxing stuff you do
}, 250);
window.addEventListener('resize', myEfficientFn);
</pre>

<p>The <code>debounce</code> function will not allow a callback to be used more than once per given time frame.  This is especially important when assigning a callback function to frequently-firing events.</p>

<h2><a href="https://davidwalsh.name/javascript-polling"><code>poll</code></a></h2>

<p>As I mentioned with the <code>debounce</code> function, sometimes you don't get to plug into an event to signify a desired state -- if the event doesn't exist, you need to check for your desired state at intervals:</p>

<pre class="js">// The polling function
function poll(fn, timeout, interval) {
    var endTime = Number(new Date()) + (timeout || 2000);
    interval = interval || 100;

    var checkCondition = function(resolve, reject) {
        // If the condition is met, we're done! 
        var result = fn();
        if(result) {
            resolve(result);
        }
        // If the condition isn't met but the timeout hasn't elapsed, go again
        else if (Number(new Date()) &lt; endTime) {
            setTimeout(checkCondition, interval, resolve, reject);
        }
        // Didn't match and too much time, reject!
        else {
            reject(new Error('timed out for ' + fn + ': ' + arguments));
        }
    };

    return new Promise(checkCondition);
}

// Usage:  ensure element is visible
poll(function() {
	return document.getElementById('lightbox').offsetWidth &gt; 0;
}, 2000, 150).then(function() {
    // Polling done, now do something else!
}).catch(function() {
    // Polling timed out, handle the error!
});
</pre>

<p>Polling has long been useful on the web and will continue to be in the future!</p>

<h2><a href="https://davidwalsh.name/javascript-once"><code>once</code></a></h2>

<p>There are times when you prefer a given functionality only happen once, similar to the way you'd use an <code>onload</code> event.  This code provides you said functionality:</p>

<pre class="js">function once(fn, context) { 
	var result;

	return function() { 
		if(fn) {
			result = fn.apply(context || this, arguments);
			fn = null;
		}

		return result;
	};
}

// Usage
var canOnlyFireOnce = once(function() {
	console.log('Fired!');
});

canOnlyFireOnce(); // "Fired!"
canOnlyFireOnce(); // nada
</pre>

<p>The <code>once</code> function ensures a given function can only be called once, thus prevent duplicate initialization!</p>

<h2><a href="https://davidwalsh.name/get-absolute-url"><code>getAbsoluteUrl</code></a></h2>

<p>Getting an absolute URL from a variable string isn't as easy as you think.  There's the <code>URL</code> constructor but it can act up if you don't provide the required arguments (which sometimes you can't).  Here's a suave trick for getting an absolute URL from and string input:</p>

<pre class="js">var getAbsoluteUrl = (function() {
	var a;

	return function(url) {
		if(!a) a = document.createElement('a');
		a.href = url;

		return a.href;
	};
})();

// Usage
getAbsoluteUrl('/something'); // https://davidwalsh.name/something
</pre>

<p>The "burn" element <code>href</code> handles and URL nonsense for you, providing a reliable absolute URL in return.</p>

<h2><a href="https://davidwalsh.name/detect-native-function"><code>isNative</code></a></h2>

<p>Knowing if a given function is native or not can signal if you're willing to override it.  This handy code can give you the answer:</p>

<pre class="js">;(function() {

  // Used to resolve the internal `[[Class]]` of values
  var toString = Object.prototype.toString;
  
  // Used to resolve the decompiled source of functions
  var fnToString = Function.prototype.toString;
  
  // Used to detect host constructors (Safari &gt; 4; really typed array specific)
  var reHostCtor = /^\[object .+?Constructor\]$/;

  // Compile a regexp using a common native method as a template.
  // We chose `Object#toString` because there's a good chance it is not being mucked with.
  var reNative = RegExp('^' +
    // Coerce `Object#toString` to a string
    String(toString)
    // Escape any special regexp characters
    .replace(/[.*+?^${}()|[\]\/\\]/g, '\\$&amp;')
    // Replace mentions of `toString` with `.*?` to keep the template generic.
    // Replace thing like `for ...` to support environments like Rhino which add extra info
    // such as method arity.
    .replace(/toString|(function).*?(?=\\\()| for .+?(?=\\\])/g, '$1.*?') + '$'
  );
  
  function isNative(value) {
    var type = typeof value;
    return type == 'function'
      // Use `Function#toString` to bypass the value's own `toString` method
      // and avoid being faked out.
      ? reNative.test(fnToString.call(value))
      // Fallback to a host object check because some environments will represent
      // things like typed arrays as DOM methods which may not conform to the
      // normal native pattern.
      : (value &amp;&amp; type == 'object' &amp;&amp; reHostCtor.test(toString.call(value))) || false;
  }
  
  // export however you want
  module.exports = isNative;
}());

// Usage
isNative(alert); // true
isNative(myCustomFunction); // false
</pre>

<p>The function isn't pretty but it gets the job done!</p>

<h2><a href="https://davidwalsh.name/add-rules-stylesheets"><code>insertRule</code></a></h2>

<p>We all know that we can grab a NodeList from a selector (via <code>document.querySelectorAll</code>) and give each of them a style, but what's more efficient is setting that style to a selector (like you do in a stylesheet):</p>

<pre class="js">var sheet = (function() {
	// Create the &lt;style&gt; tag
	var style = document.createElement('style');

	// Add a media (and/or media query) here if you'd like!
	// style.setAttribute('media', 'screen')
	// style.setAttribute('media', 'only screen and (max-width : 1024px)')

	// WebKit hack :(
	style.appendChild(document.createTextNode(''));

	// Add the &lt;style&gt; element to the page
	document.head.appendChild(style);

	return style.sheet;
})();

// Usage
sheet.insertRule("header { float: left; opacity: 0.8; }", 1);
</pre>

<p>This is especially useful when working on a dynamic, AJAX-heavy site.  If you set the style to a selector, you don't need to account for styling each element that may match that selector (now or in the future).</p>

<h2><a href="https://davidwalsh.name/element-matches-selector"><code>matchesSelector</code></a></h2>

<p>Oftentimes we validate input before moving forward; ensuring a truthy value, ensuring forms data is valid, etc.  But how often do we ensure an element qualifies for moving forward?  You can use a <code>matchesSelector</code> function to validate if an element is of a given selector match:</p>

<pre class="js">function matchesSelector(el, selector) {
	var p = Element.prototype;
	var f = p.matches || p.webkitMatchesSelector || p.mozMatchesSelector || p.msMatchesSelector || function(s) {
		return [].indexOf.call(document.querySelectorAll(s), this) !== -1;
	};
	return f.call(el, selector);
}

// Usage
matchesSelector(document.getElementById('myDiv'), 'div.someSelector[some-attribute=true]')
</pre>

					</div>
				</article>
				<!--================= END :: Tutorial =================-->
				
				<!--================= START :: Tutorial =================-->
				<article>
					<a id="t-08" name="t-08"></a><h1>08 : Collection of useful JavaScript functions and patterns</h1>
					<div class="tutorial__content">
<span>http://codebits.glennjones.net/cheatsheet/javascript.htm</span>

<p>This is a collection of useful JavaScript functions and patterns that I often use, when not coding with jQuery. 
                    I am still copying example from my projects into this document so it is a bit of a <strong>work in progress</strong>.</p>

                    <ul>
                        <li><a href="#strings">Strings</a></li>
                        <li><a href="#arrays">Arrays</a></li>
                        <li><a href="#dates">Dates</a></li>
                        <li><a href="#objects">Objects</a></li>
                        <li><a href="#dom">DOM</a></li>
                        <li><a href="#loops">Loops</a></li>
                        <li><a href="#events">Events</a></li>
                        <li><a href="#typedetection">Type detection</a></li>
                        <li><a href="#objectdetection">Object detection</a></li>
                        <li><a href="#json">JSON</a></li>
                        <li><a href="#module">Module</a></li>
                        <li><a href="#closure">Closure</a></li>
                    </ul>




<h2><a name="strings">Strings</a></h2>
<pre class="prettyprint" lang-html=""><code>
// Removes any white space to the right and left of the string
function trim(str) {
    return str.replace(/^\s+|\s+$/g, "");
}


// Removes any white space to the left of the string
function ltrim(str) {
    return str.replace(/^\s+/, "");
}


// Removes any white space to the right of the string
function rtrim(str) {
    return str.replace(/\s+$/, "");
}


// Truncate a string to a given length
function truncate(str, len) {
    if (str.length &gt; len) {
        str = str.substring(0, len);
    }
    return str;
};


// Return a string only containing the letters a to z
function onlyLetters(str) {
    return str.toLowerCase().replace(/[^a-z]/g, "");
};


// Return a string only containing the letters a to z and numbers
function onlyLettersNums(str) {
    return str.toLowerCase().replace(/[^a-z,0-9,-]/g, "");
};
</code></pre>


<h2><a name="arrays">Arrays</a></h2>
<pre class="prettyprint" lang-html=""><code>
// Removes an item from a given array
function removeArrayItem(arr, item) {
    var i = 0;
    while (i &lt; arr.length) {
        if (arr[i] == item) {
            arr.splice(i, 1);
        } else {
            i++;
        }
    }
};


// Does a given array contain a item
function contains(a, obj) {
    var i = a.length;
    while (i--) {
        if (a[i] === obj) {
            return true;
        }
    }
    return false;
};


// The index of an item - Javascript 1.6+
['glenn','john'].indexOf('john')  returns 2
</code></pre>


<h2><a name="dates">Dates</a></h2>
<pre class="prettyprint" lang-html=""><code>
// Converts native date to a ISO date
function isoDateString(d) {
    function pad(n) {
        return n &lt; 10 ? '0' + n : n
    }
    return d.getUTCFullYear() + '-'
        + pad(d.getUTCMonth() + 1) + '-'
        + pad(d.getUTCDate()) + 'T'
        + pad(d.getUTCHours()) + ':'
        + pad(d.getUTCMinutes()) + ':'
        + pad(d.getUTCSeconds()) + 'Z'
}
</code></pre>


<h2><a name="objects">Objects</a></h2>
<pre class="prettyprint" lang-html=""><code>
// Sorts a array of objects by a property
function sortObjectsByProperty(a, field, reverse, primer) {
    return a.sort(sortObjects(field, reverse, primer));
};


// Object sort
function sortObjects(field, reverse, primer) {
    reverse = (reverse) ? -1 : 1;
    return function (a, b) {
        a = a[field];
        b = b[field];
        if (primer !== undefined &amp;&amp; a !== undefined &amp;&amp; b !== undefined) {
            a = primer(a);
            b = primer(b);
        }
        if (a &lt; b) return reverse * -1;
        if (a &gt; b) return reverse * 1;
        return 0;
    }
};
</code></pre>


<h2><a name="dom">DOM</a></h2>
<pre class="prettyprint" lang-html=""><code>
// Does the node have a class
function hasClass(node, className) {
    if (node.className) {
        return node.className.match(
            new RegExp('(\\s|^)' + className + '(\\s|$)'));
    } else {
        return false;
    }
};


// Add a class to an node
function addClass(node, className) {
    if (hasClass(node, className)) node.className += " " + className;
};


// Removes a class from an node
function removeClass(node, className) {
    if (hasClass(node, className)) {
        var reg = new RegExp('(\\s|^)' + className + '(\\s|$)');
        node.className = node.className.replace(reg, ' ');
    }
};


//Returns first ancestor of required class or a null
function getParentByClass(node, className) {
    if (arguments.length === 2) {
        if (node.parentNode &amp;&amp; node.nodeName !== "BODY")
            return getParentByClass(node.parentNode, className, 1);
        else
            return null;
    }
    // Recursive calls
    if (node !== null &amp;&amp; node !== undefined) {
        if (hasClass(node, className)) {
            return node;
        } else {
            if (node.parentNode &amp;&amp; node.nodeName !== "BODY")
                return getParentByClass(node.parentNode, className, 1);
            else
                return null;
        }
    } else {
        return null;
    }
};


// Returns the text of a given node 
function getTextContent(node) {
    if (typeof node.textContent != "undefined") {
        return node.textContent;
    }
    return node.innerText;
};


// Removes all child nodes
function removeAllChildren(node) {
    if (node) {
        while (node.firstChild) {
            node.removeChild(node.firstChild);
        }
    }
}


// Appends a new element to a given node
function append(node, eltName, attArr, strHtml) {
    if (node) {
        var nNode = document.createElement(eltName);
        if (attArr !== undefined) {
            var j = attArr.length;
            while (j--) {
                nNode.setAttribute(attArr[j][0], attArr[j][1]);
            }
        }
        if (strHtml !== undefined) {
            nNode.innerHTML = strHtml;
        }
        node.appendChild(nNode);
        return nNode;
    } else {
        return null;
    }
}


// Get elements by class name (Backwards compatible version)
function getElementsByClassName(rootNode, className) {
    var returnElements = [];
    if (rootNode.getElementsByClassName) {
        // Native getElementsByClassName 
        returnElements = rootNode.getElementsByClassName(className);
    } else if (document.evaluate) {
        // XPath 
        var xpathExpression;
        xpathExpression = ".//*[contains(concat(' ', @class, ' '), ' " 
            + className + " ')]";
        var xpathResult = document.evaluate(
            xpathExpression, rootNode, null, 0, null);
        var node;
        while ((node = xpathResult.iterateNext())) {
            returnElements.push(node);
        }
    } else {
        // Slower DOM fallback 
        className = className.replace(/\-/g, "\\-");
        var elements = rootNode.getElementsByTagName("*");
        for (var x = 0; x &lt; elements.length; x++) {
            if (elements[x].className.match("(^|\\s)" + className 
                + "(\\s|$)")) {
                returnElements.push(elements[x]);
            }
        }
    }
    return returnElements;
}


// Get elements by attribute (Backwards compatible version)
function getElementsByAttribute(
    rootNode, attributeName, attributeValues) {

    var attributeList = attributeValues.split(" ");
    var returnElements = [];
    if (rootNode.querySelectorAll) {
        var selector = '';
        for (var i = 0; i &lt; attributeList.length; i++) {
            selector += '[' + attributeName 
                + '*= "' + attributeList[i] + '"], ';
        }
        returnElements = rootNode.querySelectorAll(
            selector.substring(0, selector.length - 2));
    } else if (document.evaluatex) {
        // XPath 
        var xpathExpression = ".//*[";
        for (var i = 0; i &lt; attributeList.length; i++) {
            if (i !== 0) {
                xpathExpression += " or ";
            }
            xpathExpression += "contains(
                concat(' ', @" + attributeName 
                + ", ' '), ' " + attributeList[i] + " ')";
        }
        xpathExpression += "]";
        var xpathResult = document.evaluate(
            xpathExpression, rootNode, null, 0, null);
        var node;
        while ((node = xpathResult.iterateNext())) {
            returnElements.push(node);
        }
    } else {
        // Slower fallback 
        attributeName = attributeName.replace(/\-/g, "\\-");
        var elements = rootNode.getElementsByTagName("*");
        for (var x = 0; x &lt; elements.length; x++) {
            if (elements[x][attributeName]) {
                var found = false;
                for (var y = 0; y &lt; attributeList.length; y++) {
                    if (elements[x][attributeName].match("(^|\\s)" 
                        + attributeList[y] + "(\\s|$)")) {
                        found = true;
                    }
                }
                if (found)
                    returnElements.push(elements[x]);
            }
        }
    }
    return returnElements;
},

</code></pre>


<h2><a name="loops">Loops</a></h2>
<pre class="prettyprint" lang-html=""><code>
// While reverse loop - fast
var i = arr.length;
while (i--) {
    // Do Stuff
}


// While loop
var i = arr.length;
var x = 0;
while (x &lt; i) {
    // Do stuff
    x++;
}
</code></pre>



<h2><a name="events">Events</a></h2>
<pre class="prettyprint" lang-html=""><code>
    
// Add event (Cross browser old school)
function addEvent(obj, type, fn) {
    if (obj) {
        if (obj.attachEvent) {
            obj['e' + type + fn] = fn;
            obj[type + fn] = function () { 
                obj['e' + type + fn](window.event); 
            };
            obj.attachEvent('on' + type, obj[type + fn]);
        } else {
            obj.addEventListener(type, fn, false);
        }
    }
};


// Remove event (Cross browser old school)
function removeEvent(obj, type, fn) {
    if (obj) {
        if (obj.detachEvent) {
            obj.detachEvent('on' + type, obj[type + fn]);
            obj[type + fn] = null;
        } else {
            obj.removeEventListener(type, fn, false);
        }
    }
};


// Cancel event bubbling to the rest of DOM
function cancelBubble(e) {
    if (window.event)
        window.event.cancelBubble = true;
    else
        e.stopPropagation();
};


// Prevents the events default action from happening.
u.preventDefault = function (e) {
    if (e.preventDefault)
        e.preventDefault();
    try {
        e.returnValue = false;
    } catch (ex) {
        // Do nothing
    }
};

// Cancel bubbling and prevent default action
function eventStop(e) {
    cancelBubble(e);
    preventDefault(e);
}
</code></pre>



<h2><a name="typedetection">Type detection</a></h2>
<pre class="prettyprint" lang-html=""><code>
// Is an object a string
function isString(obj) {
    return typeof (obj) == 'string';
};


// Is an object a array
function isArray(obj) {
    return obj &amp;&amp; !(obj.propertyIsEnumerable('length')) 
        &amp;&amp; typeof obj === 'object' 
        &amp;&amp; typeof obj.length === 'number';
};


// Is an object a int
function isInt(obj) {
    var re = /^\d+$/;
    return re.test(obj);
};


// Is an object a email address
function isEmail(obj) {
    if(isString(obj)){
        return obj.match(/\b[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,4}\b/ig);
    }else{
        return false;
    }
};


// Is an object a URL
function isUrl (obj) {
    if(isString(obj)){
        var re = new RegExp("^(http|https)\://([a-zA-Z0-9\.\-]+(\:" +
            "[a-zA-Z0-9\.&amp;%\$\-]+)*@)*((25[0-5]|2[0-4][0-9]|" +
            "[0-1]{1}[0-9]{2}|[1-9]{1}[0-9]{1}|[1-9])\.(25[0-5]|2" +
            "[0-4][0-9]|[0-1]{1}[0-9]{2}|[1-9]{1}[0-9]{1}|[1-9]|0)\." +
            "(25[0-5]|2[0-4][0-9]|[0-1]{1}[0-9]{2}|[1-9]{1}[0-9]{1}|" +
            "[1-9]|0)\.(25[0-5]|2[0-4][0-9]|[0-1]{1}[0-9]{2}|[1-9]" +
            "{1}[0-9]{1}|[0-9])|localhost|([a-zA-Z0-9\-]+\.)*[a-zA-Z" +
            "0-9\-]+\.(com|edu|gov|int|mil|net|org|biz|arpa|info|name" +
            "|pro|aero|coop|museum|[a-zA-Z]{2}))(\:[0-9]+)*(/($|[a-z" +
            "A-Z0-9\.\,\?\'\\\+&amp;%\$#\=~_\-]+))*$");
        return obj.match(re);
    }else{
        return false;
    }
};
</code></pre>


<h2><a name="objectdetection">Object/Method detection</a></h2>
<pre class="prettyprint" lang-html=""><code>
    // Checks for Drag and Drop API support
    function hasDragDrop() {
        var element = document.createElement('div');
        var name = 'ondragstart';
        var isSupported = (name in element);
        if (!isSupported &amp;&amp; element.setAttribute) {
            element.setAttribute(name, 'return;');
            isSupported = typeof element[name] == 'function';
        }
        element = null;
        return isSupported;
    };
</code></pre>


<h2><a name="json">JSON</a></h2>
<pre class="prettyprint" lang-html=""><code>
// Loads a JSON file into document
function getJSON(url) {
    script = document.createElement("script");
    script.setAttribute("type", "text/javascript");
    if (url.indexOf('?') &gt; -1)
        url += '&amp;';
    else
        url += '?';
    url += 'rand=' + Math.random();
    script.setAttribute("src", url);
    document.getElementsByTagName('head')[0].appendChild(script);
};
</code></pre>


<h2><a name="module">Module</a></h2>
<pre class="prettyprint" lang-html=""><code>
// The module pattern
var PeopleStore = (function (m) {
    m.newModule = {};
    newModule.version = 0.1;

    return m;

} (PeopleStore || {}));
</code></pre> 


<h2><a name="closure">Closure</a></h2>
<pre class="prettyprint" lang-html=""><code>
// onClick with a external closure
removeBtn.onclick = post(obj.aValue)
function post(aValue) {
  return function() {
    // do somthing with aValue
  };
}


// onClick with a closure
removeBtn.onclick = function (aValue) {
    return function () {
        // do somthing with aValue
    };
} (obj.aValue)


// addEventListener with a closure
removeBtn.addEventListener('click', function (aValue) {
	return function () {
        // do somthing with aValue
    };
}(obj.aValue), false);
</code></pre>


                  
<p>I have coded and collected these functions over time. They often follow patterns that are found in the public domain. 
Everyone sits on the shoulders of others. The RegExp are copied from public sources on the web. </p>

					</div>
				</article>
				<!--================= END :: Tutorial =================-->
				
				<!--================= START :: Tutorial =================-->
				<article>
					<a id="t-09" name="t-09"></a><h1>09 : My todays top 10 most useful Javascript Functions</h1>
					<div class="tutorial__content">
<div class="art_content"><p>These are my todays top 10 Javascript functions which I gathered in more than 6 months of casually Javascript Development. Almost each of them helped out of more than one problem, so they deserve to be perpetuated here and help again. Most of these are not written by me, but by some other great programmer on the web, and I really would like to mention all of them here if I would know where I have got all of these great scripts.</p><p>Have fun an use wisely.</p><h2>1. Get Elements By Class Name (getElementsByClassName)</h2><p>This is maybe one of the most used and most needed custom Javascript functions of all time. It provides a way to get all elements in a page with a certain class attribute.<br><br></p><pre><code>function getElementsByClassName(classname, node){
&nbsp; &nbsp; if (!node) {
&nbsp; &nbsp; &nbsp; &nbsp; node = document.getElementsByTagName('body')[0];
&nbsp; &nbsp; }
&nbsp;
&nbsp; &nbsp; var a = [], re = new RegExp('\\b' + classname + '\\b');
&nbsp; &nbsp; els = node.getElementsByTagName('*');
&nbsp; &nbsp; for (var i = 0, j = els.length; i &lt; j; i++) {
&nbsp; &nbsp; &nbsp; &nbsp; if (re.test(els[i].className)) {
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; a.push(els[i]);
&nbsp; &nbsp; &nbsp; &nbsp; }
&nbsp; &nbsp; }
&nbsp; &nbsp; return a;
}</code></pre><h2>2. Test if Internet Explorer is used and get its version number</h2><p>I do not know how much functions, CSS selectors or whatever - IE so often acts different or just stupid. It always requires extra work. This after all will help you to detect this nasty browser.<br><br></p><pre><code>// use the class
if(Browser.Version() &lt;8) {
&nbsp;// make crazy IE shit
}
&nbsp;
var Browser = {
&nbsp; &nbsp; Version: function(){
&nbsp; &nbsp; &nbsp; &nbsp; var version = 999; // we assume a sane browser
&nbsp; &nbsp; &nbsp; &nbsp; if (navigator.appVersion.indexOf("MSIE") != -1) 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // bah, IE again, lets downgrade version number
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; version = parseFloat(navigator.appVersion.split("MSIE")[1]);
&nbsp; &nbsp; &nbsp; &nbsp; return version;
&nbsp; &nbsp; }
}</code></pre><h2>3. Clear input-field onclick, if value is default</h2><p>This is not much of javascript, we actually call it dynamic html. It is just the standard way to present the comfortable input fields to users.<br><br></p><pre><code><input type="text" name="" value="username" onclick="if(this.value=='username') this.value='';"></code></pre><h2>4. Test if a String is not empty</h2><p>Can help to avoid a lot of common mistakes with javascript.<br><br></p><pre><code>var bpat &nbsp; &nbsp;= /\S/;
function isNonblank (s) {
&nbsp; &nbsp;return String (s).search (bpat) != -1
}</code></pre><h2>5. Function Exists</h2><p>This is a possibility in Javascript to test if a function exists (like function_exists in PHP). This can be useful in cases of debugging or when you are not sure if some required script file is loaded, for example.<br><br></p><pre><code>if(typeof yourFunctionName == 'function') {
&nbsp; &nbsp; &nbsp;yourFunctionName();
}</code></pre><h2>6. Get scroll width/height of page visitors' browser window</h2><p>A browser-safe way to get the number of pixels, which a user scrolled down the webpage currently.<br><br></p><pre><code>function getScrollXY() {
&nbsp; &nbsp; var scrOfX = 0, scrOfY = 0;
&nbsp;
&nbsp; &nbsp; if( typeof( window.pageYOffset ) == 'number' ) {
&nbsp; &nbsp; &nbsp; &nbsp; //Netscape compliant
&nbsp; &nbsp; &nbsp; &nbsp; scrOfY = window.pageYOffset;
&nbsp; &nbsp; &nbsp; &nbsp; scrOfX = window.pageXOffset;
&nbsp; &nbsp; } else if( document.body &amp;&amp; ( document.body.scrollLeft || document.body.scrollTop ) ) {
&nbsp; &nbsp; &nbsp; &nbsp; //DOM compliant
&nbsp; &nbsp; &nbsp; &nbsp; scrOfY = document.body.scrollTop;
&nbsp; &nbsp; &nbsp; &nbsp; scrOfX = document.body.scrollLeft;
&nbsp; &nbsp; } else if( document.documentElement &amp;&amp; ( document.documentElement.scrollLeft || document.documentElement.scrollTop ) ) {
&nbsp; &nbsp; &nbsp; &nbsp; //IE6 standards compliant mode
&nbsp; &nbsp; &nbsp; &nbsp; scrOfY = document.documentElement.scrollTop;
&nbsp; &nbsp; &nbsp; &nbsp; scrOfX = document.documentElement.scrollLeft;
&nbsp; &nbsp; }
&nbsp; &nbsp; return [ scrOfX, scrOfY ];
}</code></pre><h2>7. Get current size of page visitors' browser window</h2><p>A browser-safe way to get the window height and window width of the current viewers browser in pixels.<br><br></p><pre><code>function getWindowSize() {
&nbsp; &nbsp; var myWidth = 0, myHeight = 0;
&nbsp;
&nbsp; &nbsp; if( typeof( window.innerWidth ) == 'number' ) {
&nbsp; &nbsp; &nbsp; &nbsp; //Non-IE
&nbsp; &nbsp; &nbsp; &nbsp; myWidth = window.innerWidth;
&nbsp; &nbsp; &nbsp; &nbsp; myHeight = window.innerHeight;
&nbsp; &nbsp; } else if( document.documentElement &amp;&amp; ( document.documentElement.clientWidth || document.documentElement.clientHeight ) ) {
&nbsp; &nbsp; &nbsp; &nbsp; //IE 6+ in 'standards compliant mode'
&nbsp; &nbsp; &nbsp; &nbsp; myWidth = document.documentElement.clientWidth;
&nbsp; &nbsp; &nbsp; &nbsp; myHeight = document.documentElement.clientHeight;
&nbsp; &nbsp; } else if( document.body &amp;&amp; ( document.body.clientWidth || document.body.clientHeight ) ) {
&nbsp; &nbsp; &nbsp; &nbsp; //IE 4 compatible
&nbsp; &nbsp; &nbsp; &nbsp; myWidth = document.body.clientWidth;
&nbsp; &nbsp; &nbsp; &nbsp; myHeight = document.body.clientHeight;
&nbsp; &nbsp; }
&nbsp; &nbsp; return [ myWidth, myHeight ];
}</code></pre><h2>8. Scale images by setting a maximum width/height</h2><p>It is not always the best idea to scale images with javascript. But I came to several applications there this was useful though.<br><br></p><pre><code>
var images = document.getElementsByTagName("img"); // get your images somehow
scaleImages(imgs,150,150); // call the function
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
// scales the images to a maximum width/height
function scaleImages(images,maxh,maxw) {
&nbsp; 
for(i=0;i<imgs.length;i++) {=""  var="" ratio="maxh/maxw;" img="imgs[i];"  =""  if="" (img.height="" img.width=""> ratio){
&nbsp; // height is the problem
&nbsp; if (img.height &gt; maxh){
&nbsp; &nbsp;img.width = Math.round(img.width*(maxh/img.height));
&nbsp; &nbsp;img.height = maxh;
&nbsp; }
&nbsp;} else {
&nbsp; // width is the problem
&nbsp; if (img.width &gt; maxh){
&nbsp; &nbsp;img.height = Math.round(img.height*(maxw/img.width));
&nbsp; &nbsp;img.width = maxw;
&nbsp; }
&nbsp; &nbsp;}
&nbsp; &nbsp;img.setAttribute("class","showpreview ready");
&nbsp; }
}</imgs.length;i++)></code></pre><h2>9. Print Javascript Array (like print_r()-in PHP)</h2><p>A really useful function for debugging and developing with javascript. Instead of [object Object] or something similar you will see the whole contents of an array in your output.<br><br></p><pre><code>&nbsp;function dump(arr,level) {
&nbsp; var dumped_text = "";
&nbsp; if(!level) level = 0;
&nbsp; 
&nbsp; //The padding given at the beginning of the line.
&nbsp; var level_padding = "";
&nbsp; for(var j=0;j<level+1;j++) level_padding="" +=" &nbsp; &nbsp;" ;=""  ="" if(typeof(arr)="=" 'object')="" {="" array="" hashes="" objects=""  for(var="" item="" in="" arr)="" var="" value="arr[item];" if(typeof(value)="=" if="" it="" is="" an="" array,=""  dumped_text="" "'"="" "'="" ...\n";="" }="" else=""> \"" + value + "\"\n";
&nbsp; &nbsp; }
&nbsp; &nbsp;}
&nbsp; } else { //Stings/Chars/Numbers etc.
&nbsp; &nbsp;dumped_text = "===&gt;"+arr+"&lt;===("+typeof(arr)+")";
&nbsp; }
&nbsp; return dumped_text;
&nbsp;}</level+1;j++)></code></pre><h2>10. XML2Array (parse xml to javascript array)</h2><p>For the special case of reading XML with Javascript. But very useful, when it comes to the case. It is much easier to handle a huge array in Javascript than reading lots of data from a complex XML-file. Maybe there is a tiny disadvantage concerning speed, but I think it is worth that.<br><br></p><pre><code>//////////////////////////////////// xml2array() ////////////////////////////////////////
// See http://www.openjs.com/scripts/xml_parser/
var not_whitespace = new RegExp(/[^\s]/|&gt;); //This can be given inside the funciton - I made it a global variable to make the scipt a little bit faster.
var parent_count;
//Process the xml data
function xml2array(xmlDoc,parent_count) {
&nbsp;var arr;
&nbsp;var parent = "";
&nbsp;parent_count = parent_count || new Object;

&nbsp;var attribute_inside = 0; /*:CONFIG: Value - 1 or 0
&nbsp;* If 1, Value and Attribute will be shown inside the tag - like this...
&nbsp;* For the XML string...
&nbsp;* <guid ispermalink="true">http://www.bin-co.com/</guid>
&nbsp;* The resulting array will be...
&nbsp;* array['guid']['value'] = "http://www.bin-co.com/";
&nbsp;* array['guid']['attribute_isPermaLink'] = "true";
&nbsp;* 
&nbsp;* If 0, the value will be inside the tag but the attribute will be outside - like this... 
&nbsp;* For the same XML String the resulting array will be...
&nbsp;* array['guid'] = "http://www.bin-co.com/";
&nbsp;* array['attribute_guid_isPermaLink'] = "true";
&nbsp;*/

&nbsp;if(xmlDoc.nodeName &amp;&amp; xmlDoc.nodeName.charAt(0) != "#") {
&nbsp; if(xmlDoc.childNodes.length &gt; 1) { //If its a parent
&nbsp; &nbsp;arr = new Object;
&nbsp; &nbsp;parent = xmlDoc.nodeName;
&nbsp; &nbsp;
&nbsp; }
&nbsp;}
&nbsp;var value = xmlDoc.nodeValue;
&nbsp;if(xmlDoc.parentNode &amp;&amp; xmlDoc.parentNode.nodeName &amp;&amp; value) {
&nbsp; if(not_whitespace.test(value)) {//If its a child
&nbsp; &nbsp;arr = new Object;
&nbsp; &nbsp;arr[xmlDoc.parentNode.nodeName] = value;
&nbsp; }
&nbsp;}

&nbsp;if(xmlDoc.childNodes.length) {
&nbsp; if(xmlDoc.childNodes.length == 1) { //Just one item in this tag.
&nbsp; &nbsp;arr = xml2array(xmlDoc.childNodes[0],parent_count); //:RECURSION:
&nbsp; } else { //If there is more than one childNodes, go thru them one by one and get their results.
&nbsp; &nbsp;var index = 0;

&nbsp; &nbsp;for(var i=0; i<xmldoc.childnodes.length; i++)="" {="" go="" thru="" all="" the="" child="" nodes.=""  ="" var="" temp="xml2array(xmlDoc.childNodes[i],parent_count);" :recursion:="" if(temp)=""  var="" assoc="false;" arr_count="0;"  for(key="" in="" temp)="" if(isnan(key))="" arr_count++;="" if(arr_count="">2) break;//We just need to know wether it is a single value array or not
&nbsp; &nbsp; &nbsp;}

&nbsp; &nbsp; &nbsp;if(assoc &amp;&amp; arr_count == 1) {
&nbsp; &nbsp; &nbsp; if(arr[key]) { &nbsp;//If another element exists with the same tag name before,
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // &nbsp;put it in a numeric array.
&nbsp; &nbsp; &nbsp; &nbsp;//Find out how many time this parent made its appearance
&nbsp; &nbsp; &nbsp; &nbsp;if(!parent_count || !parent_count[key]) {
&nbsp; &nbsp; &nbsp; &nbsp; parent_count[key] = 0;

&nbsp; &nbsp; &nbsp; &nbsp; var temp_arr = arr[key];
&nbsp; &nbsp; &nbsp; &nbsp; arr[key] = new Object;
&nbsp; &nbsp; &nbsp; &nbsp; arr[key][0] = temp_arr;
&nbsp; &nbsp; &nbsp; &nbsp;}
&nbsp; &nbsp; &nbsp; &nbsp;parent_count[key]++;
&nbsp; &nbsp; &nbsp; &nbsp;arr[key][parent_count[key]] = temp[key]; //Members of of a numeric array
&nbsp; &nbsp; &nbsp; } else {
&nbsp; &nbsp; &nbsp; &nbsp;parent_count[key] = 0;
&nbsp; &nbsp; &nbsp; &nbsp;arr[key] = temp[key];
&nbsp; &nbsp; &nbsp; &nbsp;if(xmlDoc.childNodes[i].attributes &amp;&amp; xmlDoc.childNodes[i].attributes.length) {
&nbsp; &nbsp; &nbsp; &nbsp; for(var j=0; j</xmldoc.childnodes.length;></code></pre></div>
					</div>
				</article>
				<!--================= END :: Tutorial =================-->
				
				<!--================= START :: Tutorial =================-->
				<article>
					<a id="t-10" name="t-10"></a><h1>10 : 12 Extremely Useful Hacks for JavaScript</h1>
					<span>https://blog.jscrambler.com/12-extremely-useful-hacks-for-javascript/</span>
					<div class="tutorial__content">



<p>In this post I will share <strong>12 extremely useful hacks for JavaScript</strong>. These hacks reduce the code and will help you to run optimized code. So let's start hacking!  </p>

<h2 id="1convertingtobooleanusingoperator">1) Converting to boolean using <strong>!!</strong> operator</h2>

<p>Sometimes we need to check if some variable exists or if it has a valid value, to consider them as <em>true value</em>. For do this kind of validation, you can use the <code>!!</code><em>(Double negation operator)</em> a simple <code>!!variable</code>, which will automatically convert any kind of data to boolean and this variable will return <code>false</code> only if it has some of these values: <code>0</code>, <code>null</code>, <code>""</code>, <code>undefined</code> or <code>NaN</code>, otherwise it will return <code>true</code>. To understand it in practice, take a look this simple example:</p>

<pre><code class="language- javascript">function Account(cash) {  
    this.cash = cash;
    this.hasMoney = !!cash;
}
var account = new Account(100.50);  
console.log(account.cash); // 100.50  
console.log(account.hasMoney); // true

var emptyAccount = new Account(0);  
console.log(emptyAccount.cash); // 0  
console.log(emptyAccount.hasMoney); // false  
</code></pre>

<p>In this case, if an <code>account.cash</code> value is greater than zero, the <code>account.hasMoney</code> will be true.  </p>

<h2 id="2convertingtonumberusingoperator">2) Converting to number using <strong>+</strong> operator</h2>

<p>This magic is awesome! And it's very simple to be done, but it only works with string numbers, otherwise it will return <code>NaN</code><em>(Not a Number)</em>. Have a look on this example:</p>

<pre><code class="language- javascript">function toNumber(strNumber) {  
    return +strNumber;
}
console.log(toNumber("1234")); // 1234  
console.log(toNumber("ACB")); // NaN  
</code></pre>

<p>This magic will work with <code>Date</code> too and, in this case, it will return the timestamp number:</p>

<pre><code class="language- javascript">console.log(+new Date()) // 1461288164385  
</code></pre>

<h2 id="3shortcircuitsconditionals">3) Short-circuits conditionals</h2>

<p>If you see a similar code:</p>

<pre><code class="language- javascript">if (conected) {  
    login();
}
</code></pre>

<p>You can shorten it by using the combination of a variable (which will be verified) and a function using the <code>&amp;&amp;</code> (AND operator) between both. For example, the previous code can become smaller in one line:</p>

<pre><code class="language- javascript">conected &amp;&amp; login();  
</code></pre>

<p>You can do the same to check if some attribute or function exists in the object. Similar to the below code:</p>

<pre><code class="language- javascript">user &amp;&amp; user.login();  
</code></pre>

<h2 id="4defaultvaluesusingoperator">4) Default values using <strong>||</strong> operator</h2>

<p>Today in ES6 there is the default argument feature. In order to simulate this feature in old browsers you can use the <code>||</code> (OR operator) by including the default value as a second parameter to be used. If the first parameter returns <code>false</code> the second one will be used as a default value. See this example:</p>

<pre><code class="language- javascript">function User(name, age) {  
    this.name = name || "Oliver Queen";
    this.age = age || 27;
}
var user1 = new User();  
console.log(user1.name); // Oliver Queen  
console.log(user1.age); // 27

var user2 = new User("Barry Allen", 25);  
console.log(user2.name); // Barry Allen  
console.log(user2.age); // 25  
</code></pre>

<h2 id="5cachingthearraylengthintheloop">5) Caching the <code>array.length</code> in the loop</h2>

<p>This tip is very simple and causes a huge impact on the performance when processing large arrays during a loop. Basically, almost everybody writes this synchronous <code>for</code> to iterate an array:</p>

<pre><code class="language- javascript">for (var i = 0; i &lt; array.length; i++) {  
    console.log(array[i]);
}
</code></pre>

<p>If you work with smaller arrays – it's fine, but if you process large arrays, this code will recalculate the size of array in every iteration of this loop and this will cause a bit of delays. To avoid it, you can cache the <code>array.length</code> in a variable to use it instead of invoking the <code>array.length</code> every time during the loop:</p>

<pre><code class="language- javascript">var length = array.length;  
for (var i = 0; i &lt; length; i++) {  
    console.log(array[i]);
}
</code></pre>

<p>To make it smaller, just write this code:</p>

<pre><code class="language- javascript">for (var i = 0, length = array.length; i &lt; length; i++) {  
    console.log(array[i]);
}
</code></pre>

<h2 id="6detectingpropertiesinanobject">6) Detecting properties in an object</h2>

<p>This trick is very useful when you need to check if some attribute exists and it avoids running undefined functions or attributes. If you are planning to write cross-browser code, probably you will use this technique too. For example, let's imagine that you need to write code that is compatible with the old Internet Explorer 6 and you want to use the <code>document.querySelector()</code>, to get some elements by their ids. However, in this browser this function doesn't exist, so to check the existence of this function you can use the <code>in</code> operator, see this example:</p>

<pre><code class="language- javascript">if ('querySelector' in document) {  
    document.querySelector("#id");
} else {
    document.getElementById("id");
}
</code></pre>

<p>In this case, if there is no <code>querySelector</code> function in the <code>document</code> object, we can use the <code>document.getElementById()</code> as fallback.</p>

<h2 id="7gettingthelastiteminthearray">7) Getting the last item in the array</h2>

<p>The <code>Array.prototype.slice(begin, end)</code> has the power to cut arrays when you set the <code>begin</code> and <code>end</code> arguments. But if you don't set the <code>end</code> argument, this function will automatically set the max value for the array. I think that few people know that this function can accept negative values, and if you set a negative number as <code>begin</code> argument you will get the last elements from the array:</p>

<pre><code class="language- javascript">var array = [1, 2, 3, 4, 5, 6];  
console.log(array.slice(-1)); // [6]  
console.log(array.slice(-2)); // [5,6]  
console.log(array.slice(-3)); // [4,5,6]  
</code></pre>

<h2 id="8arraytruncation">8) Array truncation</h2>

<p>This technique can lock the array's size, this is very useful to delete some elements of the array based on the number of elements you want to set. For example, if you have an array with 10 elements, but you want to get only the first five elements, you can truncate the array, making it smaller by setting the <code>array.length = 5</code>. See this example:</p>

<pre><code class="language- javascript">var array = [1, 2, 3, 4, 5, 6];  
console.log(array.length); // 6  
array.length = 3;  
console.log(array.length); // 3  
console.log(array); // [1,2,3]  
</code></pre>

<h2 id="9replaceall">9) Replace all</h2>

<p>The <code>String.replace()</code> function allows using String and Regex to replace strings, natively this function only replaces the first occurrence. But you can simulate a <code>replaceAll()</code> function by using the <code>/g</code> at the end of a Regex:</p>

<pre><code class="language- javascript">var string = "john john";  
console.log(string.replace(/hn/, "ana")); // "joana john"  
console.log(string.replace(/hn/g, "ana")); // "joana joana"  
</code></pre>

<h2 id="10mergingarrays">10) Merging arrays</h2>

<p>If you need to merge two arrays you can use the <code>Array.concat()</code> function:</p>

<pre><code class="language- javascript">var array1 = [1, 2, 3];  
var array2 = [4, 5, 6];  
console.log(array1.concat(array2)); // [1,2,3,4,5,6];  
</code></pre>

<p>However, this function is not the most suitable to merge large arrays because it will consume a lot of memory by creating a new array. In this case, you can use <code>Array.push.apply(arr1, arr2)</code> which instead creates a new array – it will merge the second array in the first one reducing the memory usage:</p>

<pre><code class="language- javascript">var array1 = [1, 2, 3];  
var array2 = [4, 5, 6];  
console.log(array1.push.apply(array1, array2)); // [1,2,3,4,5,6];  
</code></pre>

<h2 id="11convertingnodelisttoarrays">11) Converting NodeList to Arrays</h2>

<p>If you run the <code>document.querySelectorAll("p")</code> function, it will probably return an array of DOM elements, the NodeList object. But this object doesn't have all array's functions, like: <code>sort()</code>, <code>reduce()</code>, <code>map()</code>, <code>filter()</code>. In order to enable these and many other native array's functions you need to convert NodeList into Arrays. To run this technique just use this function: <code>[].slice.call(elements)</code>:</p>

<pre><code class="language- javascript">var elements = document.querySelectorAll("p"); // NodeList  
var arrayElements = [].slice.call(elements); // Now the NodeList is an array  
var arrayElements = Array.from(elements); // This is another way of converting NodeList to Array  
</code></pre>

<h2 id="12shufflingarrayselements">12) Shuffling array's elements</h2>

<p>To shuffle the array's elements without using any external library like <em>Lodash</em>, just run this magic trick:</p>

<pre><code class="language- javascript">var list = [1, 2, 3];  
console.log(list.sort(function() {  
    return Math.random() - 0.5
})); // [2,1,3]
</code></pre>

<h2 id="conclusion">Conclusion</h2>

<p>Now you learned some useful JS hacks which are largely used to minify JavaScript code and some of these tricks are used in many popular JS frameworks like Lodash, Underscore.js, Strings.js, among others. If you want to go even deeper and learn more about how you can minify your code even more and even protect it from prying eyes talk to <a href="support@jscrambler.com">us</a>. I hope you enjoyed this post and if you know other JS hacks, please let us know!</p>
					</div>
				</article>
				<!--================= END :: Tutorial =================-->
				
				<!--================= START :: Tutorial =================-->
				<article>
					<a id="t-11" name="t-11"></a><h1>11 : 45 Useful JavaScript Tips, Tricks and Best Practices</h1>
					<div class="tutorial__content">
<span>https://modernweb.com/45-useful-javascript-tips-tricks-and-best-practices/</span>
<p>As you know, JavaScript is the number one programming language in the world, the language of the web, of mobile hybrid apps (like <a href="http://phonegap.com/">PhoneGap</a> or <a href="http://www.appcelerator.com/">Appcelerator</a>), of the server side (like <a href="http://nodejs.org">NodeJS</a> or <a href="http://wakanda.org">Wakanda</a>) and has many other implementations. It's also the starting point for many new developers to the world of programming, as it can be used to display a simple alert in the web browser but also to control a robot (using <a href="http://nodebots.io/">nodebot</a>, or <a href="http://semu.github.io/noduino/">nodruino</a>). The developers who master JavaScript and write organized and performant code have become the most sought after in the job market.</p>
<p>In this article, I'll share a set of JavaScript tips, tricks and best practices that should be known by all JavaScript developers regardless of their browser/engine or the SSJS (Server Side JavaScript) interpreter.</p>
<p>Note that the code snippets in this article have been tested in the latest Google Chrome version 30, which uses the V8 JavaScript Engine (V8 3.20.17.15).</p>
<p><strong>1 – Don't forget <code>var</code> keyword when assigning a variable's value for the first time.</strong></p>
<p>Assignment to an undeclared variable automatically results in a global variable being created. Avoid global variables.</p>
<p><strong>2 – use <code>===</code> instead of <code>==</code></strong></p>
<p>The <code>==</code> (or <code>!=</code>) operator performs an automatic type conversion if needed. The <code>===</code> (or <code>!==</code>) operator will not perform any conversion. It compares the value and the type, which could be considered faster than <code>==</code>.</p>
<pre><code class="language-javascript">[10] === 10    // is false
[10]  == 10    // is true
'10' == 10     // is true
'10' === 10    // is false
 []   == 0     // is true
 [] ===  0     // is false
 '' == false   // is true but true == "a" is false
 '' ===   false // is false </code></pre>
<p><strong>3 – <code>undefined</code>, <code>null</code>, 0, <code>false</code>, <code>NaN</code>, <code>''</code> (empty string) are all falsy.</strong><br>
<strong>4 – Use Semicolons for line termination</strong></p>
<p>The use of semi-colons for line termination is a good practice. You won't be warned if you forget it, because in most cases it will be inserted by the JavaScript parser. For more details about why you should use semi-colons, take a look to this artice: <a href="http://davidwalsh.name/javascript-semicolons">http://davidwalsh.name/javascript-semicolons</a>.</p>
<p><strong>5 – Create an object constructor</strong></p>
<pre><code class="language-javascript">function Person(firstName, lastName){
    this.firstName =  firstName;
    this.lastName = lastName;        
}  

var Saad = new Person("Saad", "Mousliki");</code></pre>
<p><strong>6 – Be careful when using <code>typeof</code>, <code>instanceof</code> and <code>constructor</code>.</strong></p>
<ul>
<li><em>typeof</em> : a JavaScript unary operator used to  return a string that represents the primitive type of a variable,  don't forget that <code>typeof null</code> will return "object", and for the majority of object types (Array, Date, and others) will return also "object".</li>
<li><em>constructor</em> : is a property of the internal prototype property, which could be overridden by code.</li>
<li><em>instanceof</em> : is another JavaScript operator that check in all the prototypes chain the constructor it returns true if it's found and false if not.</li>
</ul>
<pre><code class="language-javascript">var arr = ["a", "b", "c"];
typeof arr;   // return "object" 
arr  instanceof Array // true
arr.constructor();  //[]
</code></pre>
<p><strong>7 – Create a Self-calling Function</strong></p>
<p>This is often called a Self-Invoked Anonymous Function or Immediately Invoked Function Expression (IIFE). It is a function that executes automatically when you create it, and has the following form:</p>
<pre><code class="language-javascript">(function(){
    // some private code that will be executed automatically
})();  
(function(a,b){
    var result = a+b;
    return result;
})(10,20)</code></pre>
<p><strong>8 – Get a random item from an array</strong></p>
<pre><code class="language-javascript">var items = [12, 548 , 'a' , 2 , 5478 , 'foo' , 8852, , 'Doe' , 2145 , 119];

var  randomItem = items[Math.floor(Math.random() * items.length)];</code></pre>
<p><strong>9 – Get a random number in a specific range</strong></p>
<p>This code snippet can be useful when trying to generate fake data for testing purposes, such as a salary between min and max.</p>
<pre><code class="language-javascript">var x = Math.floor(Math.random() * (max - min + 1)) + min;</code></pre>
<p><strong>10 – Generate an array of numbers with numbers from 0 to max</strong></p>
<pre><code class="language-javascript">var numbersArray = [] , max = 100;

for( var i=1; numbersArray.push(i++) &lt; max;);  // numbers = [1,2,3 ... 100] </code></pre>
<p><strong>11 – Generate a random set of alphanumeric characters</strong></p>
<pre><code class="language-javascript">function generateRandomAlphaNum(len) {
    var rdmString = "";
    for( ; rdmString.length &lt; len; rdmString  += Math.random().toString(36).substr(2));
    return  rdmString.substr(0, len);

}
</code></pre>
<p><strong>12 – Shuffle an array of numbers</strong></p>
<pre><code class="language-javascript">var numbers = [5, 458 , 120 , -215 , 228 , 400 , 122205, -85411];
numbers = numbers.sort(function(){ return Math.random() - 0.5});
/* the array numbers will be equal for example to [120, 5, 228, -215, 400, 458, -85411, 122205]  */</code></pre>
<p>A better option could be to implement a random sort order by code (e.g. : Fisher-Yates shuffle), than using the native sort JavaScript function. For more details take a look to <a href="http://stackoverflow.com/questions/962802/is-it-correct-to-use-javascript-array-sort-method-for-shuffling/962890#962890">this discussion</a>.</p>
<p><strong>13 – A string trim function</strong></p>
<p>The classic trim function of Java, C#, PHP and many other language that remove whitespace from a string doesn't exist in JavaScript, so we could add it to the <code>String</code> object.</p>
<pre><code class="language-javascript">String.prototype.trim = function(){return this.replace(/^s+|s+$/g, "");};  </code></pre>
<p>A native implementation of the trim() function is available in the recent JavaScript engines.</p>
<p><strong>14 – Append an array to another array</strong></p>
<pre><code class="language-javascript">var array1 = [12 , "foo" , {name "Joe"} , -2458];

var array2 = ["Doe" , 555 , 100];
Array.prototype.push.apply(array1, array2);
/* array1 will be equal to  [12 , "foo" , {name "Joe"} , -2458 , "Doe" , 555 , 100] */</code></pre>
<p><strong>15 – Transform the <code>arguments</code> object into an array</strong></p>
<pre><code class="language-javascript">var argArray = Array.prototype.slice.call(arguments);</code></pre>
<p><strong>16 – Verify that a given argument is a number</strong></p>
<pre><code class="language-javascript">function isNumber(n){
    return !isNaN(parseFloat(n)) &amp;&amp; isFinite(n);
}</code></pre>
<p><strong>17 – Verify that a given argument is an array</strong></p>
<pre><code class="language-javascript">function isArray(obj){
    return Object.prototype.toString.call(obj) === '[object Array]' ;
}</code></pre>
<p>Note that if the toString() method is overridden, you will not get the expected result using this trick.</p>
<p>Or use…</p>
<pre><code class="language-javascript">Array.isArray(obj); // its a new Array method</code></pre>
<p>You could also use <code>instanceof</code> if you are not working with multiple frames. However, if you have many contexts, you will get a wrong result.</p>
<pre><code class="language-javascript">var myFrame = document.createElement('iframe');
document.body.appendChild(myFrame);

var myArray = window.frames[window.frames.length-1].Array;
var arr = new myArray(a,b,10); // [a,b,10]  

// instanceof will not work correctly, myArray loses his constructor 
// constructor is not shared between frames
arr instanceof Array; // false</code></pre>
<p><strong>18 – Get the max or the min in an array of numbers</strong></p>
<pre><code class="language-javascript">var  numbers = [5, 458 , 120 , -215 , 228 , 400 , 122205, -85411]; 
var maxInNumbers = Math.max.apply(Math, numbers); 
var minInNumbers = Math.min.apply(Math, numbers);</code></pre>
<p><strong>19 – Empty an array</strong></p>
<pre><code class="language-javascript">var myArray = [12 , 222 , 1000 ];  
myArray.length = 0; // myArray will be equal to [].</code></pre>
<p><strong>20 – Don't use delete to remove an item from array</strong></p>
<p>Use <code>splice</code> instead of using <code>delete</code> to delete an item from an array. Using <code>delete</code> replaces the item with <code>undefined</code> instead of the removing it from the array.</p>
<p>Instead of…</p>
<pre><code class="language-javascript">var items = [12, 548 ,'a' , 2 , 5478 , 'foo' , 8852, , 'Doe' ,2154 , 119 ]; 
items.length; // return 11 
delete items[3]; // return true 
items.length; // return 11 
/* items will be equal to [12, 548, "a", undefined × 1, 5478, "foo", 8852, undefined × 1, "Doe", 2154,       119]   */</code></pre>
<p>Use…</p>
<pre><code class="language-javascript">var items = [12, 548 ,'a' , 2 , 5478 , 'foo' , 8852, , 'Doe' ,2154 , 119 ]; 
items.length; // return 11 
items.splice(3,1) ; 
items.length; // return 10 
/* items will be equal to [12, 548, "a", 5478, "foo", 8852, undefined × 1, "Doe", 2154,       119]   */</code></pre>
<p>The delete method should be used to delete an object property.</p>
<p><strong>21 – Truncate an array using length</strong></p>
<p>Like the previous example of emptying an array, we truncate it using the <code>length</code> property.</p>
<pre><code class="language-javascript">var myArray = [12 , 222 , 1000 , 124 , 98 , 10 ];  
myArray.length = 4; // myArray will be equal to [12 , 222 , 1000 , 124].</code></pre>
<p>As a bonus, if you set the array length to a higher value, the length will be changed and new items will be added with <code>undefined</code> as a value. The array length is not a read only property.</p>
<pre><code class="language-javascript">myArray.length = 10; // the new array length is 10 
myArray[myArray.length - 1] ; // undefined</code></pre>
<p><strong>22 – Use logical AND/ OR for conditions</strong></p>
<pre><code class="language-javascript">var foo = 10;  
foo == 10 &amp;&amp; doSomething(); // is the same thing as if (foo == 10) doSomething(); 
foo == 5 || doSomething(); // is the same thing as if (foo != 5) doSomething();</code></pre>
<p>The logical OR could also be used to set a default value for function argument.</p>
<pre><code class="language-javascript">function doSomething(arg1){ 
    arg1 = arg1 || 10; // arg1 will have 10 as a default value if it's not already set
}</code></pre>
<p><strong>23 – Use the map() function method to loop through an array's items</strong></p>
<pre><code class="language-javascript">var squares = [1,2,3,4].map(function (val) {  
    return val * val;  
}); 
// squares will be equal to [1, 4, 9, 16] </code></pre>
<p><strong>24 – Rounding number to N decimal place</strong></p>
<pre><code class="language-javascript">var num =2.443242342;
num = num.toFixed(4);  // num will be equal to 2.4432</code></pre>
<p>NOTE : the <code>toFixed()</code> function returns a string and not a number.</p>
<p><strong>25 – Floating point problems</strong></p>
<pre><code class="language-javascript">0.1 + 0.2 === 0.3 // is false 
9007199254740992 + 1 // is equal to 9007199254740992  
9007199254740992 + 2 // is equal to 9007199254740994</code></pre>
<p>Why does this happen? 0.1 +0.2 is equal to 0.30000000000000004. What you need to know is that all JavaScript numbers are floating points represented internally in 64 bit binary according to the IEEE 754 standard. For more explanation, take a look to <a href="http://www.2ality.com/2012/04/number-encoding.html">this blog post</a>.</p>
<p>You can use <code>toFixed()</code> and <code>toPrecision()</code> to resolve this problem.</p>
<p><strong>26 – Check the properties of an object when using a for-in loop</strong></p>
<p>This code snippet could be useful in order to avoid iterating through the properties from the object's prototype.</p>
<pre><code class="language-javascript">for (var name in object) {  
    if (object.hasOwnProperty(name)) { 
        // do something with name                    
    }  
}</code></pre>
<p><strong>27 – Comma operator</strong></p>
<pre><code class="language-javascript">var a = 0; 
var b = ( a++, 99 ); 
console.log(a);  // a will be equal to 1 
console.log(b);  // b is equal to 99</code></pre>
<p><strong>28 – Cache variables that need calculation or querying</strong></p>
<p>In the case of a jQuery selector, we could cache the DOM element.</p>
<pre><code class="language-javascript">var navright = document.querySelector('#right'); 
var navleft = document.querySelector('#left'); 
var navup = document.querySelector('#up'); 
var navdown = document.querySelector('#down');</code></pre>
<p><strong>29 – Verify the argument before passing it to <code>isFinite()</code></strong></p>
<pre><code class="language-javascript">isFinite(0/0) ; // false 
isFinite("foo"); // false 
isFinite("10"); // true 
isFinite(10);   // true 
isFinite(undefined);  // false 
isFinite();   // false 
isFinite(null);  // true  !!! </code></pre>
<p><strong>30 – Avoid negative indexes in arrays</strong></p>
<pre><code class="language-javascript">var numbersArray = [1,2,3,4,5]; 
var from = numbersArray.indexOf("foo") ;  // from is equal to -1 
numbersArray.splice(from,2);    // will return [5]</code></pre>
<p>Make sure that the arguments passed to <code>splice</code> are not negative.</p>
<p><strong>31 – Serialization and deserialization (working with JSON)</strong></p>
<pre><code class="language-javascript">var person = {name :'Saad', age : 26, department : {ID : 15, name : "R&amp;D"} }; 
var stringFromPerson = JSON.stringify(person); 
/* stringFromPerson is equal to "{"name":"Saad","age":26,"department":{"ID":15,"name":"R&amp;D"}}"   */ 
var personFromString = JSON.parse(stringFromPerson);  
/* personFromString is equal to person object  */</code></pre>
<p><strong>32 – Avoid the use of <code>eval()</code> or the <code>Function</code> constructor</strong></p>
<p>Use of <code>eval</code> or the <code>Function</code> constructor are expensive operations as each time they are called script engine must convert source code to executable code.</p>
<pre><code class="language-javascript">var func1 = new Function(functionCode);
var func2 = eval(functionCode);</code></pre>
<p><strong>33 – Avoid using <code>with()</code> (The good part)</strong></p>
<p>Using <code>with()</code> inserts a variable at the global scope. Thus, if another variable has the same name it could cause confusion and overwrite the value.</p>
<p><strong>34 – Avoid using for-in loop for arrays</strong></p>
<p>Instead of using…</p>
<pre><code class="language-javascript">var sum = 0;  
for (var i in arrayNumbers) {  
    sum += arrayNumbers[i];  
}</code></pre>
<p>…it's better to use…</p>
<pre><code class="language-javascript">var sum = 0;  
for (var i = 0, len = arrayNumbers.length; i &lt; len; i++) {  
    sum += arrayNumbers[i];  
}</code></pre>
<p>As a bonus, the instantiation of <code>i</code> and <code>len</code> is executed once because it's in the first statement of the for loop. Thsi is faster than using…</p>
<pre><code class="language-javascript">for (var i = 0; i &lt; arrayNumbers.length; i++)</code></pre>
<p>Why? The length of the array <code>arrayNumbers</code> is recalculated every time the loop iterates.</p>
<p>NOTE : the issue of recalculating the length in each iteration was fixed in the latest JavaScript engines.</p>
<p><strong>35 – Pass functions, not strings, to <code>setTimeout()</code> and <code>setInterval()</code></strong></p>
<p>If you pass a string into <code>setTimeout()</code> or <code>setInterval()</code>, the string will be evaluated the same way as with <code>eval</code>, which is slow. Instead of using…</p>
<pre><code class="language-javascript">setInterval('doSomethingPeriodically()', 1000);  
setTimeout('doSomethingAfterFiveSeconds()', 5000);</code></pre>
<p>…use…</p>
<pre><code class="language-javascript">setInterval(doSomethingPeriodically, 1000);  
setTimeout(doSomethingAfterFiveSeconds, 5000);</code></pre>
<p><strong>36 – Use a switch/case statement instead of a series of if/else</strong></p>
<p>Using switch/case is faster when there are more than 2 cases, and it is more elegant (better organized code). Avoid using it when you have more than 10 cases.</p>
<p><strong>37 – Use switch/case statement with numeric ranges</strong></p>
<p>Using a switch/case statement with numeric ranges is possible with this trick.</p>
<pre><code class="language-javascript">function getCategory(age) {  
    var category = "";  
    switch (true) {  
        case isNaN(age):  
            category = "not an age";  
            break;  
        case (age &gt;= 50):  
            category = "Old";  
            break;  
        case (age &lt;= 20):  
            category = "Baby";  
            break;  
        default:  
            category = "Young";  
            break;  
    };  
    return category;  
}  
getCategory(5);  // will return "Baby"</code></pre>
<p><strong>38 – Create an object whose prototype is a given object</strong></p>
<p>It's possible to write a function that creates an object whose prototype is the given argument like this…</p>
<pre><code class="language-javascript">function clone(object) {  
    function OneShotConstructor(){}; 
    OneShotConstructor.prototype= object;  
    return new OneShotConstructor(); 
} 
clone(Array).prototype ;  // []</code></pre>
<p><strong>39 – An HTML escaper function</strong></p>
<pre><code class="language-javascript">function escapeHTML(text) {  
    var replacements= {"&lt;": "&amp;lt;", "&gt;": "&amp;gt;","&amp;": "&amp;amp;", """: "&amp;quot;"};                      
    return text.replace(/[&lt;&gt;&amp;"]/g, function(character) {  
        return replacements[character];  
    }); 
}</code></pre>
<p><strong>40 – Avoid using try-catch-finally inside a loop</strong></p>
<p>The try-catch-finally construct creates a new variable in the current scope at runtime each time the catch clause is executed where the caught exception object is assigned to a variable.</p>
<p>Instead of using…</p>
<pre><code class="language-javascript">var object = ['foo', 'bar'], i;  
for (i = 0, len = object.length; i &lt;len; i++) {  
    try {  
        // do something that throws an exception 
    }  
    catch (e) {   
        // handle exception  
    } 
}</code></pre>
<p>…use…</p>
<pre><code class="language-javascript">var object = ['foo', 'bar'], i;  
try { 
    for (i = 0, len = object.length; i &lt;len; i++) {  
        // do something that throws an exception 
    } 
} 
catch (e) {   
    // handle exception  
} </code></pre>
<p><strong>41 – Set timeouts to <code class="language-javascript">XMLHttpRequests</code></strong></p>
<p>You could abort the connection if an XHR takes a long time (for example, due to a network issue), by using <code>setTimeout()</code> with the XHR call.</p>
<pre><code class="language-javascript">var xhr = new XMLHttpRequest (); 
xhr.onreadystatechange = function () {  
    if (this.readyState == 4) {  
        clearTimeout(timeout);  
        // do something with response data 
    }  
}  
var timeout = setTimeout( function () {  
    xhr.abort(); // call error callback  
}, 60*1000 /* timeout after a minute */ ); 
xhr.open('GET', url, true);  

xhr.send();</code></pre>
<p>As a bonus, you should generally avoid synchronous XHR calls completely.</p>
<p><strong>42 – Deal with WebSocket timeout</strong></p>
<p>Generally when a WebSocket connection is established, a server could time out your connection after 30 seconds of inactivity. The firewall could also time out the connection after a period of inactivity.</p>
<p>To deal with the timeout issue you could send an empty message to the server periodically. To do this, add these two functions to your code: one to keep alive the connection and the other one to cancel the keep alive. Using this trick, you'll control the timeout.</p>
<p>Add a <code>timerID</code>…</p>
<pre><code class="language-javascript">var timerID = 0; 
function keepAlive() { 
    var timeout = 15000;  
    if (webSocket.readyState == webSocket.OPEN) {  
        webSocket.send('');  
    }  
    timerId = setTimeout(keepAlive, timeout);  
}  
function cancelKeepAlive() {  
    if (timerId) {  
        cancelTimeout(timerId);  
    }  
}</code></pre>
<p>The <code>keepAlive()</code> function should be added at the end of the <code>onOpen()</code> method of the webSocket connection and the <code>cancelKeepAlive()</code> at the end of the <code>onClose()</code> method.</p>
<p><strong>43 – Keep in mind that <a href="http://dev.opera.com/articles/view/efficient-javascript/?page=2#primitiveoperator">primitive operations can be faster than function calls</a>. Use <a href="http://vanilla-js.com/">VanillaJS</a>.</strong></p>
<p>For example, instead of using…</p>
<pre><code class="language-javascript">var min = Math.min(a,b); 
A.push(v);</code></pre>
<p>…use…</p>
<pre><code class="language-javascript">var min = a &lt; b ? a : b; 
A[A.length] = v;</code></pre>
<p><strong>44 – Don't forget to use a code beautifier when coding. Use JSLint and minification (JSMin, for example) before going live.</strong></p>
<p><strong>45 – JavaScript is awesome: <a href="http://stackoverflow.com/questions/11246/best-resources-to-learn-javascript">Best Resources To Learn JavaScript</a></strong></p>
<ul>
<li>Code Academy JavaScript tracks: <a href="http://www.codecademy.com/tracks/javascript">http://www.codecademy.com/tracks/javascript</a></li>
<li>Eloquent JavaScript by Marjin Haverbeke: <a href="http://eloquentjavascript.net/">http://eloquentjavascript.net/</a></li>
<li>Advanced JavaScript by John Resig: <a href="http://ejohn.org/apps/learn/">http://ejohn.org/apps/learn/</a></li>
</ul>
<h2>Conclusion</h2>
<p>I know that there are many other tips, tricks and best practices, so if you have any ones to add or if you have any feedback or corrections to the ones that I have shared, please adda comment.</p>
					</div>
				</article>
				<!--================= END :: Tutorial =================-->
				
				<!--================= START :: Tutorial =================-->
				<article>
					<a id="t-12" name="t-12"></a><h1>12 : JavaScript Architecture for the 23rd Century</h1>
					<span>https://modernweb.com/javascript-architecture-23rd-century/</span>
					<div class="tutorial__content">

<blockquote><p>Jonathan discusses JavaScript architecture patterns of the 23rd century and what the future of JavaScript holds for the 24th century."</p></blockquote>
<p>JavaScript applications have grown in size and complexity for the last several years. More and more single page applications have hit the market, and demands for that type of experience have increased to the point where even Google finally decided to <a href="http://googlewebmastercentral.blogspot.com/2014/05/understanding-web-pages-better.html">render JavaScript</a> when it crawls pages.</p>
<p>This demand for SPA type applications has made JavaScript architecture increasingly important. JavaScript, being a dynamic language, you have to go the extra mile to ensure that the code is written in a maintainable fashion and to avoid spaghetti code.</p>
<p>For a long time it seemed like it was ok to just use a single file full of jQuery selectors and event handlers. This is just not a sustainable pattern. The Modern Web that we are entering here in the 23rd century demands a more thought out, and architected approach.</p>
<h2>Architecture Patterns</h2>
<p>An architectural pattern is not something that you sit down and write. No one sits at their desk and thinks about how to write a new shiny pattern. A pattern is something that comes about as a discovery. Some problem is solved potentially multiple times and a pattern is extracted from the solution(s).</p>
<h3>Constructor</h3>
<p>First of all let's take a step back into some native JavaScript functionality that has been there for years, the constructor pattern.</p>
<pre><code class="language-javascript">function Starship() {}
</code></pre>
<p>Every function you declare in JavaScript can be used as a <strong>constructor</strong> to create an instance. This allows you to create reusable functions.</p>
<pre><code class="language-javascript">var enterprise = new Starship(),
IKSBuruk = new Starship();
</code></pre>
<p>You can modify the original function to take arguments to help describe the instance better. You can assign the arguments to properties on <code>this</code> which will refer to the instance of the constructor.</p>
<pre><code class="language-javascript">function Starship(owner, operator, type) {
  this.owner = owner;
  this.operator = operator;
  this.type = type;
}

var enterprise = new Starship('Federation', 'Star Fleet', 'Class 1 Heavy Cruiser'),
birdOfprey = new Starship('Klingon Empire', 'Klingon Imperial Fleet', 'Klingon Warship');
</code></pre>
<p>You can also utilize a built in feature of JavaScript constructors called the <code>prototype</code>. The <code>prototype</code> is simply an object. On it, you define properties and methods that will be added to every instance of a constructor.</p>
<pre><code class="language-javascript">function Starship(owner, operator, type, weapons) {
  /* ... */
  this.weapons = weapons;
}

Starship.prototype.fire = function(weapon) {
  this.weapons[weapon].launch();
};

function PhotonTorpedoSystem() {}
  PhotonTorpedoSystem.prototype.launch = function() {
  console.log('launching torpedos');
};

var torpedos = new PhotonTorpedoSystem(),

var weaponSystem = {
  torpedos: torpedos;
};

var enterprise = new Starship(
  'Federation',
  'Star Fleet',
  'Class 1 Heavy Cruiser',
  weaponSystem
);
enterprise.fire('torpedos') // launching torpedos;
</code></pre>
<p>What's great about the <code>prototype</code> system in JavaScript is it enables you to create a system of inheritance. Inheritance in JavaScript is a little bit different than in other languages, but it's not too difficult with a bit of practice.</p>
<pre><code class="language-javascript">function ConstitutionClass(captain, firstOfficer, missionDuration) {
  this.captain = captain;
  this.firstOfficer = firstOfficer;
  this.missionDuration = missionDuration;

  Starship.apply(this, ['Federation', 'Star Fleet', 'Class 1 Heavy Cruiser', weaponSystem]);
}

ConstitutionClass.prototype = Object.create(Starship.prototype);
ConstitutionClass.prototype.constructor = ConstitutionClass;

ConstitutionClass.prototype.warp = function(speed) {
console.log('warping at: ' + speed);
};

var enterprise = new ConstitutionClass('Kirk', 'Spock', 5);
enterprise.fire('torpedos'); // Launching Torpedos
enterprise.warp(14.1); // warping at: 14.1
</code></pre>
<p>Here we've created the <code>ConstitutionClass</code> constructor. This constructor takes a <code>captain</code>, <code>firstOfficer</code>, and <code>missionDuration</code> as arguments. It then goes on to call <code>Starship.apply</code> and passes in an array of arguments. This ensures that the parent constructor gets called.</p>
<p>Every function in JavaScript has a <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function/call"><code>call</code></a> and <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function/apply"><code>apply</code></a> method that allows you to invoke a function by passing in a <code>context</code> and, in the case of <code>apply</code>, an array of arguments to use when invoking the function.</p>
<p>Next, to properly tell the <code>ConstitutionClass</code> to inherit from <code>Starship</code> we simply use <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/create"><code>Object.create</code></a> to assign the prototype of <code>ConstitutionClass</code>.</p>
<p>What this does is tell <code>ConstitutionClass</code> that it's a type of <code>Starship</code> by adding all of the <code>Starship</code> prototype properties and methods to the <code>ConstitutionClass</code> prototype.</p>
<p>Check out how this looks when you run it and open up the console…</p>
<p><img src="http://d.pr/i/12tb7+" alt=""></p>
<p>You can easily see how the <code>enterprise</code> instance of <code>ConstitutionClass</code> has correctly been assigned its properties, as well as the properties of a <code>Starship</code>.</p>
<p>Notice also how the <code>ConstitutionClass</code> has a warp method as well as a <code>fire</code> method that it inherits from the <code>Starship</code>.</p>
<p>That's <strong>prototypical inheritance</strong>.</p>
<h3>IIFEs to prevent global leaks</h3>
<p>An important thing to note about the code above is there are several global leaks occurring. When you simply declare a function or variable in a JavaScript file, it will automatically be added to the global namespace (the <code>window</code> in the case of a browser);</p>
<p>This code here will create several globals…</p>
<pre><code class="language-javascript">function PhotonTorpedoSystem() {}
PhotonTorpedoSystem.prototype.launch = function() {
  console.log('launching torpedos');
};

var torpedos = new PhotonTorpedoSystem(),

var weaponSystem = {
  torpedos: torpedos;
};
</code></pre>
<p>After running this code you will have created <code>window.PhotonTorpedoSystem</code>, <code>window.torpedos</code>, and <code>window.weaponSystem</code>. This is not an ideal scenario.</p>
<p>One great pattern for avoiding this issue is to utilize an Immediately Invoked Function Expression…</p>
<pre><code class="language-javascript">(function(global) {

function PhotonTorpedoSystem() {}
  PhotonTorpedoSystem.prototype.launch = function() {
  console.log('launching torpedos');
};

var torpedos = new PhotonTorpedoSystem(),

var weaponSystem = {
  torpedos: torpedos;
};

/* Create instance of enterprise etc */

global.PhotonTorpedoSystem = PhotonTorpedoSystem; // Export just this to the window
}(window));
</code></pre>
<p>Here you can see the <code>(function(global) {</code> at the beginning and the <code>}(window));</code><br>
at the end. This causes the anonymous function <code>function(global)</code> to fire right away, and sets <code>global</code> to the <code>window</code>. This all works because the IIFE creates a closure. Everything defined inside the IIFE is contained in the memory for that function alone unless it gets exported on the <code>global</code> we defined.</p>
<p>Now you can explicitly set things on the <code>window</code> for use in other JavaScript files.</p>
<p>This is a step in the right direction, but another even better pattern to utilize here would be the <strong>Namespace Pattern</strong>.</p>
<pre><code class="language-javascript">// weaponSystems.js
(function(global, NS) {
NS.Weapons = NS.Weapons || {};

function PhotonTorpedoSystem() {}
PhotonTorpedoSystem.prototype.launch = function() {
  console.log('launching torpedos');
};

/* ... */

NS.Weapons.PhotonTorpedoSystem = PhotonTorpedoSystem; // Export just this to the NS.Weapons namespace
}(window, window.NS = NS || {});
</code></pre>
<p>Notice how we've changed the bottom of the IIFE to <code>}(window, window.NS = NS || {});</code>. This will pass the <code>window</code>, as well as an <code>NS</code> object. This slightly odd notation here says, "pass NS if it exists, or create a new object for it".</p>
<p>You can also see this syntax used again here <code>NS.Weapons = NS.Weapons || {};</code>.</p>
<p>It's effectively the same thing as using an if statement, but is more terse.</p>
<pre><code class="language-javascript">if (!NS.Weapons) {
NS.Weapons = {};
}
</code></pre>
<p>You can add whatever objects and functions you want to on to the namespace. This will allow you to avoid adding too many globals to the window.</p>
<pre><code class="language-javascript">(function(global, NS) {
NS.Ships = NS.Ships || {};

function Starship(owner, operator, type, weapons) { /* ... */ }
function ConstitutionClass(captain, firstOfficer, missionDuration) { /* ... */ }

/* ... */

NS.Ships.Starship = Starship;
NS.Ships.ConstitutionClass = ConstitutionClass;

}(window, window.NS = NS || {});
</code></pre>
<h3>IIFE for the Revealing Module Pattern</h3>
<p>Another pattern for creating functions is the "revealing module pattern".</p>
<pre><code class="language-javascript">NS.Owners.starFleet = (function() {
  var ships = [];

  var addShip = function(ship) {
    ships.push(ship);
  };

  var removeShip = function(ship) {
    var index = ships.indexOf(ship);

    if (index &gt; -1) {
      ships.splice(index, 1);
    }
  };

  var getTotal = function() {
    return ships.length;
  };

  return {
    addShip: addShip,
    removeShip: removeShip,
    totalShipsInFleet: getTotal
  };
}());
</code></pre>
<p>This pattern allows you to define the public API for an object as well as have a few private members because of the IIFE. In this case, <code>ships</code> stays private because it's defined within the IIFE, whereas <code>addShip</code> and <code>removeShip</code> are exported via the object in the <code>return</code> statement.</p>
<pre><code class="language-javascript">(function() {
var enterprise = new NS.Ships.ConstitutionClass('Kirk', 'Spock', 5);

NS.Owners.starFleet.addShip(enterprise);

NS.Owners.starFleet.getTotal(); // 1
}());
</code></pre>
<p>Now you can use <code>NS.Owers.starFleet</code> to add ships to Star Fleet.</p>
<h3>Organizing Files</h3>
<p>Architectural patterns are very helpful for creating maintainable web applications. One further problem exists though in large scale applications, and that's file organization.</p>
<p>In the early days, having all of your code in a single Javascript file was still not a great idea, but it could work because there wasn't that much code. Today in the 23rd century, that's just not the case. There are hundreds, if not thousands, of lines of code necessary for a web application. Having a single JavaScript file is just not feasible.</p>
<p>When you start adopting architectural patterns like constructor or module patterns, your code will have been broken down into smaller units. This is great for multiple reasons. For one, you'll now be able to move these small units in to their own files. And it makes unit testing much easier.</p>
<p>As a goal, try to keep each JavaScript file containing one logical "class" or module.</p>
<p>You may have something like this.</p>
<pre><code>/js/
/js/app.js
/js/starship.js
/js/constitutionClass.js
/js/starFleet.js
</code></pre>
<p>This is much nicer. You're able to logically divide up each piece of functionality. After a while though, you may have too many JS files in the <code>/js</code> folder and may want to consider some subfolders.</p>
<blockquote><p>There are only two hard things in Computer Science: cache invalidation and naming things.<br>
— Phil Karlton</p></blockquote>
<p>Naming things is hard, so when getting ready to divide your application up into subfolder, just pick some standards for you and your team and follow them. Consistency always wins!</p>
<pre><code>/js/
/js/app.js
/js/classes/starship.js
/js/classes/constitutionClass.js
/js/core/starFleet.js
/js/infrastructure/..js
/js/templates/..js
</code></pre>
<p>Another common organizational strategy is to break up large pieces of functionality into their own folders.</p>
<pre><code>/js/
/js/app.js
/js/ships/starship.js
/js/ships/constitutionClass.js
/js/core/starFleet.js
/js/captainsLog/..js
/js/weaponSystems/..js
</code></pre>
<p>No matter what you choose, the idea is to maintain consistency within your structure for your team. There's no wrong answer here, just pick something and go with it.</p>
<p>One hiccup you'll find breaking up your logic into many files though is dealing with loading them into your HTML pages.</p>
<p>With a structure like this you'll end up having to have many <code>script</code> includes that have to be in a very specific order to avoid errors.</p>
<pre><code class="language-markup">&lt;script src="https://x6ar5ez4ac-flywheel.netdna-ssl.com/js/app.js"&gt;&lt;/script&gt;
&lt;script src="https://x6ar5ez4ac-flywheel.netdna-ssl.com/js/core/starFleet.js"&gt;&lt;/script&gt;
&lt;script src="https://x6ar5ez4ac-flywheel.netdna-ssl.com/js/weaponSystems/photonTorpedos.js"&gt;&lt;/script&gt;
&lt;script src="https://x6ar5ez4ac-flywheel.netdna-ssl.com/js/starship.js"&gt;&lt;/script&gt;
&lt;script src="https://x6ar5ez4ac-flywheel.netdna-ssl.com/js/constitutionClass.js"&gt;&lt;/script&gt;
</code></pre>
<p>If any one of those files gets included in the wrong order, you'll run into problems. You also will have many synchronous script includes that slow your page render.</p>
<p>Enter AMD.</p>
<h3>AMD</h3>
<p>Asynchronous Module Definition is a specification created by the CommonJS group to handle these types of issues. It defines a specification for creating and requiring modules into an application.</p>
<p>One of the best implementations of AMD is <a href="http://requirejs.org">require.js</a>.</p>
<p>With require.js, you create many modules just like we have been working with so far, but there's a wrapper for each module. This wrapper not only hides globals from the window, but also helps define a dependency chain which allows you to have a single <code>script</code> tag on your page. There is also a great build tool called <code>r.js</code> that can compile all your modules to a single minified file.</p>
<p>To start, download require.js and include it in your page.</p>
<pre><code class="language-markup">&lt;script src="https://x6ar5ez4ac-flywheel.netdna-ssl.com/vendor/require.js" data-main="/js/main"&gt;&lt;/script&gt;
</code></pre>
<p>The <code>data-main</code> here points to a <code>main.js</code> file in our <code>/js</code> directory. This <code>main</code> file is responsible for some initial setup that tells <code>require</code> a bit about our application and kicks off the process of loading in files.</p>
<pre><code class="language-javascript">require.config({
  paths: {
    'foo': '/vendor/foo'
  }
});

require(['app'], function(app) {
  app.init();
});
</code></pre>
<p>Here is a very simple <code>main</code> file. The <code>require.config</code> can set up some aliases if you need them. Then you use the <code>require</code> method by passing in an array of module names. The module names correspond directly to their file names minus the <code>.js</code><br>
extension. Here we kick off the application by loading <code>/js/app.js</code>.</p>
<p><code>app.js</code> would look something like…</p>
<pre><code class="language-javascript">define(function(require) {
  var ConstitutionClass = require('ships/constitutionClass');
  starFleet = require('core/starFleet'),
  captainsLog = require('captainsLog/log');

  return {
    init: function() {
      var enterprise = new ConstitutionClass('Kirk', 'Spock', 5);

      starFleet.addShip(enterprise);
      captainsLog.record('Stardate 43125.8. Commence 5 year mission into deep space');
    }
  };
});
</code></pre>
<p>This module is defined with the commonjs syntax. There are 2 ways you can export an API with requre.js's commonjs syntax as well. Either via the return statement as above, or via the actual <code>commonjs</code> way of using <code>module.exports</code>.</p>
<pre><code class="language-javascript">module.exports = {
  init: function() {
    var enterprise = new ConstitutionClass('Kirk', 'Spock', 5);

    starFleet.addShip(enterprise);
    captainsLog.record('Stardate 43125.8. Commence 5 year mission into deep space');
  }
};
</code></pre>
<p>Another quick note about require.js. All the examples below are going to use the commonjs syntax for creating modules, however you can either use the commonjs syntax or use a syntax like this…</p>
<pre><code class="language-javascript">define([
  'ships/constitutionClass',
  'core/starFleet',
  'captainsLog/log'
], function(ConstitutionClass, starFleet, captainsLog) {

  return {
    init: function() {
      var enterprise = new ConstitutionClass('Kirk', 'Spock', 5);

      starFleet.addShip(enterprise);
      captainsLog.record('Stardate 43125.8. Commence 5 year mission into deep space');
    }
  }
});
</code></pre>
<p>Rather than a function that asks for the require function <code>function(require)</code>, you can pass in an array of dependencies. The modules are loaded in and are passed in as the arguments to the function. <code>function(ConstitutionClass, starFleet, captainsLog) {</code>. This is important to know because what require.js actually does is convert the commonjs syntax into this syntax for you.</p>
<p>Either syntax is perfectly valid, so choose which you prefer. The commonjs syntax is nice though because in theory you could share your modules with node, and/or browserify which we'll talk about later.</p>
<p>Then the <code>ships/constitutionClass.js</code> would look like…</p>
<pre><code class="language-javascript">define(function(require) {
  var Starship = require('ships/starship');

  function ConstitutionClass() { /* ... */}

  return ConstitutionClass;
});
</code></pre>
<p>This module returns a constructor function just like we created above, except now there's no need for any namespacing because you're working with a module that keeps everything private except what you return from the module.</p>
<p>You can also see how the dependency chain is beginning to form. <code>app.js</code> requires <code>ships/constitutionClass.js</code> which then requires <code>ships/starship.js</code>. This will continue on and on down the chain of dependencies.</p>
<p>A module like <code>core/starFleet.js</code> might look like this…</p>
<pre><code class="language-javascript">define(function() {
  var ships = [];

  var addShip = function(ship) {
    ships.push(ship);
  };

    var removeShip = function(ship) {
    var index = ships.indexOf(ship);

    if (index &gt; -1) {
      ships.splice(index, 1);
    }
  };

  var getTotal = function() {
    return ships.length;
  };

  return {
    addShip: addShip,
    removeShip: removeShip,
    totalShipsInFleet: getTotal
  };
});
</code></pre>
<p>Effectively the same thing as the revealing module pattern gave us. Simply return an object literal with a public API.</p>
<h3>Browserify</h3>
<p>Browserify is another method of creating JavaScript modules. With browserify, you basically write commonjs modules and run <code>browserify</code> with the global node.js module and it will bundle up your code for use in the browser.</p>
<p>The syntax of creating modules with require and browserify is very close if you choose to use the commonjs syntax and the <code>module.exports</code> when working with require.</p>
<p>The <code>app.js</code> above written as an actual commonjs module looks like…</p>
<pre><code class="language-javascript">var ConstitutionClass = require('ships/constitutionClass');
starFleet = require('core/starFleet'),
captainsLog = require('captainsLog/log');

module.exports = {
  init: function() {
    var enterprise = new ConstitutionClass('Kirk', 'Spock', 5);

    starFleet.addShip(enterprise);
    captainsLog.record('Stardate 43125.8. Commence 5 year mission into deep space');
  }
};
</code></pre>
<p>The only difference is that you use <code>module.exports</code> to export your public API rather than a return statement.</p>
<p>To use browserify, install it with npm…</p>
<pre><code>npm install -g browserifylanguage-shell
</code></pre>
<p>Then you run it…</p>
<pre><code class="language-shell">browserify main.js &gt; bundle.js
</code></pre>
<p>This will output a single <code>bundle.js</code> file for use in the browser. There are a lot of advantages to both browserify and require.js. Module loading helps break up your application and no matter which you choose, it will help you create a more maintainable application.</p>
<h3>ES6</h3>
<p>One of the many awesome features coming in ES6 or ES.next is built-in classes with native JavaScript. ECMAScript is currently working on the spec for classes. You can view the <a href="http://people.mozilla.org/~jorendorff/es6-draft.html">unofficial draft</a> of the spec.</p>
<p>The new spec for JavaScript defines a new way of creating classes in JavaScript. If we take our previous examples and write them using ES6, the <code>Starship</code> class would look like…</p>
<pre><code class="language-javascript">class Starship {
  constructor(owner, operator, type, weapons) {
    this.owner = owner;
    this.operator = operator;
    this.type = type;
    this.weapons = weapons;
  }

  fire(weapon) {
    this.weapons[weapon].launch();
  }
}
</code></pre>
<p>You can see immediate differences here. First is the <code>class</code> identifier. Then you can see how you define a constructor with <code>constructor</code> and methods by simply a <code>methodname(a, b, c)</code> signature. No need to use <code>function</code> anywhere here.</p>
<p>Inheritance is also much easier. The <code>ConstitutionClass</code> can easily inherit from the <code>Starship</code> using <code>extends</code>…</p>
<pre><code class="language-javascript">class ConstitutionClass extends Starship {
  constructor(captain, firstOfficer, missionDuration) {
    this.captain = captain;
    this.firstOfficer = firstOfficer;
    this.missionDuration = missionDuration;

    super('Federation', 'Star Fleet', 'Class 1 Heavy Cruiser', {
      torpedos: new PhotonTorpedoSystem()
    });
  }

  warp(speed) {
    console.log('warping at: ' + speed);
  }
}
</code></pre>
<p>You'll also notice <code>super</code> here which is how you call the parent method and takes the place of <code>Starship.apply(this, [/* ... */])</code>.</p>
<p>This new <code>class</code> syntax is incredibly exciting for the future of JavaScript. Having built in classes is something JavaScript has needed for a while, and this new syntax is looking great.</p>
<h3>Traceur</h3>
<p>There is no telling when this <code>class</code> syntax will make it into browsers, but fortunately there's a tool called <a href="https://github.com/google/traceur-compiler">Traceur</a> that allows us to work with new features of JavaScript before they release.</p>
<p>You can install traceur with npm…</p>
<pre><code class="language-shell">npm install -g traceur
</code></pre>
<p>And you can compile ES6 file down to ES5 for use today.</p>
<pre><code class="language-shell">traceur --out build.js --script starship.js
</code></pre>
<p>Just note that if you plan on using it in the browser you must also include the runtime file above your includes…</p>
<pre><code class="language-markup">&lt;script src="bin/traceur-runtime.js"&gt;&lt;/script&gt;
</code></pre>
<p>Hopefully ES6 classes is the future of how we'll be writing maintainable JavaScript in the future.</p>
<h2>Conclusion</h2>
<p>JavaScript is an ever-changing language. As it grows there will be more and more ways to use it, and architect it. The architectural patterns above are a great way you can create JavaScript applications today, while the <code>class</code> syntax will be the way of things in the 24th century. Keep JavaScripting, and live long and prosper.</p>
					</div>
				</article>
				<!--================= END :: Tutorial =================-->
				
				<!--================= START :: Tutorial =================-->
				<article>
					<a id="t-13" name="t-13"></a><h1>13 : 9 New Array Functions in ES6</h1>
					<span>http://vegibit.com/new-array-functions-in-es6/</span>
					<div class="tutorial__content">


<div class="entry-content">
            <p><a href="http://vegibit.com/new-array-functions-in-es6/"><img src="http://vegibit.com/wp-content/uploads/2017/03/new-array-functions-in-es6.png" alt="new array functions in es6" width="400" height="300" class="alignleft size-full wp-image-22991" srcset="http://vegibit.com/wp-content/uploads/2017/03/new-array-functions-in-es6.png 400w, http://vegibit.com/wp-content/uploads/2017/03/new-array-functions-in-es6-300x225.png 300w" sizes="(max-width: 400px) 100vw, 400px" draggable="true" data-bukket-ext-bukket-draggable="true"></a></p>
<p class="lead">There are many new extensions to the array object in ES6.  In this journey of learning the foo of ES6, we will set our targets on mastering the ways of new functions like Array.of(), Array.from(), Array.fill(), Array.find(), Array.findIndex(), Array.copyWithin(), Array.entries(), Array.keys(), and Array.values().  These new functions make it easier to fill up arrays, or find data within them.  In addition to that it is now easier to work with specific keys and values in the array itself.  These newer functions are lessening the need for utility libraries so they are definitely welcome.  Let's put the rubber to the road with all of the new array extensions in ES6 right now.</p>
<hr>
<h2>1. Array.of()</h2>
<p>To learn about the new <strong>Array.of()</strong> function, let us first take a look at a strange little quirk in ES5 concerning using the Array constructor.  We'll set up an array of <code>prices</code>, then take a look at the length of the array.</p>


		<pre>let prices = Array(5000);
console.log(prices.length);
&nbsp;
// 5000
</pre>
<!-- [Format Time: 0.0004 seconds] -->
<p>When the code runs, it tells us that we have an array with a length of 5000.  What?!  We only passed one value, <code>5000</code>, into the array.  Well in ES5, if you pass just one value to the array constructor which is numeric, an array of that size will be created.  That is kind of strange, don't you think?  This is the purpose of <strong>Array.of()</strong>.  Let have a redo with our new function.</p>


		<pre>let prices = Array.of(5000);
console.log(prices.length);
&nbsp;
// 1
</pre>
<!-- [Format Time: 0.0003 seconds] -->
<p><span class="label label-success"><strong>Nice!</strong></span>  In this go round, we find the length of <code>prices</code> to be <code>1</code>.  That seems to make much more sense.  Array.of() is a new way of creating an array which fixes this odd behavior in ES5.  If you create an array with just one numeric value, the array is created with just that value and not the amount of that value.</p>
<hr>
<h2>2. Array.from()</h2>
<p>Let's see how the new <strong>Array.from()</strong> function works.  Below we have set up an array with three values of 500, 700, and 1000.  On the second line, we make a call to Array.from() and pass in <code>prices</code> as the <em>first</em> argument, and an <strong><a href="http://vegibit.com/es6-arrow-function-tutorial/">arrow function</a></strong> as the <em>second</em> argument.  By running the code, we see that the prices are now taxed at 5 percent.  Array.from() creates a brand new array based on <code>prices</code>, and for each element in that array the arrow function is called.  So basically we take each price and multiply it by 1.05 denoting a tax rate of 5 percent.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<pre>let prices = [500, 700, 1000];
let taxed = Array.from(prices, price =&gt; price * 1.05);
console.log(taxed);
&nbsp;
// [525, 735, 1050]
</pre>
<!-- [Format Time: 0.0008 seconds] -->

<hr>
<h4>Using Array.from() with three arguments</h4>
<p>In the prior example, we passed two arguments to the Array.from() function.  The first was the array we were working with, and the second was a function.  In this example we will pass an array, a function, <em>and also an object</em>.  Say you had a site that listed items for sale, but for each item sold you had to pay a listing fee of 5 dollars.  Let's see how to calculate this.</p>


		<pre>let prices = [500, 700, 1000];
let totalprice = Array.from(prices, function (price) {
&nbsp;&nbsp;&nbsp;&nbsp;return price + this.listingfee;
}, {listingfee: 5});
&nbsp;
console.log(totalprice);
&nbsp;
// [505, 705, 1005]
</pre>
<!-- [Format Time: 0.0010 seconds] -->

<p>What is happening here is that the third argument to Array.from() is an object which becomes <code>this</code> in the function.  That is why we are able to take the <code>price</code> and add <code>this.listingfee</code> to give us the total price.  Note that when using this technique, we need to use a standard function as opposed to an arrow function for the second argument to Array.from().  This is because arrow functions do not allow meddling with the <code>this</code> value.</p>
<hr>
<h2>3. Array.fill()</h2>
<p>ES6 now gives you an easy way to fill up an array using <strong>Array.fill()</strong>.  Let's see a quick example.</p>


		<pre>let prices = [500, 700, 1000];
prices.fill(2000);
console.log(prices);
&nbsp;
// Array [ 2000, 2000, 2000 ]
</pre>
<!-- [Format Time: 0.0005 seconds] -->

<p>So it looks like this function will overwrite any existing values in all keys of the array with the provided value.  Since we call <code>.fill()</code> on the <code>prices</code> array which has 3 elements in it, all elements in the array are now <code>9000</code>.  There is also an option to pass a second argument to Array.fill() in order to start at a specific index.  Let's see how to do that.</p>


		<pre>let prices = [500, 700, 1000];
prices.fill(2000, 2);
console.log(prices);
&nbsp;
// Array [ 500, 700, 2000 ]
</pre>
<!-- [Format Time: 0.0005 seconds] -->

<p>By passing the value of <code>2</code> as the second argument, we are telling the fill function to start filling the array at the 2nd index.  Since arrays are 0 based as we know, it is the third value in our array that gets overwritten with the value of <code>2000</code>.</p>
<p>Now, why only pass two arguments when you can pass three?!  Here we will pass another argument to Array.fill().  This will demonstrate that the second argument specifies what index to start at while the third argument specifies <em>where to stop</em>.  Check it out now.</p>


		<pre>let prices = [500, 600, 700, 800, 900, 1000, 1500];
prices.fill(2000, 2, 4);
console.log(prices);
&nbsp;
// Array [ 500, 600, 2000, 2000, 900, 1000, 1500 ]
</pre>
<!-- [Format Time: 0.0007 seconds] -->

<p>We added a few more values to our original array so that it is a bit easier to see how this works.  Notice that we begin filling with the value of <code>2000</code> at <em>index 2</em> and stop at <em>index 4</em>.  Note that the filling stops before actually placing a value in the index.  This is why you see only index 2 and 3 with the value of 2000.</p>
<hr>
<h2>4. Array.find()</h2>
<p><strong>Array.find()</strong> is another new function added to arrays in ES6.  You can use it to easily find a value in an array that meets a given criteria.  Let's see how it works.</p>


		<pre>let prices = [500, 600, 700, 800, 900, 1000, 1500];
let result = prices.find(price =&gt; price &gt; 777);
console.log(result);
&nbsp;
// 800
</pre>
<!-- [Format Time: 0.0008 seconds] -->

<p>Notice that we pass an arrow function to the .find() function.  That function is applied against every element in the array, and as soon as it finds a value that meets the criteria, that value is returned.  It does not continue to return all values that meet the criteria.  This is why we only get one result in this example.  Let's run through this example just one more time to see it in action.</p>


		<pre>let prices = [500, 600, 700, 800, 900, 1000, 1500];
let result = prices.find(price =&gt; price &lt; 777 &amp;&amp; price &gt; 600);
console.log(result);
&nbsp;
// 700
</pre>
<!-- [Format Time: 0.0009 seconds] -->

<p>So here, we use a compound expression in the arrow function to be more specific.  We specify that we want a value that is less than 777 but also greater than 600.  700 is the first value to meet that criteria, so we get that result back.</p>
<hr>
<h2>5. Array.findIndex()</h2>
<p>In addition to Array.find(), we now also have the <strong>Array.findIndex()</strong> function which works in a similar way but instead of returning the value, it returns the <em>index</em>.  Let's see how it works.</p>


		<pre>let prices = [500, 600, 700, 800, 900, 1000, 1500];
let result = prices.findIndex(function (price) {
&nbsp;&nbsp;&nbsp;&nbsp;return price == this;
}, 1000);
console.log(result);
&nbsp;
// 5
</pre>
<!-- [Format Time: 0.0009 seconds] -->

<p>Here we use a regular JavaScript function passed into the .findIndex() function.  We simply return the result of price being equal to <code>this</code>.  <code>this</code> is set to 1000, which is the second argument to .findIndex().  We can see that the value of 1000 lives at index 5 of the zero based array.</p>
<hr>
<h2>6. Array.copyWithin()</h2>
<p><strong>Array.copyWithin()</strong> is an interesting addition to the array function library in ES6.  With it, you can copy values inside the array just like the name implies.  It takes a value from one index, and places it in another.  Here is an example.</p>


		<pre>let prices = [500, 600, 700, 800, 900, 1000, 1500];
prices.copyWithin(3, 1);
console.log(prices);
&nbsp;
// Array [ 500, 600, 700, 600, 700, 800, 900 ]
</pre>
<!-- [Format Time: 0.0006 seconds] -->

<p>The key to understanding copyWithin() is what the arguments mean.  Argument 1 is the index which will be overwritten.  It is where data will be copied to.  The second argument is the data to copy from.  So in our example, we are saying that we are going to copy the data at index 1 (600) and paste it into index 3 (800).  After the function runs, we see that index 3 no longer holds 800, it now holds 600.  It is working as expected.  There is also the option to pass a third argument to copyWithin().  This third argument tells us how many items to copy.  Let's see how it works.</p>


		<pre>let prices = [500, 600, 700, 800, 900, 1000, 1500];
prices.copyWithin(2, 0, 3);
console.log(prices);
&nbsp;
// Array [ 500, 600, 500, 600, 700, 1000, 1500 ]
</pre>
<!-- [Format Time: 0.0007 seconds] -->

<p>The destination index is 2, or the third value in the array.  We start copying form index 0, or the first value in the array.  We are going to copy three successive values starting at index 0.  So the result correctly displays 500 in the 2nd index position, followed by two additional copied values of 600 and 700.  Index 5 and 6 are unaffected and so they contain their original values of 1000 and 1500.</p>
<hr>
<h2>7. Array.entries()</h2>
<p>The <strong>Array.entries()</strong> function is a really cool addition to the language.  It takes an array, and creates a listing so to speak of each entry.  Let's examine closely how it works.</p>


		<pre>let words = ['Lenovo', 'Tablet', 'Coffee'];
console.log(words.entries());
&nbsp;
// Array Iterator {&nbsp;&nbsp;}
</pre>
<!-- [Format Time: 0.0005 seconds] -->
<p>First up, we simply set up an array of words.  Then we log out the value of calling .entries() on that array.  Interesting!  It results in an <strong><a href="http://vegibit.com/iterators-in-es6/">array iterator</a></strong>.  Hmm, well we learned that we can call the <code>.next()</code> function on iterators, so let's try that out!</p>


		<pre>let words = ['Lenovo', 'Tablet', 'Coffee'];
console.log(words.entries().next());
&nbsp;
// Object { value: Array[2], done: false }
// The Array held in value contains 0: 0 and 1: Lenovo
</pre>
<!-- [Format Time: 0.0005 seconds] -->

<p>Awesome!  We can see that we get the first list so to speak of the array.  The iterator object is not done, so it is set to <code>false</code>.  However the <code>value</code> contains an array which holds two values.  At index 0 of that array is the index of where Lenovo lives.  That is index <code>0</code>.  At index 1 is the value itself, which is <code>Lenovo</code>.  Very neat.  Finally, since we know we can use the <strong><a href="http://vegibit.com/es6-rest-parameters-and-spread-operators/">spread operator</a></strong> on iterators, let's go ahead and do that now.</p>


		<pre>let words = ['Lenovo', 'Tablet', 'Coffee'];
console.log(...words.entries());
&nbsp;
// Array [ 0, "Lenovo" ] 
// Array [ 1, "Tablet" ] 
// Array [ 2, "Coffee" ]
</pre>
<!-- [Format Time: 0.0004 seconds] -->

<p>The .entries() function gives us the index / value pair of the array.</p>
<hr>
<h2>8. Array.keys()</h2>
<p><strong>Array.keys()</strong> works in a similar way to Array.entries() except that it only provides the keys of the array.  See it in action now.</p>


		<pre>let words = ['Lenovo', 'Tablet', 'Coffee'];
console.log(...words.keys());
&nbsp;
// 0 1 2
</pre>
<!-- [Format Time: 0.0004 seconds] -->

<hr>
<h2>9. Array.values()</h2>
<p>Finally, we have our Array.values() function which is similar to the prior two examples but provides only the values at each key.  Observe young Jedi.</p>


		<pre>let words = ['Lenovo', 'Tablet', 'Coffee'];
console.log(...words.values());
&nbsp;
// Lenovo Tablet Coffee
</pre>
<!-- [Format Time: 0.0005 seconds] -->

<hr>
<h3>9 New Array Functions in ES6 Summary</h3>
<p>You are now wielding special kung foo powers in your handling of arrays in ES6.  No longer are you confined by the burdens of working with arrays such as was done in ES5.  On your path to enlightenment you have found new and easier ways to get your work done, and as such, we hope you have found this journey exciting.</p>

            
                    </div>
					</div>
				</article>
				<!--================= END :: Tutorial =================-->
				
				<!--================= START :: Tutorial =================-->
				<article>
					<a id="t-14" name="t-14"></a><h1>14 : Implementing EventEmitter in ES6</h1>
					<span>http://www.datchley.name/es6-eventemitter/</span>
					<div class="tutorial__content">

 <p>So, since I've been swamped with work recently and haven't posted much, I'd like to get back into the swing of things and throw up a simple EventEmitter implementation I put together for my current <a href="https://github.com/datchley/ng-reflux">ngReflux</a> project I'm working on.  </p>

<p>ngReflux is a Flux implementation for use with AngularJS applications and based on Mikael Brassman's <a href="https://gist.github.com/spoike/ba561727a3f133b942dc">original gist</a> idea for RefluxJS.  You can read more about the Flux architecture <a href="https://facebook.github.io/flux/docs/overview.html">elsewhere</a>.</p>

<p>Since Reflux removes the Dispatcher from the Flux flow altogether, it makes both Actions and Stores observables by having them prototypically inherit from an EventEmitter. Reflux uses <a href="https://github.com/primus/eventemitter3">EventEmitter3</a>, which is a full implementation for Node and the browser; but I wanted to keep this small and simple, with few outside dependencies, so I rolled my own.</p>

<h3 id="theobserverpattern">The Observer Pattern</h3>

<p>Before we look at the code, let's quickly review the <a href="https://en.wikipedia.org/wiki/Observer_pattern">Observer Pattern</a>, which is what EventEmitter is based on.</p>

<p>The Observer Pattern is fairly simple.  An object (<em>typically called a "subject"</em>) allows other Objects called Observers to be notified when some state in the Observable changes.  This is essentially the pub/sub architecture.</p>

<p><img src="http://www.datchley.name/content/images/2015/10/Observer-Pattern.png" alt=""></p>

<p>Making an object "observable" focuses primarily on providing at least three different behaviors:</p>

<ol>
<li><code>addListener(label,callback)</code> - Allow others to "listen" to the observer, providing it a callback to invoke when the observable's state changes.  </li>
<li><code>removeListener(label, callback)</code> - Allow those listening to remove themselves as listeners so they can stop receiving notifications of state changes.  </li>
<li><code>emit(label,...)</code> - Allow the observable to notify all observers of a state change by invoking each observer's callback with any changed state.</li>
</ol>

<p>In our <code>EventEmitter</code> implementation we also have labels, which allows an object acting as an observable to allow others to listen for changes on a specific "channel", which is just a string identifying the type or category of changes the observer wants to be notified about.  Observables can have one or more channels depending on their needs.</p>

<h3 id="implementingeventemitter">Implementing EventEmitter</h3>

<p>Let's use some of the latest Javascript ES2015/ECMA Script 6 features and get this thing rolling. </p>

<p>First, we'll setup our EventEmitter as a <code>class</code>, which is really just syntactic sugar for creating a function that is intended to be invoked with <code>new</code>, combined with adding methods on its prototype property.</p>

<pre><code class="language-javascript">class EventEmitter {  
  constructor() {
    this.listeners = new Map();
  }
  addListener(label, callback) { }
  removeListener(label, callback) { }
  emit(label, ...args) {  }
}
</code></pre>

<p>Our class has a constructor which sets up an initially empty map for keeping track of our listeners.  Note, too, the shorter syntax of declaring prototype methods on the class.  We've stubbed them out above and will show the implementation below.</p>

<h4 id="addlistenerlabelcallback">addListener(label, callback)</h4>

<p>Adding a listener takes two parameters. We'll need the label that identifies the type of notifications the listener wants to receive; and the callback function we should invoke for the listener when we emit that event.</p>

<pre><code class="language-javascript">  addListener(label, callback) {
    this.listeners.has(label) || this.listeners.set(label, []);
    this.listeners.get(label).push(callback);
  }
</code></pre>

<p>We just ensure we have a queue (<em>array of</em>) of listeners for the given label, creating it if it isn't there; and then push the callback function into that queue.</p>

<h4 id="removelistenerlabelcallback">removeListener(label, callback)</h4>

<p>Removing a listener takes the same parameters as <code>addListener</code>; but we need to be able to find that callback in the appropriate list in order to remove it.  </p>

<pre><code class="language-javascript">let isFunction = function(obj) {  
    return typeof obj == 'function' || false;
};

removeListener(label, callback) {  
    let listeners = this.listeners.get(label),
        index;

    if (listeners &amp;&amp; listeners.length) {
        index = listeners.reduce((i, listener, index) =&gt; {
            return (isFunction(listener) &amp;&amp; listener === callback) ?
                i = index :
                i;
        }, -1);

        if (index &gt; -1) {
            listeners.splice(index, 1);
            this.listeners.set(label, listeners);
            return true;
        }
    }
    return false;
}
</code></pre>

<p>Outside of our helper function to determine if an object is a <code>function</code>, the implementation is straight forward. Loop through the listeners for that label, if there are any, and retain the index of the callback that matches the one passed in, using that to remove that item from the list.</p>

<p>If you aren't familiar with using Array functions like <code>reduce</code> and <code>map</code>, take a look at my <a href="http://www.datchley.name/working-with-collections/">previous post</a> on the subject.</p>

<h4 id="emitlabelargs">emit(label, ...args)</h4>

<p>Here's where we emit events to all our listeners passing on some data that we think might interest them.  We just need the label to emit the event on, which tells us which set of listeners to notify; and the remaining arguments are passed to each listener callback directly.</p>

<pre><code class="language-javascript">emit(label, ...args) {  
    let listeners = this.listeners.get(label);

    if (listeners &amp;&amp; listeners.length) {
        listeners.forEach((listener) =&gt; {
            listener(...args); 
        });
        return true;
    }
    return false;
}
</code></pre>

<p>We use ES6's spread/rest operator here to collect all our arguments for emit into the single variable <code>args</code>; as well as to pass them as individual arguments to each listener callback invocation. Every time we emit on a label, all the other data we pass in gets passed to <em>all</em> our listeners callbacks.</p>

<p>Handling the arguments for each of those actions above in ES5 would be analogous to the following:</p>

<pre><code>function emit(label) {  
  var args = [].slice.call(arguments, 1);
  // ...
          listeners.apply(null, args);
}
</code></pre>

<p>The spread/rest operator helps make for cleaner and clearer code in this case.</p>

<h3 id="puttingitalltogether">Putting it all together</h3>

<p>Now that we have our EventEmitter class let's create an an observer and see how it works.  Our simple <code>Observer</code> constructor takes a single argument of the specific Observable that we want to listen on. We then listen for <code>"change"</code> events and output any data received to the console.</p>

<pre><code class="language-javascript">class Observer {  
  constructor(id, subject) {
    this.id = id;
    this.subject = subject;
    this.subject.addListener("change", (data) =&gt; this.onChange(data));
  }
  onChange(data) {
    console.log(`${this.id} notified of change:`, data);
  }
}
</code></pre>

<p>We use ES6's new string templating interpolation to format our console output as well, which is pretty nice.</p>

<p>Now we can create an Observable using our EventEmitter and a couple of Observers and fire off some events and see it all work.</p>

<pre><code>let observable = new EventEmitter();  
let [observer1, observer2] = [  
  new Observer(1, observable),
  new Observer(2, observable)
];

observable.emit("change", { a: 1 });  
// =&gt; (1) notified of change: { a: 1 }
// =&gt; (2) notified of change: { a: 1 }
</code></pre>

<p>We also used ES6's destructuring for the assignment on our observers, too.</p>

<p>Hopefully this has helped give you some insight into both the Observer Pattern and how EventEmitters are implemented.  You can find out more about ES2015 and ES6 through Babel's <a href="https://babeljs.io/docs/learn-es2015/">learning resource</a>. You can view the full code in <a href="https://gist.github.com/datchley/37353d6a2cb629687eb9">a gist</a>; and feel free to ask questions and leave comments!</p>

<p><em>Updated</em> As commenters Greg and Christian pointed out, the better way to compare functions in the <code>removeListener()</code> method is to use straight <code>===</code> comparison rather than relying on <code>.toString()</code> to compare a decompiled version of the function. Using <code>toString()</code>'s results is inconsitent across various browsers/devices, and will not work for bound functions, using <code>.bind()</code>. </p>
					</div>
				</article>
				<!--================= END :: Tutorial =================-->
				
				<!--================= START :: Tutorial =================-->
				<article>
					<a id="t-15" name="t-15"></a><h1>15 : Getting Functional with Javascript (Part 1)</h1>
					<span>http://www.datchley.name/getting-functional-with-javascript-part-1/</span>
					<div class="tutorial__content">


<section class="post-content">
    <p>After reading about <em>currying</em>, <em>partial application</em> and other functional programming techniques, some developers are left wondering when, exactly, they would ever use those methods; and why would they want to?</p>

<p>With this three part blog post series we'll try to tackle that issue and show how you could approach solving a problem in a functional fashion in the context of a small, realistic example.</p>

<h2 id="whatisfunctionalprogramming">What is Functional Programming</h2>

<p>Before we dive right in, let's take a brief moment to review some practical functional programming concepts.  </p>

<p>Functional programming focuses on the <em>"function"</em> as the primary expression of reuse. By building small functions that focus on very specific tasks, functional programming uses composition to build up more complex functions - this is where techniques like <em>currying</em> and <em>partial application</em> come into play.</p>

<blockquote>
  <p>Functional Programming uses functions as the declarative expression of reuse, avoiding mutating state, eliminating side effects &amp; using composition to build functionality</p>
</blockquote>

<p>Functional programming is essentially programming with functions! The additional considerations like avoiding mutating state, pure functions with no side effects and elimination of loops in favor of recursion are part of a Pure Functional Programming approach, which is built in in languages like Haskell.  </p>

<p>We'll focus on the practical parts of functional programming that we can immediately make use of in Javascript in this blog series.</p>

<p><strong>Higher Order Functions</strong> - Javascript has <em>first-class functions</em>, which means we can pass functions as arguments to other functions; and return functions as values from functions. </p>

<p><strong>Decorators</strong> - Because we can make higher order functions, we can create functions that augment other functions' behavior and/or arguments</p>

<p><strong>Composition</strong> - we can also create functions that are composed of multiple functions, created chained processing of inputs.</p>

<p>We'll introduce the techniques we'll use to take advantage of these features as they are needed.  This lets us introduce them in context and keep the concepts digestible and easy to understand.</p>

<h2 id="letsbuildsomethingalready">Let's Build Something, Already!</h2>

<p>Ok, so what is it we are going to build?  </p>

<p>Let's take the typical example of needing to process some data coming back from an asynchronous request.  In this case, the response is in JSON format and contains a list of blog post summaries. </p>

<p>Here's our response data we'll be working with: <a href="https://gist.github.com/datchley/26bce4a05fde0226b405#file-json-data-js">View full data in Gist</a> and an example record.</p>

<pre><code>// An example record from our JSON response data
var records = [  
  {
    "id": 1,
    "title": "Currying Things",
    "author": "Dave",
    "selfurl": "/posts/1",
    "published": 1437847125528,
    "tags": [
      "functional programming"
    ],
    "displayDate": "2015-07-25"
  },
  // ...
];
</code></pre>

<p><strong>Our Requirements</strong>: Now, suppose that we want to build a display of recent posts (<em>no older than a month</em>), organized in groups by tags and sorted by publish date. Let's think for a moment about what we need to do:</p>

<ul>
<li>filter out posts older than a month (<em>say, 30 days</em>).</li>
<li>group the posts by their tags (<em>this might mean posts show up in two groups if they have more than one tag.</em>)</li>
<li>sort each tag listing by published date, descending.</li>
</ul>

<p>We'll cover each requirement above in a single post in this series, starting with filtering in this post.</p>

<h3 id="filteringtherecords">Filtering the Records</h3>

<p>Our first step is to filter out the records where the published date is older than the last 30 days.  Since functional programming is all about <em>functions</em> as the primary expression for reuse, let's build a function to encapsulate the act of filtering a list.</p>

<pre><code>function filter(list, fn) {  
  return list.filter(fn);
}
</code></pre>

<p>I can hear you asking now..., <em>"Really? That's all!?"</em>  </p>

<p>Well, yes, and no.  </p>

<p>While this function encapsulates the concept of filtering an array (<code>list</code>) using a predicate function (<code>fn</code>), which could have easily been done by just calling <code>list.filter(fn)</code> directly.  So, why not do it that way?</p>

<p>Because when we abstract the operation into a function, we can then use <em>currying</em> to build a more useful function.</p>

<blockquote>
  <p><strong>Currying</strong> is the act of taking a function with <em>N</em> arguments and returning a nested series of <em>N</em> functions that each take 1 argument.</p>
</blockquote>

<p>For more information and to brush up on this concept, read my <a href="http://www.datchley.name/currying-vs-partial-application/">previous post</a> about currying and an implementation of <em>left-&gt;right</em> currying.</p>

<p><a href="/content/images/2015/08/curry-argument-diagram-1.png" class="lightbox" data-featherlight="image"><img src="http://www.datchley.name/content/images/2015/08/curry-argument-diagram-1.png" alt="" draggable="true" data-bukket-ext-bukket-draggable="true"></a></p>

<p>In this case we'll use a function called <code>rightCurry()</code>, which curries a function's arguments from right to left.  Typically, a plain <code>curry()</code> function would curry arguments left to right.  </p>

<p>Here's our implementation, along with another utility function <code>flip()</code>, which it uses internally.</p>

<pre><code>// Returns a function which reverses the order of the 
// arguments to the passed in function when invoked.
function flip(fn) {  
    return function() {
        var args = [].slice.call(arguments);
        return fn.apply(this, args.reverse());
    };
}

// Returns a new function that curries the original 
// function's arguments from right to left.
function rightCurry(fn, n) {  
  var arity = n || fn.length,
      fn = flip(fn);
  return function curried() {
      var args = [].slice.call(arguments), 
          context = this;

      return args.length &gt;= arity ?
          fn.apply(context, args.slice(0, arity)) : 
          function () {
              var rest = [].slice.call(arguments);
              return curried.apply(context, args.concat(rest));
          };
  };
}
</code></pre>

<p>With currying we can create functions that allow us to create new, partially applied functions we can reuse. In our case, we'll use it to create a function which partially applies a predicate to the operation of filtering a list.</p>

<p><a href="/content/images/2015/08/filterWith-diagram.png" class="lightbox" data-featherlight="image"><img src="http://www.datchley.name/content/images/2015/08/filterWith-diagram.png" alt="" draggable="true" data-bukket-ext-bukket-draggable="true"></a></p>

<pre><code>// A function to filter a list with a given predicate
var filterWith = rightCurry(filter);  
</code></pre>

<p>This is basically the same as manually currying our binary <code>filter(list, fn)</code> function like this.</p>

<pre><code>function filterWith(fn) {  
  return function(list) {
    return filter(list, fn);
  }
}
</code></pre>

<p>And we can use it as follows?  </p>

<pre><code>var list = [1,2,3,4,5,6,7,8,9,10];

// Create a partially applied filter to get even numbers from a list
var justEvens = filterWith(function(n) { return n%2 == 0; });

justEvens(list);  
// [2,4,6,8,10]
</code></pre>

<p>Wow, seems like a lot of work initially; but what we got out of this approach is </p>

<ul>
<li>using <em>currying</em> to create a general, reusable function, <code>filterWith()</code>, which can be used in a number of situations to create more specific list filters</li>
<li>the ability to execute this new filter lazily whenever we get some data. <em>We can't call <code>Array.prototype.filter</code> without having it act on a list of data immediately</em></li>
<li>a more declarative API that aids in readability and understanding </li>
</ul>

<h3 id="aboutthatpredicatefunction">About that Predicate Function</h3>

<p>Our <code>filterWith()</code> function needs a predicate function, which returns <em>true</em> or <em>false</em> when given an item in the list, to determine if that item should be returned in the newly filtered list. </p>

<p>Let's start off by making a more generic comparison function that can tell us if a given number is greater than or equal to another number.</p>

<pre><code>// Simple comparison for '&gt;='
function greaterThanOrEqual(a, b) {  
  return a &gt;= b;
}
</code></pre>

<p>Given that our published dates are in numeric, timestamp format (<em>milliseconds since the Epoch</em>) this should work fine.  But, the predicate function for filtering Arrays is only passed a single argument to check, not two. </p>

<p>So, how do we make our binary comparison function work in a situation that needs a unary function?</p>

<p>Currying to the rescue again! We'll use it to make a function that can create unary comparison functions.</p>

<pre><code>var greaterThanOrEqualTo = rightCurry(greaterThanOrEqual);  
</code></pre>

<p>We can now use this curried version to create a unary predicate function that will work with list filtering, such as:</p>

<pre><code>var list = [5,3,6,2,8,1,9,4,7],  
    // a unary comparison function to see if a value is &gt;= 5
    fiveOrMore = greaterThanOrEqualTo(5);

filterWith(fiveOrMore)(list);  
// [5,6,8,9,7]
</code></pre>

<p>Awesome!  Now we can be more specific and create a predicate that solves our original problem of filtering dates greater than or equal to 30 days ago:</p>

<pre><code>var thirtyDaysAgo = (new Date()).getTime() - (86400000 * 30),  
    within30Days = greaterThanOrEqualTo(thirtyDaysAgo);

var dates = [  
  (new Date('2015-07-29')).getTime(), 
  (new Date('2015-05-01')).getTime() 
];

filterWith(within30Days)(dates);  
// [1438128000000]  - July 29th, 2015
</code></pre>

<p>So far, so good!  </p>

<p>We've created a predicate for filtering that can be easily reused. Also, because we're using a functional approach, our code is much more declarative and easy to follow - it sort of reads exactly as it works.  Readability and maintenance are important things to consider when writing any code!</p>

<h3 id="typeproblems">Type Problems...</h3>

<p><em>Uh-oh, we have another issue</em>! Our program needs to filter a list of objects, so our predicate function is going to need to access the <code>published</code> property on each item passed in.  </p>

<p>Our current predicate, <code>within30Days()</code>, doesn't handle object argument types, only scalar values! Let's solve that with another function! (<em>are you seeing a pattern here?</em>)</p>

<p>We'd like to reuse our existing predicate function; but modify its arguments so that it can work with our specific object types.  Here's a new utility function that let's us augment an existing function by modifying its arguments.</p>

<pre><code>function useWith(fn /*, txfn, ... */) {  
  var transforms = [].slice.call(arguments, 1),
      _transform = function(args) {
        return args.map(function(arg, i) {
          return transforms[i](arg);
        });
      };
  return function() {
    var args = [].slice.call(arguments),
        targs = args.slice(0, transforms.length),
        remaining = args.slice(transforms.length);

    return fn.apply(this, _transform(targs).concat(remaining));
  }
}
</code></pre>

<p>This is our most interesting functional utility so far, and nearly identical to the function of the same name in the <a href="http://ramdajs.com/docs/#useWith">Ramda.js library</a>.  </p>

<p><code>useWith()</code> returns a function which modifies the original function, <code>fn</code>, so that when it is invoked, it will pass each argument through a corresponding transform (<code>txnfn</code>) function.  If there are more arguments when invoked than transform functions, the remaining arguments will be passed in <em>"as is."</em></p>

<p>Let's help that definition out with a small example. Simply, <code>useWith()</code> lets us do the following:  </p>

<pre><code>function sum(a,b) { return a + b; }  
function add1(v) { return v+1; }  
var additiveSum = useWith(sum, add1, add1);

// Before sum receives 4 &amp; 5, they are each passed through
// the 'add1()' function and transformed
additiveSum(4,5);  // 11  
</code></pre>

<p>When we call <code>additiveSum(4,5)</code> we essentially get the following call stack:</p>

<ul>
<li><code>additiveSum(4,5)</code>
<ul><li><code>add1(4) =&gt; 5</code></li>
<li><code>add1(5) =&gt; 6</code></li>
<li><code>sum(5, 6) =&gt; 11</code></li></ul></li>
</ul>

<p>We can use <code>useWith()</code> to modify our existing predicate to operate on object types rather than scalar values. First, let's use <em>currying</em> again to create a function that lets us create partially applied functions that can access objects by property name.</p>

<pre><code>// function to access a property on an object
function get(obj, prop) { return obj[prop]; }  
// Curried version of `get()`
var getWith = rightCurry(get);  
</code></pre>

<p>Now we can use <code>getWith()</code> as the transform function to grab the <code>.published</code> date from each object to pass to our unary predicate function used in the filter.</p>

<pre><code>// Our modified predicate that can work on the `.published` 
// property of our record objects.
var within30Days = useWith(greaterThanOrEqualTo(thirtyDaysAgo), getWith('published'));  
</code></pre>

<p>Let's give this a try with some test data:</p>

<pre><code>// Array of sample object data
var dates = [  
      { id: 1, published: (new Date('2015-07-29')).getTime() }, 
      { id: 2, published: (new Date('2015-05-01')).getTime() }
    ],
    within30Days = useWith(greaterThanOrEqualTo(thirtyDaysAgo), getWith('published'));

// Get any object with a published date in the last 30 days
filterWith(within30Days)(dates);  
// { id: 1, published: 1438128000000 }
</code></pre>

<h3 id="readytofilter">Ready to Filter!</h3>

<p>Ok, given our first requirement to keep only post records within the last 30 days, let's give our full implementation a run with our response data.</p>

<pre><code>filterWith(within30Days)(records);  
// [
//    { id: 1, title: "Currying Things", displayDate: "2015-07-25", ... },
//    { id: 2, title: "ES6 Promises", displayDate: "2015-07-26", ... },
//    { id: 7, title: "Common Promise Idioms", displayDate: "2015-08-06", ... },
//    { id: 9, title: "Default Function Parameters in ES6", displayDate: "2015-07-06", ... },
//    { id: 10, title: "Use More Parenthesis!", displayDate: "2015-08-26", ... },
// ]
</code></pre>

<p>We now have a new list of <em>just</em> posts within the last 30 days. Looks like we've met our first requirement and are off to a good start. As we go along, we'll put our functional utilities in a library that we can reuse.  </p>

<p><strong>Get the Source</strong>: You can see the <a href="https://gist.github.com/datchley/26bce4a05fde0226b405">source code</a> for this post, which has all our functional utilities in a single <code>.js</code> file and our main application logic in its own file as well. We'll continue to add to these in each post in this series.</p>

<h2 id="summary">Summary</h2>

<p>We've discovered some key functional programming techniques like <em>currying</em> and <em>partial application</em> and the contexts in which we can use them. We also found out that focusing on building small, useful functions in conjunction with functional techniques allows us to compose higher order functions and enable better reuse.  With these basics under our belt, the next two posts will seem much less daunting.</p>

<p>In the next post in this series we'll combine what we have so far for filtering with grouping the records by <em>tag name</em>, where we'll introduce more list related functions and more flexible function composition as well.</p>
        <ul class="tags">
            <li class="tag" id="tag-id-17"><a href="/tag/currying/">currying</a></li> 
            <li class="tag" id="tag-id-19"><a href="/tag/functional-programming/">functional programming</a></li> 
        </ul>
  </section>
					</div>
				</article>
				<!--================= END :: Tutorial =================-->
				
				<!--================= START :: Tutorial =================-->
				<article>
					<a id="t-16" name="t-16"></a><h1>16 : Getting Functional with Javascript (Part 2)</h1>
					<span>http://www.datchley.name/getting-functional-with-javascript-part-2/</span>
					<div class="tutorial__content">

						
<section class="post-content">
    <p>In our <a href="http://www.datchley.name/getting-functional-with-javascript-part-1/">previous post</a> on functional programming we began introducing some functional themes by working through requirements for processing a typical <a href="https://gist.github.com/datchley/26bce4a05fde0226b405#file-json-data-js">JSON response</a>. </p>

<p>Here's a recap of our requirements:</p>

<ul>
<li><i class="fa fa-check-square-o"></i> filter out posts older than a month (say, 30 days).</li>
<li><i class="fa fa-square-o"></i> group the posts by their tags (this might mean posts show up in two groups if they have more than one tag.)</li>
<li><i class="fa fa-square-o"></i> sort each tag listing by published date, descending.</li>
</ul>

<p>That first post focused on our first requirement above - filtering out posts older than 30 days.  </p>

<p>We also started a <a href="https://gist.github.com/datchley/26bce4a05fde0226b405#file-functional-js">library</a> of useful functional utilities, which we'll continue to add to in this post. You can view <a href="https://gist.github.com/datchley/26bce4a05fde0226b405">the gist</a> to see the full source code for this series.</p>

<p>In this post, we'll cover our second requirement which is grouping our records in the newly filtered list by their <code>tags</code>.</p>

<h2 id="groupingthings">Grouping Things</h2>

<p>In Javascript, we can group items in a list using <code>Array#reduce()</code>, which we covered in a <a href="http://www.datchley.name/working-with-collections/">previous blog post</a>. Definitely take a look at that now if you aren't familiar; but the basic idea is that <code>reduce()</code> allows us to iteratively build up a new value by doing something with each item in the array. </p>

<p><a href="/content/images/2015/08/Copy-of-Untitled-drawing-1-.png" class="lightbox" data-featherlight="image"><img src="http://www.datchley.name/content/images/2015/08/Copy-of-Untitled-drawing-1-.png" alt="" draggable="true" data-bukket-ext-bukket-draggable="true"></a></p>

<p>Usually, you think of taking some list of values and using <code>reduce()</code> to produce a single, new value, like: </p>

<pre><code>[1,2,3,4].reduce(function(sum, n) { return sum += n; }, 0);  // 10
</code></pre>

<p>It's this ability to iterate over values and build up or accumulate a new value that allows us to use <code>reduce()</code> to perform grouping operations. For instance:</p>

<pre><code>var list = [  
  { name: 'Dave', age: 40 },
  { name: 'Dan', age: 35 },
  { name: 'Kurt', age: 44 },
  { name: 'Josh', age: 33 }
];

list.reduce(function(acc, item) {  
  var key = item.age &lt; 40 ? 'under40' : 'over40';
  acc[key] = acc[key] || [];
  acc[key].push(item);
  return acc;
}, {});
// {
//   'over40': [ 
//      { name: 'Dave', age: 40 }, 
//      { name: 'Kurt', age: 44 }
//   ],
//   'under40': [ 
//      { name: 'Dan', age: 35 }, 
//      { name: 'Josh', age: 33 }
//   ]
// }
</code></pre>

<p>In the above snippet, we use <code>reduce()</code> to iterate over a list of objects.  We use an empty object as the starting point and group the records based on their age.  This allows us to treat an object like a map, assigning records to groups identified by property names on the resulting object.</p>

<p>Let's use this ability via <code>reduce()</code> to create a <code>group()</code> function.</p>

<pre><code>var toString = Object.prototype.toString;  
var isFunction = function(o) { return toString.call(o) == '[object Function]'; };

function group(list, prop) {  
  return list.reduce(function(grouped, item) {
      var key = isFunction(prop) ? prop.apply(this, [item]) : item[prop];
      grouped[key] = grouped[key] || [];
      grouped[key].push(item);
      return grouped;
  }, {});
}
// our right curried version of `group()`
var groupBy = rightCurry(group);  
</code></pre>

<p><a href="/content/images/2015/08/diagram-groupby.png" class="lightbox" data-featherlight="image"><img src="http://www.datchley.name/content/images/2015/08/diagram-groupby.png" alt="" draggable="true" data-bukket-ext-bukket-draggable="true"></a></p>

<p><code>group()</code> and <code>groupBy()</code> divide a list into sets, grouped by the property named <code>prop</code> on each object in the list. If <code>prop</code> is a function it will use the result of passing each value through <code>prop</code>. This is similar to the way <code>_.groupBy()</code> works in the lodash and underscore libraries.</p>

<p>Here's our previous example, now using <code>groupBy()</code>:</p>

<pre><code>var getKey = function(item) { return item.age &lt; 40 ? 'under40' : 'over40'; };  
groupBy(getKey)(list);  
// gives us the same results as previous example
</code></pre>

<p>In this case we passed a function as the <code>prop</code> argument that returned a string for grouping.  But we can use the non-function use of <code>prop</code> for records like our JSON response, where we want to group by a given property on the record:</p>

<pre><code>var list = [  
  { value: 'A', tag: 'letter' },
  { value: 1, tag: 'number' },
  { value: 'B', tag: 'letter' },
  { value: 2, tag: 'number' },
];
groupBy('tag')(list);  
// {
//   'letter': [ 
//      { value: 'A', tag: 'letter' },
//      { value: 'B', tag: 'letter' }
//   ],
//   'number': [ 
//      { value: 1, tag: 'number' },
//      { value: 2, tag: 'number' }
//   ]
// }
</code></pre>

<p>This looks like it should work well. However, the list of objects we were grouping above could only belong to one possible group: 'letter' or 'number'. The list of objects had a <em>many-to-one</em> relationship with the grouping key.</p>

<p>In our JSON response, this isn't the case, as each post's <code>tag</code> property is an array of one or more tag names.</p>

<h2 id="groupingmanytomanyrelationships">Grouping Many-to-Many relationships?</h2>

<p>So, did we go to all that trouble building a <code>groupBy()</code> function that won't work for our requirement?  Absolutely not! This is functional programming, after all, so we'll just use that function composed with other functions to build the one we want!</p>

<p>Let's take a step back and look at our JSON response again; but in a different light, like a typical database table:</p>

<p><a href="/content/images/2015/08/json-data-table-format.png" class="lightbox" data-featherlight="image"><img src="http://www.datchley.name/content/images/2015/08/json-data-table-format.png" alt="" draggable="true" data-bukket-ext-bukket-draggable="true"></a></p>

<p>We need a way to explode our list so that we output a list with one record for each tag-post combination. That output list is very similar to a <em>linking</em> or <em>joining</em> table used in databases that have tables with a many-to-many relationship - <em>in this case tags to posts</em>. </p>

<p>Doing this will necessarily create duplicates on our output; but we need those since a post can show up in multiple groups given our requirements.  </p>

<p>Our output list would resemble the following given our table example:</p>

<p><a href="/content/images/2015/08/many-to-many-table-example.png" class="lightbox" data-featherlight="image"><img src="http://www.datchley.name/content/images/2015/08/many-to-many-table-example.png" alt="" draggable="true" data-bukket-ext-bukket-draggable="true"></a></p>

<p>Given the above diagram, it's clear that what we are doing is outputing a combination. In this case, our output is the combination of the post record with each of its possible tags.  </p>

<p>We know we'll need to map over our lists, so let's create a <code>map()</code> and <code>mapWith()</code> function we can use going forward:</p>

<p><a href="/content/images/2015/08/mapwith-diagram.png" class="lightbox" data-featherlight="image"><img src="http://www.datchley.name/content/images/2015/08/mapwith-diagram.png" alt="" draggable="true" data-bukket-ext-bukket-draggable="true"></a></p>

<pre><code>// Returns a new list by applying the function `fn` to each item
// in `list`
function map(list, fn) {  
  return list.map(fn);
}
var mapWith = rightCurry(map);  
</code></pre>

<p>Now, let's create a <code>pair()</code> function that can combine the elements from two lists.</p>

<pre><code>function isArray(o) { return toString.call(o) == '[object Array]'; }

function pair(list, listFn) {  
  isArray(list) || (list = [list]);
  (isFunction(listFn) || isArray(listFn)) || (listFn = [listFn]);
  return mapWith(function(itemLeft){
    return mapWith(function(itemRight) {
      return [itemLeft, itemRight];
    })(isFunction(listFn) ? listFn.call(this, itemLeft) : listFn);
  })(list);
}
var pairWith = rightCurry(pair);  
</code></pre>

<p>We basically take two lists, map over each item in the first list, and for each item, output the results of combining that item with each item in the second list using a nested map. We also allow a function that returns a list as the second parameter, which will be passed the item from the first list on each iteration.</p>

<p>Let's try this with our filtered records from the before. We'll use our right curried <code>getWith()</code> to pass a function as the second parameter that will return the array of tags on each post as the second set to combine against.</p>

<pre><code>pair(filtered, getWith('tags'));  
// [ 
//   [ [ { /* ... */ }, 'functional programming' ] ],
//   [ [ { /* ... */ }, 'es6' ],
//     [ { /* ... */ }, 'promises' ]
//   ],
//   /* ... */
// ]
</code></pre>

<p>Interesting..., those are the right tag-&gt;post pairs, but they're nested in arrays within the array because we have nested <code>mapWith()</code> calls, each of which return an array.  </p>

<p>We can, however, flatten that using another handy function called <code>flatten()</code>, which will flatten an array by one level, ie, transform <code>[[1,2],[3,4]]</code> into <code>[1,2,3,4]</code>.</p>

<pre><code>function flatten(list) {  
    return list.reduce(function(items, item) {
        return isArray(item) ? items.concat(item) : item;
    }, []);
}
</code></pre>

<p>We use <code>reduce()</code> here to build up the new array, concatenating any values that are arrays directly into the resulting array, removing nesting. Flattening our previous results gives us the following:</p>

<pre><code>// [ 
//   [ { /* ... */ }, 'functional programming' ],
//   [ { /* ... */ }, 'es6' ],
//   [ { /* ... */ }, 'promises' ],
//   /* ... */
// ]
</code></pre>

<p>Now we have the data structure we want to start doing our grouping! </p>

<p>But, this operation is so common -- <em>the idea of flattening nested lists as we map across them</em> -- that it's usually combined into a single function, <code>flatMap(list, fn)</code>. </p>

<p>Let's create a <code>flatMap()</code> function and its right curried friend <code>flatMapWith()</code>.</p>

<p><a href="/content/images/2015/08/flatmapwith-diagram-1-.png" class="lightbox" data-featherlight="image"><img src="http://www.datchley.name/content/images/2015/08/flatmapwith-diagram-1-.png" alt="" draggable="true" data-bukket-ext-bukket-draggable="true"></a></p>

<pre><code>function flatMap(list, fn) {  
  return flatten(map(list, fn));
}
var flatMapWith = rightCurry(flatMap);  
</code></pre>

<p>We can use that inside our <code>pair()</code> function as well to ensure the right output:</p>

<p><a href="/content/images/2015/08/diagram-pair.png" class="lightbox" data-featherlight="image"><img src="http://www.datchley.name/content/images/2015/08/diagram-pair.png" alt="" draggable="true" data-bukket-ext-bukket-draggable="true"></a></p>

<pre><code>function pair(list, listFn) {  
  isArray(list) || (list = [list]);
  (isFunction(listFn) || isArray(listFn)) || (listFn = [listFn]);
  return flatMapWith(function(itemLeft){
    return mapWith(function(itemRight) {
      return [itemLeft, itemRight];
    })(isFunction(listFn) ? listFn.call(this, itemLeft) : listFn);
  })(list);
}
</code></pre>

<p>Now we can put our entire flow together, which consists of:</p>

<ol>
<li>creating a many-to-many list of tag-&gt;post pairs using <code>pairWith()</code>  </li>
<li>using that new list as input to <code>groupBy()</code> to group each record by its given tag (<em>the second item in each pair</em>).</li>
</ol>

<pre><code>var bytags = pairWith(getWith('tags'))(records);  // #1  
var groupedtags = groupBy(getWith(1), bytags);       // #2  
// {
//    'destructuring': [
//         [ { /* ... */ }, 'destructuring' ],
//         [ { /* ... */ }, 'destructuring' ]
//    ],
//    'es6': [
//        [ { /* ... */ }, 'es6' ],
//        [ { /* ... */ }, 'es6' ]
//    ],
//    /* ... */
// }
</code></pre>

<h2 id="cleaningup">Cleaning Up</h2>

<p>So, after rebuilding the list as a many-to-many joined list and then grouping by the tags as the key, we end up with a structure that still isn't quite what we want - each post record is still nested in a list pair with its group key.</p>

<p>We need a way to map over our output object's properties and then map over each of those arrays and replace each list pair with just the post record.</p>

<p>We can map over arrays already using <code>map()</code> and its variants; but we can also do the same thing with objects if we think of the objects as a list where each item is a property and its value.</p>

<p>We'll call this <code>mapObject()</code> and it will return an object as well. </p>

<p><a href="/content/images/2015/08/mapObject-diagram.png" class="lightbox" data-featherlight="image"><img src="http://www.datchley.name/content/images/2015/08/mapObject-diagram.png" alt="" draggable="true" data-bukket-ext-bukket-draggable="true"></a></p>

<pre><code>function mapObject(obj, fn) {  
  return keys(obj).reduce(function(res, key) {
    res[key] = fn.apply(this, [key, obj[key]]);
    return res;
  }, {});
}
// A right curried version
var mapObjectWith = rightCurry(mapObject);  
</code></pre>

<p>The function passed to <code>mapObject()</code> is passed not only the item but also the property name.  Now, we can use our ability to map over an object to convert our structure:</p>

<pre><code>// Remove our extraneous group key and pair, replacing with the post record
var finalgroups = mapObjectWith(function(group, set){  
    return mapWith(getWith(0))(set);
})(groupedtags);
// {
//   'destructuring': [
//      { id: 2, title: 'ES6 Promises', ..., tags: ['es6', 'promises'] },
//      { id: 4, title: 'Basic Destructuring in ES6', ..., tags: ['es6', 'destructuring'] },
//   ],
//   'es6': [ /*...*/ ],
//   /*...*/
// }
</code></pre>

<h3 id="beingmoredeclarative">Being More Declarative</h3>

<p>The operation we used above in which we want to pull out a specific property's value from a list of objects, <code>mapWith(getWith(prop))</code>, is a fairly common action. So much so, that this is commonly named <code>pluck()</code>, and you'll find it in numerous functional libraries.  </p>

<pre><code>// For each object in `list`, return the value of `prop`
function pluck(list, prop) {  
  return mapWith(getWith(prop))(list);
}
// right curried version of `pluck`
var pluckWith = rightCurry(pluck);  
</code></pre>

<p>That's a bit more declarative and gives us another higher order function we can reuse. But we'd like our resulting code to be a bit more descriptive of the actions it is actually performing - getting the post record from each nested pair.</p>

<p>Let's start by being explicit with the function we're passing to <code>mapObjectWith()</code>:</p>

<pre><code>function getPostRecords(prop, pair) {  
  return pluckWith(0)(pair); 
}
</code></pre>

<p>Ah, that's a bit more descriptive. And when combined with our original solution, becomes much more declarative of the action we're actually performing.</p>

<pre><code>var finalgroups = mapObjectWith(getPostRecords)(groupedtags);  
</code></pre>

<h3 id="thefullimplementation">The full implementation</h3>

<p>The final implementation for meeting our second requirement:</p>

<pre><code>// Step 1: Build our many-to-many list 
var bytags = pairWith(getWith('tags'))(records);

// Step 2: group by the tags (pair[1]):  
var groupedtags = groupBy(getWith(1), bytags);

// Step 3: strip extra key in nested pairs: 
function getPostRecords(prop, value) {  
  return pluckWith(0)(value); 
}
var finalgroups = mapObjectWith(getPostRecords)(groupedtags);  
</code></pre>

<h2 id="summary">Summary</h2>

<p>In this post we've added a number of utility functions to our library.  We also took a circuitous route through transforming our initial data due to its many-to-many relationship between posts and tags.  We were then able to output a list of posts for each tag.</p>

<p>We also looked at a handful of common functional programming and combinative idioms like <code>pluck</code>, <code>map</code> and <code>mapObject</code>.  Be sure and look over <a href="https://gist.github.com/datchley/26bce4a05fde0226b405">the gist</a> of the full source for this second part of our blog series. </p>

<p>In the next and final blog post, we'll find out why we keep making right curried versions of all our functions as we discuss composition; and we'll finish our final requirement which is sorting each group of posts.</p>
        <ul class="tags">
            <li class="tag" id="tag-id-5"><a href="/tag/javascript/">javascript</a></li> 
            <li class="tag" id="tag-id-19"><a href="/tag/functional-programming/">functional programming</a></li> 
        </ul>
  </section>
					</div>
				</article>
				<!--================= END :: Tutorial =================-->
				
				
				
				<!--================= START :: Tutorial =================-->
				<article>
					<a id="t-17" name="t-17"></a><h1>17 : Understanding Prototypes, Delegation &amp; Composition</h1>
					<span>http://www.datchley.name/understanding-prototypes-delegation-composition/</span>
					<div class="tutorial__content">


					
<p>In the <a href="http://www.datchley.name/delegate-object-to-classical-inheritance/">last post</a> we covered the basics of creating and using Javascript objects, which included using <code>new</code> to invoke functions as constructors. In this post, we're going to focus on the following:</p>

<ul>
<li>how Javascript's prototype based objects work</li>
<li>building up functionality through <em>pseudo-classical inheritance</em> via constructor functions and the prototype chain</li>
<li>and a simpler, more idiomatic way to build up functionality using composition, delegation and mixins.</li>
</ul>

<h2 id="whatisthisprototypething">What is this 'prototype' thing?</h2>

<p>When most developers think of Object Oriented (OO) programming, they are usually coming from languages like Java and C++ where the concept of a <em>class</em> represents a kind of <em>blueprint</em> for a particular type of object's behavior. In those languages, a class is a separate, (<em>typically</em>) static representation of how an object should be created; and this is much different than an <em>instance</em> of an object created from that class.</p>

<p>Despite what some people might tell you, Javascript does not have classes.  What some developers refer to as a "class", is actually just a function, with other functions assigned to its <code>.prototype</code> property; which, in turn, is called with <code>new</code> in order to treat the function like a constructor.</p>

<pre><code>// Not a 'class', just a function
function Person(name) {  
  this.name = name;
}
Person.prototype.hello = function() {  
  console.log("Hello, my name is " + this.name);
};

// invoke our function with `new` for magical constructor behavior
var dave = new Person("Dave");  
dave.hello();  
// "Hello, my name is Dave"
</code></pre>

<p>The <code>.prototype</code> property of <code>Person</code> above is an actual property on the <code>Person</code> function (<em>functions are objects</em>). This property is treated as an object and used to create the actual prototype to which our new object is linked.  </p>

<p><strong>Note</strong>: In some browsers you can access an objects prototype using <code>__proto__</code> property - typically referred to using the <code>[[Prototype]]</code> symbol. </p>

<blockquote>
  <p>The actual prototype of an object "<em>is just another object</em>" to which it is linked</p>
</blockquote>

<p>Using the <code>.prototype</code> property of a function we can assign new properties so that when a new object is created from that constructor function, those properties are available on that object's actual prototype.  </p>

<p>To wit, the above code snippet yields the following relationships:</p>

<p><img src="http://www.datchley.name/content/images/2015/06/js-prototype-example--1-.png" alt=""></p>

<p>These prototypes in Javascript are really just a way to compose functionality. They allow an object to <em>delegate</em> behavior to its <em>prototype</em>, which is simply just another object that it links to via an internal, single path chain.  </p>

<p>This resembles "inheritance" in the sense that you can call a function on your object that isn't directly defined on that object, so long as it is defined on an object that your function links to in the prototype chain. </p>

<p>You may have heard this referred to as <em>prototypal inheritance</em>; but, in reality, this is simply Ojects Linking to Other Objects (<em>OLOO</em>), as <a href="http://davidwalsh.name/javascript-objects-deconstruction">Kyle Simpson</a> correctly termed it. The actual work is being accomplished via:</p>

<ul>
<li><strong>composition</strong> - your object contains another object, called its prototype, and</li>
<li><strong>delegation</strong> - when you access a property on your object, if it's not directly defined on it, javascript will search the prototype chain and delegate that behavior to the first object it finds that defines that property.</li>
</ul>

<h3 id="constructor"><code>.constructor</code></h3>

<p>Just to make OO concepts even muddier in Javascript, we also have the <code>.constructor</code> property. This property will reference a function used to create one of the objects in a given object's prototype chain. </p>

<p>When you call a function with <code>new</code> the <code>.constructor</code> property is set for you on the returned object's prototype.</p>

<p>In the case of our example above, we can inspect the <code>.constructor</code> property and see that it holds a reference to the <code>Person()</code> function, which we used to construct the object. </p>

<pre><code>dave.__proto__.constructor; // function Person()  
dave.__proto__.__proto__.constructor; // function Object()  
</code></pre>

<p><img src="http://www.datchley.name/content/images/2015/06/js-prototype-example--2-.png" alt=""></p>

<p>However, this direct relationship doesn't always hold true; especially when we start trying to implement <em>inheritance</em> using <code>new</code> and assigning prototypes. </p>

<pre><code>function Foo(){}

function Bar(){  
    // Call our parent constructor on our object
    Foo.call(this);
}
// "inherit" from Foo's prototype
Bar.prototype = Object.create(Foo.prototype);

var bar = new Bar();

console.log(bar.constructor);  
// function Foo() !WOOPS, that's not our constructor
</code></pre>

<p>By re-assigning the prototype, we end up with the <code>.constructor</code> property of the prototype object referencing <code>Foo()</code>, not the constructor of our <code>bar</code> object, which we expected to be <code>Bar()</code>. To fix that, we have to manually reassign the constructor right after setting its prototype.</p>

<pre><code>Bar.prototype = Object.create(Foo.prototype);  
Bar.prototype.constructor = Bar;  
</code></pre>

<h3 id="instanceof"><code>instanceof</code></h3>

<p>When using <code>new</code> for constructor functions, Javascript allows us to use <code>instanceof</code> to check if an object is an instance of a particular constructor function.  More precisely, <code>instanceof</code> checks if an object's prototype chain contains an instance of a given constructor's prototype.</p>

<p>For example:  </p>

<pre><code>function A(){}

function B(){}  
B.prototype = Object.create(A.prototype);

var obj = new B();  
console.log(obj instanceof B); // true  
console.log(obj instanceof A); // true  
console.log(obj instanceof Object);  // true  
console.log("%o", obj.constructor.prototype); // A {}  
</code></pre>

<p>However, <code>instanceof</code> can be problematic in some circumstances and return incorrect results:</p>

<ul>
<li>the prototype of the object in question has changed</li>
<li>you are comparing across frame/window execution contexts (<em>object from one frame, say an Array, checked in another frame will return false when doing <code>obj instanceof Array</code></em>)</li>
<li>you don't have a constructor function to use to introspect the object (<em>say, a third party library, module or closure</em>)</li>
</ul>

<p>For instance:  </p>

<pre><code>// Related objects whose constructors are out of scope
var a = (function(){  
    function A(){};
    return new A();
})();
var b = (function(proto) {  
    function B(){};
    B.prototype = proto;
    return new B();
})(a);

// Can we determine if b is related to a?
function F(){}  
F.prototype = a;  
console.log("Related? ", b instanceof F);  
// Related? true
</code></pre>

<p>In this case, we have two objects whose constructor functions weren't available for comparison using <code>instanceof</code>; so we create a throw-away function and assign the base object <code>a</code> to it's <code>.prototype</code> and then use <code>instanceof</code> to determine if <code>b</code> is an instance of the function <code>F()</code>. Rather, if the prototype of <code>F()</code> is anywhere in the prototype chain of <code>b</code>.</p>

<p>Clearly the object <code>b</code> was not constructed by the function <code>F</code>, but we still get a false positive because of how <code>instanceof</code> tests for ancestry using the constructor's prototype.</p>

<blockquote>
  <p><code>obj instanceof F</code> is semantically misleading. It does not imply that <code>obj</code> was created by <code>F()</code> or is even remotely related to <code>F()</code>; only that the prototype <code>F</code> will use when invoked with <code>new</code> is somewhere in the prototype chain of <code>obj</code>.</p>
</blockquote>

<h2 id="implementinginheritanceinjavascript">Implementing inheritance in Javascript</h2>

<p>So far we've seen that Javascript provides us with a number of "features" that make it <em>seem</em> as if it supports thinking about and implementing objects using classical inheritance. But, we've also seen the caveats that surround those features like <code>instanceof</code>, <code>new</code> to invoke functions as constructors and the <code>.constructor</code> and <code>.prototype</code> properties. </p>

<p>To implement classical inheritance, we need to understand the details of how it's implemented behind the scenes to fully appreciate that Javascript isn't really using "classes" or inheritance at all.</p>

<p>Let's give it a go with a simple, albeit contrived, example of inheritance with a <code>Dog</code> which inherits from <code>Animal</code>.</p>

<pre><code>// Our base "class" Animal
function Animal(name) {  
    this.me = name;
}
// Some base "class" methods
Animal.prototype.who = function() {  
    return "I am " + this.me;
};
Animal.prototype.speak = function() {  
    // What should this do? I dunno...
    console.log("(Animal) speak!");
}

// A child "class" that "inherits" from Animal
function Dog(name) {  
    Animal.call(this, name);
}
// Ensure we properly inherit from our base class
Dog.prototype = Object.create( Animal.prototype );  
Dog.prototype.constructor = Dog;

// Add our own 'speak' method and call our base class 'speak' as well
Dog.prototype.speak = function() {  
    Animal.prototype.speak.call(this); 
    console.log("Hello, " + this.who() + "." );
};

// Puppies! Awwwww
var fluffy = new Dog( "Fluffy" );  
var spot = new Dog( "Spot" );  
</code></pre>

<p>So, yeah, we now have a couple of talking dogs. Nothing to see here, move along...</p>

<p>Get a cup of coffee (<em>or your favorite beverage</em>) and sit down for second. Take some deep breaths; because as straight forward (<em>not so much</em>) as the above code looks, the following diagram shows what's actually happening under the hood:</p>

<p><img src="http://www.datchley.name/content/images/2015/06/classical-inheritance-js.png" alt=""></p>

<p>Seems like we're going to a lot of effort to treat Javascript like it has classes by </p>

<ul>
<li>using <code>new</code> to invoke functions as constructors</li>
<li>mimicking methods by assigning them to the function's <code>.prototype</code> property</li>
<li>ensuring that we create the proper relationships by setting the correct prototype for child classes and ensuring we call our parent class's constructor in the right context</li>
<li>and re-wiring the <code>.constructor</code> property of our <code>.prototype</code> to ensure it points to our actual constructor function</li>
</ul>

<p>In fact, this all boils down to jumping through hoops to basically ensure our objects properly compose behavior via creating the right linkage to another object via composition in the prototype chain.</p>

<p>I hear you asking, "<em>There must be a better, more idiomatic, way to do this in Javascript?</em>" </p>

<p>Yes, there is.</p>

<h2 id="delegationusingobjectcreate">Delegation using <code>Object.create()</code></h2>

<p>We used <code>Object.create()</code> above when creating the function prototypes. <code>Object.create()</code> does exactly what we really want - creating a linkage between objects by building an object based on another object.</p>

<p>So, maybe we can just use "plain objects", instead of constructor functions?</p>

<pre><code>var foo = { a: 1 };

var bar = Object.create(foo);  
bar.b = 2;

var baz = Object.create(bar);  
baz.c = 3;

console.log("I can haz 'a' and 'b'? ", !!(baz.a &amp;&amp; baz.b));  
// true
</code></pre>

<p><code>Object.create()</code> properly sets up the prototype linkage and gives us a new object; which we can then link to another object.  We don't have to worry about <code>instanceof</code> because we're not using functions as constructors; nor do we have to deal with setting a <code>.prototype</code> or <code>.constructor</code> property correctly.</p>

<p>So let's go back to our <code>Animal</code> and <code>Dog</code> example and see how we would compose that same functionality using delegation through <code>Object.create()</code> instead of constructors. </p>

<p>We'll use <code>Object.assign()</code> to initialize the objects in the our chain. Most browsers don't support <code>Object.assign()</code> yet, so you can use this simple polyfill to run the examples:</p>

<pre><code>if (!Object.prototype.assign) {  
    Object.prototype.assign = function() {
        var args = [].slice.call(arguments),
            target = args.shift();

        return args.reduce(function(base, obj) {
            Object.keys(obj).forEach(function(prop) {
                if (obj.hasOwnProperty(prop)) {
                    base[prop] = obj[prop];
                }
            });
            return base;
        }, target);
    }
}
</code></pre>

<p>The functionality we want to compose using delegation will be similar to our original; but delegation is a fundamentally different approach and pattern than inheritance.</p>

<ul>
<li>Delegation builds functionality by composing (<em>via links</em>) regular objects, not by using constructor functions.</li>
<li>Delegation uses more specific method names on the delegator objects that are reflective of the actions they perform. Inheritance keeps method names fairly generic, as sub-classes tend to re-implement specific behavior that override the base classes method. </li>
<li>State is typically maintained at the delegator level, not in the delegatee objects.</li>
</ul>

<pre><code>var Animal = {  
    who: function() { return this.name; },
    speak: function(s) { console.log(this.who() + ": " + s); }
}

var Dog = Object.create(Animal, {  
    bark: {
        value: function() { this.speak("woof!"); }
    }
});

var spot = Object.assign(Object.create(Dog), { name: "Spot" });  
var fluffy = Object.assign(Object.create(Dog), { name: "Fluffy" });

spot.bark();  
fluffy.bark();  
</code></pre>

<p>That's much less code; and here's the new mental model you'll have to grok.  Much easier!</p>

<p><img src="http://www.datchley.name/content/images/2015/06/js-object-create-example--2-.png" alt=""></p>

<p>We're composing functionality here using <code>Object.create()</code>. And the <code>bark()</code> method of our <code>Dog</code> objects delegates to <code>Animal.speak()</code>, available via its prototype chain. </p>

<p>The approach with the delegation pattern is to use an object as a base "type" that contains common behavior and have other objects link to that object to use that functionality. </p>

<p>In many respects, what we're trying to do is simply <em>compose behavior</em>, not create types, like inheritance does.  The relationship between two objects is explicit via composition using <code>Object.create()</code>, rather than implicit via an internal inheritance mechanism.</p>

<p>So, if we're wanting to really just compose behavior; and those behaviors might be common to a number of different objects, there is actually another pattern we can use: <strong>mixins</strong>. </p>

<h3 id="composingbehaviorthroughmixins">Composing Behavior through Mixins</h3>

<p>The concept of <em>mixins</em> is fairly wide spread and found in a number of languages.  The idea is to factor out common, reusable behavior into their own objects and then integrate those objects into more specific objects that need to use them.</p>

<pre><code>// A base object so we can create people
var Person = {  
    who: function(){ return this.name; },
    init: function(name) {
        this.name = name;
    }
};

// Factor out common functionality into their own
// objects
var canSpeak = {  
    speak: function(s) { console.log(this.who() + ": " + s); }
};
var canWalk = {  
    walk: function() { console.log(this.who() + " is walking..."); }
};
var canBuild = {  
    tools: ['hammer', 'pliers'],
    use: function(tool) { this.tools.push(tool); },
    build: function(thing) { 
        var withTool = parseInt(Math.floor(Math.random() * this.tools.length));
        console.log(this.who() + " is building a " + thing + " using " + this.tools[withTool]);
    }
};

// Can we build it?...
var bob = Object.assign(Object.create(Person), canSpeak, canWalk, canBuild);  
bob.init("Bob the Builder");  
bob.speak("Hi there!");  
bob.walk();  
bob.use("stapler");  
bob.build("web site");  
</code></pre>

<p>This pattern improves things by </p>

<ul>
<li>further simplifying the mental model used to create objects, </li>
<li>improves the readability of the code,</li>
<li>makes it very easy to isolate functionality in specific objects for better reuse. (<em>DRY, Separation of Concerns</em>)  </li>
</ul>

<p>Here's the inside view of using mixins.</p>

<p><img src="http://www.datchley.name/content/images/2015/06/js-prototype-example--3-.png" alt=""></p>

<p>What an object can do is explicitly stated through the use of mixins. Plus, we can add as many behaviors/mixins as make sense to an object.</p>

<p>We're still using delegation here, via the prototype chain; but mixins give us the ability to inherit from objects in a different way.  Mixins represent <em>concatenative inheritance</em>, meaning that instead of delegating behavior to another object, we copy that behavior directly. You can see this in the above diagram, as all the mixins' properties now exist on our new object.</p>

<h2 id="summary">Summary</h2>

<p>There are many libraries available that wrap the implementation of <em>inheritance</em> making it easier to program in Javascript if you come from a strict OO background or "class" centric language. But using inheritance and trying to maintain that mental model in Javascript is complex and hard to manage due to various problems.</p>

<p>With the end goal of simply being able to compose functionality, we found that the more idiomatic way to do that in Javascript is through simple objects, the prototype chain, and using new patterns of thinking in our design like <em>delegation</em> and <em>mixins</em>.</p>

<p>Hopefully this post has been enlightening for at least some of you; as this is a topic that is amply covered in books and online by various people - each with their own take on the subject.</p>

<hr>

<p><em>MDN can give you a good reference on <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/create">Object.create</a> and <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/assign">Object.assign</a> if you're curious about the details.</em></p>

<p><em>Also, be sure and check out Kyle Simpson's <a href="https://github.com/getify/You-Dont-Know-JS/tree/master/this%20%26%20object%20prototypes">You Don't Know JS: this &amp; Object Prototypes</a> and Eric Elliott's <a href="https://medium.com/javascript-scene/common-misconceptions-about-inheritance-in-javascript-d5d9bab29b0a">Common Misconceptions about Inheritance in Javascript</a> for more on this subject and a much deeper insight.</em></p>
					</div>
				</article>
				<!--================= END :: Tutorial =================-->
				
				<!--================= START :: Tutorial =================-->
				<article>
					<a id="t-18" name="t-18"></a><h1>18 : Some jQuery Functions And Their JavaScript Equivalents</h1>
					<span>http://callmenick.com/post/jquery-functions-javascript-equivalents</span>
					<div class="tutorial__content">
					

<p>In light of my recent forays into the JavaScript DOM world, I'd decided to do a little research and write a snippet collection based on jQuery functions and their JavaScript equivalents. I think jQuery is a great tool, and it has done great things for me and many others as developers. But I'm a firm believer that nowadays, JavaScript is an indispensable tool to keep in your arsenal. Manipulating the DOM with JavaScript DOM methods is fun and easy, and the majority of times, plain old vanilla JS is all we need. It seems scary at first, but let's take a look at some core functions/methods that we're accustomed to, how they work, and how to execute them with just plain old JavaScript.</p>
<h2>Accessing Elements</h2>
<p>There are many ways to access elements with JavaScript and jQuery. Let's look at a few important ones here.</p>
<h3>By ID</h3>
<p>In this above scenario, we're accessing by ID, so we'd expect that only one element is returned. With jQuery, we tend to access single elements by ID like this:</p>
<pre><code class="language-javascript">var el = $("#element");</code></pre>
<p>With regular JS, we can achieve this two ways:</p>
<pre><code class="language-javascript">// traditional JS
var el = document.getElementById("element");

// new school JS
var el = document.querySelector("#element");</code></pre>
<p>From here on, we can use these variables and apply our manipulations whenever we want. We've successfully assigned an element to a variable, and can now use it wherever we want.</p>
<h3>By Class &amp; Tag</h3>
<p>In jQuery, we also see that we can access all elements that have a certain class or tag. This is useful when we want to iterate over all of these elements and perform functions on them. We'd access them like this:</p>
<pre><code class="language-javascript">// access by tag name
var els = $("p");

// access by class
var els = $(".class");</code></pre>
<p>Here's the JavaScript equivalents:</p>
<pre><code class="language-javascript">// by tag name
var els = document.getElementsByTagName("p");        // OR
var els = document.querySelectorAll("p");

// by class name
var els = document.getElementsByClassName("class");    // OR
var els = document.querySelectorAll(".class");</code></pre>
<h3>Useful Tips</h3>
<p>The methods <code>getElementsByTagName</code>, <code>getElementsByClassName</code>, <code>querySelector</code>, and <code>querySelectorAll</code> can be applied to DOM elements to return collections of elements or node lists that are children of an element in question. We can, for example, do this:</p>
<pre><code class="language-javascript">var wrapper = document.getElementById("wrapper"),
    els = wrapper.querySelectorAll("p");</code></pre>
<p>A jQuery equivalent would be this:</p>
<pre><code class="language-javascript">var els = $("#wrapper p");</code></pre>
<h3>Caveats</h3>
<p>Here are some things to note:</p>
<ol>
<li>Using <code>querySelector</code> on an element that exists more than once (e.g.: <code>querySelector("p")</code> will return the first matching element.</li>
<li>Technically, <code>querySelectorAll</code> returns a non-live node list of elements. This is in contrast to the HTMLCollection returned by <code>getElementsByTagName</code> and <code>getElementsByClassName</code>. Be mindful of that! </li>
</ol>
<h2>Getting &amp; Setting the HTML of an Element</h2>
<p>It's fairly common practice in simple interfaces that after a user commits to a call to action, the HTML of an element is replaced. This can be to display a success or error message after a form submission, for example. Sometimes, we might want to fetch the HTML contents of an element and throw it into another element in our DOM. With jQuery, this is made possible by the simple <code>.html()</code> function. Here it is in action:</p>
<pre><code class="language-javascript">// getting the HTML
var content = $("#content").html();

// setting the HTML
$("#box").html(content);</code></pre>
<p>With JavaScript, we're presented with the function <code>innerHTML</code> that serves the same purpose. Here's a replication of the above, but with pure JavaScript:</p>
<pre><code class="language-javascript">// getting the HTML
var content = document.getElementById("content").innerHTML;

// setting the HTML
document.getElementById("box").innerHTML = content;</code></pre>
<p>Be mindful when using <code>innerHTML</code> though. According to the MDN:</p>
<blockquote>
<p>If a <code>&lt;div&gt;</code>, <code>&lt;span&gt;</code>, or <code>&lt;noembed&gt;</code> node has a child text node that includes the characters (&amp;), (&lt;), or (&gt;), innerHTML returns these characters as <code>&amp;amp</code>, <code>&amp;lt</code> and <code>&amp;gt</code> respectively. Use <code>Node.textContent</code> to get a correct copy of these text nodes' contents.</p>
</blockquote>
<h2>Attaching Event Handler Functions to Elements</h2>
<p>A very important part of JavaScript programming is attaching evened handler functions, or "listening" for events on elements in the DOM. These events range from click and hover, to blur. jQuery offers us a lot of direct attachment of event handlers, for example <code>$("#el").click();</code>, but we're going to look at a jQuery function that resembles pure JavaScript, and is very useful - the <code>.on()</code> function. Here it is in action, listening for a click on an element:</p>
<pre><code class="language-javascript">// listening for a click on #el
$("#el").on("click", function(){
    console.log("element clicked");
});</code></pre>
<p>The above should output "element clicked" to the console. With JavaScript, the implementation is friendly and straightforward. In fact, the name itself is very self explanatory. Here's the implementation:</p>
<pre><code class="language-javascript">// listening for a click on #el
document.querySelector("#el").addEventListener("click", function(){
    console.log("element clicked");
});</code></pre>
<h3>Multiple Event Handlers with jQuery</h3>
<p>Here's something cool to note though. With jQuery, we can add multiple event handlers on the same element by comma-separating them before the function is called. Here's an example:</p>
<pre><code class="language-javascript">// listening for a click and hover on #el
$("#el").on("click", "hover", function(){
    console.log("click or hover");
});</code></pre>
<h2>Appending and Prepending Content</h2>
<p>Often, we want to append or prepend some additional information or message to an element after user interaction. jQuery provides us two neat functions to take care of this -  <code>.append()</code> and <code>.prepend()</code>. The names give away their functionality, so let's look at some implementation:</p>
<pre><code class="language-javascript">// append "success" message to a log
$("#log").append("&lt;p&gt;Success!&lt;/p&gt;");

// prepend "error" message to a log
$("#log").prepend("&lt;p&gt;Error...go back and fix.&lt;/p&gt;");</code></pre>
<p>For appending content, JavaScript offers us a self explanatory function too - <code>Node.appendChild</code>. In this case though, we are dealing with nodes, so we can't directly insert content. Instead, we must insert a node that contains content. Let's take a look at this function in action:</p>
<pre><code class="language-javascript">// create an element, give it some HTML, append it to #log
var p = document.createElement("p");
p.innerHTML = "Success!";
document.getElementById("log").appendChild(p);</code></pre>
<p>Prepending isn't as straightforward, as there is no <code>Node.prependChild</code> function in JavaScript. However, using a combination of <code>insertBefore</code> and <code>firstChild</code>, we can insert our node before the first child of the element in question, i.e. prepending our node to <code>#log</code>. Let's take a look at this in action:</p>
<pre><code class="language-javascript">// create an element and get our #log div
var p = document.createElement("p"),
    log = document.getElementById("log");

// add some HTML to p
p.innerHTML = "Error...go back and fix.";

// prepend p to #log
log.insertBefore(p, log.firstChild);</code></pre>
<h2>Altering the CSS of an Element</h2>
<p>Users tend to feel more welcome and safe when they feel this sense of familiarity. It's not uncommon then to see different colours or styles of things changing based on user interaction. Form failed to submit? Change the background colour to red. Successful submission? Change it to green. Want to hide the form after successful submission? Set the property to <code>display: none</code>. These are attributes of DOM elements that can all be controlled via CSS. jQuery conveniently gives us the <code>.css()</code> function to tap into an elements CSS. Let's take a look how:</p>
<pre><code class="language-javascript">// this will output the element's background colour
var col = $("#el").css("background-color");
console.log(col);

// this will change the element's background colour to green
$("#el").css("background-color", "green");

// alternate syntax for passing array into .css
$("#el").css({
    "background-color": "green",
    "colour": "white"
});</code></pre>
<p>On the vanilla JS side of things, we're presented with the function <code>HTMLElement.style</code>. This allows us to set the style of an element. Here it is in action:</p>
<pre><code class="language-javascript">// change the colour of #el to green
document.getElementById("el").style.color = "green";</code></pre>
<p>To actually get the style attribute of an element is a bit different though. According to the MDN:</p>
<blockquote>
<p>The style property is not useful for learning about the element's style in general, since it represents only the CSS declarations set in the element's inline style attribute, not those that come from style rules elsewhere, such as style rules in the <code>&lt;head&gt;</code> section, or external style sheets. To get the values of all CSS properties for an element you should use <code>window.getComputedStyle()</code> instead.</p>
</blockquote>
<p>In jQuery, a similar function goes down when getting the style. Here's a look at <code>window.getComputedStyle()</code> in action:</p>
<pre><code class="language-javascript">// this will return the computed colour of "el"
var el = document.getElementById("el");
var elStyle = window.getComputedStyle(el, null);
console.log(elStyle.color);</code></pre>
<h2>Iterating Over a Collection of Elements</h2>
<p>The last comparison we'll go through is of significant importance as it entails looping. Looping is a very important part of any programming language, and JavaScript is no different. Often times, we need to iterate over a collection of elements and perform some functionality to each of those elements. This is what loops are for.</p>
<p>Let's target all elements in our DOM with a class of <code>.el</code>, loop over them, and change the colour to blue. With jQuery, the <code>.each()</code> function gives us a nice starting point. Combining what we've learnt above, here's the implementation:</p>
<pre><code class="language-javascript">$(".el").each(function(i, el){
    /**
     * i represents the integer value of where we are in the loop
     * el represents the element in question in the current loop
     * $(this) also represents the element in question in the current loop
     */

    // change the element colour to blue.
    $(this).css({
        "colour": "blue"
    });    
});</code></pre>
<p>With JavaScript, we can use a simple <code>for</code> loop to take care of this. The thought process behind it is the same - get a collection of HTML elements, loop over them, and edit them. Here's how:</p>
<pre><code class="language-javascript">// get all elements with class .el
var els = document.querySelectorAll(".el");

// loop over them while i less than number of elements
for (var i = 0, len = els.length; i &lt; len; i++) {
  els[i].style.backgroundColor = "blue";
}</code></pre>
<h3>Bonus</h3>
<p>Here's some swanky alternative JavaScript syntax that resembles the <code>.each()</code> function a bit more. It's a <code>forEach</code> function, and we first create an empty array and then add each of the nodes to it. After that, we iterate using a <code>forEach</code> statement. Here it is in action:</p>
<pre><code class="language-javascript">[].slice.call(document.querySelectorAll(".el")).forEach(function(el,i){
    /**
     * i represents the integer value of where we are in the loop
     * el represents the element in question in the current loop
     */

     // change the element colour to blue.
     el.style.backgroundColor = "blue";
});</code></pre>
<h2>Wrap Up</h2>
<p>And that's a wrap! We've looked at some common and important jQuery/JavaScript comparisons, and seen that JavaScript isn't that scary after all. I'm not taking anything away from jQuery, I think it's amazing. But if you're using jQuery because you're scared to dive in to vanilla JS, then you shouldn't be. In 2014, JavaScript is a very important language and can take you far. I hope this collection of snippets helped clear the air for you a bit and got your feet a little wet with JS programming. If you have any comments, feedback, suggestions, or questions, feel free to leave them below.</p>
					</div>
				</article>
				<!--================= END :: Tutorial =================-->
				
				<!--================= START :: Tutorial =================-->
				<article>
					<a id="t-19" name="t-19"></a><h1>19 : Is everything in JavaScript an Object?</h1>
					<span>https://blog.simpleblend.net/is-everything-in-javascript-an-object/</span>
					<div class="tutorial__content">



          
      <p>I have always found this statement confusing: "Everything in JavaScript is an Object". What did they mean by this? How can a Function or an Array at the same time be an Object? Before we tackle this question, we need to understand how the different Data Types are categorized.</p>
<p>In JavaScript, there are two Data Types: <strong>Primitives</strong> and <strong>Objects</strong>. (Object Types are also sometimes referred to as Reference Types). <span class="citation-num" data-citation-num="1">1</span></p>
<table>
<thead>
<tr>
<th>Primitive</th>
<th>Object</th>
</tr>
</thead>
<tbody>
<tr>
<td>Number</td>
<td>Function</td>
</tr>
<tr>
<td>String</td>
<td>Object</td>
</tr>
<tr>
<td>Boolean</td>
<td>Array</td>
</tr>
<tr>
<td>Symbol</td>
<td></td>
</tr>
<tr>
<td>null</td>
<td></td>
</tr>
<tr>
<td>undefined</td>
<td></td>
</tr>
</tbody>
</table>
<p>Based on this categorizing, the simple anwser is no, not everything in JavaScript is an Object. Only values that belong to that Type are Objects. Another way of looking at it is, any Type that isn't a Primitive Type is an Object Type. But what is it that <em>differentiates</em> Primitives from Objects? And more importantly, what do people <em>really mean</em> when they say "everything" or "almost everything" is an Object"? There are two main distinctions: mutability, and comparison.</p>
<h2>Mutability</h2>
<p>From my experience, what people <em>really mean</em> when they talk about values being "object like" is their mutability. More specifically, they're talking about the ability to add and remove properties. For example, because Functions and Arrays belong to the Object Type you can add properties to them just like you would an object literal.</p>
<pre><code class="language-javascript">var func = function() {};
func.firstName = "Andrew";
func.firstName; // "Andrew"

var arry = [];
arry.age = 26;
arry.age; // 26
</code></pre>
<p>This opens the door to all sorts of fascinating use cases, and is really the key to understanding how Prototypes and Constructors work.</p>
<p>However because Primitive Types are immutable, we're unable to assign properties to them. <span class="citation-num" data-citation-num="2">2</span> The parser will immediately discard them when attemping to read their value.</p>
<pre><code class="language-javascript">var me = "Andrew";
me.lastname = "Robbins";
me.lastname; // undefined

var num = 10;
num.prop = 11;
num.prop; // undefined
</code></pre>
<p>At this point, I think it would be useful to examine things at a more fundamental level. With regards to primitives, what does it really mean to say that their values cannot be changed? Consider the following code:</p>
<pre><code class="language-javascript">1 = 2; // ReferenceError
</code></pre>
<p>This might seem like a silly example, but I think it shines a much needed light on exactly what we're talking about when we talk about mutability. When you type the number 1 into the JavaScript console, the compiler assigns that piece of data to the Primitive data type. Therefore when you attempt to change the number 1 to the number 2, it fails and probably has a heartattack.</p>
<h2>Comparison and passing around</h2>
<p>Besides mutability, another important distinction between Primitive Types and Object Types is the way they're compared and passed around within the program. Primitive Types are compared by value, while Object Types are compared by reference. What does this mean? Let's look at Primitives first. Consider the following code:</p>
<pre><code class="language-javascript">"a" === "a"; // true
</code></pre>
<p>This is true because the value "a" is equal to "a". Simple. However what happens when we introduce variables into the picture? Nothing has changed except that we're now storing our Primitive Types into variables.</p>
<pre><code class="language-javascript">var a = "a",
    b = "a";

a === b; // true
</code></pre>
<p>Since Primitive Types are compared by value, the result will true. The value of the variable a is exactly equal to the value of the variable b. In other words, "a" equals "a". Aristotle would be proud. However look at this. If we apply the same example to an Object Type, we get the opposite result.</p>
<pre><code class="language-javascript">var a = {name: "andrew"},
    b = {name: "andrew"};

a === b; // false
</code></pre>
<p>Why is this? Object Types must reference the same object in order for its comparison to be true. In the example above, we're creating a <em>new</em> object for the variable b. As David Flanagan puts it:</p>
<blockquote><p>"…we say that objects are compared by reference: two object values are the same if and only if they refer to the same underlying object." <span class="citation-num" data-citation-num="3">3</span></p></blockquote>
<p>Now, what happens when we pass these values around?</p>
<pre><code class="language-javascript">var a = {name: "andrew"},
    b = a;

b.name = "robbins";

a === b; // true
</code></pre>
<p>This might seem strange at first, but look closer at what's happening. Because objects are part of the Object type, it's values are compared and passed by reference. Reference to what? Reference to the same underlying object. In the above example, we're setting b equal to a. We didn't create a <em>new</em> object. We're simply creating a <em>reference</em> to another object. A different way of looking at it is that we're pointing the variable b to a. Therefore when we mutate the "name" property on b, we're at the same time mutating the "name" property on a.</p>
<p>Back to Primitives, how would the same example apply to them?</p>
<pre><code class="language-javascript">var a = "Andrew",
    b = a;

b = "Robbins";

a === b; // false
</code></pre>
<p>Remembering that Primitives are compared and passed by value, when we set b equal to a, we're actually creating a new copy of a. Therefore when we change the value of b and then compare it to a, the value is not the same anymore.</p>
<h2>Wrapper Objects</h2>
<p>Some of you may be wondering, "Ok, if Primitives aren't Objects then why can I call methods on them?" The answer is Wrapper Objects.</p>
<p>When you attempt to call methods on a Primitive, JavaScript does a magic trick behind the scenes. It takes your Primitive value and converts it to a <em>temporary</em> Object using a constructor function. <span class="citation-num" data-citation-num="4">4</span> The decision of which constructor function to use will depend on the Primitive value you're attempting to change. For example, calling .length on a string will use the built in String() constructor to <em>temporarily</em> change the Primitive to an Object—allowing you to use the length method to mutate it. This temporary Object is called a Wrapper Object. <span class="citation-num" data-citation-num="5">5</span></p>
<p>Interestingly enough, the two Primitive values null and undefined do not behave this way. Trying to call methods on these values will result in a TypeError.</p>
<p>We can use the typeof keyword to show the difference.</p>
<pre><code class="language-javascript">typeof "s"; // "string"
typeof new String(s); // "object"
</code></pre>
<p>As a sidenote, it's useful to know that there's a well-documented bug <span class="citation-num" data-citation-num="6">6</span> in JS compilers which returns "object" when executing typeof null.</p>
<pre><code class="language-javascript">typeof null // "object"
</code></pre>
<p>Considering that JavaScript was written in 10 days <span class="citation-num" data-citation-num="7">7</span>, I'm not going to lose any sleep over it =)</p>
<p>It's also useful to know that properties on Primitives are read-only, and temporary.</p>
<pre><code class="language-javascript">var hello = "hello";
hello.slice(1); // "ello" (Here we're actually calling slice not on hello, but of a copy of hello)
hello; // "hello"
</code></pre>
<h2>Summary</h2>
<p>JavaScript values can be categorized into two Types: Primitives and Objects. The Primitive Types are String, Number, Boolean, Symbol, undefined and null. The Object Types are Function, Object and Array.</p>
<p>The two distinctions between Primitives and Objects are their mutability and the way they're compared and "passed around" within the program.</p>
<p>Primitives are immutable. Another way of saying this is that their values can't be changed. On the other hand, Objects are mutable. Their values can be updated and changed.</p>
<p>Primitives are compared by value. When assigning one primitive to another using variables, a copy is made. Objects on the other hand are compared by reference. Reference to what? Reference to the underlying Object. When assigning one Object to another, a reference / pointer is created. At this stage, mutating a value on one Object will update the value on the other Object.</p>
<p>When attempting to call methods on Primitive values, JavaScript uses a Wrapper Object to temporarily coerce the Primitive. The resulting Object is read-only and garbage collected after execution.</p>
<p>In the next section, we'll go over how these Types fit into the bigger picture by analyzing Prototypes, Constructors, and Inheritance.</p>
<h2>Update: 11/8/14</h2>
<p>Recently there was a discussion over at <a href="https://javascriptkicks.com/stories/1669">https://javascriptkicks.com/stories/1669</a> regarding the performance of both Objects and Primitives. <a href="https://twitter.com/drewpcodes">@drewpcodes</a> wanted to know which approach would be faster: storing floating point numbers in Primitive form or Objects form? I was curious to know as-well so I wrote a small program to test it out. You can find the code I used here: <a href="http://jsfiddle.net/pmqortov">http://jsfiddle.net/pmqortov</a></p>
<p>I created two arrays: one array stored the data as Objects, and another stored the data as Primitives. Based on <a href="https://twitter.com/drewpcodes">@drewpcodes</a> use-case, the data I used was 150 floating point numbers. I also decided to limit both arrays to 150 entries so it wouldn't freeze my computer.</p>
<p>I then iterated over the arrays and saved a timestamp before and after every iteration. Then I did a little math on each timestamp and found the average in ms. For the sake of accuracy, I looped 5000 times for each instance. I noticed increasing this number would freeze Chrome. =)</p>
<p>Surprisingly enough, the list containing the data stored as Objects was actually 2ms faster then stored as Primitives! Here were the actual numbers:</p>
<pre><code class="language-javascript">// List with Objects 
// Average execution across 5000 repetitions: 16.8528 ms 
 
// List with Primitives 
// Average execution across 5000 repetitions: 18.2898 ms 
</code></pre>
<p>At this point I don't have an opinion either way of which method is best for storing your data. It could be that at higher volumes the Object method would be advantagous, but I'd like to see more evidence first.</p>
<p>Cheers!</p>
					</div>
				</article>
				<!--================= END :: Tutorial =================-->
				
				<!--================= START :: Tutorial =================-->
				<article>
					<a id="t-20" name="t-20"></a><h1>20 : Partial Application with Function#bind</h1>
					<span>http://adripofjavascript.com/blog/drips/partial-application-with-function-bind.html</span>
					<div class="tutorial__content">
<div class="post">
        <h1 class="post-title">Partial Application with Function#bind</h1>
        
            <p><i>
                Originally published in the 
                <a href="/">A Drip of JavaScript newsletter</a>.
            </i></p>
        

        <p>In <a href="/blog/drips/partial-application-with-function-bind.html">last week's drip</a>, we covered using <code>bind</code> to create bound functions. But <code>bind</code> is also a very convenient way of implementing partial application. First, let's take a look at exactly what partial application is.</p>

<p>According to <a href="https://en.wikipedia.org/wiki/Partial_application">Wikipedia</a>, partial application "refers to the process of fixing a number of arguments to a function, producing another function of smaller arity." Arity refers to the number of arguments that a function takes.</p>

<p>Here's an example:</p>
<pre><code>function multiply (x, y) {
    return x * y;
}

function double (num) {
    return multiply(2, num);
}
</code></pre>
<p>That's a very rudimentary form of partial application, where inside <code>double</code> we permanently fix <code>multiply</code>'s first argument as <code>2</code>, producing a new function <code>double</code>.</p>

<p>But explicitly declaring the body of the new function isn't actually necessary if you use <code>bind</code>. Here's how we could rewrite that:</p>
<pre><code>function multiply (x, y) {
    return x * y;
}

var double = multiply.bind(null, 2);
</code></pre>
<p>As we covered last time, the first argument to <code>bind</code> sets it's internal <code>this</code> value. Since our function doesn't depend on <code>this</code>, we just pass in <code>null</code>. But any subsequent arguments that we supply will be used to permanently fix the arguments of the function we are binding. In this case, we are only fixing one argument, but we can potentially fix as many as we want.</p>
<pre><code>function greet (salutation, person, delivery) {
    var message = '"'+ salutation + ', ' + person + '," ' +
                  delivery + ' the greeter.';

    console.log(message);
}

var hail = greet.bind(null, "Hail");

// Outputs: '"Hail, Lord Elrond," said the greeter.'
hail("Lord Elrond", "said");

var begone = greet.bind(null, "Begone", "Wormtongue", "commanded");

// Outputs: '"Begone, Wormtongue," commanded the greeter.'
begone();
</code></pre>
<p>One thing you may have noticed is that <code>bind</code> always fixes the arguments from left to right. This means that it isn't suitable for all forms of partial application, but it does cover the most common ones.</p>

<p>You may be wondering if partial application is actually all that useful in real code. To answer, let's revisit an example from our <a href="http://designpepper.com/blog/drips/using-dispatch-tables-to-avoid-conditionals-in-javascript">discussion of dispatch tables</a>:</p>
<pre><code>var commandTable = {
    north:    function() { movePlayer("north"); },
    east:     function() { movePlayer("east");  },
    south:    function() { movePlayer("south"); },
    west:     function() { movePlayer("west");  },
    look:     describeLocation,
    backpack: showBackpack
};

function processUserInput(command) {
    commandTable[command]();
}
</code></pre>
<p>In this example we are taking user input from a text adventure game, and then calling the appropriate command from <code>commandTable</code>. As you can see, we're using the same rudimentary form of partial application that we saw in our first example.</p>

<p>Using <code>bind</code> we can clean this up a bit.</p>
<pre><code>var commandTable = {
    north:    movePlayer.bind(null, "north"),
    east:     movePlayer.bind(null, "east"),
    south:    movePlayer.bind(null, "south"),
    west:     movePlayer.bind(null, "west"),
    look:     describeLocation,
    backpack: showBackpack
};

function processUserInput(command) {
    commandTable[command]();
}
</code></pre>
<p>As I mentioned last time, <code>bind</code> isn't available in IE8 and older, so you may want to use a polyfill or library to achieve the same functionality. If you only want to implement partial application and don't need to create bound functions, you might want to consider the <code>partial</code> methods in <a href="http://underscorejs.org/#partial">Underscore</a> and <a href="http://lodash.com/docs#partial">Lo-Dash</a>.</p>

    </div>
					</div>
				</article>
				<!--================= END :: Tutorial =================-->
				
				<!--================= START :: Tutorial =================-->
				<article>
					<a id="t-21" name="t-21"></a><h1>21 : Partial Application in JavaScript</h1>
					<span>http://blakeembrey.com/articles/2014/01/partial-application-in-javascript/</span>
					<div class="tutorial__content">
						<article class="content article"><p>Partial application is the act of pre-filling arguments of a function and returning a new function of smaller arity. The returned function can be called with additional parameters and in JavaScript, the <code>this</code> context can also be changed when called. Using a partially applied function is extremely common in functional programming with JavaScript as it allows us to compose some really nifty utilities and avoid repeating ourselves in code.</p>
<p>In modern JavaScript engines, there is a <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function/bind">bind function</a> which can be used to achieve a similar result. The difference between <code>partial</code> and <code>bind</code> is that the a partial functions <code>this</code> context is set when the returned function is called, while a bound functions <code>this</code> context has already been defined and can't be changed.</p>
<pre><code>var __slice = Array.prototype.slice;

/**
 * Wrap a function with default arguments for partial application.
 *
 * @param  {Function} fn
 * @param  {*}        ...
 * @return {Function}
 */
var partial = function (fn /*, ...args */) {
  var args = __slice.call(arguments, 1);

return function () {
    return fn.apply(this, args.concat(__slice.call(arguments)));
  };
};
</code></pre>
<p>From the function above, we can understand that <code>partial</code> accepts the function to be pre-filled and it's default arguments. It then returns a new function which can be called with some more arguments. It's important to note that the context (<code>this</code>) is being defined when the returned function is called. But when would you even want to use this?</p>
<p>Normally I would be happy to give a simple example of transforming an <code>add</code> function into an <code>add5</code> by partially applying it - <code>partial(add, 5)</code>. This definitely demonstates how we can use the utility, but doesn't really touch on why.</p>
<p>Consider writing a logging utility that accepts some different arguments that need to be logged - <code>var log = function (type, value) {}</code>. Fantastic, it looks like a really simple function to use. But now we want set every log in our file to the <code>testing</code> type. We can do a couple of things to achieve this. One option would be to assign our type to a variable and reuse the variable - <code>var testType = 'Testing'</code> and <code>log(testType, value)</code>. This will get messy after we write it more than once. What if we just wrapped the <code>log</code> function automatically?</p>
<pre><code>var testLog = function () {
  return log.apply(this, ['testing'].concat(__slice.call(arguments)));
};
</code></pre>
<p>Great, this looks familiar - we could have just used partial - <code>var testLog = partial(log, 'Testing')</code>. Now we have a function we can continue to reuse any number of times without fear of repeating ourselves.</p>
<h2 id="bonus-points">Bonus Points</h2>
<p>If you've been reading any of my previous blog posts, you may have noticed me abusing the usefulness of <a href="http://blakeembrey.com/articles/forcing-function-arity-in-javascript/">function arity</a> in anonymously returned functions. And in another article I wrote about a utility that can help us remove the <a href="http://blakeembrey.com/articles/javascript-variadic-function/">repetitive argument slicing</a>. If you haven't checked out these utilities yet, take a quick look and I bet you'll see how we could use them here.</p>
<pre><code>var partial = variadic(function (fn, args) {
  var remaining = Math.max(fn.length - args.length, 0);

  return arity(remaining, variadic(function (called) {
    return fn.apply(this, args.concat(called));
  }));
});
</code></pre>
<p>Now the returned partially applied function gives us the correct number of trailing arguments still to be filled using the <code>arity</code> utility. On top of that, we managed to get rid of slicing arguments constantly by using the <code>variadic</code> utility. In fact, I've been so interested in these reusable utilities that I published the <a href="https://github.com/blakeembrey/partial">partial utility on Github</a> so I can reuse it later.</p>
</article>
					</div>
				</article>
				<!--================= END :: Tutorial =================-->
				
				<!--================= START :: Tutorial =================-->
				<article>
					<a id="t-22" name="t-22"></a><h1>22 ; Composing Functions in JavaScript</h1>
					<span>http://blakeembrey.com/articles/2014/01/compose-functions-javascript/</span>
					<div class="tutorial__content">
<article class="content article"><p>Composing multiple functions to create more complex ones is a common utility in any programming language. And the ability to construct functions in a way that is easily composable is a true talent, but it really shines with code maintenance and reuse. It's not uncommon to find huge applications composed of many, much smaller functions. Inspired by this pattern of extremely modular functions, I've been slowly migrating my programming style to allow for more composable and reusable functions.</p>
<p>To compose functions together, we will need to accept a list of functions for it to be made up from. Let's call the functions <code>a</code>, <code>b</code> and <code>c</code>. Now that we have the list of functions, we need to call each of them with the result of the next function. In JavaScript, we would do this with <code>a(b(c(x)))</code> - with <code>x</code> being the starting value. However, it would be much more useful to have something a little more reusable than this.</p>
<pre><code>var compose = function () {
  var fns = arguments;

  return function (result) {
    for (var i = fns.length - 1; i &gt; -1; i--) {
      result = fns[i].call(this, result);
    }

    return result;
  };
};
</code></pre>
<p>The above function iterates over the function list (our arguments) in reverse - the last function to pass in is executed first. Given a single value as the initial input, it'll chain that value between every function call and return the final result. This allows us to do some really cool things.</p>
<pre><code>var number = compose(Math.round, parseFloat);

number('72.5'); //=&gt; 73
</code></pre>
<h2 id="sequence">Sequence</h2>
<p>Another utility I've seen about in some functional libraries is called <a href="https://github.com/raganwald/allong.es#functional-composition">sequence</a>. It's very similar to <code>compose</code>, except the arguments are executed in reverse. For example:</p>
<pre><code>var sequence = function () {
  var fns = arguments;

  return function (result) {
    for (var i = 0; i &lt; fns.length; i++) {
      result = fns[i].call(this, result);
    }

    return result;
  };
};
</code></pre>
<p>However, we should make a note of the almost identical function signature to <code>compose</code>. Usually, seeing something like this should trigger a warning in your head to find some way to reuse previous functionality, instead of replicating it. In this example, we can reuse the <code>compose</code> function to write the <code>sequence</code> implementation.</p>
<pre><code>var __slice = Array.prototype.slice;

var sequence = function () {
  return compose.apply(this, __slice.call(arguments).reverse());
};
</code></pre>
</article>
					</div>
				</article>
				<!--================= END :: Tutorial =================-->
				
				<!--================= START :: Tutorial =================-->
				<article>
					<a id="t-23" name="t-23"></a><h1>23 : A JavaScript Invoke Function</h1>
					<span>http://blakeembrey.com/articles/2014/01/javascript-invoke-function/</span>
					<div class="tutorial__content">
<article class="content article"><p><strong>Update:</strong> Now available on <a href="https://github.com/blakeembrey/invoke">github</a> and <a href="https://www.npmjs.org/package/util-invoke">npm</a>.</p>
<p>Under certain functional JavaScript toolbelts, we can find a utility that is used purely for invoking a method on a passed in object. The utility is a really simple snippet that can be used in a number of different circumstances.</p>
<pre><code>var __slice = Array.prototype.slice;

var invoke = function (method /*, ...args */) {
  var args = __slice.call(arguments, 1);

  return function (obj /*, ..args */) {
    return obj[method].apply(obj, args.concat(__slice.call(arguments, 1)));
  };
};
</code></pre>
<p>The most useful situation for a utility such as this is in combination with other functional utilities and iterators. Consider the case where we have an array of objects with identical methods. Not uncommon in a complex MVC application where you may be tracking child views. To remove every child view, we need to iterate over an array of views and call <code>remove</code>.</p>
<pre><code>var children = [/* ... */];

children.forEach(invoke('remove'));
</code></pre>
</article>
					</div>
				</article>
				<!--================= END :: Tutorial =================-->
				
				<!--================= START :: Tutorial =================-->
				<article>
					<a id="t-24" name="t-24"></a><h1>24 : YOU MIGHT NOT NEED JQUERY</h1>
					<span class="ref-site">http://youmightnotneedjquery.com/</span>
					<div class="tutorial__content">
<div class="comparisons">
      <div class="empty-message">Your search didn't match any comparisons.</div>
      <section id="ajax" class="odd">
        <div class="inner">
          <h2>AJAX</h2>
          <div class="alternatives-block">
            <h4>Alternatives:</h4>
            <ul class="alternatives">
              <li><a href=" https://github.com/ded/Reqwest" target="_blank">reqwest</a></li>
              <li><a href=" https://github.com/then/request" target="_blank">then-request</a></li>
              <li><a href=" https://github.com/visionmedia/superagent" target="_blank">superagent</a></li>
            </ul>
          </div>
          <div id="json" class="comparison">
            <h3><a href="#json">JSON</a></h3>
            <div data-browser="jquery" class="browser jquery">
              <h4>jQuery</h4>
              <pre><code>$.getJSON('/my/url', function(data) {

});
</code></pre>
            </div>
            <div data-browser="ie8" class="browser ie8" style="display: none;">
              <h4>IE8+</h4>
              <pre><code>var request = new XMLHttpRequest();
request.open('GET', '/my/url', true);

request.onreadystatechange = function() {
  if (this.readyState === 4) {
    if (this.status &gt;= 200 &amp;&amp; this.status &lt; 400) {
      // Success!
      var data = JSON.parse(this.responseText);
    } else {
      // Error :(
    }
  }
};

request.send();
request = null;
</code></pre>
            </div>
            <div data-browser="ie9" class="browser ie9" style="display: block;">
              <h4>IE9+</h4>
              <pre><code>var request = new XMLHttpRequest();
request.open('GET', '/my/url', true);

request.onload = function() {
  if (request.status &gt;= 200 &amp;&amp; request.status &lt; 400) {
    // Success!
    var data = JSON.parse(request.responseText);
  } else {
    // We reached our target server, but it returned an error

  }
};

request.onerror = function() {
  // There was a connection error of some sort
};

request.send();
</code></pre>
            </div>
            <div data-browser="ie10" class="browser ie10" style="display: none;">
              <h4>IE10+</h4>
              <pre><code>var request = new XMLHttpRequest();
request.open('GET', '/my/url', true);

request.onload = function() {
  if (this.status &gt;= 200 &amp;&amp; this.status &lt; 400) {
    // Success!
    var data = JSON.parse(this.response);
  } else {
    // We reached our target server, but it returned an error

  }
};

request.onerror = function() {
  // There was a connection error of some sort
};

request.send();
</code></pre>
            </div>
          </div>
          <div id="post" class="comparison">
            <h3><a href="#post">Post</a></h3>
            <div data-browser="jquery" class="browser jquery">
              <h4>jQuery</h4>
              <pre><code>$.ajax({
  type: 'POST',
  url: '/my/url',
  data: data
});
</code></pre>
            </div>
            <div data-browser="ie8" class="browser ie8" style="display: block;">
              <h4>IE8+</h4>
              <pre><code>var request = new XMLHttpRequest();
request.open('POST', '/my/url', true);
request.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded; charset=UTF-8');
request.send(data);
</code></pre>
            </div>
          </div>
          <div id="request" class="comparison">
            <h3><a href="#request">Request</a></h3>
            <div data-browser="jquery" class="browser jquery">
              <h4>jQuery</h4>
              <pre><code>$.ajax({
  type: 'GET',
  url: '/my/url',
  success: function(resp) {

  },
  error: function() {

  }
});
</code></pre>
            </div>
            <div data-browser="ie8" class="browser ie8" style="display: none;">
              <h4>IE8+</h4>
              <pre><code>var request = new XMLHttpRequest();
request.open('GET', '/my/url', true);

request.onreadystatechange = function() {
  if (this.readyState === 4) {
    if (this.status &gt;= 200 &amp;&amp; this.status &lt; 400) {
      // Success!
      var resp = this.responseText;
    } else {
      // Error :(
    }
  }
};

request.send();
request = null;
</code></pre>
            </div>
            <div data-browser="ie9" class="browser ie9" style="display: block;">
              <h4>IE9+</h4>
              <pre><code>var request = new XMLHttpRequest();
request.open('GET', '/my/url', true);

request.onload = function() {
  if (request.status &gt;= 200 &amp;&amp; request.status &lt; 400) {
    // Success!
    var resp = request.responseText;
  } else {
    // We reached our target server, but it returned an error

  }
};

request.onerror = function() {
  // There was a connection error of some sort
};

request.send();
</code></pre>
            </div>
            <div data-browser="ie10" class="browser ie10" style="display: none;">
              <h4>IE10+</h4>
              <pre><code>var request = new XMLHttpRequest();
request.open('GET', '/my/url', true);

request.onload = function() {
  if (this.status &gt;= 200 &amp;&amp; this.status &lt; 400) {
    // Success!
    var resp = this.response;
  } else {
    // We reached our target server, but it returned an error

  }
};

request.onerror = function() {
  // There was a connection error of some sort
};

request.send();
</code></pre>
            </div>
          </div>
        </div>
      </section>
      <section id="effects">
        <div class="inner">
          <h2>Effects</h2>
          <div class="alternatives-block">
            <h4>Alternatives:</h4>
            <ul class="alternatives">
              <li><a href=" http://daneden.github.io/animate.css/" target="_blank">animate.css</a></li>
              <li><a href=" https://github.com/visionmedia/move.js" target="_blank">move.js</a></li>
            </ul>
          </div>
          <div id="fade_in" class="comparison">
            <h3><a href="#fade_in">Fade In</a></h3>
            <div data-browser="jquery" class="browser jquery">
              <h4>jQuery</h4>
              <pre><code>$(el).fadeIn();
</code></pre>
            </div>
            <div data-browser="ie8" class="browser ie8" style="display: none;">
              <h4>IE8+</h4>
              <pre><code>function fadeIn(el) {
  var opacity = 0;

  el.style.opacity = 0;
  el.style.filter = '';

  var last = +new Date();
  var tick = function() {
    opacity += (new Date() - last) / 400;
    el.style.opacity = opacity;
    el.style.filter = 'alpha(opacity=' + (100 * opacity)|0 + ')';

    last = +new Date();

    if (opacity &lt; 1) {
      (window.requestAnimationFrame &amp;&amp; requestAnimationFrame(tick)) || setTimeout(tick, 16);
    }
  };

  tick();
}

fadeIn(el);
</code></pre>
            </div>
            <div data-browser="ie9" class="browser ie9" style="display: block;">
              <h4>IE9+</h4>
              <pre><code>function fadeIn(el) {
  el.style.opacity = 0;

  var last = +new Date();
  var tick = function() {
    el.style.opacity = +el.style.opacity + (new Date() - last) / 400;
    last = +new Date();

    if (+el.style.opacity &lt; 1) {
      (window.requestAnimationFrame &amp;&amp; requestAnimationFrame(tick)) || setTimeout(tick, 16);
    }
  };

  tick();
}

fadeIn(el);
</code></pre>
            </div>
            <div data-browser="ie10" class="browser ie10" style="display: none;">
              <h4>IE10+</h4>
              <pre><code>el.classList.add('show');
el.classList.remove('hide');
</code></pre>
              <pre><code>.show {
  transition: opacity 400ms;
}
.hide {
  opacity: 0;
}
</code></pre>
            </div>
          </div>
          <div id="hide" class="comparison">
            <h3><a href="#hide">Hide</a></h3>
            <div data-browser="jquery" class="browser jquery">
              <h4>jQuery</h4>
              <pre><code>$(el).hide();
</code></pre>
            </div>
            <div data-browser="ie8" class="browser ie8" style="display: block;">
              <h4>IE8+</h4>
              <pre><code>el.style.display = 'none';
</code></pre>
            </div>
          </div>
          <div id="show" class="comparison">
            <h3><a href="#show">Show</a></h3>
            <div data-browser="jquery" class="browser jquery">
              <h4>jQuery</h4>
              <pre><code>$(el).show();
</code></pre>
            </div>
            <div data-browser="ie8" class="browser ie8" style="display: block;">
              <h4>IE8+</h4>
              <pre><code>el.style.display = '';
</code></pre>
            </div>
          </div>
        </div>
      </section>
      <section id="elements" class="odd">
        <div class="inner">
          <h2>Elements</h2>
          <div class="alternatives-block">
            <h4>Alternatives:</h4>
            <ul class="alternatives">
              <li><a href=" https://github.com/ded/bonzo" target="_blank">bonzo</a></li>
              <li><a href=" https://github.com/julienw/dollardom" target="_blank">$dom</a></li>
            </ul>
          </div>
          <div id="add_class" class="comparison">
            <h3><a href="#add_class">Add Class</a></h3>
            <div data-browser="jquery" class="browser jquery">
              <h4>jQuery</h4>
              <pre><code>$(el).addClass(className);
</code></pre>
            </div>
            <div data-browser="ie8" class="browser ie8" style="display: block;">
              <h4>IE8+</h4>
              <pre><code>if (el.classList)
  el.classList.add(className);
else
  el.className += ' ' + className;
</code></pre>
            </div>
            <div data-browser="ie10" class="browser ie10" style="display: none;">
              <h4>IE10+</h4>
              <pre><code>el.classList.add(className);
</code></pre>
            </div>
          </div>
          <div id="after" class="comparison">
            <h3><a href="#after">After</a></h3>
            <div data-browser="jquery" class="browser jquery">
              <h4>jQuery</h4>
              <pre><code>$(el).after(htmlString);
</code></pre>
            </div>
            <div data-browser="ie8" class="browser ie8" style="display: block;">
              <h4>IE8+</h4>
              <pre><code>el.insertAdjacentHTML('afterend', htmlString);
</code></pre>
            </div>
          </div>
          <div id="append" class="comparison">
            <h3><a href="#append">Append</a></h3>
            <div data-browser="jquery" class="browser jquery">
              <h4>jQuery</h4>
              <pre><code>$(parent).append(el);
</code></pre>
            </div>
            <div data-browser="ie8" class="browser ie8" style="display: block;">
              <h4>IE8+</h4>
              <pre><code>parent.appendChild(el);
</code></pre>
            </div>
          </div>
          <div id="before" class="comparison">
            <h3><a href="#before">Before</a></h3>
            <div data-browser="jquery" class="browser jquery">
              <h4>jQuery</h4>
              <pre><code>$(el).before(htmlString);
</code></pre>
            </div>
            <div data-browser="ie8" class="browser ie8" style="display: block;">
              <h4>IE8+</h4>
              <pre><code>el.insertAdjacentHTML('beforebegin', htmlString);
</code></pre>
            </div>
          </div>
          <div id="children" class="comparison">
            <h3><a href="#children">Children</a></h3>
            <div data-browser="jquery" class="browser jquery">
              <h4>jQuery</h4>
              <pre><code>$(el).children();
</code></pre>
            </div>
            <div data-browser="ie8" class="browser ie8" style="display: none;">
              <h4>IE8+</h4>
              <pre><code>var children = [];
for (var i = el.children.length; i--;) {
  // Skip comment nodes on IE8
  if (el.children[i].nodeType != 8)
    children.unshift(el.children[i]);
}
</code></pre>
            </div>
            <div data-browser="ie9" class="browser ie9" style="display: block;">
              <h4>IE9+</h4>
              <pre><code>el.children
</code></pre>
            </div>
          </div>
          <div id="clone" class="comparison">
            <h3><a href="#clone">Clone</a></h3>
            <div data-browser="jquery" class="browser jquery">
              <h4>jQuery</h4>
              <pre><code>$(el).clone();
</code></pre>
            </div>
            <div data-browser="ie8" class="browser ie8" style="display: block;">
              <h4>IE8+</h4>
              <pre><code>el.cloneNode(true);
</code></pre>
            </div>
          </div>
          <div id="contains" class="comparison">
            <h3><a href="#contains">Contains</a></h3>
            <div data-browser="jquery" class="browser jquery">
              <h4>jQuery</h4>
              <pre><code>$.contains(el, child);
</code></pre>
            </div>
            <div data-browser="ie8" class="browser ie8" style="display: block;">
              <h4>IE8+</h4>
              <pre><code>el !== child &amp;&amp; el.contains(child);
</code></pre>
            </div>
          </div>
          <div id="contains_selector" class="comparison">
            <h3><a href="#contains_selector">Contains Selector</a></h3>
            <div data-browser="jquery" class="browser jquery">
              <h4>jQuery</h4>
              <pre><code>$(el).find(selector).length;
</code></pre>
            </div>
            <div data-browser="ie8" class="browser ie8" style="display: block;">
              <h4>IE8+</h4>
              <pre><code>el.querySelector(selector) !== null
</code></pre>
            </div>
          </div>
          <div id="each" class="comparison">
            <h3><a href="#each">Each</a></h3>
            <div data-browser="jquery" class="browser jquery">
              <h4>jQuery</h4>
              <pre><code>$(selector).each(function(i, el){

});
</code></pre>
            </div>
            <div data-browser="ie8" class="browser ie8" style="display: none;">
              <h4>IE8+</h4>
              <pre><code>function forEachElement(selector, fn) {
  var elements = document.querySelectorAll(selector);
  for (var i = 0; i &lt; elements.length; i++)
    fn(elements[i], i);
}

forEachElement(selector, function(el, i){

});
</code></pre>
            </div>
            <div data-browser="ie9" class="browser ie9" style="display: block;">
              <h4>IE9+</h4>
              <pre><code>var elements = document.querySelectorAll(selector);
Array.prototype.forEach.call(elements, function(el, i){

});
</code></pre>
            </div>
          </div>
          <div id="empty" class="comparison">
            <h3><a href="#empty">Empty</a></h3>
            <div data-browser="jquery" class="browser jquery">
              <h4>jQuery</h4>
              <pre><code>$(el).empty();
</code></pre>
            </div>
            <div data-browser="ie8" class="browser ie8" style="display: none;">
              <h4>IE8+</h4>
              <pre><code>while(el.firstChild)
  el.removeChild(el.firstChild);
</code></pre>
            </div>
            <div data-browser="ie9" class="browser ie9" style="display: block;">
              <h4>IE9+</h4>
              <pre><code>el.innerHTML = '';
</code></pre>
            </div>
          </div>
          <div id="filter" class="comparison">
            <h3><a href="#filter">Filter</a></h3>
            <div data-browser="jquery" class="browser jquery">
              <h4>jQuery</h4>
              <pre><code>$(selector).filter(filterFn);
</code></pre>
            </div>
            <div data-browser="ie8" class="browser ie8" style="display: none;">
              <h4>IE8+</h4>
              <pre><code>function filter(selector, filterFn) {
  var elements = document.querySelectorAll(selector);
  var out = [];
  for (var i = elements.length; i--;) {
    if (filterFn(elements[i]))
      out.unshift(elements[i]);
  }
  return out;
}

filter(selector, filterFn);
</code></pre>
            </div>
            <div data-browser="ie9" class="browser ie9" style="display: block;">
              <h4>IE9+</h4>
              <pre><code>Array.prototype.filter.call(document.querySelectorAll(selector), filterFn);
</code></pre>
            </div>
          </div>
          <div id="find_children" class="comparison">
            <h3><a href="#find_children">Find Children</a></h3>
            <div data-browser="jquery" class="browser jquery">
              <h4>jQuery</h4>
              <pre><code>$(el).find(selector);
</code></pre>
            </div>
            <div data-browser="ie8" class="browser ie8" style="display: block;">
              <h4>IE8+</h4>
              <pre><code>el.querySelectorAll(selector);
</code></pre>
            </div>
          </div>
          <div id="find_elements" class="comparison">
            <h3><a href="#find_elements">Find Elements</a></h3>
            <div class="alternatives-block">
              <h4>Alternatives:</h4>
              <ul class="alternatives">
                <li><a href=" https://github.com/ded/qwery" target="_blank">qwery</a></li>
                <li><a href=" http://sizzlejs.com/" target="_blank">sizzle</a></li>
              </ul>
            </div>
            <div data-browser="jquery" class="browser jquery">
              <h4>jQuery</h4>
              <pre><code>$('.my #awesome selector');
</code></pre>
            </div>
            <div data-browser="ie8" class="browser ie8" style="display: block;">
              <h4>IE8+</h4>
              <pre><code>document.querySelectorAll('.my #awesome selector');
</code></pre>
            </div>
          </div>
          <div id="get_attributes" class="comparison">
            <h3><a href="#get_attributes">Get Attributes</a></h3>
            <div data-browser="jquery" class="browser jquery">
              <h4>jQuery</h4>
              <pre><code>$(el).attr('tabindex');
</code></pre>
            </div>
            <div data-browser="ie8" class="browser ie8" style="display: block;">
              <h4>IE8+</h4>
              <pre><code>el.getAttribute('tabindex');
</code></pre>
            </div>
          </div>
          <div id="get_html" class="comparison">
            <h3><a href="#get_html">Get Html</a></h3>
            <div data-browser="jquery" class="browser jquery">
              <h4>jQuery</h4>
              <pre><code>$(el).html();
</code></pre>
            </div>
            <div data-browser="ie8" class="browser ie8" style="display: block;">
              <h4>IE8+</h4>
              <pre><code>el.innerHTML
</code></pre>
            </div>
          </div>
          <div id="get_outer_html" class="comparison">
            <h3><a href="#get_outer_html">Get Outer Html</a></h3>
            <div data-browser="jquery" class="browser jquery">
              <h4>jQuery</h4>
              <pre><code>$('<div>').append($(el).clone()).html();
</div></code></pre>
            </div>
            <div data-browser="ie8" class="browser ie8" style="display: block;">
              <h4>IE8+</h4>
              <pre><code>el.outerHTML
</code></pre>
            </div>
          </div>
          <div id="get_style" class="comparison">
            <h3><a href="#get_style">Get Style</a></h3>
            <div data-browser="jquery" class="browser jquery">
              <h4>jQuery</h4>
              <pre><code>$(el).css(ruleName);
</code></pre>
            </div>
            <div data-browser="ie8" class="browser ie8" style="display: none;">
              <h4>IE8+</h4>
              <pre><code>// Varies based on the properties being retrieved, some can be retrieved from el.currentStyle
// https://github.com/jonathantneal/Polyfills-for-IE8/blob/master/getComputedStyle.js
</code></pre>
            </div>
            <div data-browser="ie9" class="browser ie9" style="display: block;">
              <h4>IE9+</h4>
              <pre><code>getComputedStyle(el)[ruleName];
</code></pre>
            </div>
          </div>
          <div id="get_text" class="comparison">
            <h3><a href="#get_text">Get Text</a></h3>
            <div data-browser="jquery" class="browser jquery">
              <h4>jQuery</h4>
              <pre><code>$(el).text();
</code></pre>
            </div>
            <div data-browser="ie8" class="browser ie8" style="display: none;">
              <h4>IE8+</h4>
              <pre><code>el.textContent || el.innerText
</code></pre>
            </div>
            <div data-browser="ie9" class="browser ie9" style="display: block;">
              <h4>IE9+</h4>
              <pre><code>el.textContent
</code></pre>
            </div>
          </div>
          <div id="has_class" class="comparison">
            <h3><a href="#has_class">Has Class</a></h3>
            <div data-browser="jquery" class="browser jquery">
              <h4>jQuery</h4>
              <pre><code>$(el).hasClass(className);
</code></pre>
            </div>
            <div data-browser="ie8" class="browser ie8" style="display: block;">
              <h4>IE8+</h4>
              <pre><code>if (el.classList)
  el.classList.contains(className);
else
  new RegExp('(^| )' + className + '( |$)', 'gi').test(el.className);
</code></pre>
            </div>
            <div data-browser="ie10" class="browser ie10" style="display: none;">
              <h4>IE10+</h4>
              <pre><code>el.classList.contains(className);
</code></pre>
            </div>
          </div>
          <div id="matches" class="comparison">
            <h3><a href="#matches">Matches</a></h3>
            <div data-browser="jquery" class="browser jquery">
              <h4>jQuery</h4>
              <pre><code>$(el).is($(otherEl));
</code></pre>
            </div>
            <div data-browser="ie8" class="browser ie8" style="display: block;">
              <h4>IE8+</h4>
              <pre><code>el === otherEl
</code></pre>
            </div>
          </div>
          <div id="matches_selector" class="comparison">
            <h3><a href="#matches_selector">Matches Selector</a></h3>
            <div data-browser="jquery" class="browser jquery">
              <h4>jQuery</h4>
              <pre><code>$(el).is('.my-class');
</code></pre>
            </div>
            <div data-browser="ie8" class="browser ie8" style="display: none;">
              <h4>IE8+</h4>
              <pre><code>var matches = function(el, selector) {
  var _matches = (el.matches || el.matchesSelector || el.msMatchesSelector || el.mozMatchesSelector || el.webkitMatchesSelector || el.oMatchesSelector);

  if (_matches) {
    return _matches.call(el, selector);
  } else {
    var nodes = el.parentNode.querySelectorAll(selector);
    for (var i = nodes.length; i--;) {
      if (nodes[i] === el)
        return true;
    }
    return false;
  }
};

matches(el, '.my-class');
</code></pre>
            </div>
            <div data-browser="ie9" class="browser ie9" style="display: block;">
              <h4>IE9+</h4>
              <pre><code>var matches = function(el, selector) {
  return (el.matches || el.matchesSelector || el.msMatchesSelector || el.mozMatchesSelector || el.webkitMatchesSelector || el.oMatchesSelector).call(el, selector);
};

matches(el, '.my-class');
</code></pre>
            </div>
          </div>
          <div id="next" class="comparison">
            <h3><a href="#next">Next</a></h3>
            <div data-browser="jquery" class="browser jquery">
              <h4>jQuery</h4>
              <pre><code>$(el).next();
</code></pre>
            </div>
            <div data-browser="ie8" class="browser ie8" style="display: none;">
              <h4>IE8+</h4>
              <pre><code>// nextSibling can include text nodes
function nextElementSibling(el) {
  do { el = el.nextSibling; } while ( el &amp;&amp; el.nodeType !== 1 );
  return el;
}

el.nextElementSibling || nextElementSibling(el);
</code></pre>
            </div>
            <div data-browser="ie9" class="browser ie9" style="display: block;">
              <h4>IE9+</h4>
              <pre><code>el.nextElementSibling
</code></pre>
            </div>
          </div>
          <div id="offset" class="comparison">
            <h3><a href="#offset">Offset</a></h3>
            <div data-browser="jquery" class="browser jquery">
              <h4>jQuery</h4>
              <pre><code>$(el).offset();
</code></pre>
            </div>
            <div data-browser="ie8" class="browser ie8" style="display: block;">
              <h4>IE8+</h4>
              <pre><code>var rect = el.getBoundingClientRect();

{
  top: rect.top + document.body.scrollTop,
  left: rect.left + document.body.scrollLeft
}
</code></pre>
            </div>
          </div>
          <div id="offset_parent" class="comparison">
            <h3><a href="#offset_parent">Offset Parent</a></h3>
            <div data-browser="jquery" class="browser jquery">
              <h4>jQuery</h4>
              <pre><code>$(el).offsetParent();
</code></pre>
            </div>
            <div data-browser="ie8" class="browser ie8" style="display: block;">
              <h4>IE8+</h4>
              <pre><code>el.offsetParent || el
</code></pre>
            </div>
          </div>
          <div id="outer_height" class="comparison">
            <h3><a href="#outer_height">Outer Height</a></h3>
            <div data-browser="jquery" class="browser jquery">
              <h4>jQuery</h4>
              <pre><code>$(el).outerHeight();
</code></pre>
            </div>
            <div data-browser="ie8" class="browser ie8" style="display: block;">
              <h4>IE8+</h4>
              <pre><code>el.offsetHeight
</code></pre>
            </div>
          </div>
          <div id="outer_height_with_margin" class="comparison">
            <h3><a href="#outer_height_with_margin">Outer Height With Margin</a></h3>
            <div data-browser="jquery" class="browser jquery">
              <h4>jQuery</h4>
              <pre><code>$(el).outerHeight(true);
</code></pre>
            </div>
            <div data-browser="ie8" class="browser ie8" style="display: none;">
              <h4>IE8+</h4>
              <pre><code>function outerHeight(el) {
  var height = el.offsetHeight;
  var style = el.currentStyle || getComputedStyle(el);

  height += parseInt(style.marginTop) + parseInt(style.marginBottom);
  return height;
}

outerHeight(el);
</code></pre>
            </div>
            <div data-browser="ie9" class="browser ie9" style="display: block;">
              <h4>IE9+</h4>
              <pre><code>function outerHeight(el) {
  var height = el.offsetHeight;
  var style = getComputedStyle(el);

  height += parseInt(style.marginTop) + parseInt(style.marginBottom);
  return height;
}

outerHeight(el);
</code></pre>
            </div>
          </div>
          <div id="outer_width" class="comparison">
            <h3><a href="#outer_width">Outer Width</a></h3>
            <div data-browser="jquery" class="browser jquery">
              <h4>jQuery</h4>
              <pre><code>$(el).outerWidth();
</code></pre>
            </div>
            <div data-browser="ie8" class="browser ie8" style="display: block;">
              <h4>IE8+</h4>
              <pre><code>el.offsetWidth
</code></pre>
            </div>
          </div>
          <div id="outer_width_with_margin" class="comparison">
            <h3><a href="#outer_width_with_margin">Outer Width With Margin</a></h3>
            <div data-browser="jquery" class="browser jquery">
              <h4>jQuery</h4>
              <pre><code>$(el).outerWidth(true);
</code></pre>
            </div>
            <div data-browser="ie8" class="browser ie8" style="display: none;">
              <h4>IE8+</h4>
              <pre><code>function outerWidth(el) {
  var width = el.offsetWidth;
  var style = el.currentStyle || getComputedStyle(el);

  width += parseInt(style.marginLeft) + parseInt(style.marginRight);
  return width;
}

outerWidth(el);
</code></pre>
            </div>
            <div data-browser="ie9" class="browser ie9" style="display: block;">
              <h4>IE9+</h4>
              <pre><code>function outerWidth(el) {
  var width = el.offsetWidth;
  var style = getComputedStyle(el);

  width += parseInt(style.marginLeft) + parseInt(style.marginRight);
  return width;
}

outerWidth(el);
</code></pre>
            </div>
          </div>
          <div id="parent" class="comparison">
            <h3><a href="#parent">Parent</a></h3>
            <div data-browser="jquery" class="browser jquery">
              <h4>jQuery</h4>
              <pre><code>$(el).parent();
</code></pre>
            </div>
            <div data-browser="ie8" class="browser ie8" style="display: block;">
              <h4>IE8+</h4>
              <pre><code>el.parentNode
</code></pre>
            </div>
          </div>
          <div id="position" class="comparison">
            <h3><a href="#position">Position</a></h3>
            <div data-browser="jquery" class="browser jquery">
              <h4>jQuery</h4>
              <pre><code>$(el).position();
</code></pre>
            </div>
            <div data-browser="ie8" class="browser ie8" style="display: block;">
              <h4>IE8+</h4>
              <pre><code>{left: el.offsetLeft, top: el.offsetTop}
</code></pre>
            </div>
          </div>
          <div id="position_relative_to_viewport" class="comparison">
            <h3><a href="#position_relative_to_viewport">Position Relative To Viewport</a></h3>
            <div data-browser="jquery" class="browser jquery">
              <h4>jQuery</h4>
              <pre><code>var offset = el.offset();

{
  top: offset.top - document.body.scrollTop,
  left: offset.left - document.body.scrollLeft
}
</code></pre>
            </div>
            <div data-browser="ie8" class="browser ie8" style="display: block;">
              <h4>IE8+</h4>
              <pre><code>el.getBoundingClientRect()
</code></pre>
            </div>
          </div>
          <div id="prepend" class="comparison">
            <h3><a href="#prepend">Prepend</a></h3>
            <div data-browser="jquery" class="browser jquery">
              <h4>jQuery</h4>
              <pre><code>$(parent).prepend(el);
</code></pre>
            </div>
            <div data-browser="ie8" class="browser ie8" style="display: block;">
              <h4>IE8+</h4>
              <pre><code>parent.insertBefore(el, parent.firstChild);
</code></pre>
            </div>
          </div>
          <div id="prev" class="comparison">
            <h3><a href="#prev">Prev</a></h3>
            <div data-browser="jquery" class="browser jquery">
              <h4>jQuery</h4>
              <pre><code>$(el).prev();
</code></pre>
            </div>
            <div data-browser="ie8" class="browser ie8" style="display: none;">
              <h4>IE8+</h4>
              <pre><code>// prevSibling can include text nodes
function previousElementSibling(el) {
  do { el = el.previousSibling; } while ( el &amp;&amp; el.nodeType !== 1 );
  return el;
}

el.previousElementSibling || previousElementSibling(el);
</code></pre>
            </div>
            <div data-browser="ie9" class="browser ie9" style="display: block;">
              <h4>IE9+</h4>
              <pre><code>el.previousElementSibling
</code></pre>
            </div>
          </div>
          <div id="remove" class="comparison">
            <h3><a href="#remove">Remove</a></h3>
            <div data-browser="jquery" class="browser jquery">
              <h4>jQuery</h4>
              <pre><code>$(el).remove();
</code></pre>
            </div>
            <div data-browser="ie8" class="browser ie8" style="display: block;">
              <h4>IE8+</h4>
              <pre><code>el.parentNode.removeChild(el);
</code></pre>
            </div>
          </div>
          <div id="remove_class" class="comparison">
            <h3><a href="#remove_class">Remove Class</a></h3>
            <div data-browser="jquery" class="browser jquery">
              <h4>jQuery</h4>
              <pre><code>$(el).removeClass(className);
</code></pre>
            </div>
            <div data-browser="ie8" class="browser ie8" style="display: block;">
              <h4>IE8+</h4>
              <pre><code>if (el.classList)
  el.classList.remove(className);
else
  el.className = el.className.replace(new RegExp('(^|\\b)' + className.split(' ').join('|') + '(\\b|$)', 'gi'), ' ');
</code></pre>
            </div>
            <div data-browser="ie10" class="browser ie10" style="display: none;">
              <h4>IE10+</h4>
              <pre><code>el.classList.remove(className);
</code></pre>
            </div>
          </div>
          <div id="replace_from_html" class="comparison">
            <h3><a href="#replace_from_html">Replace From Html</a></h3>
            <div data-browser="jquery" class="browser jquery">
              <h4>jQuery</h4>
              <pre><code>$(el).replaceWith(string);
</code></pre>
            </div>
            <div data-browser="ie8" class="browser ie8" style="display: block;">
              <h4>IE8+</h4>
              <pre><code>el.outerHTML = string;
</code></pre>
            </div>
          </div>
          <div id="set_attributes" class="comparison">
            <h3><a href="#set_attributes">Set Attributes</a></h3>
            <div data-browser="jquery" class="browser jquery">
              <h4>jQuery</h4>
              <pre><code>$(el).attr('tabindex', 3);
</code></pre>
            </div>
            <div data-browser="ie8" class="browser ie8" style="display: block;">
              <h4>IE8+</h4>
              <pre><code>el.setAttribute('tabindex', 3);
</code></pre>
            </div>
          </div>
          <div id="set_html" class="comparison">
            <h3><a href="#set_html">Set Html</a></h3>
            <div data-browser="jquery" class="browser jquery">
              <h4>jQuery</h4>
              <pre><code>$(el).html(string);
</code></pre>
            </div>
            <div data-browser="ie8" class="browser ie8" style="display: block;">
              <h4>IE8+</h4>
              <pre><code>el.innerHTML = string;
</code></pre>
            </div>
          </div>
          <div id="set_style" class="comparison">
            <h3><a href="#set_style">Set Style</a></h3>
            <div data-browser="jquery" class="browser jquery">
              <h4>jQuery</h4>
              <pre><code>$(el).css('border-width', '20px');
</code></pre>
            </div>
            <div data-browser="ie8" class="browser ie8" style="display: block;">
              <h4>IE8+</h4>
              <pre><code>// Use a class if possible
el.style.borderWidth = '20px';
</code></pre>
            </div>
          </div>
          <div id="set_text" class="comparison">
            <h3><a href="#set_text">Set Text</a></h3>
            <div data-browser="jquery" class="browser jquery">
              <h4>jQuery</h4>
              <pre><code>$(el).text(string);
</code></pre>
            </div>
            <div data-browser="ie8" class="browser ie8" style="display: none;">
              <h4>IE8+</h4>
              <pre><code>if (el.textContent !== undefined)
  el.textContent = string;
else
  el.innerText = string;
</code></pre>
            </div>
            <div data-browser="ie9" class="browser ie9" style="display: block;">
              <h4>IE9+</h4>
              <pre><code>el.textContent = string;
</code></pre>
            </div>
          </div>
          <div id="siblings" class="comparison">
            <h3><a href="#siblings">Siblings</a></h3>
            <div data-browser="jquery" class="browser jquery">
              <h4>jQuery</h4>
              <pre><code>$(el).siblings();
</code></pre>
            </div>
            <div data-browser="ie8" class="browser ie8" style="display: none;">
              <h4>IE8+</h4>
              <pre><code>var siblings = Array.prototype.slice.call(el.parentNode.children);

for (var i = siblings.length; i--;) {
  if (siblings[i] === el) {
    siblings.splice(i, 1);
    break;
  }
}
</code></pre>
            </div>
            <div data-browser="ie9" class="browser ie9" style="display: block;">
              <h4>IE9+</h4>
              <pre><code>Array.prototype.filter.call(el.parentNode.children, function(child){
  return child !== el;
});
</code></pre>
            </div>
          </div>
          <div id="toggle_class" class="comparison">
            <h3><a href="#toggle_class">Toggle Class</a></h3>
            <div data-browser="jquery" class="browser jquery">
              <h4>jQuery</h4>
              <pre><code>$(el).toggleClass(className);
</code></pre>
            </div>
            <div data-browser="ie8" class="browser ie8" style="display: none;">
              <h4>IE8+</h4>
              <pre><code>if (el.classList) {
  el.classList.toggle(className);
} else {
    var classes = el.className.split(' ');
    var existingIndex = -1;
    for (var i = classes.length; i--;) {
      if (classes[i] === className)
        existingIndex = i;
    }

    if (existingIndex &gt;= 0)
      classes.splice(existingIndex, 1);
    else
      classes.push(className);

  el.className = classes.join(' ');
}
</code></pre>
            </div>
            <div data-browser="ie9" class="browser ie9" style="display: block;">
              <h4>IE9+</h4>
              <pre><code>if (el.classList) {
  el.classList.toggle(className);
} else {
  var classes = el.className.split(' ');
  var existingIndex = classes.indexOf(className);

  if (existingIndex &gt;= 0)
    classes.splice(existingIndex, 1);
  else
    classes.push(className);

  el.className = classes.join(' ');
}
</code></pre>
            </div>
            <div data-browser="ie10" class="browser ie10" style="display: none;">
              <h4>IE10+</h4>
              <pre><code>el.classList.toggle(className);
</code></pre>
            </div>
          </div>
        </div>
      </section>
      <section id="events">
        <div class="inner">
          <h2>Events</h2>
          <div id="off" class="comparison">
            <h3><a href="#off">Off</a></h3>
            <div data-browser="jquery" class="browser jquery">
              <h4>jQuery</h4>
              <pre><code>$(el).off(eventName, eventHandler);
</code></pre>
            </div>
            <div data-browser="ie8" class="browser ie8" style="display: none;">
              <h4>IE8+</h4>
              <pre><code>function removeEventListener(el, eventName, handler) {
  if (el.removeEventListener)
    el.removeEventListener(eventName, handler);
  else
    el.detachEvent('on' + eventName, handler);
}

removeEventListener(el, eventName, handler);
</code></pre>
            </div>
            <div data-browser="ie9" class="browser ie9" style="display: block;">
              <h4>IE9+</h4>
              <pre><code>el.removeEventListener(eventName, eventHandler);
</code></pre>
            </div>
          </div>
          <div id="on" class="comparison">
            <h3><a href="#on">On</a></h3>
            <div data-browser="jquery" class="browser jquery">
              <h4>jQuery</h4>
              <pre><code>$(el).on(eventName, eventHandler);
</code></pre>
            </div>
            <div data-browser="ie8" class="browser ie8" style="display: none;">
              <h4>IE8+</h4>
              <pre><code>function addEventListener(el, eventName, handler) {
  if (el.addEventListener) {
    el.addEventListener(eventName, handler);
  } else {
    el.attachEvent('on' + eventName, function(){
      handler.call(el);
    });
  }
}

addEventListener(el, eventName, handler);
</code></pre>
            </div>
            <div data-browser="ie9" class="browser ie9" style="display: block;">
              <h4>IE9+</h4>
              <pre><code>el.addEventListener(eventName, eventHandler);
</code></pre>
            </div>
          </div>
          <div id="ready" class="comparison">
            <h3><a href="#ready">Ready</a></h3>
            <div data-browser="jquery" class="browser jquery">
              <h4>jQuery</h4>
              <pre><code>$(document).ready(function(){

});
</code></pre>
            </div>
            <div data-browser="ie8" class="browser ie8" style="display: none;">
              <h4>IE8+</h4>
              <pre><code>function ready(fn) {
  if (document.readyState != 'loading'){
    fn();
  } else if (document.addEventListener) {
    document.addEventListener('DOMContentLoaded', fn);
  } else {
    document.attachEvent('onreadystatechange', function() {
      if (document.readyState != 'loading')
        fn();
    });
  }
}
</code></pre>
            </div>
            <div data-browser="ie9" class="browser ie9" style="display: block;">
              <h4>IE9+</h4>
              <pre><code>function ready(fn) {
  if (document.readyState != 'loading'){
    fn();
  } else {
    document.addEventListener('DOMContentLoaded', fn);
  }
}
</code></pre>
            </div>
          </div>
          <div id="trigger_custom" class="comparison">
            <h3><a href="#trigger_custom">Trigger Custom</a></h3>
            <div class="alternatives-block">
              <h4>Alternatives:</h4>
              <ul class="alternatives">
                <li><a href=" https://github.com/Wolfy87/EventEmitter" target="_blank">EventEmitter</a></li>
                <li><a href=" https://github.com/arextar/Vine" target="_blank">Vine</a></li>
                <li><a href=" https://github.com/jeromeetienne/microevent.js" target="_blank">microevent</a></li>
              </ul>
            </div>
            <div data-browser="jquery" class="browser jquery">
              <h4>jQuery</h4>
              <pre><code>$(el).trigger('my-event', {some: 'data'});
</code></pre>
            </div>
            <div data-browser="ie8" class="browser ie8" style="display: none;">
              <h4>IE8+</h4>
              <pre><code>// Custom events are not natively supported, so you have to hijack a random
// event.
//
// Just use jQuery.
</code></pre>
            </div>
            <div data-browser="ie9" class="browser ie9" style="display: block;">
              <h4>IE9+</h4>
              <pre><code>if (window.CustomEvent) {
  var event = new CustomEvent('my-event', {detail: {some: 'data'}});
} else {
  var event = document.createEvent('CustomEvent');
  event.initCustomEvent('my-event', true, true, {some: 'data'});
}

el.dispatchEvent(event);
</code></pre>
            </div>
          </div>
          <div id="trigger_native" class="comparison">
            <h3><a href="#trigger_native">Trigger Native</a></h3>
            <div data-browser="jquery" class="browser jquery">
              <h4>jQuery</h4>
              <pre><code>$(el).trigger('change');
</code></pre>
            </div>
            <div data-browser="ie8" class="browser ie8" style="display: none;">
              <h4>IE8+</h4>
              <pre><code>if (document.createEvent) {
  var event = document.createEvent('HTMLEvents');
  event.initEvent('change', true, false);
  el.dispatchEvent(event);
} else {
  el.fireEvent('onchange');
}
</code></pre>
            </div>
            <div data-browser="ie9" class="browser ie9" style="display: block;">
              <h4>IE9+</h4>
              <pre><code>// For a full list of event types: https://developer.mozilla.org/en-US/docs/Web/API/document.createEvent
var event = document.createEvent('HTMLEvents');
event.initEvent('change', true, false);
el.dispatchEvent(event);
</code></pre>
            </div>
          </div>
        </div>
      </section>
      <section id="utils" class="odd">
        <div class="inner">
          <h2>Utils</h2>
          <div id="bind" class="comparison">
            <h3><a href="#bind">Bind</a></h3>
            <div data-browser="jquery" class="browser jquery">
              <h4>jQuery</h4>
              <pre><code>$.proxy(fn, context);
</code></pre>
            </div>
            <div data-browser="ie8" class="browser ie8" style="display: none;">
              <h4>IE8+</h4>
              <pre><code>fn.apply(context, arguments);
</code></pre>
            </div>
            <div data-browser="ie9" class="browser ie9" style="display: block;">
              <h4>IE9+</h4>
              <pre><code>fn.bind(context);
</code></pre>
            </div>
          </div>
          <div id="array_each" class="comparison">
            <h3><a href="#array_each">Array Each</a></h3>
            <div data-browser="jquery" class="browser jquery">
              <h4>jQuery</h4>
              <pre><code>$.each(array, function(i, item){

});
</code></pre>
            </div>
            <div data-browser="ie8" class="browser ie8" style="display: none;">
              <h4>IE8+</h4>
              <pre><code>function forEach(array, fn) {
  for (var i = 0; i &lt; array.length; i++)
    fn(array[i], i);
}

forEach(array, function(item, i){

});
</code></pre>
            </div>
            <div data-browser="ie9" class="browser ie9" style="display: block;">
              <h4>IE9+</h4>
              <pre><code>array.forEach(function(item, i){

});
</code></pre>
            </div>
          </div>
          <div id="deep_extend" class="comparison">
            <h3><a href="#deep_extend">Deep Extend</a></h3>
            <div data-browser="jquery" class="browser jquery">
              <h4>jQuery</h4>
              <pre><code>$.extend(true, {}, objA, objB);
</code></pre>
            </div>
            <div data-browser="ie8" class="browser ie8" style="display: block;">
              <h4>IE8+</h4>
              <pre><code>var deepExtend = function(out) {
  out = out || {};

  for (var i = 1; i &lt; arguments.length; i++) {
    var obj = arguments[i];

    if (!obj)
      continue;

    for (var key in obj) {
      if (obj.hasOwnProperty(key)) {
        if (typeof obj[key] === 'object')
          out[key] = deepExtend(out[key], obj[key]);
        else
          out[key] = obj[key];
      }
    }
  }

  return out;
};

deepExtend({}, objA, objB);
</code></pre>
            </div>
          </div>
          <div id="extend" class="comparison">
            <h3><a href="#extend">Extend</a></h3>
            <div class="alternatives-block">
              <h4>Alternatives:</h4>
              <ul class="alternatives">
                <li><a href=" http://lodash.com/docs#assign" target="_blank">lo-dash</a></li>
                <li><a href=" http://underscorejs.org/#extend" target="_blank">underscore</a></li>
                <li><a href=" http://www.2ality.com/2014/01/object-assign.html" target="_blank">ECMA6</a></li>
              </ul>
            </div>
            <div data-browser="jquery" class="browser jquery">
              <h4>jQuery</h4>
              <pre><code>$.extend({}, objA, objB);
</code></pre>
            </div>
            <div data-browser="ie8" class="browser ie8" style="display: block;">
              <h4>IE8+</h4>
              <pre><code>var extend = function(out) {
  out = out || {};

  for (var i = 1; i &lt; arguments.length; i++) {
    if (!arguments[i])
      continue;

    for (var key in arguments[i]) {
      if (arguments[i].hasOwnProperty(key))
        out[key] = arguments[i][key];
    }
  }

  return out;
};

extend({}, objA, objB);
</code></pre>
            </div>
          </div>
          <div id="index_of" class="comparison">
            <h3><a href="#index_of">Index Of</a></h3>
            <div data-browser="jquery" class="browser jquery">
              <h4>jQuery</h4>
              <pre><code>$.inArray(item, array);
</code></pre>
            </div>
            <div data-browser="ie8" class="browser ie8" style="display: none;">
              <h4>IE8+</h4>
              <pre><code>function indexOf(array, item) {
  for (var i = 0; i &lt; array.length; i++) {
    if (array[i] === item)
      return i;
  }
  return -1;
}

indexOf(array, item);
</code></pre>
            </div>
            <div data-browser="ie9" class="browser ie9" style="display: block;">
              <h4>IE9+</h4>
              <pre><code>array.indexOf(item);
</code></pre>
            </div>
          </div>
          <div id="is_array" class="comparison">
            <h3><a href="#is_array">Is Array</a></h3>
            <div data-browser="jquery" class="browser jquery">
              <h4>jQuery</h4>
              <pre><code>$.isArray(arr);
</code></pre>
            </div>
            <div data-browser="ie8" class="browser ie8" style="display: none;">
              <h4>IE8+</h4>
              <pre><code>isArray = Array.isArray || function(arr) {
  return Object.prototype.toString.call(arr) == '[object Array]';
};

isArray(arr);
</code></pre>
            </div>
            <div data-browser="ie9" class="browser ie9" style="display: block;">
              <h4>IE9+</h4>
              <pre><code>Array.isArray(arr);
</code></pre>
            </div>
          </div>
          <div id="map" class="comparison">
            <h3><a href="#map">Map</a></h3>
            <div data-browser="jquery" class="browser jquery">
              <h4>jQuery</h4>
              <pre><code>$.map(array, function(value, index){

});
</code></pre>
            </div>
            <div data-browser="ie8" class="browser ie8" style="display: none;">
              <h4>IE8+</h4>
              <pre><code>function map(arr, fn) {
  var results = [];
  for (var i = 0; i &lt; arr.length; i++)
    results.push(fn(arr[i], i));
  return results;
}

map(array, function(value, index){

});
</code></pre>
            </div>
            <div data-browser="ie9" class="browser ie9" style="display: block;">
              <h4>IE9+</h4>
              <pre><code>array.map(function(value, index){

});
</code></pre>
            </div>
          </div>
          <div id="now" class="comparison">
            <h3><a href="#now">Now</a></h3>
            <div data-browser="jquery" class="browser jquery">
              <h4>jQuery</h4>
              <pre><code>$.now();
</code></pre>
            </div>
            <div data-browser="ie8" class="browser ie8" style="display: none;">
              <h4>IE8+</h4>
              <pre><code>new Date().getTime();
</code></pre>
            </div>
            <div data-browser="ie9" class="browser ie9" style="display: block;">
              <h4>IE9+</h4>
              <pre><code>Date.now();
</code></pre>
            </div>
          </div>
          <div id="parse_html" class="comparison">
            <h3><a href="#parse_html">Parse Html</a></h3>
            <div data-browser="jquery" class="browser jquery">
              <h4>jQuery</h4>
              <pre><code>$.parseHTML(htmlString);
</code></pre>
            </div>
            <div data-browser="ie8" class="browser ie8" style="display: none;">
              <h4>IE8+</h4>
              <pre><code>var parseHTML = function(str) {
  var el = document.createElement('div');
  el.innerHTML = str;
  return el.children;
};

parseHTML(htmlString);
</code></pre>
            </div>
            <div data-browser="ie9" class="browser ie9" style="display: block;">
              <h4>IE9+</h4>
              <pre><code>var parseHTML = function(str) {
  var tmp = document.implementation.createHTMLDocument();
  tmp.body.innerHTML = str;
  return tmp.body.children;
};

parseHTML(htmlString);
</code></pre>
            </div>
          </div>
          <div id="parse_json" class="comparison">
            <h3><a href="#parse_json">Parse Json</a></h3>
            <div data-browser="jquery" class="browser jquery">
              <h4>jQuery</h4>
              <pre><code>$.parseJSON(string);
</code></pre>
            </div>
            <div data-browser="ie8" class="browser ie8" style="display: block;">
              <h4>IE8+</h4>
              <pre><code>JSON.parse(string);
</code></pre>
            </div>
          </div>
          <div id="trim" class="comparison">
            <h3><a href="#trim">Trim</a></h3>
            <div data-browser="jquery" class="browser jquery">
              <h4>jQuery</h4>
              <pre><code>$.trim(string);
</code></pre>
            </div>
            <div data-browser="ie8" class="browser ie8" style="display: none;">
              <h4>IE8+</h4>
              <pre><code>string.replace(/^\s+|\s+$/g, '');
</code></pre>
            </div>
            <div data-browser="ie9" class="browser ie9" style="display: block;">
              <h4>IE9+</h4>
              <pre><code>string.trim();
</code></pre>
            </div>
          </div>
          <div id="type" class="comparison">
            <h3><a href="#type">Type</a></h3>
            <div data-browser="jquery" class="browser jquery">
              <h4>jQuery</h4>
              <pre><code>$.type(obj);
</code></pre>
            </div>
            <div data-browser="ie8" class="browser ie8" style="display: block;">
              <h4>IE8+</h4>
              <pre><code>Object.prototype.toString.call(obj).replace(/^\[object (.+)\]$/, '$1').toLowerCase();
</code></pre>
            </div>
          </div>
        </div>
      </section>
    </div>
					</div>
				</article>
				<!--================= END :: Tutorial =================-->
				
				<!--================= START :: Tutorial =================-->
				<article>
					<a id="t-25" name="t-25"></a><h1>25 : The JavaScript Bind Function</h1>
					<span class="ref-site">http://blakeembrey.com/articles/2013/12/javascript-bind-function/</span>
					<div class="tutorial__content">
<article class="content article"><p>The JavaScript <code>bind</code> function is a common-place utility when working with many different frameworks and libraries. It's purpose is to bind the <code>this</code> value to a static object and is useful when passing functions around as callbacks, where maintaining the correct <code>this</code> value is required. A common convention to circumvent this utility is the <code>var that = this</code>, but this isn't very feasible everywhere.</p>
<p>In <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function/bind">modern JavaScript implementations</a> the function is built directly onto <code>Function.prototype</code>, giving us <code>bind</code> functionality on every function. For our implementation we'll be implementing a standalone functionality that works similar to the built-in <code>bind</code> function.</p>
<p>However, it's important to note that <code>bind</code> also comes with another handy feature. It accepts an unlimited number of arguments after the context to pass in as the function parameters, from left to right.</p>
<pre><code>var __slice = Array.prototype.slice;

/**
 * Bind a function to a certain context.
 *
 * @param  {Function} fn
 * @param  {Object}   context
 * @param  {*}        ...
 * @return {Function}
 */
var bind = function (fn, context /*, ...args */) {
  var args = __slice.call(arguments, 2);
  
  return function () {
    return fn.apply(context, args.concat(__slice.call(arguments)));
  };
};
</code></pre>
<p>Bind allows us to keep the <code>this</code> context when passing the callback to another function. Imagine passing a function that uses <code>this</code> into <code>setTimeout</code> or someone elses library utility, where <code>this</code> could be unpredictable.</p>
<pre><code>var greet = function (greeting) {
  return greeting + ' ' + this.user;
};

greet('Hello'); //=&gt; "Hello undefined"

var boundGreet = bind(greet, { user: 'Bob' });

boundGreet('Hello'); //=&gt; "Hello Bob"
</code></pre>
<p>We also have another useful feature built into <code>bind</code> - partial application. Partial application is essentially the act of pre-filling function arguments. Any future arguments are then appended to the arguments we have already defined.</p>
<pre><code>var greet = function (user, greeting) {
  return greeting + ' ' + user;
};

var greetBlake = bind(greet, null, 'Blake');

greetBlake('Hi'); //=&gt; "Hi Blake"
greetBlake('Hello'); //=&gt; "Hello Blake"
</code></pre>
<h2 id="bonus-implementation-using-variadic">Bonus Implementation using Variadic</h2>
<p>In my last post, I introduced the concept of a <a href="http://blakeembrey.com/articles/javascript-variadic-function/">variadic function</a>. As this article demonstrates, <code>bind</code> is a perfect example of a variadic function, so let's reimplement <code>bind</code> with the variadic function.</p>
<pre><code>var bind = variadic(function (fn, context, args) {
  return variadic(function (called) {
    return fn.apply(context, args.concat(called));
  });
});
</code></pre>
</article>
					</div>
				</article>
				<!--================= END :: Tutorial =================-->
				
				<!--================= START :: Tutorial =================-->
				<article>
					<a id="t-26" name="t-26"></a><h1>26 : Forcing Function Arity in JavaScript</h1>
					<span class="ref-site">http://blakeembrey.com/articles/2014/01/forcing-function-arity-in-javascript/</span>
					<div class="tutorial__content">
<article class="content article"><p>Function arity in something in JavaScript that is usually overlooked. For the most part, that's perfectly understandable, it's just a number. Unfortunately, this number can be integral to many other functions working correctly. But first, what number am I talking about?</p>
<pre><code>var fn = function (a, b) {};

fn.length; //=&gt; 2
</code></pre>
<p>As you can see, the length gives up the exact number of arguments the function is expecting to be passed in. This can be useful for other functions that might want to alter its behaviour based on this digit. For example, I found outlining this issue <a href="http://raganwald.com/2013/03/21/arity-and-partial-function-application.html">with currying</a>. Basically, the <code>curry</code> function implementation relies on using the arity information to know how many times the function needs to be curried.</p>
<p>To force the number of arity in our returned anonymous functions, we need to dynamically generate a function with the specified number of arguments. Why? Because the previous implementations of <a href="http://blakeembrey.com/articles/wrapping-javascript-functions/">wrapping functions</a>, <a href="http://blakeembrey.com/articles/javascript-bind-function/">bind</a>, <a href="http://blakeembrey.com/articles/javascript-variadic-function/">variadic</a> and every other functional utility I have demonstrated don't proxy the number of arguments through the returned function.</p>
<p>This can be a problem in the case where we want to use this function somewhere that expects a function length to work correctly, like when currying. We could fix this at the source, a half a dozen times and any number of times more. Or we could write a little utility that will enfore a number of arguments for us.</p>
<pre><code>var names   = 'abcdefghijklmnopqrstuvwxyz';
var __slice = Array.prototype.slice;

/**
 * Make a function appear as though it accepts a certain number of arguments.
 *
 * @param  {Number}   length
 * @param  {Function} fn
 * @return {Function}
 */
var arity = function (length, fn) {
  return eval(
    '(function (' + __slice.call(names, 0, length).join(',') + ') {\n' +
    'return fn.apply(this, arguments);\n' +
    '})'
  );
};
</code></pre>
<p>The above function allows us to pass in an argument length and a function to proxy. It then returns to us an anonymous function with the correct number of arguments defined (<code>.length</code> works!) and allows us to call the function and return the usual result. It doesn't do anything to the arguments in the interim, it just tells the world how many arguments we are accepting.</p>
<h2 id="the-other-arity-problem">The Other Arity Problem</h2>
<p>So we've touched one of the arity problems, which is a expecting to read the correct arity from a function. The reverse arity problem is when a function is called with incorrect or overloaded arguments. Consider <code>parseInt</code>, which accepts two arguments - a string and the radix.</p>
<pre><code>[1, 2, 3, 4, 5].map(parseInt); //=&gt; [1, NaN, NaN, NaN, NaN]
</code></pre>
<p>Now we're having problems. To fix this we can make a utility function that limits the number of arguments passed through.</p>
<pre><code>var __slice = Array.prototype.slice;

/**
 * Force a function to accept a specific number of arguments.
 *
 * @param  {Number}   length
 * @param  {Function} fn
 * @return {Function}
 */
var nary = function (length, fn) {
  return function () {
    return fn.apply(this, __slice.call(arguments, 0, length));
  };
};
</code></pre>
<p>If you've been reading, you would have just noticed that we introduced the original bug we've been trying to avoid. That is, we're returning a new anonymous function without proxying the number of arguments through. Let's quickly correct that with the function we just wrote.</p>
<pre><code>var __slice = Array.prototype.slice;

/**
 * Force a function to accept a specific number of arguments.
 *
 * @param  {Number}   length
 * @param  {Function} fn
 * @return {Function}
 */
var nary = function (length, fn) {
  // Uses the previous function to proxy the number of arguments.
  return arity(length, function () {
    return fn.apply(this, __slice.call(arguments, 0, length));
  });
};
</code></pre>
<p>Now we can use this to fix our map error from earlier. We also have the added bonus of a correct argument representation.</p>
<pre><code>nary(1, parseInt).length; //=&gt; 1

[1, 2, 3, 4, 5].map(nary(1, parseInt)); //=&gt; [1, 2, 3, 4, 5]
</code></pre>
</article>
					</div>
				</article>
				<!--================= END :: Tutorial =================-->
				
				<!--================= START :: Tutorial =================-->
				<article>
					<a id="t-27" name="t-27"></a><h1>27 : Wrapping JavaScript Functions</h1>
					<span class="ref-site">http://blakeembrey.com/articles/2014/01/wrapping-javascript-functions/</span>
					<div class="tutorial__content">
<article class="content article"><p>In the modern age of web applications and development, it seems we are constantly adding side effects to every part of our applications - everything from analytics to event triggering. Unfortunately in a lot of cases, we tend to cram this functionality into function with the useful stuff. As programmers, this causes numerous issues down the line - especially when it comes to refactoring and code comprehensibility.</p>
<p>A simple way to keep this functionality apart from the core code is create a helpful utility function to manage it for you. And to keep our code readability, we shouldn't allow anything advanced that can break our understanding of the original function. That means we don't want to be able to alter the original function, but we can still trigger any side effects we need to inline with the original function.</p>
<pre><code>var before = function (before, fn) {
  return function () {
    before.apply(this, arguments);
    return fn.apply(this, arguments);
  };
};
</code></pre>
<p>To use the function, we can pass any function in as the first argument and the original function we want to wrap as the second argument. For example, we could do <code>before(logger, add)</code>. Even without seeing the <code>logger</code> or <code>add</code> functions, we can imagine what each do. And because we are passing all the arguments to the side effect function, we can do stuff with the information.</p>
<p>One thing I find myself doing is checking what arguments were passed to a certain function. To do this now, we can <code>before(console.log.bind(console), fn)</code>. Now, let's implement the reverse functionality.</p>
<pre><code>var after = function (fn, after) {
  return function () {
    var result = fn.apply(this, arguments);
    after.call(this, result);
    return result;
  };
};
</code></pre>
<p>This is extremely similar to the first example. The main difference is that the first function passed in is the side effect, but now we have the side effect running after our wrapped function. Adapting the previous example, we can now do <code>after(add, logger)</code> and the logger will execute after the result is computed with the same arguments.</p>
<p>One cool thing we could actually do, is to run argument validation in the <code>before</code> function. Consider this.</p>
<pre><code>var validAdd = before(function () {
  for (var i = 0; i &lt; arguments.length; i++) {
    if (typeof arguments[i] !== 'number') {
      throw new TypeError('Expected a number');
    }
  }
}, add);
</code></pre>
<p>We can also put these two functions together and create a new utility. This one allows us to pass both a function before and after our core functionality. E.g. <code>around(logger, add, logger)</code>.</p>
<pre><code>var around = function (over, fn, under) {
  return before(over, after(fn, under));
};
</code></pre>
<h2 id="allow-unlimited-before-and-after-functions">Allow unlimited before and after functions</h2>
<p>We can also adapt the functions to accept a variable number of arguments as the <code>before</code> and <code>after</code> functions. However, we can't do this to the <code>around</code> utility since we wouldn't know which argument is the core function.</p>
<pre><code>var __slice = Array.prototype.slice;

var before = function (/* ...before, fn */) {
  var fn     = arguments[arguments.length - 1];
  var before = __slice.call(arguments, 0, -1);

  return function () {
    for (var i = 0; i &lt; before.length; i++) {
      before[i].apply(this, arguments);
    }

    return fn.apply(this, arguments);
  };
};

var after = function (fn /*, ...after */) {
  var after = __slice.call(arguments, 1);

  return function () {
    var result = fn.apply(this, arguments);

    for (var i = 0; i &lt; after.length; i++) {
      after[i].call(this, result);
    }

    return result;
  };
};
</code></pre>
<h2 id="advanced-wrapping-utility">Advanced wrapping utility</h2>
<p>So far we've seen some function wrapping utilities that are purely for side effects. They have no capability to alter the main function arguments or change the function result. For something more advanced than trigger side-effects, we might to want to use something a little different.</p>
<pre><code>var __slice = Array.prototype.slice;

var wrap = function (fn, wrap) {
  return function () {
    return wrap.apply(this, [fn].concat(__slice.call(arguments)));
  };
};
</code></pre>
<p>This is actually pretty similar the <code>wrap</code> function used in Prototype.js. It allows us to call a custom wrapper function with the original function and all the arguments. But, how do we even use this?</p>
<pre><code>var addAndMultiplyBy2 = wrap(add, function (originalFn, a, b) {
  return 2 * originalFn(a, b);
});
</code></pre>
</article>
					</div>
				</article>
				<!--================= END :: Tutorial =================-->
				
				<!--================= START :: Tutorial =================-->
				<article>
					<a id="t-28" name="t-28"></a><h1>28 : Part 1 - Javascript : Basic Scope</h1>
					<span class="ref-site">http://www.datchley.name/basic-scope/</span>
					<div class="tutorial__content">
<section class="post-content">
    <p><em>Part 1 of a <a href="/tag/fundamentals">fundamentals series</a> covering Javascript basics that I routinely come across in mentoring junior developers.</em></p>

<p>It's common for Javascript developers at all levels to deal with scope and its associated implications.  In this post we'll cover the basics of Javascript scope and some of the issues commonly encountered.</p>

<h2 id="lexicalscope">Lexical Scope</h2>

<p>Scope, in general, refers to how the browser's javascript engine looks up identifier names at run time to in order to set how they will be looked up during execution.  That definition implies that there is a <em>lexing</em> phase of the engine which is done prior to executing.</p>

<p>Javascript has two lexical scopes: <em>global</em> and <em>function</em> level. With ES6 there is also <em>block</em> level scoping; but more on that later. These lexical scopes are also nested. For instance:</p>

<p><a href="http://www.datchley.name/content/images/2015/08/js-es5-scope-2.png" class="lightbox" data-featherlight="image"><img src="http://www.datchley.name/content/images/2015/08/js-es5-scope-2.png" alt="" draggable="true" data-bukket-ext-bukket-draggable="true"></a></p>

<p>Here we have three separate lexical scopes. The default global scope which contains declarations for <code>a</code> and <code>foo</code>, the lexical scope declared within the <code>foo()</code> function which contains <code>x</code>, <code>b</code> and <code>bar</code>, and the lexical scope declared within <code>bar()</code> which contains <code>y</code> and <code>c</code>.  </p>

<p>Notice that outside of a function, the default scope of declared variables is the global scope (<em><code>window</code> in the browser</em>). Also, that scopes can be nested.  Nested scopes have access to the scope's they are declared in, which has two important implications:</p>

<ul>
<li>nested scopes can access variables declared in their parent scopes (<em>there is a scope lookup chain</em>)</li>
<li>nested scopes can <em>shadow</em> variables declared in their parent scope.</li>
</ul>

<h3 id="closures">Closures</h3>

<p>The first point allows <em>closures</em>, meaning we can define a function which will retain access to it's enclosing scope, even outside of that enclosing scope.  </p>

<pre><code>var times = function(n) {  
    return function(x) {
        return x * n;
    };
}
var times2 = times(2);  
console.log(times2(4));  
// =&gt; 8
</code></pre>

<p>Here, the function returned by times allows us to create functions that multiply their argument by a given value, <code>n</code>. The function returned retains a reference to <code>n</code>, even though the lexical scope of that function is not accessible outside of the actual function. <code>n</code>, in effect, becomes a <em>free</em> variable that is only accessible to the function defined and returned within the scope in which <code>n</code> was declared.</p>

<h3 id="shadowing">Shadowing</h3>

<p>Scope lookup during the lexical phase also stops once it finds the first match. This means you can <em>shadow</em> a variable further up the scope chain.</p>

<pre><code>var a = 4;  
function foo(x) {  
   var a = x;  // shadows parent 'a' declaration
   console.log(a);
}
console.log(foo(6));   // =&gt; 6  
console.log(a);        // =&gt; 4  
</code></pre>

<p>Here, the locally declared <code>a</code> <em>shadows</em> the <code>a</code> declared in the parent, global scope.  Without the <code>var</code> keyword, we would have been reassigning to the variable <code>a</code> in the parent scope.</p>

<pre><code>var a = 4;  
function foo(x) {  
   a = x;    // woops!
   console.log(a);
}
console.log(foo(6));   // =&gt; 6  
console.log(a);        // =&gt; 6  
</code></pre>

<h3 id="hoisting">Hoisting</h3>

<p>Hoisting also plays a factor with Javascript's scoping. In Javascript, <code>var</code> and <code>function(){}</code> declarations are hoisted to the top of the current scope; and hence, those identifiers are available to any code in that scope.</p>

<pre><code>(function(){
   console.log(inc(4));  // 5
   console.log("a =",a); // a = undefined?

   var a = 1;
   function inc(n){ return ++n; }
})();
</code></pre>

<p>Uh, oh. So we can clearly access <code>inc()</code> which was hoisted and it looks like we can use <code>a</code> without a Reference Error; but, <code>a</code> is undefined? </p>

<p>Javascript only hoists the declaration and not the initialized value.  The value will still end up being assigned at the same spot you have the original declaration. The above code actually gets modified and works as follows:</p>

<pre><code>(function(){
    var a;
    function inc(n){ return ++n; }

    console.log(inc(4));   // 5
    console.log("a = ", a); // a = undefined

    a = 4; // Ah-ha!
})();
</code></pre>

<p>This is the same for variables assigned function expressions as well. Because function expressions are just values in an assignment statement.</p>

<pre><code>(function(){
   console.log(inc(4)); // 5
   console.log(dec(4)); // ReferenceError: dec undefined

   var dec = function(n) { return --n; }
   function inc(n){ return ++n; }
})();
</code></pre>

<h3 id="es6scopingadditions">ES6 Scoping Additions</h3>

<p>With the new ES6 specification, lexical scope has been altered in a handful of ways, primarily with the new <code>let</code> and <code>const</code> declarations and with the shorter <code>=&gt;</code> function syntax.</p>

<p>In ES5, as discussed above, if you wanted to declare a lexically scoped block of code, you could do so by creating a closure, typically with an <em>immediately invoked function expression</em> or <em>IIFE</em>.  ES5 was essentially lexically scoped to <em>functions</em>.</p>

<pre><code>var greet = (function() {  
   var greeting = "Hello!";
   return function(name) { 
      console.log(greeting + ", " + name + "!");
   };
})();
greet("Cap'n Tight Pants");  
// =&gt; "Hello, Cap'n Tight Pants!"
</code></pre>

<h4 id="let"><code>let</code></h4>

<p>With ES6's <code>let</code> declaration we can now have lexically scope <em>blocks</em> of code, without using functions or IIFEs.</p>

<pre><code>var a = 1, b = 2, c = 3;  
{
  let a = 4, b = 5, c = 6;
  console.log("a,b,c = ", a, b, c);
}
console.log("a,b,c = ", a, b , c);  
// =&gt; a,b,c = 4 5 6
// =&gt; a,b,c = 1 2 3
</code></pre>

<p>Something you might encounter with <code>let</code> declarations also, is that according to the ES6 spec, <code>let</code> declarations don't <em>hoist</em> like <code>var</code> and <code>function</code> declarations.</p>

<p>With <code>let</code> declarations, you'll get a reference error if you try to access a <code>let</code> declared variable <em>before</em> its declaration in the code (<em>according to the ES6 spec</em>).  </p>

<pre><code>console.log("a = ", a);  
console.log("b = ", b);  
var a = 4;  
let b = 6;  
// =&gt; a = undefined
// =&gt; b = ReferenceError!
</code></pre>

<p>However, if you are using Traceur or Babel(6to5), this will not be the case, as transpiling this dead zone behavior would require much more work and nearly reimplementing the Javascript run-time to handle those cases.</p>

<h4 id="const"><code>const</code></h4>

<p><code>const</code> is the other new, block scope declaration type, which, as you would suspect creates <em>constant</em> variables.</p>

<pre><code>const a = 4;  
console.log("a = ", a);  
a = 3;    // TypeError! a is readonly  
</code></pre>

<p>A <code>const</code> declared variable must be initialized with a value when it is declared.  Declaring <code>const a;</code> and trying to assign a value to it later on will throw an error.  Also, <code>const</code> works by limiting the assignment to a variable, not by freezing a variable's value. So, if you assign a reference type to it, you can still modify the underlying properties of that reference type:  </p>

<pre><code>const a = { name: 'Mal', ship: 'Serenity' };  
a = 4;   // TypeError  
a.name = 'Wash'  // no problem!

const b = [1,2,3];  
b.unshift(0);  // b = [0,1,2,3]  
</code></pre>

<p><code>const</code> declared reference variables hold a constant reference to that variable, not a constant value - so the underlying reference assigned to a const can change.</p>

<h3 id="lexicalthis">Lexical <code>this</code></h3>

<p>We've already encountered the idea that Javascript <code>var</code> and <code>function</code> declarations are lexically scoped to the enclosing function or scope they are contained in.  But, what about the <code>this</code> keyword inside of functions? What does it reference?</p>

<p>Most familiar is the use of <code>this</code> in functions used as constructors with the <code>new</code> keyword.  When using <code>new</code>, <code>this</code> refers to the eventual object that will be returned from the function.</p>

<pre><code>function Tribble(color) {  
  this.color = color;
}
var my_tribble = new Tribble("brown");  
my_tribble.color;  // "brown"  
</code></pre>

<p>When calling an method on an object, <code>this</code> refers to the object that is the <em>context</em> that that function is being called with; in most cases, this is the object prototype or instance the function is assigned to.</p>

<pre><code>var tardis = {  
  where: "Gallifrey",
  go: function() { 
    console.log("Off to " + this.where + ", Allons-y!"); 
  }
};
tardis.go();  // "Off to Gallifrey, Allons-y!"  
</code></pre>

<p>When calling <code>tardis.go()</code>, the <code>this</code> references the current context of that function, which is the <code>tardis</code> object.  But, even without a context object, <code>this</code> still refers to the functions context, which turns out to be <code>window</code> for browsers.</p>

<pre><code>var where = "Gallifrey";  
function go() {  
  console.log("Off to " + this.where + ", Allons-y!"); 
}
go();  // "Off to Gallifrey, Allons-y!"  
</code></pre>

<p><code>this</code>, it seems, is fairly flexible and potentially dubious in Javascript depending on what you're trying to do.</p>

<h4 id="es6functions">ES6 <code>=&gt;</code> functions</h4>

<p>ES6 specifies a short-hand syntax for declarations for functions using the <em>fat arrow</em> (<code>=&gt;</code>) syntax.  However, <code>=&gt;</code> functions bind <code>this</code> to their enclosing scope, unlike regular functions which create a new scope entirely.</p>

<pre><code>var even = (x) =&gt; x % 2 == 0;  
console.log(even(2));  // true  
console.log(even(3));  // false

var a = 4,  
    list = [1,2,3].map((n) =&gt; n + a);
// list = [5,6,7]
</code></pre>

<p>The left side of the <code>=&gt;</code> declares the function's arguments and the right side declares the return value, or a block of code as the function body.</p>

<pre><code>let evens = [1,2,3,4,5,6].filter((n) =&gt; {  
  if (even(n)) {
    return n;
  }
});
console.log(evens);  // [2,4,6]  
</code></pre>

<p>There is much more to Javascript scoping than this (<em>ha, get it?</em>); and I would suggest you take a look at Kyle Simpson's <a href="http://www.amazon.com/You-Dont-Know-JS-Closures/dp/1449335586">You Don't Know JS: Scope &amp; Closures</a> and the <a href="https://people.mozilla.org/~jorendorff/es6-draft.html#sec-declarations-and-the-variable-statement">ES6 spec</a> related to scoping of <code>let</code> and <code>const</code> as well for a more detailed coverage and understanding.</p>

<p>If you are using <a href="https://babeljs.io/">Babel</a> or <a href="https://github.com/google/traceur-compiler">Traceur</a>, be sure and reference their documentation for any missing parts or inconsistencies from the ES6 specification as well, which will make it easier when you transition for transpilers to native ES6 in the browser.</p>

<hr>

<p><em>In <a href="http://www.datchley.name/functions/">Part 2</a> in the 'fundamentals' series I'll cover some of the basics of Javascript functions, notably <code>call</code>, <code>apply</code>, <code>bind</code> and more on the ES6 <code>=&gt;</code> functions.</em></p>
        <ul class="tags">
            <li class="tag" id="tag-id-2"><a href="/tag/fundamentals/">fundamentals</a></li> 
            <li class="tag" id="tag-id-3"><a href="/tag/scope/">scope</a></li> 
        </ul>
  </section>
					</div>
				</article>
				<!--================= END :: Tutorial =================-->
				

				<!--================= START :: Tutorial =================-->
				<article>
					<a id="t-29" name="t-29"></a><h1>29 : Part 2 - Functions</h1>
					<span class="ref-site">http://www.datchley.name/functions/</span>
					<div class="tutorial__content">
<section class="post-content">
    <p><em>Part 2 of a series on Javascript Fundamentals. See <a href="http://www.datchley.name/basic-scope/">Part 1</a> on Scope in Javascript.</em></p>

<h3 id="declarationexpressioninvoking">Declaration, Expression, Invoking</h3>

<p>I don't want to belabor the basics of function declaration and definition in Javascript; but there are primarily two different ways you'll see functions in Javascript:</p>

<ul>
<li>function declarations</li>
<li>function expressions (named &amp; anonymous)</li>
</ul>

<p>Functions can be declared using the <code>function</code> keyword and a name, as in  </p>

<pre><code>function compare(a,b) {  
  return a == b ? 0 : (a &lt; b) ? -1 : 1;
}
</code></pre>

<p>This declares a function called <code>compare</code>, which is <em>hoisted</em> to the top of its enclosing scope and available to any code in that scope or its child scopes.</p>

<p>Functions can also be treated as values, meaning you can assign them to variables and pass and return them to and from functions as well. These are referred to as <em>first-class functions</em> and lead to <em>higher-order functions</em> when working in a more declarative, functional style of programming.</p>

<pre><code>// function expression
var even = function(n){ return n % 2 == 0; };  

// returning a function
var log = function(base) {  // returning a function  
  return function(n) {
    return Math.log(n) / Math.log(base);
  }
};
var log10 = log(10);  
log10(100);   // 2  
</code></pre>

<p>For a discussion of function <code>scope</code> in relation to <em>IIFE</em>s and lexical <code>this</code>, refer to <a href="http://www.datchley.name/basic-scope/">Part 1</a> of this series on Scope.</p>

<h3 id="functionargumentsarity">Function Arguments &amp; Arity</h3>

<p>The arity of a function refers to the number of arguments a function expects. This is determined by the number of declared arguments in the function declaration and is available in the function's <code>.length</code> property.</p>

<pre><code>function foo(a,b) { console.log(a, b); }  
foo.length;   // 2  
</code></pre>

<p>A functions arity is, and can be, necessarily different than the arguments it actually receives when called.  If we invoke a function with fewer arguments than it expects, the argument identifiers in the function for arguments not passed will be set to undefined.</p>

<pre><code>foo(4, 5);  // =&gt; 4, 5  
foo(3);     // =&gt; 3, undefined  
foo();      // =&gt; undefined, undefined  
</code></pre>

<p>Within a function we can access all the arguments passed, both those declared in the function declaration and any extras (<em>you can pass more than the declared arguments to a function</em>) using the available <code>arguments</code> variable.</p>

<pre><code>function args(a,b) {  
   console.log("a,b: ", a, b);
   console.log("all: ", arguments);
}
foo(1,2);        // a,b: 1 2  
                 // all: [1,2]
foo(1,2,3,4);    // a,b: 1 2  
                 // all: [1,2,3,4]
</code></pre>

<p>The <code>arguments</code> object is a local variable available within all functions and it is <em>array-like</em>.  This means it is not an instanceof the <code>Array</code> type and does not have many of it's methods.  <code>arguments</code> can be accessed by index, ie <code>arguments[0]</code>, <code>arguments[1]</code> and it has a <code>.length</code> property.</p>

<p>This feature allows Javascript functions to have variable arguments. To work with the arguments as a real array, you can simply convert the arguments object to an array.</p>

<pre><code>function has() {  
  let args = [].slice.call(arguments);
  args.forEach((arg) =&gt; console.log(arg));
}
has(1,2,3,4);  
// 1
// 2 
// 3
// 4
</code></pre>

<h3 id="invokingfunctions">Invoking functions</h3>

<p>Invoking a function is done using the <code>()</code> operator on the function name or variable holding the function expression.</p>

<pre><code>var foo(){ /* do foo */ }   // declaration  
foo();   // invoke

(function baz() {           // IIFE
   console.log("baz!");
})();
// "baz!"

var bar = function(){ /* do bar */ };  // expression  
bar();   // invoke  
</code></pre>

<p>We can also assign a function to a property on an object and invoke it through the standard object property access method as well.</p>

<pre><code>let princess = {  
   name: 'Leia Organa',
   say: function(msg) { console.log(this.name + ": " + msg); }
};
princess.say("I love you!");  
// =&gt; Leia Organa: I love you!
</code></pre>

<p>In this case, when invoking a function via an object's property it's assigned to, the context of <code>this</code> in that function is the object itself.</p>

<p>However, using Javascript's <code>.call()</code> and <code>.apply()</code>, we can change that context when invoking the function.</p>

<pre><code>let name = 'Han Solo';  
princess.say.call(this, "I know.");  
// =&gt; Han Solo: I know.
</code></pre>

<p>What just happened there?  Why would Han totally underplay that kind of declaration <em>and</em> how'd he steal her line?  The <code>.call()</code> method's first argument is an object to use as the invoking context of the function being called.  This allows us to override <code>princess.name</code> and use the global <code>name</code> variable by passing in <code>this</code>, which refers to the <code>window</code> object.</p>

<p><code>.call()</code> also lets us pass in as many arguments for that function using the remaining parameters, which is how Han came across as so smug.</p>

<p>The only difference between <code>.call()</code> and <code>.apply()</code> is that <code>.apply()</code> only takes 2 parameters: a context object just like call, and an array of arguments (<em>instead of passing them as individual parameters</em>). Even though <code>.apply()</code> takes the arguments as an array, they are still passed normally to the function being invoked.</p>

<pre><code>function add(a,b) { console.log(a + b); }  
add.apply(null, [2,3]);  
// 5
</code></pre>

<p>Why did we just pass <code>null</code> as the context object and what exactly did that do? According the the ECMAScript standard, passing in <code>null</code> or <code>undefined</code> will make the function's lexically scoped <code>this</code> point to the global scope.</p>

<p>In most cases with single functions, the lexical context of <code>this</code> is probably not a concern, as you probably aren't referencing <code>this</code> within the function.  However, when dealing with functions assigned to object properties and invoked through them, understanding how the first argument of <code>.call()</code> and <code>.apply()</code> affect the function's <code>this</code> is important.</p>

<p>Why would we use <code>.apply()</code> and not just use <code>.call()</code> everywhere?  Let's say you had a function called <code>after()</code> that would wrap an existing function and ensure some code was executed every time after that function was called. Using <code>.call()</code> would be nearly impossible given that you don't know the number of parameters that function might be called with - without resorting to something potentially dangerous like using <code>eval()</code>.</p>

<pre><code>function lots(a,b,c,d) {  
   console.log([a,b,c,d].join(','));
}
function after(fn) {  
  var orig = fn;
  return function() {
    orig.call(null, /* how do you pass them? */);
  };
}
var lots = after(lots);  
lots(1,2,3,4);  
</code></pre>

<p>This is where <code>.apply()</code> and the <code>arguments</code> local variable come to the rescue:</p>

<pre><code>function after(fn) {  
  var orig = fn;
  return function() {
    var args = [].slice.call(arguments);
    return orig.apply(null, args);
  };
}
var lots = after(lots);  
lots(1,2,3,4);  
/// 1,2,3,4
</code></pre>

<h3 id="usingbind">Using <code>.bind()</code></h3>

<p>So we know now that <code>.call()</code> and <code>.apply()</code> can be used to not only invoke the given function; but to also change it's calling context and pass parameters as well.  But, those methods directly invoke the function when used. </p>

<p>Javascript also gives us the <code>.bind()</code> method on functions to allow us to <em>bind</em> both a context and one or more parameters and <em>not</em> invoke the function; but instead return this newly bound function to be called later.</p>

<p>We can use the same example from above, but allow our <code>after</code> function to take a second parameter to specify the calling context the function should be executed with.</p>

<pre><code>var doctor = {  
  name: 'Matt Smith',
  who: function named() {
   console.log(this.name);
  }
};

function after(fn, context) {  
  var orig = context ? fn.bind(context) : fn;
  return function() {
    var args = [].slice.call(arguments);
    return orig.apply(null, args);
  };
}

var tenth = { name: 'David Tennant' };  
var thedoctor = after(doctor.who, tenth);  
doctor.who();  // Matt Smith  
thedoctor();   // David Tennant  
</code></pre>

<p><code>.bind()</code> also allows us to pre-bind one or more argument parameters to the function as well.  For instance:</p>

<pre><code>function add(a,b) { return a + b; }  
var add2 = add.bind(null, 2);  
add2(4);   // 6  
add2(3,6); // 5  
</code></pre>

<p>Here, we create a new function by <em>partially applying</em> the first argument to <code>add()</code>.  Passing any subsequent parameters makes no difference.</p>

<p>Keep in mind that <code>.call()</code>, <code>.apply()</code> and <code>.bind()</code> can not be used with ES6's <code>=&gt;</code> functions to change the context of <code>this</code>, as <code>this</code> is explicitly bound to the enclosing scope where the function is declared.  You can use <code>.apply</code> and <code>.call</code> to pass in argument parameters, but the first argument is ignored for changing context.</p>

<p>For more detailed information, the Mozilla Developer Network (MDN), a good reference for anything Javascript, has excellent coverage on <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function/call"><code>.call</code></a>, <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function/apply"><code>.apply</code></a> and <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function/bind"><code>.bind</code></a>.</p>

<hr>

<p><em>In Part 3 in the 'fundamentals' series I'll cover a number of the ES5/6 array methods and idioms, like <code>map</code>, <code>filter</code>, <code>reduce</code>, <code>from</code>, <code>of</code> and iterating arrays using <code>for..of</code></em></p>
        <ul class="tags">
            <li class="tag" id="tag-id-2"><a href="/tag/fundamentals/">fundamentals</a></li> 
            <li class="tag" id="tag-id-4"><a href="/tag/functions/">functions</a></li> 
        </ul>
  </section>
					</div>
				</article>
				<!--================= END :: Tutorial =================-->
				
				<!--================= START :: Tutorial =================-->
				<article>
					<a id="t-30" name="t-30"></a><h1>30 : Part 3 - .map, .reduce &amp; .filter, Oh My!</h1>
					<span class="ref-site">http://www.datchley.name/working-with-collections/</span>
					<div class="tutorial__content">
<section class="post-content">
    <p><em>Part 3 of a series on Javascript Fundamentals. See the <a href="/tag/fundamentals">full list of posts</a></em></p>

<p>Making use of Javascript's <code>map()</code>, <code>reduce()</code> and <code>filter()</code> Array methods can help you write more declarative, fluent style code. Rather than building up <code>for</code> loops and nesting to process data in lists and collections, you can take advantage of these methods to better organize your logic into building blocks of functions, and then chain them to create more readable and understandable implementations. And ES6 gives us a few more nice array methods as well, like <code>.from</code>, <code>.find</code>, <code>.findIndex</code>, <code>.of</code> and <code>for..of</code> loops!</p>

<h2 id="arraymap"><code>Array.map</code></h2>

<p>There are very common things we want to do to lists. The first one that comes to mind is cycling through the list and performing an operation on each item. You can do this with <code>Array.forEach</code>. </p>

<pre><code>var numbers = [1,2,3,4,5,6,7,8,9,10];  
numbers.forEach((n, index) =&gt; {  
   numbers[index] = n + 1;
});
// =&gt; [2,3,4,5,6,7,8,9,10,11]
</code></pre>

<p>Here, we're looping through the array and adding one to each item. This approach also has the side effect that it mutates the original list of data. As good developers, we want to reduce side effects and be <em>transparent</em> and <em>idempotent</em> with our functions and processing. </p>

<p>So, let's use <code>map()</code> to perform the same operation and leave the original list in tact.  </p>

<pre><code>var plusone = numbers.map((n) =&gt; n+1);  
// =&gt; numbers: [1,2,3,4,5,6,7,8,9,10]
// =&gt; plusone: [2,3,4,5,6,7,8,9,10,11]
</code></pre>

<p>Easy enough. No side-effects and we have a new list with exactly what we wanted.</p>

<p>Now, what if we then want to take just the <em>even</em> numbers from this result in a list?</p>

<h2 id="arrayfilter"><code>Array.filter</code></h2>

<p>We can use <code>Array.filter()</code> to visit each item in a list, much like <code>map()</code>; however, the predicate function you pass to <code>filter()</code> should return either <code>true</code>, to allow that item in the list, or <code>false</code> to skip it. Also like <code>map()</code>, <code>filter()</code> returns a new array with copies of the items that match the filter and does not modify the original.</p>

<pre><code>var evens = plusone.filter((n) =&gt; n % 2 === 0);  
// =&gt; evens: [2,4,6,8,10]
</code></pre>

<p>Even easier! Now that we've got the list we want to work with, lets get a count of the number of how many are evenly divisible by 4.  </p>

<h2 id="arrayreduce"><code>Array.reduce</code></h2>

<p>When we want to aggregate data in a list, or data related to a list, we can use <code>Array.reduce()</code>.  <code>reduce()</code> applies a function to an accumulated value on each element in a list from left to right.</p>

<pre><code>var byfour = evens.reduce((groups, n) =&gt; {  
  let key = n % 4 == 0 ? 'yes' : 'no';
  (groups[key] = groups[key] || []).push(n);
  return groups;
}, {});
// =&gt; byfour: { 'yes': [4,8], 'no': [2,6,10] }
</code></pre>

<p>Unlike <code>map()</code> and <code>filter()</code>, however, <code>reduce()</code> doesn't return a new list, it returns the aggregate value directly.  In the case of our number list, our accumulated value was the initial empty object passed as the last parameter to the <code>reduce()</code> call.  We then used that to create a property based on the divisible-by-four-ness of each number that served as a bucket to put the numbers in.</p>

<h2 id="beingfluentish">Being fluent-ish</h2>

<p>A fluent API or interface is one that provides better readability through:</p>

<ul>
<li>chaining of method calls over some base context</li>
<li>defining operations via the return value of each called method</li>
<li>is self-referential, where the new context is equivalent to the last</li>
<li>terminates via return of a void context</li>
</ul>

<p>JQuery works likes this, as well as lodash and underscore using the <code>_.chain()</code> method wrapper, allowing chaining of method calls on a base context that represents a DOM element tree.</p>

<p>Because <code>map()</code> and <code>filter()</code> return new arrays, we can take advantage of this and chain multiple array operations together.</p>

<pre><code>[1,2,3,4,5,6,7,8,9,10]
  .map((n) =&gt; n*2)
  .filter((n) =&gt; 10 % n == 0)
  .reduce((sum, n) =&gt; (sum += n), 0);
// =&gt; 12
</code></pre>

<p>Now, this isn't a "real" fluent interface; but it does resemble one from a chaining perspective and gives us a more declarative approach to implementing operations on lists.</p>

<h2 id="someneweres6arraymethods">(Some) Newer ES6 Array methods</h2>

<p>ES6 gives us some new Array methods that make some things easier compared to what we previously had to do in ES5, as well as adding some extra functionality.</p>

<h3 id="arrayfrom"><code>Array.from()</code></h3>

<p>The new <code>.from()</code> method is a static method of Array and allows us to create real arrays from "array-like" objects (<em>such as <code>arguments</code> or dom collections</em>); and it also allows us to pass a function to to apply to items in those arrays, giving us some <code>.map()</code>-like behavior as well.</p>

<p>For instance, we can create a real array from a DOM collection, which isn't really an instance of Array but is array like in that it allows indexing and has a length.</p>

<pre><code>var divs = document.querySelectorAll('div.pane');  
var text = Array.from(divs, (d) =&gt; d.textContent);  
console.log("div text:", text);  
</code></pre>

<p>The above snippet takes the DOM collection returned from <code>querySelectorAll()</code> and uses <code>Array.from</code> to map across each item and return us a "real" array of the text content from those DOM elements.  To use it with the <code>arguments</code> variable in functions is just as easy.</p>

<pre><code>// Old, ES5 way to get array from arguments
function() {  
  var args = [].slice.call(arguments);
  //...
}

// Using ES6 Array.from
function() {  
  var args = Array.from(arguments);
  //..
}
</code></pre>

<p>You can also use <code>Array.from</code> for other cool things, like filling in holes in arrays, since <code>Array.from</code>'s map function is passed <code>undefined</code> for any empty indexes in the array-like value being operated on.  </p>

<pre><code>var filled = Array.from([1,,2,,3], (n) =&gt; n || 0);  
console.log("filled:", filled);  
// =&gt; [1,0,2,0,3]
</code></pre>

<h3 id="arrayfindandarrayfindindex"><code>Array.find()</code> and <code>Array.findIndex()</code></h3>

<p>ES5 gave us <code>Array.filter()</code> which we've seen and is fantastic for filtering out the elements in an array. But, to find an element by value in an array in ES5, we'd have had to resort to something like the following.  To loop over an array and use more complex logic to find a value, we'd have to use a <code>for</code> loop.</p>

<pre><code>function find(list, value) {  
    var index = list.indexOf(value);
    return index == -1 ? undefined : list[index];
}
var arr = ['cat','dog','bat','badger','cow'];  
console.log("dog? ", find(arr, 'dog'));  
// dog? dog
console.log("weasle? ", find(arr, 'weasle'));  
// weasle? undefined

var found;  
// Find the first item longer than 3 characters
for (var i=0; i &lt; arr.length; i++) {  
  if (arr[i].length &gt; 3) {
    found = arr[i];
    break;
  }
}
// found: 'badger'
</code></pre>

<p>But, ES6 allows us to do the same thing using <code>Array.find()</code> to get a value, if it exists in an array; and <code>Array.findIndex()</code> to get the index of something by value.  However, instead of taking a value directly as a parameter, <code>find()</code> and <code>findIndex</code> take a predicate function that is applied to each element in the array, and once the predicate returns true, stops the search and returns the value at that position (<em>for <code>.find</code></em>) or the index at that position (<em>for <code>findIndex</code></em>).</p>

<pre><code>// Array.find and Array.findIndex(fn)
var found = [1,4,-5,10].find((n) =&gt; n &lt; 0);  
console.log("found:", found);

var index = [1,4,-5,10].findIndex((n) =&gt; n &lt; 0);  
console.log("index:", index);

// found: -5
// index: 2
</code></pre>

<h3 id="arrayof"><code>Array.of()</code></h3>

<p><code>Array.of()</code> lets us create a new Array instance from a variable number of arguments, regardless of the type of those arguments.</p>

<pre><code>var arr = Array.of(0,true, undefined, null);  
console.log("arr:", arr);  
// arr: [0, true, undefined, null]
</code></pre>

<p>This is essentially the same as the following ES5 function:</p>

<pre><code>function ArrayOf(){  
  return [].slice.call(arguments);
}
</code></pre>

<p><code>Array.of()</code> works more consistently at creating instances of Arrays than using the <code>Array()</code> constructor.  The <code>Array()</code> constructor can run into issues if a single argument is passed and it's a number.</p>

<pre><code>console.log(new Array(3, -5, 10));  
// [3, -5, 10] - an array with the arguments as entries
console.log(new Array(3));  
// [,,]  - an array with three empty holes
console.log(new Array(5.7));  
// RangeError: invalid array length - woops!
</code></pre>

<h3 id="theforofloop">The <code>for..of</code> loop</h3>

<p>The <code>for..of</code> loop creates a loop over any <em>iterable</em> object, including <code>Array</code>, <code>arguments</code>, <code>Set</code>, <code>Map</code> and custom iterable objects like <code>generators</code>. This is different than the <code>for..in</code> operator, as <code>for..in</code> iterates over an Array, you get indexes, not values.  <code>for..in</code> can be used on Objects, but returns the property names, not values. <code>for..of</code> can not be used on <code>Objects</code>, as there is no default iterator defined for <code>Objects</code> in javascript.</p>

<pre><code>var arr = [3,5,7,9],  
    obj = { a: 1, b: 2, c: 3 };

// ES5 for..in over objects
for (var p in obj) {  
  console.log(p);
}
// a  b   c

// ES5 for..in over arrays
for (var n in arr) {  
  console.log(n);
}
// 0 1 2 3

// ES6 for..of over arrays
for (let n of arr) {  
  console.log(n);
}
// 3 5 7 9 
</code></pre>

<p>Using <code>for..of</code>, we can now actually iterate values on Arrays. Though we still can't use it on <code>Object</code>s, we can use a generator and <code>for..of</code> to loop over the keys and values in an object.</p>

<pre><code>// using a generator function
function* entries(obj) {  
   for (let key of Object.keys(obj)) {
     yield [key, obj[key]];
   }
}


for (let [key, value] of entries(obj)) {  
   console.log(key, "-&gt;", value);
}
// a -&gt; 1
// b -&gt; 2
// c -&gt; 3
</code></pre>

<p>Iterable objects and generators are, however, a topic for a different blog post!</p>

<p>If you're looking for more information on some of the ES6 Array methods, be sure and check out <a href="http://www.2ality.com/2014/05/es6-array-methods.html">Axel Rauschmayer's Post</a> and <a href="http://h3manth.com/new/blog/2014/es6-array-methods/">Hemanth HM's post</a>, and be sure and look at <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/for...of">MDN's entry</a> on <code>for..of</code>.</p>

<hr>

<p><em>In Part 4 in the 'fundamentals' series I'll cover some of the basics of <del>iterables and generators</del> (a bit early for this) Objects, prototypes, delegation and composition, including <code>Object.create()</code>.</em></p>
        <ul class="tags">
            <li class="tag" id="tag-id-2"><a href="/tag/fundamentals/">fundamentals</a></li> 
            <li class="tag" id="tag-id-5"><a href="/tag/javascript/">javascript</a></li> 
            <li class="tag" id="tag-id-6"><a href="/tag/collections/">collections</a></li> 
        </ul>
  </section>
					</div>
				</article>
				<!--================= END :: Tutorial =================-->
				
				<!--================= START :: Tutorial =================-->
				<article>
					<a id="t-31" name="t-31"></a><h1>31 : Part 4 - Object-ively Javascript</h1>
					<span class="ref-site">http://www.datchley.name/delegate-object-to-classical-inheritance/</span>
					<div class="tutorial__content">
<section class="post-content">
    <p><em>Part 4 of a series on Javascript Fundamentals. See the <a href="/tag/fundamentals">full list of posts</a></em></p>

<p>The goal of this post is to, at a high level, cover some of the basics of creating, using and implementing objects in Javascript.  In a second part, we'll follow up with understanding Javascript object prototype, the prototype chain and making better use of composition and delegation over inheritance.</p>

<p><em>I'll mention objects being "prototype linked" to other objects in this article quite often. If you're still confused by Javascript's prototype based object delegation scheme, just hold tight for the second part coming soon</em></p>

<h2 id="makingobjects">Making Objects</h2>

<p>The easiest way to create objects in Javascript, and the most efficient, is using object literals.  </p>

<pre><code>var actor = {  
  name: "David Tennant",
  age: 44
};
</code></pre>

<p>Here,<code>actor</code> is an object with two properties, <code>name</code>, which contains a string, and <code>age</code> which contains a number.  This is the same as using <code>var obj = new Object()</code> and then assigning properties. Both objects are prototype linked the standard <code>Object</code> prototype. </p>

<p>We can also create a function to make objects by calling it as a <em>constructor</em> function using the <code>new</code> operator.  </p>

<pre><code>function Person(name, age) {  
   this.name = name;
   this.age = age;
}
var actor = new Person("David Tennant", 44);  
</code></pre>

<p>Using the <code>new</code> operator introduces some implicit operations, which we'll discuss shortly.</p>

<p>We also have <code>Object.create()</code> as well, though it works a bit differently.</p>

<p><code>Object.create()</code> takes two parameters and returns a new object. This object is prototype linked to the first object passed as a parameter.  The second parameter is an optional object containing property descriptors to assign directly on the newly returned object.  </p>

<p>A property descriptor object is an object containing definitions for properties. The property names in this descriptor object are themselves objects which contain various attributes attributed to that property, such as: <code>value</code>, <code>writable</code>, <code>configurable</code>, and <code>enumerable</code>. </p>

<ul>
<li><code>value</code> (<em>any</em>) - is the value assigned to that property</li>
<li><code>writeable</code> (<em>boolean</em>) - if false, means the value of that property can not be changed</li>
<li><code>enumerable</code> (<em>boolean</em>) - if true, means that property will be iterated over when a user does a <code>for..in</code> or similar operation.</li>
<li><code>configurable</code> (<em>boolean</em>) - if false, any attempts to delete the property or change its value will fail. </li>
</ul>

<p>Try the following in Chrome DevTools to see how basic object properties are setup:</p>

<pre><code>var obj = { a: 42 };  
console.log("%o", Object.getOwnPropertyDescriptor(obj, 'a'));  
// Object
//    configurable: true
//    enumerable: true
//    value: 42
//    writable: true
//    ...
</code></pre>

<p>Using <code>Object.create()</code> we can create objects using another object as a prototype (<em>an exemplar</em>); and an optional property descriptor object. Any properties on the exemplar are accessed via the object's prototype chain; and any properties in the descriptor object are <em>own properties</em> assigned directly to the new object returned.</p>

<pre><code>// creates a new, empty object linked to Object.prototype
var obj = Object.create({});  

// create a new, empty object not linked to Object.prototype
obj = Object.create(null);

var person_proto = {  
      name: "", age: null
    },
    descriptor = {
      tardis: { value: "blue box" }
    };

// creates a new object based on person_proto
var actor = Object.create(person_proto, descriptor)  
actor.name = "David Tennant";  
actor.age = 44;  
// actor:
//   name: "David Tennant"
//   age: 44
//   tardis: "blue box"
</code></pre>

<p>In ES6, we could use the following pattern in creating our <code>actor</code> instance instead:</p>

<pre><code>var actor = Object.assign(Object.create(person_proto), {  
  tardis: "blue box"
});
</code></pre>

<p>ES6's <code>Object.assign()</code> is similar to the many <code>extend()</code> style functions that libraries like jQuery and Underscore use to create/extend objects using one or more objects.</p>

<h3 id="understandingwhatnewdoes">Understanding what <code>new</code> does</h3>

<p>There is much magic happening in a function invoked with the <code>new</code> operator.  At its most basic, when using <code>new</code>, the function invocation is hijacked and given a new, empty object as context, which is assigned to the local variable <code>this</code> inside the function.  </p>

<p>The expectation of functions called as constructors is that they do something with that context: assigning properties or otherwise manipulating it; and magically, that same context object is returned from the function.</p>

<p>Using <code>new</code> works similarly to the following function:  </p>

<pre><code>function _new(/* constructor, param, ... */) {  
  var  args = [].slice.call(arguments),
       constructor = args.shift(), 
       context = Object.create(constructor.prototype),
       res;

  res = constructor.apply(context, args);
  return (typeof res === 'object' &amp;&amp; res != null) ? res : context;
}
var actor = _new(Person, "David Tennant", 44);  
</code></pre>

<p>This is very simplified, but it gives you an idea of what's going on. </p>

<p>But as <a href="https://medium.com/javascript-scene/common-misconceptions-about-inheritance-in-javascript-d5d9bab29b0a">Eric Elliot</a>, <a href="http://raganwald.com/2014/07/09/javascript-constructor-problem.html">Reginald Braithwaite</a> and <a href="http://davidwalsh.name/javascript-objects">Kyle Simpson</a> point out using <code>new</code> and constructor functions can be problematic for a number of reasons.</p>

<blockquote>
  <p>"If a feature is sometimes dangerous, and there is a better option, then always use the better option." -- Douglas Crockford</p>
</blockquote>

<h2 id="objectaccess">Object Access</h2>

<p>Objects have properties.  Properties are named keys on the object that can hold values. Those values can be basic types like strings, numbers, booleans or even object types like arrays, functions or other objects stored as references.  The easiest way to access properties on an object is using the <code>.</code> operator.  </p>

<pre><code>var obj = {  
  foo: "bar", 
  baz: 42,
  print: function(s){ console.log(s); }
};

obj.foo;  
obj.print("hi");  
</code></pre>

<p>You can also access object properties using the <code>[]</code> operator. The <code>[]</code> operator expects a string argument that identifies the property key you're trying to access.  Any non-string value will be coerced to a string and then used.</p>

<pre><code>var obj = {};  
obj["name"] = "David Tennant";  
obj["age"] = 44;  
obj["33"] = "what?";  // can only access using [] operator  
obj[true] = "true";   // coercion to property named "true"

obj.33;      // syntax error!  
obj["33"];   // "what?"  
obj["true"]; // "true"  
obj.true;    // "true"  
</code></pre>

<p>This makes it easy to dynamically access properties at runtime by storing or building the property names.</p>

<p>ES6 gives us a way to specify properties as shorthand, as well as computed property names.  For example,</p>

<pre><code>let age = 44;  
let obj = {  
  name: "David Tennant",
  // short for, who: function(){...}
  who() { console.log("the doctor"); },
  // short for age: age
  age,
  // computed property names!
  ["hello_" + (() =&gt; "sweetie")()]: "the wife"
};

obj.who();                       // "the doctor"  
console.log(obj.hello_sweetie);  // "the wife"  
</code></pre>

<p>I'll point out some more resources on the new ES6 object features at the end of this post.  Outside of computed property names, most of the object literal shorthand notation is just syntactic sugar to make declaring and working with objects in Javascript easier.</p>

<h2 id="iteratingobjects">Iterating Objects</h2>

<p>Now that our objects have all these properties, maybe we want to iterate through them.  Objects themselves are not <em>iterable objects</em> like arrays - they don't have an iterator defined for them, as access isn't as straight forward as one might think - you might iterate over the property names or property values; and what about prototype linked objects?</p>

<p>You can iterate over objects using the special <code>for..in</code> loop, which does iterate over the object's property keys, not it's values.  But, <code>for..in</code> will iterate over prototype linked, enumerable properties as well, so be sure and use a <code>.hasOwnProperty()</code> to help limit the scope and recursion into the prototype chain of the object you're iterating.</p>

<pre><code>var obj = { a: 1, b: 2 },  
    obj2 = Object.create(obj, {
      c: { value: 3, enumerable: true },
      d: { value: 4, enumerable: true } 
    });

for (var prop in obj2) {  
    console.log(prop);
}
// a b c d
for (var prop in obj2) {  
    if (obj2.hasOwnProperty(prop)) {
        console.log(prop);
    }
}
// c d
</code></pre>

<p>You can get access to an object's property keys using <code>Object.keys()</code>. The benefit of which, is that it only returns enumerable properties directly on the object in question - not prototype linked, enumerable properties.</p>

<pre><code>Object.keys(obj2).forEach(function(p) {  
  console.log(p + " = " + obj2[p]);
});
// c = 3
// d = 4
</code></pre>

<p>For information on ES6's new object shorthand properties and computed properties, check out <a href="https://strongloop.com/strongblog/javascript-es6-object-notation/">Strongloop's article</a> and <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Object_initializer">MDN</a>.</p>

<p>Also take a look at Kyle Simpson's <a href="https://github.com/getify/You-Dont-Know-JS/tree/master/this%20%26%20object%20prototypes">You Don't Know JS: this &amp; Object properties</a> for more details about Javascript objects, <code>new</code> and more.</p>

<p><em>In the next article I'll cover specifically Javascript objects and prototypes and talk about why you should be using composition and delegation instead of trying to mimic "class" style inheritance with <code>new</code> and constructor functions.</em></p>
        <ul class="tags">
            <li class="tag" id="tag-id-2"><a href="/tag/fundamentals/">fundamentals</a></li> 
            <li class="tag" id="tag-id-5"><a href="/tag/javascript/">javascript</a></li> 
        </ul>
  </section>
					</div>
				</article>
				<!--================= END :: Tutorial =================-->
				
				<!--================= START :: Tutorial =================-->
				<article>
					<a id="t-32" name="t-32"></a><h1>32 : Chapter 4: Currying</h1>
					<span class="ref-site">https://drboolean.gitbooks.io/mostly-adequate-guide/content/ch4.html</span>
					<div class="tutorial__content">
<section class="normal markdown-section">
                                
                                
<h2 id="cant-live-if-livin-is-without-you">Can't live if livin' is without you</h2>
<p class="comments-section">My Dad once explained how there are certain things one can live without until one acquires them. A microwave is one such thing. Smart phones, another. The older folks among us will remember a fulfilling life sans internet. For me, currying is on this list.</p>
<p class="comments-section">The concept is simple: You can call a function with fewer arguments than it expects. It returns a function that takes the remaining arguments.</p><div class="comments-area"><div class="comment"><div class="comment-body "><a class="comment-user" target="_blank" href="https://www.gitbook.com/@deepakanand">Deepak Anand</a><div class="comment-content">"call a function with fewer arguments than it expects"<br><p>Isnt that partial application?</p>
</div></div></div><div class="comments-list" data-thcomments="39"><div class="comment"><div class="comment-body "><a class="comment-user" target="_blank" href="https://www.gitbook.com/@derekhannah">Derek Hannah</a><div class="comment-content"><p>nope. Currying always produces nested unary (1-ary) functions. The transformed function is still largely the same as the original. Partial application produces functions of arbitrary arity. The transformed function is different from the original – it needs less arguments.</p>
</div></div></div><div class="comment"><div class="comment-body "><a class="comment-user" target="_blank" href="https://www.gitbook.com/@derekhannah">Derek Hannah</a><div class="comment-content"><p><a href="http://www.2ality.com/2011/09/currying-vs-part-eval.html">http://www.2ality.com/2011/09/currying-vs-part-eval.html</a></p>
</div></div></div></div><div class="comments-post"><div class="comments-toolbar"><a href="#">Sign in to comment</a></div></div></div>
<p class="comments-section">You can choose to call it all at once or simply feed in each argument piecemeal.</p>
<pre><code>var add = function(x) {
  return function(y) {
    return x + y;
  };
};

var increment = add(1);
var addTen = add(10);

increment(2);
// 3

addTen(2);
// 12
</code></pre>
<p class="comments-section">Here we've made a function <code>add</code> that takes one argument and returns a function. By calling it, the returned function remembers the first argument from then on via the closure. Calling it with both arguments all at once is a bit of a pain, however, so we can use a special helper function called <code>curry</code> to make defining and calling functions like this easier.</p><div class="comments-area"><div class="comment"><div class="comment-body "><a class="comment-user" target="_blank" href="https://www.gitbook.com/@boazblake">Boaz Blake</a><div class="comment-content"> By calling it, the returned function remembers the first argument from then on via the closure</div></div></div><div class="comments-list" data-thcomments="126"></div><div class="comments-post"><div class="comments-toolbar"><a href="#">Sign in to comment</a></div></div></div>
<p class="comments-section">Let's set up a few curried functions for our enjoyment.</p>
<pre><code>var curry = require('lodash/curry');

var match = curry(function(what, str) {
  return str.match(what);
});

var replace = curry(function(what, replacement, str) {
  return str.replace(what, replacement);
});

var filter = curry(function(f, ary) {
  return ary.filter(f);
});

var map = curry(function(f, ary) {
  return ary.map(f);
});
</code></pre>
<p class="comments-section">The pattern I've followed is a simple, but important one. I've strategically positioned the data we're operating on (String, Array) as the last argument. It will become clear as to why upon use.</p>
<pre><code>match(/\s+/g, 'hello world');
// [ ' ' ]

match(/\s+/g)('hello world');
// [ ' ' ]

var hasSpaces = match(/\s+/g);
// function(x) { return x.match(/\s+/g) }

hasSpaces('hello world');
// [ ' ' ]

hasSpaces('spaceless');
// null

filter(hasSpaces, ['tori_spelling', 'tori amos']);
// ['tori amos']

var findSpaces = filter(hasSpaces);
// function(xs) { return xs.filter(function(x) { return x.match(/\s+/g) }) }

findSpaces(['tori_spelling', 'tori amos']);
// ['tori amos']

var noVowels = replace(/[aeiouy]/ig);
// function(replacement, x) { return x.replace(/[aeiouy]/ig, replacement) }

var censored = noVowels("*");
// function(x) { return x.replace(/[aeiouy]/ig, '*') }

censored('Chocolate Rain');
// 'Ch*c*l*t* R**n'
</code></pre>
<p class="comments-section">What's demonstrated here is the ability to "pre-load" a function with an argument or two in order to receive a new function that remembers those arguments.</p>
<p class="comments-section">I encourage you to <code>npm install lodash</code>, copy the code above and have a go at it in the REPL. You can also do this in a browser where lodash or ramda is available.</p>
<h2 id="more-than-a-pun--special-sauce">More than a pun / special sauce</h2>
<p class="comments-section">Currying is useful for many things. We can make new functions just by giving our base functions some arguments as seen in <code>hasSpaces</code>, <code>findSpaces</code>, and <code>censored</code>.</p>
<p class="comments-section">We also have the ability to transform any function that works on single elements into a function that works on arrays simply by wrapping it with <code>map</code>:</p>
<pre><code>var getChildren = function(x) {
  return x.childNodes;
};

var allTheChildren = map(getChildren);
</code></pre>
<p class="comments-section">Giving a function fewer arguments than it expects is typically called <em>partial application</em>. Partially applying a function can remove a lot of boiler plate code. Consider what the above <code>allTheChildren</code> function would be with the uncurried <code>map</code> from lodash (note the arguments are in a different order):</p>
<pre><code>var allTheChildren = function(elements) {
  return _.map(elements, getChildren);
};
</code></pre>
<p class="comments-section">We typically don't define functions that work on arrays, because we can just call <code>map(getChildren)</code> inline. Same with <code>sort</code>, <code>filter</code>, and other higher order functions(Higher order function: A function that takes or returns a function).</p>
<p class="comments-section">When we spoke about <em>pure functions</em>, we said they take 1 input to 1 output. Currying does exactly this: each single argument returns a new function expecting the remaining arguments. That, old sport, is 1 input to 1 output.</p>
<p class="comments-section">No matter if the output is another function - it qualifies as pure. We do allow more than one argument at a time, but this is seen as merely removing the extra <code>()</code>'s for convenience.</p>
<h2 id="in-summary">In summary</h2>
<p class="comments-section">Currying is handy and I very much enjoy working with curried functions on a daily basis. It is a tool for the belt that makes functional programming less verbose and tedious.</p>
<p class="comments-section">We can make new, useful functions on the fly simply by passing in a few arguments and as a bonus, we've retained the mathematical function definition despite multiple arguments.</p>
<p class="comments-section">Let's acquire another essential tool called <code>compose</code>.</p>
<p class="comments-section"><a href="ch5.html">Chapter 5: Coding by Composing</a></p>
<h2 id="exercises">Exercises</h2>
<p class="comments-section">A quick word before we start. We'll use a library called <a href="http://ramdajs.com" target="_blank">Ramda</a> which curries every function by default. Alternatively you may choose to use <a href="https://github.com/lodash/lodash/wiki/FP-Guide" target="_blank">lodash/fp</a> which does the same and is written/maintained by the creator of lodash. Both will work just fine and it is a matter of preference.</p>
<p class="comments-section">There are <a href="https://github.com/DrBoolean/mostly-adequate-guide/tree/master/code/part1_exercises" target="_blank">unit tests</a> to run against your exercises as you code them, or you can just copy-paste into a JavaScript REPL for the early exercises if you wish.</p>
<p class="comments-section">Answers are provided with the code in the <a href="https://github.com/DrBoolean/mostly-adequate-guide/tree/master/code/part1_exercises/answers" target="_blank">repository for this book</a>. Best way to do the exercises is with an <a href="feedback_loop.md">immediate feedback loop</a>.</p>
<pre><code>var _ = require('ramda');


// Exercise 1
//==============
// Refactor to remove all arguments by partially applying the function.

var words = function(str) {
  return _.split(' ', str);
};

// Exercise 1a
//==============
// Use map to make a new words fn that works on an array of strings.

var sentences = undefined;


// Exercise 2
//==============
// Refactor to remove all arguments by partially applying the functions.

var filterQs = function(xs) {
  return _.filter(function(x) {
    return match(/q/i, x);
  }, xs);
};


// Exercise 3
//==============
// Use the helper function _keepHighest to refactor max to not reference any
// arguments.

// LEAVE BE:
var _keepHighest = function(x, y) {
  return x &gt;= y ? x : y;
};

// REFACTOR THIS ONE:
var max = function(xs) {
  return _.reduce(function(acc, x) {
    return _keepHighest(acc, x);
  }, -Infinity, xs);
};


// Bonus 1:
// ============
// Wrap array's slice to be functional and curried.
// //[1, 2, 3].slice(0, 2)
var slice = undefined;


// Bonus 2:
// ============
// Use slice to define a function "take" that takes n elements from the beginning of the string. Make it curried.
// // Result for "Something" with n=4 should be "Some"
var take = undefined;
</code></pre>

                                
                                </section>
					</div>
				</article>
				<!--================= END :: Tutorial =================-->
				
				<!--================= START :: Tutorial =================-->
				<article>
					<a id="t-33" name="t-33"></a><h1>33 : Chapter 5: Coding by Composing</h1>
					<span class="ref-site">https://drboolean.gitbooks.io/mostly-adequate-guide/content/ch5.html</span>
					<div class="tutorial__content">
<section class="normal markdown-section">
                                
                                
<h2 id="functional-husbandry">Functional husbandry</h2>
<p class="comments-section">Here's <code>compose</code>:</p>
<pre><code>var compose = function(f, g) {
  return function(x) {
    return f(g(x));
  };
};
</code></pre>
<p class="comments-section"><code>f</code> and <code>g</code> are functions and <code>x</code> is the value being "piped" through them.</p>
<p class="comments-section">Composition feels like function husbandry. You, breeder of functions, select two with traits you'd like to combine and mash them together to spawn a brand new one. Usage is as follows:</p>
<pre><code>var toUpperCase = function(x) {
  return x.toUpperCase();
};
var exclaim = function(x) {
  return x + '!';
};
var shout = compose(exclaim, toUpperCase);

shout("send in the clowns");
//=&gt; "SEND IN THE CLOWNS!"
</code></pre>
<p class="comments-section">The composition of two functions returns a new function. This makes perfect sense: composing two units of some type (in this case function) should yield a new unit of that very type. You don't plug two legos together and get a lincoln log. There is a theory here, some underlying law that we will discover in due time.</p>
<p class="comments-section">In our definition of <code>compose</code>, the <code>g</code> will run before the <code>f</code>, creating a right to left flow of data. This is much more readable than nesting a bunch of function calls. Without compose, the above would read:</p>
<pre><code>var shout = function(x) {
  return exclaim(toUpperCase(x));
};
</code></pre>
<p class="comments-section">Instead of inside to outside, we run right to left, which I suppose is a step in the left direction(boo). Let's look at an example where sequence matters:</p>
<pre><code>var head = function(x) {
  return x[0];
};
var reverse = reduce(function(acc, x) {
  return [x].concat(acc);
}, []);
var last = compose(head, reverse);

last(['jumpkick', 'roundhouse', 'uppercut']);
//=&gt; 'uppercut'
</code></pre>
<p class="comments-section"><code>reverse</code> will turn the list around while <code>head</code> grabs the initial item. This results in an effective, albeit inefficient, <code>last</code> function. The sequence of functions in the composition should be apparent here. We could define a left to right version, however, we mirror the mathematical version much more closely as it stands. That's right, composition is straight from the math books. In fact, perhaps it's time to look at a property that holds for any composition.</p>
<pre><code>// associativity
var associative = compose(f, compose(g, h)) == compose(compose(f, g), h);
// true
</code></pre>
<p class="comments-section">Composition is associative, meaning it doesn't matter how you group two of them. So, should we choose to uppercase the string, we can write:</p>
<pre><code>compose(toUpperCase, compose(head, reverse));

// or
compose(compose(toUpperCase, head), reverse);
</code></pre>
<p class="comments-section">Since it doesn't matter how we group our calls to <code>compose</code>, the result will be the same. That allows us to write a variadic compose and use it as follows:</p>
<pre><code>// previously we'd have to write two composes, but since it's associative, we can give compose as many fn's as we like and let it decide how to group them.
var lastUpper = compose(toUpperCase, head, reverse);

lastUpper(['jumpkick', 'roundhouse', 'uppercut']);
//=&gt; 'UPPERCUT'


var loudLastUpper = compose(exclaim, toUpperCase, head, reverse);

loudLastUpper(['jumpkick', 'roundhouse', 'uppercut']);
//=&gt; 'UPPERCUT!'
</code></pre>
<p class="comments-section">Applying the associative property gives us this flexibility and peace of mind that the result will be equivalent. The slightly more complicated variadic definition is included with the support libraries for this book and is the normal definition you'll find in libraries like <a href="https://lodash.com/" target="_blank">lodash</a>, <a href="http://underscorejs.org/" target="_blank">underscore</a>, and <a href="http://ramdajs.com/" target="_blank">ramda</a>.</p>
<p class="comments-section">One pleasant benefit of associativity is that any group of functions can be extracted and bundled together in their very own composition. Let's play with refactoring our previous example:</p>
<pre><code>var loudLastUpper = compose(exclaim, toUpperCase, head, reverse);

// or
var last = compose(head, reverse);
var loudLastUpper = compose(exclaim, toUpperCase, last);

// or
var last = compose(head, reverse);
var angry = compose(exclaim, toUpperCase);
var loudLastUpper = compose(angry, last);

// more variations...
</code></pre>
<p class="comments-section">There's no right or wrong answers - we're just plugging our legos together in whatever way we please. Usually it's best to group things in a reusable way like <code>last</code> and <code>angry</code>. If familiar with Fowler's "<a href="http://martinfowler.com/books/refactoring.html" target="_blank">Refactoring</a>", one might recognize this process as "<a href="http://refactoring.com/catalog/extractMethod.html" target="_blank">extract method</a>"...except without all the object state to worry about.</p>
<h2 id="pointfree">Pointfree</h2>
<p class="comments-section">Pointfree style means never having to say your data. Excuse me. It means functions that never mention the data upon which they operate. First class functions, currying, and composition all play well together to create this style.</p>
<pre><code>//not pointfree because we mention the data: word
var snakeCase = function(word) {
  return word.toLowerCase().replace(/\s+/ig, '_');
};

//pointfree
var snakeCase = compose(replace(/\s+/ig, '_'), toLowerCase);
</code></pre>
<p class="comments-section">See how we partially applied <code>replace</code>? What we're doing is piping our data through each function of 1 argument. Currying allows us to prepare each function to just take its data, operate on it, and pass it along. Something else to notice is how we don't need the data to construct our function in the pointfree version, whereas in the pointful one, we must have our <code>word</code> available before anything else.</p>
<p class="comments-section">Let's look at another example.</p>
<pre><code>//not pointfree because we mention the data: name
var initials = function(name) {
  return name.split(' ').map(compose(toUpperCase, head)).join('. ');
};

//pointfree
var initials = compose(join('. '), map(compose(toUpperCase, head)), split(' '));

initials("hunter stockton thompson");
// 'H. S. T'
</code></pre>
<p class="comments-section">Pointfree code can again, help us remove needless names and keep us concise and generic. Pointfree is a good litmus test for functional code as it lets us know we've got small functions that take input to output. One can't compose a while loop, for instance. Be warned, however, pointfree is a double-edged sword and can sometimes obfuscate intention. Not all functional code is pointfree and that is O.K. We'll shoot for it where we can and stick with normal functions otherwise.</p>
<h2 id="debugging">Debugging</h2>
<p class="comments-section">A common mistake is to compose something like <code>map</code>, a function of two arguments, without first partially applying it.</p>
<pre><code>//wrong - we end up giving angry an array and we partially applied map with god knows what.
var latin = compose(map, angry, reverse);

latin(['frog', 'eyes']);
// error


// right - each function expects 1 argument.
var latin = compose(map(angry), reverse);

latin(['frog', 'eyes']);
// ['EYES!', 'FROG!'])
</code></pre>
<p class="comments-section">If you are having trouble debugging a composition, we can use this helpful, but impure trace function to see what's going on.</p>
<pre><code>var trace = curry(function(tag, x) {
  console.log(tag, x);
  return x;
});

var dasherize = compose(join('-'), toLower, split(' '), replace(/\s{2,}/ig, ' '));

dasherize('The world is a vampire');
// TypeError: Cannot read property 'apply' of undefined
</code></pre>
<p class="comments-section">Something is wrong here, let's <code>trace</code></p>
<pre><code>var dasherize = compose(join('-'), toLower, trace('after split'), split(' '), replace(/\s{2,}/ig, ' '));
// after split [ 'The', 'world', 'is', 'a', 'vampire' ]
</code></pre>
<p class="comments-section">Ah! We need to <code>map</code> this <code>toLower</code> since it's working on an array.</p>
<pre><code>var dasherize = compose(join('-'), map(toLower), split(' '), replace(/\s{2,}/ig, ' '));

dasherize('The world is a vampire');

// 'the-world-is-a-vampire'
</code></pre>
<p class="comments-section">The <code>trace</code> function allows us to view the data at a certain point for debugging purposes. Languages like haskell and purescript have similar functions for ease of development.</p>
<p class="comments-section">Composition will be our tool for constructing programs and, as luck would have it, is backed by a powerful theory that ensures things will work out for us. Let's examine this theory.</p>
<h2 id="category-theory">Category theory</h2>
<p class="comments-section">Category theory is an abstract branch of mathematics that can formalize concepts from several different branches such as set theory, type theory, group theory, logic, and more. It primarily deals with objects, morphisms, and transformations, which mirrors programming quite closely. Here is a chart of the same concepts as viewed from each separate theory.</p>
<p><img src="https://drboolean.gitbooks.io/mostly-adequate-guide/content/images/cat_theory.png" alt="category theory" draggable="true" data-bukket-ext-bukket-draggable="true"></p>
<p class="comments-section">Sorry, I didn't mean to frighten you. I don't expect you to be intimately familiar with all these concepts. My point is to show you how much duplication we have so you can see why category theory aims to unify these things.</p>
<p class="comments-section">In category theory, we have something called... a category. It is defined as a collection with the following components:</p>
<ul>
<li>A collection of objects</li>
<li>A collection of morphisms</li>
<li>A notion of composition on the morphisms</li>
<li>A distinguished morphism called identity</li>
</ul>
<p class="comments-section">Category theory is abstract enough to model many things, but let's apply this to types and functions, which is what we care about at the moment.</p>
<p class="comments-section"><strong>A collection of objects</strong>
The objects will be data types. For instance, <code>String</code>, <code>Boolean</code>, <code>Number</code>, <code>Object</code>, etc. We often view data types as sets of all the possible values. One could look at <code>Boolean</code> as the set of <code>[true, false]</code> and <code>Number</code> as the set of all possible numeric values. Treating types as sets is useful because we can use set theory to work with them.</p>
<p class="comments-section"><strong>A collection of morphisms</strong>
The morphisms will be our standard every day pure functions.</p>
<p class="comments-section"><strong>A notion of composition on the morphisms</strong>
This, as you may have guessed, is our brand new toy - <code>compose</code>. We've discussed that our <code>compose</code> function is associative which is no coincidence as it is a property that must hold for any composition in category theory.</p>
<p class="comments-section">Here is an image demonstrating composition:</p>
<p><img src="https://drboolean.gitbooks.io/mostly-adequate-guide/content/images/cat_comp1.png" alt="category composition 1" draggable="true" data-bukket-ext-bukket-draggable="true">
<img src="https://drboolean.gitbooks.io/mostly-adequate-guide/content/images/cat_comp2.png" alt="category composition 2" draggable="true" data-bukket-ext-bukket-draggable="true"></p>
<p class="comments-section">Here is a concrete example in code:</p>
<pre><code>var g = function(x) {
  return x.length;
};
var f = function(x) {
  return x === 4;
};
var isFourLetterWord = compose(f, g);
</code></pre>
<p class="comments-section"><strong>A distinguished morphism called identity</strong>
Let's introduce a useful function called <code>id</code>. This function simply takes some input and spits it back at you. Take a look:</p>
<pre><code>var id = function(x) {
  return x;
};
</code></pre>
<p class="comments-section">You might ask yourself "What in the bloody hell is that useful for?". We'll make extensive use of this function in the following chapters, but for now think of it as a function that can stand in for our value - a function masquerading as every day data.</p>
<p class="comments-section"><code>id</code> must play nicely with compose. Here is a property that always holds for every unary (unary: a one-argument function) function f:</p>
<pre><code>// identity
compose(id, f) == compose(f, id) == f;
// true
</code></pre>
<p class="comments-section">Hey, it's just like the identity property on numbers! If that's not immediately clear, take some time with it. Understand the futility. We'll be seeing <code>id</code> used all over the place soon, but for now we see it's a function that acts as a stand in for a given value. This is quite useful when writing pointfree code.</p>
<p class="comments-section">So there you have it, a category of types and functions. If this is your first introduction, I imagine you're still a little fuzzy on what a category is and why it's useful. We will build upon this knowledge throughout the book. As of right now, in this chapter, on this line, you can at least see it as providing us with some wisdom regarding composition - namely, the associativity and identity properties.</p>
<p class="comments-section">What are some other categories, you ask? Well, we can define one for directed graphs with nodes being objects, edges being morphisms, and composition just being path concatenation. We can define with Numbers as objects and <code>&gt;=</code> as morphisms (actually any partial or total order can be a category). There are heaps of categories, but for the purposes of this book, we'll only concern ourselves with the one defined above. We have sufficiently skimmed the surface and must move on.</p>
<h2 id="in-summary">In Summary</h2>
<p class="comments-section">Composition connects our functions together like a series of pipes. Data will flow through our application as it must - pure functions are input to output after all, so breaking this chain would disregard output, rendering our software useless.</p>
<p class="comments-section">We hold composition as a design principle above all others. This is because it keeps our app simple and reasonable. Category theory will play a big part in app architecture, modelling side effects, and ensuring correctness.</p>
<p class="comments-section">We are now at a point where it would serve us well to see some of this in practice. Let's make an example application.</p>
<p class="comments-section"><a href="ch6.html">Chapter 6: Example Application</a></p>
<h2 id="exercises">Exercises</h2>
<pre><code>var _ = require('ramda');
var accounting = require('accounting');

// Example Data
var CARS = [{
  name: 'Ferrari FF',
  horsepower: 660,
  dollar_value: 700000,
  in_stock: true,
}, {
  name: 'Spyker C12 Zagato',
  horsepower: 650,
  dollar_value: 648000,
  in_stock: false,
}, {
  name: 'Jaguar XKR-S',
  horsepower: 550,
  dollar_value: 132000,
  in_stock: false,
}, {
  name: 'Audi R8',
  horsepower: 525,
  dollar_value: 114200,
  in_stock: false,
}, {
  name: 'Aston Martin One-77',
  horsepower: 750,
  dollar_value: 1850000,
  in_stock: true,
}, {
  name: 'Pagani Huayra',
  horsepower: 700,
  dollar_value: 1300000,
  in_stock: false,
}];

// Exercise 1:
// ============
// Use _.compose() to rewrite the function below. Hint: _.prop() is curried.
var isLastInStock = function(cars) {
  var last_car = _.last(cars);
  return _.prop('in_stock', last_car);
};

// Exercise 2:
// ============
// Use _.compose(), _.prop() and _.head() to retrieve the name of the first car.
var nameOfFirstCar = undefined;


// Exercise 3:
// ============
// Use the helper function _average to refactor averageDollarValue as a composition.
var _average = function(xs) {
  return _.reduce(_.add, 0, xs) / xs.length;
}; // &lt;- leave be

var averageDollarValue = function(cars) {
  var dollar_values = _.map(function(c) {
    return c.dollar_value;
  }, cars);
  return _average(dollar_values);
};


// Exercise 4:
// ============
// Write a function: sanitizeNames() using compose that returns a list of lowercase and underscored car's names: e.g: sanitizeNames([{name: 'Ferrari FF', horsepower: 660, dollar_value: 700000, in_stock: true}]) //=&gt; ['ferrari_ff'].

var _underscore = _.replace(/\W+/g, '_'); //&lt;-- leave this alone and use to sanitize

var sanitizeNames = undefined;


// Bonus 1:
// ============
// Refactor availablePrices with compose.

var availablePrices = function(cars) {
  var available_cars = _.filter(_.prop('in_stock'), cars);
  return available_cars.map(function(x) {
    return accounting.formatMoney(x.dollar_value);
  }).join(', ');
};


// Bonus 2:
// ============
// Refactor to pointfree. Hint: you can use _.flip().

var fastestCar = function(cars) {
  var sorted = _.sortBy(function(car) {
    return car.horsepower;
  }, cars);
  var fastest = _.last(sorted);
  return fastest.name + ' is the fastest';
};
</code></pre>

                                
                                </section>
					</div>
				</article>
				<!--================= END :: Tutorial =================-->
				
				<!--================= START :: Tutorial =================-->
				<article>
					<a id="t-34" name="t-34"></a><h1>34 : Functional Mixins in ECMAScript 2015</h1>
					<span class="ref-site">http://raganwald.com/2015/06/17/functional-mixins.html</span>
					<div class="tutorial__content">
<section id="main_content">

          <p>In <a href="http://raganwald.com/2015/06/10/mixins.html">Prototypes are Objects</a>, we saw that you can emulate "mixins" using <code class="highlighter-rouge">Object.assign</code> on the prototypes that underly JavaScript "classes." We'll revisit this subject now and spend more time looking at mixing functionality into classes.</p>

<p>First, a quick recap: In JavaScript, a "class" is implemented as a constructor function and its prototype, whether you write it directly, or use the <code class="highlighter-rouge">class</code> keyword. Instances of the class are created by calling the constructor with <code class="highlighter-rouge">new</code>. They "inherit" shared behaviour from the constructor's <code class="highlighter-rouge">prototype</code> property.<sup id="fnref:delegate"><a href="#fn:delegate" class="footnote">1</a></sup></p>

<h3 id="the-object-mixin-pattern">the object mixin pattern</h3>

<p>One way to share behaviour scattered across multiple classes, or to untangle behaviour by factoring it out of an overweight prototype, is to extend a prototype with a <em>mixin</em>.</p>

<p>Here's a class of todo items:</p>

<pre><code>class Todo {
  constructor (name) {
    this.name = name || 'Untitled';
    this.done = false;
  }
  do () {
    this.done = true;
    return this;
  }
  undo () {
    this.done = false;
    return this;
  }
}
</code></pre>

<p>And a "mixin" that is responsible for colour-coding:</p>

<pre><code>const Coloured = {
  setColourRGB ({r, g, b}) {
    this.colourCode = {r, g, b};
    return this;
  },
  getColourRGB () {
    return this.colourCode;
  }
};
</code></pre>

<p>Mixing colour coding into our Todo prototype is straightforward:</p>

<pre><code>Object.assign(Todo.prototype, Coloured);

new Todo('test')
  .setColourRGB({r: 1, g: 2, b: 3})
  //=&gt; {"name":"test","done":false,"colourCode":{"r":1,"g":2,"b":3}}
</code></pre>

<p>We can "upgrade" it to have a <a href="http://raganwald.com/2015/06/04/classes-are-expressions.html">private property</a> if we wish:</p>

<pre><code>const colourCode = Symbol("colourCode");

const Coloured = {
  setColourRGB ({r, g, b}) {
    this[colourCode]= {r, g, b};
    return this;
  },
  getColourRGB () {
    return this[colourCode];
  }
};
</code></pre>

<p>So far, very easy and very simple. This is a <em>pattern</em>, a recipe for solving a certain problem using a particular organization of code.</p>


<h3 id="functional-mixins">functional mixins</h3>

<p>The object mixin we have above works properly, but our little recipe had two distinct steps: Define the mixin and then extend the class prototype. Angus Croll pointed out that it's more elegant to define a mixin as a function rather than an object. He calls this a <a href="https://javascriptweblog.wordpress.com/2011/05/31/a-fresh-look-at-javascript-mixins/" title="A fresh look at JavaScript Mixins">functional mixin</a>. Here's <code class="highlighter-rouge">Coloured</code> again, recast in functional form:</p>

<pre><code>const Coloured = (target) =&gt;
  Object.assign(target, {
    setColourRGB ({r, g, b}) {
      this.colourCode = {r, g, b};
      return this;
    },
    getColourRGB () {
      return this.colourCode;
    }
  });

Coloured(Todo.prototype);
</code></pre>

<p>We can make ourselves a <em>factory function</em> that also names the pattern:</p>

<pre><code>const FunctionalMixin = (behaviour) =&gt;
  target =&gt; Object.assign(target, behaviour);
</code></pre>

<p>This allows us to define functional mixins neatly:</p>

<pre><code>const Coloured = FunctionalMixin({
  setColourRGB ({r, g, b}) {
    this.colourCode = {r, g, b};
    return this;
  },
  getColourRGB () {
    return this.colourCode;
  }
});
</code></pre>

<h3 id="enumerability">enumerability</h3>

<p>If we look at the way <code class="highlighter-rouge">class</code> defines prototypes, we find that the methods defined are not enumerable by default. This works around a common error where programmers iterate over the keys of an instance and fail to test for <code class="highlighter-rouge">.hasOwnProperty</code>.</p>

<p>Our object mixin pattern does not work this way, the methods defined in a mixin <em>are</em> enumerable by default, and if we carefully defined them to be non-enumerable, <code class="highlighter-rouge">Object.assign</code> wouldn't mix them into the target prototype, because <code class="highlighter-rouge">Object.assign</code> only assigns enumerable properties.</p>

<p>And thus:</p>

<pre><code>Coloured(Todo.prototype)

const urgent = new Todo("finish blog post");
urgent.setColourRGB({r: 256, g: 0, b: 0});

for (let property in urgent) console.log(property);
  // =&gt;
    name
    done
    colourCode
    setColourRGB
    getColourRGB
</code></pre>

<p>As we can see, the <code class="highlighter-rouge">setColourRGB</code> and <code class="highlighter-rouge">getColourRGB</code> methods are enumerated, although the <code class="highlighter-rouge">do</code> and <code class="highlighter-rouge">undo</code> methods are not. This can be a problem with naïve code: we can't always rewrite all the <em>other</em> code to carefully use <code class="highlighter-rouge">.hasOwnProperty</code>.</p>

<p>One benefit of functional mixins is that we can solve this problem and transparently make mixins behave like <code class="highlighter-rouge">class</code>:</p>

<pre><code>const FunctionalMixin = (behaviour) =&gt;
  function (target) {
    for (let property of Reflect.ownKeys(behaviour))
      Object.defineProperty(target, property, { value: behaviour[property] })
    return target;
  }
</code></pre>

<p>Writing this out as a pattern would be tedious and error-prone. Encapsulating the behaviour into a function is a small win.</p>

<h3 id="mixin-responsibilities">mixin responsibilities</h3>

<p>Like classes, mixins are metaobjects: They define behaviour for instances. In addition to defining behaviour in the form of methods, classes are also responsible for initializing instances. But sometimes, classes and metaobjects handle additional responsibilities.</p>

<p>For example, sometimes a particular concept is associated with some well-known constants. When using a class, can be handy to namespace such values in the class itself:</p>

<pre><code>class Todo {
  constructor (name) {
    this.name = name || Todo.DEFAULT_NAME;
    this.done = false;
  }
  do () {
    this.done = true;
    return this;
  }
  undo () {
    this.done = false;
    return this;
  }
}

Todo.DEFAULT_NAME = 'Untitled';

// If we are sticklers for read-only constants, we could write:
// Object.defineProperty(Todo, 'DEFAULT_NAME', {value: 'Untitled'});
</code></pre>

<p>We can't really do the same thing with simple mixins, because all of the properties in a simple mixin end up being mixed into the prototype of instances we create by default. For example, let's say we want to define <code class="highlighter-rouge">Coloured.RED</code>, <code class="highlighter-rouge">Coloured.GREEN</code>, and <code class="highlighter-rouge">Coloured.BLUE</code>. But we don't want any specific coloured instance to define <code class="highlighter-rouge">RED</code>, <code class="highlighter-rouge">GREEN</code>, or <code class="highlighter-rouge">BLUE</code>.</p>

<p>Again, we can solve this problem by building a functional mixin. Our <code class="highlighter-rouge">FunctionalMixin</code> factory function will accept an optional dictionary of read-only mixin properties, provided they are associated with a special key:</p>

<pre><code>const shared = Symbol("shared");

function FunctionalMixin (behaviour) {
  const instanceKeys = Reflect.ownKeys(behaviour)
    .filter(key =&gt; key !== shared);
  const sharedBehaviour = behaviour[shared] || {};
  const sharedKeys = Reflect.ownKeys(sharedBehaviour);

  function mixin (target) {
    for (let property of instanceKeys)
      Object.defineProperty(target, property, { value: behaviour[property] });
    return target;
  }
  for (let property of sharedKeys)
    Object.defineProperty(mixin, property, {
      value: sharedBehaviour[property],
      enumerable: sharedBehaviour.propertyIsEnumerable(property)
    });
  return mixin;
}

FunctionalMixin.shared = shared;
</code></pre>

<p>And now we can write:</p>

<pre><code>const Coloured = FunctionalMixin({
  setColourRGB ({r, g, b}) {
    this.colourCode = {r, g, b};
    return this;
  },
  getColourRGB () {
    return this.colourCode;
  },
  [FunctionalMixin.shared]: {
    RED:   { r: 255, g: 0,   b: 0   },
    GREEN: { r: 0,   g: 255, b: 0   },
    BLUE:  { r: 0,   g: 0,   b: 255 },
  }
});

Coloured(Todo.prototype)

const urgent = new Todo("finish blog post");
urgent.setColourRGB(Coloured.RED);

urgent.getColourRGB()
  //=&gt; {"r":255,"g":0,"b":0}
</code></pre>

<h3 id="mixin-methods">mixin methods</h3>

<p>Such properties need not be values. Sometimes, classes have methods. And likewise, sometimes it makes sense for a mixin to have its own methods. One example concerns <code class="highlighter-rouge">instanceof</code>.</p>

<p>In earlier versions of ECMAScript, <code class="highlighter-rouge">instanceof</code> is an operator that checks to see whether the prototype of an instance matches the prototype of a constructor function. It works just fine with "classes," but it does not work "out of the box" with mixins:</p>

<pre><code>urgent instanceof Todo
  //=&gt; true

urgent instanceof Coloured
  //=&gt; false
</code></pre>

<p>To handle this and some other issues where programmers are creating their own notion of dynamic types, or managing prototypes directly with <code class="highlighter-rouge">Object.create</code> and <code class="highlighter-rouge">Object.setPrototypeOf</code>, ECMAScript 2015 provides a way to override the built-in <code class="highlighter-rouge">instanceof</code> behaviour: An object can define a method associated with a well-known symbol, <code class="highlighter-rouge">Symbol.hasInstance</code>.</p>

<p>We can test this quickly:<sup id="fnref:but"><a href="#fn:but" class="footnote">2</a></sup></p>

<pre><code>Object.defineProperty(Coloured, Symbol.hasInstance, {value: (instance) =&gt; true});
urgent instanceof Coloured
  //=&gt; true
{} instanceof Coloured
  //=&gt; true
</code></pre>

<p>Of course, that is not semantically correct. But using this technique, we can write:</p>

<pre><code>const shared = Symbol("shared");

function FunctionalMixin (behaviour) {
  const instanceKeys = Reflect.ownKeys(behaviour)
    .filter(key =&gt; key !== shared);
  const sharedBehaviour = behaviour[shared] || {};
  const sharedKeys = Reflect.ownKeys(sharedBehaviour);
  const typeTag = Symbol("isA");

  function mixin (target) {
    for (let property of instanceKeys)
      Object.defineProperty(target, property, { value: behaviour[property] });
    target[typeTag] = true;
    return target;
  }
  for (let property of sharedKeys)
    Object.defineProperty(mixin, property, {
      value: sharedBehaviour[property],
      enumerable: sharedBehaviour.propertyIsEnumerable(property)
    });
  Object.defineProperty(mixin, Symbol.hasInstance, {value: (instance) =&gt; !!instance[typeTag]});
  return mixin;
}

FunctionalMixin.shared = shared;

urgent instanceof Coloured
  //=&gt; true
{} instanceof Coloured
  //=&gt; false
</code></pre>

<p>Do you need to implement <code class="highlighter-rouge">instanceof</code>? Quite possibly not. "Rolling your own polymorphism" is usually a last resort. But it can be handy for writing test cases, and a few daring framework developers might be working on multiple dispatch and pattern-matching for functions.</p>

<h3 id="summary">summary</h3>

<p>The charm of the object mixin pattern is its simplicity: It really does not need an abstraction wrapped around an object literal and <code class="highlighter-rouge">Object.assign</code>.</p>

<p>However, behaviour defined with the mixin pattern is <em>slightly</em> different than behaviour defined with the <code class="highlighter-rouge">class</code> keyword. Two examples of these differences are enumerability and mixin properties (such as constants and mixin methods like <code class="highlighter-rouge">[Symbol.hasInstance]</code>).</p>

<p>Functional mixins provide an opportunity to implement such functionality, at the cost of some complexity in the <code class="highlighter-rouge">FunctionalMixin</code> function that creates functional mixins.</p>

<p>As a general rule, it's best to have things behave as similarly as possible in the domain code, and this sometimes does involve some extra complexity in the infrastructure code. But that is more of a guideline than a hard-and-fast rule, and for this reason there is a place for both the object mixin pattern <em>and</em> functional mixins in JavaScript.</p>

<p>(discuss on <a href="https://news.ycombinator.com/item?id=9734774">hacker news</a> and <a href="http://www.reddit.com/r/javascript/comments/3a7hxz/functional_mixins_in_ecmascript_2015/">/r/javascript</a>)</p>

<p><em>follow-up</em>: <a href="http://raganwald.com/2015/06/20/purely-functional-composition.html">Purely Functional Composition</a></p>

<hr>

<p>more reading:</p>

<ul>
  <li><a href="http://raganwald.com/2015/06/10/mixins.html">Prototypes are Objects (and why that matters)</a></li>
  <li><a href="http://raganwald.com/2015/06/04/classes-are-expressions.html">Classes are Expressions (and why that matters)</a></li>
  <li><a href="http://raganwald.com/2015/06/17/functional-mixins.html">Functional Mixins in ECMAScript 2015</a></li>
  <li><a href="http://raganwald.com/2015/06/26/decorators-in-es7.html">Using ES.later Decorators as Mixins</a></li>
  <li><a href="http://raganwald.com/2015/08/05/method-advice.html">Method Advice in Modern JavaScript</a></li>
  <li><a href="http://raganwald.com/2015/12/23/super-considered-hmmmful.html"><code class="highlighter-rouge">super()</code> considered hmmm-ful</a></li>
  <li><a href="http://raganwald.com/2015/12/28/mixins-subclass-factories-and-method-advice.html">JavaScript Mixins, Subclass Factories, and Method Advice</a></li>
  <li><a href="http://raganwald.com/2015/12/31/this-is-not-an-essay-about-traits-in-javascript.html">This is not an essay about 'Traits in Javascript'</a></li>
</ul>

<p>notes:</p>

<div class="footnotes">
  <ol>
    <li id="fn:delegate">
      <p>A much better way to put it is that objects with a prototype <em>delegate</em> behaviour to their prototype (and that may in turn delegate behaviour to its prototype if it has one, and so on).&nbsp;<a href="#fnref:delegate" class="reversefootnote">↩</a></p>
    </li>
    <li id="fn:but">
      <p>This may <strong>not</strong> work with various transpilers and other incomplete ECMAScript 2015 implementations. Check the documentation. For example, you must enable the "high compliancy" mode in <a href="http://babeljs.io">BabelJS</a>. This is off by default to provide the highest possible performance for code bases that do not need to use features like this.&nbsp;<a href="#fnref:but" class="reversefootnote">↩</a></p>
    </li>
  </ol>
</div>

        </section>
					</div>
				</article>
				<!--================= END :: Tutorial =================-->
				
				<!--================= START :: Tutorial =================-->
				<article>
					<a id="t-35" name="t-35"></a><h1>35 : JavaScript Mixins, Subclass Factories, and Method Advice</h1>
					<span class="ref-site">http://raganwald.com/2015/12/28/mixins-subclass-factories-and-method-advice.html</span>
					<div class="tutorial__content">
<section id="main_content">

          <p><em>Mixins</em> solve a very common problem in class-centric OOP: For non-trivial applications, there is a messy many-to-many relationship between behaviour and classes, and it does not neatly decompose into a tree. In this essay, we only touch lightly over the benefits of using mixins with classes, and in their stead we will focus on some of the limitations of mixins and ways to not just overcome them, but create designs that are superior to those created with classes alone.</p>

<p>(For more on why mixins matter in the first place, you may want to review <a href="http://raganwald.com/2015/06/10/mixins.html">Prototypes are Objects (and why that matters)</a>, <a href="http://raganwald.com/2015/06/17/functional-mixins.html">Functional Mixins in ECMAScript 2015</a>, and <a href="http://raganwald.com/2015/06/26/decorators-in-es7.html">Using ES.later Decorators as Mixins</a>.)</p>



<h3 id="simple-mixins">simple mixins</h3>

<p>As noted above, for non-trivial applications, there is a messy many-to-many relationship between behaviour and classes. However, JavaScript's single-inheritance model forces us to organize behaviour in trees, which can only represent one-to-many relationships.</p>

<p>The mixin solution to this problem is to leave classes in a single inheritance hierarchy, and to mix additional behaviour into individual classes as needed. Here's a vastly simplified functional mixin for classes:<sup id="fnref:simplified"><a href="#fn:simplified" class="footnote">1</a></sup></p>

<pre><code>function mixin (behaviour) {
  let instanceKeys = Reflect.ownKeys(behaviour);
  let typeTag = Symbol('isa');

  function _mixin (clazz) {
    for (let property of instanceKeys)
      Object.defineProperty(clazz.prototype, property, {
        value: behaviour[property],
        writable: true
      });
    Object.defineProperty(clazz.prototype, typeTag, { value: true });
    return clazz;
  }
  Object.defineProperty(_mixin, Symbol.hasInstance, {
    value: (i) =&gt; !!i[typeTag]
  });
  return _mixin;
}
</code></pre>

<p>This is more than enough to do a lot of very good work in JavaScript, but it's just the starting point. Here's how we put it to work:</p>

<pre><code>let BookCollector = mixin({
  addToCollection (name) {
    this.collection().push(name);
    return this;
  },
  collection () {
    return this._collected_books || (this._collected_books = []);
  }
});

class Person {
  constructor (first, last) {
    this.rename(first, last);
  }
  fullName () {
    return this.firstName + " " + this.lastName;
  }
  rename (first, last) {
    this.firstName = first;
    this.lastName = last;
    return this;
  }
}

let Executive = BookCollector(
  class extends Person {
    constructor (title, first, last) {
      super(first, last);
      this.title = title;
    }

    fullName () {
      return `${this.title} ${super.fullName()}`;
    }
  }
);

let president = new Executive('President', 'Barak', 'Obama');

president
  .addToCollection("JavaScript Allongé")
  .addToCollection("Kestrels, Quirky Birds, and Hopeless Egocentricity");

president.collection()
  //=&gt; ["JavaScript Allongé","Kestrels, Quirky Birds, and Hopeless Egocentricity"]
</code></pre>

<h3 id="multiple-inheritance">multiple inheritance</h3>

<p>If you want to mix behaviour into a class, mixins do the job very nicely. But sometimes, people want more. They want <strong>multiple inheritance</strong>. Meaning, what they really want is for class <code class="highlighter-rouge">Executive</code> to inherit from <code class="highlighter-rouge">Person</code> <em>and</em> from <code class="highlighter-rouge">BookCollector</code>.</p>

<p>What's the difference between <code class="highlighter-rouge">Executive</code> mixing <code class="highlighter-rouge">BookCollector</code> in and <code class="highlighter-rouge">Executive</code> inheriting from <code class="highlighter-rouge">BookCollector</code>?</p>

<ol>
  <li>If <code class="highlighter-rouge">Executive</code> mixes <code class="highlighter-rouge">BookCollector</code> in, the properties <code class="highlighter-rouge">addToCollection</code> and <code class="highlighter-rouge">collection</code> become own properties of <code class="highlighter-rouge">Executive</code>'s prototype. If <code class="highlighter-rouge">Executive</code> inherits from <code class="highlighter-rouge">BookCollector</code>, they don't.<br><br></li>
  <li>If <code class="highlighter-rouge">Executive</code> mixes <code class="highlighter-rouge">BookCollector</code> in, <code class="highlighter-rouge">Executive</code> can't override methods of <code class="highlighter-rouge">BookCollector</code>. If <code class="highlighter-rouge">Executive</code> inherits from <code class="highlighter-rouge">BookCollector</code>, it can.<br><br></li>
  <li>If <code class="highlighter-rouge">Executive</code> mixes <code class="highlighter-rouge">BookCollector</code> in, <code class="highlighter-rouge">Executive</code> can't override methods of <code class="highlighter-rouge">BookCollector</code>, and therefore it can't make a method that overrides a method of <code class="highlighter-rouge">BookCollector</code> and then uses <code class="highlighter-rouge">super</code> to call the original. If <code class="highlighter-rouge">Executive</code> inherits from <code class="highlighter-rouge">BookCollector</code>, it can.</li>
</ol>

<p>If JavaScript had multiple inheritance, we could extend a class with more than one superclass:</p>

<pre><code>class Todo {
  constructor (name) {
    this.name = name || 'Untitled';
    this.done = false;
  }

  do () {
    this.done = true;
    return this;
  }

  undo () {
    this.done = false;
    return this;
  }

  toHTML () {
    return this.name; // highly insecure
  }
}

class Coloured {
  setColourRGB ({r, g, b}) {
    this.colourCode = {r, g, b};
    return this;
  }

  getColourRGB () {
    return this.colourCode;
  }
}

let yellow = {r: 'FF', g: 'FF', b: '00'},
    red    = {r: 'FF', g: '00', b: '00'},
    green  = {r: '00', g: 'FF', b: '00'},
    grey   = {r: '80', g: '80', b: '80'};

let oneDayInMilliseconds = 1000 * 60 * 60 * 24;

class TimeSensitiveTodo extends Todo, Coloured {
  constructor (name, deadline) {
    super(name);
    this.deadline = deadline;
  }

  getColourRGB () {
    let slack = this.deadline - Date.now();

    if (this.done) {
      return grey;
    }
    else if (slack &lt;= 0) {
      return red;
    }
    else if (slack &lt;= oneDayInMilliseconds){
      return yellow;
    }
    else return green;
  }

  toHTML () {
    let rgb = this.getColourRGB();

    return `<span style="color: #${rgb.r}${rgb.g}${rgb.b};">${super.toHTML()}</span>`;
  }
}
</code></pre>

<p>This hypothetical <code class="highlighter-rouge">TimeSensitiveTodo</code> extends both <code class="highlighter-rouge">Todo</code> and <code class="highlighter-rouge">Coloured</code>, and it overrides <code class="highlighter-rouge">toHTML</code> from <code class="highlighter-rouge">Todo</code> as well as overriding <code class="highlighter-rouge">getColourRGB</code> from <code class="highlighter-rouge">Coloured</code>.</p>

<h3 id="subclass-factories">subclass factories</h3>

<p>However, JavaScript does not have "true" multiple inheritance, and therefore this code does not work. But we can simulate multiple inheritance for cases like this. The way it works is to step back and ask ourselves, "What would we do if we didn't have mixins or multiple inheritance?"</p>

<p>The answer is, we'd force a square multiple inheritance peg into a round single inheritance hole, like this:</p>

<pre><code>class Todo {
  // ...
}

class ColouredTodo extends Todo {
  // ...
}

class TimeSensitiveTodo extends ColouredTodo {
  // ...
}
</code></pre>

<p>By making <code class="highlighter-rouge">ColouredTodo</code> extend <code class="highlighter-rouge">Todo</code>, <code class="highlighter-rouge">TimeSensitiveTodo</code> can extend <code class="highlighter-rouge">ColouredTodo</code> and override methods from both. This is exactly what most programmers do, and we know that it is an anti-pattern, as it leads to duplicated class behaviour and deep class hierarchies.</p>

<p>But.</p>

<p>What if, instead of manually creating this hierarchy, we use our simple mixins to do the work for us? We can take advantage of the fact that <a href="http://raganwald.com/2015/06/04/classes-are-expressions.html">classes are expressions</a>, like this:</p>

<pre><code>let Coloured = mixin({
  setColourRGB ({r, g, b}) {
    this.colourCode = {r, g, b};
    return this;
  },

  getColourRGB () {
    return this.colourCode;
  }
});

let ColouredTodo = Coloured(class extends Todo {});
</code></pre>

<p>Thus, we have a <code class="highlighter-rouge">ColouredTodo</code> that we can extend and override, but we also have our <code class="highlighter-rouge">Coloured</code> behaviour in a mixin we can use anywhere we like without duplicating its functionality in our code. The full solution looks like this:</p>

<pre><code>class Todo {
  constructor (name) {
    this.name = name || 'Untitled';
    this.done = false;
  }

  do () {
    this.done = true;
    return this;
  }

  undo () {
    this.done = false;
    return this;
  }

  toHTML () {
    return this.name; // highly insecure
  }
}

let Coloured = mixin({
  setColourRGB ({r, g, b}) {
    this.colourCode = {r, g, b};
    return this;
  },

  getColourRGB () {
    return this.colourCode;
  }
});

let ColouredTodo = Coloured(class extends Todo {});

let yellow = {r: 'FF', g: 'FF', b: '00'},
    red    = {r: 'FF', g: '00', b: '00'},
    green  = {r: '00', g: 'FF', b: '00'},
    grey   = {r: '80', g: '80', b: '80'};

let oneDayInMilliseconds = 1000 * 60 * 60 * 24;

class TimeSensitiveTodo extends ColouredTodo {
  constructor (name, deadline) {
    super(name);
    this.deadline = deadline;
  }

  getColourRGB () {
    let slack = this.deadline - Date.now();

    if (this.done) {
      return grey;
    }
    else if (slack &lt;= 0) {
      return red;
    }
    else if (slack &lt;= oneDayInMilliseconds){
      return yellow;
    }
    else return green;
  }

  toHTML () {
    let rgb = this.getColourRGB();

    return `<span style="color: #${rgb.r}${rgb.g}${rgb.b};">${super.toHTML()}</span>`;
  }
}

let task = new TimeSensitiveTodo('Finish blog post', Date.now() + oneDayInMilliseconds);

task.toHTML()
  //=&gt; <span style="color: #FFFF00;">Finish blog post</span>
</code></pre>

<p>The key snippet is <code class="highlighter-rouge">let ColouredTodo = Coloured(class extends Todo {});</code>, it turns behaviour into a subclass that can be extended and overridden. We can turn this pattern into a function:</p>

<pre><code>let subclassFactory = (behaviour) =&gt; {
  let mixBehaviourInto = mixin(behaviour);

  return (superclazz) =&gt; mixBehaviourInto(class extends superclazz {});
}
</code></pre>

<p>Using <code class="highlighter-rouge">subclassFactory</code>, we wrap the class we want to extend, instead of the class we are declaring. Like this:</p>

<pre><code>let subclassFactory = (behaviour) =&gt; {
  let mixBehaviourInto = mixin(behaviour);

  return (superclazz) =&gt; mixBehaviourInto(class extends superclazz {});
}

let ColouredAsWellAs = subclassFactory({
  setColourRGB ({r, g, b}) {
    this.colourCode = {r, g, b};
    return this;
  },

  getColourRGB () {
    return this.colourCode;
  }
});

class TimeSensitiveTodo extends ColouredAsWellAs(ToDo) {
  constructor (name, deadline) {
    super(name);
    this.deadline = deadline;
  }

  getColourRGB () {
    let slack = this.deadline - Date.now();

    if (this.done) {
      return grey;
    }
    else if (slack &lt;= 0) {
      return red;
    }
    else if (slack &lt;= oneDayInMilliseconds){
      return yellow;
    }
    else return green;
  }

  toHTML () {
    let rgb = this.getColourRGB();

    return `<span style="color: #${rgb.r}${rgb.g}${rgb.b};">${super.toHTML()}</span>`;
  }
}
</code></pre>

<p>The syntax of <code class="highlighter-rouge">class TimeSensitiveTodo extends ColouredAsWellAs(ToDo)</code> says exactly what we mean: We are extending our <code class="highlighter-rouge">Coloured</code> behaviour as well as extending <code class="highlighter-rouge">ToDo</code>.<sup id="fnref:fagnani"><a href="#fn:fagnani" class="footnote">2</a></sup></p>

<h3 id="another-way-forward">another way forward</h3>

<p>The solution subclass factories offer is emulating inheritance from more than one superclass. That, in turn, makes it possible to override methods from our superclass as well as the behaviour we want to mix in. Which is fine, but we don't actually want multiple inheritance!</p>

<p>It's just that we're looking at an overriding/extending methods problem, but we're holding an inheritance-shaped hammer. So it looks like a multiple-inheritance nail. But what if we address the problem of overriding and extending methods directly, rather than indirectly via multiple inheritance?</p>

<h3 id="simple-overwriting-with-simple-mixins">simple overwriting with simple mixins</h3>

<p>We start by noting that in the first pass of our <code class="highlighter-rouge">mixin</code> function, we blindly copied properties from the mixin into the class's prototype, whether the class defined those properties or not. So if we write:</p>

<pre><code>let RED        = { r: 'FF', g: '00', b: '00' },
    WHITE      = { r: 'FF', g: 'FF', b: 'FF' },
    ROYAL_BLUE = { r: '41', g: '69', b: 'E1' },
    LIGHT_BLUE = { r: 'AD', g: 'D8', b: 'E6' };

let BritishRoundel = mixin({
  shape () {
    return 'round';
  },

  roundels () {
    return [RED, WHITE, ROYAL_BLUE];
  }
})

let CanadianAirForceRoundel = BritishRoundel(class {
  roundels () {
    return [RED, WHITE, LIGHT_BLUE];
  }
});

new CanadianAirForceRoundel().roundels()
  //=&gt; [
    {"r":"FF","g":"00","b":"00"},
    {"r":"FF","g":"FF","b":"FF"},
    {"r":"41","g":"69","b":"E1"}
  ]
</code></pre>

<p>Our <code class="highlighter-rouge">CanadianAirForceRoundel</code>'s third stripe winds up being regular blue instead of light blue, because the <code class="highlighter-rouge">roundels</code> method from the mixin <code class="highlighter-rouge">BritishRoundel</code> overwrites its own. (Yes, this is a ridiculous example, but it gets the point across.)</p>

<p>We can fix this by not overwriting a property if the class already defines it. That's not so hard:</p>

<pre><code>function mixin (behaviour) {
  let instanceKeys = Reflect.ownKeys(behaviour);
  let typeTag = Symbol('isa');

  function _mixin (clazz) {
    for (let property of instanceKeys)
      if (!clazz.prototype.hasOwnProperty(property)) {
        Object.defineProperty(clazz.prototype, property, {
          value: behaviour[property],
          writable: true
        });
      }
    Object.defineProperty(clazz.prototype, typeTag, { value: true });
    return clazz;
  }
  Object.defineProperty(_mixin, Symbol.hasInstance, {
    value: (i) =&gt; !!i[typeTag]
  });
  return _mixin;
}
</code></pre>

<p>Now we can override <code class="highlighter-rouge">roundels</code> in <code class="highlighter-rouge">CanadianAirForceRoundel</code> while mixing <code class="highlighter-rouge">shape</code> in just fine:</p>

<pre><code>new CanadianAirForceRoundel().roundels()
  //=&gt; [
    {"r":"FF","g":"00","b":"00"},
    {"r":"FF","g":"FF","b":"FF"},
    {"r":"AD","g":"D8","b":"E6"}
  ]
</code></pre>

<p>The method defined in the class is now the "definition of record," just as we might expect. But it's not enough in and of itself.</p>

<h3 id="combining-advice-with-simple-mixins">combining advice with simple mixins</h3>

<p>The above adjustment to 'mixin' is fine for simple overwriting, but what about when we wish to modify or extend a method's behaviour while still invoking the original? Recall that our <code class="highlighter-rouge">TimeSensitiveTodo</code> example performed a simple override of <code class="highlighter-rouge">getColourRGB</code>, but its implementation of <code class="highlighter-rouge">toHTML</code> used <code class="highlighter-rouge">super</code> to invoke the method it was overriding.</p>

<p>Our adjustment will not allow a method in the class to invoke the body of a method in a mixin. So we can't use it to implement <code class="highlighter-rouge">TimeSensitiveTodo</code>. For that, we need a different tool, <a href="http://raganwald.com/2015/08/05/method-advice.html">method advice</a>.</p>

<p>Method advice is a powerful tool in its own right: It allows us to compose method functionality in a declarative way. Here's a simple "override" function that decorates a class:</p>

<pre><code>let override = (behaviour, ...overriddenMethodNames) =&gt;
  (clazz) =&gt; {
    if (typeof behaviour === 'string') {
      behaviour = clazz.prototype[behaviour];
    }
    for (let overriddenMethodName of overriddenMethodNames) {
      let overriddenMethodFunction = clazz.prototype[overriddenMethodName];

      Object.defineProperty(clazz.prototype, overriddenMethodName, {
        value: function (...args) {
          return behaviour.call(this, overriddenMethodFunction.bind(this), ...args);
        },
        writable: true
      });
    }
    return clazz;
  };
</code></pre>

<p>It takes behaviour in the form of a name of a method or a function, and one or more names of methods to override. It overrides each of the methods with the behaviour, which is invoked with the overridden method's function as the first argument.</p>

<p>This allows us to invoke the original without needing to use <code class="highlighter-rouge">super</code>. And although we don't show all the other use cases here, it is handy for far more than overriding mixin methods, it can be used to decompose methods into separate responsibilities.</p>

<p>Using <code class="highlighter-rouge">override</code>, we can decorate methods with any arbitrary functionality. We'd use it like this:</p>

<pre><code>class Todo {
  constructor (name) {
    this.name = name || 'Untitled';
    this.done = false;
  }

  do () {
    this.done = true;
    return this;
  }

  undo () {
    this.done = false;
    return this;
  }

  toHTML () {
    return this.name; // highly insecure
  }
}

let Coloured = mixin({
  setColourRGB ({r, g, b}) {
    this.colourCode = {r, g, b};
    return this;
  },

  getColourRGB () {
    return this.colourCode;
  }
});

let yellow = {r: 'FF', g: 'FF', b: '00'},
    red    = {r: 'FF', g: '00', b: '00'},
    green  = {r: '00', g: 'FF', b: '00'},
    grey   = {r: '80', g: '80', b: '80'};

let oneDayInMilliseconds = 1000 * 60 * 60 * 24;

let TimeSensitiveTodo = override('wrapWithColour', 'toHTML')(
  Coloured(
    class extends Todo {
      constructor (name, deadline) {
        super(name);
        this.deadline = deadline;
      }

      getColourRGB () {
        let slack = this.deadline - Date.now();

        if (this.done) {
          return grey;
        }
        else if (slack &lt;= 0) {
          return red;
        }
        else if (slack &lt;= oneDayInMilliseconds){
          return yellow;
        }
        else return green;
      }

      wrapWithColour (original) {
        let rgb = this.getColourRGB();

        return `<span style="color: #${rgb.r}${rgb.g}${rgb.b};">${original()}</span>`;
      }
    }
  )
);
let task = new TimeSensitiveTodo('Finish blog post', Date.now() + oneDayInMilliseconds);

task.toHTML()
  //=&gt; <span style="color: #FFFF00;">Finish blog post</span>
</code></pre>

<p>With this solution, we've used our revamped mixin function to support <code class="highlighter-rouge">getColourRGB</code> overriding the mixin's definition, and we've used <code class="highlighter-rouge">override</code> to support wrapping functionality around the original <code class="highlighter-rouge">toHTML</code> method.</p>

<p>As a final bonus, if we are using a transpiler that supports ES.who-knows-when, we can use the proposed class decorator syntax:</p>

<pre><code>@override('wrapWithColour', 'toHTML')
@Coloured
class TimeSensitiveTodo extends Todo {
  constructor (name, deadline) {
    super(name);
    this.deadline = deadline;
  }

  getColourRGB () {
    let slack = this.deadline - Date.now();

    if (this.done) {
      return grey;
    }
    else if (slack &lt;= 0) {
      return red;
    }
    else if (slack &lt;= oneDayInMilliseconds){
      return yellow;
    }
    else return green;
  }

  wrapWithColour (original) {
    let rgb = this.getColourRGB();

    return `<span style="color: #${rgb.r}${rgb.g}${rgb.b};">${original()}</span>`;
  }
}
</code></pre>

<p>This is extremely readable.</p>

<h3 id="method-advice-beyond-extending-mixin-methods">method advice beyond extending mixin methods</h3>

<p><code class="highlighter-rouge">override</code> in and of itself is not spectacular. But most functionality that extends the behaviour of a method doesn't process the result of the original. Most extensions do some work <em>before</em> the method is invoked, or do some work <em>after</em> the method is invoked.</p>

<p>So in addition to <code class="highlighter-rouge">override</code>, or toolbox should include <code class="highlighter-rouge">before</code> and <code class="highlighter-rouge">after</code> method advice. <code class="highlighter-rouge">before</code> invokes the behaviour first, and if its return value is <code class="highlighter-rouge">undefined</code> or <code class="highlighter-rouge">truthy</code>, it invokes the decorated method:</p>

<pre><code>let before = (behaviour, ...decoratedMethodNames) =&gt;
  (clazz) =&gt; {
    if (typeof behaviour === 'string') {
      behaviour = clazz.prototype[behaviour];
    }
    for (let decoratedMethodName of decoratedMethodNames) {
      let decoratedMethodFunction = clazz.prototype[decoratedMethodName];

      Object.defineProperty(clazz.prototype, decoratedMethodName, {
        value: function (...args) {
          let behaviourValue = behaviour.apply(this, ...args);

          if (behaviourValue === undefined || !!behaviourValue)
             return decoratedMethodFunction.apply(this, args);
        },
        writable: true
      });
    }
    return clazz;
  };
</code></pre>

<p><code class="highlighter-rouge">before</code> should be used to decorate methods with setup or validation behaviour. Its "partner" is <code class="highlighter-rouge">after</code>, a decorator that runs behaviour after the decorated method is invoked:</p>

<pre><code>let after = (behaviour, ...decoratedMethodNames) =&gt;
  (clazz) =&gt; {
    if (typeof behaviour === 'string') {
      behaviour = clazz.prototype[behaviour];
    }
    for (let decoratedMethodName of decoratedMethodNames) {
      let decoratedMethodFunction = clazz.prototype[decoratedMethodName];

      Object.defineProperty(clazz.prototype, decoratedMethodName, {
        value: function (...args) {
          let decoratedMethodValue = ecoratedMethodFunction.apply(this, args);

          behaviour.apply(this, ...args);
          return decoratedMethodValue;
        },
        writable: true
      });
    }
    return clazz;
  };
</code></pre>

<p>With <code class="highlighter-rouge">before</code>, <code class="highlighter-rouge">after</code>, and <code class="highlighter-rouge">override</code> in hand, we have several advantages over traditional method overriding. First, <code class="highlighter-rouge">before</code> and <code class="highlighter-rouge">after</code> do a better job of declaring our intent when decomposing behaviour. And second, method advice allows us to add behaviour to multiple methods at once, focusing responsibility for cross-cutting concerns, like this:</p>

<pre><code>const mustBeLoggedIn = () =&gt; {
    if (currentUser() == null)
      throw new PermissionsException("Must be logged in!");
  }

const mustBeMe = () =&gt; {
    if (currentUser() == null || !currentUser().person().equals(this))
      throw new PermissionsException("Must be me!");
  }

@HasAge
@before(mustBeMe, 'setName', 'setAge', 'age')
@before(mustBeLoggedIn, 'fullName')
class Person {

  setName (first, last) {
    this.firstName = first;
    this.lastName = last;
  }

  fullName () {
    return this.firstName + " " + this.lastName;
  }

};
</code></pre>

<p>Mixins allow us to have a many-to-many relationship between behaviour and classes. Method advice is similar: It makes a many-to-many relationship between behaviour and methods particularly easy to declare.</p>

<p>After using mixins and method advice on a regular basis, instead of using superclasses for shared behaviour, we use mixins and method advice instead. Superclasses are then relegated to those cases where we need to build behaviour into the constructor.</p>

<h3 id="wrapping-up">wrapping up</h3>

<p>A simple mixin can cover many cases, but when we wish to override or extend method behaviour, we need to either use the subclass factory pattern or incorporate method advice. Method advice offers benefits above and beyond overriding mixin methods, especially if we use <code class="highlighter-rouge">before</code> and <code class="highlighter-rouge">after</code> in addition to <code class="highlighter-rouge">override</code>.</p>

<p>That being said, subclass factories are most convenient of we are comfortable with hierarchies of superclasses and with using <code class="highlighter-rouge">super</code> to extend method behaviour. Subclass factories work best when we don't have a lot of behaviour that needs to be shared between different methods.</p>

<p>Method advice permits us to use a simpler approach to mixins, and makes it easy to have a many-to-many relationship between methods and behaviour, and it makes it easy to factor the responsibility for cross-cutting concerns out of each method.</p>

<p>No matter which approach we use, we find ourselves needing shallower and shallower class hierarchies when we use mixins to their fullest. Which demonstrates the power of working with simple constructs (like mixins and decorators) in JavaScript: We do not need nearly as much of the heavyweight OOP apparatus borrowed from 30 year-old languages, we just need to use the language we already have, in ways that cut with its grain.</p>

<p>(discuss on <a href="https://news.ycombinator.com/item?id=10801425">hacker news</a>)</p>

<hr>

<p>more reading:</p>

<ul>
  <li><a href="http://raganwald.com/2015/06/10/mixins.html">Prototypes are Objects (and why that matters)</a></li>
  <li><a href="http://raganwald.com/2015/06/04/classes-are-expressions.html">Classes are Expressions (and why that matters)</a></li>
  <li><a href="http://raganwald.com/2015/06/17/functional-mixins.html">Functional Mixins in ECMAScript 2015</a></li>
  <li><a href="http://raganwald.com/2015/06/26/decorators-in-es7.html">Using ES.later Decorators as Mixins</a></li>
  <li><a href="http://raganwald.com/2015/08/05/method-advice.html">Method Advice in Modern JavaScript</a></li>
  <li><a href="http://raganwald.com/2015/12/23/super-considered-hmmmful.html"><code class="highlighter-rouge">super()</code> considered hmmm-ful</a></li>
  <li><a href="http://raganwald.com/2015/12/28/mixins-subclass-factories-and-method-advice.html">JavaScript Mixins, Subclass Factories, and Method Advice</a></li>
  <li><a href="http://raganwald.com/2015/12/31/this-is-not-an-essay-about-traits-in-javascript.html">This is not an essay about 'Traits in Javascript'</a></li>
</ul>

<p>notes:</p>

<div class="footnotes">
  <ol>
    <li id="fn:simplified">
      <p>A production-ready implementation would handle more than just methods. For example, it would allow you to mix getters and setters into a class, and it would allow us to attach properties or methods to the target class itself, and not just instances. But this simplified version handles methods, simple properties, "mixin properties," and <code class="highlighter-rouge">instanceof</code>, and that is enough for the purposes of investigating OO design questions.&nbsp;<a href="#fnref:simplified" class="reversefootnote">↩</a></p>
    </li>
    <li id="fn:fagnani">
      <p>Justin Fagnani named this pattern "subclass factory" in his essay <a href="http://justinfagnani.com/2015/12/21/real-mixins-with-javascript-classes/">"Real" Mixins with JavaScript Classes</a>. It's well worth a read, and his implementation touches on other matters such as optimizing performance on modern JavaScript engines.&nbsp;<a href="#fnref:fagnani" class="reversefootnote">↩</a></p>
    </li>
  </ol>
</div>

        </section>
					</div>
				</article>
				<!--================= END :: Tutorial =================-->
				
				<!--================= START :: Tutorial =================-->
				<article>
					<a id="t-36" name="t-36"></a><h1>36 : Compose me That: Function Composition in JavaScript</h1>
					<span class="ref-site">https://www.linkedin.com/pulse/compose-me-function-composition-javascript-kevin-greene</span>
					<div class="tutorial__content">
<div class="prose" itemprop="articleBody"><p>Source on Github:&nbsp;<a href="https://github.com/kevinbgreene/composition-tutorial" target="_blank" rel="nofollow noopener">Composition Tutorial</a></p> 
<p>Note: This article is the spiritual sibling of my previous post:&nbsp;<a href="https://www.linkedin.com/pulse/curry-me-partial-application-javascript-kevin-greene" target="_blank">Curry me This: Partial Application in JavaScript</a>. Both articles cover fundamental&nbsp;concepts for any functional programmer. If you're not familiar with currying I'd suggest reading that article first as we will be using curried functions here.</p> 
<h2>Are We Painting a Picture Here?</h2> 
<p>Yes, we are painting a picture and functions are the lines we draw. Function composition is a formalized way of thinking about something that is largely considered a good practice is software development, keep your functions short, single purpose and referentially transparent. Doing this&nbsp;makes your functions easy to test, easy to reason about and easy to document for others who will be using your code.</p> 
<p>Function composition is also directly a mathematical concept. In mathematics there is a composition operator, typically an empty circle (°). It should be an empty mid dot, but probably shows up here as a degree symbol. The circle between two functions means take the result of the function on the right and pass it as the argument to the function on the left. The composition of two functions is a new function. If we have some function A such that A(3) = 15&nbsp;and some function B such that B(15) = 22&nbsp;then some function C that is equal to B compose A (C = B ° A)&nbsp;would be a function that given 3 as argument would return 22 (C(3) = 22).</p> 
<p>Short, single purpose functions don't really do much, that's their beauty. So the not so surprising secret as to how we make them do interesting things is that we compose them. Complex functions are compositions of simpler functions.</p> 
<p>This function strips extra white space from a string. This function computes the distance between two points. This function finds the standard deviation of a&nbsp;list&nbsp;of numbers. It should be easy to describe what a function does. If you write a function and can't clearly describe what it is doing in a simple, declarative sentence you probably need to refactor that function into multiple functions, or step back and ask what it is you are actually trying to do. What you are trying to do can be described in a series of logical and declarative steps. We are dealing with computers here. At some point what you are trying to do needs to be translated into binary. Very often these steps will be your functions. Your application is the ultimate composition of these functions.</p> 
<h3>Wouldn't This be Easier to Describe with Examples?</h3> 
<p>Let's start simple. Say we want to create a function that takes a string and capitalizes every word in that string, what do we need to do?</p> 
<ol> 
 <li>Find the words in the string.</li> 
 <li>Capitalize the first character of each word.</li> 
 <li>Return the new string.</li> 
</ol> 
<p>Ignoring that we could do this fairly concisely with a regex (some of us, namely your humble narrator, suck at regexes), let's follow the steps and build this function.&nbsp;Something like this would do:</p> 
<p><img class="center" src="https://media.licdn.com/mpr/mpr/shrinknp_800_800/AAEAAQAAAAAAAAcoAAAAJDdkZGYzNGY2LWZmOGYtNDMyZi05MjMyLTRkYTQ2NWVkZThkNw.png" width="640" height="333" draggable="true" data-bukket-ext-bukket-draggable="true">Nothing complicated. Each step follows logically from the previous. There is obviously some room for abstraction there though. There's a lot of implementation details in there that have nothing to do with the basic steps of what we want to do. The first thing we do is break the input string into an array of words. We have room here for a words function.</p> 
<p><img class="center" src="https://media.licdn.com/mpr/mpr/shrinknp_800_800/AAEAAQAAAAAAAAiUAAAAJDY1YmI2YWVmLWYxMDItNGQ2OC05NzhjLTdlNGMzOTI5YWIyNg.png" width="640" height="216" draggable="true" data-bukket-ext-bukket-draggable="true">Which turns our titleCase function into this:</p> 
<p><img class="center" src="https://media.licdn.com/mpr/mpr/shrinknp_800_800/AAEAAQAAAAAAAAfdAAAAJDc4NGVkZWIxLTkyMTQtNDhiOC05YzYwLTY0MzdjYWE2NzZiMw.png" width="640" height="288" draggable="true" data-bukket-ext-bukket-draggable="true">Does our titleCase function really care what it takes to capitalize a word? No. It only needs to know the words are capitalized. We could then break the capitalization of each word out into its own function.</p> 
<p><img class="center" src="https://media.licdn.com/mpr/mpr/shrinknp_800_800/AAEAAQAAAAAAAAiAAAAAJGY5NWY1MzBiLTEzODYtNDBkZS05MjlmLTRjYWRmMzRlNjYyZA.png" width="640" height="382" draggable="true" data-bukket-ext-bukket-draggable="true"></p> 
<p>Then it would follow to create a function that capitalized each of a list of words.&nbsp;The ultimate idea is to strip the titleCase function down into only the steps described in our high-level overview, stripping away the implementation details of those steps and abstracting the implementation into other functions that can be logically described&nbsp;in terms of those implementation details.</p> 
<h3>Hold on There Pokey, We're in Abstraction Hell</h3> 
<p>True, we haven't actually composed anything get. I would argue though that our titleCase function&nbsp;should really be a one-liner, a composition of even simpler functions.</p> 
<p><img class="center" src="https://media.licdn.com/mpr/mpr/shrinknp_800_800/AAEAAQAAAAAAAAfRAAAAJGQ0NTJkNDJjLTI3OTMtNDEwOS04ZGNmLWEzMDA1MGJjY2MzNg.png" width="640" height="162" draggable="true" data-bukket-ext-bukket-draggable="true"></p> 
<p>Ok, so what's going on here? To start, let's look at this without the call to compose:</p> 
<p><img class="center" src="https://media.licdn.com/mpr/mpr/shrinknp_800_800/AAEAAQAAAAAAAAd6AAAAJDRkYWJkZmM4LTk5YzItNDBiYy1hMzM0LTFkZjhjMDVjNGE5Nw.png" width="640" height="201" draggable="true" data-bukket-ext-bukket-draggable="true"></p> 
<p>You've probably done something like this before, using a function invocation as the argument for another function. That is all function composition really is. We're just dealing with abstractions to make this idea more explicit.</p> 
<p>We can't make our own operators or infix functions in JavaScript, so compose is a function that takes some n number of functions and returns a new function that is the right to left composition of those functions. We'll look at an implementation shortly. In this case, the argument received by titleCase is some string that is given to the words function. Capitalize gets the result of the words function and join gets the result of capitalize. The return value of join is used as the return value of the composition.</p> 
<p>Back when we originally described what this function should do we had three steps. Here we have three functions that correspond to each of those steps. Find the words, capitalize them, return the new string (by joining the capitalized words). The three functions compose together to create our titleCase function.</p> 
<p>Alright, but what exactly do each of these three steps consist of? Our words function did a little more than just split on spaces:</p> 
<ol> 
 <li>Trim leading/trailing white space</li> 
 <li>Split string on spaces</li> 
 <li>Remove empty strings (extra spaces) from words list</li> 
</ol> 
<p>Three more steps. Another composition:</p> 
<p><img class="center" src="https://media.licdn.com/mpr/mpr/shrinknp_800_800/AAEAAQAAAAAAAAeOAAAAJGIyN2FhZTY0LTE4MDYtNDZlYS04MGUwLTUxZGMyZjQxYjdmZg.png" width="640" height="165" draggable="true" data-bukket-ext-bukket-draggable="true">The trim and split functions here are simple helpers that allow us to call String.prototype.trim and String.prototype.split as normal functions.</p> 
<p><img class="center" src="https://media.licdn.com/mpr/mpr/shrinknp_800_800/AAEAAQAAAAAAAAfBAAAAJDUwYTM4MjJlLWM2NTQtNGVhYS05ZjRmLWQ3ODY0ZTA2NWE4NA.png" width="640" height="165" draggable="true" data-bukket-ext-bukket-draggable="true"></p> 
<p>Split&nbsp;is a little more interesting in that it is curried. So split(' ') is a new function that splits on spaces:</p> 
<p><img class="center" src="https://media.licdn.com/mpr/mpr/shrinknp_800_800/AAEAAQAAAAAAAAe4AAAAJGM5ZjlmZjU3LTE4YTgtNDU4Yi1hNzY2LTAyNDY3YWY4YTY0Yw.png" width="640" height="183" draggable="true" data-bukket-ext-bukket-draggable="true">It follows then that we could make a breakOnSpace function:</p> 
<p><img class="center" src="https://media.licdn.com/mpr/mpr/shrinknp_800_800/AAEAAQAAAAAAAAdGAAAAJGNkODJhZGU1LTVkYTktNDA4Yy1iOWM3LWI0NDIwY2UyMjEzMw.png" width="640" height="167" draggable="true" data-bukket-ext-bukket-draggable="true">The removeEmpty function handles the case when we split on a single space if there are extra spaces in our string we end up with empty strings in our words array. We remove these empty strings from our words array. Maybe this isn't desirable in all situations, but it's a wrinkle we'll add to our implementation.</p> 
<p>For completeness, here is removeEmpty:</p> 
<p><img class="center" src="https://media.licdn.com/mpr/mpr/shrinknp_800_800/AAEAAQAAAAAAAAhSAAAAJDFkNDQxY2IyLTE1NDctNGZlOC05N2ExLThiMjM1MmU1OWE2Yw.png" width="640" height="165" draggable="true" data-bukket-ext-bukket-draggable="true"></p> 
<p><em>Note: We'll skip the remaining two steps of titleCase (capitalize and join). Their implementations can be found in the linked source code.</em></p> 
<h3>TDD: It's Not All Puppy Dogs and Ice Cream</h3> 
<p>I write most of my JavaScript with heavy use of curry and compose. This allows and pushes me towards a few things. One is micro code reuse. The more of these small function I have, the more ways I can compose them to make more complex functions for use in whatever project I am working on. Two is that it changes the way I look at my code. I look at my code more and more with an eye of how I can abstract, simplify and reuse the code I write. Three is I am a big believer in TDD (Test Driven Development). Even if you don't strictly follow TDD at some point you need to unit test your JavaScript. These tiny functions are impossibly easy to unit test. Then, if my logic is sound, these tiny functions that are thoroughly unit tested are almost certain to work when I compose them together. If they don't work when I compose them together there is a higher level flaw in my reasoning about what a function should be doing, the steps it should be taking. Then once the composition is in place and unit tested I can then use that function in another composition that is more likely to work because its component parts have been correctly reasoned and unit tested.</p> 
<p>Writing unit tests can be a real pain. The easier it is to do the more likely we are to do it. When the logic you are testing is simple and well-reasoned it will be much easier for you to write test. Building functions up through composition forces your functions to be well reasoned because they are simply compositions of the steps they need to perform. Even when I'm code sketching with a larger problem I'm not immediately sure how to tackle I always go back to building it up from smaller functions that are easy for me to test.</p> 
<h2>So, How do we Make This Magic?</h2> 
<p>As I pointed out, function composition is probably something you've already done. You've probably used it a lot. Any time you've written something like this g(f(arg)) you've used function composition. However, if we want the composition of g and f to be a reusable function we need to wrap it in some function that accepts the argument for us.</p> 
<p><img class="center" src="https://media.licdn.com/mpr/mpr/shrinknp_800_800/AAEAAQAAAAAAAAleAAAAJDIyNWE0ZjNkLWZiMjctNGJmYi1iMTkzLTAxZTZiNjQ2NjdmYg.png" width="640" height="72" draggable="true" data-bukket-ext-bukket-draggable="true"></p> 
<p>There are certainly libraries that offer compose functions. Essentially the same libraries that offer curry functions. I'll list them again at the end. I at least like knowing how the magic works even if I'm going to use a library.</p> 
<p>The examples we looked at above both had 3 steps. We can make a function that takes three functions and composes them.</p> 
<p><img class="center" src="https://media.licdn.com/mpr/mpr/shrinknp_800_800/AAEAAQAAAAAAAAlVAAAAJGQyOWNjNGFlLWUxOWEtNGM1Yi1iY2VhLWZiZjlhM2ZmM2FhYQ.png" width="640" height="270" draggable="true" data-bukket-ext-bukket-draggable="true"></p> 
<p>Obviously not ideal, but gets the job done.&nbsp;We would need compose functions for all the different numbers of functions we would like to compose together (compose2, compose4...).</p> 
<p>How do we make a generic compose function?</p> 
<p>What exactly does a generic compose function need to do?</p> 
<ol> 
 <li>Take some n number of functions</li> 
 <li>Return a new function that takes an argument and returns the result of calling the composition of those functions on that argument</li> 
</ol> 
<p>Well, we start like this:</p> 
<p><img class="center" src="https://media.licdn.com/mpr/mpr/shrinknp_800_800/AAEAAQAAAAAAAAlgAAAAJDcwNmNkNGNmLWZkY2MtNGM1Zi04MDBmLWY2YTk4YjA5OGQ3Mw.png" width="640" height="240" draggable="true" data-bukket-ext-bukket-draggable="true">Using rest parameters it's easy to get the functions we need to call as an array. We return a function that accepts the argument. How do we apply that to our list of functions?&nbsp;If we step back and don't think about function application, just what do we have? We have a list and need to return a result. Don't we have an array method that does something like that? Yep, sounds like a reduce:</p> 
<p><img class="center" src="https://media.licdn.com/mpr/mpr/shrinknp_800_800/AAEAAQAAAAAAAAk7AAAAJGE1NzQzNDRmLThkNjMtNDQ3OS1iZGFiLWE1ZTdkMWYzMjI5YQ.png" width="640" height="271" draggable="true" data-bukket-ext-bukket-draggable="true">The argument of the composition is the initial accumulator of reduce. The new accumulator is then the result of applying the next function to the accumulator.</p> 
<p>Why do we use reduceRight? Why not apply the functions left to right? We could make it work either way. Keeping right to left composition keeps us closer to the mathematical roots of function composition. It also makes things read a little more clearly if we immediately invoke a composition:</p> 
<p><img class="center" src="https://media.licdn.com/mpr/mpr/shrinknp_800_800/AAEAAQAAAAAAAAe2AAAAJGI0ZDk0YmFjLTU2NWItNGY4Yi1iYjg0LWVkMzE0NjE4MmUwMQ.png" width="640" height="74" draggable="true" data-bukket-ext-bukket-draggable="true">It's a little more clear that 'this is a test' is being passed first as an argument to words. Right to left implies the flow of data through the composition.</p> 
<h3>Library Implementations</h3> 
<ol> 
 <li><a href="http://ramdajs.com/0.21.0/index.html" target="_blank" rel="nofollow noopener">ramda.js</a></li> 
 <li><a href="https://lodash.com/" target="_blank" rel="nofollow noopener">lodash.js</a>&nbsp;(calls their implementation flow/flowRight)</li> 
 <li><a href="http://underscorejs.org/" target="_blank" rel="nofollow noopener">underscore.js</a></li> 
</ol></div>
					</div>
				</article>
				<!--================= END :: Tutorial =================-->
				
				
				<!--================= START :: Tutorial =================-->
				<article>
					<a id="t-37" name="t-37"></a><h1>37 : Curry me This: Partial Application in JavaScript</h1>
					<span class="ref-site">https://www.linkedin.com/pulse/curry-me-partial-application-javascript-kevin-greene</span>
					<div class="tutorial__content">
<div class="prose" itemprop="articleBody"><p>Source on Github: <a href="https://github.com/kevinbgreene/curry-tutorial" target="_blank" rel="nofollow noopener">Curry Tutorial</a></p> 
<h2>Currying vs Partial Application</h2> 
<p>Currying and partial application are related concepts and the terms are often used interchangeably. It boils down to this, we have some function F(a,b,c) that has&nbsp;three parameters, but we don't want to apply all three arguments at the same time. Why on earth would we want to do that? Settle down, we'll get to that.</p> 
<p>The prototypical example of this is an add (+) function:</p> 
<p><img class="center" src="https://media.licdn.com/mpr/mpr/shrinknp_800_800/AAEAAQAAAAAAAAfMAAAAJGY2ODljNjEzLTk3YTYtNGEyMC04N2VmLTQ2ODhiMTNiNzZkYQ.png" width="640" height="220" draggable="true" data-bukket-ext-bukket-draggable="true">If we were to partially apply add, we could do something like this:</p> 
<p><img class="center" src="https://media.licdn.com/mpr/mpr/shrinknp_800_800/AAEAAQAAAAAAAAiPAAAAJGQ0MzEzMWZlLTkyYjEtNGNiYS04Njk0LWE4ZjE1ZjEzNDI1Mw.png" width="640" height="150" draggable="true" data-bukket-ext-bukket-draggable="true">By partially applying the function we get back a new function with the 'a' parameter bound to the number 1. So we have a function that is just waiting for a 'b', a function that will add 1 to any number given to it. This gives us a great little semantic helper function we can use over and over again.</p> 
<p>Partially applying? What about currying? As I said, these are similar concepts. To illustrate the difference lets look at a slightly different function:</p> 
<p><img class="center" src="https://media.licdn.com/mpr/mpr/shrinknp_800_800/AAEAAQAAAAAAAAlxAAAAJDM2OTcyODEyLTg5ZjktNGZiOC1hOWU5LWIwODA3ZDhhNzk5NQ.png" width="640" height="213" draggable="true" data-bukket-ext-bukket-draggable="true">Partial application generally refers to the ability to (surprise) partially apply a function. Just give it less arguments than it requires, as a result you are given back a new function that waits for the remaining arguments.</p> 
<p>Curry can be thought of as a more specific case of this. If a function takes three arguments and is curried it is really three functions. Each function takes one argument&nbsp;and returns a new function that takes the next&nbsp;argument until all arguments are received then it returns the final result. Curried functions only ever take one argument.</p> 
<p><img class="center" src="https://media.licdn.com/mpr/mpr/shrinknp_800_800/AAEAAQAAAAAAAAeBAAAAJGQxNjg5ZmMwLWM0MjctNDA0NC1iYzNkLWY3OWQxZGJiNzNmNA.png" width="640" height="208" draggable="true" data-bukket-ext-bukket-draggable="true">Applying two arguments to a curried threeSum returns a result dependent on implementation. It may throw an error, or it may ignore the second argument. If it ignores the second argument in our example we are left with essentially this: threeSum(2)(4), a function waiting on a third argument to bind to 'c'.</p> 
<p>The difference between partial application and currying may not be practically too important, but I make the distinction as a note that there is technically a distinction. In practice you will often see curry used to refer to partial application. Later, in these very typed words, I will slip into that myself.</p> 
<p>Hey, but I know a little JavaScript. I know the functions we've written so far really only do something like this:</p> 
<p><img class="center" src="https://media.licdn.com/mpr/mpr/shrinknp_800_800/AAEAAQAAAAAAAAfSAAAAJGI1NjBlOWE2LWQ3MGYtNDJlNy05MDk2LWExZGY4ZGFlNTBkNQ.png" width="640" height="149" draggable="true" data-bukket-ext-bukket-draggable="true">True. NaN is not a function, information for life.</p> 
<h3>Using Function.prototype.bind</h3> 
<p>Native JavaScript already gives us a tool to perform partial application. Function.prototype.bind is a very useful bit of business. It allows us to bind a context and&nbsp;arguments to a function. The context bit can be cool, but we're going to concern ourselves only with binding arguments. Because of this, I will always use null as the first argument to bind.</p> 
<p><em>Note: If you are unfamiliar with Function.prototype.bind I suggest checking out the MDN documentation before continuing:&nbsp;<a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function/bind" target="_blank" rel="nofollow noopener">Function.prototype.bind</a>.</em></p> 
<p>If we use bind to perform partial application, we end up with something like this:</p> 
<p><img class="center" src="https://media.licdn.com/mpr/mpr/shrinknp_800_800/AAEAAQAAAAAAAAi4AAAAJGIyZWZiMjI2LWY0N2YtNDQyYi1iNDI2LWI2MDY5MDYwMDNlNw.png" width="640" height="203" draggable="true" data-bukket-ext-bukket-draggable="true">The first argument (null) is bound to the context of the function. The following arguments are bound to the parameters of the function. If you've used React, you may have used bind to pass arguments to event handlers. Here we are using bind for partial application, to create new functions that are in essence more specific versions of the original function. This is the value of partial application, a subject we'll return to shortly.</p> 
<p>Function.prototype.bind always returns a new function and always takes&nbsp;as many arguments as we care to pass to it. This would be perfectly fine:</p> 
<p><img class="center" src="https://media.licdn.com/mpr/mpr/shrinknp_800_800/AAEAAQAAAAAAAAd4AAAAJGU1YjRiNGY0LWRkY2MtNGFhMS1hZmQ0LTRmM2IyZDhjZTY2Yg.png" width="640" height="91" draggable="true" data-bukket-ext-bukket-draggable="true">In this case only the 0 and 'henry' were bound to parameters. The add function only took two parameters so the first two arguments bound to add were bound to those parameters. Then on function invocation (someJunk('haha')) we were returned '0henry'. All the other arguments&nbsp;we gave to add were&nbsp;just thrown away.</p> 
<p>This API is pretty clunky if our main want is to take advantage of partial application. Things were nicer in our theoretical API earlier where add just knew what to do based on the arguments it had so far.</p> 
<h3>Going Our Own Way</h3> 
<p>How would we implement this ourselves? I want functions that allow me to partially apply them, always giving me back new functions until I have provided all the arguments, then I want a result.</p> 
<p>Starting simply, if we were to just write our add function as a curriedAdd function:</p> 
<p><img class="center" src="https://media.licdn.com/mpr/mpr/shrinknp_800_800/AAEAAQAAAAAAAAf6AAAAJDk1ZTkzZDI3LTU0ODYtNDdlNy1iOWM3LTNhYWE1ODM5NTMyNA.png" width="640" height="218" draggable="true" data-bukket-ext-bukket-draggable="true">This is a true curried function. It is a composition of two functions that each take one argument.</p> 
<p>Binary functions are incredibly common.&nbsp;Say I want to take advantage of currying, but I don't want to go back and rewrite all the binary functions I've written before. I want something like bind that will allow me to transform those binary functions into curried functions. Write a function that takes as its argument a binary function and returns a curried version of that function.</p> 
<p>It would look something like this:</p> 
<p><img class="center" src="https://media.licdn.com/mpr/mpr/shrinknp_800_800/AAEAAQAAAAAAAAiyAAAAJDk5YzQ2NjNmLTFhMTAtNDA3NC1hMDE5LTFiZTQwYzhmOTA1Ng.png" width="640" height="238" draggable="true" data-bukket-ext-bukket-draggable="true">Yes, very similar to our curriedAdd function. It takes a function and returns a function that takes the first argument. When applied that function returns a function to take a second argument. When that function is applied we finally get a result. Now we can rewrite our curriedAdd function like this:</p> 
<p><img class="center" src="https://media.licdn.com/mpr/mpr/shrinknp_800_800/AAEAAQAAAAAAAAf9AAAAJDA3N2I1YzBiLTQ0ZGQtNDU0NC05NGIwLThiMDYyZjc3NTI5Ng.png" width="640" height="99" draggable="true" data-bukket-ext-bukket-draggable="true">Okay, so what do I do if I have a function that takes three arguments, or four? Do I really want to pass all the parameters separately every time? If we're going to take advantage of these patterns in our daily code we are probably more interested in partial application than true currying. We also want a generic version of our binaryCurry function that can turn any function into a function that can be partially applied.</p> 
<p>So, let's write this function. An obvious requirement of this is we need to know how many arguments the function we are transforming expects to receive. I don't see this used often, but functions have a length property which is the number of declared parameters. Like this:</p> 
<p><img class="center" src="https://media.licdn.com/mpr/mpr/shrinknp_800_800/AAEAAQAAAAAAAAesAAAAJGI0OTcwM2UzLTBkMDQtNDFjYy1iMzIwLWJiYWE5ZmM1YzdiZg.png" width="640" height="120" draggable="true" data-bukket-ext-bukket-draggable="true">Note:&nbsp;This doesn't take into account arguments a function may use by accessing the arguments array-like thing we shouldn't really be using anyway.</p> 
<p>Using ES6 rest parameters and the spread operator, writing a generic curry function is rather concise.</p> 
<p><em>Note: Rest parameters allow us to receive a variable number of arguments in our functions. Instead of using the arguments object we get an actual array of arguments that weren't otherwise bound to parameters. For a more detailed description of rest parameters MDN is again the spot:&nbsp;<a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Functions/rest_parameters" target="_blank" rel="nofollow noopener">Rest Parameters</a>.</em></p> 
<p><em>Note: The spread operator allows us to take an array and very literally spread it out, as in the case where we have an array and want to pass it to a function that takes multiple arguments. Hey, that's what we used to use apply for. Yes, that's what we used to use apply for. Again, here's MDN:&nbsp;<a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Spread_operator" target="_blank" rel="nofollow noopener">Spread Operator</a>.</em></p> 
<p><img class="center" src="https://media.licdn.com/mpr/mpr/shrinknp_800_800/AAEAAQAAAAAAAAkDAAAAJGIyYWNkNjZjLWVkODAtNGFmZi1hMzhhLTNhZDkyOTFlZTNjNw.png" width="640" height="588" draggable="true" data-bukket-ext-bukket-draggable="true">What happens here? The first time this function is called it only expects one argument, a function to curry (to create a new function that can be partially applied). The args parameter will probably be an empty array on first invocation, unless you want to bind any arguments to this function from the beginning. We save the arity (number of arguments it expects) to a local variable. We then return a function we define inside the curry function. We call this function 'curried' to indicate this is the curried function. Yes, yes, the author is an idiot. Moving on. When this function is invoked we concat the new args2 array with the old args array and check if we have received all the arguments yet. If we have, we apply the original function and return the result. If we have not we recursively call the curry function, passing along all the new arguments which puts us back in the original position, returning the curried function to await more arguments. On this second call (and all future calls) to curry the args parameter will be all the arguments we have received so far. New arguments from the client will be bound to args2 and concatenated with args to form locals.</p> 
<p>Play around, test it. Try to solve the problem for yourself. We now have a generic function we can use to transform any function into one that can be partially applied.</p> 
<h2>Subclassing a Function?</h2> 
<p>Currying and partial application are tools like anything else. Their value comes in the form of being able to reuse more code. You can write functions in their&nbsp;most generic form and partially apply them to create functions suited for a specific situation. I've had the most success in explaining the concept to people new to it by describing it as subclassing a function. Most programmers are familiar with the idea of a generic base class that is subclassed for a given situation. Thinking about the abstraction in those terms will probably give you the best idea of what the value is.</p> 
<h3>Can We Have Some Examples?</h3> 
<p>Sure, let's look at a couple situations where using partial application can help us write a little cleaner code. These examples will be simple, but should get you started.</p> 
<p>First, let's write a function to help us test the length of given objects. Not a terribly complex task, but something that's fairly common.</p> 
<p><img class="center" src="https://media.licdn.com/mpr/mpr/shrinknp_800_800/AAEAAQAAAAAAAAczAAAAJGEzNWM4YjY3LTk2ZWQtNDBiNS05YWYxLTI3YmQwZTY4NjExMg.png" width="640" height="223" draggable="true" data-bukket-ext-bukket-draggable="true">Simple enough. It returns a boolean letting us know if a given object has a given length. Because this function is curried we can do something like this:</p> 
<p><img class="center" src="https://media.licdn.com/mpr/mpr/shrinknp_800_800/AAEAAQAAAAAAAAl1AAAAJDZlNzdmOGIxLTVkYjQtNGNiOS05M2Q5LTEwZGUzYmVkMDk5Mg.png" width="640" height="200" draggable="true" data-bukket-ext-bukket-draggable="true">Because of partial application hasLength(15) returns a new function that waits on the object to test. The array filter method uses this new function as it iterates over the array, on each iteration passing the second argument&nbsp;to hasLength, which upon getting its second argument runs the test and returns a boolean. It makes filter a little more concise. It makes our code more semantic, thus making it a little easier to read. No giant gains, but we're just getting started. We could make this even a little more self-documenting by doing something like this:</p> 
<p><img class="center" src="https://media.licdn.com/mpr/mpr/shrinknp_800_800/AAEAAQAAAAAAAAeEAAAAJDNhZDg3Y2FmLTVkOGMtNDA3My04NGQ3LTE1NWY5OWM2NjUxZg.png" width="640" height="212" draggable="true" data-bukket-ext-bukket-draggable="true">This is even more code, but illustrates the kind of things you can start doing with utility or helper functions to make them a little easier to read and to make many functions that all use the same code by writing the original (hasLength in this case) in the most generic form, allowing us to create new functions for more specific situations.</p> 
<p>Something else you may want to do is test if a given DOM element matches a given selector.</p> 
<p><img class="center" src="https://media.licdn.com/mpr/mpr/shrinknp_800_800/AAEAAQAAAAAAAAg3AAAAJGE2NDA2OWE0LWY0NTctNDE3MS1iMTIwLTI5ODQzNzBjMjdmZg.png" width="640" height="514" draggable="true" data-bukket-ext-bukket-draggable="true">You'll start to notice. If you are going to take advantage of partial application with your functions, the order in which the parameters are defined restricts how the function can be used. Here, I want the selector to be argument I partially apply to make my more specific function. I want to write these tester functions I can use on any element. If the element was first I could only use this function on one element, probably less useful, but it depends on your use case.</p> 
<p>And to use this:</p> 
<p><img class="center" src="https://media.licdn.com/mpr/mpr/shrinknp_800_800/AAEAAQAAAAAAAAj2AAAAJDhmZGM2ZjkxLTk3MjAtNDE1Ni1hYzAwLWE4NzcwMzc0OGQ2MQ.png" width="640" height="192" draggable="true" data-bukket-ext-bukket-draggable="true"></p> 
<h3>Implementations?</h3> 
<p>We've seen how to use bind to perform partial applications. We've seen how to build our own function for creating functions that can be partially applied. However, you really want someone else to deal with the implementation for you. As mentioned in the comments there are libraries that provide curry implementations.</p> 
<p>Some notable libraries:</p> 
<ol> 
 <li><a href="http://ramdajs.com/0.21.0/index.html" target="_blank" rel="nofollow noopener">ramda.js</a></li> 
 <li><a href="https://lodash.com/" target="_blank" rel="nofollow noopener">lodash.js</a></li> 
 <li><a href="http://underscorejs.org/" target="_blank" rel="nofollow noopener">underscore.js</a>&nbsp;(which calls its implementation 'partial')</li> 
</ol> 
<h2>Conclusion</h2> 
<p>Using partial application to reuse code probably won't drastically change things for you in your daily work. However, one of the things we are constantly doing as developers in finding ways to reuse our code and not write the same thing more than once. Something else we all do at times is write functions that are way too large and do way too much. We just get something working. Then, having a clearer picture of what we should do, we refactor that function into several functions, each performing one task. Often while doing this we find pieces of code that are generic, that are performing micro computations that aren't really tied to this specific use case. These smaller computations can often be handled by libraries, or can be moved into utility packages within our application, keeping our main application logic cleaner. All of these situations bring opportunities to take advantage of tools like partial application to build abstractions we might not have seen or considered without this tool in our chest. Like any tool, as you use it more you will become better at wielding it and will change the way you write code as you learn to see abstractions you didn't see previously.</p> 
<h3>Further Reading:</h3> 
<ol> 
 <li><a href="https://en.wikipedia.org/wiki/Currying" target="_blank" rel="nofollow noopener">Currying on Wikipedia</a></li> 
 <li><a href="https://en.wikipedia.org/wiki/Partial_application" target="_blank" rel="nofollow noopener">Partial application on Wikipedia</a></li> 
</ol></div>
					</div>
				</article>
				<!--================= END :: Tutorial =================-->
				
				<!--================= START :: Tutorial =================-->
				<article>
					<a id="t-38" name="t-38"></a><h1>38 : Functional Data Structures in JavaScript: The Basics</h1>
					<span class="ref-site">https://www.linkedin.com/pulse/function-data-structures-javascript-basics-kevin-greene</span>
					<div class="tutorial__content">
<div class="prose" itemprop="articleBody"><p>Source on Github: <a href="http://github.com/kevinbgreene/functional-data-js" target="_blank" rel="nofollow noopener">Functional Data Structures</a></p> 
<p><br></p> 
<h2>Once Upon a Time</h2> 
<p>When I was in college I had no interest in thinking about the future, so I was an art major. I did however have an interest in computers and technology so for an elective I took an intro to computer science course. I honestly don't remember much about the course. It was years later that I returned to programming. You know, gave up on my hopes and dreams and got a real job. The thing that stuck with me from the course was recursion. It was early in the semester and the instructor was demonstrating loops by finding the nth Fibonacci number (cringe). He then showed the recursive solution.</p> 
<p><img src="https://media.licdn.com/mpr/mpr/AAEAAQAAAAAAAAdIAAAAJDEyNjliY2VlLWJjZDktNGM3Mi04ODAxLTAzODBjYTIxMTM1OA.png" class="center" draggable="true" data-bukket-ext-bukket-draggable="true"></p> 
<p>Nothing special, but nice. To my young art-student brain the elegance of recursion was very pleasing and this idea stuck with me. So, years later, when I returned to programming I was very interested in this idea that had stuck with me. That recursion thing was nice. I want to know more about what can be done with that. How do I break large problems down into small problems so I can solve them with recursion?</p> 
<p>A lot of the beauty of recursion comes from how each function call maintains its own state, eliminating the need for temporary variables. If we look at an iterative solution to the same problem we find the need for multiple variable assignments.</p> 
<p><img src="https://media.licdn.com/mpr/mpr/AAEAAQAAAAAAAAknAAAAJDcwMmZhM2VmLTAzMmYtNGVjOC1iZDIxLThmMzRmZWNiMzdkZA.png" class="center" draggable="true" data-bukket-ext-bukket-draggable="true"></p> 
<p>This could be reduced, but this illustrates my point. In order to maintain the state of our computation we have to create additional variables. The recursive solution just used the arguments passed into the function. This is the beginning of how we can persist data using only functions.</p> 
<p>When we think about functional programming languages immutable data is one of the things we associate with them. What makes functional data structures immutable? Does the data have to be immutable? How are they different than the data structures we are used to using? A lot of these questions really don't matter practically when you're writing programs. It matters if data is mutable or not. It doesn't matter how it gets that way. In JavaScript we have Object.freeze. We can make immutable data if we want. All data in our programs is really just the location of some bits in memory. Those bits can always be changed. The lower level the programming language you're using, the more you have to be concerned with the specifics of managing those bits and their location. What we will be exploring here is storing data in functions.</p> 
<p>This is a good subject for a book. Actually, the inspiration for this post was translating the Standard ML examples from Chris Okasaki's book <a href="http://www.amazon.com/Purely-Functional-Structures-Chris-Okasaki/dp/0521663504" target="_blank" rel="nofollow noopener">Purely Function Data Structures</a> to JavaScript. We'll see how far I want to take this post. I'll probably cover some basic structures, then next week or next month write another post about more complex structures. For now we'll cover numbers, booleans, tuples, lists and binary search trees.</p> 
<p><br></p> 
<h2>Church Numerals</h2> 
<p>A lot of the ideas that form the basis of functional programming languages are derived from lambda calculus. The lambda calculus is a model for computation. If you are interested in functional programming but unfamiliar with lambda calculus I suggest to check it out. I'll include some links to articles and books later. The key idea (specifically in untyped lambda calculus) is that the only data structure we have is a function. Actually, the only piece of syntax we have is a function and the argument bindings to that function. No numbers, strings, lists, conditionals, loops... etc. If you need these things you have to build them yourself with functions. We're going to loosen these restrictions a bit as we go, specifically we are going to use conditionals, but for now let's look at how we might do useful things with only functions.</p> 
<p>How can we do things in an environment that doesn't even have numbers? When we talk about the existence of numbers what we are really talking about is the ability to count some occurrences of a thing. With our given limitations the thing we have to count are functions. Specifically what we are going to count is the number of applications of a function. If a given function isn't applied at all that is 0. If it is applied once that is one. For any number n the equivalent number to us is the nth composition of some function fn with itself.</p> 
<p><img src="https://media.licdn.com/mpr/mpr/AAEAAQAAAAAAAAfyAAAAJGJlYzY2YTMxLWQwN2EtNGE5Yi1hZmZiLTQ4MTcwNmI3ZTVjMw.png" class="center" draggable="true" data-bukket-ext-bukket-draggable="true"></p> 
<p>This function takes a function "fn" and some argument "x". The function is applied to x once, thus One. Numbers expressed in this fashion are called Church numerals after Alonzo Church, who introduced the lambda calculus. If this is one what then is Zero?</p> 
<p><img src="https://media.licdn.com/mpr/mpr/AAEAAQAAAAAAAAd2AAAAJDBhYjFiOTgyLTUxMWMtNGZmNC05YWZhLTEyZDllNzRkM2EzMA.png" class="center" draggable="true" data-bukket-ext-bukket-draggable="true"></p> 
<p>The same signature, but the function isn't applied. Moving along we come to Two.</p> 
<p><img src="https://media.licdn.com/mpr/mpr/AAEAAQAAAAAAAAevAAAAJGY1YWRmMTM5LTdhMWYtNDk4OS1iYzc3LTIzYjllYTdkYTZmNw.png" class="center" draggable="true" data-bukket-ext-bukket-draggable="true"></p> 
<p>Or we call the function fn one extra time on One:</p> 
<p><img src="https://media.licdn.com/mpr/mpr/AAEAAQAAAAAAAAiRAAAAJDgxOGQwNGE2LTZjOTQtNDJkYi1hYmEzLWMwNWU1Mjk2ODQzZA.png" class="center" draggable="true" data-bukket-ext-bukket-draggable="true"></p> 
<p>This leads us to a function to increment any Church numeral:</p> 
<p><img src="https://media.licdn.com/mpr/mpr/AAEAAQAAAAAAAAgJAAAAJDg0MTZhOTBkLThkMjktNGVmZi1iZDRiLWU1MGY0ZGIxYWQ1ZA.png" class="center" draggable="true" data-bukket-ext-bukket-draggable="true"></p> 
<p>Now we can write numbers in terms of the number that came before them.</p> 
<p><img src="https://media.licdn.com/mpr/mpr/AAEAAQAAAAAAAAj8AAAAJGI3YmRiMmFmLWNhYzktNDdkOS05ZmRiLWU5NDdiZTdkZjU0OA.png" class="center" draggable="true" data-bukket-ext-bukket-draggable="true"></p> 
<p>We're placing artificial limitations on ourselves by using only functions to express data. It would be nice to at least have a way to check our work, maintain our sanity and see these things as the Arabic numerals we are used to.</p> 
<p><img src="https://media.licdn.com/mpr/mpr/AAEAAQAAAAAAAAgvAAAAJDY5MDQ2M2FiLTUzYmMtNGVjZC04NTVmLTE5NWJkMzM5OTczNA.png" class="center" draggable="true" data-bukket-ext-bukket-draggable="true"></p> 
<p>One of our numbers is just a function that takes two arguments. If we apply these functions correctly we can retrieve the corresponding Arabic numeral. By using 0 as the initial argument for the function we can keep track of how many times one of our numbers call its function. The function we then pass in as the first argument is an accumulator that just needs to increment the number it receives and pass it to the next function invocation.</p> 
<p>If some number n is just a function representing the nth composition of some function fn, how do we express addition?</p> 
<p><img src="https://media.licdn.com/mpr/mpr/AAEAAQAAAAAAAAjwAAAAJGJhNDk2MjFjLWYwZWUtNDIwYi1hNGJlLWJkMjY5YTIwN2Y2Ng.png" class="center" draggable="true" data-bukket-ext-bukket-draggable="true"></p> 
<p>When this function is applied n calls fn n times and m an additional m times resulting in the addition of m and n.</p> 
<p><img src="https://media.licdn.com/mpr/mpr/AAEAAQAAAAAAAAmJAAAAJDY2MGU2NGEzLWFhN2YtNGEwNi04ZWJiLTVhMmRjN2UwMzZkYQ.png" class="center" draggable="true" data-bukket-ext-bukket-draggable="true"></p> 
<p>We will return to numbers shortly and learn how to perform more operations on Church numerals. It will help to introduce a few more concepts first.</p> 
<p><br></p> 
<h2>Booleans</h2> 
<p>Booleans are where things start to get a little interesting to me. The patterns we start exploring with booleans are going to be the patterns we use to express the rest of the data structures we're going to look at. They also start representing patterns that could actually be used to build useful data structures.</p> 
<p>We have two potential values for booleans. That's it. We know what they are ahead of time. We know logically what they represent. A boolean is really just a fork in the road. Either one thing or another.</p> 
<p><img src="https://media.licdn.com/mpr/mpr/AAEAAQAAAAAAAAg8AAAAJGNjMGEyMDg2LWIyZDgtNDQ4ZC04NTg5LTEyZjQzZjAzMjc0OQ.png" class="center" draggable="true" data-bukket-ext-bukket-draggable="true"></p> 
<p>An operation that was consuming one of these booleans would call the function with two values and would know wether the boolean was True or False based on the value returned.</p> 
<p><img src="https://media.licdn.com/mpr/mpr/AAEAAQAAAAAAAAixAAAAJGE5ODE5ODc0LTQ1Y2YtNDNjNi1iZWE4LWFmMDAzZGU2ZWQ0OA.png" class="center" draggable="true" data-bukket-ext-bukket-draggable="true"></p> 
<p>In essence our boolean is its own if/else. If it's true the first argument is used, else the second argument.</p> 
<p>We could perform a logical NOT, reverse the value, simply enough.</p> 
<p><img src="https://media.licdn.com/mpr/mpr/AAEAAQAAAAAAAAhjAAAAJDkzODY4Y2JjLTJmNDUtNGQ0NS04NjMwLTRhNGZlYWE2OWUxNA.png" class="center" draggable="true" data-bukket-ext-bukket-draggable="true"></p> 
<p>If this function is given a True it will return the left value of False and if given a False will return the right value of True. We can follow this up with logical AND.</p> 
<p><img src="https://media.licdn.com/mpr/mpr/AAEAAQAAAAAAAAc8AAAAJGVlYjM5YjY4LTJjZGMtNDc4MC1iZjNjLWVjZWU1YTM5Yzc4Nw.png" class="center" draggable="true" data-bukket-ext-bukket-draggable="true"></p> 
<p>If the leftBool is a True the value of rightBool will be returned as the value of this function. It will evaluate to true only if both are true. If leftBool is False the value of leftBool will be returned as the value of this function.</p> 
<p>Logical OR follows very quickly from this.</p> 
<p><img src="https://media.licdn.com/mpr/mpr/AAEAAQAAAAAAAAktAAAAJGI2MDlhMjQyLTg4YTctNDk4Zi1iODczLTdjNTU1ZDRjNTMwNA.png" class="center" draggable="true" data-bukket-ext-bukket-draggable="true"></p> 
<p>If leftBool is True leftBool is returned, otherwise we return rightBool. This function returns True if either value is True.</p> 
<p><br></p> 
<h2>Pairs</h2> 
<p>Let's start persisting arbitrary data into functions. If I wanted to persist two values in a pair I would expect that to look something like this:</p> 
<p><img src="https://media.licdn.com/mpr/mpr/AAEAAQAAAAAAAAfkAAAAJGRhYTM3ZWJlLWM5YTgtNGNmMy1iMjE5LTc4YzhmYzdhMWY1Nw.png" class="center" draggable="true" data-bukket-ext-bukket-draggable="true"></p> 
<p>We know we are only persisting data as functions. If we pass two values to a function 'Pair' those values will be available to the scope of that function.</p> 
<p><img src="https://media.licdn.com/mpr/mpr/AAEAAQAAAAAAAAhiAAAAJGJmMDA3OTQ5LTE1NDMtNDQzZS1hNjZiLTM2MmEzZGU0NmUxYg.png" class="center" draggable="true" data-bukket-ext-bukket-draggable="true"></p> 
<p>The two values 'left' and 'right' are now bound to the scope of this function invocation. How do we retrieve those values later? We return a function that gives us access to this scope.</p> 
<p><img src="https://media.licdn.com/mpr/mpr/AAEAAQAAAAAAAAg-AAAAJGRiZjk5MjlkLTViMTItNGM0MS1iNGU3LTRkYzZkNWVlZWEwYQ.png" class="center" draggable="true" data-bukket-ext-bukket-draggable="true"></p> 
<p>Now the value we receive from calling Pair is a function that gives us access to that inner scope. We invoke this returned function with a function that takes two arguments, the two values we gave to the Pair function.</p> 
<p><img src="https://media.licdn.com/mpr/mpr/AAEAAQAAAAAAAAlGAAAAJDg4MzY0ZGI0LTljZDAtNGExMC05Njc1LTViYmEyYTk4OWRhZg.png" class="center" draggable="true" data-bukket-ext-bukket-draggable="true"></p> 
<p>We say that the function destructures the Pair because it pulls it apart into its component values. This is somewhat similar to how destructuring assignment works in JavaScript.</p> 
<p><img src="https://media.licdn.com/mpr/mpr/AAEAAQAAAAAAAAiRAAAAJDI0MmI4ZmFhLWY0YjItNDQwYy1hMzBlLTI1Y2FkMTE3OWFkMQ.png" class="center" draggable="true" data-bukket-ext-bukket-draggable="true"></p> 
<p>We can use destructuring to create functions to retrieve the first and second values of the Pair.</p> 
<p><img src="https://media.licdn.com/mpr/mpr/AAEAAQAAAAAAAAePAAAAJGRiNmViYzI0LTFlZjgtNGEzMy1hMzY1LTI2OTEyM2ExNWQ0NQ.png" class="center" draggable="true" data-bukket-ext-bukket-draggable="true"></p> 
<p><br></p> 
<h2>Lists</h2> 
<p>Lists follow naturally from Pairs. In our implementation of Pairs we knew exactly how many values our data structure would handle. It would hold two, no more, no less. With Lists we need to handle an arbitrary number of values. The data structure we are actually going to implement is a linked list where a node in our list holds two things the value at that position and some representation of the remainder of the list.</p> 
<p><img src="https://media.licdn.com/mpr/mpr/AAEAAQAAAAAAAAh0AAAAJGU4MGY2NTc0LWNkYzYtNDMxOS1hYjkzLTJmZmFhNDFmZTUzMA.png" class="center" draggable="true" data-bukket-ext-bukket-draggable="true"></p> 
<p>Hmm, this is identical to our implementation of Pair. This isn't quite going to be good enough. What do we do when we do when we get to the end of a list? How do we represent there is no more list, or that we have an empty list? Do we just let the destructureNode function fail? No. We add a special value to represent the empty list. This is typically called Nil.</p> 
<p><img src="https://media.licdn.com/mpr/mpr/AAEAAQAAAAAAAAdlAAAAJGQ2N2ZjOTM5LWYwM2QtNDdlOC1iMGIzLWY1ZmEwOTJlOTE2Yw.png" class="center" draggable="true" data-bukket-ext-bukket-draggable="true"></p> 
<p>Now we can also represent the end of a List as Nil. If we're looping through a List we can make a recursive call in the destructureNode function and short-circuit the recursion when we hit the end of the List in our destructureNil function.</p> 
<p>The key thing to remember here is head is a value our list is holding and tail is another List, specifically the remaining List after this node.</p> 
<p>It's easy enough to build on this and write functions to retrieve the head and tail of our Lists. This is almost identical to the first and second functions for Pairs. The only difference is we need to handle the special case of Nil.</p> 
<p><img src="https://media.licdn.com/mpr/mpr/AAEAAQAAAAAAAAglAAAAJDVlMDI3MGY2LTc4YzUtNDNhOS1iOTgwLTFhZTllOWU3ZjQwNw.png" class="center" draggable="true" data-bukket-ext-bukket-draggable="true"></p> 
<p>Before moving on, let's write a function to transform one of these Lists into a JavaScript array to make it easier to check our work.</p> 
<p><img src="https://media.licdn.com/mpr/mpr/AAEAAQAAAAAAAAg-AAAAJDY1M2QwYjcwLWJmYjAtNDEzZS04ODEwLTY0Y2RkMDA0NTgzMQ.png" class="center" draggable="true" data-bukket-ext-bukket-draggable="true"></p> 
<p>Let's do something more interesting. Let's concatenate two lists. Our data structures are immutable, so we won't be modifying either List in order to perform the concatenation. What we will do is copy the first List and use the second List as the tail of our copy. This will leave our second List in tact, but we will save ourselves from unnecessary copying if the two Lists just share those nodes.</p> 
<p><img src="https://media.licdn.com/mpr/mpr/AAEAAQAAAAAAAAfuAAAAJDJlYzQ0ZjhlLWQ4N2ItNGE4Yy1hNDc4LWY0Y2YxOGI4NTZhMg.png" class="center" draggable="true" data-bukket-ext-bukket-draggable="true"></p> 
<p>When our recursion reaches the end of the first List the destructureNil function is used which just returns the second List which is then used as the tail of the last node in our copy.</p> 
<p>I'll take a moment to point out something obvious here. The List constructor is a prepend function.</p> 
<p><img src="https://media.licdn.com/mpr/mpr/AAEAAQAAAAAAAAeIAAAAJDBlZDZjZmEzLWZkYjEtNGQ0NS1iMjc4LTQ0YjBlYWMzZTlkYg.png" class="center" draggable="true" data-bukket-ext-bukket-draggable="true"></p> 
<p>The prepend operation is performed in constant O(1) time. Our concat operation however must recurse through every node in the first List, meaning concatenation takes time proportional to the size of the first List O(n). In many functional languages this operation is referred to as 'cons'. There really is no List constructor. Every List is just created by prepending to the Nil value.</p> 
<p>How about appending to a List? Appending to a List is going to be another O(n) operation. We are going to copy the List and just add one extra node to the end.</p> 
<p><img src="https://media.licdn.com/mpr/mpr/AAEAAQAAAAAAAAdIAAAAJGE3YjhhZWNlLTYzYmItNDMwNS1iYWIyLTJmNzViYWNjZmJmMg.png" class="center" draggable="true" data-bukket-ext-bukket-draggable="true"></p> 
<p>To make a copy of a List we were using a prepend operation. Could we then use our new append operation to make a reverse copy?</p> 
<p><img src="https://media.licdn.com/mpr/mpr/AAEAAQAAAAAAAAh0AAAAJDRlOTk0ZTQzLWY5ZWQtNDFkNC1iOGM1LWQ4NmNlZWM3YTc1ZA.png" class="center" draggable="true" data-bukket-ext-bukket-draggable="true"></p> 
<p>What other operations do we commonly want to perform on lists? Getting the nth value of a List is pretty common.</p> 
<p><img src="https://media.licdn.com/mpr/mpr/AAEAAQAAAAAAAAfQAAAAJDVhMTkwY2Q4LTliNzgtNDVkMC05NDU0LWJjYWNjZjUzODM0NA.png" class="center" draggable="true" data-bukket-ext-bukket-draggable="true"></p> 
<p>I told you, we would eventually get around to using conditionals. We've been able to do a lot with only functions. We could certainly do more, but I'm not that masochistic. Simple enough, we just keep decrementing n until it reaches 0 then we know we're at the correct node. If we get to an Empty node before n reaches 0 we know the requested index is out-of-bounds.</p> 
<p>What follows quickly from this is updating the node at the nth index. Because we are again non-destructively updating our Lists, we are creating a new List with the given node updated. We accomplish this by copying every node until we reach the given index and then use any remaining nodes as the tail of our new List, similar to how we performed concatenation.</p> 
<p><img src="https://media.licdn.com/mpr/mpr/AAEAAQAAAAAAAAl9AAAAJDE2YjFiNzAzLTI5NmEtNGMyZC05NDAwLTY5YjkxYTc1YmJlYQ.png" class="center" draggable="true" data-bukket-ext-bukket-draggable="true"></p> 
<p>We could obviously fill out all of the common functions for Lists. However, I think we get the idea. All the operations follow the same patterns. In the included source code I have implementations for map, filter, foldl and foldr if you want to take a look.</p> 
<p><br></p> 
<h2>Binary Search Trees</h2> 
<p>Binary Search Trees are going to be the last data structure we look at in this post. Following on from Pairs and Lists we are just going to be adding a little bit of complexity to what we have already seen. A node in a List is singly-linked to the rest of the List. A node in a binary tree is doubly-linked. All nodes in the left sub-tree have values less than the current node and all values in the right sub-tree have values greater than the current node. For this implementation we are going to say all values in the left sub-tree are less than or equal to the value of the current node. As with Lists we are going to have a special type to represent an empty tree.</p> 
<p><img src="https://media.licdn.com/mpr/mpr/AAEAAQAAAAAAAAgwAAAAJDFlMTc5ZTBhLTAxZTctNDkyMS1iNDJiLWRmMGQ2ZTE1MTVkMg.png" class="center" draggable="true" data-bukket-ext-bukket-draggable="true"></p> 
<p>As usual, we are going to make a function to turn our Tree into a more easily inspectable JavaScript object.</p> 
<p><img src="https://media.licdn.com/mpr/mpr/AAEAAQAAAAAAAAf7AAAAJDU2ODQ0NzQzLTIxYjgtNDA4Ni05OTg5LTlkMTM5YmFiZDdkNg.png" class="center" draggable="true" data-bukket-ext-bukket-draggable="true"></p> 
<p>The first thing we are going to want to do with our Tree is to insert values into it. Like Lists, Trees are built by inserting elements into the empty Tree. With binary search trees new elements are inserted as a new leaf. We just need to find the correct place to insert the new leaf. We compare the value of the new value to the value of the current node and move left or right depending on if it is smaller or larger. Once we find an Empty node we have a place to insert the new node.</p> 
<p><img src="https://media.licdn.com/mpr/mpr/AAEAAQAAAAAAAAhYAAAAJGMyYzI2ZjdkLWZkYjYtNDk0ZC1iMGM2LTkwMzA5Y2ZiYmU1Ng.png" class="center" draggable="true" data-bukket-ext-bukket-draggable="true"></p> 
<p>You will notice this code copies nodes on the path to the new node. Nodes that are not on the insertion path are shared with the new Tree, returned as a result of this insertion, and the old Tree. Just look at the first conditional in the destructureTree branch. The value to insert is less than or equal to the current. The right sub-tree is going to go unaltered. It can be shared. The inverse is true if the value is greater.</p> 
<p>The next thing we want to do with a binary search tree is to search. We will start with the simplest search. Just find the minimum (or maximum) value in our Tree. In the case of finding the minimum value we just keep moving left until we reach the end. We do so by recursively calling the min function on the left child node until we reach a left child node that has an empty left child. If you were to write this code in an object oriented language you would check for an empty left child node by checking a property on the node object. Something like node.left === null. Here we need to destructure the left node to see if it has an empty left child. If it does have an empty left node we return the current node we're on, else we recurse into the left node.</p> 
<p><img src="https://media.licdn.com/mpr/mpr/AAEAAQAAAAAAAAgrAAAAJDNlYzdhMTdhLWNlZmQtNDU1My1iZjlmLWM5ZDQ5M2MyOWE2Mg.png" class="center" draggable="true" data-bukket-ext-bukket-draggable="true"></p> 
<p>This code is easily adapted to finding the max by replacing the recursive call with the left node to a recursive call with the right node. I'll leave that out.</p> 
<p>How about more generic searching? I want to know if a given value is already in the tree. This follows fairly directly from finding the min or max. Our code just needs a conditional to know to move left or right based on the search value relative to the current value. If we come to an Empty node we return false, otherwise we return true when we land on a node with a value equal to our search value.</p> 
<p><img src="https://media.licdn.com/mpr/mpr/AAEAAQAAAAAAAAinAAAAJGIyYjZiMzVlLTIwMTEtNGZiMC05MjIxLTMwNjVhNmJmOWEyNA.png" class="center" draggable="true" data-bukket-ext-bukket-draggable="true"></p> 
<p>Deleting values is always where binary search trees get a little hairy to implement. However, in a functional data structure deleting values is much more straight forward. Deleting is much more straight forward because we don't have to worry about maintaining the mutated state of our data structure. We are copying all the pieces we are altering. We can be more declarative about saying, 'This is what this structure should look like now'. We will start with removing the minimum value in a Tree. We just need to move left until we reach a node with an empty left child. We then replace that node with its right child.</p> 
<p><img src="https://media.licdn.com/mpr/mpr/AAEAAQAAAAAAAAe9AAAAJDg1MDVkYTQ4LTUzNjgtNGIxYS1hZjVjLWZkNDA5YWNhN2MyMw.png" class="center" draggable="true" data-bukket-ext-bukket-draggable="true"></p> 
<p>If you look back at our code for finding the minimum value you'll see that this is almost identical. We are just constructing our new data structure as we recurse down to the minimum node. Once a node has no left child, which we know when the inner destructureEmpty is called, we just return the right node. If the initial Tree we pass in is an Empty tree we just return Empty.</p> 
<p>Following on from this we can write a function to delete an arbitrary value from a Tree. This again looks very much like our generic search function, we just build up a new Tree as we recurse down, moving left or right depending on if the value to remove is less than or greater than the value of the current node. However, what happens when we find the node to remove? We need to fill in the hole left by removing a node.</p> 
<p>To keep our remove function clean, we write a helper function to replace the removed node. We replace the removed node with the minimum node in the right sub-tree of the node we are removing. The minimum node in the right sub-tree is guaranteed to not break the correctness of our tree. It will be greater than all of the nodes in the left sub-tree of the node we are removing and it will be less than all of the nodes in what remains of the right sub-tree of the node we are removing. We take the value of the minimum node in the right sub-tree and create a new node to replace the node we are removing. This new node will use the left sub-tree of the node we are removing. Again, sharing this sub-tree with the tree we are deleting from as we are leaving it unaltered. Our new node will also use the right sub-tree of the node we are removing. However, for the right sub-tree we will be using a copy. We need to remove the minimum so we are not including the same node twice. Luckily enough we just made a removeMin function.</p> 
<p><img src="https://media.licdn.com/mpr/mpr/AAEAAQAAAAAAAAlIAAAAJGM1MDhmZTMxLTIxODQtNGUzZS04YzRhLTE5ODZjY2IwOGUwZg.png" class="center" draggable="true" data-bukket-ext-bukket-draggable="true"></p> 
<p>If you have written this in an object-oriented language, you will notice this is much less code. At each step we are able to be very declarative about what we want our tree to look like at that point.</p> 
<p>In our functional implementation of Lists we noted we were actually implementing a linked list and many of our operations took time proportional to the size of the list. For random input functional binary search trees will still offer logarithmic inserts, deletes and searches. I'm going to follow this post up fairly soon with a look at functional balanced binary search trees, specifically red/black trees. But this was our last data structure for today.</p> 
<p><br></p> 
<h2>A Return to Arithmetic</h2> 
<p>The first thing we covered were Church numerals. Almost certainly the least practical thing we looked at, but we're going to close for today and look at how we can do subtraction on Church numerals. This is an example of how far you can take computation with nothing more than functions. Once we can represent numbers and the operations on numbers we can support anything.</p> 
<p>We are going to solve the problem of subtraction by creating a decrement function and then applying it some n number of times. If we define a number in Church numerals as the number of times a function is applied, how do we get the previous application? The function we are applying must maintain its previous state.</p> 
<p>In our toNumber function we used the function application of our Church numerals to translate them into Arabic numerals. We could use this function application to perform operations between Church numerals.</p> 
<p>We wrote our add function like this:</p> 
<p><img src="https://media.licdn.com/mpr/mpr/AAEAAQAAAAAAAAf-AAAAJDRjZjYwNWM2LWJjNTYtNGQ2Yi1hNDM1LTUyMGJlNzg4ZjliNQ.png" class="center" draggable="true" data-bukket-ext-bukket-draggable="true"></p> 
<p>The n numeral applies fn n times and then m applies it m more times. However, we also wrote an increment function we called succ.</p> 
<p><img src="https://media.licdn.com/mpr/mpr/AAEAAQAAAAAAAAkNAAAAJGVmNWUwNDM3LTBmOTUtNDg2Yi1hNmM5LTcxNGJlNThlZGFkNw.png" class="center" draggable="true" data-bukket-ext-bukket-draggable="true"></p> 
<p>This just applies fn once extra time to num. We could write an addition function in terms of the succ function. Increment the m numeral some n number of times.</p> 
<p><img src="https://media.licdn.com/mpr/mpr/AAEAAQAAAAAAAAemAAAAJGE2NGE4MTU5LTJhMGMtNDI5ZC1iZDkwLTM1ODI1ZDc1NDM3Mg.png" class="center" draggable="true" data-bukket-ext-bukket-draggable="true"></p> 
<p>Instead of using another Church numeral as the argument for our function, what if we used a Pair? As we incremented the numeral the first value in the pair would be the previous value and the second value would be the current value. The succ function won't handle this for us, but we can write another function that could operate on Pairs.</p> 
<p><img src="https://media.licdn.com/mpr/mpr/AAEAAQAAAAAAAAflAAAAJDY4ZGU4ZjllLTA2YjAtNDZiNi04MjhkLTdiM2IxYWM1MWI5Yw.png" class="center" draggable="true" data-bukket-ext-bukket-draggable="true"></p> 
<p>If slide starts with a pair of zeros, Pair(Zero, Zero), successive calls to slide, slide(slide(Pair(Zero, Zero))), will work like the succ function, except the first value will always be one less. Therefore to implement a decrement function we apply slide some n number of times, starting with Pair(Zero, Zero), and take the first value from the returned Pair.</p> 
<p><img src="https://media.licdn.com/mpr/mpr/AAEAAQAAAAAAAAemAAAAJGU2YWU4OWVmLTI3YjQtNDVhOC1iNGExLWZiYjBjOWRlNGI2Yw.png" class="center" draggable="true" data-bukket-ext-bukket-draggable="true"></p> 
<p>Subtraction can now be written in terms of pred the same way we wrote our second attempt at add in terms of succ.</p> 
<p><img src="https://media.licdn.com/mpr/mpr/AAEAAQAAAAAAAAdtAAAAJDBlODBmMTU5LWFlZjgtNDFhOS04OTA1LWQwZjI0MWMxZjhiYw.png" class="center" draggable="true" data-bukket-ext-bukket-draggable="true"></p> 
<p>Cool, that's it for this post. As I said I'll follow up sometime soon with an implementation of red/black trees and maybe some other stuff. We'll see.</p> 
</div>
					</div>
				</article>
				<!--================= END :: Tutorial =================-->
				
				<!--================= START :: Tutorial =================-->
				<article>
					<a id="t-39" name="t-39"></a><h1>39 : Model-View-Controller (MVC) with JavaScript</h1>
					<span class="ref-site">https://alexatnet.com/articles/model-view-controller-mvc-javascript</span>
					<div class="tutorial__content">

<p>I like JavaScript because it is one of the most flexible languages in the world.
It supports wide range of the programming styles and techniques, but such
flexibility comes with danger - it is very easy for the JavaScript project to
become a messy heap if the practices or design patterns are applied in a wrong
way or inconsistently.</p>

<p>My goal for this article is to demonstrate how to apply the Model-View-
Controller pattern while developing a simple JavaScript component. The component
is a kind of the HTML ListBox ("select" HTML tag) control with an editable list
of items: the user should be able to select and remove items and add new items
into the list. The component will consist of three classes that corresponds to
the parts of the <a href="http://en.wikipedia.org/wiki/Model-view-controller">Model-View-Controller</a> design pattern.</p>

<p>I hope, this article will be a good reading for you, but it would be much better
if you consider to run the examples and adapt them to you needs. I believe you
have everything to create and run JavaScript programs: brains, hands, text
editor, and an Internet Browser (Google Chrome, for example).</p>

<p>The Model-View-Controller pattern requires some description here. As you may
know, the name of the pattern is based on the names of its main parts: Model,
which stores an application data model; View, which renders Model for an
appropriate representation; and Controller, which updates Model. Wikipedia
defines typical components of the Model-View-Controller architecture as follows:</p>

<ul>
<li><strong>Model</strong> - The domain-specific representation of the information on which the
application operates. The model is another name for the domain layer. Domain
logic adds meaning to raw data (e.g., calculating if today is the user's
birthday, or the totals, taxes and shipping charges for shopping cart items).</li>
<li><strong>View</strong> - Renders the model into a form suitable for interaction, typically a
user interface element. MVC is often seen in web applications, where the view is
the HTML page and the code which gathers dynamic data for the page.</li>
<li><strong>Controller</strong> - Processes and responds to events, typically user actions, and
invokes changes on the model and perhaps the view.</li>
</ul>

<p>The data of the component is just a list of items, in which one particular item
can be selected and deleted. So, the model of the component is very simple - it
consists of an array and a selected item index; and here it is:</p>

<pre><code class="language-js">/**
 * The Model. Model stores items and notifies
 * observers about changes.
 */
function ListModel(items) {
    this._items = items;
    this._selectedIndex = -1;

    this.itemAdded = new Event(this);
    this.itemRemoved = new Event(this);
    this.selectedIndexChanged = new Event(this);
}

ListModel.prototype = {
    getItems : function () {
        return [].concat(this._items);
    },

    addItem : function (item) {
        this._items.push(item);
        this.itemAdded.notify({ item : item });
    },

    removeItemAt : function (index) {
        var item;

        item = this._items[index];
        this._items.splice(index, 1);
        this.itemRemoved.notify({ item : item });
        if (index === this._selectedIndex) {
            this.setSelectedIndex(-1);
        }
    },

    getSelectedIndex : function () {
        return this._selectedIndex;
    },

    setSelectedIndex : function (index) {
        var previousIndex;

        previousIndex = this._selectedIndex;
        this._selectedIndex = index;
        this.selectedIndexChanged.notify({ previous : previousIndex });
    }
};
</code></pre>

<p>Event is a simple class for implementing the Observer pattern:</p>

<pre><code class="language-js">function Event(sender) {
    this._sender = sender;
    this._listeners = [];
}

Event.prototype = {
    attach : function (listener) {
        this._listeners.push(listener);
    },
    notify : function (args) {
        var index;

        for (index = 0; index &lt; this._listeners.length; index += 1) {
            this._listeners[index](this._sender, args);
        }
    }
};
</code></pre>

<p>The View class requires defining controls for interacting with. There are
numerous alternatives of interface for the task, but I prefer a most simple one.
I want my items to be in a Listbox control and two buttons below it: "plus"
button for adding items and "minus" for removing selected item. The support for
selecting an item is provided by Listbox's native functionality. A View class is
tightly bound with a Controller class, which "… handles the input event from
the user interface, often via a registered handler or callback" (from
<a href="http://en.wikipedia.org/wiki/Model-view-controller">wikipedia.org</a>).</p>

<p>Here are the View and Controller classes:</p>

<pre><code class="language-js">/**
 * The View. View presents the model and provides
 * the UI events. The controller is attached to these
 * events to handle the user interraction.
 */
function ListView(model, elements) {
    this._model = model;
    this._elements = elements;

    this.listModified = new Event(this);
    this.addButtonClicked = new Event(this);
    this.delButtonClicked = new Event(this);

    var _this = this;

    // attach model listeners
    this._model.itemAdded.attach(function () {
        _this.rebuildList();
    });
    this._model.itemRemoved.attach(function () {
        _this.rebuildList();
    });

    // attach listeners to HTML controls
    this._elements.list.change(function (e) {
        _this.listModified.notify({ index : e.target.selectedIndex });
    });
    this._elements.addButton.click(function () {
        _this.addButtonClicked.notify();
    });
    this._elements.delButton.click(function () {
        _this.delButtonClicked.notify();
    });
}

ListView.prototype = {
    show : function () {
        this.rebuildList();
    },

    rebuildList : function () {
        var list, items, key;

        list = this._elements.list;
        list.html('');

        items = this._model.getItems();
        for (key in items) {
            if (items.hasOwnProperty(key)) {
                list.append($('&lt;option&gt;' + items[key] + '&lt;/option&gt;'));
            }
        }
        this._model.setSelectedIndex(-1);
    }
};

/**
 * The Controller. Controller responds to user actions and
 * invokes changes on the model.
 */
function ListController(model, view) {
    this._model = model;
    this._view = view;

    var _this = this;

    this._view.listModified.attach(function (sender, args) {
        _this.updateSelected(args.index);
    });

    this._view.addButtonClicked.attach(function () {
        _this.addItem();
    });

    this._view.delButtonClicked.attach(function () {
        _this.delItem();
    });
}

ListController.prototype = {
    addItem : function () {
        var item = window.prompt('Add item:', '');
        if (item) {
            this._model.addItem(item);
        }
    },

    delItem : function () {
        var index;

        index = this._model.getSelectedIndex();
        if (index !== -1) {
            this._model.removeItemAt(this._model.getSelectedIndex());
        }
    },

    updateSelected : function (index) {
        this._model.setSelectedIndex(index);
    }
};
</code></pre>

<p>And of course, the Model, View, and Controller classes should be instantiated.
The sample, which you can below, uses the following code to instantiate and
configure the classes:</p>

<pre><code class="language-js">$(function () {
    var model = new ListModel(['PHP', 'JavaScript']),
        view = new ListView(model, {
            'list' : $('#list'), 
            'addButton' : $('#plusBtn'), 
            'delButton' : $('#minusBtn')
        }),
        controller = new ListController(model, view);
    
    view.show();
});​
</code></pre>

<pre><code class="language-html">&lt;select id="list" size="10"&gt;&lt;/select&gt;
&lt;button id="plusBtn"&gt;  +  &lt;/button&gt;
&lt;button id="minusBtn"&gt;  -  &lt;/button&gt;
</code></pre>

<pre>/*global $ */
/*jslint indent: 4, maxlen: 80, browser: true, nomen: true */

(function () {
    'use strict';

    function Event(sender) {
        this._sender = sender;
        this._listeners = [];
    }

    Event.prototype = {
        attach : function (listener) {
            this._listeners.push(listener);
        },
        notify : function (args) {
            var index;

            for (index = 0; index &lt; this._listeners.length; index += 1) {
                this._listeners[index](this._sender, args);
            }
        }
    };

    /**
     * The Model. Model stores items and notifies
     * observers about changes.
     */
    function ListModel(items) {
        this._items = items;
        this._selectedIndex = -1;

        this.itemAdded = new Event(this);
        this.itemRemoved = new Event(this);
        this.selectedIndexChanged = new Event(this);
    }

    ListModel.prototype = {
        getItems : function () {
            return [].concat(this._items);
        },

        addItem : function (item) {
            this._items.push(item);
            this.itemAdded.notify({ item : item });
        },

        removeItemAt : function (index) {
            var item;

            item = this._items[index];
            this._items.splice(index, 1);
            this.itemRemoved.notify({ item : item });
            if (index === this._selectedIndex) {
                this.setSelectedIndex(-1);
            }
        },

        getSelectedIndex : function () {
            return this._selectedIndex;
        },

        setSelectedIndex : function (index) {
            var previousIndex;

            previousIndex = this._selectedIndex;
            this._selectedIndex = index;
            this.selectedIndexChanged.notify({ previous : previousIndex });
        }
    };

    /**
     * The View. View presents the model and provides
     * the UI events. The controller is attached to these
     * events to handle the user interraction.
     */
    function ListView(model, elements) {
        this._model = model;
        this._elements = elements;

        this.listModified = new Event(this);
        this.addButtonClicked = new Event(this);
        this.delButtonClicked = new Event(this);

        var _this = this;

        // attach model listeners
        this._model.itemAdded.attach(function () {
            _this.rebuildList();
        });
        this._model.itemRemoved.attach(function () {
            _this.rebuildList();
        });

        // attach listeners to HTML controls
        this._elements.list.change(function (e) {
            _this.listModified.notify({ index : e.target.selectedIndex });
        });
        this._elements.addButton.click(function () {
            _this.addButtonClicked.notify();
        });
        this._elements.delButton.click(function () {
            _this.delButtonClicked.notify();
        });
    }

    ListView.prototype = {
        show : function () {
            this.rebuildList();
        },

        rebuildList : function () {
            var list, items, key;

            list = this._elements.list;
            list.html('');

            items = this._model.getItems();
            for (key in items) {
                if (items.hasOwnProperty(key)) {
                    list.append($('<option>' + items[key] + '</option>'));
                }
            }
            this._model.setSelectedIndex(-1);
        }
    };

    /**
     * The Controller. Controller responds to user actions and
     * invokes changes on the model.
     */
    function ListController(model, view) {
        this._model = model;
        this._view = view;

        var _this = this;

        this._view.listModified.attach(function (sender, args) {
            _this.updateSelected(args.index);
        });

        this._view.addButtonClicked.attach(function () {
            _this.addItem();
        });

        this._view.delButtonClicked.attach(function () {
            _this.delItem();
        });
    }

    ListController.prototype = {
        addItem : function () {
            var item = window.prompt('Add item:', '');
            if (item) {
                this._model.addItem(item);
            }
        },

        delItem : function () {
            var index;

            index = this._model.getSelectedIndex();
            if (index !== -1) {
                this._model.removeItemAt(this._model.getSelectedIndex());
            }
        },

        updateSelected : function (index) {
            this._model.setSelectedIndex(index);
        }
    };

    $(function () {
        var model = new ListModel(['PHP', 'JavaScript']),
            view = new ListView(model, {
                'list' : $('#list'),
                'addButton' : $('#plusBtn'),
                'delButton' : $('#minusBtn')
            }),
            controller = new ListController(model, view);

        view.show();
    });
}());
</pre>
					</div>
				</article>
				<!--================= END :: Tutorial =================-->
				
				<!--================= START :: Tutorial =================-->
				<article>
					<a id="t-40" name="t-40"></a><h1>40 : JavaScript Function Memoization</h1>
					<span class="ref-site">http://inlehmansterms.net/2015/03/01/javascript-memoization/</span>
					<div class="tutorial__content">
<section class="Post-content">
    <p>In this post I am going to walk through when you might want to use memoization for your JavaScript functions and how you can easily memoize any function. Before we can go much further, let's define what memoization is.</p>

<!--more-->

<h2 id="what-is-memoization">What is memoization?</h2>

<p>Memoization is an optimization technique where expensive function calls are cached such that the result can be immediately returned the next time the function is called with the same arguments. This method of optimization is not unique to JavaScript and is quite common in many programming languages. It is especially useful in recursive functions as calls are more likely to call with the same arguments while recursing. Take a recursive <code>factorial</code> function for example:</p>
<pre><code>function factorial(num) {
  if(num === 1) { return 1 };
  return num * factorial(num - 1);
}
</code></pre>
<p>If we call <code>factorial(3)</code>, the function calls <code>factorial(3)</code>, <code>factorial(2)</code>, and <code>factorial(1)</code> will be called. If we memoize this function, another call to <code>factorial(3)</code> will not need to recurse, it can simply return the result that it has cached. The real benefit is if we call <code>factorial(4)</code>, we will short circuit our recursion, because <code>factorial(3)</code> is already cached, so we do not need to recurse any further, we can just use that result.</p>

<h2 id="sounds-great-sign-me-up">Sounds great, sign me up!</h2>

<p>We can simply create a <code>memoize</code> function that takes another function and modifies it to memoize calls.</p>
<pre><code>function memoize(func) {
  var cache = {};
  return function() {
    var key = JSON.stringify(arguments);
    if(cache[key]) {
      return cache[key];
    }
    else {
      var val = func.apply(this, arguments);
      cache[key] = val;
      return val;
    }
  };
}
</code></pre>
<p>Now we can easily memoize any pure function, like our <code>factorial</code> function.</p>
<pre><code>var factorial = memoize(function(num) {
  console.log('working for factorial(' + num + ')');
  if(num === 1) { return 1 };
  return num * factorial(num - 1);
});

// first call
console.log(factorial(3));
//=&gt; working for factorial(3)
//=&gt; working for factorial(2)
//=&gt; working for factorial(1)
//=&gt; 6

// successive calls
console.log(factorial(3)); //=&gt; 6
console.log(factorial(3)); //=&gt; 6

// short circuit higher factorial calls
console.log(factorial(4));
//=&gt; working for factorial(4)
//=&gt; 24
</code></pre>


<h2 id="advanced-usage">Advanced usage</h2>

<p>Right now we have memoization working by simply wrapping a given function with our <code>memoization</code> function. The results are cached for calls with the same arguments. This is great, but what if the arguments are not our only dependencies. What if we are memoizing a method on an object and that method relies on both the arguments AND other properties on the object? How do we account for these other dependencies? If we do not do anything different, memoizing a function might actually cause it to produce incorrect values (if the other dependencies have changed). We need a way to invalidate the cache for these dependencies as well.</p>

<p>The good news is that we can easily take other dependencies into account. Earlier you might have been wondering why I am using <code>JSON.stringify</code> to create my cache keys, and soon you will see how this helps make it extremely easy to add any number of dependencies in addition to a function's arguments.</p>

<p>Let's say we have a <code>Person</code> model with a firstName and lastName as well as a method, <code>fullName</code>, that takes an optional argument, title and outputs the person's full name.</p>
<pre><code>function memoize() { ... }

function Person(firstName, lastName) {
  this.firstName = firstName;
  this.lastName = lastName;

  this.fullName = memoize(function(title) {
    return title + ' ' + this.firstName + ' ' + this.lastName;
  });
}
</code></pre>
<p>All we need to do to memoize this function on the <code>Person</code> object, is to update the <code>memoize</code> function to take a second argument, <code>depsFunc</code>. <code>depsFunc</code> will be a function that returns an array of the dependencies. We can then use <code>depsFunc</code> as well as <code>func</code> to calculate the unique key in our hash.</p>
<pre><code>function memoize(func, depsFunc) {
  var cache = {};
  return function() {
    var key = JSON.stringify([depsFunc(), arguments]);
    if(cache[key]) {
      return cache[key];
    }
    else {
      var val = func.apply(this, arguments);
      cache[key] = val;
      return val;
    }
  };
}

function Person(firstName, lastName) {
  this.firstName = firstName;
  this.lastName = lastName;

  this.fullName = memoize(
    // calculation
    function(title) {
      console.log('working...');
      return title + ' ' + this.firstName + ' ' + this.lastName;
    },
    // dependencies
    function() {
      return [this.firstName, this.lastName];
    }.bind(this));
}

// create a new Person
var person = new Person('Jonathan', 'Lehman');

// first call to our memoized function does the work
console.log(person.fullName('Mr.'));
//=&gt; working
//=&gt; Mr. Jonathan Lehman

// successive calls
console.log(person.fullName('Mr.'));
//=&gt; Mr. Jonathan Lehman

// work must be done if dependencies or arguments change

// change arguments
console.log(person.fullName('Mister'));
//=&gt; work
//=&gt; Mister Jonathan Lehman

// change deps
person1.firstName = 'Jon';
console.log(person.fullName('Mr.'));
//=&gt; work
//=&gt; Mr. Jon Lehman
</code></pre>

<h2 id="careful-memoization-is-not-a-magic-bullet">Careful, memoization is not a magic bullet</h2>

<p>Keep in mind that memoization does not make sense for all function calls. There is a higher memory overhead since we must store our cached results so that we can later recall them as well as an added complexity of using memoization, so it really only makes sense for functions that are computationally expensive.</p>

<p>Also, memoization does not work well for functions that are not pure, that is functions that have side effects. Memoizing only allows us to cache a result, so any other side effects get lost on successive calls. That said, you can get around this constraint, by returning a function that includes your side effects that you will need to execute after getting the result.</p>

  </section>
					</div>
				</article>
				<!--================= END :: Tutorial =================-->
				
				<!--================= START :: Tutorial =================-->
				<article>
					<a id="t-41" name="t-41"></a><h1>41 : Javascript Memoization</h1>
					<span class="ref-site">https://www.safaribooksonline.com/library/view/javascript-the-good/9780596517748/ch04s15.html</span>
					<div class="tutorial__content">
<div class="sect1" title="Memoization"><p>Functions can use objects to remember the results of previous operations, making
                it possible to avoid unnecessary work. This optimization is called
                    <span class="emphasis"><em>memoization</em></span>. JavaScript's objects and arrays are very
                convenient for this.<a id="IDX-CHP-4-0244" class="indexterm"></a><a id="IDX-CHP-4-0245" class="indexterm"></a></p><p>Let's say we want a recursive function to compute Fibonacci numbers. A Fibonacci
                number is the sum of the two previous Fibonacci numbers. The first two are 0 and
                    1:<a id="IDX-CHP-4-0246" class="indexterm"></a><a id="IDX-CHP-4-0247" class="indexterm"></a><a id="IDX-CHP-4-0248" class="indexterm"></a></p><a id="I_programlisting4_d1e3564"></a><pre class="programlisting">var fibonacci = function (n) {
    return n &lt; 2 ? n : fibonacci(n − 1) + fibonacci(n − 2);
};

for (var i = 0; i &lt;= 10; i += 1) {
    document.writeln('// ' + i + ': ' + fibonacci(i));
}

// 0: 0
// 1: 1
// 2: 1
// 3: 2
// 4: 3
// 5: 5
// 6: 8
// 7: 13
// 8: 21
// 9: 34
// 10: 55</pre><p>This works, but it is doing a lot of unnecessary work. The <code class="literal">fibonacci</code> function is called 453 times. We call it 11
                times, and it calls itself 442 times in computing values that were probably already
                recently computed. If we <span class="emphasis"><em>memoize</em></span> the function, we can
                significantly reduce its workload.</p><p>We will keep our memoized results in a <code class="literal">memo</code>
                array that we can hide in a closure. When our function is called, it first looks to
                see if it already knows the result. If it does, it can immediately return it:</p><a id="I_programlisting4_d1e3579"></a><pre class="programlisting">var fibonacci = (function (  ) {
    var memo = [0, 1];
    var fib = function (n) {
        var result = memo[n];
        if (typeof result !== 'number') {
            result = fib(n − 1) + fib(n − 2);
            memo[n] = result;
        }
        return result;
    };
    return fib;
}( ));</pre><p>This function returns the same results, but it is called only 29 times. We called
                it 11 times. It called itself 18 times to obtain the previously memoized
                results.</p><p>We can generalize this by making a function that helps us make memoized functions.
                The <code class="literal">memoizer</code> function will take an initial
                    <code class="literal">memo</code> array and the <code class="literal">formula</code> function. It returns a recur function that manages the memo
                store and that calls the <code class="literal">formula</code> function as
                needed. We pass the <code class="literal">recur</code> function and the
                function's parameters to the <code class="literal">formula</code>
                function:</p><a id="I_programlisting4_d1e3604"></a><pre class="programlisting">var memoizer = function (memo, formula) {
    var recur = function (n) {
        var result = memo[n];
        if (typeof result !== 'number') {
            result = formula(recur, n);
            memo[n] = result;
        }
        return result;
    };
    return recur;
};</pre><p>We can now define <code class="literal">fibonacci</code> with the memoizer,
                providing the initial <code class="literal">memo</code> array and <code class="literal">formula</code> function:</p><a id="I_programlisting4_d1e3618"></a><pre class="programlisting">var fibonacci = memoizer([0, 1], function (recur, n) {
    return recur(n − 1) + recur(n − 2);
});</pre><p>By devising functions that produce other functions, we can significantly reduce
                the amount of work we have to do. For example, to produce a memoizing factorial
                function, we only need to supply the basic factorial formula:<a id="IDX-CHP-4-0249" class="indexterm"></a></p><a id="I_programlisting4_d1e3625"></a><pre class="programlisting">var factorial = memoizer([1, 1], function (recur, n) {
    return n * recur(n − 1);
});</pre></div>
					</div>
				</article>
				<!--================= END :: Tutorial =================-->
				
				<!--================= START :: Tutorial =================-->
				<article>
					<a id="t-42" name="t-42"></a><h1>42 : Hello World</h1>
					<h3>A "Hello World"-like example of Javascript using the MVC pattern.</h3>
					<span class="ref-site">http://sandbox.thewikies.com/javascript-mvc-hello-world/</span>
					<div class="tutorial__content">
<pre>
/* ==========================================================================
 * A "Hello World"-like example of Javascript using the MVC pattern.
 * ========================================================================== */



/*
 * Model
 */

// a model is where the data object is created.
var ModelExample = function ( data ) {
	// the model instance has a property called "myProperty"
	// created from the data's "yourProperty".
	this.myProperty = data.yourProperty;

	// return the model instance
	return this;
};

// a model constructor might have a function that creates new model instances.
ModelExample.find = function ( id ) {
	// data used to create a new model may come from anywhere
	// but in this example data comes from this inline object.
	var ourData = {
		'123': {
			yourProperty: 'Hello World'
		}
	};

	// get a new model instance containing our data.
	var model = new ModelExample(ourData[id]);

	// return the model.
	return model;
};



/*
 * View
 */

// a view is where the output is created.
var ViewExample = function ( model ) {
	this.model = model;

	return this;
};

// a view might have a function that returns the rendered output.
ViewExample.prototype.output = function () {
	// data used to create a template may come from anywhere
	// but in this example template comes from this inline string.
	var ourData = '&lt;h1&gt;&lt;%= myProperty %&gt;&lt;/h1&gt;';

	// store this instance for reference in the replace function below
	var instance = this;

	// return the template using values from the model.
	return ourData.replace(/&lt;%=\s+(.*?)\s+%&gt;/g, function (m, m1) {
		return instance.model[m1];
	});
};

// a view might have a function that renders the output.
ViewExample.prototype.render = function () {
	// this view renders to the element with the id of "output"
	document.getElementById('output').innerHTML = this.output();
};



/*
 * Controller
 */

// a controller is where the model and the view are used together.
var ControllerExample = function () {
	return this;
};

// this function uses the Model and View together.
ControllerExample.prototype.loadView = function ( id ) {
	// get the model.
	var model = ModelExample.find( id );

	// get a new view.
	var view = new ViewExample(model);

	// run the view's "render" function
	view.render();
};




/*
 * Example
 */

function bootstrapper() {
	var controller = new ControllerExample;
	controller.loadView(123);
}

bootstrapper();


</pre>

<pre>
/* ==========================================================================
 * A "Hello World"-like example of Javascript using the MVC pattern.
 * This time with the addition of events.
 * ========================================================================== */



/*
 * Model
 */

// a model is where the data object is created.
var _Model = function ( data ) {
	// the model instance has a property called "myProperty"
	// created from the data's "yourProperty".
	this.myProperty = data.yourProperty;

	// return the model instance
	return this;
};

// a model constructor might have a function that creates new model instances.
_Model.find = function ( id ) {
	// data used to create a new model may come from anywhere
	// but in this example data comes from this inline object.
	var ourData = {
		'123': {
			yourProperty: 'You clicked.'
		},
		'456': {
			yourProperty: 'You pressed a key.'
		}
	};

	// get a new model instance containing our data.
	var model = new _Model(ourData[id]);

	// return the model.
	return model;
};



/*
 * View
 */

// a view is where the output is created.
var _View = function ( model ) {
	this.model = model;

	return this;
};

// a view might have a function that returns the rendered output.
_View.prototype.output = function () {
	// data used to create a template may come from anywhere
	// but in this example template comes from this inline string.
	var ourData = '&lt;h1&gt;&lt;%= myProperty %&gt;&lt;/h1&gt;';

	// store this instance for reference in the replace function below
	var instance = this;

	// return the template using values from the model.
	return ourData.replace(/&lt;%=\s+(.*?)\s+%&gt;/g, function (m, m1) {
		return instance.model[m1];
	});
};

// a view might have a function that renders the output.
_View.prototype.render = function () {
	// this view renders to the element with the id of "output"
	document.getElementById('output').innerHTML = this.output();
};


/*
 * Controller
 */

// a controller is where the model and the view are used together.
var _Controller = {};

// this function uses the Model and View together.
_Controller.loadView = function ( id ) {
	// get the model.
	var model = _Model.find( id );

	// get a new view.
	var view = new _View(model);

	// run the view's "render" function
	view.render();
};



/*
 * Event
 */

var Event123 = 1 &lt;&lt; 0;
var Event456 = 1 &lt;&lt; 1;

// an event is where something happening is captured.
var _Event = function (flag) {
	// check if Event123 was passed
	if (flag &amp; Event123) {
		// run the controller's show function
		_Controller.loadView(123);
	}

	// check if Event456 was passed
	if (flag &amp; Event456) {
		// run the controller's show function
		_Controller.loadView(456);
	}
};



/*
 * Example
 */

function bootstrapper() {
	document.onclick = function () {
		_Event(Event123);
	};

	document.onkeydown = function () {
		_Event(Event456);
	};
}

bootstrapper();
</pre>
					</div>
				</article>
				<!--================= END :: Tutorial =================-->
				
				<!--================= START :: Tutorial =================-->
				<article>
					<a id="t-43" name="t-43"></a><h1>43 : JavaScript's Magical Tips Every Developer Should Remember</h1>
					<span class="ref-site">https://blog.zipboard.co/javascripts-magical-tips-every-developer-should-remember-631b699fc251</span>
					<div class="tutorial__content">
<div class="section-inner sectionLayout--insetColumn"><p name="f692" id="f692" class="graf graf--p graf-after--figure">Over the course of developing our product at <a href="http://zipboard.co" data-href="http://zipboard.co" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">zipBoard</a>, JavaScript has been our bedrock for all intents and purposes. As per <a href="http://stackoverflow.com/research/developer-survey-2016#developer-profile" data-href="http://stackoverflow.com/research/developer-survey-2016#developer-profile" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">this developer survey</a> at Stack Overflow, we're in good company on this front. JavaScript is <em class="markup--em markup--p-em">the</em> most popular technology for full stack development. While I have been focusing mainly on NodeJS, and somewhat AngularJS, I have realized that there are always some tricks and tips involved in every programming language irrespective of its nature of existence.</p><p name="c962" id="c962" class="graf graf--p graf-after--p">I have seen (<em class="markup--em markup--p-em">so many times</em>) that we programmers can tend to make things over complicated, which in-turn leads to problems and chaos in the developing environment. It is beautifully explained by <a href="https://medium.com/@_ericelliott" data-href="https://medium.com/@_ericelliott" data-anchor-type="2" data-user-id="c359511de780" data-action-value="c359511de780" data-action="show-user-card" data-action-type="hover" class="markup--user markup--p-user" target="_blank">Eric Elliott</a> in his post.</p><p name="2a87" id="2a87" class="graf graf--p graf-after--mixtapeEmbed">Without further ado let's get started with the cool tips for JavaScript:</p><p name="c940" id="c940" class="graf graf--p graf-after--p"><strong class="markup--strong markup--p-strong">1. Use "var" when creating a new variable.</strong><br>Whenever you are creating a new variable always keep in mind to use "var" in front of the variable name unless you want to create a global variable. This is so because if you create a variable without using "var" its scope will automatically be global which sometime creates issues, unless required.</p><p name="4776" id="4776" class="graf graf--p graf-after--p"><strong class="markup--strong markup--p-strong">2. Always use "===" as comparator instead of "==" (Strict equal)</strong><br>Use "===" instead of "==" because when you use "==" there is automatic type conversion involved which can lead to undesirable results.</p><pre name="127a" id="127a" class="graf graf--pre graf-after--p">3 == '3' // true<br>3 === '3' //false</pre><p name="d794" id="d794" class="graf graf--p graf-after--pre">This happens because in "===" the comparison takes place among the value and type.</p><pre name="6b6d" id="6b6d" class="graf graf--pre graf-after--p">[10] == 10   // is true<br>[10] === 10  // is false<br>'10' == 10   // is true<br>'10' === 10  // is false<br>[] == 0      // is true<br>[] === 0     // is false<br>'' == false  // is true<br>'' === false // is false</pre><p name="e2b8" id="e2b8" class="graf graf--p graf-after--pre"><strong class="markup--strong markup--p-strong">3. 'undefined, null, 0, false, NaN, '' (empty string)' are all false conditions.</strong></p><p name="a3c4" id="a3c4" class="graf graf--p graf-after--p"><strong class="markup--strong markup--p-strong">4. Empty an array</strong></p><pre name="a93c" id="a93c" class="graf graf--pre graf-after--p">var sampleArray = [2, 223, 54, 31];<br>sampleArray.length = 0; // sampleArray becomes []</pre><p name="a4ab" id="a4ab" class="graf graf--p graf-after--pre"><strong class="markup--strong markup--p-strong">5. Rounding number to N decimal places</strong></p><pre name="c301" id="c301" class="graf graf--pre graf-after--p">var n = 2.4134213123;<br>n = n.toFixed(4); // computes n = "2.4134"</pre><p name="5c55" id="5c55" class="graf graf--p graf-after--pre"><strong class="markup--strong markup--p-strong">6. Verify that your computation will produce finite result or not.</strong></p><pre name="0e19" id="0e19" class="graf graf--pre graf-after--p">isFinite(0/0);       // false<br>isFinite('foo');     // true<br>isFinite('10');      // true<br>isFinite(10);        // true<br>isFinite(undefined); // false<br>isFinite();          // false  <br>isFinite(null);      // true</pre><p name="d1db" id="d1db" class="graf graf--p graf-after--pre">Lets take an example to understand the use case of this function, suppose you have written a database query over a table which contains large amount of data and after the execution of query you are not certain about all the possible result values of that query. The data of query changes on something that you put dynamically in the query. In such a case you are not sure about finite property of the result and if you use that result directly it can give you infinite condition, which can break your code.</p><p name="ebba" id="ebba" class="graf graf--p graf-after--p">Hence, it is recommended to use <code class="markup--code markup--p-code">isFinite()</code> before any such operations so that infinite values can be handled properly.</p><p name="de4e" id="de4e" class="graf graf--p graf-after--p"><strong class="markup--strong markup--p-strong">7. Use a switch/case statement instead of a series of if/else</strong></p><p name="6efb" id="6efb" class="graf graf--p graf-after--p">Using switch/case is faster when there are more than 2 cases, and it is more elegant (better organized code). Avoid using it when you have more than 10 cases.</p><p name="7ccc" id="7ccc" class="graf graf--p graf-after--p"><strong class="markup--strong markup--p-strong">8. Use of "use strict" inside your file</strong><br>The string "use strict" will keep you from worrying about declaration of a variable which I mentioned in 1st point.</p><pre name="623b" id="623b" class="graf graf--pre graf-after--p"><em class="markup--em markup--pre-em">// This is bad, since you do create a global without having anyone to tell you<br></em>(function () {<br>   a = 42;<br>   console.log(a);<br>   <em class="markup--em markup--pre-em">// → 42</em><br>})();<br>console.log(a);<em class="markup--em markup--pre-em"><br>// → 42</em></pre><p name="c128" id="c128" class="graf graf--p graf--startsWithDoubleQuote graf-after--pre">"use strict" will keep you away from making above mistake. Using "use strict", you can get quite a few more errors:</p><pre name="8c59" id="8c59" class="graf graf--pre graf-after--p">(function () {<br>   "use strict";<br>   a = 42;<em class="markup--em markup--pre-em"><br>   // Error: Uncaught ReferenceError: a is not defined<br></em>})();</pre><p name="0d08" id="0d08" class="graf graf--p graf-after--pre">You could be wondering why you can't put "use strict" outside the wrapping function. Well, you can, but it will be applied globally. That's still not bad; but it will affect if you have code which comes from other libraries, or if you bundle everything in one file.</p><p name="3301" id="3301" class="graf graf--p graf-after--p"><strong class="markup--strong markup--p-strong">9. Use &amp;&amp; and || to create magic</strong></p><pre name="cf60" id="cf60" class="graf graf--pre graf--startsWithDoubleQuote graf-after--p">"" || "foo"<em class="markup--em markup--pre-em"><br>// → "foo"</em></pre><pre name="477f" id="477f" class="graf graf--pre graf-after--pre">undefined || 42<em class="markup--em markup--pre-em"><br>// → 42</em></pre><pre name="cbff" id="cbff" class="graf graf--pre graf-after--pre">function doSomething () {<br>   return { foo: "bar" };<br>}<br>var expr = true;<br>var res = expr &amp;&amp; doSomething();<br>res &amp;&amp; console.log(res);<br><em class="markup--em markup--pre-em">// → { foo: "bar" }</em></pre><p name="cced" id="cced" class="graf graf--p graf-after--pre"><strong class="markup--strong markup--p-strong">Additionally, don't forget to use a code beautifier when coding. Use </strong><a href="http://www.jslint.com/" data-href="http://www.jslint.com/" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank"><strong class="markup--strong markup--p-strong">JSLint</strong></a><strong class="markup--strong markup--p-strong"> and </strong><a href="https://en.wikipedia.org/wiki/Minification_%28programming%29" data-href="https://en.wikipedia.org/wiki/Minification_(programming)" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank"><strong class="markup--strong markup--p-strong">minification</strong></a><strong class="markup--strong markup--p-strong"> (</strong><a href="https://pypi.python.org/pypi/jsmin" data-href="https://pypi.python.org/pypi/jsmin" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank"><strong class="markup--strong markup--p-strong">JSMin</strong></a><strong class="markup--strong markup--p-strong">, for example) before going live. This will help you maintain a coding standard in your project and make it as standard as possible.</strong></p><p name="b73c" id="b73c" class="graf graf--p graf-after--p">The above is a mere reflection of the power of JavaScript.</p><p name="9db0" id="9db0" class="graf graf--p graf-after--p graf--trailing">Thanks for reading!</p></div>
					</div>
				</article>
				<!--================= END :: Tutorial =================-->
				
				<!--================= START :: Tutorial =================-->
				<article>
					<a id="t-44" name="t-44"></a><h1>44 : 5 Features You Can Use in ES6 Today</h1>
					<span class="ref-site">https://scotch.io/bar-talk/five-things-you-can-use-in-es6-today</span>
					<div class="tutorial__content">
<div class="content">
                                <p>In my day job I'm the head of developer evangelism at <a href="https://www.pubnub.com?utm_source=Inbound&amp;utm_medium=scotchio&amp;utm_campaign=IN-CY17-Q1-XXX-XXX-March-14&amp;utm_term=utm-generator&amp;utm_content=utm-example/">PubNub</a>. We use
Javascript heavily in our new product <a href="https://www.pubnub.com/products/blocks/?utm_source=Inbound&amp;utm_medium=scotchio&amp;utm_campaign=IN-CY17-Q1-XXX-XXX-March-14&amp;utm_term=utm-generator&amp;utm_content=utm-example/">BLOCKS</a>, which enables developers
to run massively distributed Javascript code on the edge with very
low latency. </p>
<blockquote>
<p>Needless to say, we care a lot about Javascript performance and features, which is why ES6 is so exciting to us.</p>
</blockquote>
<p><strong>The changes in ES6 have been massive, exciting, and confusing.</strong> In this essay I'll introduce five features of the new JavaScript that you can use right away to supercharge your code, and what features to hold off on. </p>
<h2 id="ecmawhat"><a href="#ecmawhat"><span class="icon">#</span> Ecma-what?</a></h2>
<p>JavaScript has had many versions over the years, but overall
the evolution was slow until recently. I think More changes have
happened in the past two years than in the previous twenty.
ES 6 stands for EcmaScript 6. It's also called EcmaScript 2015,
or ES 2015. These are all different names for the 'new Javascript'.</p>
<p>I'm not entirely sure <em>why</em> JS has changed so much recently,
but it seems to be because the owners of the major JavaScript engines
have finally become interested in pushing the language forward.</p>
<p>Also, the advent of <a href="https://scotch.io/tutorials/javascript-transpilers-what-they-are-why-we-need-them">transpilers</a> like <a href="https://scotch.io/tutorials/from-javascript-to-typescript-pt-i-types-variables">TypeScript</a> have made it possible to use new
language features <em>before</em> they are built into the browsers. These
two have combined to push JavaScript forward massively.</p>
<p>JS matters because it's the fabric of the web, and increasingly used
in server side apps with Node, and in mobile and desktop apps with Cordova,
React Native, and Electron. </p>
<blockquote>
<p>In short: JS is everywhere </p>
</blockquote>
<p>So it matters that we push it forward. Languages which don't evolve start to die.
Improving the language means we can improve our code. Our apps can
have fewer bugs. And some of these features enable the runtimes
to actually run code faster. So let's dive in, starting with
variables.</p>
<h2 id="the-problem-with-variables"><a href="#the-problem-with-variables"><span class="icon">#</span> The Problem with Variables</a></h2>
<p>In Javascript when you want to create a variable you use
the <code>var</code> keyword. <code>var</code> is great, but it has a couple of problems.
First, variables always <em>vary</em>. There is no way to make a true
constant in Javascript. You can sorta fake it by creating an object
with an immutable property. You can override the setter of the
property so that it can't be set by outside code, but it's a lot
of extra typing and requires an entire object instead of
a simple variable.</p>
<pre><code>var VARS = {
    foo
        set = function() { }
        get = function() { return 42 }
}
VARS.foo = 42; // now I have a constant</code></pre>
<p>Regular Javascript variables also have a scoping problem. Take a look
at this code.</p>
<pre><code>function badCode() {
    if(foo) {
        var x = 5;
    }
    if(bar) {
        console.log(x);
    }
}</code></pre>
<p>Variables declared with <code>var</code> are global to the function they are
defined in, <em>not the block</em>. You'd think that the log
statement above wouldn't work because
<code>bar</code> is defined in a different block.
and in a language like java or C# you'd be right, but in
Javascript <code>var</code> is global to a function, not a block.</p>
<p>It gets worse when we add in <em>variable hoisting</em>. Consider
this code</p>
<pre><code>function badCode() {
    console.log("foo is",foo);
    var foo = 'bar';
}</code></pre>
<p>I'm using <code>foo</code> before I've defined it. What does this code <em>even mean</em>?
Under the hood the javascript engine will hoist the variable
declaration to the top of the function block. I can sort of see
why you might want to hoist functions, but variable hoisting
makes it very easy to introduce subtle bugs that are a pain
to diagnose.</p>
<p>Look at this <code>for</code> loop:</p>
<pre><code>for(var i=0; i&lt;5; i++) {
    console.log(i);
}
console.log(i);</code></pre>
<p>The variable is only used inside the loop, but I can still
reference it outside. This is just tons of bugs waiting to happen.</p>
<p>The good news is we don't have to use var anymore. Instead we can use const and let.</p>
<h2 id="introducing-const-and-let"><a href="#introducing-const-and-let"><span class="icon">#</span> Introducing const and let</a></h2>
<p>The new keyword <code>const</code> does exactly what the name suggests.
It makes a <em>real</em> constant. If you try to set the constant you'll
get a runtime error. Even better, code linting systems can detect
this kind of bug at compile time now, so you can find bugs earlier
at development time rather than in production.</p>
<p>The other new kind of variable is created with the <code>let</code> keyword.
<code>let</code> is just like <code>var</code> but it is scoped by block
instead of function. Now it does what we expect.</p>
<pre><code>function goodCode() {
    if(foo) {
        let x = 5;
    }
    if(bar) {
        console.log(x); //error
    }
}</code></pre>
<p>Let's revisit the <code>for</code> loop example:</p>
<pre><code>function goodCode() {
    for(let i=0; i&lt;5; i++) {
        console.log(i);
    }
    console.log(i); //error
}
</code></pre>
<p>Now the <code>i</code> variable is restricted to the body of the <code>for</code> loop.
There is no way it can be used outside accidentally.
Also, <code>let</code> isn't hoisted, so all of those magic moving variables
go away.</p>
<p>The new keywords <code>const</code> and <code>let</code> are a complete replacement for
<code>var</code>. With modern browsers and the newest versions of Node,
there is no reason to use <code>var</code> anymore. Good riddance.</p>
<h2 id="super-strings"><a href="#super-strings"><span class="icon">#</span> Super Strings</a></h2>
<p>ES6 introduces a new type of string called <em>Template Literals</em>. I
prefer to call them <em>Super Strings</em>.
You use a super string just like a regular string, but instead of
using single or double quotes, you use the back quote.</p>
<pre><code>var q  = 'foo';
var qq = "foo";

var bq = `foo`;

var qq = "Sally sells \"sea shells\"";
var bq = `Sally sells "sea shells"`;</code></pre>
<p>So far so good, but nothing is very different.  It does have one
immediate advantage. If you need to use double or single quotes
inside of a string you don't have to escape them anymore. However,
super strings have a few other tricks up their sleeves.</p>
<h3>Multiline Strings</h3>
<p>Finally we can have real multi-line strings. Need to quote several
lines of something? You don't have to escape newlines or do join
tricks anymore. Just put in the newlines directly and it works.</p>
<pre><code>var qq = "this is a very long"
  + " piece of text that goes over several lines"
  + " and would require silly hacks";

var bq = `this is a very long
    piece of text that goes over several lines
    and would require silly hacks`;</code></pre>
<h3>Expression escaping</h3>
<p>Another new feature is <em>expression escaping</em>.
Within a super string you can put <code>${}</code> with any valid
Javascript expression inside the brackets. This is much cleaner than
double escaping your quotes, and recent IDEs will
syntax highlight these expressions nicely.</p>
<pre><code>var name = "Alice";
var greeting = `Good morning ${name}`;
var amount = 5;
var price = 3;
var sales = `That costs ${amount*price} dollars`;&lt;/pre&gt;</code></pre>
<p>Combining expression escaping with multiline support gives
us great HTML templates. </p>
<pre><code>var template = `
  &lt;div&gt;
    &lt;h3&gt;Good Morning ${name}&lt;/h3&gt;
    &lt;p&gt;
      That item will cost you
      &lt;b&gt;${amount*price}&lt;/b&gt;
      dollars.
    &lt;/p&gt;
  &lt;/div&gt;`</code></pre>
<h2 id="arrow-functions"><a href="#arrow-functions"><span class="icon">#</span> Arrow Functions</a></h2>
<p>So that was strings and variables, but now let's take a look
at functions. If you've heard anything about ES6 before, it was
probably about <em>arrow functions</em>. These are a different syntax
to write regular functions but with a more compact
syntax. They also have one very important difference:
the <code>this</code> variable means something different. Let's look at some
code.</p>
<p>Suppose you want to loop over an array to double the values
within it, producing a new array. You could do it with the
following <code>for</code> loop,  but that creates extra variables
and it can be easy to accidentially break early or get the
index wrong. plus it's a lot of extra typing.</p>
<pre><code>var output = [];
for(var i=0; i&lt;;input.length; i++) {
    output[i] = input[i] * 2;
}</code></pre>
<p>Javascript arrays have a method called <code>map</code> which calls a
function on every element to generate a new element,
which are then placed into a new array. It works like this:</p>
<pre><code>var output = input.map(function(x) {
    return x * 2;
});</code></pre>
<p>This looks better but it would be nice to make it smaller.
The <code>x*2</code> part is the only thing which actually does any work.
The rest is syntactic overhead. With an arrow function
we can do it like this:</p>
<pre><code>var output = input.map((x)=&gt;x*2);</code></pre>
<p>Woah! That's a lot smaller. Let me explain what happened. An
arrow function lets you rewrite a function without the actual
<code>function</code> word. Instead you put the <code>=&gt;</code> after the parenthesis
containing the function parameters. </p>
<pre><code>//regular
function (x) {
    return x * 2;
}
//arrow style
(x) =&gt; {
    return x * 2;
}</code></pre>
<p>Arrow functions let us write the same thing smaller. But we can
make it event shorter. Let's remove the whitespace. Same code just shorter.</p>
<pre><code>(x) =&gt; { return x * 2; }</code></pre>
<p>But we can make it <em>even</em> shorter still. If the arrow function
contains only a single expression, we can remove the return and
the braces and semicolon, resulting in a tiny one line expression
which automatically returns it's value. This is so much cleaner.</p>
<pre><code>(x) =&gt; x * 2
var output = input.map((x)=&gt;x*2);</code></pre>
<p>Arrow functions can make your code very compact and powerful. But there's
one more trick up it's sleeve. It fixes <code>this</code>.</p>
<h3>The Curse of This</h3>
<p>In Javascript the magic variable <code>this</code> always refers to the object
that the function is called on. So code like the following doesn't
do what you think it does. </p>
<pre><code>function App() {
    this.clicked = false;
    var button = document.getElementById('button');
    button.addEventListener('click', function(evt) {
        this.clicked = true; //won't do what you think
    });
}</code></pre>
<p>When you are using other objects the <code>this</code> context may be
different than what you expect. When you pass a function to
somewhere else to be called back, it may call the function
with a different 'this'. If you add an event
handler to a button the button will be the 'this'. Sometimes
that's what you want, but in the code above it isn't. We want
<code>this</code> to be the surrounding App object, not the button.</p>
<p>This is a long standing problem with Javascript. It's so common
that developers have created something known as the <em>self</em> pattern
where you save the correct <code>this</code> reference using a temporary
variable <code>self</code>. It's yucky but it works.</p>
<pre><code>function App() {
    this.clicked = false;
    var button = document.getElementById('button');
    &lt;b&gt;var self = this;&lt;/b&gt;
    button.addEventListener('click', function(evt) {
        self.clicked = true;
    });
}</code></pre>
<p>Another way to solve the problem is to <em>bind</em> the function.
The <code>bind</code> method forces the <code>this</code> to be a specific object,
regardless of how the function is latter called.</p>
<pre><code>function App() {
    this.clicked = false;
    var button = document.getElementById('button');
    var callback = (function(evt) {
        this.clicked = true
    })&lt;b&gt;.bind(this);&lt;/b&gt;
    button.addEventListener('click',callback);
}</code></pre>
<p>Again, this will <em>work</em> but it's not great. We now
have extra code to write, and underneath doing a bind can create
extra overhead. Arrow functions give us a better way to do it.</p>
<pre><code>function App() {
    this.clicked = false;
    var button = document.getElementById('button');
    button.addEventListener('click',()=&gt;{
        this.clicked = true;
    });
}</code></pre>
<p>Arrow functions automatically capture the <code>this</code> var from the surrounding
context of where the function <em>is defined</em>,
not from where the function <em>is used</em>.
This means you can pass the function to some other place and absolutely
know that right version of <code>this</code> will be used.
In the code above everything works perfectly without any yucky hacks.</p>
<p>In short, arrow functions are really awesome. I try to use them
everywhere I can. They make your code shorter, easier to
read, and <code>this</code> becomes sensible again.</p>
<h2 id="promises"><a href="#promises"><span class="icon">#</span> Promises</a></h2>
<p>Another great feature of arrow functions is that they work well
with Promises. A Promise is a new kind of object in Javascript
designed to help with things that take a long time to execute.
Javascript doesn't have threads so if you want to do something that
might take a long time then you have to use callbacks.</p>
<p>For example, in Node you might want to load a file, parse it,
make a database request, then write a new file. These must all be
done in order, but they are all asynchronous so you have to start
nesting your callbacks. This produces what JS hackers like to
call <em>The Pyramid of Doom</em>. You get massively nested code.</p>
<pre><code>fs.readFile("file.txt", function(err, file) {
    db.fetchNames(function(err, names) {
        processFile(file, names, function(err, outfile) {
            fs.writeFile('file.txt',outfile, function(err, status) {
                console.log("we are done writing the file");
            })
        });
    })
});</code></pre>
<p>This code is ugly, hard to reason about, and has lots of nasty corners
for bugs to hide. Promises help us defeat the pyramid of doom.</p>
<p>A Javascript <code>Promise</code> is an object that represents a value which may not be
available yet. It <em>promises</em> to have the value in the future.
You can add a callback to be invoked when the final value is ready
using the <code>then</code> function.</p>
<pre><code>var prom = makeSomePromise();
//value not ready yet
prom.then((value)=&gt;{
    //do something with the value
})</code></pre>
<p>Promises with <code>then</code> callbacks are much like traditional callbacks,
but promises add an extra twist: they can be <em>chained</em>.  Let's revisit
our code from before. Each of the functions must be called in order,
and each depends on the result of the previous one. Using promises
we can do it like this instead. </p>
<pre><code>    fs.readFile("file.txt")
        .then((file) =&gt; {
            return db.fetchNames().then((names)=&gt;{
                return processFile(file,names)
            })
        })
        .then((outfile)=&gt;{
            return fs.writeFile('file.txt',outfile);
        })
        .then(()=&gt;{
            console.log("we are done writing the file");
        });</code></pre>
<p>Notice how the arrow functions make this nice and clean.
Each <code>then()</code> callback returns a value. This value is passed
to the next one so all of our functions can be easily chained.</p>
<p>Now you'll notice that the <code>processFile</code> command needs the result
of the previous <em>two</em> values however a promise only passes one value.
We also don't care what order <code>readFile</code> and <code>fetchNames</code> happens
in. We just want to know when both are completed. Promise can do this
too.</p>
<h3>Promise.all</h3>
<p>Suppose want to load each file from an array of filenames and be
be notified when they are all done. We can do that with <code>Promise.all()</code>.
<code>all</code> is a utility method on <code>Promise</code> which takes an array of promises and returns a new promise that resolves when all of the sub-promises complete.
Here's how we would load all of the files with <code>Promise.all</code>. (assume that
<code>readFile</code> is a function which returns a promise to read the file).</p>
<pre><code>var proms = filenames.map((name)=&gt; readFile(name));
Promise.all(proms).then((files)=&gt;{
    console.log(`we have ${files.length} files`);
});</code></pre>
<p>Now we can rewrite our original Node example like this:</p>
<pre><code>Promise.all([
    fs.readFile("file.txt"),
    db.fetchNames()
])
.then((vals) =&gt; processFile(vals[0],vals[1]))
.then((outfile)=&gt; fs.writeFile('file.txt',outfile))
.then(()=&gt; console.log("we are done writing the file"));</code></pre>
<p>I've combined the read file and database calls into a
single promise using <code>Promise.all</code>. The value it will
return is an array containing the results of both sub-promises,
so I can then put them into <code>processFile</code>. Notice that I've
also used the abbreviated arrow syntax to make the code smaller
and cleaner.</p>
<h3>Handling Failure</h3>
<p>Now consider what happens if one of these Promises fails?  To
handle the first one failing we could put in a try / catch block,
but the next <code>then</code> will still be called. Really we want everything
to stop if the first one fails. Promises have another trick up
their sleeves: the catch callback.</p>
<p>In the new version below if anything fails it will immediately jump to the
catch callback at the end, skipping the rest. After the catch we
can still add more then clauses.</p>
<pre><code>Promise.all([
    fs.readFile("file.txt"),
    db.fetchNames()
])
.then((vals) =&gt; processFile(vals[0],vals[1]))
.then((outfile)=&gt; fs.writeFile('file.txt',outfile))
.then(()=&gt; console.log("we are done writing the file"))
.catch((e) =&gt; {
    console.log("some error happened");
});</code></pre>
<h3>Making your own Promises</h3>
<p>Of course promises only work if the APIs we call actually use them.
Lots of libraries are starting to switch over to
promises, but while we wait we can make our own promises too.
We do it with the <code>Promise</code> constructor.</p>
<pre><code>function makePromise(foo,bar) {
    return new Promise((resolve, reject) =&gt; {
        try {
            //do long stuff
            resolve(value);
        } catch {
            reject(error);
        }
    });
}</code></pre>
<p>It takes two values: <code>resolve</code> and <code>reject</code>. Each of these are
callback functions. Inside you do whatever you need to do that
takes a long time, even if it involves multiple callbacks.
When you are completely done invoke <code>resolve()</code> with the final
value. This will then be sent the to the first <code>then</code>
clause of whatever uses your promise.</p>
<p>If something bad happens and you want to reject the value,
instead of throwing an error use the <code>reject()</code>, passing
whatever alternate value you want.</p>
<p>Here's a real-life example. I use AJAX calls all the
time but they can be ugly, like this.</p>
<pre><code>var url = "http://api.silly.io/api/list/e3da7b3b-976d-4de1-a743-e0124ce973b8?format=json";

var xml = new XMLHttpRequest();
xml.addEventListener('load', function() {
    var result = JSON.parse(this.responseText);
    console.log(result);
});
xml.addEventListener('error',function(error) {
    console.log("something bad happened");
});
xml.open("GET",url);
xml.send();</code></pre>
<p>Let's wrap this code up in a promise.</p>
<pre><code>function doGet(url) {
    return new Promise((resolve,rej)=&gt;{
        var xml = new XMLHttpRequest();
        xml.addEventListener('load', function() {
            var result = JSON.parse(this.responseText);
            resolve(result);
        });
        xml.addEventListener('error',function(error) {
            reject(error);
        });
        xml.open("GET",url);
        xml.send();
    });
}</code></pre>
<p>This is still the same basic code, but I can call it like this instead.</p>
<pre><code>var url = "someapi.com/dostuff?foo=bar";
doGet(url).then((obj)=&gt;{
    console.log(obj);
});</code></pre>
<p>Wow, that's <em>so</em> much cleaner. In reality I don't need make my own
AJAX Promise wrapper because there is a new web standard called
Fetch which already does this for me. Fetch isn't quite supported in
all browsers yet, so we can use our own until then.</p>
<p>Promises can be a bit tricky to wrap your head around at
first, but once you start using them I think you'll really like
them. They make it very easy to pull multiple functions together
into a single workflow that makes logical sense, and to
properly catch all errors along the way.</p>
<h2 id="arrays"><a href="#arrays"><span class="icon">#</span> Arrays</a></h2>
<p>Finally I want to show you a bunch of new Array features.
Most of these aren't exactly <em>new</em> for ES6, and in fact some of
them are quite old. However, they are finally supported everywhere
and play nicelly with Arrow Functions and Promises, so I think of them
as new.</p>
<p>Suppose you want to do something to every element of an array. Instead
of using a for loop, use the <code>forEach</code> or <code>map</code> functions.</p>
<pre><code>var values = [1,2,3,4,5,6,7,8,9,10];
values.forEach((x)=&gt;console.log(x));
var doubled = values.map((x) =&gt; x*2);</code></pre>
<p>The <code>forEach</code> function runs the callback on every element of the
array. The <code>map</code> function also runs on each element, but it stores the
results of each callback into a new array.</p>
<p>If you want to transform an array by including only certain values,
use the <code>filter</code> function.</p>
<pre><code>//find all values that match the filter
var evens = values.filter((x)=&gt;x%2==0);</code></pre>
<p>Array also has functions to find single values within the array based
on some criteria.</p>
<pre><code>//find the first that matches
var six = values.find((x) =&gt;  x &gt;= 6);
//find the index of the first that match
var index = values.findIndex((x) =&gt;  x &gt;= 6);
//true if at least one item matches
var any = values.some((x) =&gt; x &gt; 10);</code></pre>
<p>Finally arrays can be reduced to a single value with the <code>reduce</code> function.
<code>reduce</code> is very powerful and can be used to do lots of things like
summing an array or flattening nested arrays</p>
<pre><code>//reduce the array to a single value
var sum = values.reduce((a,b) =&gt; a+b, 0);
//flatten nested arrays
var list1 = [[0, 1], [2, 3], [4, 5]];
var list2 = [0, [1, [2, [3, [4, [5]]]]]];
const flatten = arr =&gt; arr.reduce(
  (acc, val) =&gt; acc.concat(
    Array.isArray(val) ? flatten(val) : val
  ),
  []
);
flatten(list1); // returns [0, 1, 2, 3, 4, 5]
flatten(list2); // returns [0, 1, 2, 3, 4, 5]</code></pre>
<p>To loop over the properties in an object you can use the <code>Object.keys</code>
to get an array of property names, then loop over it with <code>forEach</code></p>
<pre><code>var obj = {
    first:'Alice',
    middle:'N',
    last:'Wonderland',
    age:8,
    height:45,
}
Object.keys(obj).forEach((key)=&gt;{
    console.log("key = ", key);
    console.log("value = ", obj[key]);
});</code></pre>
<h2 id="things-to-avoid"><a href="#things-to-avoid"><span class="icon">#</span> Things to Avoid</a></h2>
<p>The five features I've shown you can be used today, but there's
a lot of other things in ES6 that you should avoid for time being;
either because they don't provide much value or aren't well supported
yet. These include:</p>
<ul>
<li>Destructuring</li>
<li>Modules</li>
<li>Default Parameters</li>
<li>Spread Operator</li>
<li>Symbols</li>
<li>Generators and Iterators</li>
<li>Weak Maps and Weak Sets</li>
<li>Proxies</li>
</ul>
<p>Destructuring allows you to pull values out of an object by name.
It can be useful in a few situations, but the best use I've found is
extracting functions from modules. Unfortunately modules are still a
mess and don't work the same everywhere, so avoid them for now. </p>
<p>Along with destructuring you can do without tricks like default
parameters, and the spread operator. I find these to be more
trouble than they are worth, at least for now.</p>
<p>Symbols, generators, iterators, weak maps and sets, and proxies
are genuinely useful but they aren't supported everywhere yet so I
suggest you wait a while before using them.</p>
<p>There is also a new class syntax. It still uses JavaScript's
prototypical inheritance, but it makes the syntax of defining a
class cleaner and consistent. However, it is also not as valuable
without the new module support so I suggest waiting a bit longer.</p>
<pre><code>class Foo extends Bar {
    constructor(stuff) {
        super(stuff);
        this.first = "first name"
    }
    doStuff() {
    }
    doMoreStuff() {
    }
}</code></pre>
<h2 id="can-i-use-it"><a href="#can-i-use-it"><span class="icon">#</span> Can I Use It?</a></h2>
<p>Most desktop and mobile browsers support everything I've shown you.
However, depending on your audience you may have older
browsers / older mobile OSes that don't.  Whenever you want to know
if something is ready, go to <a href="http://caniuse.com">caniuse.com</a>. It
will tell you what versions of each browser support what.</p>
<p>If you need to support IE &lt; 10, there's a good chance you'll want to use a <a href="https://scotch.io/tutorials/javascript-transpilers-what-they-are-why-we-need-them">transpiler</a> like <a href="https://scotch.io/tutorials/from-javascript-to-typescript-pt-i-types-variables">TypeScript</a> or <a href="https://babeljs.io">Babel</a></p>
<p>So those are five awesome features of ES6 that you can start
using right away. More stuff is coming, but you don't need to wait to
use these. Get to codin'. And if you want go use them in
low latency data stream driven Javascript code, go check out
<a href="https://www.pubnub.com/products/blocks/?utm_source=Inbound&amp;utm_medium=scotchio&amp;utm_campaign=IN-CY17-Q1-XXX-XXX-March-14&amp;utm_term=utm-generator&amp;utm_content=utm-example/">PubNub BLOCKS</a>. </p>
<h3>Sample Code</h3>
<p>We've created <a href="https://www.pubnub.com/blocks-catalog/?utm_source=Inbound&amp;utm_medium=scotchio&amp;utm_campaign=IN-CY17-Q1-XXX-XXX-March-14&amp;utm_term=utm-generator&amp;utm_content=utm-example/">a catalog of example code</a> that uses Arrow Functions and Promises
to communicate with lots of useful realtime webservices like
on-the-fly language translation, geo-coding, and chatbot apis.</p>
                                                                    <p>This content is <strong>sponsored</strong> via <a href="https://synd.co/1tbGq6z">Syndicate Ads</a>
                                
                            </p></div>
					</div>
				</article>
				<!--================= END :: Tutorial =================-->
				
				<!--================= START :: Tutorial =================-->
				<article>
					<a id="t-45" name="t-45"></a><h1>45 : Asynchronous in the Browser</h1>
					<span class="ref-site">http://www.datchley.name/asynchronous-in-the-browser/</span>
					<div class="tutorial__content">
<section class="post-content">
    <p>Asynchronous programming can be a hard thing to wrap your head around as a programmer if you're used to direct, synchronous style programming. In the browser, the most familiar form of asynchronous programming is likely the DOM event API.  But, asynchronous development in the browser happens in a number of places:</p>

<ul>
<li>DOM Events</li>
<li>Browser API calls like <code>setTimout()</code>, <code>setInterval()</code> and <code>setImmediate()</code></li>
<li>XHR (XML HTTP Requests), or Ajax calls</li>
</ul>

<p>This post will look at the primary mechanism used to handle asynchronous programming in the browser - callbacks.  We'll look at standard callbacks and continuation passing style (CPS); and various patterns used to implement those and keep them efficient. Don't worry, though, in the next part we'll cover a better asynchronous design pattern: Promises.</p>

<h2 id="asyncvssynchronous">Async vs Synchronous</h2>

<p>In direct style, synchronous programming, one task follows another task, and so forth, until all the tasks are complete. Each task completes its work and returns execution before the next task can begin.  This is easy to reason about as a developer - things happen in a sequence.</p>

<pre><code>first();  
second();  
last();  
</code></pre>

<p>Even when the sequence is chained, via the first step calling the second step, which calls the last step.  It's still fairly easy to follow the chain of execution in the sequence.</p>

<p>For example:  </p>

<pre><code>function getList() { return [1,2,3,4,5,6]; }  
function getEvens() {  
  return addFour().filter(function(item) { return item % 2 == 0; });
}
function addFour() {  
  return getList().map(function(item) { return item + 4; });
}
function sum() {  
  return getEvens().reduce(function(sum, n){ return (sum += n); }, 0);
}
console.log("sum =", sum());  
</code></pre>

<p>In the above example the synchronous flow of events looks like this:</p>

<p><a href="http://www.datchley.name/content/images/2015/06/synchronous-chain-sequence-diagram.png" class="lightbox" data-featherlight="image"><img src="http://www.datchley.name/content/images/2015/06/synchronous-chain-sequence-diagram.png" alt="" draggable="true" data-bukket-ext-bukket-draggable="true"></a></p>

<p>Each function in the chain simply calls the next function in the chain, returning a result.</p>

<p>However, if our <code>getList()</code> function had to fetch the list from a remote resource (<em>asynchronously</em>), how would we handle processing the results?  This is where callbacks come into play.</p>

<h3 id="callbacks">Callbacks</h3>

<p>Many of you are likely already familiar with the concept of callbacks as you use them every time you listen for DOM events, or use jQuery's <code>$.ajax()</code> or even the browser's timer API calls like <code>setTimeout()</code> and its relatives.</p>

<p>At its most basic, a function that performs a task asynchronously will immediately return, so as not to block the main execution thread<sup id="fnref:1"><a href="#fn:1" rel="footnote">1</a></sup>. It will typically use some browser API (setTimeout, XHR) to perform its processing in the background until it finishes. </p>

<p>But, in order to allow you to process the results of that long running task, those functions take an extra argument which is a function to call with that result once it's ready.  That function is termed a <em>callback</em>.</p>

<p>Let's reimplement our <code>getList()</code> method to operate asynchronously and take a callback to allow us to continue processing its results.</p>

<pre><code>function getList(callback) {  
  // runs asynchronously and immediately returns
  setTimeout(function(){ callback([1,2,3,4,5,6]); }, 2000);
}
function getEvens(list) {  
  return list.filter(function(item) { return item % 2 == 0; });
}
function addFour(list) {  
  return list.map(function(item) { return item + 4; });
}
function sum(list) {  
  var res = getEvens(list);
  res = addFour(res);
  console.log(res.reduce(function(sum, n){ return (sum += n); }, 0));
}

getList(sum);  
console.log("waiting...");  
// waiting... (2 seconds pass)
// 24
</code></pre>

<p>Now that <code>getList()</code> immediately returns, we have to wrap our previous synchronous calls in a function that we pass to <code>getList()</code> as the callback.  In this case, we just modified the <code>sum()</code> function to wrap our tasks to perform after receiving the results from <code>getList()</code>. We have to move all of our processing of the results into the callback function, as the callback is the only scope in which the results of the asynchronous process are available.</p>

<p>Here's the control flow for our asynchronous version of <code>getList()</code>.</p>

<p><a href="http://www.datchley.name/content/images/2015/06/async-chain-sequence-diagram.png" class="lightbox" data-featherlight="image"><img src="http://www.datchley.name/content/images/2015/06/async-chain-sequence-diagram.png" alt="" draggable="true" data-bukket-ext-bukket-draggable="true"></a></p>

<p>Since <code>getList()</code> returns immediately, we see the output from the <code>console.log()</code> statement before our callback completes its processing.</p>

<p>If we have a series of asynchronous tasks that allow you to handle processing via a callback, we have to build up a nested callback structure.</p>

<pre><code>function asyncTask(fn) {  
  return setTimeout(function(){ fn(); }, 2000); 
}

function foo(n, fn) {  
  asyncTask(function(val){ fn(n); });
}
function bar(n, fn) {  
  asyncTask(function(val){ fn(n); });
}
function baz(n, fn) {  
  asyncTask(function(val){ fn(n); });
}

var n = 1;  
foo(n, function(res) {  
  bar(res+1, function(res) {
    baz(res+1, function(res) {
      console.log("result =", res);
    });
  });
});
// 6 seconds pass...
// result = 3
</code></pre>

<p>Even with the simplified code above, you can see why this situation is referred to as <em>callback hell</em>.  Working with numerous asynchronous tasks that are interdependent can be a nightmare to manage with callbacks in this fashion.  Here's the sequence diagram for that flow.</p>

<p><a href="http://www.datchley.name/content/images/2015/06/async-nested-sequence-diagram.png" class="lightbox" data-featherlight="image"><img src="http://www.datchley.name/content/images/2015/06/async-nested-sequence-diagram.png" alt="" draggable="true" data-bukket-ext-bukket-draggable="true"></a></p>

<h3 id="continuationpassingstylecps">Continuation Passing Style (CPS)</h3>

<p>Continuation Passing Style is common in the node API, among other places. The idea behind continuation passing style is:</p>

<ul>
<li>no function is allowed to return to it's caller.</li>
<li>Each function takes a callback or continuation function as its last argument</li>
<li>that continuation function is the last thing to be called</li>
</ul>

<pre><code>function foo() {  
  bar(function (res) {
    console.log("result = " + res);
  });
}
function bar(fn) {  
  baz(fn);
}
function baz(fn) {  
  fn(3);
}
foo();  
</code></pre>

<p>The above code sample shows a set of functions written using CPS. Each function's last (<em>and only in this example</em>) argument is a callback. Once you start writing functions using CPS, everything else must follow suit and become CPS as well.</p>

<p>Here's the control flow sequence for the above example:</p>

<p><a href="http://www.datchley.name/content/images/2015/06/cps-sync-sequence-diagram.png" class="lightbox" data-featherlight="image"><img src="http://www.datchley.name/content/images/2015/06/cps-sync-sequence-diagram.png" alt="" draggable="true" data-bukket-ext-bukket-draggable="true"></a></p>

<p>CPS works well for systems that are asynchronous by default, like node, where the event loop constantly runs and the API functions as callbacks.  Converting direct style programming to CPS, however, requires some work and some different thinking about how your processing takes place.</p>

<p>Let's take the following expression and convert it to use <em>Continuation Passing Style</em>.</p>

<pre><code>var a=1, b=2, c=3, d=4, e=5;  
(a + ((Math.pow(b, 2)) * c) / d) - e;   // -4
</code></pre>

<p>A simple, direct mathematical expression; and not something you would want or need to convert to CPS; but for this example, it gives us a good view into how functions can be modified to work in this style.  We'll convert each arithmetic operation into it's own function that operates according to CPS rules.</p>

<pre><code>function mul(x, y, cont) { cont(x*y); }  
function add(x, y, cont) { cont(x+y); }  
function sub(x, y, cont) { cont(x-y); }  
function div(x, y, cont) { cont(x/y); }  
function sqr(x, cont) { cont(x^2); }

sqr(b, function(res){  
  mul(res, c, function(res) {
    div(res, d, function(res) {
      add(a, res, function(res) {
        sub(res, e, function(res) {
          console.log(res);  // -4
        });
      });
    });
  });
});
</code></pre>

<p>In order to handle processing, we have to nest each call to retain the scope and results passed to each callback. This gives us another case of the <em>pyramid of doom</em> or callback hell. </p>

<p>However, we can attempt to flatten the nested series of callbacks to make our code easier to read; as well as easier to reason about. </p>

<h3 id="thestacktailcalls">The Stack &amp; Tail Calls</h3>

<p>In stack based languages, like Javascript, function invocations create a new "frame" on the stack which holds the context, scope identifiers, return location and other items necessary to execute the function and return control to the caller.</p>

<p>The stack itself is memory resident, and so the stack is typically a much smaller portion of the memory allocated for the browser.  This means stack space is limited. When a function returns, its stack frame is removed from the stack which frees that memory.</p>

<p>If you've ever written a recursive function, you've likely run up against the infamous <code>Range Error: Maximum call stack size exceeded</code> message.  For example, take a simple factorial function written in recursive style:</p>

<pre><code>function factorial(n) {  
  return n ? n * factorial(n-1) : 1;
}
factorial(10);     // 3628800  
factorial(1000);   // Infinity  (integer overflow!)  
factorial(32768);  // Range Error: stack size exceeded  
</code></pre>

<p>We'll ignore the issue with integer overflow on <code>factorial(1000)</code> causing a result of <code>Infinity</code> (<em>a special value in Javascript</em>)<sup id="fnref:2"><a href="#fn:2" rel="footnote">2</a></sup> as it's out of the scope of our conversation at the moment. It's the <code>Range Error</code> that interests us here.</p>

<p>Because the stack is limited in memory size, there are only so many nested functions you can call - as in the case of our recursive <code>factorial()</code> function.  This could be solved, however, if Javascript's runtime handled "tail call elimination"<sup id="fnref:3"><a href="#fn:3" rel="footnote">3</a></sup>.</p>

<p>Tail calls occur when a function returns the result of calling another function.  That function is said to be in <em>tail position</em>. Our <code>factorial</code> function isn't optimized for tail call elimination, since the it returns the result of an expression (<code>n * factorial(n-1)</code>), not a function invocation; </p>

<p>If Javascript had tail call optimization, we could rewrite our <code>factorial()</code> function to take advantage of that feature like so:</p>

<pre><code>function factorial(n) {  
  function _factorial(n, acc) {
    acc || (acc = 1);
      return n ? _factorial(n-1, n*acc) : acc;  // tail call
  }
  return _factorial(n);
}
</code></pre>

<p>Tail call optimization would transform the recursive calls into an iterative loop, which gives us a constant stack space and is much more efficient.</p>

<p>CPS falls into this same category of having tail calls, as each continuation function passed is an explicit tail call; and hence, could be optimized by the language runtime. But without optimization, CPS alone can lead to growing stack problems.</p>

<h3 id="trampolining">Trampolining</h3>

<p>We can optimize for tail calls ourselves by either writing the function in tail position as a loop:</p>

<pre><code>function factorialL(n) {  
    var acc = 1;
    while(n) {
        acc *= n--;
    }
    return acc;
}
</code></pre>

<p>or using a technique called <em>trampolining</em>.  Trampolining is common in functional programming and provides us a way to call our function in tail position without growing the stack.</p>

<p>Here's an implementation of the <code>trampoline()</code> function:  </p>

<pre><code>function trampoline(fn) {  
    var args = [].slice.call(arguments, 1);
    while (fn &amp;&amp; fn instanceof Function) {
        fn = fn.apply(this, args);
    }
    return fn;
}
</code></pre>

<p>The trampoline works by continuously executing a function as long as it continues to return a function. Once it returns a value, the loop terminates and the value is returned.</p>

<p>Here's our <code>factorial()</code> function written to optimize for recursive tail calls by using <code>trampoline()</code>. We simply wrap our call to our internal <code>_factorial()</code> function in a call to <code>trampoline()</code> and ensure that the internal function will return a reference to the next invocation of itself to be executed.  Once done, we simply return our <code>acc</code> value and the trampoline stops.</p>

<pre><code>function factorial(n) {  
  function _factorial(n, acc) {
    acc || (acc = 1);
      return n ? _factorial.bind(this, n-1, n*acc) : acc;
  }
  return trampoline(_factorial, n);
}

factorial(32768);  
// Infinity - no range error now!
</code></pre>

<p>So how does this help us in Continuation Passing Style? Remember, each <em>continuation</em> is a function, that represents the <em>next step in processing</em>. This continuation is executed in tail position by the current phase of processing once it has finished - the callback is now a continuation to more processing.  There is no need to retain the stack frame or context of the current function once it executes the continuation, as everything needed is passed to the continuation callback.</p>

<p>Instead of nesting our continuations and growing the stack, we can use our <code>trampoline()</code> to flatten out the processing steps; and retain a constant stack space.</p>

<pre><code>// CPS functions representing our processing steps
var steps = [  
    function first(cont) {
        cont(1);
    },
    function second(val, cont) {
        cont(val+2);
    },
    function third(val, cont) {
        cont(val+3);
    }
];

// A function to flatten our CPS steps into a series
// passing any values as we go. Takes a callback which
// will receive the result passed to the final continuation
function waterfall(steps, done) {  
    steps.push(done);
    trampoline(function() {
        return steps.length ? 
            function _cb(){
                var args = [].slice.call(arguments),
                    fn = steps.shift(); 
                fn.apply(this, args.concat(_cb));
            } :
            undefined;  // steps complete 
    });
}

waterfall(steps, function(res) {  
    console.log("final = ", res);   // final = 6
});
</code></pre>

<p>This is very similar to the <code>async.waterfall</code> method in the node <a href="https://github.com/caolan/async">async module</a>.  We can define our processing steps individually and allow our <code>waterfall()</code> function to run them, in order, using an anonymous callback as the continuation. </p>

<p>Our <code>waterfall()</code> also takes a final callback continuation, in CPS fashion, that will be passed the result given to the last continuation in the last step. It functions like a pipeline, where we are able to pass each step's result to the next step.</p>

<p>Here's a non-trampolined version of the <code>waterfall()</code> function that uses recursion.</p>

<pre><code>function waterfall(list, final) {  
  var args = [].slice.call(arguments, 2);

  if (list.length) {
    var fn = list.shift(),
        cb = function() {
          var results = [].slice.call(arguments);
          waterfall.apply(this, [list, final].concat(results));
        };
    fn.apply(this, args.concat(cb));
  }
  else {
    final.apply(this, args);
  }
}
</code></pre>

<h2 id="asyncerrorhandlingpatterns">Async Error Handling Patterns</h2>

<p>Error handling in asynchronous programming can be problematic. Because the asynchronous functions aren't running in the main thread, you can't really wrap them in a <code>try..catch</code>.</p>

<pre><code>try {  
    function async(cb) {
        setTimeout(function() {
            throw new Error("woops!");
            cb("done");
        }, 2000);
    }


    async(function(res) {
        console.log("received:", res);
    });
}
catch(e) {  
    console.log(e);
}
// Uncaught Error: woops!
</code></pre>

<p>This doesn't work because the error is thrown in a separate thread of execution, so even wrapping our entire program in a <code>try..catch</code> won't help.  The only way to handle it would be inside the actual asynchronous call and then processing that error a different way.</p>

<p>To get around that, many async library APIs have been built to take two callbacks, one for successful completion and one that gets called on error. We can rework our async function above to allow for this as well.</p>

<pre><code>function async2(cb, err) {  
    setTimeout(function() {
        try {
            if (true)
                throw new Error("woops!");
            else
                cb("done");
        }
        catch(e) {
            err(e);
        }
    }, 2000);
}

async2(function(res) {  
    console.log("received:", res);
}, function(err) {
    console.log("Error: async threw an exception:", err);
});
// Error: async threw an exception: Error: woops!
</code></pre>

<p>Now, we have a way to gracefully handle exceptions and errors encountered in our asynchronous process and can provide a fallback path of execution.</p>

<p>In Continuation Passing Style, a common pattern is the error first design of callbacks which is common in the node API.  In this pattern, you use a single callback and the first argument is reserved for any error response, which would mean the async process didn't complete successfully. </p>

<pre><code>function asyncCPS(continuation) {  
    setTimeout(function() {
        try {
            var res = 42;
            if (true)
                throw new Error("woops!");
            else
                continuation(null, res); // pass 'null' for error
        }
        catch(e) {
            continuation(e, null);
        }
    }, 2000);
}

asyncCPS(function(err, res) {  
    if (err)
        console.log("Error: (cps) failed:", err);
    else
        console.log("(cps) received:", res);
});
// Error: (cps) failed: woops!
</code></pre>

<p>Now, our callbacks simply check if <code>err</code> is defined first, and if so, handle the issue in some graceful way; otherwise, our usual continuation processing occurs.  </p>

<p>We can generalize this type of error handling by writing a function which works as a decorator on a async function that returns a new function that is wrapped in a <code>try..catch</code> for us.</p>

<pre><code>// Function decorator that will give us a new
// function that wraps the invocation of a given function
// in a try catch.
function Try(fn, cont) {  
    return function _tryWrapper(){
        var args = [].slice.call(arguments);
        try {
            fn.apply(this, args);
        }
        catch(e) {
            cont(e);
        }
    };
}

function asyncCPSWrap(continuation) {  
    setTimeout(Try(function _cpsAsync() {
        var res = 42;
        if (true)
            throw new Error("woops!");
        else
            continuation(null, res);

    }, continuation), 2000);
};

asyncCPSWrap(function _callback(err, res) {  
    if (err)
        console.log("(cps) error:", err);
    else
        console.log("(cps) received:", res);
});
// (cps) error: Error: woops!
</code></pre>

<p>Our version of <code>Try()</code> above is written to work with CPS as it takes the async function to wrap and takes the continuation callback as a second parameter.  On any exception, it knows to pass the error as the first argument to the continuation.  </p>

<p>You could also easily re-write this for regular callbacks to accept a <em>success</em> and <em>error</em> callback handler as well and wire them up appropriately in the function returned from <code>Try()</code>.  As we'll see in the next article, <em>Promises</em> make error handling much cleaner and easier to implement than what's available using straight callbacks and CPS.</p>

<h2 id="conclusion">Conclusion</h2>

<p>With node/iojs, XHR/Ajax, DOM Events and so many other asynchronous processes that happen in modern day web applications, understanding how callbacks and patterns like <em>continuation passing</em> work is a must. This post just skimmed the surface of these patterns; but there is more in the world of asynchronous web development you can look into, such as <a href="https://rxjs.codeplex.com/">observable streams</a> and <a href="http://davidwalsh.name/es6-generators">ES6 generators</a>.</p>

<p>In the next piece we'll cover another widely used standard for asynchronous programming on the web, Promises.</p>

<hr>

<div class="footnotes"><ol><li class="footnote" id="fn:1"><p>For the curious (<em>and I hope you are</em>) this might lead you to ponder the workings of Javascript's single execution thread and the event loop in the browser, for which there is a <a href="https://www.youtube.com/watch?v=8aGhZQkoFbQ">great talk</a> by Philip Roberts you should immediately go watch. <a href="#fnref:1" title="return to article">↩</a></p></li>
<li class="footnote" id="fn:2"><p>Numbers in Javascript are an interesting topic, and you can find out more about <em>Infinity</em>, IEEE 754 Standard in a <a href="http://www.2ality.com/2012/04/number-encoding.html">great post</a> by Axel Rauschmayer. <a href="#fnref:2" title="return to article">↩</a></p></li>
<li class="footnote" id="fn:3"><p>Keep hope alive, and continue to optimize for tail calls since <a href="http://wiki.ecmascript.org/doku.php?id=harmony:proper_tail_calls">ES6 will support proper tail call optimizations</a>. Yay! <a href="#fnref:3" title="return to article">↩</a></p></li></ol></div>
        <ul class="tags">
            <li class="tag" id="tag-id-5"><a href="/tag/javascript/">javascript</a></li> 
            <li class="tag" id="tag-id-8"><a href="/tag/asynchronous/">asynchronous</a></li> 
            <li class="tag" id="tag-id-9"><a href="/tag/cps/">cps</a></li> 
            <li class="tag" id="tag-id-10"><a href="/tag/callbacks/">callbacks</a></li> 
            <li class="tag" id="tag-id-11"><a href="/tag/tail-call-optimization/">tail call optimization</a></li> 
        </ul>
  </section>
					</div>
				</article>
				<!--================= END :: Tutorial =================-->
				
				<!--================= START :: Tutorial =================-->
				<article>
					<a id="t-46" name="t-46"></a><h1>46: The Basics of DOM Manipulation in Vanilla JavaScript (No jQuery)</h1>
					<span class="ref-site">https://www.sitepoint.com/dom-manipulation-vanilla-javascript-no-jquery/</span>
					<div class="tutorial__content">
<p class='wp-special'>Whenever we need to perform DOM manipulation, we&#8217;re all quick to reach for jQuery. However, the vanilla JavaScript DOM API is actually quite capable in its own right, and since IE &lt; 11 has been <a href="https://www.microsoft.com/en-us/WindowsForBusiness/End-of-IE-support">officially abandoned</a>, it can now be used without any worries.</p>
<p>In this article, I&#8217;ll demonstrate how to accomplish some of the most common DOM manipulation tasks with plain JavaScript, namely:</p>

<ul>
<li>querying and modifying the DOM,</li>
<li>modifying classes and attributes,</li>
<li>listening to events, and</li>
<li>animation.</li>
</ul>
<p>I&#8217;ll finish off by showing you how to create your own super slim DOM-library that you can drop into any project. Along the way, you&#8217;ll learn that DOM manipulation with VanillaJS is not rocket science and that many jQuery methods in fact have direct equivalents in the native API.</p>
<p>So let&#8217;s get to it &#8230;</p>
<h2 id="dommanipulationqueryingthedom">DOM Manipulation: Querying the DOM</h2>
<p><em>Please note: I won&#8217;t explain the Vanilla DOM API in full detail, but only scratch the surface. In the usage examples, you may encounter methods I haven&#8217;t introduced explicitly. In this case just refer to the excellent <a href="https://developer.mozilla.org/en-US/">Mozilla Developer Network</a> for details.</em></p>
<p>The DOM can be queried using the <code>.querySelector()</code> method, which takes an arbitrary CSS selector as an argument:</p>
<pre><code class="javascript language-javascript">const myElement = document.querySelector('#foo &gt; div.bar')
</code></pre>
<p>This will return the first match (depth first). Conversely, we can check if an element matches a selector:</p>
<pre><code class="javascript language-javascript">myElement.matches('div.bar') === true
</code></pre>
<p>If we want to get all occurrences, we can use:</p>
<pre><code class="javascript language-javascript">const myElements = document.querySelectorAll('.bar')
</code></pre>
<p>If we already have a reference to a parent element, we can just query that element&#8217;s children instead of the whole <code>document</code>. Having narrowed down the context like this, we can simplify selectors and increase performance.</p>
<pre><code class="javascript language-javascript">const myChildElemet = myElement.querySelector('input[type="submit"]')

// Instead of
// document.querySelector('#foo &gt; div.bar input[type="submit"]')
</code></pre>
<p>Then why use those other, less convenient methods like <code>.getElementsByTagName()</code> at all? Well, one important difference is that the result of <code>.querySelector()</code> is <em>not live</em>, so when we dynamically add an element (see <a href="#modifyingthedom">section 3</a> for details) that matches a selector, the collection won&#8217;t update.</p>
<pre><code class="javascript language-javascript">const elements1 = document.querySelectorAll('div')
const elements2 = document.getElementsByTagName('div')
const newElement = document.createElement('div')

document.body.appendChild(newElement)
elements1.length === elements2.length // false
</code></pre>
<p>Another consideration is that such a live collection doesn&#8217;t need to have all of the information up front, whereas <code>.querySelectorAll()</code> immediately gathers everything in a static list, making it <a href="https://www.nczonline.net/blog/2010/09/28/why-is-getelementsbytagname-faster-that-queryselectorall/">less performant</a>.</p>
<h3 id="workingwithnodelists">Working with Nodelists</h3>
<p>Now there are two common gotchas regarding <code>.querySelectorAll()</code>. The first one is that we can&#8217;t call Node methods on the result and propagate them to its elements (like you might be used from jQuery objects). Rather we have to explicitly iterate over those elements. And this is the other gotcha: the return value is a NodeList, not an Array. This means we can&#8217;t call any array methods (e.g. <code>.forEach</code>) on it. We have to convert it to an array first.</p>
<pre><code class="javascript language-javascript">// Using Array.from()
Array.from(myElements).forEach(doSomethingWithEachElement)

// Or prior to ES6
Array.prototype.forEach.call(myElements, doSomethingWithEachElement)

// Shorthand:
[].forEach.call(myElements, doSomethingWithEachElement)
</code></pre>
<p>Each element also has a couple of rather self-explanatory read-only properties referencing the &#8220;family&#8221;, all of which are live:</p>
<pre><code class="javascript language-javascript">myElement.children
myElement.firstElementChild
myElement.lastElementChild
myElement.previousElementSibling
myElement.nextElementSibling
</code></pre>
<p>As the <a href="https://developer.mozilla.org/en-US/docs/Web/API/element">Element</a> interface inherits from the <a href="https://developer.mozilla.org/en-US/docs/Web/API/Node">Node</a> interface, the following properties are also available:</p>
<pre><code class="javascript language-javascript">myElement.childNodes
myElement.firstChild
myElement.lastChild
myElement.previousSibling
myElement.nextSibling
myElement.parentNode
myElement.parentElement
</code></pre>
<p>Where the former only reference elements, the latter (except for <code>.parentElement</code>) can be any kind of node, e.g. text nodes. We can then check the <a href="https://developer.mozilla.org/en-US/docs/Web/API/Node/nodeType">type</a> of a given node like e.g.</p>
<pre><code class="javascript language-javascript">myElement.firstChild.nodeType === 3 // this would be a text node
</code></pre>
<p>As with any object, we can check a node&#8217;s prototype chain using the <code>instanceof</code> operator:</p>
<pre><code class="javascript language-javascript">myElement.firstChild.nodeType instanceof Text
</code></pre>
<h2 id="modifyingclassesandattributes">Modifying Classes and Attributes</h2>
<p>Modifying classes of elements is as easy as:</p>
<pre><code class="javascript language-javascript">myElement.classList.add('foo')
myElement.classList.remove('bar')
myElement.classList.toggle('baz')
</code></pre>
<p>You can read a more in-depth disussion of how to modify classes in this <a href="https://www.sitepoint.com/add-remove-css-class-vanilla-js/">quick tip by Yaphi Berhanu</a>. Element properties can be accessed like any other object&#8217;s properties</p>
<pre><code class="javascript language-javascript">// Get an attribute value
const value = myElement.value

// Set an attribute as an element property
myElement.value = 'foo'

// Set multiple properties using Object.assign()
Object.assign(myElement, {
  value: 'foo',
  id: 'bar'
})

// Remove an attribute
myElement.value = null
</code></pre>
<p>Note that there are also the methods <code>.getAttibute()</code>, <code>.setAttribute()</code> and .<code>removeAttribute()</code>. These directly modify the <em>HTML attributes</em> (as opposed to the DOM properties) of an element, thus causing a browser redraw (you can observe the changes by inspecting the element with your browser&#8217;s dev tools). Not only is such a browser redraw more expensive than just setting DOM properties, but  these methods also can have <a href="https://developer.mozilla.org/en-US/docs/Web/API/Element/setAttribute#Notes">unexpected results</a>.</p>
<p>As a rule of thumb, only use them for attributes that don&#8217;t have a corresponding DOM property (such as <code>colspan</code>), or if you really want to &#8220;persist&#8221; those changes to the HTML (e.g. to keep them when cloning an element or modifying its parent&#8217;s <code>.innerHTML</code> — see <a href="#modifyingthedom">section 3</a>).</p>
<h3 id="addingcssstyles">Adding CSS styles</h3>
<p>CSS rules can be applied like any other property; note though that the properties are camel-cased in JavaScript:</p>
<pre><code class="javascript language-javascript">myElement.style.marginLeft = '2em'
</code></pre>
<p>If we want certain values, we can obtain these via the <code>.style</code> property. However, this will only give us styles that have been explicitly applied. To get the computed values, we can use, <code>.window.getComputedStyle()</code>. It takes the element and returns a <a href="https://developer.mozilla.org/en-US/docs/Web/API/CSSStyleDeclaration">CSSStyleDeclaration</a> containing all styles from the element itself as well as those inherited from its parents:</p>
<pre><code class="javascript language-javascript">window.getComputedStyle(myElement).getPropertyValue('margin-left')
</code></pre>
<h2 id="modifyingthedom">Modifying the DOM</h2>
<p>We can move elements around like so:</p>
<pre><code class="javascript language-javascript">// Append element1 as the last child of element2
element1.appendChild(element2)

// Insert element2 as child of element 1, right before element3
element1.insertBefore(element2, element3)

// Insert element2 as child of element 1, right after element3
element1.insertAfter(element2, element3)
</code></pre>
<p>If we don&#8217;t want to move the element, but insert a copy, we can clone it like so:</p>
<pre><code class="javascript language-javascript">// Create a clone
const myElementClone = myElement.cloneNode()
myParentElement.appendChild(myElementClone)
</code></pre>
<p>The <code>.cloneNode()</code> method optionally takes a boolean as argument; if set to true, a <em>deep</em> copy will be created, meaning its children are also cloned.</p>
<p>Of course, we can just as well create entirely new elements or text nodes:</p>
<pre><code class="javascript language-javascript">const myNewElement = document.createElement('div')
const myNewTextNode = document.createTextNode('some text')
</code></pre>
<p>which we can then insert as shown above.  If we want to remove an element, we can&#8217;t do so directly, but we <em>can</em> remove children from a parent element, like so:</p>
<pre><code class="javascript language-javascript">myParentElement.removeChild(myElement)
</code></pre>
<p>This gives us a nice little work around, meaning can actually remove an element indirectly, by referencing its parent element:</p>
<pre><code class="javascript language-javascript">myElement.parentNode.removeChild(myElement)
</code></pre>
<h3 id="elementproperties">Element properties</h3>
<p>Every element also has the properties <code>.innerHTML</code> and <code>.textContent</code> (as well as <code>.innerText</code>, which is similar to <code>.textContent</code>, but has some <a href="http://perfectionkills.com/the-poor-misunderstood-innerText/">important differences</a>). These  hold the HTML and plain text content respectively. They are writable properties, meaning we can modify elements and their contents directly:</p>
<pre><code class="javascript language-javascript">// Replace the inner HTML
myElement.innerHTML = `
  &lt;div&gt;
    &lt;h2&gt;New content&lt;/h2&gt;
    &lt;p&gt;beep boop beep boop&lt;/p&gt;
  &lt;/div&gt;
`

// Remove all child nodes
myElement.innerHTML = null

// Append to the inner HTML
myElement.innerHTML += `
  &lt;a href="foo.html"&gt;continue reading...&lt;/a&gt;
  &lt;hr/&gt;
`
</code></pre>
<p>Appending markup to the HTML as shown above is usually a bad idea though, as we&#8217;d lose any previously made property changes on the affected elements (unless we persisted those changes as HTML attributes as shown in <a href="#modifyingclassesandattributes">section 2</a>) and bound event listeners.  Setting the <code>.innerHTML</code> is good for completely throwing away markup and replacing it with something else, e.g. server-rendered markup. So appending elements would better be done like so:</p>
<pre><code class="javascript language-javascript">const link = document.createElement('a')
const text = document.createTextNode('continue reading...')
const hr = document.createElement('hr')

link.href = 'foo.html'
link.appendChild(text)
myElement.appendChild(link)
myElement.appendChild(hr)
</code></pre>
<p>With this approach however we&#8217;d cause two browser redraws — one for each appended element — whereas changing the <code>.innerHTML</code> only causes one. As a way around this performance issue we can first assemble all nodes in a <a href="https://developer.mozilla.org/en-US/docs/Web/API/DocumentFragment">DocumentFragment</a>, and then just append that single fragment:</p>
<pre><code class="javascript language-javascript">const fragment = document.createDocumentFragment()

fragment.appendChild(text)
fragment.appendChild(hr)
myElement.appendChild(fragment)
</code></pre>
<h2 id="listeningtoevents">Listening to events</h2>
<p>This is possibly the best known way to bind an event listener:</p>
<pre><code class="javascript language-javascript">myElement.onclick = function onclick (event) {
  console.log(event.type + ' got fired')
}
</code></pre>
<p>But this should generally be avoided. Here, <code>.onclick</code> is a property of the element, meaning that you can change it, but you cannot use it to add  additional listeners — by reassigning a new function you&#8217;ll overwrite the reference to the old one.</p>
<p>Instead, we can use the much mightier <code>.addEventListener()</code> method to add as many events of as many types as we like. It takes three arguments: the event type (such as <code>click</code>), a function that gets called whenever the event occurs on the element (this function gets passed an event object), and an optional config object which will be explained further below.</p>
<pre><code class="javascript language-javascript">myElement.addEventListener('click', function (event) {
  console.log(event.type + ' got fired')
})

myElement.addEventListener('click', function (event) {
  console.log(event.type + ' got fired again')
})
</code></pre>
<p>Within the listener function, <code>event.target</code> refers to the element on which the event was triggered (as does <code>this</code>, unless of course we&#8217;re using an <a href="https://www.sitepoint.com/es6-arrow-functions-new-fat-concise-syntax-javascript/">arrow function</a>). Thus you can easily access its properties like so:</p>
<pre><code class="javascript language-javascript">// The `forms` property of the document is an array holding
// references to all forms
const myForm = document.forms[0]
const myInputElements = myForm.querySelectorAll('input')

Array.from(myInputElements).forEach(el =&gt; {
  el.addEventListener('change', function (event) {
    console.log(event.target.value)
  })
})
</code></pre>
<h3 id="preventingdefaultactions">Preventing default actions</h3>
<p>Note that <code>event</code> is always available within the listener function, but it is good practive to explitly pass it in anyway when needed (and we can name it as we like then, of course). Without elaborating on the <a href="https://developer.mozilla.org/en-US/docs/Web/API/Event">Event</a> interface itself, one particularly noteworthy method is <code>.preventDefault()</code>, which will, well, prevent the browser&#8217;s default behavior, such as following a link. Another common use-case would be to conditionally prevent the submission of a form if the client-side form-validation fails.</p>
<pre><code class="javascript language-javascript">myForm.addEventListener('submit', function (event) {
  const name = this.querySelector('#name')

  if (name.value === 'Donald Duck') {
    alert('You gotta be kidding!')
    event.preventDefault()
  }
})
</code></pre>
<p>Another important event method is <code>.stopPropagation()</code>, which will prevent the event from bubbling up the DOM. This means that if we have a propagation-stopping click listener (say) on an element, and another click listener on one of its parents, a click event that gets triggered on the child element won&#8217;t get triggered on the parent — otherwise, it would get triggered on both.</p>
<p>Now <code>.addEventListener()</code> takes an optional config object as a 3rd argument, which can have any of the following boolean properties (all of which default to <code>false</code>):</p>
<ul>
<li><code>capture</code>: The event will be triggered on the element before any other element beneath it in the DOM (event capturing and bubbling is an article in its own right, for more details have a look <a href="http://javascript.info/tutorial/bubbling-and-capturing">here</a>)</li>
<li><code>once</code>: As you might guess, this indicates that the event will get triggered only once</li>
<li><code>passive</code>: This means that <code>event.preventDefault()</code> will be ignored (and usually yield a warning in the console)</li>
</ul>
<p>The most common option is <code>.capture</code>; in fact, it is so common that there&#8217;s a shorthand for this: instead of specifying it in the config object, you can just pass in a boolean here:</p>
<pre><code class="javascript language-javascript">myElement.addEventListener(type, listener, true)
</code></pre>
<p>Event listeners can be removed using <code>.removeEventListener()</code>, which takes the event type and a reference to the callback function to be removed; for example, the <code>once</code> option could also be implemented like</p>
<pre><code class="javascript language-javascript">myElement.addEventListener('change', function listener (event) {
  console.log(event.type + ' got triggered on ' + this)
  this.removeEventListener('change', listener)
})
</code></pre>
<h3 id="eventdelegation">Event delegation</h3>
<p>Another useful pattern is <em>event delegation</em>: say we have a form and want to add a <code>change</code> event listener to all of its <code>input</code> children. One way to do so would be iterating over them using <code>myForm.querySelectorAll('input')</code> as shown above. However, this is unnecessary when we can just as well add it to the form itself and check the contents of <code>event.target</code>.</p>
<pre><code class="javascript language-javascript">myForm.addEventListener('change', function (event) {
  const target = event.target
  if (target.matches('input')) {
    console.log(target.value)
  }
})
</code></pre>
<p>Another advantage of this pattern is that it automatically accounts for dynamically inserted children as well, without having to bind new listeners to each.</p>
<h2 id="animation">Animation</h2>
<p>Usually, the cleanest way to perform animations is to apply CSS classes with a <code>transition</code> property, or use CSS <code>@keyframes</code>. But if you need more flexibility  (e.g. for a game), this can be done with JavaScript as well.</p>
<p>The naive approach would be to have a <code>window.setTimeout()</code> function call itself until the desired animation is completed. However, this inefficiently forces rapid document reflows; and this <em>layout thrashing</em> can quickly lead to stuttering, expecially on mobile devices. Intead, we can sync the updates using <code>window.requestAnimationFrame()</code> to schedule all current changes to the next browser repaint frame. It takes a callback as argument which receives the current (high res) timestamp:</p>
<pre><code class="javascript language-javascript">const start = window.performance.now()
const duration = 2000

window.requestAnimationFrame(function fadeIn (now)) {
  const progress = now - start
  myElement.style.opacity = progress / duration

  if (progress &lt; duration) {
    window.requestAnimationFrame(fadeIn)
  }
}
</code></pre>
<p>This way we can achieve very smooth animations. For a more detailed discussion, please have a look at <a href="https://www.sitepoint.com/quick-tip-game-loop-in-javascript/">this</a> article by Mark Brown.</p>
<h2 id="writingyourownhelpermethods">Writing your own helper methods</h2>
<p>True, always having to iterate over elements to do something with them may be rather cumbersome compared to jQuery&#8217;s concise and chainable <code>$('.foo').css({color: 'red'})</code> syntax.  So why not simply write our own shorthand methods for things like this?</p>
<pre><code class="javascript language-javascript">const $ = function $ (selector, context = document) {
const elements = Array.from(context.querySelectorAll(selector))

  return {
    elements,

    html (newHtml) {
      this.elements.forEach(element =&gt; {
        element.innerHTML = newHtml
      })

      return this
    },

    css (newCss) {
      this.elements.forEach(element =&gt; {
        Object.assign(element.style, newCss)
      })

      return this
    },

    on (event, handler, options) {
      this.elements.forEach(element =&gt; {
        element.addEventListener(event, handler, options)
      })

      return this
    }

    // etc.
  }
}
</code></pre>
<p>Thus we have a super slim DOM-library with only the methods that we really need, and without all the backwards-compatibility weight. Usually we&#8217;d have those methods in our collection&#8217;s prototype though. Here&#8217;s a (somewhat more elaborate) <a href="https://gist.github.com/SitePointEditors/4f6643d62a87aece860b0784c6eeffd2">gist</a> with some ideas how to implement such helpers. Alternatively, we might keep it as simple as</p>
<pre><code class="javascript language-javascript">const $ = (selector, context = document) =&gt; context.querySelector(selector)
const $$ = (selector, context = document) =&gt; context.querySelectorAll(selector)

const html = (nodeList, newHtml) =&gt; {
  Array.from(nodeList).forEach(element =&gt; {
    element.innerHTML = newHtml
  })
}

// And so on...
</code></pre>
<h2 id="demo">Demo</h2>
<p>To round this article off, here&#8217;s a CodePen which demonstrates many of the concepts explained above to implement a simple lightbox technique. I encourage you to take some time to look through the source code and let me know in the comments below if you have any observations or questions.</p>
<p data-height="360" data-theme-id="6441" data-slug-hash="aJaggB" data-default-tab="result" data-user="SitePoint" data-embed-version="2" data-pen-title="Tightbox" class="codepen">See the Pen <a href="http://codepen.io/SitePoint/pen/aJaggB/">Tightbox</a> by SitePoint (<a href="http://codepen.io/SitePoint">@SitePoint</a>) on <a href="http://codepen.io">CodePen</a>.</p>
<p><script async src="https://production-assets.codepen.io/assets/embed/ei.js"></script></p>
<h2 id="conclusion">Conclusion</h2>
<p>I hope I could show that DOM manipulation with plain JavaScript is not rocket science and that in fact, many jQuery methods have direct equivalents in the native DOM API. This means that for some everyday use cases (such as a navigation menu or a modal popup), the additional overhead of a DOM library may be out of place.</p>
<p>And while it&#8217;s true that some parts of the native API are verbose or inconvenient (such as having to iterate over node lists manually all the time),  we can quite easily write our own small helper functions to abstract away such repetitive tasks.</p>
<p>But now it&#8217;s over to you. What do you think? Do you prefer to avoid third-party libraries where you can, or is rolling your own simply not worth the cognitive overhead? Let me know in the comments below.</p>
					</div>
				</article>
				<!--================= END :: Tutorial =================-->
				
				<!--================= START :: Tutorial =================-->
				<article>
					<a id="t-47" name="t-47"></a><h1>47 : Functional Programming Jargon</h1>
					<span class="ref-site">https://github.com/hemanth/functional-programming-jargon</span>
					<div class="tutorial__content">
<article class="markdown-body entry-content" itemprop="text">
<p>Functional programming (FP) provides many advantages, and its popularity has been increasing as a result. However, each programming paradigm comes with its own unique jargon and FP is no exception. By providing a glossary, we hope to make learning FP easier.</p>
<p>Examples are presented in JavaScript (ES2015). <a href="https://github.com/hemanth/functional-programming-jargon/wiki/Why-JavaScript%3F">Why JavaScript?</a></p>
<p><em>This is a <a href="https://github.com/hemanth/functional-programming-jargon/issues/20">WIP</a>; please feel free to send a PR ;)</em></p>
<p>Where applicable, this document uses terms defined in the <a href="https://github.com/fantasyland/fantasy-land">Fantasy Land spec</a></p>


<p><strong>Table of Contents</strong></p>

<ul>
<li><a href="#arity">Arity</a></li>
<li><a href="#higher-order-functions-hof">Higher-Order Functions (HOF)</a></li>
<li><a href="#partial-application">Partial Application</a></li>
<li><a href="#currying">Currying</a></li>
<li><a href="#auto-currying">Auto Currying</a></li>
<li><a href="#function-composition">Function Composition</a></li>
<li><a href="#continuation">Continuation</a></li>
<li><a href="#purity">Purity</a></li>
<li><a href="#side-effects">Side effects</a></li>
<li><a href="#idempotent">Idempotent</a></li>
<li><a href="#point-free-style">Point-Free Style</a></li>
<li><a href="#predicate">Predicate</a></li>
<li><a href="#contracts">Contracts</a></li>
<li><a href="#guarded-functions">Guarded Functions</a></li>
<li><a href="#category">Category</a></li>
<li><a href="#value">Value</a></li>
<li><a href="#constant">Constant</a></li>
<li><a href="#functor">Functor</a>
<ul>
<li><a href="#preserves-identity">Preserves identity</a></li>
<li><a href="#composable">Composable</a></li>
</ul>
</li>
<li><a href="#pointed-functor">Pointed Functor</a></li>
<li><a href="#lift">Lift</a></li>
<li><a href="#referential-transparency">Referential Transparency</a></li>
<li><a href="#equational-reasoning">Equational Reasoning</a></li>
<li><a href="#lambda">Lambda</a></li>
<li><a href="#lambda-calculus">Lambda Calculus</a></li>
<li><a href="#lazy-evaluation">Lazy evaluation</a></li>
<li><a href="#monoid">Monoid</a></li>
<li><a href="#monad">Monad</a></li>
<li><a href="#comonad">Comonad</a></li>
<li><a href="#applicative-functor">Applicative Functor</a></li>
<li><a href="#morphism">Morphism</a>
<ul>
<li><a href="#endomorphism">Endomorphism</a></li>
<li><a href="#isomorphism">Isomorphism</a></li>
</ul>
</li>
<li><a href="#setoid">Setoid</a></li>
<li><a href="#semigroup">Semigroup</a></li>
<li><a href="#foldable">Foldable</a></li>
<li><a href="#traversable">Traversable</a></li>
<li><a href="#type-signatures">Type Signatures</a></li>
<li><a href="#union-type">Union type</a></li>
<li><a href="#product-type">Product type</a></li>
<li><a href="#option">Option</a></li>
<li><a href="#functional-programming-libraries-in-javascript">Functional Programming Libraries in JavaScript</a></li>
</ul>

<h2><a id="user-content-arity" class="anchor" href="#arity" aria-hidden="true"></a>Arity</h2>
<p>The number of arguments a function takes. From words like unary, binary, ternary, etc. This word has the distinction of being composed of two suffixes, "-ary" and "-ity." Addition, for example, takes two arguments, and so it is defined as a binary function or a function with an arity of two. Such a function may sometimes be called "dyadic" by people who prefer Greek roots to Latin. Likewise, a function that takes a variable number of arguments is called "variadic," whereas a binary function must be given two and only two arguments, currying and partial application notwithstanding (see below).</p>
<pre><code>const sum = (a, b) =&gt; a + b

const arity = sum.length
console.log(arity) // 2

// The arity of sum is 2
</code></pre>
<h2><a id="user-content-higher-order-functions-hof" class="anchor" href="#higher-order-functions-hof" aria-hidden="true"></a>Higher-Order Functions (HOF)</h2>
<p>A function which takes a function as an argument and/or returns a function.</p>
<pre><code>const filter = (predicate, xs) =&gt; xs.filter(predicate)
</code></pre>
<pre><code>const is = (type) =&gt; (x) =&gt; Object(x) instanceof type
</code></pre>
<pre><code>filter(is(Number), [0, '1', 2, null]) // [0, 2]
</code></pre>
<h2><a id="user-content-partial-application" class="anchor" href="#partial-application" aria-hidden="true"></a>Partial Application</h2>
<p>Partially applying a function means creating a new function by pre-filling some of the arguments to the original function.</p>
<pre><code>// Helper to create partially applied functions
// Takes a function and some arguments
const partial = (f, ...args) =&gt;
  // returns a function that takes the rest of the arguments
  (...moreArgs) =&gt;
    // and calls the original function with all of them
    f(...args, ...moreArgs)

// Something to apply
const add3 = (a, b, c) =&gt; a + b + c

// Partially applying `2` and `3` to `add3` gives you a one-argument function
const fivePlus = partial(add3, 2, 3) // (c) =&gt; 2 + 3 + c

fivePlus(4) // 9
</code></pre>
<p>You can also use <code>Function.prototype.bind</code> to partially apply a function in JS:</p>
<pre><code>const add1More = add3.bind(null, 2, 3) // (c) =&gt; 2 + 3 + c
</code></pre>
<p>Partial application helps create simpler functions from more complex ones by baking in data when you have it. <a href="#currying">Curried</a> functions are automatically partially applied.</p>
<h2><a id="user-content-currying" class="anchor" href="#currying" aria-hidden="true"></a>Currying</h2>
<p>The process of converting a function that takes multiple arguments into a function that takes them one at a time.</p>
<p>Each time the function is called it only accepts one argument and returns a function that takes one argument until all arguments are passed.</p>
<pre><code>const sum = (a, b) =&gt; a + b

const curriedSum = (a) =&gt; (b) =&gt; a + b

curriedSum(40)(2) // 42.

const add2 = curriedSum(2) // (b) =&gt; 2 + b

add2(10) // 12
</code></pre>
<h2><a id="user-content-auto-currying" class="anchor" href="#auto-currying" aria-hidden="true"></a>Auto Currying</h2>
<p>Transforming a function that takes multiple arguments into one that if given less than its correct number of arguments returns a function that takes the rest. When the function gets the correct number of arguments it is then evaluated.</p>
<p>lodash &amp; ramda have a <code>curry</code> function that works this way.</p>
<pre><code>const add = (x, y) =&gt; x + y

const curriedAdd = _.curry(add)
curriedAdd(1, 2) // 3
curriedAdd(1) // (y) =&gt; 1 + y
curriedAdd(1)(2) // 3
</code></pre>
<p><strong>Further reading</strong></p>
<ul>
<li><a href="http://fr.umio.us/favoring-curry/">Favoring Curry</a></li>
<li><a href="https://www.youtube.com/watch?v=m3svKOdZijA">Hey Underscore, You're Doing It Wrong!</a></li>
</ul>
<h2><a id="user-content-function-composition" class="anchor" href="#function-composition" aria-hidden="true"></a>Function Composition</h2>
<p>The act of putting two functions together to form a third function where the output of one function is the input of the other.</p>
<pre><code>const compose = (f, g) =&gt; (a) =&gt; f(g(a)) // Definition
const floorAndToString = compose((val) =&gt; val.toString(), Math.floor) // Usage
floorAndToString(121.212121) // '121'
</code></pre>
<h2><a id="user-content-continuation" class="anchor" href="#continuation" aria-hidden="true"></a>Continuation</h2>
<p>At any given point in a program, the part of the code that's yet to be executed is known as a continuation.</p>
<pre><code>const printAsString = (num) =&gt; console.log(`Given ${num}`)

const addOneAndContinue = (num, cc) =&gt; {
  const result = num + 1
  cc(result)
}

addOneAndContinue(2, printAsString) // 'Given 3'
</code></pre>
<p>Continuations are often seen in asynchronous programming when the program needs to wait to receive data before it can continue. The response is often passed off to the rest of the program, which is the continuation, once it's been received.</p>
<pre><code>const continueProgramWith = (data) =&gt; {
  // Continues program with data
}

readFileAsync('path/to/file', (err, response) =&gt; {
  if (err) {
    // handle error
    return
  }
  continueProgramWith(response)
})
</code></pre>
<h2><a id="user-content-purity" class="anchor" href="#purity" aria-hidden="true"></a>Purity</h2>
<p>A function is pure if the return value is only determined by its
input values, and does not produce side effects.</p>
<pre><code>const greet = (name) =&gt; `Hi, ${name}`

greet('Brianne') // 'Hi, Brianne'
</code></pre>
<p>As opposed to each of the following:</p>
<pre><code>window.name = 'Brianne'

const greet = () =&gt; `Hi, ${window.name}`

greet() // "Hi, Brianne"
</code></pre>
<p>The above example's output is based on data stored outside of the function...</p>
<pre><code>let greeting

const greet = (name) =&gt; {
  greeting = `Hi, ${name}`
}

greet('Brianne')
greeting // "Hi, Brianne"
</code></pre>
<p>... and this one modifies state outside of the function.</p>
<h2><a id="user-content-side-effects" class="anchor" href="#side-effects" aria-hidden="true"></a>Side effects</h2>
<p>A function or expression is said to have a side effect if apart from returning a value, it interacts with (reads from or writes to) external mutable state.</p>
<pre><code>const differentEveryTime = new Date()
</code></pre>
<pre><code>console.log('IO is a side effect!')
</code></pre>
<h2><a id="user-content-idempotent" class="anchor" href="#idempotent" aria-hidden="true"></a>Idempotent</h2>
<p>A function is idempotent if reapplying it to its result does not produce a different result.</p>
<pre><code>f(f(x)) ≍ f(x)
</code></pre>
<pre><code>Math.abs(Math.abs(10))
</code></pre>
<pre><code>sort(sort(sort([2, 1])))
</code></pre>
<h2><a id="user-content-point-free-style" class="anchor" href="#point-free-style" aria-hidden="true"></a>Point-Free Style</h2>
<p>Writing functions where the definition does not explicitly identify the arguments used. This style usually requires <a href="#currying">currying</a> or other <a href="#higher-order-functions-hof">Higher-Order functions</a>. A.K.A Tacit programming.</p>
<pre><code>// Given
const map = (fn) =&gt; (list) =&gt; list.map(fn)
const add = (a) =&gt; (b) =&gt; a + b

// Then

// Not points-free - `numbers` is an explicit argument
const incrementAll = (numbers) =&gt; map(add(1))(numbers)

// Points-free - The list is an implicit argument
const incrementAll2 = map(add(1))
</code></pre>
<p><code>incrementAll</code> identifies and uses the parameter <code>numbers</code>, so it is not points-free.  <code>incrementAll2</code> is written just by combining functions and values, making no mention of its arguments.  It <strong>is</strong> points-free.</p>
<p>Points-free function definitions look just like normal assignments without <code>function</code> or <code>=&gt;</code>.</p>
<h2><a id="user-content-predicate" class="anchor" href="#predicate" aria-hidden="true"></a>Predicate</h2>
<p>A predicate is a function that returns true or false for a given value. A common use of a predicate is as the callback for array filter.</p>
<pre><code>const predicate = (a) =&gt; a &gt; 2

;[1, 2, 3, 4].filter(predicate) // [3, 4]
</code></pre>
<h2><a id="user-content-contracts" class="anchor" href="#contracts" aria-hidden="true"></a>Contracts</h2>
<p>A contract specifies the obligations and guarantees of the behavior from a function or expression at runtime. This acts as a set of rules that are expected from the input and output of a function or expression, and errors are generally reported whenever a contract is violated.</p>
<pre><code>// Define our contract : int -&gt; int
const contract = (input) =&gt; {
  if (typeof input === 'number') return true
  throw new Error('Contract violated: expected int -&gt; int')
}

const addOne = (num) =&gt; contract(num) &amp;&amp; num + 1

addOne(2) // 3
addOne('some string') // Contract violated: expected int -&gt; int
</code></pre>
<h2><a id="user-content-guarded-functions" class="anchor" href="#guarded-functions" aria-hidden="true"></a>Guarded Functions</h2>
<p>TODO</p>
<h2><a id="user-content-category" class="anchor" href="#category" aria-hidden="true"></a>Category</h2>
<p>A category in category theory is a collection of objects and morphisms between them. In programming, typically types
act as the objects and functions as morphisms.</p>
<p>To be a valid category 3 rules must be met:</p>
<ol>
<li>There must be an identity morphism that maps an object to itself.
Where <code>a</code> is an object in some category,
there must be a function from <code>a -&gt; a</code>.</li>
<li>Morphisms must compose.
Where <code>a</code>, <code>b</code>, and <code>c</code> are objects in some category,
and <code>f</code> is a morphism from <code>a -&gt; b</code>, and <code>g</code> is a morphism from <code>b -&gt; c</code>;
<code>g(f(x))</code> must be equivalent to <code>(g • f)(x)</code>.</li>
<li>Composition must be associative
<code>f • (g • h)</code> is the same as <code>(f • g) • h</code></li>
</ol>
<p>Since these rules govern composition at very abstract level, category theory is great at uncovering new ways of composing things.</p>
<h3><a id="user-content-further-reading" class="anchor" href="#further-reading" aria-hidden="true"></a>Further reading</h3>
<ul>
<li><a href="https://bartoszmilewski.com/2014/10/28/category-theory-for-programmers-the-preface/">Category Theory for Programmers</a></li>
</ul>
<h2><a id="user-content-value" class="anchor" href="#value" aria-hidden="true"></a>Value</h2>
<p>Anything that can be assigned to a variable.</p>
<pre><code>5
Object.freeze({name: 'John', age: 30}) // The `freeze` function enforces immutability.
;(a) =&gt; a
;[1]
undefined
</code></pre>
<h2><a id="user-content-constant" class="anchor" href="#constant" aria-hidden="true"></a>Constant</h2>
<p>A variable that cannot be reassigned once defined.</p>
<pre><code>const five = 5
const john = Object.freeze({name: 'John', age: 30})
</code></pre>
<p>Constants are <a href="#referential-transparency">referentially transparent</a>. That is, they can be replaced with the values that they represent without affecting the result.</p>
<p>With the above two constants the following expression will always return <code>true</code>.</p>
<pre><code>john.age + five === ({name: 'John', age: 30}).age + (5)
</code></pre>
<h2><a id="user-content-functor" class="anchor" href="#functor" aria-hidden="true"></a>Functor</h2>
<p>An object that implements a <code>map</code> function which, while running over each value in the object to produce a new object, adheres to two rules:</p>
<h3><a id="user-content-preserves-identity" class="anchor" href="#preserves-identity" aria-hidden="true"></a>Preserves identity</h3>
<pre><code>object.map(x =&gt; x) ≍ object
</code></pre>
<h3><a id="user-content-composable" class="anchor" href="#composable" aria-hidden="true"></a>Composable</h3>
<pre><code>object.map(compose(f, g)) ≍ object.map(g).map(f)
</code></pre>
<p>(<code>f</code>, <code>g</code> be arbitrary functions)</p>
<p>A common functor in JavaScript is <code>Array</code> since it abides to the two functor rules:</p>
<pre><code>[1, 2, 3].map(x =&gt; x) // = [1, 2, 3]
</code></pre>
<p>and</p>
<pre><code>const f = x =&gt; x + 1
const g = x =&gt; x * 2

;[1, 2, 3].map(x =&gt; f(g(x))) // = [3, 5, 7]
;[1, 2, 3].map(g).map(f)     // = [3, 5, 7]
</code></pre>
<h2><a id="user-content-pointed-functor" class="anchor" href="#pointed-functor" aria-hidden="true"></a>Pointed Functor</h2>
<p>An object with an <code>of</code> function that puts <em>any</em> single value into it.</p>
<p>ES2015 adds <code>Array.of</code> making arrays a pointed functor.</p>
<pre><code>Array.of(1) // [1]
</code></pre>
<h2><a id="user-content-lift" class="anchor" href="#lift" aria-hidden="true"></a>Lift</h2>
<p>Lifting is when you take a value and put it into an object like a <a href="#pointed-functor">functor</a>. If you lift a function into an <a href="#applicative-functor">Applicative Functor</a> then you can make it work on values that are also in that functor.</p>
<p>Some implementations have a function called <code>lift</code>, or <code>liftA2</code> to make it easier to run functions on functors.</p>
<pre><code>const liftA2 = (f) =&gt; (a, b) =&gt; a.map(f).ap(b) // note it's `ap` and not `map`.

const mult = a =&gt; b =&gt; a * b

const liftedMult = liftA2(mult) // this function now works on functors like array

liftedMult([1, 2], [3]) // [3, 6]
liftA2((a, b) =&gt; a + b)([1, 2], [3, 4]) // [4, 5, 5, 6]
</code></pre>
<p>Lifting a one-argument function and applying it does the same thing as <code>map</code>.</p>
<pre><code>const increment = (x) =&gt; x + 1

lift(increment)([2]) // [3]
;[2].map(increment) // [3]
</code></pre>
<h2><a id="user-content-referential-transparency" class="anchor" href="#referential-transparency" aria-hidden="true"></a>Referential Transparency</h2>
<p>An expression that can be replaced with its value without changing the
behavior of the program is said to be referentially transparent.</p>
<p>Say we have function greet:</p>
<pre><code>const greet = () =&gt; 'Hello World!'
</code></pre>
<p>Any invocation of <code>greet()</code> can be replaced with <code>Hello World!</code> hence greet is
referentially transparent.</p>
<h2><a id="user-content-equational-reasoning" class="anchor" href="#equational-reasoning" aria-hidden="true"></a>Equational Reasoning</h2>
<p>When an application is composed of expressions and devoid of side effects, truths about the system can be derived from the parts.</p>
<h2><a id="user-content-lambda" class="anchor" href="#lambda" aria-hidden="true"></a>Lambda</h2>
<p>An anonymous function that can be treated like a value.</p>
<pre><code>;(function (a) {
  return a + 1
})

;(a) =&gt; a + 1
</code></pre>
<p>Lambdas are often passed as arguments to Higher-Order functions.</p>
<pre><code>[1, 2].map((a) =&gt; a + 1) // [2, 3]
</code></pre>
<p>You can assign a lambda to a variable.</p>
<pre><code>const add1 = (a) =&gt; a + 1
</code></pre>
<h2><a id="user-content-lambda-calculus" class="anchor" href="#lambda-calculus" aria-hidden="true"></a>Lambda Calculus</h2>
<p>A branch of mathematics that uses functions to create a <a href="https://en.wikipedia.org/wiki/Lambda_calculus">universal model of computation</a>.</p>
<h2><a id="user-content-lazy-evaluation" class="anchor" href="#lazy-evaluation" aria-hidden="true"></a>Lazy evaluation</h2>
<p>Lazy evaluation is a call-by-need evaluation mechanism that delays the evaluation of an expression until its value is needed. In functional languages, this allows for structures like infinite lists, which would not normally be available in an imperative language where the sequencing of commands is significant.</p>
<pre><code>const rand = function*() {
  while (1 &lt; 2) {
    yield Math.random()
  }
}
</code></pre>
<pre><code>const randIter = rand()
randIter.next() // Each execution gives a random value, expression is evaluated on need.
</code></pre>
<h2><a id="user-content-monoid" class="anchor" href="#monoid" aria-hidden="true"></a>Monoid</h2>
<p>An object with a function that "combines" that object with another of the same type.</p>
<p>One simple monoid is the addition of numbers:</p>
<pre><code>1 + 1 // 2
</code></pre>
<p>In this case number is the object and <code>+</code> is the function.</p>
<p>An "identity" value must also exist that when combined with a value doesn't change it.</p>
<p>The identity value for addition is <code>0</code>.</p>
<pre><code>1 + 0 // 1
</code></pre>
<p>It's also required that the grouping of operations will not affect the result (associativity):</p>
<pre><code>1 + (2 + 3) === (1 + 2) + 3 // true
</code></pre>
<p>Array concatenation also forms a monoid:</p>
<pre><code>;[1, 2].concat([3, 4]) // [1, 2, 3, 4]
</code></pre>
<p>The identity value is empty array <code>[]</code></p>
<pre><code>;[1, 2].concat([]) // [1, 2]
</code></pre>
<p>If identity and compose functions are provided, functions themselves form a monoid:</p>
<pre><code>const identity = (a) =&gt; a
const compose = (f, g) =&gt; (x) =&gt; f(g(x))
</code></pre>
<p><code>foo</code> is any function that takes one argument.</p>
<pre><code>compose(foo, identity) ≍ compose(identity, foo) ≍ foo
</code></pre>
<h2><a id="user-content-monad" class="anchor" href="#monad" aria-hidden="true"></a>Monad</h2>
<p>A monad is an object with <a href="#pointed-functor"><code>of</code></a> and <code>chain</code> functions. <code>chain</code> is like <a href="#functor"><code>map</code></a> except it un-nests the resulting nested object.</p>
<pre><code>// Implementation
Array.prototype.chain = function (f) {
  return this.reduce((acc, it) =&gt; acc.concat(f(it)), [])
}

// Usage
;Array.of('cat,dog', 'fish,bird').chain((a) =&gt; a.split(',')) // ['cat', 'dog', 'fish', 'bird']

// Contrast to map
;Array.of('cat,dog', 'fish,bird').map((a) =&gt; a.split(',')) // [['cat', 'dog'], ['fish', 'bird']]
</code></pre>
<p><code>of</code> is also known as <code>return</code> in other functional languages.
<code>chain</code> is also known as <code>flatmap</code> and <code>bind</code> in other languages.</p>
<h2><a id="user-content-comonad" class="anchor" href="#comonad" aria-hidden="true"></a>Comonad</h2>
<p>An object that has <code>extract</code> and <code>extend</code> functions.</p>
<pre><code>const CoIdentity = (v) =&gt; ({
  val: v,
  extract () {
    return this.val
  },
  extend (f) {
    return CoIdentity(f(this))
  }
})
</code></pre>
<p>Extract takes a value out of a functor.</p>
<pre><code>CoIdentity(1).extract() // 1
</code></pre>
<p>Extend runs a function on the comonad. The function should return the same type as the comonad.</p>
<pre><code>CoIdentity(1).extend((co) =&gt; co.extract() + 1) // CoIdentity(2)
</code></pre>
<h2><a id="user-content-applicative-functor" class="anchor" href="#applicative-functor" aria-hidden="true"></a>Applicative Functor</h2>
<p>An applicative functor is an object with an <code>ap</code> function. <code>ap</code> applies a function in the object to a value in another object of the same type.</p>
<pre><code>// Implementation
Array.prototype.ap = function (xs) {
  return this.reduce((acc, f) =&gt; acc.concat(xs.map(f)), [])
}

// Example usage
;[(a) =&gt; a + 1].ap([1]) // [2]
</code></pre>
<p>This is useful if you have two objects and you want to apply a binary function to their contents.</p>
<pre><code>// Arrays that you want to combine
const arg1 = [1, 3]
const arg2 = [4, 5]

// combining function - must be curried for this to work
const add = (x) =&gt; (y) =&gt; x + y

const partiallyAppliedAdds = [add].ap(arg1) // [(y) =&gt; 1 + y, (y) =&gt; 3 + y]
</code></pre>
<p>This gives you an array of functions that you can call <code>ap</code> on to get the result:</p>
<pre><code>partiallyAppliedAdds.ap(arg2) // [5, 6, 7, 8]
</code></pre>
<h2><a id="user-content-morphism" class="anchor" href="#morphism" aria-hidden="true"></a>Morphism</h2>
<p>A transformation function.</p>
<h3><a id="user-content-endomorphism" class="anchor" href="#endomorphism" aria-hidden="true"></a>Endomorphism</h3>
<p>A function where the input type is the same as the output.</p>
<pre><code>// uppercase :: String -&gt; String
const uppercase = (str) =&gt; str.toUpperCase()

// decrement :: Number -&gt; Number
const decrement = (x) =&gt; x - 1
</code></pre>
<h3><a id="user-content-isomorphism" class="anchor" href="#isomorphism" aria-hidden="true"></a>Isomorphism</h3>
<p>A pair of transformations between 2 types of objects that is structural in nature and no data is lost.</p>
<p>For example, 2D coordinates could be stored as an array <code>[2,3]</code> or object <code>{x: 2, y: 3}</code>.</p>
<pre><code>// Providing functions to convert in both directions makes them isomorphic.
const pairToCoords = (pair) =&gt; ({x: pair[0], y: pair[1]})

const coordsToPair = (coords) =&gt; [coords.x, coords.y]

coordsToPair(pairToCoords([1, 2])) // [1, 2]

pairToCoords(coordsToPair({x: 1, y: 2})) // {x: 1, y: 2}
</code></pre>
<h2><a id="user-content-setoid" class="anchor" href="#setoid" aria-hidden="true"></a>Setoid</h2>
<p>An object that has an <code>equals</code> function which can be used to compare other objects of the same type.</p>
<p>Make array a setoid:</p>
<pre><code>Array.prototype.equals = function (arr) {
  const len = this.length
  if (len !== arr.length) {
    return false
  }
  for (let i = 0; i &lt; len; i++) {
    if (this[i] !== arr[i]) {
      return false
    }
  }
  return true
}

;[1, 2].equals([1, 2]) // true
;[1, 2].equals([0]) // false
</code></pre>
<h2><a id="user-content-semigroup" class="anchor" href="#semigroup" aria-hidden="true"></a>Semigroup</h2>
<p>An object that has a <code>concat</code> function that combines it with another object of the same type.</p>
<pre><code>;[1].concat([2]) // [1, 2]
</code></pre>
<h2><a id="user-content-foldable" class="anchor" href="#foldable" aria-hidden="true"></a>Foldable</h2>
<p>An object that has a <code>reduce</code> function that can transform that object into some other type.</p>
<pre><code>const sum = (list) =&gt; list.reduce((acc, val) =&gt; acc + val, 0)
sum([1, 2, 3]) // 6
</code></pre>
<h2><a id="user-content-traversable" class="anchor" href="#traversable" aria-hidden="true"></a>Traversable</h2>
<p>TODO</p>
<h2><a id="user-content-type-signatures" class="anchor" href="#type-signatures" aria-hidden="true"></a>Type Signatures</h2>
<p>Often functions in JavaScript will include comments that indicate the types of their arguments and return values.</p>
<p>There's quite a bit of variance across the community but they often follow the following patterns:</p>
<pre><code>// functionName :: firstArgType -&gt; secondArgType -&gt; returnType

// add :: Number -&gt; Number -&gt; Number
const add = (x) =&gt; (y) =&gt; x + y

// increment :: Number -&gt; Number
const increment = (x) =&gt; x + 1
</code></pre>
<p>If a function accepts another function as an argument it is wrapped in parentheses.</p>
<pre><code>// call :: (a -&gt; b) -&gt; a -&gt; b
const call = (f) =&gt; (x) =&gt; f(x)
</code></pre>
<p>The letters <code>a</code>, <code>b</code>, <code>c</code>, <code>d</code> are used to signify that the argument can be of any type. The following version of <code>map</code> takes a function that transforms a value of some type <code>a</code> into another type <code>b</code>, an array of values of type <code>a</code>, and returns an array of values of type <code>b</code>.</p>
<pre><code>// map :: (a -&gt; b) -&gt; [a] -&gt; [b]
const map = (f) =&gt; (list) =&gt; list.map(f)
</code></pre>
<p><strong>Further reading</strong></p>

<h2><a id="user-content-union-type" class="anchor" href="#union-type" aria-hidden="true"></a>Union type</h2>
<p>A union type is the combination of two types together into another one.</p>
<p>JS doesn't have static types but let's say we invent a type <code>NumOrString</code> which is a sum of <code>String</code> and <code>Number</code>.</p>
<p>The <code>+</code> operator in JS works on strings and numbers so we can use this new type to describe its inputs and outputs:</p>
<pre><code>// add :: (NumOrString, NumOrString) -&gt; NumOrString
const add = (a, b) =&gt; a + b

add(1, 2) // Returns number 3
add('Foo', 2) // Returns string "Foo2"
add('Foo', 'Bar') // Returns string "FooBar"
</code></pre>
<p>Union types are also known as algebraic types, tagged unions, or sum types.</p>
<p>There's a <a href="https://github.com/paldepind/union-type">couple</a> <a href="https://github.com/puffnfresh/daggy">libraries</a> in JS which help with defining and using union types.</p>
<h2><a id="user-content-product-type" class="anchor" href="#product-type" aria-hidden="true"></a>Product type</h2>
<p>A <strong>product</strong> type combines types together in a way you're probably more familiar with:</p>
<pre><code>// point :: (Number, Number) -&gt; {x: Number, y: Number}
const point = (x, y) =&gt; ({x: x, y: y})
</code></pre>
<p>It's called a product because the total possible values of the data structure is the product of the different values.</p>
<p>See also <a href="https://en.wikipedia.org/wiki/Set_theory">Set theory</a>.</p>
<h2><a id="user-content-option" class="anchor" href="#option" aria-hidden="true"></a>Option</h2>
<p>Option is a <a href="#union-type">union type</a> with two cases often called <code>Some</code> and <code>None</code>.</p>
<p>Option is useful for composing functions that might not return a value.</p>
<pre><code>// Naive definition

const Some = (v) =&gt; ({
  val: v,
  map (f) {
    return Some(f(this.val))
  },
  chain (f) {
    return f(this.val)
  }
})

const None = () =&gt; ({
  map (f) {
    return this
  },
  chain (f) {
    return this
  }
})

// maybeProp :: (String, {a}) -&gt; Option a
const maybeProp = (key, obj) =&gt; typeof obj[key] === 'undefined' ? None() : Some(obj[key])
</code></pre>
<p>Use <code>chain</code> to sequence functions that return <code>Option</code>s</p>
<pre><code>// getItem :: Cart -&gt; Option CartItem
const getItem = (cart) =&gt; maybeProp('item', cart)

// getPrice :: Item -&gt; Option Number
const getPrice = (item) =&gt; maybeProp('price', item)

// getNestedPrice :: cart -&gt; Option a
const getNestedPrice = (cart) =&gt; getItem(obj).chain(getPrice)

getNestedPrice({}) // None()
getNestedPrice({item: {foo: 1}}) // None()
getNestedPrice({item: {price: 9.99}}) // Some(9.99)
</code></pre>
<p><code>Option</code> is also known as <code>Maybe</code>. <code>Some</code> is sometimes called <code>Just</code>. <code>None</code> is sometimes called <code>Nothing</code>.</p>
<h2><a id="user-content-functional-programming-libraries-in-javascript" class="anchor" href="#functional-programming-libraries-in-javascript" aria-hidden="true"></a>Functional Programming Libraries in JavaScript</h2>


</article>
					</div>
				</article>
				<!--================= END :: Tutorial =================-->
				
				<!--================= START :: Tutorial =================-->
				<article>
					<a id="t-48" name="t-48"></a><h1>48 : ES6 Object Destructuring</h1>
					<span class="ref-site"></span>
					<div class="tutorial__content">
<div class="post"><p>As JavaScript developers you are working a lot with objects and let's face it, manipulating objects wasn't the most convenient thing in JavaScript. ES6 is about to change this. Today we are going to discuss how to destructure objects using ES6.</p>
<p>Before however let's take a look at a sample object and see what we'd do now, using ES5:</p>
<pre><code>var person = {
    name: 'Joe',
    age: 21,
    married: true,
    hobbies: ['football', 'tennis', 'cooking']
};
</code></pre>
<p>In order to extract some information and store them as variables we'd probably do:</p>
<pre><code>var name = person.name;
var age = person.age;
// so on
</code></pre>
<p>This is a slightly laborous exercise, with ES6, utilising object destructuring we can very simply do:</p>
<pre><code>var {name, age} = person;
</code></pre>
<p>The above line will automatically create both a <code>name</code> and an <code>age</code> variable. If we want we can also have different names then the property name from the object for the variables:</p>
<pre><code>var {myName: name, myAge: age} = person;
</code></pre>
<p>This will create <code>myName</code> and <code>myAge</code> variables with the right values.</p>
<p>And finally, we can also desctructure arrays using the same notation:</p>
<pre><code>var {name, age, hobbies: [first, second]} = person;
</code></pre>
<p>You could now easily access these variables, for example <code>console.log(first)</code> would return 'football'.</p>

              </div>
					</div>
				</article>
				<!--================= END :: Tutorial =================-->
				
			
				<!--================= START :: Tutorial =================-->
				<article>
					<a id="t-49" name="t-49"></a><h1>49 : ECMAScript 6 equivalents in ES5</h1>
					<span class="ref-site">https://github.com/addyosmani/es6-equivalents-in-es5</span>
					<div class="tutorial__content">
<article class="markdown-body entry-content" itemprop="text">
<p><strong>Table of contents:</strong></p>
<ol>
<li><a href="#arrow-functions">Arrow Functions</a></li>
<li><a href="#block-scoping-functions">Block Scoping Functions</a></li>
<li><a href="#t-emplate-literals">Template Literals</a></li>
<li><a href="#computed-property-names">Computed Property Names</a></li>
<li><a href="#destructuring-assignment">Destructuring Assignment</a></li>
<li><a href="#default-parameters">Default Parameters</a></li>
<li><a href="#iterators-and-for-of">Iterators and For-Of</a></li>
<li><a href="#classes">Classes</a></li>
<li><a href="#modules">Modules</a></li>
<li><a href="#numeric-literals">Numeric Literals</a></li>
<li><a href="#property-method-assignment">Property Method Assignment</a></li>
<li><a href="#object-initializer-shorthand">Object Initializer Shorthand</a></li>
<li><a href="#rest-parameters">Rest Parameters</a></li>
<li><a href="#spread-operator">Spread Operator</a></li>
<li><a href="#proxying-a-function-object">Proxying a function object</a></li>
<li><a href="#array-like-object-to-array">Array-like object to array</a></li>
<li><a href="#about">About</a></li>
<li><a href="#license">License</a></li>
</ol>
<h2><a id="user-content-arrow-functions" class="anchor" href="#arrow-functions" aria-hidden="true"></a>Arrow Functions</h2>
<p>An arrow function expression (also known as fat arrow function) has a shorter syntax compared to function expressions and lexically binds the this value. Arrow functions are always anonymous.</p>
<p>ES6:</p>
<pre><code>[1, 2, 3].map(n =&gt; n * 2);
// -&gt; [ 2, 4, 6 ]
</code></pre>
<p>ES5 equivalent:</p>
<pre><code>[1, 2, 3].map(function(n) { return n * 2; }, this);
// -&gt; [ 2, 4, 6 ]
</code></pre>
<p>ES6:</p>
<pre><code>var evens = [2, 4, 6, 8, 10];

// Expression bodies
var odds = evens.map(v =&gt; v + 1);
var nums = evens.map((v, i) =&gt; v + i);

console.log(odds);
// -&gt; [3, 5, 7, 9, 11]

console.log(nums);
// -&gt; [2, 5, 8, 11, 14]

// Statement bodies
var fives = [];
nums = [1, 2, 5, 15, 25, 32];
nums.forEach(v =&gt; {
  if (v % 5 === 0)
    fives.push(v);
});

console.log(fives);
// -&gt; [5, 15, 25]

// Lexical this
var bob = {
  _name: 'Bob',
  _friends: [],
  printFriends() {
    this._friends.forEach(f =&gt;
      console.log(this._name + ' knows ' + f));
  }
}
</code></pre>
<p>ES5:</p>
<pre><code>'use strict';

var evens = [2, 4, 6, 8, 10];

// Expression bodies
var odds = evens.map(function (v) {
  return v + 1;
}, this);
var nums = evens.map(function (v, i) {
  return v + i;
}, this);

console.log(odds);
// -&gt; [3, 5, 7, 9, 11]

console.log(nums);
// -&gt; [2, 5, 8, 11, 14]

var fives = [];
nums = [1, 2, 5, 15, 25, 32];

// Statement bodies
nums.forEach(function (v) {
  if (v % 5 === 0) {
    fives.push(v);
  }
}, this);

console.log(fives);
// -&gt; [5, 15, 25]

// Lexical this
var bob = {
  _name: 'Bob',
  _friends: [],
  printFriends: function printFriends() {
    this._friends.forEach(function (f) {
      return console.log(this._name + ' knows ' + f);
    }, this);
  }
};
</code></pre>
<h2><a id="user-content-block-scoping-functions" class="anchor" href="#block-scoping-functions" aria-hidden="true"></a>Block Scoping Functions</h2>
<p>Block scoped bindings provide scopes other than the function and top level scope. This ensures your variables don't leak out of the scope they're defined:</p>
<p>ES6:</p>
<pre><code>// let declares a block scope local variable,
// optionally initializing it to a value in ES6

'use strict';

var a = 5;
var b = 10;

if (a === 5) {
  let a = 4; // The scope is inside the if-block
  var b = 1; // The scope is inside the function

  console.log(a);  // 4
  console.log(b);  // 1
}

console.log(a); // 5
console.log(b); // 1
</code></pre>
<p>ES5:</p>
<pre><code>'use strict';

var a = 5;
var b = 10;

if (a === 5) {
  // technically is more like the following
  (function () {
    var a = 4;
    b = 1;

    console.log(a); // 4
    console.log(b); // 1
  })();
}

console.log(a); // 5
console.log(b); // 1
</code></pre>
<p>ES6:</p>
<pre><code>// const creates a read-only named constant in ES6.
'use strict';
// define favorite as a constant and give it the value 7
const favorite = 7;
// Attempt to overwrite the constant
try {
  favorite = 15;
} catch (err) {
  console.log('my favorite number is still: ' + favorite);
  // will still print 7
}
</code></pre>
<p>ES5:</p>
<pre><code>'use strict';
// define favorite as a non-writable `constant` and give it the value 7
Object.defineProperties(window, {
  favorite: {
    value: 7,
    enumerable: true
  }
});
// ^ descriptors are by default false and const are enumerable
var favorite = 7;
// Attempt to overwrite the constant
favorite = 15;
// will still print 7
console.log('my favorite number is still: ' + favorite);
</code></pre>
<h2><a id="user-content-template-literals" class="anchor" href="#t-emplate-literals" aria-hidden="true"></a>Template Literals</h2>
<p>ES6 Template Literals are strings that can include <strong>embedded expressions</strong>. This is sometimes referred to as string interpolation.</p>
<p>ES6:</p>
<pre><code>// Basic usage with an expression placeholder
var person = 'Addy Osmani';
console.log(`Yo! My name is ${person}!`);

// Expressions work just as well with object literals
var user = {name: 'Caitlin Potter'};
console.log(`Thanks for getting this into V8, ${user.name}.`);

// Expression interpolation. One use is readable inline math.
var a = 50;
var b = 100;
console.log(`The number of JS frameworks is ${a + b} and not ${2 * a + b}.`);

// Multi-line strings without needing \n\
console.log(`string text line 1
string text line 2`);

// Functions inside expressions
function fn() { return 'result'; }
console.log(`foo ${fn()} bar`);
</code></pre>
<p>ES5:</p>
<pre><code>'use strict';

// Basic usage with an expression placeholder
var person = 'Addy Osmani';
console.log('Yo! My name is ' + person + '!');

// Expressions work just as well with object literals
var user = { name: 'Caitlin Potter' };
console.log('Thanks for getting this into V8, ' + user.name + '.');

// Expression interpolation. One use is readable inline math.
var a = 50;
var b = 100;
console.log('The number of JS frameworks is ' + (a + b) + ' and not ' + (2 * a + b) + '.');

// Multi-line strings:
console.log('string text line 1\nstring text line 2');
// Or, alternatively:
console.log('string text line 1\n\
string text line 2');

// Functions inside expressions
function fn() {
  return 'result';
}
console.log('foo ' + fn() + ' bar');
</code></pre>
<h2><a id="user-content-computed-property-names" class="anchor" href="#computed-property-names" aria-hidden="true"></a>Computed Property Names</h2>
<p>Computed property names allow you to specify properties in object literals based on expressions:</p>
<p>ES6:</p>
<pre><code>var prefix = 'foo';
var myObject = {
  [prefix + 'bar']: 'hello',
  [prefix + 'baz']: 'world'
};

console.log(myObject['foobar']);
// -&gt; hello
console.log(myObject['foobaz']);
// -&gt; world
</code></pre>
<p>ES5:</p>
<pre><code>'use strict';

var prefix = 'foo';
var myObject = {};

myObject[prefix + 'bar'] = 'hello';
myObject[prefix + 'baz'] = 'world';

console.log(myObject['foobar']);
// -&gt; hello
console.log(myObject['foobaz']);
// -&gt; world
</code></pre>
<h2><a id="user-content-destructuring-assignment" class="anchor" href="#destructuring-assignment" aria-hidden="true"></a>Destructuring Assignment</h2>
<p>The destructuring assignment syntax is a JavaScript expression that makes it possible to extract data from arrays or objects using a syntax that mirrors the construction of array and object literals.</p>
<p>ES6:</p>
<pre><code>var {foo, bar} = {foo: 'lorem', bar: 'ipsum'};
// foo =&gt; lorem and bar =&gt; ipsum
</code></pre>
<p>ES5:</p>
<pre><code>'use strict';

var _ref = { foo: 'lorem', bar: 'ipsum' };

// foo =&gt; lorem and bar =&gt; ipsum
var foo = _ref.foo;
var bar = _ref.bar;
</code></pre>
<p>ES3:</p>
<pre><code>with({foo: 'lorem', bar: 'ipsum'}) {
  // foo =&gt; lorem and bar =&gt; ipsum
}
</code></pre>
<p>ES6:</p>
<pre><code>var [a, , b] = [1,2,3];
</code></pre>
<p>ES6 (shimming using <code>Symbol.iterator</code>):</p>
<pre><code>'use strict';

var _slicedToArray = function (arr, i) {
  if (Array.isArray(arr)) {
    return arr;
  } else {
    var _arr = [];

    for (var _iterator = arr[Symbol.iterator](), _step; !(_step = _iterator.next()).done;) {
      _arr.push(_step.value);

      if (i &amp;&amp; _arr.length === i) {
        break;
      }
    }

    return _arr;
  }
};

var _ref = [1, 2, 3];

var _ref2 = _slicedToArray(_ref, 3);

var a = _ref2[0];
var b = _ref2[2];
</code></pre>
<p>ES5:</p>
<pre><code>String.prototype.asNamedList = function () {
  return this.split(/\s*,\s*/).map(function (name, i) {
    return name ? ('var ' + name + '=slice(' + i + ', ' + (i + 1) + ')[0]') : '';
  }).join(';');
};

with([1,2,3]) {
  eval('a, , b'.asNamedList());
}
</code></pre>
<h2><a id="user-content-default-parameters" class="anchor" href="#default-parameters" aria-hidden="true"></a>Default Parameters</h2>
<p>Default parameters allow your functions to have optional arguments without needing to check arguments.length or check for undefined.</p>
<p>ES6:</p>
<pre><code>function greet(msg='hello', name='world') {
  console.log(msg,name);
}

greet();
// -&gt; hello world
greet('hey');
// -&gt; hey world
</code></pre>
<p>ES5:</p>
<pre><code>'use strict';

function greet() {
  // unfair ... if you access arguments[0] like this you can simply
  // access the msg variable name instead
  var msg = arguments[0] === undefined ? 'hello' : arguments[0];
  var name = arguments[1] === undefined ? 'world' : arguments[1];
  console.log(msg, name);
}

function greet(msg, name) {
  (msg === undefined) &amp;&amp; (msg = 'hello');
  (name === undefined) &amp;&amp; (name = 'world');
  console.log(msg,name);
}

// using basic utility that check against undefined
function greet(msg, name) {
  console.log(
    defaults(msg, 'hello'),
    defaults(name, 'world')
  );
}

greet();
// -&gt; hello world
greet('hey');
// -&gt; hey world
</code></pre>
<p>ES6:</p>
<pre><code>function f(x, y=12) {
  // y is 12 if not passed (or passed as undefined)
  return x + y;
}

f(3) === 15;
</code></pre>
<p>ES5:</p>
<pre><code>'use strict';

function f(x, y) {
  if (y === undefined) {
    y = 12;
  }

  return x + y;
}

f(3) === 15;
</code></pre>
<h2><a id="user-content-iterators-and-for-of" class="anchor" href="#iterators-and-for-of" aria-hidden="true"></a>Iterators And For-Of</h2>
<p>Iterators are objects that can traverse a container. It's a useful way to make a class work inside a for of loop.
The interface is similar to the iterators-interface. Iterating with a <code>for..of</code> loop looks like:</p>
<p>ES6:</p>
<pre><code>// Behind the scenes, this will get an iterator from the array and loop through it, getting values from it.
for (let element of [1, 2, 3]) {
  console.log(element);
}
// =&gt; 1 2 3
</code></pre>
<p>ES6 (without using <code>for-of</code>, if <code>Symbol</code> is supported):</p>
<pre><code>'use strict';

for (var _iterator = [1, 2, 3][Symbol.iterator](), _step; !(_step = _iterator.next()).done;) {
  var element = _step.value;
  console.log(element);
}

// =&gt; 1 2 3
</code></pre>
<p>ES5 (approximates):</p>
<pre><code>// Using forEach()
// Doesn't require declaring indexing and element variables in your containing
// scope. They get supplied as arguments to the iterator and are scoped to just
// that iteration.
var a = [1,2,3];
a.forEach(function (element) {
    console.log(element);
});

// =&gt; 1 2 3

// Using a for loop
var a = [1,2,3];
for (var i = 0; i &lt; a.length; ++i) {
    console.log(a[i]);
}
// =&gt; 1 2 3
</code></pre>
<p>Note the use of <code>Symbol</code>. The ES5 equivalent would require a Symbol polyfill in order to correctly function.</p>
<h2><a id="user-content-classes" class="anchor" href="#classes" aria-hidden="true"></a>Classes</h2>
<p>This implements class syntax and semantics as described in the ES6 draft spec. Classes are a great way to reuse code.
Several JS libraries provide classes and inheritance, but they aren't mutually compatible.</p>
<p>ES6:</p>
<pre><code>class Hello {
  constructor(name) {
    this.name = name;
  }

  hello() {
    return 'Hello ' + this.name + '!';
  }

  static sayHelloAll() {
    return 'Hello everyone!';
  }
}

class HelloWorld extends Hello {
  constructor() {
    super('World');
  }

  echo() {
    alert(super.hello());
  }
}

var hw = new HelloWorld();
hw.echo();

alert(Hello.sayHelloAll());
</code></pre>
<p>ES5 (approximate):</p>
<pre><code>function Hello(name) {
  this.name = name;
}

Hello.prototype.hello = function hello() {
  return 'Hello ' + this.name + '!';
};

Hello.sayHelloAll = function () {
  return 'Hello everyone!';
};

function HelloWorld() {
  Hello.call(this, 'World');
}

HelloWorld.prototype = Object.create(Hello.prototype);
HelloWorld.prototype.constructor = HelloWorld;
HelloWorld.sayHelloAll = Hello.sayHelloAll;

HelloWorld.prototype.echo = function echo() {
  alert(Hello.prototype.hello.call(this));
};

var hw = new HelloWorld();
hw.echo();

alert(Hello.sayHelloAll());
</code></pre>
<p>A more faithful (albeit, slightly verbose) interpretation can be found in this <a href="https://goo.gl/ZvEQDq">Babel</a> output.</p>
<h2><a id="user-content-modules" class="anchor" href="#modules" aria-hidden="true"></a>Modules</h2>
<p>Modules are mostly implemented, with some parts of the Loader API still to be corrected. Modules try to solve many issues in dependencies and deployment, allowing users to create modules with explicit exports, import specific exported names from those modules, and keep these names separate.</p>
<p><em>Assumes an environment using CommonJS</em></p>
<p>app.js - ES6</p>
<pre><code>import math from 'lib/math';
console.log('2π = ' + math.sum(math.pi, math.pi));
</code></pre>
<p>app.js - ES5</p>
<pre><code>var math = require('lib/math');
console.log('2π = ' + math.sum(math.pi, math.pi));
</code></pre>
<p>lib/math.js - ES6</p>
<pre><code>export function sum(x, y) {
  return x + y;
}
export var pi = 3.141593;
</code></pre>
<p>lib/math.js - ES5</p>
<pre><code>exports.sum = sum;
function sum(x, y) {
  return x + y;
}
var pi = exports.pi = 3.141593;
</code></pre>
<p>lib/mathplusplus.js - ES6</p>
<pre><code>export * from 'lib/math';
export var e = 2.71828182846;
export default function(x) {
  return Math.exp(x);
}
</code></pre>
<p>lib/mathplusplus.js - ES5</p>
<pre><code>var Math = require('lib/math');

var _extends = function (target) {
  for (var i = 1; i &lt; arguments.length; i++) {
    var source = arguments[i];
    for (var key in source) {
      target[key] = source[key];
    }
  }

  return target;
};

var e = exports.e = 2.71828182846;
exports['default'] = function (x) {
  return Math.exp(x);
};

module.exports = _extends(exports['default'], exports);
</code></pre>
<h2><a id="user-content-numeric-literals" class="anchor" href="#numeric-literals" aria-hidden="true"></a>Numeric Literals</h2>
<p>ES6:</p>
<pre><code>var binary = [
  0b0,
  0b1,
  0b11
];
console.assert(binary === [0, 1, 3]);

var octal = [
  0o0,
  0o1,
  0o10,
  0o77
];
console.assert(octal === [0, 1, 8, 63]);
</code></pre>
<p>ES5:</p>
<pre><code>'use strict';

var binary = [0, 1, 3];
console.assert(binary === [0, 1, 3]);

var octal = [0, 1, 8, 63];
console.assert(octal === [0, 1, 8, 63]);
</code></pre>
<h2><a id="user-content-property-method-assignment" class="anchor" href="#property-method-assignment" aria-hidden="true"></a>Property Method Assignment</h2>
<p>Method syntax is supported in object initializers, for example see toString():</p>
<p>ES6:</p>
<pre><code>var object = {
  value: 42,
  toString() {
    return this.value;
  }
};

console.log(object.toString() === 42);
// -&gt; true
</code></pre>
<p>ES5:</p>
<pre><code>'use strict';

var object = {
  value: 42,
  toString: function toString() {
    return this.value;
  }
};

console.log(object.toString() === 42);
// -&gt; true
</code></pre>
<h2><a id="user-content-object-initializer-shorthand" class="anchor" href="#object-initializer-shorthand" aria-hidden="true"></a>Object Initializer Shorthand</h2>
<p>This allows you to skip repeating yourself when the property name and property value are the same in an object literal.</p>
<p>ES6:</p>
<pre><code>function getPoint() {
  var x = 1;
  var y = 10;

  return {x, y};
}

console.log(getPoint() === {
  x: 1,
  y: 10
});
</code></pre>
<p>ES5:</p>
<pre><code>'use strict';

function getPoint() {
  var x = 1;
  var y = 10;

  return { x: x, y: y };
}

console.log(getPoint() === {
  x: 1,
  y: 10
});
</code></pre>
<h2><a id="user-content-rest-parameters" class="anchor" href="#rest-parameters" aria-hidden="true"></a>Rest Parameters</h2>
<p>Rest parameters allows your functions to have variable number of arguments without using the arguments object.
The rest parameter is an instance of Array so all the array methods just work.</p>
<p>ES6:</p>
<pre><code>function f(x, ...y) {
  // y is an Array
  return x * y.length;
}

console.log(f(3, 'hello', true) === 6);
// -&gt; true
</code></pre>
<p>ES5:</p>
<pre><code>'use strict';

function f(x) {
  var y = [];
  y.push.apply(y, arguments) &amp;&amp; y.shift();

  // y is an Array
  return x * y.length;
}

console.log(f(3, 'hello', true) === 6);
// -&gt; true
</code></pre>
<h2><a id="user-content-spread-operator" class="anchor" href="#spread-operator" aria-hidden="true"></a>Spread Operator</h2>
<p>The spread operator is like the reverse of rest parameters. It allows you to expand an array into multiple formal parameters.</p>
<p>ES6:</p>
<pre><code>function add(a, b) {
  return a + b;
}

let nums = [5, 4];

console.log(add(...nums));
</code></pre>
<p>ES5:</p>
<pre><code>'use strict';

var _toArray = function (arr) {
  return Array.isArray(arr) ? arr : [].slice.call(arr);
};

function add(a, b) {
  return a + b;
}

var nums = [5, 4];
console.log(add.apply(null, _toArray(nums)));
</code></pre>
<p>ES6:</p>
<pre><code>function f(x, y, z) {
  return x + y + z;
}
// Pass each elem of array as argument
f(...[1,2,3]) === 6;
</code></pre>
<p>ES5:</p>
<pre><code>'use strict';

function f(x, y, z) {
  return x + y + z;
}
// Pass each elem of array as argument
f.apply(null, [1, 2, 3]) === 6;
</code></pre>
<h2><a id="user-content-proxying-a-function-object" class="anchor" href="#proxying-a-function-object" aria-hidden="true"></a>Proxying a function object</h2>
<p>ES6:</p>
<pre><code>var target = function () {
  return 'I am the target';
};

var handler = {
  apply: function (receiver, ...args) {
    return 'I am the proxy';
  }
};

var p = new Proxy(target, handler);
console.log(p() === 'I am the proxy');
// -&gt; true
</code></pre>
<p>ES5:</p>
<p>No proxy in ES5, hard to intercept <strong>noSuchMethod</strong> and others.</p>
<h2><a id="user-content-array-like-object-to-array" class="anchor" href="#array-like-object-to-array" aria-hidden="true"></a>Array-like object to array</h2>
<p><strong>Array.from</strong> converts a single argument that is an array-like object or list (eg. <code>arguments</code>, <code>NodeList</code>, <code>DOMTokenList</code> (used by <code>classList</code>), <code>NamedNodeMap</code> (used by attributes property) into a new Array() and returns it.</p>
<p>ES6:</p>
<pre><code>var listFriends = function() {
  var friends = Array.from(arguments);
  friends.forEach(friend =&gt; {
    console.log(friend);
  });
};
listFriends('ann', 'bob');
// -&gt; 'ann'
// -&gt; 'bob'


var divs = document.querySelectorAll('div');
Array.from(divs).forEach(node =&gt; {
    console.log(node);
});
// -&gt; &lt;div&gt;...&lt;/div&gt;
// -&gt; &lt;div&gt;...&lt;/div&gt;
</code></pre>
<p>ES5:</p>
<pre><code>var listFriends = function() {
  var friends = [].slice.call(arguments)
  friends.forEach(function(friend) {
    console.log(friend);
  });
};
listFriends('ann', 'bob');
// -&gt; 'ann'
// -&gt; 'bob'


var divsArray = [].slice.call(document.querySelectorAll('div'));
divsArray.forEach(function(node) {
    console.log(node);
});
// -&gt; &lt;div&gt;...&lt;/div&gt;
// -&gt; &lt;div&gt;...&lt;/div&gt;
</code></pre>
</article>
					</div>
				</article>
				<!--================= END :: Tutorial =================-->
				
				<!--================= START :: Tutorial =================-->
				<article>
					<a id="t-50" name="t-50"></a><h1>50 : JavaScript Inheritance Done Right</h1>
					<span class="ref-site">https://ncombo.wordpress.com/2013/07/11/javascript-inheritance-done-right/</span>
					<div class="tutorial__content">
<div class="entry-content">
					<p>One of the worst (and possibly also one of the best) things about JavaScript is that it offers you many ways to do anything. Some tricks are simple and neat while others can be complex and confusing.</p>
<p>If you have done some research, you will likely have come across many ways of implementing inheritance in JavaScript. I have personally used a lot of variations over time in various projects but it's not until recently that I have settled on a particular technique.</p>
<p>I have chosen this particular technique because I feel that it most closely resembles how most OO programming languages implement inheritance. To get it to work properly, you should use the prototype-based method of class definition. Here is an example of the technique in action:</p>
<blockquote><p>
function BaseClass(name) {<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="skimlinks-unlinked">this.name</span> = name;<br>
}</p>
<p><span class="skimlinks-unlinked">BaseClass.prototype.foo</span> = function (arg) {<br>
&nbsp;&nbsp;&nbsp;&nbsp;return 'This is the foo method with argument: ' + arg;<br>
};</p>
<p>function SubClass(name) {<br>
&nbsp;&nbsp;&nbsp;&nbsp;// Call the base class' constructor.<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="skimlinks-unlinked">BaseClass.call(this</span>, name);<br>
}</p>
<p>// SubClass' prototype is based on BaseClass' prototype<br>
SubClass.prototype = Object.create(BaseClass.prototype);</p>
<p><span class="skimlinks-unlinked">SubClass.prototype.sub</span> = function () {<br>
&nbsp;&nbsp;&nbsp;&nbsp;return 'This is the sub method.'<br>
}</p>
<p><span class="skimlinks-unlinked">SubClass.prototype.foo</span> = function (arg) {<br>
&nbsp;&nbsp;&nbsp;&nbsp;// Call the base class foo method on the current instance<br>
&nbsp;&nbsp;&nbsp;&nbsp;return <span class="skimlinks-unlinked">BaseClass.prototype.foo.call(this</span>, arg) + ' SUB';<br>
}</p></blockquote>
<p>Ok, so what stands out the most in this code is this line:</p>
<blockquote><p>SubClass.prototype = Object.create(BaseClass.prototype);</p></blockquote>
<p>When you define a function in JavaScript, initially, its prototype will be an empty object. What we're doing here is setting the SubClass' prototype to be a new instance which shares the BaseClass' prototype. Effectively, this allows us to freely modify the SubClass' extended prototype without messing with the BaseClass' prototype – The advantage of this technique over simply cloning the prototype is that changes in the BaseClass prototype will still be reflected in the SubClass (but not the other way around). The best way to think about the Object.create() method is that it instantiates a class based on a prototype without actually going through its constructor. The Object.create() function may not be supported by older browsers, but thankfully there is a simple polyfill which you can get from this page:<br>
<a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/create">https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/create</a></p>
<p>The second weird thing about the code above is this line:</p>
<p><span class="skimlinks-unlinked">BaseClass.call(this</span>, name);</p>
<p>Now if you don't know what call or apply do, you should check this:<br>
<a href="http://stackoverflow.com/questions/1986896/what-is-the-difference-between-call-and-apply">http://stackoverflow.com/questions/1986896/what-is-the-difference-between-call-and-apply</a></p>
<p>OO languages usually offer a way to explicitly call a super class' constructor or method, JavaScript is no exception. With JavaScript, you just call the constructor/method using either call() or apply() and pass a reference to the current instance as the first argument. This is a neat feature of JavaScript which allows you to effectively borrow methods from any other class to use on the current instance.</p>
<p>If you're used to languages like Java, C# and Python, you might find the class definitions above unusual – In these languages you have an explicit 'class' keyword and you define the methods INSIDE the class block. If however, you have written C++ before, this might seem a little less confusing because C++ allows you to define methods of a class outside of the class definition block.&nbsp;While JavaScript does let you define methods inside the constructor's function block, this makes inheritance more difficult to achieve and I would strongly recommend that you follow the technique above (I swear you won't regret it).</p>
										</div>
					</div>
				</article>
				<!--================= END :: Tutorial =================-->
				
				<!--================= START :: Tutorial =================-->
				<article>
					<a id="t-51" name="t-51"></a><h1>51 : Javascript Inheritance Done Right</h1>
					<span class="ref-site">http://js-bits.blogspot.com/2010/08/javascript-inheritance-done-right.html</span>
					<div class="tutorial__content">
<div class="post-body entry-content" id="post-body-578868776986553481" itemprop="description articleBody">
I've seen a number of different ways of implementing Javascript inheritance. The real test to see if inheritance is working correctly is that the instanceof operator works correctly. So all the approaches that <a href="http://www.sitepoint.com/blogs/2006/01/17/javascript-inheritance/">copy methods</a> from the base to the subclass are out of the question because they do not correctly setup the prototype chain. Another consequence of inheritance by copying is that if you change the prototype after the object has been instantiated, the object does not magically inherit the added property. <br>
<br>
This leads me to the most common approach which does correctly set up prototype chain but has a few problems:<br>
<br>
<div><pre><code>function Animal(name) {
&nbsp;&nbsp;this.name = name;
}
&nbsp;
// This style of setting the prototype to an object
// works for classes that inherit from Object.
Animal.prototype = {
&nbsp;&nbsp;sayMyName: function() {
&nbsp;&nbsp;&nbsp;&nbsp;console.log(this.getWordsToSay() + " " + this.name);
&nbsp;&nbsp;},
&nbsp;&nbsp;getWordsToSay: function() {
&nbsp;&nbsp;&nbsp;&nbsp;// Abstract
&nbsp;&nbsp;}
}
&nbsp;
function Dog(name) {
&nbsp;&nbsp;// Call the parent's constructor
&nbsp;&nbsp;Animal.call(this, name);
}
&nbsp;
// Setup the prototype chain mmm... calling
// the Animal without the required params?
Dog.prototype = new Animal();
&nbsp;
Dog.prototype.getWordsToSay = function(){
&nbsp;&nbsp;return "Ruff Ruff";
}
&nbsp;
var dog = new Dog("Lassie");
dog.sayMyName(); // Outputs Ruff Ruff Lassie
console.log(dog instanceof Animal); // true
console.log(dog.constructor); // Animal ???? That's not right
console.log("name" in Dog.prototype)// true, but undefined
</code></pre></div><br>
Alright, what's going on?<br>
<ul><li>Dog.prototype now has a property called "name" that is set to undefined. <br>
That wasn't intentional. I knew that call to Animal's constructor was funny. Though that won't cause a problem, because we add a "name" to the object in the constructor, it's not very elegant</li>
<li>dog (the instance) has a constructor property but it points to Animal,<br>
that's just wrong</li>
</ul><br>
How can we fix that? Here's a first try<br>
<br>
<div><pre><code>// This is a constructor that is used to setup inheritance without
// invoking the base's constructor. It does nothing, so it doesn't
// create properties on the prototype like our previous example did
function surrogateCtor() {}
&nbsp;
function extend(base, sub) {
&nbsp;&nbsp;// Copy the prototype from the base to setup inheritance
&nbsp;&nbsp;surrogateCtor.prototype = base.prototype;
&nbsp;&nbsp;// Tricky huh?
&nbsp;&nbsp;sub.prototype = new surrogateCtor();
&nbsp;&nbsp;// Remember the constructor property was set wrong, let's fix it
&nbsp;&nbsp;sub.prototype.constructor = sub;
}
&nbsp;
// Let's try this
function Animal(name) {
&nbsp;&nbsp;this.name = name;
}
&nbsp;
Animal.prototype = {
&nbsp;&nbsp;sayMyName: function() {
&nbsp;&nbsp;&nbsp;&nbsp;console.log(this.getWordsToSay() + " " + this.name);
&nbsp;&nbsp;},
&nbsp;&nbsp;getWordsToSay: function() {
&nbsp;&nbsp;&nbsp;&nbsp;// Abstract
&nbsp;&nbsp;}
}
&nbsp;
function Dog(name) {
&nbsp;&nbsp;// Call the parent's constructor
&nbsp;&nbsp;Animal.call(this, name);
}
&nbsp;
// Setup the prototype chain the right way
extend(Animal, Dog);
&nbsp;
Dog.prototype.getWordsToSay = function(){
&nbsp;&nbsp;return "Ruff Ruff";
}
&nbsp;
var dog = new Dog("Lassie");
dog.sayMyName(); // Outputs Ruff Ruff Lassie
console.log(dog instanceof Animal); // true
console.log(dog.constructor); // Dog
console.log("name" in Dog.prototype)// false
</code></pre></div><br>
Nice isn't it? Let's add some syntactic sugar to make it more user friendly.<br>
<ul><li>Add a reference to the base class so we don't have to hard code it</li>
<li>Pass the object's prototype methods into the call</li>
</ul><br>
<br>
<div><pre><code>function surrogateCtor() {}
&nbsp;
function extend(base, sub, methods) {
&nbsp;&nbsp;surrogateCtor.prototype = base.prototype;
&nbsp;&nbsp;sub.prototype = new surrogateCtor();
&nbsp;&nbsp;sub.prototype.constructor = sub;
&nbsp;&nbsp;// Add a reference to the parent's prototype
&nbsp;&nbsp;sub.base = base.prototype;
&nbsp;
&nbsp;&nbsp;// Copy the methods passed in to the prototype
&nbsp;&nbsp;for (var name in methods) {
&nbsp;&nbsp;&nbsp;&nbsp;sub.prototype[name] = methods[name];
&nbsp;&nbsp;}
&nbsp;&nbsp;// so we can define the constructor inline
&nbsp;&nbsp;return sub;
}
&nbsp;
// Use the same animal from above
function Dog(name) {
&nbsp;&nbsp;// Call the parent's constructor without hard coding the parent
&nbsp;&nbsp;Dog.base.constructor.call(this, name);
}
&nbsp;
extend(Animal, Dog, {
&nbsp;&nbsp;getWordsToSay: function(){
&nbsp;&nbsp;&nbsp;&nbsp;return "Ruff Ruff";
&nbsp;&nbsp;}
});
</code></pre></div><br>
One more step, I don't even like hard coding the name of the class in the methods in case I rename it, how can we fix that?<br>
<br>
The solution is to wrap everything in a self executing function and create a reference to the constructor<br>
<br>
<div><pre><code>Dog = (function(){
&nbsp;&nbsp;// $this refers to the constructor
&nbsp;&nbsp;var $this = function (name) {
&nbsp;&nbsp;&nbsp;&nbsp;// Look, no hardcoded reference to this class's name
&nbsp;&nbsp;&nbsp;&nbsp;$this.base.constructor.call(this, name);
&nbsp;&nbsp;};
&nbsp;
&nbsp;&nbsp;extend(Animal, $this, {
&nbsp;&nbsp;&nbsp;&nbsp;getWordsToSay: function(){
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return "Ruff Ruff";
&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;});
&nbsp;
&nbsp;&nbsp;return $this;
})();
</code></pre></div><br>
With this final approach, renaming the class or changing its parent requires changing a single place (for each change).

<h3>Update</h3>
<p>This article was written a while ago, when <a href="">Object.create</a> wasn't as well supported. The extend function could be simplified to be</p>
<div><pre><code>function extend(base, sub, methods) {
&nbsp;&nbsp;sub.prototype = Object.create(base.prototype);
&nbsp;&nbsp;sub.prototype.constructor = sub;
&nbsp;&nbsp;sub.base = base.prototype;
&nbsp;
&nbsp;&nbsp;// Copy the methods passed in to the prototype
&nbsp;&nbsp;for (var name in methods) {
&nbsp;&nbsp;&nbsp;&nbsp;sub.prototype[name] = methods[name];
&nbsp;&nbsp;}
&nbsp;&nbsp;// so we can define the constructor inline
&nbsp;&nbsp;return sub;
}
</code></pre></div><br>

</div>
					</div>
				</article>
				<!--================= END :: Tutorial =================-->
				
				<!--================= START :: Tutorial =================-->
				<article>
					<a id="t-52" name="t-52"></a><h1>52 : Basic Inheritance with JavaScript Constructors</h1>
					<span class="ref-site">http://adripofjavascript.com/blog/drips/basic-inheritance-with-javascript-constructors.html</span>
					<div class="tutorial__content">
<div class="post">
<p>We've looked before at using JavaScript's constructors to create our own custom object types. But what we didn't look at was how we can create an inheritance hierarchy.</p>

<p>It's important to note that even though constructors are often referred to as "classes," they really aren't the same thing as classes in other languages. In JavaScript, a constructor is just a function invoked by the <code>new</code> operator which builds a new object.</p>

<p>Here's a little refresher:</p>
<pre><code>function SuperHuman (name, superPower) {
    this.name = name;
    this.superPower = superPower;
}

SuperHuman.prototype.usePower = function () {
    console.log(this.superPower + "!");
};

var banshee = new SuperHuman("Silver Banshee", "sonic wail");

// Outputs: "sonic wail!"
banshee.usePower();
</code></pre>
<p>The <code>SuperHuman</code> constructor contains our initialization logic, while <code>SuperHuman.prototype</code> contains the methods that are shared across all <code>SuperHuman</code> instances.</p>

<p>But suppose that we want to create a new type which inherits from <code>SuperHuman</code> while adding its own functionality? What would that look like?</p>
<pre><code>function SuperHero (name, superPower) {
    this.name = name;
    this.superPower = superPower;
    this.allegiance = "Good";
}

SuperHero.prototype.saveTheDay = function () {
    console.log(this.name + " saved the day!");
};

var marvel = new SuperHero("Captain Marvel", "magic");

// Outputs: "Captain Marvel saved the day!"
marvel.saveTheDay();
</code></pre>
<p>While this gets us started, there are a couple of problems. First of all, the <code>SuperHero</code> constructor is repeating some of the logic of the <code>SuperHuman</code> constructor. And more importantly, at this point instances of <code>SuperHero</code> don't have access to <code>SuperHuman</code> methods. For example:</p>
<pre><code>// TypeError: Object &lt;#SuperHero&gt; has no method 'usePower'
marvel.usePower();
</code></pre>
<p>Let's fix those couple of issues.</p>
<pre><code>function SuperHero (name, superPower) {
    // Reuse SuperHuman initialization
    SuperHuman.call(this, name, superPower);

    this.allegiance = "Good";
}

SuperHero.prototype = new SuperHuman();

SuperHero.prototype.saveTheDay = function () {
    console.log(this.name + " saved the day!");
};

var marvel = new SuperHero("Captain Marvel", "magic");

// Outputs: "Captain Marvel saved the day!"
marvel.saveTheDay();

// Outputs: "magic!"
marvel.usePower();
</code></pre>
<p>We've managed to eliminate the repeated constructor logic by calling <code>SuperHuman</code> with <code>SuperHero</code>'s <code>this</code> object and passing along the necessary arguments. That ensures that <code>SuperHuman</code>'s initialization logic will act on the new <code>SuperHero</code> object. And then we tack on the additional logic that is specific to <code>SuperHero</code>.</p>

<p>But where the inheritance comes in is on <code>SuperHero.prototype</code>. In order to ensure that it inherits the methods from <code>SuperHuman.prototype</code>, we actually make it an instance of <code>SuperHuman</code> with <code>new SuperHuman()</code>.</p>

<p>This basic inheritance pattern won't always work, particularly if the parent constructor is complex, but it will handle simple situations quite well.</p>

<p>In future issues we'll take a look at more sophisticated ways of doing inheritance.</p>

    </div>
					</div>
				</article>
				<!--================= END :: Tutorial =================-->
				
				<!--================= START :: Tutorial =================-->
				<article>
					<a id="t-53" name="t-53"></a><h1>53 : Call and Apply for Beginners</h1>
					<span class="ref-site">http://ryanchristiani.com/call-and-apply-for-beginners/</span>
					<div class="tutorial__content">
<div class="entry">
	<p>As you advance as a junior front-end developer you will see Javascript code that looks more and more like this.</p>
<pre><code>$.when.apply(null, promiseArray)
 .then(function() {
    var data = arguments;
    ...
 });</code></pre>
<p><span id="more-885"></span></p>
<p>The <code class=" language-javascript"><span class="token punctuation">.</span>apply<span class="token punctuation">(</span><span class="token punctuation">)</span></code> and <code class=" language-javascript"><span class="token punctuation">.</span>call<span class="token punctuation">(</span><span class="token punctuation">)</span></code> methods are powerful tools in Javascript, however they can be hard to understand for a young developer, or even for a seasoned developer! The call and apply methods that people will always ask about in interviews, but when you are writing your own Javascript you can never really think of a good reason to use them, or see a need to use them. Lets break down the difference between them, and look at some practical uses for them. We will also look at some new features from ECMAScript2015 (ES6) that can help us simplify the use of these!</p>
<h3 id="i-have-already-read-this-article">I have already read this article!?</h3>
<p>There are a lot of articles out there about this concept. However recently teaching some students, there have been a few cases where <code class=" language-javascript"><span class="token punctuation">.</span>apply<span class="token punctuation">(</span><span class="token punctuation">)</span></code> has been used to really simplify things. So I wanted to write an article that has some simple break downs and examples of how to use these methods.</p>
<h2 id="scope">Scope</h2>
<p>You can't really talk about <code class=" language-javascript"><span class="token punctuation">.</span>call<span class="token punctuation">(</span><span class="token punctuation">)</span></code> and <code class=" language-javascript"><span class="token punctuation">.</span>apply<span class="token punctuation">(</span><span class="token punctuation">)</span></code> without first talking about scope in Javascript. Hopefully the concept of global and local scope is something that you understand, if it is not lets do a quick run down about how that works.</p>
<p>In Javascript if you define anything that is not inside of a function, or something without the <code class=" language-javascript"><span class="token keyword">var</span></code> keyword. This variable is considered to be global, meaning it can be accessed anywhere in your program.</p>
<pre><code>var name = "Ryan";

function sayName() {
    console.log('Hi ' + name + '!');
}
console.log(name); //Ryan
sayName(); //Hi Ryan!</code></pre>
<p>Here we created a variable outside of the function <code class=" language-javascript">sayName</code> so it is accessible inside the function as well as outside of it. If we had done something like this however:</p>
<pre><code>function sayName() {
    name = "Ryan";
    console.log('Hi ' + name + '!');
}
console.log(name); //Ryan
sayName(); //Hi Ryan!</code></pre>
<p>This would still work. Because we have created a variable without the <code class=" language-javascript"><span class="token keyword">var</span></code> keyword, it is by default a global variable. However, when you use the <code class=" language-javascript"><span class="token keyword">var</span></code> keyword and create a variable inside of a function, that is considered to be a local variable. And only accessible inside that function.</p>
<pre><code>function sayName() {
    var name = "Ryan";
    console.log('Hi ' + name + '!');
}
console.log(name); //undefined
sayName(); //Hi Ryan!</code></pre>
<p>So now <code class=" language-javascript">name</code> is scoped locally to just the <code class=" language-javascript">sayName</code> function.</p>
<p>In Javascript we have have the <code class=" language-javascript">this</code> keyword. The context that <code class=" language-javascript">this</code> refers too changes based on a few things. By default if you just open the console in your browser, <code class=" language-javascript">this</code> will refer to the global object. In the case of the browser this is the <code class=" language-javascript">window</code> object, in node it refers to a different global. </p>
<p>When we use the <code class=" language-javascript">this</code> keyword inside of an object, <code class=" language-javascript">this</code> will refer to the object itself.</p>
<pre><code>var person = {
    name: "Ryan Christiani",
    sayName: function() {
        console.log("Hi " + this.name + "!");
    }
}
person.sayName(); //Hi Ryan!</code></pre>
<p>So it is scoped just to that object. Let's see how using <code class=" language-javascript"><span class="token punctuation">.</span>call<span class="token punctuation">(</span><span class="token punctuation">)</span></code> and <code class=" language-javascript"><span class="token punctuation">.</span>apply<span class="token punctuation">(</span><span class="token punctuation">)</span></code> can help us change <code class=" language-javascript">this</code>.</p>
<h2 id="call"><code class=" language-javascript"><span class="token punctuation">.</span>call<span class="token punctuation">(</span><span class="token punctuation">)</span></code></h2>
<p>Functions in JavaScript have a method named <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function/call" target="_blank"><code class=" language-javascript"><span class="token punctuation">.</span>call<span class="token punctuation">(</span><span class="token punctuation">)</span></code></a>. It is used to call a function or method, but you are able to determine the context in which it is being called. For example. Assume we have a <code class=" language-javascript">person</code> object that just has a single property on it.</p>
<pre><code>var person = {
    name: "Ryan"
};</code></pre>
<p>Also assume we have a function called <code class=" language-javascript">sayName<span class="token punctuation">(</span><span class="token punctuation">)</span></code> that simply prints out a name property from <code class=" language-javascript">this</code>.</p>
<pre><code>function sayName() {
    console.log(this.name);
}</code></pre>
<p>Running <code class=" language-javascript">sayName<span class="token punctuation">(</span><span class="token punctuation">)</span></code> like this will not work. It will try to grab a property from the <code class=" language-javascript">window</code> object first. However if we use <code class=" language-javascript"><span class="token punctuation">.</span>call<span class="token punctuation">(</span><span class="token punctuation">)</span></code> we can pass in and specify what context we want <code class=" language-javascript">this</code> to be in our function.</p>
<pre><code>sayName.call(person); //Ryan</code></pre>
<p>Great! Now we have the power to call functions and alter the context in which they are executed on the fly!</p>
<p>With <code class=" language-javascript"><span class="token punctuation">.</span>call<span class="token punctuation">(</span><span class="token punctuation">)</span></code> we can also apply our arguments to a function. For example, lets change the <code class=" language-javascript">sayName<span class="token punctuation">(</span><span class="token punctuation">)</span></code> function to accept a parameter.</p>
<pre><code>function sayName(greetings) {
    console.log(greetings +  ' ' + this.name);
}</code></pre>
<p>Normally we could just call this function like <code class=" language-javascript">sayName<span class="token punctuation">(</span><span class="token string">'Hello'</span><span class="token punctuation">)</span></code>. However our function has no property <code class=" language-javascript">name</code>. So we have to use <code class=" language-javascript"><span class="token punctuation">.</span>call<span class="token punctuation">(</span><span class="token punctuation">)</span></code> to tell this function to use <code class=" language-javascript">person</code> as the <code class=" language-javascript">this</code> in the function, and with <code class=" language-javascript"><span class="token punctuation">.</span>call<span class="token punctuation">(</span><span class="token punctuation">)</span></code> we can tell it what arguments call uses!</p>
<pre><code>sayName.call(person,'Hello'); //Hello Ryan</code></pre>
<p>With <code class=" language-javascript"><span class="token punctuation">.</span>call<span class="token punctuation">(</span><span class="token punctuation">)</span></code> we are able to specify the context of <code class=" language-javascript">this</code> in our function, as well as the arguments we want to supply to the function. If you have more than one argument, we just add them to the <code class=" language-javascript"><span class="token punctuation">.</span>call<span class="token punctuation">(</span>context<span class="token punctuation">,</span>arg1<span class="token punctuation">,</span>arg2<span class="token punctuation">,</span>arg3<span class="token punctuation">,</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span></code>.</p>
<h2 id="apply"><code class=" language-javascript"><span class="token punctuation">.</span>apply<span class="token punctuation">(</span><span class="token punctuation">)</span></code></h2>
<p>The <code class=" language-javascript"><span class="token punctuation">.</span>apply<span class="token punctuation">(</span><span class="token punctuation">)</span></code> method is similar to <code class=" language-javascript"><span class="token punctuation">.</span>call<span class="token punctuation">(</span><span class="token punctuation">)</span></code> however it allows us to pass an array of arguments instead of one at a time. This is very useful. Lets look at a simple, but very common, example. <code class=" language-javascript">Math<span class="token punctuation">.</span>max</code> only takes a list of arguments, but maybe you are provided with an array of arguments.</p>
<pre><code>var numbers = [12,34,62,54,12];</code></pre>
<p>You could, assuming you know that the length of the array will always be the same, do something like this.</p>
<pre><code>Math.max(numbers[0],numbers[1],numbers[2],numbers[3],numbers[4]);</code></pre>
<p>However there are two things wrong with this code. One is that we are <strong>very</strong> dependent on the length of the array always being the same, what if we have one more or one less? Also we are doing a lot of writing here. And that is just no good.</p>
<p>With <code class=" language-javascript"><span class="token punctuation">.</span>apply<span class="token punctuation">(</span><span class="token punctuation">)</span></code> we can simplify this a bit more!</p>
<pre><code>Math.max.apply(null,numbers) // 62</code></pre>
<p>Using the same pattern as with <code class=" language-javascript"><span class="token punctuation">.</span>call<span class="token punctuation">(</span><span class="token punctuation">)</span></code> we specify a context to call <code class=" language-javascript">Math<span class="token punctuation">.</span>max</code> and supply the arguments. In the case of our arguments it is just our array <code class=" language-javascript">numbers</code>. Our context for this will just be <code class=" language-javascript"><span class="token keyword">null</span></code>, since we do no really care about that from <code class=" language-javascript">Math<span class="token punctuation">.</span>max</code>. Internally the JS engine will do something like this.</p>
<pre><code>Math.max(12,34,62,54,12);</code></pre>
<p>Not that exactly, but something like it. Hopefully this gives you an idea of what it is doing!</p>
<p>Lets write our own function that expects an array of arguments. It will be very simple, just to get the point across. </p>
<pre><code>function printNames() {
    for(var i = 0; i &lt; arguments.length; i++) {
        console.log(arguments[i]);
    }
}</code></pre>
<p>Here is a simple function that prints out a list of names. But WAIT! What is <code class=" language-javascript">arguments</code>?! Just like the <code class=" language-javascript">this</code> keyword every function has a special key word called <code class=" language-javascript">arguments</code>. This is an <strong>array like</strong>(more on this later) list of the arguments used to call this function. For example.</p>
<pre><code>function printArgs() {
    console.log(arguments);
}
printArgs('hey',32,'Neat'); //['hey',32,'Neat']</code></pre>
<p>Notice how in our function definition we never define parameters for our function to accept. The function we wrote earlier, <code class=" language-javascript">printNames</code> uses the same principle. Lets assume you get an array of names, again you do not know what the length will be. Using <code class=" language-javascript"><span class="token punctuation">.</span>apply<span class="token punctuation">(</span><span class="token punctuation">)</span></code> we can call this function with this array!</p>
<pre><code>printNames.apply(null,['Ryan','Kristen','Drew']);</code></pre>
<p>This will print out the names! </p>
<h3 id="agruments"><code>agruments</code></h3>
<p>Above I mentioned that <code class=" language-javascript">arguments</code> is an <strong>array like</strong> list, meaning is it not actually an array. What does that mean? Well it means we don't get all the methods you are used to from arrays. Methods like <code class=" language-javascript"><span class="token punctuation">.</span>slice<span class="token punctuation">(</span><span class="token punctuation">)</span></code>, or <code class=" language-javascript"><span class="token punctuation">.</span>splice<span class="token punctuation">(</span><span class="token punctuation">)</span></code>. If you try to call <code class=" language-javascript">arguments<span class="token punctuation">.</span>slice<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span></code>, you will get <code class=" language-markup">TypeError: arguments.slice is not a function</code>. </p>
<p>However, we have learned how to fix this already! We can use <code class=" language-javascript"><span class="token punctuation">.</span>call<span class="token punctuation">(</span><span class="token punctuation">)</span></code>. These methods from the array live on the <code class=" language-javascript">Array<span class="token punctuation">.</span>prototype</code> so in order for us to use something like slice, we need to use <code class=" language-javascript"><span class="token punctuation">.</span>call<span class="token punctuation">(</span><span class="token punctuation">)</span></code>.</p>
<pre><code>function printArgs() {
    var slicedArgs = Array.prototype.slice.call(arguments,1);
    console.log(slicedArgs);
}

printsArgs(['Ryan','Kristen','Drew']) // ['Kristen', 'Drew']</code></pre>
<p>We use <code class=" language-javascript"><span class="token punctuation">.</span>call<span class="token punctuation">(</span><span class="token punctuation">)</span></code> on <code class=" language-javascript">Array<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>slice</code>, we set <code class=" language-javascript">arguments</code> as the context of the method and provide our argument to use for <code class=" language-javascript"><span class="token punctuation">.</span>slice<span class="token punctuation">(</span><span class="token punctuation">)</span></code>! Using <code class=" language-javascript"><span class="token punctuation">.</span>call<span class="token punctuation">(</span><span class="token punctuation">)</span></code> to manipulate <code class=" language-javascript">arguments</code> is a very common pattern you will see. But let's now look at a different way of doing this!</p>
<h1 id="a-different-way"><a name="user-content-a-different-way" href="#a-different-way" class="headeranchor-link" aria-hidden="true"><span class="headeranchor"></span></a>A Different way</h1>
<p><code class=" language-javascript"><span class="token punctuation">.</span>apply<span class="token punctuation">(</span><span class="token punctuation">)</span></code> and <code class=" language-javascript">arguments</code> are great, but what if there was a better way to do this? A way that was less verbose? In ECMAScript 2015 (ES6) we get two new features. The Spread Operator and Rest Parameters. Lets look at how we can use these to do something similar to using <code class=" language-javascript"><span class="token punctuation">.</span>apply</code> and <code class=" language-javascript">arguments</code>.</p>
<h2 id="spread-operator"><a name="user-content-spread-operator" href="#spread-operator" class="headeranchor-link" aria-hidden="true"><span class="headeranchor"></span></a>Spread Operator</h2>
<p>The Spread Operator is a new feature that we can use to, well, spread our arguments. The syntax for the Spread Operator is <code class=" language-javascript"><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>arrayName</code>, consider the function below.</p>
<pre><code>var names = ['Ryan','Drew','Kristen','Wes'];
function print() {
    for(var i = 0; i &lt; arguments.length; i++) {
        console.log(arguments[i]);
    } 
}

print(...names);</code></pre>
<p>What the Spread Operator is doing, is something similar to <code class=" language-javascript"><span class="token punctuation">.</span>apply<span class="token punctuation">(</span><span class="token punctuation">)</span></code>. </p>
<pre><code>print('Ryan','Drew','Kristen','Wes');</code></pre>
<p>You can actually mix and match the use of the Spread Operator.</p>
<pre><code>var names = ['Ryan','Drew','Kristen','Wes'];
function print() {
    var nameList = Array.prototype.slice.call(arguments,1);
    for(var i = 0; i &lt; nameList.length; i++) {
        console.log(arguments[0] +  ' ' + nameList[i]);
    } 
}

print('Hello',...names);</code></pre>
<p>In this new addition to the function we use a pattern we saw earlier to store a version <code class=" language-javascript">arguments</code> into a new variable called <code class=" language-javascript">nameList</code>. We also use <code class=" language-javascript">arguments</code> to access the string <code class=" language-javascript">Hello</code> from the function call. This is getting a little out there however, there is a lot going on. We are utilizing what we learned earlier, but this can get better! </p>
<p>Before we move on I just want to point out that the Spread Operator is not a replacement for <code class=" language-javascript"><span class="token punctuation">.</span>apply<span class="token punctuation">(</span><span class="token punctuation">)</span></code> in all cases, it does not allow us to control the context of a function call, rather it helps us with arrays of values we need to supply to functions.</p>
<h2 id="rest-parameters"><a name="user-content-rest-parameters" href="#rest-parameters" class="headeranchor-link" aria-hidden="true"><span class="headeranchor"></span></a>Rest Parameters</h2>
<p>The flip side of the Spread Operator is Rest Parameters. We can use this as a solution to the array like nature of <code class=" language-javascript">arguments</code>. The syntax looks like this <code class=" language-javascript"><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>args</code>, pretty much exactly like the Spread Operator! The difference here is where you use the syntax. Let's change our function above to work with Rest Parameters.</p>
<pre><code>var names = ['Ryan','Drew','Kristen','Wes'];
function print(greetings, ...nameList) {
    for(var i = 0; i &lt; nameList.length; i++) {
        console.log(greetings +  ' ' + nameList[i]);
    } 
}

print('Hello',...names);</code></pre>
<p>Here we add the <code class=" language-javascript">greetings</code> parameter as well as this new <code class=" language-javascript"><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>nameList</code>. We now get access to an actual array in the form on <code class=" language-javascript">nameList</code>. Because of this we can change the <code class=" language-javascript"><span class="token keyword">for</span></code> loop to be an <code class=" language-javascript"><span class="token punctuation">.</span>forEach<span class="token punctuation">(</span><span class="token punctuation">)</span></code> loop, since that is an Array method!</p>
<pre><code>var names = ['Ryan','Drew','Kristen','Wes'];
function print(greetings, ...nameList) {
    nameList.forEach(function(name) {
        console.log(greetings +  ' ' + name);
    })
}

print('Hello',...names);</code></pre>
<p>That looks a little nicer!</p>
<p>For more information about these check out <a href="https://developer.mozilla.org/en/docs/Web/JavaScript/Reference/Functions/rest_parameters" target="_blank">Rest Parameters</a> and the <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Spread_operator">Spread Operator</a> on MDN. Note that these features are very new and only available in browsers that support ECMASCript 2015. However check out my post on <a href="http://ryanchristiani.com/es6es2015-easy-wins/">ES6 easy wins</a> to find out about some new features and also how you can use them today! (hint, it's <a href="https://babeljs.io" target="_blank">Babel</a>).</p>
<p>Hope that helps!</p>
				</div>
					
					</div>
				</article>
				<!--================= END :: Tutorial =================-->
				
				<!--================= START :: Tutorial =================-->
				<article>
					<a id="t-54" name="t-54"></a><h1>54 : Understanding JavaScript Constructors</h1>
					<span class="ref-site"></span>
					<div class="tutorial__content">
<div class="article-content">

                
      
      <p><em class="explanation">The following is a guest post by <a href="http://eloux.com/">Faraz Kelhini</a>. Some of this stuff is out of my comfort zone, so I asked <a href="http://getify.me/">Kyle Simpson</a> to tech check it for me. Kyle's answer (which we did during an <a href="https://css-tricks.com/lodge/office-hours/">Office Hours</a> session) was very interesting. It was: 1) This article is technically sound. JavaScript doesn't really have classes in a traditional sense and this is the way most people shoehorn them in. 2) We may want to stop shoehorning them in. JavaScript has objects and we can use them in the way they are intended to do the same kinds of things. Kyle calls it OLOO (Objects Linked to Other Objects). <a href="http://stackoverflow.com/questions/29788181/kyle-simpsons-oloo-pattern-vs-prototype-design-pattern">Here's an intro.</a> I'd think there is value in learning about both.</em></p>
<p><span id="more-208618"></span></p>
<p>Having a good understanding of constructors is crucial to truly understand the JavaScript language. Unlike many other languages, JavaScript doesn't support classes, but it has constructors to bring similar functionality to JavaScript. In this tutorial, we will explore constructors in detail and see how JavaScript utilizes them to make objects.<br>
Constructors are like regular functions, but we use them with the "new" keyword. There are two types of constructors: native (aka built-in) constructors like <code>Array</code> and <code>Object</code>, which are available automatically in the execution environment at runtime; and custom constructors, which define properties and methods for your own type of object.</p>
<p>A constructor is useful when you want to create multiple similar objects with the same properties and methods. It's a convention to capitalize the name of constructors to distinguish them from regular functions. Consider the following code:</p>
<pre><code>function Book() { 
  // unfinished code
} 
var myBook = new Book();</code></pre>
<p>The last line of the code creates an instance of Book and assigns it to a variable; even though the Book constructor doesn't do anything, myBook is still an instance of it. As you can see there is no difference between this function and regular functions except that we call it with the <code>new</code> keyword and the function name is capitalized.</p><div class="launchbit-ad-wrapper"><div id="bsa-ad-1" class="launchbit-ad"><a class="launchbit-in-article" href="//srv.buysellads.com/ads/click/x/GTND4237C67I62J7CTSLYKQWF6YI623UCABDPZ3JCEAI4KQUCKSI627KC6BDLKQIC6BDVK3EHJNCLSIZ" target="_blank"><img src="//assets.servedby-buysellads.com/p/manage/asset/id/37874" alt="" class="launchbit-img">See The 3 Use Cases of How Our DevOp Teams Automate Development<img src="https://www.launchbit.com/taz-pixel/11315-6651-111" border="0" height="1" width="1" style="display: none;"></a></div></div>
<h3 id="article-header-id-0" class="has-header-link"><a class="article-headline-link" href="#article-header-id-0">#</a>Determining the Type of an Instance</h3>
<p>To find out whether an object is an instance of another one, we use the instanceof operator:</p>
<pre><code>myBook instanceof Book    // true
myBook instanceof String  // false</code></pre>
<p>Note that if the right side of the instanceof operator isn't a function, it will throw an error:</p>
<pre><code>myBook instanceof {};
// TypeError: invalid 'instanceof' operand ({})</code></pre>
<p>Another way to find the type of an instance is using the constructor property. All object instances have a constructor property that point to the constructor function that created it.</p>
<p>Consider the following code fragment:</p>
<pre><code>myBook.constructor == Book;   // true</code></pre>
<p>Since the constructor property of myBook points to Book the result is true. All objects inherit a constructor property from their prototype:</p>
<pre><code>var s = new String("text");
s.constructor === String;      // true

"text".constructor === String; // true

var o = new Object();
o.constructor === Object;      // true

var o = {};
o.constructor === Object;      // true

var a = new Array();
a.constructor === Array;       // true

[].constructor === Array;      // true</code></pre>
<p>Although checking constructor property can be used to check the type of an instance, it is recommended to only use the instanceof operator for this purpose, because the constructor property might be overwritten, so it cannot be a reliable method for checking the type of an instance.</p>
<h3 id="article-header-id-1" class="has-header-link"><a class="article-headline-link" href="#article-header-id-1">#</a>Custom Constructor Functions</h3>
<p>A constructor is like a cookie cutter to make more than one object with similar features. In other words, the benefit of using a constructor is that it makes it easy to create multiple objects with the same properties and methods.</p>
<p>Consider the following code:</p>
<pre><code>function Book(name, year) {
  this.name = name;
  this.year = '(' + year + ')';
}</code></pre>
<p>The book constructor expects two parameters: <code>name</code> and <code>year</code>; when it is called with the <code>new</code> keyword it assigns the received parameters to the name and year property of the current instance so the constructor can be used to create objects with initialized <code>name</code> and <code>year</code> properties: </p>
<pre><code>var firstBook = new Book("Pro AngularJS", 2014);
var secondBook = new Book("Secrets Of The JavaScript Ninja", 2013); 
var thirdBook = new Book("JavaScript Patterns", 2010);
 
console.log(firstBook.name, firstBook.year);           
console.log(secondBook.name, secondBook.year);           
console.log(thirdBook.name, thirdBook.year);  </code></pre>
<p>This code logs the following in the console:</p>
<figure id="post-208619" class="align-right media-208619"><img sizes="(min-width: 1850px) calc( (100vw - 555px) / 3 )
       (min-width: 1251px) calc( (100vw - 530px) / 2 )
       (min-width: 1086px) calc(100vw - 480px)
       (min-width: 626px)  calc(100vw - 335px)
                           calc(100vw - 30px)" srcset="https://cdn.css-tricks.com/wp-content/uploads/2015/09/console-log.png 744w, https://cdn.css-tricks.com/wp-content/uploads/2015/09/console-log-300x68.png 300w" src="//cdn.css-tricks.com/wp-content/uploads/2015/09/console-log.png" alt=""></figure>
<p>As you can see, we can quickly build a large number of different book objects by invoking the Book constructor with different arguments. This is exactly the same pattern that JavaScript uses in its built-in constructors like <code>Array()</code> and <code>Date()</code>.</p>
<h3 id="article-header-id-2" class="has-header-link"><a class="article-headline-link" href="#article-header-id-2">#</a>Object.defineProperty Function</h3>
<p>The <code>Object.defineProperty()</code> can be used inside of a constructor to help perform all necessary property setup. Consider the following constructor:</p>
<pre><code>function Book(name) { 
  Object.defineProperty(this, "name", { 
      get: function() { 
        return "Book: " + name;       
      },        
      set: function(newName) {            
        name = newName;        
      },               
      configurable: false     
   }); 
}

var myBook = new Book("Single Page Web Applications");
console.log(myBook.name);    // Book: Single Page Web Applications

// we cannot delete the name property because "configurable" is set to false
delete myBook.name;    
console.log(myBook.name);    // Book: Single Page Web Applications

// but we can change the value of the name property
myBook.name = "Testable JavaScript";
console.log(myBook.name);    // Book: Testable JavaScript</code></pre>
<p>In this code we used accessor properties inside the <code>Object.defineProperty()</code>. Accessor properties don't include any properties or methods, but they define a getter to call when the property is read, and a setter to call when the property is written to.</p>
<p>A getter is expected to return a value, while a setter receives the value being assigned to the property as an argument. This constructor allows us to set or change the name property of instances, but we are not allowed to delete it, and when we get the value of name, the getter prepends the string "Book: " to the name and returns it.</p>
<h3 id="article-header-id-3" class="has-header-link"><a class="article-headline-link" href="#article-header-id-3">#</a>Object Literal Notations are Preferred to Constructors</h3>
<p>The JavaScript language has nine built-in constructors: <code>Object()</code>, <code>Array()</code>, <code>String()</code>, <code>Number()</code>, <code>Boolean()</code>, <code>Date()</code>, <code>Function()</code>, <code>Error()</code> and <code>RegExp()</code>. When creating values we are free to use either object literals or constructors, but object literals are not only easier to read but also faster to run because they can be optimize at parse time. Whenever we need simple objects it's best to stick with literals:</p>
<pre><code>// a number object
// numbers have a toFixed() method
var obj = new Object(5);
obj.toFixed(2);     // 5.00

// we can achieve the same result using literals
var num = 5;
num.toFixed(2);     // 5.00

// a string object
// strings have a slice() method 
var obj = new String("text");
obj.slice(0,2);     // "te"

// same as above
var string = "text";
string.slice(0,2);  // "te"</code></pre>
<p>As you can see there's hardly any difference between these object literals and constructors and we can still call methods on literals. It's because when we call a method on a literal, behind the scene JavaScript converts the literal to a temporary object so that it's possible to use object methods for primitive values, then JavaScript discards the temporary object. </p>
<h3 id="article-header-id-4" class="has-header-link"><a class="article-headline-link" href="#article-header-id-4">#</a>Using the "new" Keyword is Essential</h3>
<p>It's important to remember to use the <code>new</code> keyword before all constructors, if we accidentally forget "new" we will be modifying the global object instead of the newly created object. Consider the following example:</p>
<pre><code>function Book(name, year) {
  console.log(this);
  this.name = name;
  this.year = year;
}

var myBook = Book("js book", 2014);  
console.log(myBook instanceof Book);  
console.log(window.name, window.year);

var myBook = new Book("js book", 2014);  
console.log(myBook instanceof Book);  
console.log(myBook.name, myBook.year);</code></pre>
<p>When we call the Book constructor without <code>new</code> keyword, in fact we are just calling a function without a return statement and "this" inside the Book constructor will be equal to Window (instead of myBook), in other words we have unintentionally created two global variables which causes the code to produce unintended results, but when we call the function with the "new" keyword the context is switched from global (window) to the instance, therefore "this" points to myBook. Here is what the above code logs in browser console:</p>
<figure id="post-208621" class="align-right media-208621"><img sizes="(min-width: 1850px) calc( (100vw - 555px) / 3 )
       (min-width: 1251px) calc( (100vw - 530px) / 2 )
       (min-width: 1086px) calc(100vw - 480px)
       (min-width: 626px)  calc(100vw - 335px)
                           calc(100vw - 30px)" srcset="https://cdn.css-tricks.com/wp-content/uploads/2015/09/console-log-2.png 766w, https://cdn.css-tricks.com/wp-content/uploads/2015/09/console-log-2-300x91.png 300w" src="//cdn.css-tricks.com/wp-content/uploads/2015/09/console-log-2.png" alt=""></figure>
<p>Note that in strict mode this code throws an error because strict mode protects us from accidentally calling a constructor without the <code>new</code> keyword.</p>
<h3 id="article-header-id-5" class="has-header-link"><a class="article-headline-link" href="#article-header-id-5">#</a>Scope-Safe Constructors</h3>
<p>Since a constructor is just a function, it can be called without the <code>new</code> keyword, but this leads to unexpected results and errors especially for inexperienced programmers. The solution to this problem is scope-safe constructors.  We can call Scope-safe constructors with or without new keyword and they return the same result in either form.</p>
<p>Most of built-in constructors, such as Object, Regex and Array, are scope-safe. They use a pattern to determine whether the constructor is called with <code>new</code> or not.</p>
<p>If new isn't used, a proper instance of the object is created by calling the constructor again with <code>new</code> keyword. Consider the following code:</p>
<pre><code>function Book(name) { 
  if (!(this instanceof Book)) { 
    
    // the constructor was called without "new".
    return new Book(name);
  } 
}</code></pre>
<p>So using this pattern we can easily rewrite a scope-safe version of our constructor:</p>
<pre><code>function Book(name, year) { 
  if (!(this instanceof Book)) { 
    return new Book(name, year);
  }
  this.name = name;
  this.year = year;
}

var person1 = new Book("js book", 2014);
var person2 = Book("js book", 2014);
console.log(person1 instanceof Book);    // true
console.log(person2 instanceof Book);    // true</code></pre>
<p>The fact that "this" is an instance of the custom type allows us to determine if <code>new</code> is not used as soon as the constructor begins to execute and run the constructor again with <code>new</code> keyword.</p>
<h3 id="article-header-id-6" class="has-header-link"><a class="article-headline-link" href="#article-header-id-6">#</a>Conclusion</h3>
<p>JavaScript has no class statement, which is baffling for coders who are used to languages with a class statement; However, JavaScript has constructors to bring similar functionality. Constructors are just regular functions which are used with <code>new</code> keyword. They come in handy when we need to make multiple similar objects with the same properties and methods.</p>
     
    </div>
					</div>
				</article>
				<!--================= END :: Tutorial =================-->
				
				<!--================= START :: Tutorial =================-->
				<article>
					<a id="t-55" name="t-55"></a><h1>55 : Functions as First Class Citizens in Javascript</h1>
					<span class="ref-site">http://ryanchristiani.com/functions-as-first-class-citizens-in-javascript/</span>
					<div class="tutorial__content">
<div class="entry">
					<p>In Javascript we are lucky. We get the ability to pass functions around, our functions can even return functions. And this is great. As a teacher, one thing I find is that this idea confuses people learning the language. Functions are a bit of an abstract concept. So I wanted to go over a few things we can do with functions in regards to passing them around and playing with them! </p>
<p>This is focused for people just learning the language. Yet if you have been writing JS for a while, you might learn a thing of two as well!</p>
<p><span id="more-855"></span></p>
<h2 id="first-class-citizens"><a name="user-content-first-class-citizens" href="#first-class-citizens" class="headeranchor-link" aria-hidden="true"><span class="headeranchor"></span></a>First Class Citizens?!</h2>
<p>In programming languages, when you are able to pass, return and assign a type, that type is considered to be a first class citizen <cite><a href="https://en.wikipedia.org/wiki/First-class_citizen" target="_blank">[source]</a></cite>. This is one reason Javascript is becoming a popular destination for functional programming. Since we are able to create functions that can accept functions as well as return functions. This allows us to create Higher Order Functions. Higher Order Functions are functions that accept a function, and/or return a function <cite><a href="https://en.wikipedia.org/wiki/Higher-order_function" target="_blank">[source]</a></cite>.</p>
<p>Types inside of Javascript are first class citizens, we are able to assign, pass and return all the different types in JS.</p>
<h2 id="assigning-functions"><a name="user-content-assigning-functions" href="#assigning-functions" class="headeranchor-link" aria-hidden="true"><span class="headeranchor"></span></a>Assigning functions.</h2>
<p>In Javascript we can assign a function to a variable in many ways.</p>
<h3 id="using-var"><a name="user-content-using-var" href="#using-var" class="headeranchor-link" aria-hidden="true"><span class="headeranchor"></span></a>Using var</h3>
<pre><code>var myFunction = function() {
    //...function body here 
};</code></pre>
<p>A common pattern is to define a function using the <code class=" language-javascript"><span class="token keyword">var</span></code> keyword to store a function in a variable. We use an anonymous function here, but you could also use a named function if you desired.</p>
<pre><code>var myFunction = function functionName() {
    //...function body here 
};</code></pre>
<p>This will give you a reference to the function inside of the function, useful for recursion. It allows you to call the function inside of itself!</p>
<pre><code>var myFunction = function functionName(n) {
    if(n &lt; 10)   {
        n++;
        ...some code
        functionName(n);
    }
};</code></pre>
<h3 id="methods"><a name="user-content-methods" href="#methods" class="headeranchor-link" aria-hidden="true"><span class="headeranchor"></span></a>Methods</h3>
<p>Assigning a method in Javascript is super easy as well. Similar to how we can assign a function to a variable we can assign a function as a value to a key in an object.</p>
<pre><code>var warrior = {
    hp: 100,
    strength: 20,
    attack: function(target) {
        target.hp -= this.strength;
    }
}</code></pre>
<p>One thing to remember here is that when we create a function like:</p>
<pre><code>var add = function(a,b) {
    return a + b;
}</code></pre>
<p>The value stored inside the <code class=" language-javascript">add</code> variable is a function, so we can pass that value around without calling the function.</p>
<pre><code>var newAdd = add;
newAdd(2,3) //5</code></pre>
<h2 id="passing-functions"><a name="user-content-passing-functions" href="#passing-functions" class="headeranchor-link" aria-hidden="true"><span class="headeranchor"></span></a>Passing functions.</h2>
<p>Since functions are first class citizens in Javascript, we are able to pass them. A common use case as a beginner might be something like this. Lets assume we have some sort of analytics we need to preform on various types of events.</p>
<p>You could do something like this.</p>
<pre><code>$('form').on('submit',function() {
    //perform some analytics.
});

$('a[href$=".pdf"]').on('click', function() {
    //perform same analytics.
});</code></pre>
<p>There is a bit of repetition here, and we want to prevent that as much as possible. With the ability to pass functions, we can reduce repetition, and pass one function to be run when the user interacts with those elements.</p>
<pre><code>function analyticsHandler(e) {
    ...//perform some analytics.
}

$('form').on('submit',analyticsHandler);

$('a[href$=".pdf"]').on('click',analyticsHandler);</code></pre>
<p>This way, jQuery will just see the function as a value and call it when the event is fired. Which, if you think about it, is all you are doing when you provide a callback function.</p>
<pre><code>$('a').on('click', function() {
    //...
});</code></pre>
<p>Internally jQuery will call the callback function when it sees that the <code class="language-html">&lt;a&gt;</code> tag is clicked. In our <code class=" language-javascript">analyticsHandler</code> example, we are simply storing the function in an easy to use variable for later use. And it is helping us keep things DRY.</p>
<h2 id="returning-functions"><a name="user-content-returning-functions" href="#returning-functions" class="headeranchor-link" aria-hidden="true"><span class="headeranchor"></span></a>Returning functions.</h2>
<p>Something else we will look at is returning functions from functions. This can be a powerful concept if you master it, and this is a key concept when it comes to functional programming. </p>
<p>Consider the process of writing a gulp file. We use the <code class="langauge-javascript">require</code> statement from Node.js to get scripts into our file. </p>
<pre><code>var cssNext = require('gulp-cssnext');</code></pre>
<p>When you write module in Node you are able to return multiple things, however it is fairly common to simply return a function. That is why when you require something, especially a gulp plug in, you have to able to call that function later, the value returned from the <code class=" language-javascript">require</code> call is a function.</p>
<p>Here is an example from the <a href="https://github.com/cssnext/gulp-cssnext">gulp-cssnext</a> plug-in.</p>
<pre><code>module.exports = function(options) {
  return through.obj(transform(options))
}</code></pre>
<p>
This is a line from <a href="https://github.com/cssnext/gulp-cssnext/blob/master/index.js#L39-L41">index.js</a> in gulp-cssnext. They use <code class="langauge-javascript">module.exports</code> to return a function, which itself returns the results of a function call. This way we can use the returned function in our gulp files like this.</p>
<pre><code>gulp.task('css',function() {
    gulp.src('*.css')
        .pipe(cssnext())
        .pipe(dist.);
});</code></pre>
<p>A common pattern you will see when working with a Node app, especially an <a href="http://expressjs.com/">express</a> app is a line similar to this.</p>
<pre><code>var app = require('express')();</code></pre>
<p>In express you need to require it and then execute the function to create your express application. It is very common to shorten this process down to one line.</p>
<p>Another place you will see this is when using postcss. In postcss you require all of your packs in the postcss module, like this:</p>
<pre><code>postcss([ require('cssnext')(), require('cssnano')() ])</code></pre>
<p>Note the cssnext referred to here is not the gulp-cssnext plugin, but to original <a href="http://cssnext.io/" target="_blank">cssnext</a> package. In this implementation the cssnext package returns a function, that when run, sets itself up to work with postcss.</p>
<h3 id="partial-application"><a name="user-content-partial-application" href="#partial-application" class="headeranchor-link" aria-hidden="true"><span class="headeranchor"></span></a>Partial application</h3>
<p>Another common use for returning a function, is for partial application. Partial application is used to set up a function that returns a function. Calling the first function saves the first argument or arguments that were passed in. What?! Let's look at a simple example.</p>
<p>Example:</p>
<pre><code>function add(a) {
    return function(b) {
        return a + b;
    }   
}</code></pre>
<p>This function takes an <code class=" language-javascript">a</code> parameter and returns a function that will then take the second parameter <code class=" language-javascript">b</code>. The <code class=" language-javascript">a</code> is remembered inside of the second function because of the <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Closures" target="_blank">closure</a> that the returned function created. Lets look at an example of how to use it.</p>
<pre><code>var add5 = add(5);</code></pre>
<p>The value now saved in <code>add5</code> is the function. Inside of that function it references <code class=" language-javascript">a</code> and it remembers that because when it was created, <code class=" language-javascript">a</code> was available to it.</p>
<pre><code>function(b) {
    return a + b;
}</code></pre>
<p>What way we can go ahead and call it with new values that will always add 5 to the new value.</p>
<pre><code>add5(5); // 10
add5(8); // 13</code></pre>
<p>For a more in depth article on partial application and currying check out this article by <a href="http://www.datchley.name/currying-vs-partial-application/" target="_blank">Dave Atchley</a> and this one by <a href="https://medium.com/javascript-scene/curry-or-partial-application-8150044c78b8" target="_blank">Eric Elliott</a>.</p>
<p>Javascript is a powerful fun language to learn and work with, and with functions as first class citizens we are very lucky! I hope this helped with your understanding of functions, learning a language like Javascript can be draughting to a beginner, but with practice you can start to chip away at it! </p>
				</div>
					</div>
				</article>
				<!--================= END :: Tutorial =================-->
				
				<!--================= START :: Tutorial =================-->
				<article>
					<a id="t-56" name="t-56"></a><h1>56 : Quick Tip: How JavaScript References Work</h1>
					<span class="ref-site">https://www.sitepoint.com/how-javascript-references-work/</span>
					<div class="tutorial__content">
<div class="ArticleCopy language-javascript">
      

<p><strong>TL;DR:</strong> There are NO pointers in JavaScript and references work differently from what we would normally see in most other popular programming languages. In JavaScript, it's just NOT possible to have a reference from one variable to another variable. And, only compound values (e.g.. Object or Array) can be assigned by reference.</p>

<blockquote>
<p>The following terms are used throughout the article:</p>
<ul>
<li>scalar –  a singe value or unit of data (e.g. integer, boolean, string)</li>
<li>compound – comprised of multiple values (e.g. array, object, set)</li>
<li>primitive – a direct value, as opposed to a reference to something that contains the real value. </li>
</ul>
<p>JavaScript's scalar types are primitives, but some languages, such as Ruby, have scalar reference types. Note that in JavaScript, the scalar primitive values are immutable while compound values are mutable.</p>
</blockquote>
<h2 id="bottomline">Bottom Line:</h2>
<ol>
<li>The <code class=" language-javascript"><span class="token keyword">typeof</span></code> value assigned to a variable decides whether the value is stored with assign-by-value or assign-by-reference.</li>
<li>On variable assignment, the scalar primitive values (Number, String, Boolean, undefined, null, Symbol) are assigned-by-value and compound values are assigned-by-reference.</li>
<li>The references in JavaScript only point at contained values and NOT at other variables, or references.</li>
<li>In JavaScript, scalar primitive values  are immutable and compound values are mutable.</li>
</ol>
<h2 id="quickexampleofassignbyvalue">Quick Example of Assign-by-Value:</h2>
<p>In the code snippet below, we are assigning a scalar primitive value (a number) to a variable and thus assign-by-value applies here. Firstly, the variable <code class=" language-javascript">batman</code> is initialized and when the variable <code class=" language-javascript">superman</code> is assigned with the value stored in <code class=" language-javascript">batman</code>, it creates a new copy of the value and stores it. When the variable <code class=" language-javascript">superman</code> is modified, <code class=" language-javascript">batman</code> is left unaffected, as they point to distinct values.</p>
<pre><code>var batman = 7;
var superman = batman;   //assign-by-value
superman++;
console.log(batman);     //7
console.log(superman);   //8
</code></pre>
<p><img src="https://dab1nmslvvntp.cloudfront.net/wp-content/uploads/2017/03/1488365230diagram1.png" alt="Assign-by-value example"></p>
<h2 id="quickexampleofassignbyreference">Quick Example of Assign-by-Reference:</h2>
<p>In the code snippet below, we are assigning a compound value (an array) to a variable and thus assign-by-reference applies here. The variables <code class=" language-javascript">flash</code> and <code class=" language-javascript">quicksilver</code> are references to the same value (aka shared value). The references will point to the updated value when the shared value is modified .</p>
<pre><code>var flash = [8,8,8];
var quicksilver = flash;   //assign-by-reference
quicksilver.push(0);
console.log(flash);        //[8,8,8,0]
console.log(quicksilver);  //[8,8,8,0]
</code></pre>
<p><img src="https://dab1nmslvvntp.cloudfront.net/wp-content/uploads/2017/03/1488365235diagram2.png" alt="Assign-by-reference example"></p>
<h2 id="howtocreateanewreference">How to Create a New Reference</h2>
<p>When the compound value in a variable is reassigned, a new reference is created. In JavaScript, unlike in most other popular programming languages, the references are pointers to values stored in variables and NOT pointers to other variables, or references.</p>
<pre><code>var firestorm = [3,6,3];
var atom = firestorm;   //assign-by-reference
console.log(firestorm); //[3,6,3]
console.log(atom);      //[3,6,3]
atom = [9,0,9];         //value is reassigned (create new reference)
console.log(firestorm); //[3,6,3]
console.log(atom);      //[9,0,9]
</code></pre>
<p><img src="https://dab1nmslvvntp.cloudfront.net/wp-content/uploads/2017/03/1488365240diagram3.png" alt="Creating a new reference"></p>
<h2 id="howreferencesworkwhenvaluesarepassedasfunctionparameters">How References Work When Values Are Passed as Function Parameters</h2>
<p>In the code snippet below, the variable <code class=" language-javascript">magneto</code> is a compound value (an Array), thus it is assigned to variable (function argument) <code class=" language-javascript">x</code> as a reference. </p>
<p>The <code class=" language-javascript">Array<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>push</code> method invoked inside the IIFE mutates the value in the variable <code class=" language-javascript">magneto</code> via a JavaScript reference. But, the reassignment of variable <code class=" language-javascript">x</code> creates a new reference and further modifications to it do NOT affect the reference to the variable <code class=" language-javascript">magneto</code>.</p>
<pre><code>var magneto = [8,4,8];
(function(x) {        //IIFE
    x.push(99);
    console.log(x);   //[8,4,8,99]
    x = [1,4,1];      //reassign variable (create new reference)
    x.push(88);
    console.log(x);   //[1,4,1,88]
})(magneto);
console.log(magneto); //[8,4,8,99]
</code></pre>
<h2 id="howtochangetheoriginalvalueinacompoundvariablepassedasafunctionargumentviaajavascriptreference">How to Change the Original Value in a Compound Variable, Passed as a Function Argument via a JavaScript Reference</h2>
<p>The solution here would be to modify the existing compound value that the reference is pointing to. In the code snippet below, variable <code class=" language-javascript">wolverine</code> is a compound value (an Array) and, on IIFE invocation, the variable (function argument) <code class=" language-javascript">x</code> is assigned by reference. </p>
<p>The <code class=" language-javascript">Array<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>length</code> property can be used to create an empty array by setting its value to <code class=" language-javascript"><span class="token number">0</span></code>. Thus, the variable wolverine is changed to the new value set in variable <code class=" language-javascript">x</code> via a JavaScript reference.</p>
<pre><code>var wolverine = [8,7,8];
(function(x) {              //IIFE
    x.length = 0;           //make empty array object
    x.push(1,4,7,2);
    console.log(x);         //[1,4,7,2]
})(wolverine);
console.log(wolverine);     //[1,4,7,2]
</code></pre>
<h2 id="howtostoreacompoundvaluethroughassignbyvalue">How to Store a Compound Value through Assign-by-Value</h2>
<p>The solution here would be to make a manual copy of the compound value and then assign the copied value to a variable. Therefore, the reference of assigned value does NOT point back to the original value. </p>
<p>The recommended approach to create a (shallow) copy of the compound value (Array object) is to invoke <code class=" language-javascript">Array<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>slice</code> method on it with no arguments passed.</p>
<pre><code>var cisco = [7,4,7];
var zoom = cisco.slice();  //create shallow copy
cisco.push(77,33);
console.log(zoom);         //[7,4,7]
console.log(cisco);        //[7,4,7,77,33]
</code></pre>
<p><img src="https://dab1nmslvvntp.cloudfront.net/wp-content/uploads/2017/03/1488365242diagram4.png" alt="Diagram4"></p>
<h2 id="howtostoreascalarprimitivevaluethroughassignbyreference">How to Store a Scalar Primitive Value Through Assign-by-Reference?</h2>
<p>The solution here would be to wrap scalar primitive value in a compound value (i.e. an Object or Array) as its property value. Thus, it can be assigned-by-reference. In the code snippet below, scalar primitive value in variable <code class=" language-javascript">speed</code> is set as a property on object <code class=" language-javascript">flash</code>. Therefore, it is assigned-by-reference on IIFE invocation to variable (function argument) <code class=" language-javascript">x</code>.</p>
<pre><code>var flash = { speed: 88 };
(function (x) {             //IIFE
    x.speed = 55;
})(flash);
console.log(flash.speed);   //55
</code></pre>
<h2 id="summary">Summary</h2>

<p>A good understanding of references in JavaScript can help developers to avoid many common mistakes and write better code.</p>

    </div>
					</div>
				</article>
				<!--================= END :: Tutorial =================-->
				
				
				<!--================= START :: Tutorial =================-->
				<article>
					<a id="t-57" name="t-57"></a><h1>57 : JavaScript. The core.</h1>
					<span class="ref-site">http://dmitrysoshnikov.com/ecmascript/javascript-the-core/</span>
					<div class="tutorial__content">
<div class="entry-content" itemprop="mainContentOfPage">
		
<div class="ds-toc"><ol><li><a href="#an-object" title="An object">An object</a></li><li><a href="#a-prototype-chain" title="A prototype chain">A prototype chain</a></li><li><a href="#constructor" title="Constructor">Constructor</a></li><li><a href="#execution-context-stack" title="Execution context stack">Execution context stack</a></li><li><a href="#execution-context" title="Execution context">Execution context</a></li><li><a href="#variable-object" title="Variable object">Variable object</a></li><li><a href="#activation-object" title="Activation object">Activation object</a></li><li><a href="#scope-chain" title="Scope chain">Scope chain</a></li><li><a href="#closures" title="Closures">Closures</a></li><li><a href="#this-value" title="This value">This value</a></li><li><a href="#conclusion" title="Conclusion">Conclusion</a></li></ol></div>
<p>This note is an overview and summary of the "<a href="http://dmitrysoshnikov.com/tag/ecma-262-3/">ECMA-262-3 in detail</a>" series. Every section contains references to the appropriate matching chapters so you can read them to get a deeper understanding.<span id="more-1581"></span></p>
<p>Intended audience: experienced programmers, professionals.</p>
<p>We start out by considering the concept of an <em>object</em>, which is fundamental to ECMAScript.</p>
<h2 id="an-object" class="header-link" tabindex="-1"><a href="#an-object">An object</a></h2>
<p>ECMAScript, being a highly-abstracted object-oriented language, deals with <em>objects</em>. There are also <em>primitives</em>, but they, when needed, are also converted to objects.</p>
<p class="definition">An object is a <em>collection of properties</em> and has a <em>single prototype object</em>. The prototype may be either an object or the <code>null</code> value.</p>
<p>Let's take a basic example of an object. A prototype of an object is referenced by the internal <code>[[Prototype]]</code> property. However, in figures we will use <code>__&lt;internal-property&gt;__</code> underscore notation instead of the double brackets, particularly for the prototype object: <code>__proto__</code>.</p>
<p>For the code:</p>
<div><pre><code>var foo = {
&nbsp;&nbsp;x: 10,
&nbsp;&nbsp;y: 20
};
</code></pre></div>
<p>we have the structure with two explicit <em>own</em> properties and one implicit <code>__proto__</code> property, which is the reference to the prototype of <code>foo</code>:</p>
<p><img class="aligncenter figure" src="http://dmitrysoshnikov.com/wp-content/uploads/basic-object.png" alt="Figure 1. A basic object with a prototype." title="Figure 1. A basic object with a prototype."></p>
<p class="figure">Figure 1. A basic object with a prototype.</p>
<p>What for these prototypes are needed? Let's consider a <em>prototype chain</em> concept to answer this question.</p>
<h2 id="a-prototype-chain" class="header-link"><a href="#a-prototype-chain">A prototype chain</a></h2>
<p>Prototype objects are also just simple objects and may have their own prototypes. If a prototype has a non-null reference to its prototype, and so on, this is called the <em>prototype chain</em>.</p>
<p class="definition">A prototype chain is a <em>finite</em> chain of objects which is used to implement <em>inheritance</em> and <em>shared properties</em>.</p>
<p>Consider the case when we have two objects which differ only in some small part and all the other part is the same for both objects. Obviously, for a good designed system, we would like to <em>reuse</em> that similar functionality/code without repeating it in every single object. In class-based systems, this <em>code reuse</em> stylistics is called the <em>class-based inheritance</em> — you put similar functionality into the class <code>A</code>, and provide classes <code>B</code> and <code>C</code> which inherit from <code>A</code> and have their own small additional changes.</p>
<p>ECMAScript has no concept of a class. However, a code reuse stylistics does not differ much (though, in some aspects it's even more flexible than class-based) and achieved via the <em>prototype chain</em>. This kind of inheritance is called a <em>delegation based inheritance</em> (or, closer to ECMAScript, a <em>prototype based inheritance</em>).</p>
<p>Similarly like in the example with classes <code>A</code>, <code>B</code> and <code>C</code>, in ECMAScript you create objects: <code>a</code>, <code>b</code>, and <code>c</code>. Thus, object <code>a</code> stores this common part of both <code>b</code> and <code>c</code> objects. And <code>b</code> and <code>c</code> store just their own additional properties or methods.</p>
<div><pre><code>var a = {
&nbsp;&nbsp;x: 10,
&nbsp;&nbsp;calculate: function (z) {
&nbsp;&nbsp;&nbsp;&nbsp;return this.x + this.y + z;
&nbsp;&nbsp;}
};
&nbsp;
var b = {
&nbsp;&nbsp;y: 20,
&nbsp;&nbsp;__proto__: a
};
&nbsp;
var c = {
&nbsp;&nbsp;y: 30,
&nbsp;&nbsp;__proto__: a
};
&nbsp;
// call the inherited method
b.calculate(30); // 60
c.calculate(40); // 80
</code></pre></div>
<p>Easy enough, isn't it? We see that <code>b</code> and <code>c</code> have access to the <code>calculate</code> method which is defined in <code>a</code> object. And this is achieved exactly via this prototype chain.</p>
<p>The rule is simple: if a property or a method is not found in the object itself (i.e. the object has no such an <em>own</em> property), then there is an attempt to find this property/method in the prototype chain. If the property is not found in the prototype, then a prototype of the prototype is considered, and so on, i.e. the whole prototype chain (absolutely the same is made in class-based inheritance, when resolving an inherited <em>method</em> — there we go through the <em>class chain</em>). The first found property/method with the same name is used. Thus, a found property is called <em>inherited</em> property. If the property is not found after the whole prototype chain lookup, then <code>undefined</code> value is returned.</p>
<p>Notice, that <code>this</code> value in using an inherited method is set to the <em>original</em> object, but not to the (prototype) object in which the method is found. I.e. in the example above <code>this.y</code> is taken from <code>b</code> and <code>c</code>, but not from <code>a</code>. However, <code>this.x</code> is taken from <code>a</code>, and again via the <em>prototype chain</em> mechanism.</p>
<p>If a prototype is not specified for an object explicitly, then the default value for <code>__proto__</code> is taken — <code>Object.prototype</code>. Object <code>Object.prototype</code> itself also has a <code>__proto__</code>, which is the <em>final link</em> of a chain and is set to <code>null</code>.</p>
<p>The next figure shows the inheritance hierarchy of our <code>a</code>, <code>b</code> and <code>c</code> objects:</p>
<p><img class="aligncenter figure" src="http://dmitrysoshnikov.com/wp-content/uploads/prototype-chain.png" alt="Figure 2. A prototype chain." title="Figure 2. A prototype chain."></p>
<p class="figure">Figure 2. A prototype chain.</p>
<div class="note">Notice: <abbr title="ECMAScript 5">ES5</abbr> standardized an alternative way for prototype-based inheritance using <code>Object.create</code> function:
<div><pre><code>var b = Object.create(a, {y: {value: 20}});
var c = Object.create(a, {y: {value: 30}});
</code></pre></div>
<p>You can get more info on new <abbr title="ECMAScript 5">ES5</abbr> APIs in the <a href="http://dmitrysoshnikov.com/ecmascript/es5-chapter-1-properties-and-property-descriptors/#new-api-methods">appropriate chapter</a>.</p>
<p><abbr title="ECMAScript 6">ES6</abbr> though standardizes the <code>__proto__</code>, and it can be used at initialization of objects.
</p></div>
<p>Often it is needed to have objects with the <em>same or similar state structure</em> (i.e. the same set of properties), and with different <em>state values</em>. In this case we may use a <em>constructor function</em> which produces objects by <em>specified pattern</em>.</p>
<h2 id="constructor" class="header-link"><a href="#constructor">Constructor</a></h2>
<p>Besides creation of objects by specified pattern, a <em>constructor</em> function does another useful thing — it <em>automatically sets a prototype object</em> for newly created objects. This prototype object is stored in the <code>ConstructorFunction.prototype</code> property.</p>
<p>E.g., we may rewrite previous example with <code>b</code> and <code>c</code> objects using a constructor function. Thus, the role of the object <code>a</code> (a prototype) <code>Foo.prototype</code> plays:</p>
<div><pre><code>// a constructor function
function Foo(y) {
&nbsp;&nbsp;// which may create objects
&nbsp;&nbsp;// by specified pattern: they have after
&nbsp;&nbsp;// creation own "y" property
&nbsp;&nbsp;this.y = y;
}
&nbsp;
// also "Foo.prototype" stores reference
// to the prototype of newly created objects,
// so we may use it to define shared/inherited
// properties or methods, so the same as in
// previous example we have:
&nbsp;
// inherited property "x"
Foo.prototype.x = 10;
&nbsp;
// and inherited method "calculate"
Foo.prototype.calculate = function (z) {
&nbsp;&nbsp;return this.x + this.y + z;
};
&nbsp;
// now create our "b" and "c"
// objects using "pattern" Foo
var b = new Foo(20);
var c = new Foo(30);
&nbsp;
// call the inherited method
b.calculate(30); // 60
c.calculate(40); // 80
&nbsp;
// let's show that we reference
// properties we expect
&nbsp;
console.log(
&nbsp;
&nbsp;&nbsp;b.__proto__ === Foo.prototype, // true
&nbsp;&nbsp;c.__proto__ === Foo.prototype, // true
&nbsp;
&nbsp;&nbsp;// also "Foo.prototype" automatically creates
&nbsp;&nbsp;// a special property "constructor", which is a
&nbsp;&nbsp;// reference to the constructor function itself;
&nbsp;&nbsp;// instances "b" and "c" may found it via
&nbsp;&nbsp;// delegation and use to check their constructor
&nbsp;
&nbsp;&nbsp;b.constructor === Foo, // true
&nbsp;&nbsp;c.constructor === Foo, // true
&nbsp;&nbsp;Foo.prototype.constructor === Foo, // true
&nbsp;
&nbsp;&nbsp;b.calculate === b.__proto__.calculate, // true
&nbsp;&nbsp;b.__proto__.calculate === Foo.prototype.calculate // true
&nbsp;
);
</code></pre></div>
<p>This code may be presented as the following relationship:</p>
<p><img class="aligncenter figure" src="http://dmitrysoshnikov.com/wp-content/uploads/constructor-proto-chain.png" alt="Figure 3. A constructor and objects relationship." title="Figure 3. A constructor and objects relationship."></p>
<p class="figure">Figure 3. A constructor and objects relationship.</p>
<p>This figure again shows that every object has a prototype. Constructor function <code>Foo</code> also has its own <code>__proto__</code> which is <code>Function.prototype</code>, and which in turn also references via its <code>__proto__</code> property again to the <code>Object.prototype</code>. Thus, repeat, <code>Foo.prototype</code> is just an explicit property of <code>Foo</code> which refers to the prototype of <code>b</code> and <code>c</code> objects.</p>
<p>Formally, if to consider a concept of a <em>classification</em> (and we've exactly just now <em>classified</em> the new separated thing — <code>Foo</code>), a combination of the constructor function and the prototype object may be called as a "class". Actually, e.g. Python's <em>first-class</em> dynamic classes have absolutely the same implementation of properties/methods resolution. From this viewpoint, classes of Python are just a syntactic sugar for delegation based inheritance used in ECMAScript.</p>
<div class="note">Notice: in <abbr title="ECMAScript 6">ES6</abbr> the concept of a "class" is standardized, and is implemented as exactly a syntactic sugar on top of the constructor functions as described above. From this viewpoint prototype chains become as an implementation detail of the class-based inheritance:
<div><pre><code>// ES6
class Foo {
&nbsp;&nbsp;constructor(name) {
&nbsp;&nbsp;&nbsp;&nbsp;this._name = name;
&nbsp;&nbsp;}
&nbsp;
&nbsp;&nbsp;getName() {
&nbsp;&nbsp;&nbsp;&nbsp;return this._name;
&nbsp;&nbsp;}
}
&nbsp;
class Bar extends Foo {
&nbsp;&nbsp;getName() {
&nbsp;&nbsp;&nbsp;&nbsp;return super.getName() + ' Doe';
&nbsp;&nbsp;}
}
&nbsp;
var bar = new Bar('John');
console.log(bar.getName()); // John Doe
</code></pre></div>
</div>
<p>The complete and detailed explanation of this topic may be found in the Chapter 7 of ES3 series. There are two parts: <a href="http://dmitrysoshnikov.com/ecmascript/chapter-7-1-oop-general-theory/">Chapter 7.1. OOP. The general theory</a>, where you will find description of various OOP paradigms and stylistics and also their comparison with ECMAScript, and <a href="http://dmitrysoshnikov.com/ecmascript/chapter-7-2-oop-ecmascript-implementation/">Chapter 7.2. OOP. ECMAScript implementation</a>, devoted exactly to OOP in ECMAScript.</p>
<p>Now, when we know basic object aspects, let's  see on how the <em>runtime program execution</em> is implemented in ECMAScript. This is what is called an <em>execution context stack</em>, every element of which is abstractly may be represented as also an object. Yes, ECMAScript almost everywhere operates with concept of an object </p>
<h2 id="execution-context-stack" class="header-link"><a href="#execution-context-stack">Execution context stack</a></h2>
<p>There are three types of ECMAScript code: <em>global</em> code, <em>function</em> code and <em>eval</em> code. Every code is evaluated in its <em>execution context</em>. There is only one global context and may be many instances of function and <em>eval</em> execution contexts. Every call of a function, enters the function execution context and evaluates the function code type. Every call of <code>eval</code> function, enters the <em>eval</em> execution context and evaluates its code.</p>
<p>Notice, that one function may generate infinite set of contexts, because every call to a function (even if the function calls itself recursively) produces a new context with a new <em>context state</em>:</p>
<div><pre><code>function foo(bar) {}
&nbsp;
// call the same function,
// generate three different
// contexts in each call, with
// different context state (e.g. value
// of the "bar" argument)
&nbsp;
foo(10);
foo(20);
foo(30);
</code></pre></div>
<p>An execution context may activate another context, e.g. a function calls another function (or the global context calls a global function), and so on. Logically, this is implemented as a stack, which is called the <em>execution context stack</em>.</p>
<p>A context which activates another context is called a <em>caller</em>. A context is being activated is called a <em>callee</em>. A callee at the same time may be a caller of some other callee (e.g. a function called from the global context, calls then some inner function).</p>
<p>When a caller activates (calls) a callee, the caller suspends its execution and passes the control flow to the callee. The callee is pushed onto the the stack and is becoming a <em>running (active)</em> execution context. After the callee's context ends, it returns control to the caller, and the evaluation of the caller's context proceeds (it may activate then other contexts) till the its end, and so on. A callee may simply <em>return</em> or exit with an <em>exception</em>. A thrown but not caught exception may exit (pop from the stack) one or more contexts.</p>
<p>I.e. all the ECMAScript <em>program runtime</em> is presented as the <em>execution context (<abbr title="Execution context">EC</abbr>) stack</em>, where <em>top</em> of this stack is an <em>active</em> context:</p>
<p><img class="aligncenter figure" src="http://dmitrysoshnikov.com/wp-content/uploads/ec-stack.png" alt="Figure 4. An execution context stack." title="Figure 4. An execution context stack."></p>
<p class="figure">Figure 4. An execution context stack.</p>
<p>When program begins it enters the <em>global execution context</em>, which is the <em>bottom</em> and the <em>first</em> element of the stack. Then the global code provides some initialization, creates needed objects and functions. During the execution of the global context, its code may activate some other (already created) function, which will enter their execution contexts, pushing new elements onto the stack, and so on. After the initialization is done, the runtime system is waiting for some <em>event</em> (e.g. user's mouse click) which will activate some function and which will enter a new execution context.</p>
<p>In the next figure, having some function context as <code>EC1</code> and the global context as <code>Global EC</code>, we have the following stack modification on entering and exiting <code>EC1</code> from the global context:</p>
<p><img class="aligncenter figure" src="http://dmitrysoshnikov.com/wp-content/uploads/ec-stack-changes.png" alt="Figure 5. An execution context stack changes." title="Figure 5. An execution context stack changes."></p>
<p class="figure">Figure 5. An execution context stack changes.</p>
<p>This is exactly how the runtime system of ECMAScript manages the execution of a code.</p>
<p>More information on execution context in ECMAScript may be found in the appropriate <a href="http://dmitrysoshnikov.com/ecmascript/chapter-1-execution-contexts/">Chapter 1. Execution context</a>.</p>
<p>As we said, every execution context in the stack may be presented as an object. Let's see on its structure and what kind of <em>state</em> (which properties) a context is needed to execute its code.</p>
<h2 id="execution-context" class="header-link"><a href="#execution-context">Execution context</a></h2>
<p>An execution context abstractly may be represented as a simple object. Every execution context has set of properties (which we may call a <em>context's state</em>) necessary to track the execution progress of its associated code. In the next figure a structure of a context is shown:</p>
<p><img class="aligncenter figure" src="http://dmitrysoshnikov.com/wp-content/uploads/execution-context.png" alt="Figure 6. An execution context structure." title="Figure 6. An execution context structure."></p>
<p class="figure">Figure 6. An execution context structure.</p>
<p>Besides these three needed properties (a <em>variable object</em>, a <em><code>this</code> value</em> and a <em>scope chain</em>), an execution context may have any additional state depending on implementation.</p>
<p>Let's consider these important properties of a context in detail.</p>
<h2 id="variable-object" class="header-link" tabindex="-1"><a href="#variable-object">Variable object</a></h2>
<p class="definition">A <em>variable object</em> is a <em>container of data</em> associated with the execution context. It's a special object that stores <em>variables</em> and <em>function declarations</em> defined in the context.</p>
<p>Notice, that <em>function expressions</em> (in contrast with <em>function declarations</em>) are <em>not included</em> into the variable object.</p>
<p>A variable object is an abstract concept. In different context types, physically, it's presented using different object. For example, in the global context the variable object is the <em>global object itself</em> (that's why we have an ability to refer global variables via property names of the global object).</p>
<p>Let's consider the following example in the global execution context:</p>
<div><pre><code>var foo = 10;
&nbsp;
function bar() {} // function declaration, FD
(function baz() {}); // function expression, FE
&nbsp;
console.log(
&nbsp;&nbsp;this.foo == foo, // true
&nbsp;&nbsp;window.bar == bar // true
);
&nbsp;
console.log(baz); // ReferenceError, "baz" is not defined
</code></pre></div>
<p>Then the global context's variable object (<abbr title="Variable object">VO</abbr>) will have the following properties:</p>
<p><img class="aligncenter figure" src="http://dmitrysoshnikov.com/wp-content/uploads/variable-object.png" alt="Figure 7. The global variable object." title="Figure 7. The global variable object."></p>
<p class="figure">Figure 7. The global variable object.</p>
<p>See again, that function <code>baz</code> being a <em>function expression</em> is not included into the variable object. That's why we have a <code>ReferenceError</code> when trying to access it outside the function itself.</p>
<p>Notice, that in contrast with other languages (e.g. C/C++) in ECMAScript <em>only functions</em> create a new scope. Variables and inner functions defined within a scope of a function are not visible directly outside and do not pollute the global variable object.</p>
<p>Using <code>eval</code> we also enter a new (eval's) execution context. However, <code>eval</code> uses either global's variable object, or a variable object of the caller (e.g. a function from which <code>eval</code> is called).</p>
<p>And what about functions and their variable objects? In a function context, a variable object is presented as an <em>activation object</em>.</p>
<h2 id="activation-object" class="header-link"><a href="#activation-object">Activation object</a></h2>
<p>When a function is <em>activated</em> (called) by the caller, a special object, called an <em>activation object</em> is created. It's filled with <em>formal parameters</em> and the special <code>arguments</code> object (which is a map of formal parameters but with index-properties). The <em>activation object</em> then is used as a <em>variable object</em> of the function context.</p>
<p>I.e. a function's variable object is the same simple variable object, but besides variables and function declarations, it also stores formal parameters and <code>arguments</code> object and called the <em>activation object</em>.</p>
<p>Considering the following example:</p>
<div><pre><code>function foo(x, y) {
&nbsp;&nbsp;var z = 30;
&nbsp;&nbsp;function bar() {} // FD
&nbsp;&nbsp;(function baz() {}); // FE
}
&nbsp;
foo(10, 20);
</code></pre></div>
<p>we have the next activation object (<abbr title="Activation object">AO</abbr>) of the <code>foo</code> function context:</p>
<p><img class="aligncenter figure" src="http://dmitrysoshnikov.com/wp-content/uploads/activation-object.png" alt="Figure 8. An activation object." title="Figure 8. An activation object."></p>
<p class="figure">Figure 8. An activation object.</p>
<p>And again the <em>function expression</em> <code>baz</code> is not included into the variable/activate object.</p>
<p>The complete description with all subtle cases (such as <em>"hoisting"</em> of variables and function declarations) of the topic may be found in the same name <a href="http://dmitrysoshnikov.com/ecmascript/chapter-2-variable-object/">Chapter 2. Variable object</a>.</p>
<p class="note">Notice, in <abbr title="ECMA-262-5">ES5</abbr> the concepts of <em>variable object</em>, and <em>activation object</em> are combined into the <em>lexical environments</em> model, which detailed description can be found in the <a href="http://dmitrysoshnikov.com/ecmascript/es5-chapter-3-2-lexical-environments-ecmascript-implementation/" title="ECMA-262-5 in detail. Chapter 3.2. Lexical environments: ECMAScript implementation.">appropriate chapter</a>.</p>
<p>And we are moving forward to the next section. As is known, in ECMAScript we may use <em>inner functions</em> and in these inner functions we may refer to variables of <em>parent</em> functions or variables of the <em>global</em> context. As we named a variable object as a <em>scope object</em> of the context, similarly to the discussed above prototype chain, there is so-called a <em>scope chain</em>.</p>
<h2 id="scope-chain" class="header-link"><a href="#scope-chain">Scope chain</a></h2>
<p class="definition">A <em>scope chain</em> is a <em>list of objects</em> that are searched for <em>identifiers</em> appear in the code of the context.</p>
<p>The rule is again simple and similar to a prototype chain: if a variable is not found in the own scope (in the own variable/activation object), its lookup proceeds in the parent's variable object, and so on.</p>
<p>Regarding contexts, identifiers are: <em>names</em> of variables, function declarations, formal parameters, etc. When a function refers in its code the identifier which is not a local variable (or a local function or a formal parameter), such variable is called a <em>free variable</em>. And to <em>search these free variables</em> exactly a <em>scope chain</em> is used.</p>
<p>In general case, a <em>scope chain</em> is a list of all those <em>parent variable objects</em>, <em>plus</em> (in the front of scope chain) the function's <em>own variable/activation object</em>. However, the scope chain may contain also any other object, e.g. objects dynamically added to the scope chain during the execution of the context — such as <em>with-objects</em> or special objects of <em>catch-clauses</em>.</p>
<p>When <em>resolving</em> (looking up) an identifier, the scope chain is searched starting from the activation object, and then (if the identifier isn't found in the own activation object) up to the top of the scope chain — repeat, the same just like with a prototype chain.</p>
<div><pre><code>var x = 10;
&nbsp;
(function foo() {
&nbsp;&nbsp;var y = 20;
&nbsp;&nbsp;(function bar() {
&nbsp;&nbsp;&nbsp;&nbsp;var z = 30;
&nbsp;&nbsp;&nbsp;&nbsp;// "x" and "y" are "free variables"
&nbsp;&nbsp;&nbsp;&nbsp;// and are found in the next (after
&nbsp;&nbsp;&nbsp;&nbsp;// bar's activation object) object
&nbsp;&nbsp;&nbsp;&nbsp;// of the bar's scope chain
&nbsp;&nbsp;&nbsp;&nbsp;console.log(x + y + z);
&nbsp;&nbsp;})();
})();
</code></pre></div>
<p>We may assume the linkage of the scope chain objects via the implicit <code>__parent__</code> property, which refers to the next object in the chain. This approach may be tested in a <a href="http://dmitrysoshnikov.com/ecmascript/chapter-2-variable-object/#feature-of-implementations-property-__parent__">real Rhino code</a>, and exactly this technique is used in <a href="http://dmitrysoshnikov.com/ecmascript/es5-chapter-3-2-lexical-environments-ecmascript-implementation/"><abbr title="ECMAScript 5th edition">ES5</abbr> <em>lexical environments</em></a> (there it's named an <code>outer</code> link). Another representation of a scope chain may be a simple array. Using a <code>__parent__</code> concept, we may represent the example above with the following figure (thus parent variable objects are saved in the <code>[[Scope]]</code> property of a function):</p>
<p><img class="aligncenter figure" src="http://dmitrysoshnikov.com/wp-content/uploads/scope-chain.png" alt="Figure 9. A scope chain." title="Figure 9. A scope chain."></p>
<p class="figure">Figure 9. A scope chain.</p>
<p>At code execution, a scope chain may be augmented using <code>with</code> statement and <code>catch</code> clause objects. And since these objects are simple objects, they may have prototypes (and prototype chains). This fact leads to that scope chain lookup is <em>two-dimensional</em>: (1) first a scope chain link is considered, and then (2) on every scope chain's link — into the depth of the link's prototype chain (if the link of course has a prototype).</p>
<p>For this example:</p>
<div><pre><code>Object.prototype.x = 10;
&nbsp;
var w = 20;
var y = 30;
&nbsp;
// in SpiderMonkey global object
// i.e. variable object of the global
// context inherits from "Object.prototype",
// so we may refer "not defined global
// variable x", which is found in
// the prototype chain
&nbsp;
console.log(x); // 10
&nbsp;
(function foo() {
&nbsp;
&nbsp;&nbsp;// "foo" local variables
&nbsp;&nbsp;var w = 40;
&nbsp;&nbsp;var x = 100;
&nbsp;
&nbsp;&nbsp;// "x" is found in the
&nbsp;&nbsp;// "Object.prototype", because
&nbsp;&nbsp;// {z: 50} inherits from it
&nbsp;
&nbsp;&nbsp;with ({z: 50}) {
&nbsp;&nbsp;&nbsp;&nbsp;console.log(w, x, y , z); // 40, 10, 30, 50
&nbsp;&nbsp;}
&nbsp;
&nbsp;&nbsp;// after "with" object is removed
&nbsp;&nbsp;// from the scope chain, "x" is
&nbsp;&nbsp;// again found in the AO of "foo" context;
&nbsp;&nbsp;// variable "w" is also local
&nbsp;&nbsp;console.log(x, w); // 100, 40
&nbsp;
&nbsp;&nbsp;// and that's how we may refer
&nbsp;&nbsp;// shadowed global "w" variable in
&nbsp;&nbsp;// the browser host environment
&nbsp;&nbsp;console.log(window.w); // 20
&nbsp;
})();
</code></pre></div>
<p>we have the following structure (that is, before we go to the <code>__parent__</code> link, first <code>__proto__</code> chain is considered):</p>
<p><img class="aligncenter figure" src="http://dmitrysoshnikov.com/wp-content/uploads/scope-chain-with.png" alt="Figure 10. A &quot;with-augmented&quot; scope chain." title="Figure 10. A &quot;with-augmented&quot; scope chain."></p>
<p class="figure">Figure 10. A "with-augmented" scope chain.</p>
<p>Notice, that not in all implementations the global object inherits from the <code>Object.prototype</code>. The behavior described on the figure (with referencing "non-defined" variable <code>x</code> from the global context) may be tested e.g. in SpiderMonkey.</p>
<p>Until all parent variable objects exist, there is nothing special in getting parent data from the inner function — we just traverse through the scope chain resolving (searching) needed variable. However, as we mentioned above, after a context ends, all its state and it itself are <em>destroyed</em>. At the same time an <em>inner function</em> may be <em>returned</em> from the parent function. Moreover, this returned function may be later activated from another context. What will be with such an activation if a context of some free variable is already "gone"? In the general theory, a concept which helps to solve this issue is called a <em>(lexical) closure</em>, which in ECMAScript is directly related with a <em>scope chain</em> concept.</p>
<h2 id="closures" class="header-link"><a href="#closures">Closures</a></h2>
<p>In ECMAScript, functions are the <em>first-class</em> objects. This term means that functions may be passed as arguments to other functions (in such case they are called <em>"funargs"</em>, short from "functional arguments"). Functions which receive "funargs" are called <em>higher-order functions</em> or, closer to mathematics, <em>operators</em>. Also functions may be returned from other functions. Functions which return other functions are called <em>function valued</em> functions (or functions with <em>functional value</em>).</p>
<p>There are two conceptual problems related with "funargs" and "functional values". And these two sub-problems are generalized in one which is called a <em>"Funarg problem"</em> (or "A problem of a functional argument"). And exactly to solve the <em>complete "funarg problem"</em>, the concept of <em>closures</em> was invented. Let's describe in more detail these two sub-problems (we'll see that both of them are solved in ECMAScript using a mentioned on figures <code>[[Scope]]</code> property of a function).</p>
<p>First subtype of the "funarg problem" is an <em>"upward funarg problem"</em>. It appears when a function is returned "up" (to the outside) from another function and uses already mentioned above <em>free variables</em>. To be able access variables of the parent context <em>even after the parent context ends</em>, the inner function <em>at creation moment</em> saves in it's <code>[[Scope]]</code> property parent's <em>scope chain</em>. Then when the function is <em>activated</em>, the scope chain of its context is formed as combination of the activation object and this <code>[[Scope]]</code> property (actually, what we've just seen above on figures):</p>
<div><pre><code>Scope chain = Activation object + [[Scope]]
</code></pre></div>
<p>Notice again the main thing — exactly at <em>creation moment</em> — a function saves <em>parent's</em> scope chain, because exactly this <em>saved scope chain</em> will be used for variables lookup then in further calls of the function.</p>
<div><pre><code>function foo() {
&nbsp;&nbsp;var x = 10;
&nbsp;&nbsp;return function bar() {
&nbsp;&nbsp;&nbsp;&nbsp;console.log(x);
&nbsp;&nbsp;};
}
&nbsp;
// "foo" returns also a function
// and this returned function uses
// free variable "x"
&nbsp;
var returnedFunction = foo();
&nbsp;
// global variable "x"
var x = 20;
&nbsp;
// execution of the returned function
returnedFunction(); // 10, but not 20
</code></pre></div>
<p>This style of scope is called the <em>static (or lexical) scope</em>. We see that the variable <code>x</code> is found in the saved <code>[[Scope]]</code> of returned <code>bar</code> function. In general theory, there is also a <em>dynamic scope</em> when the variable <code>x</code> in the example above would be resolved as <code>20</code>, but not <code>10</code>. However, dynamic scope is not used in ECMAScript.</p>
<p>The second part of the "funarg problem"  is a <em>"downward funarg problem"</em>. In this case a parent context may exist, but may be an ambiguity with resolving an identifier. The problem is: <em>from which scope</em> a value of an identifier should be used — statically saved at a function's creation or dynamically formed at execution (i.e. a scope of a <em>caller</em>)? To avoid this ambiguity and to form a closure, a <em>static scope</em> is decided to be used:</p>
<div><pre><code>// global "x"
var x = 10;
&nbsp;
// global function
function foo() {
&nbsp;&nbsp;console.log(x);
}
&nbsp;
(function (funArg) {
&nbsp;
&nbsp;&nbsp;// local "x"
&nbsp;&nbsp;var x = 20;
&nbsp;
&nbsp;&nbsp;// there is no ambiguity,
&nbsp;&nbsp;// because we use global "x",
&nbsp;&nbsp;// which was statically saved in
&nbsp;&nbsp;// [[Scope]] of the "foo" function,
&nbsp;&nbsp;// but not the "x" of the caller's scope,
&nbsp;&nbsp;// which activates the "funArg"
&nbsp;
&nbsp;&nbsp;funArg(); // 10, but not 20
&nbsp;
})(foo); // pass "down" foo as a "funarg"
</code></pre></div>
<p>We may conclude that a <em>static scope</em> is an <em>obligatory requirement to have closures</em> in a language. However, some languages may provided combination of dynamic and static scopes, allowing a programmer to choose — what to closure and what do not. Since in ECMAScript only a static scope is used (i.e. we have solutions for both subtypes of the "funarg problem"), the conclusion is: <em>ECMAScript has complete support of closures</em>, which technically are implemented using <code>[[Scope]]</code> property of functions. Now we may give a correct definition of a closure:</p>
<p class="definition">A <em>closure</em> is a combination of a code block (in ECMAScript this is a function) and statically/lexically saved all parent scopes. Thus, via these saved scopes a function may easily refer free variables.</p>
<p>Notice, that since <em>every</em> (normal) function saves <code>[[Scope]]</code> at creation, theoretically, <em>all functions</em> in ECMAScript <em>are closures</em>.</p>
<p>Another important thing to note, that several functions may have <em>the same parent scope</em> (it's quite a normal situation when e.g. we have two inner/global functions). In this case variables stored in the <code>[[Scope]]</code> property are <em>shared between all functions</em> having the same parent scope chain. Changes of variables made by one closure are <em>reflected</em> on reading these variables in another closure:</p>
<div><pre><code>function baz() {
&nbsp;&nbsp;var x = 1;
&nbsp;&nbsp;return {
&nbsp;&nbsp;&nbsp;&nbsp;foo: function foo() { return ++x; },
&nbsp;&nbsp;&nbsp;&nbsp;bar: function bar() { return --x; }
&nbsp;&nbsp;};
}
&nbsp;
var closures = baz();
&nbsp;
console.log(
&nbsp;&nbsp;closures.foo(), // 2
&nbsp;&nbsp;closures.bar()&nbsp; // 1
);
</code></pre></div>
<p>This code may be illustrated with the following figure:</p>
<p><img class="aligncenter figure" src="http://dmitrysoshnikov.com/wp-content/uploads/shared-scope.png" alt="Figure 11. A shared [[Scope]]." title="Figure 11. A shared [[Scope]]."></p>
<p class="figure">Figure 11. A shared [[Scope]].</p>
<p>Exactly with this feature confusion with creating several functions in a loop is related. Using a loop counter inside created functions, some programmers often get unexpected results when all functions have the <em>same</em> value of a counter inside a function. Now it should be clear why it is so — because all these functions have the same <code>[[Scope]]</code> where the loop counter has the last assigned value.</p>
<div><pre><code>var data = [];
&nbsp;
for (var k = 0; k &lt; 3; k++) {
&nbsp;&nbsp;data[k] = function () {
&nbsp;&nbsp;&nbsp;&nbsp;console.log(k);
&nbsp;&nbsp;};
}
&nbsp;
data[0](); // 3, but not 0
data[1](); // 3, but not 1
data[2](); // 3, but not 2
</code></pre></div>
<p>There are several techniques which may solve this issue. One of the techniques is to provide an additional object in the scope chain — e.g. using additional function:</p>
<div><pre><code>var data = [];
&nbsp;
for (var k = 0; k &lt; 3; k++) {
&nbsp;&nbsp;data[k] = (function (x) {
&nbsp;&nbsp;&nbsp;&nbsp;return function () {
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;console.log(x);
&nbsp;&nbsp;&nbsp;&nbsp;};
&nbsp;&nbsp;})(k); // pass "k" value
}
&nbsp;
// now it is correct
data[0](); // 0
data[1](); // 1
data[2](); // 2
</code></pre></div>
<div class="note">NOTE: <abbr title="ECMAScript 6">ES6</abbr> introduced <em>block-scope</em> bindings. This is done via <code>let</code> or <code>const</code> keywords. Example from above can now easily and conveniently rewritten as:
<div><pre><code>let data = [];
&nbsp;
for (let k = 0; k &lt; 3; k++) {
&nbsp;&nbsp;data[k] = function () {
&nbsp;&nbsp;&nbsp;&nbsp;console.log(k);
&nbsp;&nbsp;};
}
&nbsp;
data[0](); // 0
data[1](); // 1
data[2](); // 2
</code></pre></div>
</div>
<p>Those who interested deeper in theory of closures and their practical application, may find additional information in the <a href="http://dmitrysoshnikov.com/ecmascript/chapter-6-closures/">Chapter 6. Closures</a>. And to get more information about a scope chain, take a look on the same name <a href="http://dmitrysoshnikov.com/ecmascript/chapter-4-scope-chain/">Chapter 4. Scope chain</a>.</p>
<p>And we're moving to the next section, considering the last property of an execution context. This is concept of a <code>this</code> value.</p>
<h2 id="this-value" class="header-link"><a href="#this-value">This value</a></h2>
<p class="definition">A <code>this</code> value is a special object which is related with the execution context. Therefore, it may be named as a <em>context object</em> (i.e. an object in which context the execution context is <em>activated</em>).</p>
<p><em>Any object</em> can be used as <code>this</code> value of the context. One important note is that the  <code>this</code> value is a <em>property of the execution context</em>, but <em>not</em> a property of the variable object.</p>
<p>This feature is very important, because in <em>contrast with variables</em>, <em><code>this</code> value never participates in identifier resolution process</em>. I.e. when accessing <code>this</code> in a code, its value is taken <em>directly</em> from the execution context and <em>without any scope chain lookup</em>. The value of <code>this</code> is determined <em>only once</em>, on <em>entering the context</em>.</p>
<p class="note">NOTE: In <abbr title="ECMAScript 6">ES6</abbr> <code>this</code> actually became a property of a <em>lexical environment</em>, i.e. property of the <em>variable object</em> in ES3 terminology. This is done to support <em>arrow functions</em>, which have <em>lexical <code>this</code></em>, which they inherit from parent contexts.</p>
<p>By the way, in contrast with ECMAScript, e.g. Python has its <code>self</code> argument of methods as a simple variable which is resolved the same and may be even changed during the execution to another value. In ECMAScript it is <em>not possible</em> to assign a new value to <code>this</code>, because, repeat, it's not a variable and is not placed in the variable object.</p>
<p>In the global context, a <code>this value</code> is the <em>global object itself</em> (that means, <code>this</code> value here equals to <em>variable object</em>):</p>
<div><pre><code>var x = 10;
&nbsp;
console.log(
&nbsp;&nbsp;x, // 10
&nbsp;&nbsp;this.x, // 10
&nbsp;&nbsp;window.x // 10
);
</code></pre></div>
<p>In case of a function context, <code>this</code> value in <em>every single function call</em> may be <em>different</em>. Here <code>this</code> value is provided by the <em>caller</em> via the <em>form of a call expression</em> (i.e. the way of how a function is activated). For example, the function <code>foo</code> below is a <em>callee</em>, being called from the global context, which is a <em>caller</em>. Let's see on the example, how for the same code of a function, <code>this</code> value in different calls (different ways of the function activation) is provided <em>differently</em> by the caller:</p>
<div><pre><code>// the code of the "foo" function
// never changes, but the "this" value
// differs in every activation
&nbsp;
function foo() {
&nbsp;&nbsp;alert(this);
}
&nbsp;
// caller activates "foo" (callee) and
// provides "this" for the callee
&nbsp;
foo(); // global object
foo.prototype.constructor(); // foo.prototype
&nbsp;
var bar = {
&nbsp;&nbsp;baz: foo
};
&nbsp;
bar.baz(); // bar
&nbsp;
(bar.baz)(); // also bar
(bar.baz = bar.baz)(); // but here is global object
(bar.baz, bar.baz)(); // also global object
(false || bar.baz)(); // also global object
&nbsp;
var otherFoo = bar.baz;
otherFoo(); // again global object
</code></pre></div>
<p>To consider deeply why (and that is more essential — <em>how</em>) <code>this</code> value may change in every function call, you may read <a href="http://dmitrysoshnikov.com/ecmascript/chapter-3-this/">Chapter 3. This</a> where all mentioned above cases are discussed in detail.</p>
<h2 id="conclusion" class="header-link"><a href="#conclusion">Conclusion</a></h2>
<p>At this step we finish this brief overview. Though, it turned out to not so "brief". However, the whole explanation of all these topics requires a complete book. We though didn't touch two major topics: <em>functions</em> (and the difference between some types of functions, e.g. <em>function declaration</em> and <em>function expression</em>) and the <em>evaluation strategy</em> used in ECMAScript. Both topics may be found in the appropriate chapters of ES3 series: <a href="http://dmitrysoshnikov.com/ecmascript/chapter-5-functions/">Chapter 5. Functions</a> and <a href="http://dmitrysoshnikov.com/ecmascript/chapter-8-evaluation-strategy/">Chapter 8. Evaluation strategy</a>.</p>
<p>If you have comments, questions or additions, I'll be glad to discuss them in comments.</p>
<p>Good luck in studying ECMAScript!</p>
<p><strong>Written by:</strong> Dmitry A. Soshnikov<br>
<strong>Published on: </strong>2010-09-02</p>
<p>
					</p></div>
					</div>
				</article>
				<!--================= END :: Tutorial =================-->
				
				<!--================= START :: Tutorial =================-->
				<article>
					<a id="t-58" name="t-58"></a><h1>58 : Understanding Scopes</h1>
					<span class="ref-site">https://github.com/angular/angular.js/wiki/Understanding-Scopes</span>
					<div class="tutorial__content">
<div class="markdown-body">
        <p><strong>Executive Summary:</strong></p>
<p>In AngularJS, a child scope normally prototypically inherits from its parent scope. One exception to this rule is a directive that uses <code>scope: { ... }</code> -- this creates an "isolate" scope that does not prototypically inherit.（and directive with transclusion） This construct is often used when creating a "reusable component" directive. In directives, the parent scope is used directly by default, which means that whatever you change in your directive that comes from the parent scope will also change in the parent scope. If you set <code>scope:true</code> (instead of <code>scope: { ... }</code>), then prototypical inheritance will be used for that directive.</p>
<p>Scope inheritance is normally straightforward, and you often don't even need to know it is happening... until you try <strong>2-way data binding</strong> (i.e., form elements, ng-model) <strong>to a primitive</strong> (e.g., number, string, boolean) defined on the parent scope from inside the child scope.  It doesn't work the way most people expect it should work.  What happens is that the child scope gets its own property that hides/shadows the parent property of the same name.  This is not something AngularJS is doing – this is how JavaScript prototypal inheritance works.  New AngularJS developers often do not realize that ng-repeat, ng-switch, ng-view, ng-include and ng-if all create new child scopes, so the problem often shows up when these directives are involved. (See <a href="http://plnkr.co/edit/zZfUQN?p=preview">this example</a> for a quick illustration of the problem.)</p>
<p>This issue with primitives can be easily avoided by following the "best practice" of <a href="http://www.youtube.com/watch?v=ZhfUv0spHCY&amp;feature=youtu.be&amp;t=30m">always have a '.' in your ng-models</a> –  watch 3 minutes worth.  Misko demonstrates the primitive binding issue with ng-switch.</p>
<p>Having a '.' in your models will ensure that prototypal inheritance is in play.  So, use <br>
<code>&lt;input type="text" ng-model="someObj.prop1"&gt;</code> rather than <br>
<code>&lt;input type="text" ng-model="prop1"&gt;</code>.</p>
<p>If you really want/need to use a primitive, there are two workarounds:</p>
<ol>
<li>Use <code>$parent.parentScopeProperty</code> in the child scope.  This will prevent the child scope from creating its own property.</li>
<li>Define a function on the parent scope, and call it from the child, passing the primitive value up to the parent (not always possible)</li>
</ol>
<p><strong>The Details:</strong></p>
<ul>
<li><a href="#javascript-prototypal-inheritance">JavaScript Prototypal Inheritance</a></li>
<li>
<a href="#angular-scope-inheritance">Angular Scope Inheritance</a>
<ul>
<li><a href="#ng-include">ng-include</a></li>
<li><a href="#ng-switch">ng-switch</a></li>
<li><a href="#ng-repeat">ng-repeat</a></li>
<li><a href="#ng-view">ng-view</a></li>
<li><a href="#ng-controller">ng-controller</a></li>
<li><a href="#directives">directives</a></li>
</ul>
</li>
</ul>
<p>##JavaScript Prototypal Inheritance</p>
<p>It is important to first have a solid understanding of JavaScript prototypal inheritance, especially if you are coming from a server-side background and you are more familiar with classical inheritance. So let's review that first.</p>
<p>Suppose parentScope has properties aString, aNumber, anArray, anObject, and aFunction. If childScope prototypically inherits from parentScope, we have:</p>
<p><img src="https://camo.githubusercontent.com/85ec776a0dd4acbe687f3db6367fa56872abb87f/687474703a2f2f692e737461636b2e696d6775722e636f6d2f61544147672e706e67" alt="normal prototypal inheritance" data-canonical-src="http://i.stack.imgur.com/aTAGg.png"></p>
<p>(Note that to save space, I show the <code>anArray</code> object as a single blue object with its three values, rather than an single blue object with three separate gray literals.)</p>
<p>If we try to access a property defined on the parentScope from the child scope, JavaScript will first look in the child scope, not find the property, then look in the inherited scope, and find the property. (If it didn't find the property in the parentScope, it would continue up the prototype chain... all the way up to the root scope). So, these are all true:</p>
<pre><code>childScope.aString === 'parent string'
childScope.anArray[1] === 20
childScope.anObject.property1 === 'parent prop1'
childScope.aFunction() === 'parent output'
</code></pre>
<p>Suppose we then do this:</p>
<pre><code>childScope.aString = 'child string'
</code></pre>
<p>The prototype chain is not consulted, and a new aString property is added to the childScope. <strong>This new property hides/shadows the parentScope property with the same name</strong>. This will become very important when we discuss ng-repeat and ng-include below.</p>
<p><img src="https://camo.githubusercontent.com/be4cd25951780638cf181b743b723ba6fb6ddb47/687474703a2f2f692e737461636b2e696d6775722e636f6d2f4f795650572e706e67" alt="shadowing" data-canonical-src="http://i.stack.imgur.com/OyVPW.png"></p>
<p>Suppose we then do this:</p>
<pre><code>childScope.anArray[1] = 22
childScope.anObject.property1 = 'child prop1'
</code></pre>
<p>The prototype chain is consulted because the objects (anArray and anObject) are not found in the childScope. The objects are found in the parentScope, and the property values are updated on the original objects. No new properties are added to the childScope; no new objects are created. (Note that in JavaScript arrays and functions are also objects.)</p>
<p><img src="https://camo.githubusercontent.com/57f1938d241122bf49583ed64ee093e45e5dd012/687474703a2f2f692e737461636b2e696d6775722e636f6d2f32516365552e706e67" alt="follow the chain" data-canonical-src="http://i.stack.imgur.com/2QceU.png"></p>
<p>Suppose we then do this:</p>
<pre><code>childScope.anArray = [100, 555]
childScope.anObject = { name: 'Mark', country: 'USA' }
</code></pre>
<p>The prototype chain is not consulted, and child scope gets two new object properties that hide/shadow the parentScope object properties with the same names.</p>
<p><img src="https://camo.githubusercontent.com/4679189c134e25e7dd7fcee18bc676cf9ec6b295/687474703a2f2f692e737461636b2e696d6775722e636f6d2f684b6574482e706e67" alt="not following the chain" data-canonical-src="http://i.stack.imgur.com/hKetH.png"></p>
<p>Takeaways:</p>
<ul>
<li>If we read childScope.propertyX, and childScope has propertyX, then the prototype chain is not consulted.</li>
<li>If we set childScope.propertyX, the prototype chain is not consulted.</li>
</ul>
<p>One last scenario:</p>
<pre><code>delete childScope.anArray
childScope.anArray[1] === 22  // true
</code></pre>
<p>We deleted the childScope property first, then when we try to access the property again, the prototype chain is consulted.</p>
<p><img src="https://camo.githubusercontent.com/7f2d4d76e472463fa2980802a08cb3bedca7e0cd/687474703a2f2f692e737461636b2e696d6775722e636f6d2f3536756f652e706e67" alt="after deleting a property" data-canonical-src="http://i.stack.imgur.com/56uoe.png"></p>
<p>Here is a <a href="http://jsfiddle.net/5qjLd/">jsfiddle</a> where you can see the above javascript prototypical inheritance examples being modified and their result (open up your browser's console to see the output. The console output can be viewed as what the 'RootScope' would see).</p>
<p>##Angular Scope Inheritance</p>
<p>The contenders:</p>
<ul>
<li>The following create new scopes, and inherit prototypically: ng-repeat, ng-include, ng-switch, ng-view, ng-controller, directive with <code>scope: true</code>, directive with <code>transclude: true</code>.</li>
<li>The following creates a new scope which does not inherit prototypically: directive with <code>scope: { ... }</code>. This creates an "isolate" scope instead.</li>
</ul>
<p>Note, by default, directives do not create new scope -- i.e., the default is <code>scope: false</code>.</p>
<p>###ng-include</p>
<p>Suppose we have in our controller:</p>
<pre><code>$scope.myPrimitive = 50;
$scope.myObject    = {aNumber: 11};
</code></pre>
<p>And in our HTML:</p>
<pre><code>&lt;script type="text/ng-template" id="/tpl1.html"&gt;
    &lt;input ng-model="myPrimitive"&gt;
&lt;/script&gt;
&lt;div ng-include src="'/tpl1.html'"&gt;&lt;/div&gt;

&lt;script type="text/ng-template" id="/tpl2.html"&gt;
    &lt;input ng-model="myObject.aNumber"&gt;
&lt;/script&gt;
&lt;div ng-include src="'/tpl2.html'"&gt;&lt;/div&gt;
</code></pre>
<p>Each ng-include generates a new child scope, which prototypically inherits from the parent scope.</p>
<p><img src="https://camo.githubusercontent.com/67fc2d40487725fde10b669426c8b6b74213e6c6/687474703a2f2f692e737461636b2e696d6775722e636f6d2f7a694466782e706e67" alt="ng-include" data-canonical-src="http://i.stack.imgur.com/ziDfx.png"></p>
<p>Typing (say, "77") into the first input textbox causes the child scope to get a new myPrimitive scope property that hides/shadows the parent scope property of the same name. This is probably not what you want/expect.</p>
<p><img src="https://camo.githubusercontent.com/f1c9d54bd5b13d1e479b41ca6062b4b9fecc8fe2/687474703a2f2f692e737461636b2e696d6775722e636f6d2f376c3864672e706e67" alt="ng-include primitive" data-canonical-src="http://i.stack.imgur.com/7l8dg.png"></p>
<p>Typing (say, "99") into the second input textbox does not result in a new child property. Because tpl2.html binds the model to an object property, prototypal inheritance kicks in when the ngModel looks for object myObject -- it finds it in the parent scope.</p>
<p><img src="https://camo.githubusercontent.com/5a6ff2644b1b7a15621c2a20928abfce0a2018bb/687474703a2f2f692e696d6775722e636f6d2f6f764a6547706f2e706e67" alt="ng-include object" data-canonical-src="http://i.imgur.com/ovJeGpo.png"></p>
<p>We can rewrite the first template to use $parent, if we don't want to change our model from a primitive to an object:</p>
<pre><code>&lt;input ng-model="$parent.myPrimitive"&gt;
</code></pre>
<p>Typing (say, "22") into this input textbox does not result in a new child property. The model is now bound to a property of the parent scope (because $parent is a child scope property that references the parent scope).</p>
<p><img src="https://camo.githubusercontent.com/40767f9e9cc824e5c9ef178e385c9daa40ade6ba/687474703a2f2f692e737461636b2e696d6775722e636f6d2f6b6438706a2e706e67" alt="ng-include $parent" data-canonical-src="http://i.stack.imgur.com/kd8pj.png"></p>
<p>For all scopes (prototypal or not), Angular always tracks a parent-child relationship (i.e., a hierarchy), via scope properties $parent, $$childHead and $$childTail. I normally don't show these scope properties in the diagrams.</p>
<p>For scenarios where form elements are not involved, another solution is to define a function on the parent scope to modify the primitive. Then ensure the child always calls this function, which will be available to the child scope due to prototypal inheritance. E.g.,</p>
<pre><code>// in the parent scope
$scope.setMyPrimitive = function(value) {
    $scope.myPrimitive = value;
}
</code></pre>
<p>Here is a <a href="http://jsfiddle.net/mrajcok/jNxyE/">sample fiddle</a> that uses this "parent function" approach.  (This was part of a <a href="http://stackoverflow.com/a/14104318/215945">Stack Overflow post</a>.)</p>
<p>See also <a href="http://stackoverflow.com/a/13782671/215945">http://stackoverflow.com/a/13782671/215945</a> and<br> <a href="https://github.com/angular/angular.js/issues/1267">https://github.com/angular/angular.js/issues/1267</a>.</p>
<p>###ng-switch</p>
<p>ng-switch scope inheritance works just like ng-include. So if you need 2-way data binding to a primitive in the parent scope, use $parent, or change the model to be an object and then bind to a property of that object. This will avoid child scope hiding/shadowing of parent scope properties.</p>
<p>See also <a href="http://stackoverflow.com/questions/12405005/angularjs-bind-scope-of-a-switch-case/12414410">AngularJS, bind scope of a switch-case?</a></p>
<p>###ng-repeat</p>
<p>Ng-repeat works a little differently. Suppose we have in our controller:</p>
<pre><code>$scope.myArrayOfPrimitives = [ 11, 22 ];
$scope.myArrayOfObjects    = [{num: 101}, {num: 202}]
</code></pre>
<p>And in our HTML:</p>
<pre><code>&lt;ul&gt;&lt;li ng-repeat="num in myArrayOfPrimitives"&gt;
       &lt;input ng-model="num"&gt;&lt;/input&gt;
    &lt;/li&gt;
&lt;/ul&gt;
&lt;ul&gt;&lt;li ng-repeat="obj in myArrayOfObjects"&gt;
       &lt;input ng-model="obj.num"&gt;&lt;/input&gt;
    &lt;/li&gt;
&lt;/ul&gt;
</code></pre>
<p>For each item/iteration, ng-repeat creates a new scope, which prototypically inherits from the parent scope, <strong>but it also assigns the item's value to a new property on the new child scope</strong>. (The name of the new property is the loop variable's name.) Here's what the Angular source code for ng-repeat actually is:</p>
<pre><code>childScope = scope.$new(); // child scope prototypically inherits from parent scope ...     
childScope[valueIdent] = value; // creates a new childScope property
</code></pre>
<p>If item is a primitive (as in myArrayOfPrimitives), essentially a copy of the value is assigned to the new child scope property. Changing the child scope property's value (i.e., using ng-model, hence child scope property <code>num</code>) does <strong>not</strong> change the array the parent scope references. So in the first ng-repeat above, each child scope gets a <code>num</code> property that is independent of the myArrayOfPrimitives array:</p>
<p><img src="https://camo.githubusercontent.com/3254baf91afdd969e6f167eeeb59950a0399a8f1/687474703a2f2f692e737461636b2e696d6775722e636f6d2f6e4c6f69572e706e67" alt="ng-repeat primitive" data-canonical-src="http://i.stack.imgur.com/nLoiW.png"></p>
<p>This ng-repeat will not work (like you want/expect it to).  In Angular 1.0.2 or earlier, typing into the textboxes changes the values in the gray boxes, which are only visible in the child scopes.  In Angular 1.0.3+, typing into the text boxes has no effect.  (See Artem's explanation as to why on <a href="http://stackoverflow.com/a/13723990/215945">StackOverflow</a>.) What we want is for the inputs to affect the myArrayOfPrimitives array, not a child scope primitive property. To accomplish this, we need to change the model to be an array of objects.</p>
<p>So, if item is an object, a reference to the original object (not a copy) is assigned to the new child scope property. Changing the child scope property's value (i.e., using ng-model, hence <code>obj.num</code>) <strong>does</strong> change the object the parent scope references. So in the second ng-repeat above, we have:</p>
<p><img src="https://camo.githubusercontent.com/881318ad2d70364cf61d50faf536a7ce08f39777/687474703a2f2f692e737461636b2e696d6775722e636f6d2f51536a544a2e706e67" alt="ng-repeat object" data-canonical-src="http://i.stack.imgur.com/QSjTJ.png"></p>
<p>(I colored one line gray just so that it is clear where it is going.)</p>
<p>This works as expected. Typing into the textboxes changes the values in the gray boxes, which are visible to both the child and parent scopes.</p>
<p>See also <a href="http://stackoverflow.com/questions/13714884/difficulty-with-ng-model-ng-repeat-and-inputs">Difficulty with ng-model, ng-repeat, and inputs</a> and<br> <a href="http://stackoverflow.com/a/13782671/215945">ng-repeat and databinding</a></p>
<p>###ng-view</p>
<p>TBD, but I think it acts just like ng-include.</p>
<p>###ng-controller</p>
<p>Nesting controllers using ng-controller results in normal prototypal inheritance, just like ng-include and ng-switch, so the same techniques apply. However, "it is considered bad form for two controllers to share information via $scope inheritance" -- <a href="http://onehungrymind.com/angularjs-sticky-notes-pt-1-architecture/">http://onehungrymind.com/angularjs-sticky-notes-pt-1-architecture/</a> A service should be used to share data between controllers instead.</p>
<p>(If you really want to share data via controllers scope inheritance, there is nothing you need to do. The child scope will have access to all of the parent scope properties. See also <a href="http://stackoverflow.com/questions/13825419/controller-load-order-differs-when-loading-or-navigating/13843771#13843771">Controller load order differs when loading or navigating</a>)</p>
<p>###directives</p>
<ol>
<li>default (<code>scope: false</code>) - the directive does not create a new scope, so there is no inheritance here. This is easy, but also dangerous because, e.g., a directive might think it is creating a new property on the scope, when in fact it is clobbering an existing property. This is not a good choice for writing directives that are intended as reusable components.</li>
<li>
<code>scope: true</code> - the directive creates a new child scope that prototypically inherits from the parent scope. If more than one directive (on the same DOM element) requests a new scope, only one new child scope is created. Since we have "normal" prototypal inheritance, this is like ng-include and ng-switch, so be wary of 2-way data binding to parent scope primitives, and child scope hiding/shadowing of parent scope properties.</li>
<li>
<code>scope: { ... }</code> - the directive creates a new isolate/isolated scope. It does not prototypically inherit. This is usually your best choice when creating reusable components, since the directive cannot accidentally read or modify the parent scope. However, such directives often need access to a few parent scope properties. The object hash is used to set up two-way binding (using '=') or one-way binding (using '@') between the parent scope and the isolate scope. There is also '&amp;' to bind to parent scope expressions. So, these all create local scope properties that are derived from the parent scope. Note that attributes are used to help set up the binding -- you can't just reference parent scope property names in the object hash, you have to use an attribute. E.g., this won't work if you want to bind to parent property <code>parentProp</code> in the isolated scope: <code>&lt;div my-directive&gt;</code> and <code>scope: { localProp: '@parentProp' }</code>. An attribute must be used to specify each parent property that the directive wants to bind to: <code>&lt;div my-directive the-Parent-Prop=parentProp&gt;</code> and <code>scope: { localProp: '@theParentProp' }</code>.
<br>Isolate scope's <code>__proto__</code> references a <a href="http://docs.angularjs.org/api/ng.%24rootScope.Scope">Scope</a> object. Isolate scope's $parent references the parent scope, so although it is isolated and doesn't inherit prototypically from the parent scope, it is still a child scope.
<br>For the picture below we have
<br><code>&lt;my-directive interpolated="{{parentProp1}}" twowayBinding="parentProp2"&gt;</code> and
<br> <code>scope: { interpolatedProp: '@interpolated', twowayBindingProp: '=twowayBinding' }</code>
<br>Also, assume the directive does this in its linking function: <code>scope.someIsolateProp = "I'm isolated"</code>
<br><img src="https://camo.githubusercontent.com/0c650e5b62347beec5ebbb4990673a523a80968c/687474703a2f2f692e737461636b2e696d6775722e636f6d2f45586a5a712e706e67" alt="isolate scope" data-canonical-src="http://i.stack.imgur.com/EXjZq.png">
<br>One final note: use <code>attrs.$observe('attr_name', function(value) { ... })</code> in the linking function to get the interpolated value of isolate scope properties that use the '@' notation.  E.g., if we have this in the linking function -- <code>attrs.$observe('interpolated', function(value) { ... })</code> -- <code>value</code> would be set to 11.  (<code>scope.interpolatedProp</code> is undefined in the linking function.  In contrast, <code>scope.twowayBindingProp</code> is defined in the linking function, since it uses the '=' notation.)
<br>For more information on isolate scopes see <a href="http://onehungrymind.com/angularjs-sticky-notes-pt-2-isolated-scope/">http://onehungrymind.com/angularjs-sticky-notes-pt-2-isolated-scope/</a>
</li>
<li>
<code>transclude: true</code> - the directive creates a new "transcluded" child scope, which prototypically inherits from the parent scope.  <del>So if your transcluded content (i.e., the stuff that ng-transclude will be replaced with) requires 2-way data binding to a primitive in the parent scope, use $parent, or change the model to be an object and then bind to a property of that object. This will avoid child scope hiding/shadowing of parent scope properties.<br>The transcluded and the isolated scope (if any) are siblings -- the $parent property of each scope references the same parent scope. When a transcluded and an isolate scope both exist, isolate scope property $$nextSibling will reference the transcluded scope.
<br>For more information on transcluded scopes, see <a href="http://stackoverflow.com/a/14484903/215945">AngularJS two way binding not working in directive with transcluded scope</a>
<br>For the picture below, assume the same directive as above with this addition: <code>transclude: true</code>
<br><img src="https://camo.githubusercontent.com/4d9a7cbb029bb29d66cbbef0f0527b2d40202d90/687474703a2f2f692e737461636b2e696d6775722e636f6d2f41684f47482e706e67" alt="transcluded scope" data-canonical-src="http://i.stack.imgur.com/AhOGH.png"></del>. The former information is outdated since v1.3. Isolated scope is the $parent of transcluded scope now. See <a href="http://stackoverflow.com/questions/17788289/why-ng-transcludes-scope-is-not-a-child-of-its-directives-scope-if-the-direc">Why ng-transclude's scope is not a child of its directive's scope - if the directive has an isolated scope?</a> for more detail.</li>
</ol>
<p>This <a href="http://jsfiddle.net/mrajcok/7g3QM/">fiddle</a> has a <code>showScope()</code> function that can be used to examine an isolate scope and its associated transcluded scope. See the instructions in the comments in the fiddle.</p>

<p>There are four types of scopes:</p>
<ol>
<li>normal prototypal scope inheritance -- ng-include, ng-switch, ng-controller, directive with <code>scope: true</code>
</li>
<li>normal prototypal scope inheritance with a copy/assignment -- ng-repeat. Each iteration of ng-repeat creates a new child scope, and that new child scope always gets a new property.</li>
<li>isolate scope -- directive with <code>scope: {...}</code>. This one is not prototypal, but '=', '@', and '&amp;' provide a mechanism to access parent scope properties, via attributes.</li>
<li>transcluded scope -- directive with <code>transclude: true</code>. This one is also normal prototypal scope inheritance, but it is also a sibling of any isolate scope.</li>
</ol>
<p>For all scopes (prototypal or not), Angular always tracks a parent-child relationship (i.e., a hierarchy), via properties $parent and $$childHead and $$childTail.</p>

<p>The above was originally posted on <a href="http://stackoverflow.com/questions/14049480/what-are-the-nuances-of-scope-prototypal-prototypical-inheritance-in-angularjs">StackOverflow</a>.</p>

      </div>
					</div>
				</article>
				<!--================= END :: Tutorial =================-->
				
				<!--================= START :: Tutorial =================-->
				<article>
					<a id="t-59" name="t-59"></a><h1>59 : Monkey-Patching, Overriding, and Decorating Methods in JavaScript</h1>
					<span class="ref-site">http://me.dt.in.th/page/JavaScript-override/</span>
					<div class="tutorial__content">

<div class="me-content-data">
	
  <p>While working on a <a href="http://casperjs.org/">CasperJS</a> <a href="http://docs.casperjs.org/en/latest/modules/tester.html">test suite</a>,
I wanted to make it generate another file after the test result file was generated,
so I had to monkey-patch their test framework
(see the section after this article for why I had to do it).</p>

<p><a href="http://en.wikipedia.org/wiki/Monkey_patch">Monkey-patching</a> is a way to override or extend the behaviour of a method without changing its original source code.
This article shows you how you can do it in a beautiful way in JavaScript.</p>

  
  <h2>Original Code</h2>

<p>Let's take this class as an example.
The <code>Tester</code> class has a method <code>saveResults</code> that saves the test result to a file specified by <code>filepath</code>.</p>
<pre><code>function Tester() {
}

Tester.prototype.saveResults = function(filepath) {
  console.log('Save test result to ' + filepath)
}

Tester.prototype.run = function() {
  console.log('Running tests...')
  this.saveResults('test.xml')
}
</code></pre>
<p>And it'd be used like this…</p>
<pre><code>var test = new Tester()
test.run()
</code></pre>
<p>Let's say that the <code>Tester</code> class is written by a third-party,
so I don't want to modify its source code.</p>

<p>However, I wanted my Tester to also generate and save a test plan file after the test result is saved.
This is where monkey-patching comes in.</p>

<h2>Stupid Monkey Patching</h2>

<p>This is the simplest way to do monkey patching.
Just copy the source code and modify it to your needs,
replacing the original function.</p>
<pre><code>var test = new Tester()

test.saveResults = function(filepath) {
  console.log('Save test result to ' + filepath)        // old code
  var planpath = filepath.replace('.xml', '_plan.xml')  // new code
  console.log('Save test plan to ' + planpath)          // new code
}

test.run()
</code></pre>
<p>It works but you have to duplicate some code from the source code.</p>

<p>There has to be a better way…</p>

<h2>Store a Reference to the Original Function</h2>

<p>We can store a reference to the original function,
and call it in our new function.</p>
<pre><code>var test = new Tester()

var originalSaveResults = test.saveResults
test.saveResults = function(filepath) {
  originalSaveResults.apply(this, arguments)
  var planpath = filepath.replace('.xml', '_plan.xml')
  console.log('Save test plan to ' + planpath)
}

test.run()
</code></pre>
<p>But how could you be sure that the function that calls <code>saveResults</code> doesn't use its return value?
We can save the return value from the original function and return it to preserve its return value, whatever it might be:</p>
<pre><code>var test = new Tester()

var originalSaveResults = test.saveResults
test.saveResults = function(filepath) {
  var returnValue = originalSaveResults.apply(this, arguments)
  var planpath = filepath.replace('.xml', '_plan.xml')
  console.log('Save test plan to ' + planpath)
  return returnValue
}

test.run()
</code></pre>
<p>Having to do this every time we monkey-patch a function seems to me like a lot of work.</p>

<p>There has to be a better way…</p>

<h2>Meet the <code>override</code> function</h2>

<p>When we override a method, we</p>

<ol>
<li>save the original function in a variable, and</li>
<li>replace that method with the function we desire to use.</li>
</ol>

<p>So I factored it out. Here's our override function:</p>
<pre><code>function override(object, methodName, callback) {
  object[methodName] = callback(object[methodName])
}
</code></pre>
<p>What it does is this:
it sends the original function into the <code>callback</code> function,
and whatever that <code>callback</code> function returns,
we replace the object's method with it.</p>

<p>Here's how we can use it:</p>
<pre><code>var test = new Tester()

override(test, 'saveResults', function(original) {
  return function(filepath) {
    var returnValue = original.apply(this, arguments)
    var planpath = filepath.replace('.xml', '_plan.xml')
    console.log('Save test plan to ' + planpath)
    return returnValue
  }
})

test.run()
</code></pre>
<p>Now it's very clear that we are overriding a function,
and no more do we have save the original function in a variable—it gets passed into the callback function.
Also,
instead of having to write the name of the method to monkey-patch twice,
we only have to write it once.</p>

<p>However,
having to call the original function,
and save its return value,
and return it myself does not look ideal…</p>

<p>There has to be a better way…</p>

<h2>Meet the <code>after</code> decorator</h2>

<p>You see the pattern:
in the function we want to replace,
we</p>

<ol>
<li>call the original function,</li>
<li>save its return value,</li>
<li>do our work, and</li>
<li>return the saved return value.</li>
</ol>

<p>We can factor that out too. Meet the <code>after</code> function:</p>
<pre><code>function after(extraBehavior) {
  return function(original) {
    return function() {
      var returnValue = original.apply(this, arguments)
      extraBehavior.apply(this, arguments)
      return returnValue
    }
  }
}
</code></pre>
<p>It's a <a href="http://javascript.info/tutorial/decorators">decorator</a>.
It takes a function <code>extraBehavior</code>,
and return a function suitable for passing to <code>override</code>—a function that takes the original function and return the altered behavior.
We can use it like this.</p>
<pre><code>override(test, 'saveResults', after(function(filepath) {
  var planpath = filepath.replace('.xml', '_plan.xml')
  console.log('Save test plan to ' + planpath)
}))
</code></pre>
<hr>

<h2>Meet the Other Decorators</h2>

<p>Here are some other decorators,
just to give you some idea how far you can go with it.</p>

<h3><code>before</code></h3>
<pre><code>function before(extraBehavior) {
  return function(original) {
    return function() {
      extraBehavior.apply(this, arguments)
      return original.apply(this, arguments)
    }
  }
}
</code></pre>
<h3><code>compose</code></h3>
<pre><code>function compose(extraBehavior) {
  return function(original) {
    return function() {
      return extraBehavior.call(this, original.apply(this, arguments))
    }
  }
}
</code></pre>
<p>Let's say you want to make <code>getName</code> always return the name uppercased:</p>
<pre><code>override(person, 'getName', compose(function(name) {
  return name.toUpperCase()
}))
</code></pre>
<h3><code>benchmark</code></h3>
<pre><code>function benchmark(original) {
  return function() {
    var startTime = new Date().getTime()
    var returnValue = original.apply(this, arguments)
    var finishTime = new Date().getTime()
    console.log('Took', finishTime - startTime, 'ms.')
    return returnValue
  }
}
</code></pre>
<h3><code>memoize</code></h3>
<pre><code>// XXX: Work only with functions with 1 argument.
function memoize(original) {
  var memo = { }
  return function(x) {
    if (Object.prototype.hasOwnProperty.call(memo, x)) return memo[x]
    memo[x] = original.call(this, x)
    return memo[x]
  }
}
</code></pre>
<p>Well, maybe we might want to memoize a recursive function.</p>
<pre><code>var fibonacci = {
  fib: function(x) {
    return x &lt;= 1 ? x : this.fib(x - 1) + this.fib(x - 2)
  }
}
override(fibonacci, 'fib', memoize)
console.log(fibonacci.fib(42)) // ~6111ms without memoize,
                               //     0ms with memoize.
</code></pre>
<h2>Using These Decorators on Their Own</h2>

<p>Of course, it's possible to use these decorators on their own.
Here's how I measured the speed of the above benchmark of <code>memoize</code> decorator:</p>
<pre><code>benchmark(fibonacci.fib.bind(fibonacci))(42)
override(fibonacci, 'fib', memoize)
benchmark(fibonacci.fib.bind(fibonacci))(42)
</code></pre>
<h2>Afterthoughts</h2>

<p>Monkey-patching is extremely useful when you want to modify the behavior of some methods,
but you don't want to alter its source code.
For example,
when attaching some extra behavior or when working around an issue in a third-party library.</p>

<p>However,
I don't recommend using it in your own code
because when you read the original function,
it will be hard to predict if some extra behavior will run
because it's been monkey-patched somewhere else in your application or not.</p>

<p>Here's a case study:</p>

<p>My Twitter client, thaiWitter,
has a lot of base functionalities hard-coded.
Additional functionalities are added by monkey-patching these classes on top of one another.</p>

<p>Soon the code became a big mess.
It's hard to test and debug.</p>

<p>The lessons I learned is this:
it's better to make an object extensible explicitly
(using hooks, events, or whatever)
than implicitly (monkey patches on top of monkey patches).</p>

<hr>

<h2>Why I had to do monkey-patch CasperJS</h2>

<h3>Capturing Screenshot when Test Failed</h3>

<p>CasperJS's <a href="http://docs.casperjs.org/en/latest/modules/tester.html"><code>tester</code></a> module fires the <code>fail</code> event when an assertion failure occurs. We could have used that instead.</p>

<p>However, when we tell CasperJS to abort the test suite on first failure (don't keep going on) with the <code>--fail-fast</code> flag turned on,
CasperJS doesn't call the registered event handler!</p>

<p>So we had to work around by monkey-patching the function that gets called when an error or an assertion failure occurs:</p>
<pre><code>override(test.currentSuite, 'addFailure', after(handleFailure))
override(test.currentSuite, 'addError',   after(handleFailure))
</code></pre>
<h3>Generating Test Plans</h3>

<p>Furthermore, we want to be able to generate a test plan document in addition to the test result,
and that's just what we did in the article:</p>
<pre><code>override(test, 'saveResults', after(savePlan))
</code></pre>
</div>
					
					</div>
				</article>
				<!--================= END :: Tutorial =================-->
				
				<!--================= START :: Tutorial =================-->
				<article>
					<a id="t-60" name="t-60"></a><h1>60 : Functional Programming in JavaScript</h1>
					<span class="ref-site">http://dealwithjs.io/functional-programming-in-javascript/</span>
					<div class="tutorial__content">
<section class="post-content">
            <p><a name="top"></a>  </p>

<h3 id="tldr">TL; DR</h3>

<p>Functional programming needs a different mindset than most of the developers/software engineers/programmers are used to. In this blog post I explain the main concepts of functional programming with examples written in JavaScript. Additional articles will follow with more in-depth details of Functional Programming in JS.</p>

<p>Source code can be found on <a href="https://github.com/gergob">GitHub</a>, in the <a href="https://github.com/gergob/jsFunctionalProgramming">jsFunctionalProgramming</a> repo.</p>

<blockquote>
  <p>I would like to thank <a href="http://dealwithjs.io/author/csaba/">Csaba Hellinger</a> for the support and input he offered for writing this article.</p>
</blockquote>

<hr>

<h1 id="part1">PART 1</h1>

<h4 id="tableofcontents">Table of Contents</h4>

<ol>
<li><a href="#whyFunctionalProgramming">Why Functional Programming</a></li>
<li><a href="#functionalJS">f(x) = = = J(s)</a></li>
<li><a href="#firstClassFunctions">First Class Functions</a></li>
<li><a href="#tailCallOptimization">Tail Call Optimization</a></li>
<li><a href="#testingRecursiveCalls">Testing Recursive Calls</a></li>
</ol>

<p>Functional programming evolves from the <a href="https://en.wikipedia.org/wiki/Lambda_calculus">Lambda Calculus</a> which (on a very high level) is a Mathematical Abstraction of function representation and how these representations should be evaluated.</p>

<blockquote>
  <p>Functional programming is a declarative programming paradigm.</p>
</blockquote>

<h4 id="anamewhyfunctionalprogrammingawhyfunctionalprogrammingtop"><a name="whyFunctionalProgramming"></a>Why Functional Programming ? <a href="#top">^</a></h4>

<p>Using functional programming has some specific characteristics: </p>

<ol>
<li><strong>Avoiding State Change (and mutable data)</strong> - one of the characteristics of functional programming is that functions do not change the state of the application, they rather create a new state from the old one.  </li>
<li><strong>Declarations vs statements</strong> - in functional programming as in Mathematics a declarative approach is used for defining/describing functions.  </li>
<li><strong>Idempotence</strong> - it means when invoking a function (any number of times) using the same arguments will always have the same result, this also goes hand in hand with avoiding state change.</li>
</ol>

<p>These three reasons do not seem to mean much at first glance, but if we analyze this more in depth we figure out that because of the three characteristics the following use cases are good candidates for functional programming:</p>

<ol>
<li><strong>Parallel code execution</strong> - because of the <strong>Idempotence</strong> and <strong>Avoiding State Change</strong> properties of functional programming, the code written in a functional manner can be parallelized easier since there will not be synchronization issues.  </li>
<li><strong>Concise/Compact Code</strong> - since functional programming has a declarative approach the code does not have additional algorithmic steps like there is in procedural programming.  </li>
<li><strong>Different mindset</strong> - once you coded in a real functional programming language you will develop a new mindset and a new way of thinking when writing applications.</li>
</ol>

<h4 id="anamefunctionaljsafxjstop"><a name="functionalJS"></a> f(x) === J(s) <a href="#top">^</a></h4>

<p><strong>Is JavaScript a real (purely) functional programming language?</strong></p>

<blockquote>
  <p>NO! JavaScript is not a pure functional programming language...</p>
</blockquote>

<h5 id="anamefirstclassfunctionsafirstclassfunctionstop"><a name="firstClassFunctions"></a>First-class Functions <a href="#top">^</a></h5>

<p><strong>BUT</strong> it can be used well for functional programming because it has <strong>first-class</strong> functions. By definition a programming language has <strong>first-class</strong> functions, if it handles functions as any other type within the language. For example functions can be passed as arguments to other functions or can be assigned to variables. </p>

<p>We will examine some first class function, but first lets start with building blocks which we need to have in order to use JS as a real functional programming language. </p>

<p>In most of the pure functional programming languages (Haskell, Clean, Erlang) there are no <code>for</code> or <code>while</code> loops, so iterating over lists needs to be done using recursive functions. Pure functional programming languages have language support and are optimized for list comprehension and list concatenation.</p>

<p>Here is an implementation of a functional <code>for</code> loop, we will use this in our code later on, but you will see this has limitations in JS since <a href="http://www.2ality.com/2015/06/tail-call-optimization.html">tail call optimization</a> is not widely supported (yet), but more on this later. </p>

<pre><code>function funcFor(first, last, step, callback) {

    //
    // recursive inner function
    //
    function inner(index) {
        if ((step &gt; 0 &amp;&amp; index &gt;= last) || (step &lt; 0 &amp;&amp; index &lt; last)) {
            return;
        }

        callback(index);

        //
        // next (proper tail call)
        //
        inner(index + step);
    }

    //
    // start with the first
    //
    inner(first);
}
</code></pre>

<p>The <code>inner</code> function contains the stop condition handling, it invokes the <code>callback</code> with the <code>index</code> value and the recursive call <code>inner(index + step)</code> ensures the loop passes on to the next step.</p>

<blockquote>
  <p>Recursion is an important aspect of functional programming.</p>
</blockquote>

<p>Now lets see some real first class functions:</p>

<pre><code>function applyIfAllNumbers(items, fn) {  
    if(areNumbers(items)) {
        return funcMap(items, fn);
    }
    return [];
}
</code></pre>

<p>The purpose of the <code>applyIfAllNumbers</code> function is, to invoke the <code>fn</code> function for each number in the <code>items</code> parameter, but ONLY if all the elements in the <code>items</code> array are numbers. </p>

<p>Below are the validator functions:</p>

<pre><code>function areNumbers(numbers) {  
    if (numbers.length === 0) {
        return true;
    }
    else {
        return isNumber(numbers[0]) &amp;&amp;
               areNumbers(numbers.slice(1));
    }
}

function isNumber(n) {  
    return isFinite(n) &amp;&amp; +n === n;
}
</code></pre>

<p>The code is straightforward, the <code>isNumber</code> returns <code>true</code> if the parameter is a number, otherwise <code>false</code>. The <code>areNumbers</code> reuses the <code>isNumber</code> to determine if all the elements in the <code>numbers</code> array are numbers or not(<strong>again, recursion was used to implement the logic</strong>).</p>

<p>Another example is <code>applyForNumbersOnly</code>:  </p>

<pre><code>function applyForNumbersOnly(items, fn) {  
    let numbers = filter(items, isNumber);
    return funcMap(numbers, fn);
}
</code></pre>

<p>Which can be simplified even more:</p>

<pre><code>function applyForNumbersOnly(items, fn) {  
    return funcMap(filter(items, isNumber), fn);
}
</code></pre>

<p><code>applyForNumbersOnly</code> invokes the <code>fn</code> method only for numbers in the <code>items</code> collection.</p>

<p>The <code>funcMap</code> function is the re-implementation of the well known <code>map</code> function from functional programming, but here I used the <code>funcForEach</code> implementation to create it:</p>

<pre><code>function funcForEach(items, fn) {  
    return funcFor(0, items.length, 1, function(idx) {
        fn(items[idx]);
    });
}

function funcMap(items, fn) {  
    let result = [];
    funcForEach(items, function(item) {
        result.push(fn(item));
    });
    return result;
}
</code></pre>

<p>Last we have the <code>filter</code> function which, again, uses recursion to apply the filter logic.</p>

<pre><code>function filter(input, callback) {  
    function inner(input, callback, index, output) {
        if (index === input.length) {
            return output;
        }
        return inner(input, 
                     callback, 
                     index + 1, 
                     callback(input[index]) ? output.concat(input[index]) : output);
    }
    return inner(input, callback, 0, []);
}
</code></pre>

<h4 id="anametailcalloptimizationatailcalloptimizationtcoinjstop"><a name="tailCallOptimization"></a>Tail call optimization (TCO) in JS <a href="#top">^</a></h4>

<p>In the <a href="http://www.ecma-international.org/ecma-262/6.0/#sec-tail-position-calls">EcmaScript 2015 TCO</a> specs there are some use-cases defined when the language should support tail call optimization. One of the most important requirements is to <code>"use strict"</code> mode in your code, otherwise JS cannot apply the TCO.</p>

<p>There is no built in method to detect if a browser supports TCO or not, this has to be done through code:</p>

<pre><code>"use strict";

function isTCOSupported() {  
    const outerStackLen = new Error().stack.length;
    // name of the inner function mustn't be longer than the outer!
    return (function inner() {
        const innerStackLen = new Error().stack.length;
        return innerStackLen &lt;= outerStackLen;
    }());
}

console.log(isTCOSupported() ? "TCO Available" : "TCO N/A");  
</code></pre>

<p>Here is an example of the functional re-implementation of <code>Math.pow</code> function, which can benefit from the TCO in EcmaScript 2015.</p>

<blockquote>
  <p>This <code>pow</code> implementation uses <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Functions/Default_parameters">ES6 default parameters</a> to simplify implementation.</p>
</blockquote>

<pre><code>function powES6(base, power, result=base) {  
    if (power === 0) {
        return 1;
    }

    if (power === 1) {
        return result;
    }

    return powES6(base, power - 1, result * base);
}
</code></pre>

<p>First thing to note is that we have three arguments instead of two. The third parameter holds the result of the calculation. We have to carry the <code>result</code> around in order to have an implementation where our recursive call is really a tail call and JS can use his TCO technique. </p>

<p>In case we cannot use ES6 features, besides that I do not recommend using recursive implementation because the language will not offer support for optimization, the implementation is more complex:</p>

<pre><code>function recursivePow(base, power, result) {  
    if (power === 0) {
        return 1;
    }
    else if(power === 1) {
        return result;
    }

    return recursivePow(base, power - 1, result * base);
}

function pow(base, power) {  
    return recursivePow(base, power, base);
}
</code></pre>

<p>We separated the recursive calculation to another function <code>recursivePow</code>, this takes three arguments as the <code>powES6</code> did. Using a new function and passing the <code>base</code> parameter to it we implemented the default parameter initialization logic from ES6.</p>

<p>On <a href="https://kangax.github.io/compat-table/es6/#test-proper_tail_calls_" title="tail_call_optimisation">this page</a> you can check how widely is the TCO implemented by different browsers and platforms.</p>

<p>Since <strong>Safari 10</strong> is the browser which fully supports TCO (at the time of writing this article) I will run some tests with the <code>pow</code> function to see how well does it perform.</p>

<h4 id="anametestingrecursivecallsatestingrecursivecallstop"><a name="testingRecursiveCalls"></a>Testing Recursive Calls <a href="#top">^</a></h4>

<p>I used the <code>powES6</code> and <code>pow</code> functions with the following test code:</p>

<pre><code>"use strict";

function stressPow(n) {  
    var result = [];
    for (var i=0; i&lt;n; ++i) {
        result.push(
          pow(2, 0),
          pow(2, 1),
          pow(2, 2),
          pow(2, 3),
          pow(2, 4),
          pow(2, 5),
          pow(2, 10),
          pow(2, 20),
          pow(2, 30),
          pow(1, 10000),
          pow(2, 40),
          pow(3, 10),
          pow(4, 15),
          pow(1, 11000),
          pow(3.22, 125),
          pow(3.1415, 89),
          pow(7, 2500),
          pow(2, 13000)
        );
    }

    return result;
}

var start = performance.now();  
var result_standard = stressPow(2500);  
var duration = performance.now() - start;  
console.log(result_standard);  
console.log(`Duration: ${duration} ms.`);
</code></pre>

<p>I executed this JS code on Chrome v55, Firefox v50,  Safari v9.2 and Safari v10.  </p>

<table style="border: 1px solid #efefef;" border="1">  
  <thead>
    <tr>
      <th style="text-align:center; width:60px">Nr. </th>
      <th style="text-align:center">Chrome v55 (ms)</th>
      <th style="text-align:center">FF v50 (ms)</th>
      <th style="text-align:center">Safari 9.2 (ms)</th>
      <th style="text-align:center">Safari 10 (ms)</th>
    </tr>
  </thead>
  <tbody>
   <tr>
      <td style="text-align:right">1</td>
      <td style="text-align:right">1076.12</td>
      <td style="text-align:right">499.1</td>
      <td style="text-align:right">431.94</td>
      <td style="text-align:right">398.51</td>
    </tr>

<tr>  
      <td style="text-align:right">2</td>
      <td style="text-align:right">1061.20</td>
      <td style="text-align:right">499.36</td>
      <td style="text-align:right">479.20</td>
      <td style="text-align:right">373.59</td>
    </tr>

<tr>  
      <td style="text-align:right">3</td>
      <td style="text-align:right">1069.27</td>
      <td style="text-align:right">518.75</td>
      <td style="text-align:right">415.98</td>
      <td style="text-align:right">368.53</td>
    </tr>

<tr>  
      <td style="text-align:right">4</td>
      <td style="text-align:right">1056.84</td>
      <td style="text-align:right">499.98</td>
      <td style="text-align:right">423.72</td>
      <td style="text-align:right">373.79</td>
    </tr>

<tr>  
      <td style="text-align:right">5</td>
      <td style="text-align:right">1043.06</td>
      <td style="text-align:right">511.05</td>
      <td style="text-align:right">429.64</td>
      <td style="text-align:right">361.37</td>
    </tr>

<tr>  
      <td style="text-align:right">6</td>
      <td style="text-align:right">1056.72</td>
      <td style="text-align:right">505.59</td>
      <td style="text-align:right">424.78</td>
      <td style="text-align:right">361.26</td>
    </tr>

<tr>  
      <td style="text-align:right">7</td>
      <td style="text-align:right">1096.32</td>
      <td style="text-align:right">507.68</td>
      <td style="text-align:right">427.83</td>
      <td style="text-align:right">358.30</td>
    </tr>

<tr>  
      <td style="text-align:right">8</td>
      <td style="text-align:right">1099.12</td>
      <td style="text-align:right">515.85</td>
      <td style="text-align:right">436.83</td>
      <td style="text-align:right">356.68</td>
    </tr>
<tr>  
      <td style="text-align:right">9</td>
      <td style="text-align:right">1016.51</td>
      <td style="text-align:right">504.91</td>
      <td style="text-align:right">425.74</td>
      <td style="text-align:right">362.77</td>
    </tr>
<tr>  
      <td style="text-align:right">10</td>
      <td style="text-align:right">1056.65</td>
      <td style="text-align:right">530.31</td>
      <td style="text-align:right">430.95</td>
      <td style="text-align:right">368.32</td>
    </tr>
<tr>  
      <td style="text-align:right; font-weight:bold">AVG</td>
      <td style="text-align:right; font-weight:bold">1063.18</td>
      <td style="text-align:right; font-weight:bold">509.25</td>
      <td style="text-align:right; font-weight:bold">432.66</td>
      <td style="text-align:right; font-weight:bold">368.33</td>
    </tr>
  
</tbody></table>

<h5 id="conclusion">Conclusion</h5>

<p>Looking at the measurements it can be seen that Safari is the best performer if it comes to recursive function execution. Safari 10 with his TCO optimization support for JavaScript is the fastest, around ~2.8 times faster than running the code inside Chrome. Firefox performs almost as good as Safari 9.2 which was a surprise for me.</p>

<p>If you enjoyed reading this blog post, please share it or like the <a href="https://www.facebook.com/dealwithjs">Facebook page</a> of the website to get regular updates. You can also follow us <a href="https://twitter.com/dealwithjs">@dealwithjs</a>.</p>

<p>Lets stay functional!</p>

<blockquote>
  <p>PART 2 will come shortly with high order functions and samples how to implement procedural code in functional style. </p>
</blockquote>
        </section>
					</div>
				</article>
				<!--================= END :: Tutorial =================-->
				
				<!--================= START :: Tutorial =================-->
				<article>
					<a id="t-61" name="t-61"></a><h1>61 : Design Patterns - The Adapter Pattern in JavaScript</h1>
					<span class="ref-site"></span>
					<div class="tutorial__content">

<section class="post-content">
	<p><a name="top"></a>  </p>

<h3 id="tldr">TL; DR</h3>

<p>Source code can be found on <a href="https://github.com/gergob">GitHub</a>, <a href="https://github.com/gergob/jsAdapter">jsAdapter repo</a></p>

<hr>

<h3 id="designpatternstheadapter">Design Patterns - The Adapter</h3>

<p><a href="https://en.wikipedia.org/wiki/A_picture_is_worth_a_thousand_words">A picture is worth a thousand words</a>, this is for sure true once the Adapter design pattern needs to be explained.</p>

<p>Most of us has seen something like this:</p>



<p>This is a travel plug sometimes it is called plug adaptor. The plug adapter adapts (transforms) one electrical interface to another. In this case the EU standard to the US standard.</p>

<p>It is important to highlight without the adapter the two interfaces cannot communicate with each other. Another important aspect of using/creating adapters is, that adapters are always created for existing components, which need to interact.</p>

<blockquote>
  <p>There are only minor differences between the Adapter, Decorator, Facade and Bridge design patterns, we will cover these in a future blog post.</p>
</blockquote>

<p>Lets assume there is a project, which has a logger library. This was written by the initial project team and is not the most developer friendly to use. Since this project specific logger library was developed, new logger libraries appeared on the market and the project should be able to use these. <br>
One way to solve this is to write adapter(s) for the logger libraries and use those.</p>

<p>The current logger in our imagined app is this:</p>

<pre><code>function BadLogger(name) {  
    this.name = name;
    var LOG_HEADER = '[' + name + ']:';
    var self = this;

    return {
        getName: function getName() {
            return self.name;
        },
        getType: function getType() {
            return 'BadLogger';
        },
        information: function information(message) {
            console.info(LOG_HEADER + message + '- INFORMATION' );
        },
        debg: function debg(message) {
            console.log(LOG_HEADER + message + '- DEBG');
        },
        w: function w(message) {
            console.warn(LOG_HEADER + message + '- W' );
        },
        err: function err(message) {
            console.error(LOG_HEADER + message+ '- ERR' );
        }
    }
}

module.exports = {  
    getLogger: BadLogger
}
</code></pre>

<p>
I don't want to go into details why this is a bad logger (module named as <code>BadLogger</code> too), but it can be seen that the function names are not quite intuitive and don't really respect any naming convention.</p>

<p>There is another logger which we might want to use:</p>

<pre><code>function ShortLogger(name) {  
    this.name = name;
    var LOG_HEADER = '[' + name + ']';
    var self = this;
    var getTime = function() {
        return '[' + new Date().toISOString() + ']';
    }
    return {
        getName: function getName() {
            return self.name;
        },
        getType: function getType() {
            return 'ShortLogger';
        },
        i: function i(message) {
            console.info(LOG_HEADER + getTime() + '[I]: ' + message);
        },
        d: function d(message) {
            console.log(LOG_HEADER + getTime() + '[D]: ' + message);
        },
        w: function w(message) {
            console.warn(LOG_HEADER + getTime() + '[W]: ' + message);
        },
        e: function e(message) {
            console.error(LOG_HEADER + getTime() + '[E]: ' + message);
        }
    }
}

module.exports = {  
    getLogger: ShortLogger
}
</code></pre>

<p>As we can see this applies the Android Logger like standard, where the name of the log method is the first letter of the log message type, for example <code>w</code> stands for <code>warning</code>. </p>

<p>In this case the role of the adapter is to give the possibility to the development team to use any kind of logger what they want. </p>

<p>When building adapters there are two approaches:</p>

<ol>
<li><p>Build adapters for every component which have to interact with each other. In this case it means to build two adapters, one for <code>ShortLogger</code> and one for <code>BadLogger</code>.</p></li>
<li><p>Build one adapter which can adapt any of the same type component. In this case it means to build one Adapter which should handle any logger type.</p></li>
</ol>

<p>Lets stick to the second approach, below is the code for the <code>LoggerAdapter</code> module:</p>

<pre><code>var ShortLogger = require('./ShortLogger');  
var BadLogger = require('./BadLogger');

function LoggerAdapter(loggerObj) {  
    if (!loggerObj) {
        throw Error('Parameter [loggerObj] is not defined.');
    }
    console.log('[LoggerAdapter] is using Logger with name: ' + loggerObj.getName());
    var CONSTANTS = {
        DEBUG: 'DEBUG',
        WARNING: 'WARNING',
        INFORMATION: 'INFORMATION',
        ERROR: 'ERROR',
        BAD_LOGGER: 'BadLogger',
        SHORT_LOGGER: 'ShortLogger'
    };
    var loggerFunctionMapper = {};

    if(loggerObj.getType() === CONSTANTS.BAD_LOGGER) {
        loggerFunctionMapper[CONSTANTS.DEBUG] = loggerObj.debg;
        loggerFunctionMapper[CONSTANTS.INFORMATION] = loggerObj.information;
        loggerFunctionMapper[CONSTANTS.WARNING] = loggerObj.w;
        loggerFunctionMapper[CONSTANTS.ERROR] = loggerObj.err;
    }
    else if (loggerObj.getType() === CONSTANTS.SHORT_LOGGER) {
        loggerFunctionMapper[CONSTANTS.DEBUG] = loggerObj.d;
        loggerFunctionMapper[CONSTANTS.INFORMATION] = loggerObj.i;
        loggerFunctionMapper[CONSTANTS.WARNING] = loggerObj.w;
        loggerFunctionMapper[CONSTANTS.ERROR] = loggerObj.e;
    }

    function information(message) {
        try {
          loggerFunctionMapper[CONSTANTS.INFORMATION](message);
        }
        catch(err) {
            throw Error('No implementation for Logger: ' + loggerObj.toString());
        }
    };

    function debug(message) {
        try {
          loggerFunctionMapper[CONSTANTS.DEBUG](message);
        }
        catch(err) {
            throw Error('No implementation for Logger: ' + loggerObj.toString());
        }
    };
...
    return {
        debug: debug,
        information: information,
        warning: warning,
        error: error
    }
}

module.exports = {  
    LoggerAdapter: LoggerAdapter
}
</code></pre>

<p>When creating the adapter, a <code>loggerObj</code> has to be passed in, this is used for the real logging.</p>

<p>Once the project is refactored to use the <code>LoggerAdapter</code> for logging, the underlying logger can be changed much easier. </p>

<p>All the magic in the adapter is the <code>if/else</code> part at the beginning:</p>

<pre><code>if(loggerObj.getType() === CONSTANTS.BAD_LOGGER) {  
        loggerFunctionMapper[CONSTANTS.DEBUG] = loggerObj.debg;
        loggerFunctionMapper[CONSTANTS.INFORMATION] = loggerObj.information;
        loggerFunctionMapper[CONSTANTS.WARNING] = loggerObj.w;
        loggerFunctionMapper[CONSTANTS.ERROR] = loggerObj.err;
    }
    else if (loggerObj.getType() === CONSTANTS.SHORT_LOGGER) {
        loggerFunctionMapper[CONSTANTS.DEBUG] = loggerObj.d;
        loggerFunctionMapper[CONSTANTS.INFORMATION] = loggerObj.i;
        loggerFunctionMapper[CONSTANTS.WARNING] = loggerObj.w;
        loggerFunctionMapper[CONSTANTS.ERROR] = loggerObj.e;
    }
</code></pre>

<p>This is where we adapt the interfaces, depending on the type of log message and <code>loggerObj</code> we map the correct function to the log message type.</p>

<p>In case a new logger library needs to be supported, lets say a remote logger library which logs to a RESTful API, only this mapping needs to be adjusted and the new logger library can be used. </p>

<p>Below is a use case of the <code>LoggerAdapter</code>:</p>

<pre><code>var ShortLogger = require('./ShortLogger');  
var BadLogger = require('./BadLogger');  
var LoggerAdapter = require('./LoggerAdapter');  
var shortLog = ShortLogger.getLogger('ShortLoger');  
var badLogger = BadLogger.getLogger('BadLogger');

var loggerAdapter = LoggerAdapter.LoggerAdapter(badLogger);  
loggerAdapter.information('This is logged through LoggerAdapter');  
loggerAdapter.debug('This is logged through LoggerAdapter');  
loggerAdapter.warning('This is logged through LoggerAdapter');  
loggerAdapter.error('This is logged through LoggerAdapter');

console.log();

var loggerAdapter2 = LoggerAdapter.LoggerAdapter(shortLog);  
loggerAdapter2.information('Now This is logged through LoggerAdapter');  
loggerAdapter2.debug('Now This is logged through LoggerAdapter');  
loggerAdapter2.warning('Now This is logged through LoggerAdapter');  
loggerAdapter2.error('Now This is logged through LoggerAdapter');
</code></pre>

<p>Once this finished, the output was the following:</p>

<pre><code>[LoggerAdapter] is using Logger with name: BadLogger
[BadLogger]:This is logged through LoggerAdapter- INFORMATION
[BadLogger]:This is logged through LoggerAdapter- DEBG
[BadLogger]:This is logged through LoggerAdapter- W
[BadLogger]:This is logged through LoggerAdapter- ERR

[LoggerAdapter] is using Logger with name: ShortLoger
[ShortLoger][2016-11-23T21:10:59.729Z][I]: Now This is logged through LoggerAdapter
[ShortLoger][2016-11-23T21:10:59.729Z][D]: Now This is logged through LoggerAdapter
[ShortLoger][2016-11-23T21:10:59.730Z][W]: Now This is logged through LoggerAdapter
[ShortLoger][2016-11-23T21:10:59.730Z][E]: Now This is logged through LoggerAdapter
</code></pre>

<hr>

<p>If you enjoyed reading this post, please share it or like the <a href="https://www.facebook.com/dealwithjs">Facebook page</a> of the website to get regular updates. You can also follow us <a href="https://twitter.com/dealwithjs">@dealwithjs</a>.</p>
        </section>
					
					</div>
				</article>
				<!--================= END :: Tutorial =================-->
				
				<!--================= START :: Tutorial =================-->
				<article>
					<a id="t-62" name="t-62"></a><h1>62 : Design Patterns - The Factory Pattern in JavaScript</h1>
					<span class="ref-site">http://dealwithjs.io/design-patterns-the-factory-pattern-in-javascript/</span>
					<div class="tutorial__content">
<section class="post-content">
            <p><a name="top"></a>  </p>

<h3 id="tldr">TL; DR</h3>

<p>Source code can be found on <a href="https://github.com/gergob">GitHub</a>, <a href="https://github.com/gergob/jsFactory">jsFactory repo</a></p>



<h3 id="designpatternsthefactory">Design Patterns - The Factory</h3>

<h4 id="tableofcontents">Table of Contents</h4>

<ol>
<li><a href="#designPatterns">Design Patterns</a></li>
<li><a href="#factoryPattern">The Factory Pattern</a> </li>
<li><a href="#factoryPatternJS">Factory Pattern in JS</a> </li>
<li><a href="#simpleFactory">Simple Factory</a></li>
<li><a href="#configurableFactory">Configurable Factory</a></li>
<li><a href="#demo">Demo</a></li>
</ol>

<h4 id="anamedesignpatternsadesignpatternstop"><a name="designPatterns"></a>Design Patterns <a href="#top">^</a></h4>

<p>A design pattern is the re-usable form of a solution to a design problem. <sup id="fnref:1"><a href="#fn:1" rel="footnote">1</a></sup></p>

<blockquote>
  <p>In 1977 <a href="https://en.wikipedia.org/wiki/Christopher_Alexander">Christopher Alexander</a>, at that time a well-known architect, published a book, titled <a href="https://en.wikipedia.org/wiki/A_Pattern_Language">A Pattern Language</a>. He explained his ideas about incremental and organic design and laid the foundations of Design Patterns.</p>
</blockquote>

<p>In 1994 was released <strong>the Design Pattern book</strong>, the book which is the symbol of the Design Pattern topic, the classic written by the <a href="http://wiki.c2.com/?GangOfFour">Gang of Four</a>: <strong>Design Patterns: Elements of Reusable Object-Oriented Software</strong>. All the examples in this book were written in C++ and presented using C++'s language features. Understanding this book and the examples in this book is not a trivial task.</p>

<p>You may ask why do we need design patterns? The answer is simple, first of all design patterns offer solutions to problems which might appear in our apps. Of course, there are multiple solutions for these issues... <strong>BUT</strong> the solutions which design patterns offer have been proven and tested by thousands of engineers so we can rely on these. </p>

<h4 id="anamefactorypatternathefactorypatterntop"><a name="factoryPattern"></a>The Factory Pattern <a href="#top">^</a></h4>

<p>The Factory design pattern is one of the most simple design patterns. The main idea of this pattern is to have a common place (function, object, class, module) which is used to initialize (create) objects within the application. Imagine, if you want to update an existing type/object, lets say you want to add two more properties to an <code>Employee</code> type. This <code>Employee</code> type is used all over the modules inside your app (login, products and services, salary module, employee tracking, career management and so on).</p>

<p>Just imagine if the creation of objects is spread over hundreds of files within an application, maintaining and handling that large amount of files is very error-prone when the object creation logic needs to be updated. Missing to adjust some of the places where the objects are created can cause misbehavior, crash, data corruption in the application.</p>

<p>If the creation of the objects (in our case of type <code>Employee</code> but not only) is not controlled by a single component (a factory) then, you would need to change the code everywhere in the application where a new <code>Employee</code> is created. Once the creation of the objects is centralized, the number of affected code files, classes, modules is much smaller when this type of change is needed.</p>

<p><strong>The Factory design pattern is a creational design pattern</strong>. </p>

<p>Creational Design patterns are the ones which usually everyone knows about, mostly because during development most of us faced situations when there was need to create multiple objects and everyone knew (or felt) these objects should be created in the same place or at least in the same manner. Some of the commonly known design patterns are Factory, Abstract Factory, Builder and of course Singleton.</p>

<h4 id="anamefactorypatternjsafactorypatterninjstop"><a name="factoryPatternJS"></a>Factory Pattern in JS <a href="#top">^</a></h4>

<p>There are multiple ways to implement the Factory pattern within JavaScript, I implemented two factories, <code>SimpleFactory</code> and <code>ConfigurableFactory</code>. Both of these will serve the same purpose, creating different type of <code>Employee</code> objects.</p>

<h5 id="anamesimplefactoryasimplefactorytop"><a name="simpleFactory"></a>Simple Factory <a href="#top">^</a></h5>

<p>The <code>SimpleFactory</code> is a <a href="https://nodejs.org/en/">node</a> module. Inside the constructor function, I defined three methods <code>getSalesEmployee</code>, <code>getEngineerEmployee</code>, <code>getName</code>. The first two return <code>JSON</code> objects with different properties (based on the type of <code>Employee</code>), the last returns the name of the factory object.</p>

<pre><code>function SimpleFactory(name) {  
    var factoryName = name;

    var getSalesEmployee = function(firstName, lastName) {
        return {
            firstName: firstName,
            lastName: lastName,
            comission: 0,
            salary: 100,
            projects: [],
            type: 'sales'
        };
    }

    var getEngineerEmployee = function(firstName, lastName) {
        return {
            firstName: firstName,
            lastName: lastName,
            salary: 150,
            manager: '',
            technologies: [],
            projects: [],
            type: 'engineer'
        }
    }

    var getName = function() {
        return factoryName;
    }

    return {
        getSales: getSalesEmployee,
        getEngineer: getEngineerEmployee,
        getName: getName
    }
}

module.exports = {  
    getInstance: SimpleFactory
}
</code></pre>

<h5 id="anameconfigurablefactoryaconfigurablefactorytop"><a name="configurableFactory"></a>Configurable Factory <a href="#top">^</a></h5>

<p>The <code>ConfigurableFactory</code> can be used in a different way, since this can be extended with object creation logic dynamically and the implementation of the factory does not need to be changed.</p>

<pre><code>function ConfigurableFactory(name) {  
    var typeMapper = {};
    var factoryName = name;

    var addTypeSupport = function(typeName, buildFunc) {
        if (!typeName || (!buildFunc &amp;&amp; typeof(buildFunc) !== 'function')) {
            throw Error('typeName parameter needs to be defined and buildFunc paramter has to be a function');
        }
        var lcTypeName = typeName.toLowerCase();
        if (typeMapper[lcTypeName]) {
            throw Error('There is already a [' + typeName + '] type defined');
        }
        typeMapper[lcTypeName] = buildFunc;
    }

    var getObject = function(typeName) {
        var lcTypeName = typeName.toLowerCase();
        var builder = typeMapper[lcTypeName];

        if (builder !== undefined) {
            return builder();
        }

        throw Error('Cannot build type:[' + typeName + '], does not know how to...');
    }

    var getName = function() {
        return factoryName;
    }

    return {
        addTypeSupport: addTypeSupport,
        get: getObject,
        getName: getName
    }
}

module.exports = {  
    getInstance: ConfigurableFactory
}
</code></pre>

<p>The implementation is more complex than in the case of <code>SimpleFactory</code>. In this case there are also three methods, <code>addTypeSupport</code>, <code>getObject</code>, <code>getName</code>, but the logic within <code>addTypeSupport</code> and <code>getObject</code> is more complex.</p>

<p>When <code>addTypeSupport</code> is invoked a new property is added to the <code>typeMapper</code> object, the property name is the <code>typeName</code> parameter and the value is the <code>buildFunc</code> parameter.</p>

<p>The <code>buildFunc</code> parameter has to be a <code>function</code>, this contains the object creation logic for the type.</p>

<h5 id="anamedemoademotop"><a name="demo"></a>Demo <a href="#top">^</a></h5>

<h6 id="howtousesimplefactory">How to use <code>SimpleFactory</code>?</h6>

<p>In <a href="https://github.com/gergob/jsFactory/blob/master/FactoryDemo.js"><code>FactoryDemo</code></a> there is the <code>demoSimpleFactory</code> function, where I created <code>janeDoe</code> and <code>billDoe</code> using the <code>getSales</code> and <code>getEngineer</code> functions.</p>

<pre><code>demoSimpleFactory: function() {  
    var simpleFactory = SimpleFactory.getInstance('SimpleEmployeeFactory');

    console.log(SEPARATOR);
    console.log(HEADER_PREFIX, 'SimpleFactory sample')
    console.log(SEPARATOR);

    console.log('The factory is called: [' + simpleFactory.getName() + ']');

    console.log('We have a new sales colleague:');
    var janeDoe = simpleFactory.getSales('Jane', 'Doe');
    console.log(JSON.stringify(janeDoe, null, 2));

    console.log();
    console.log('We have a new engineer colleague:');
    var billDoe = simpleFactory.getEngineer('Bill', 'Doe');
    console.log(JSON.stringify(billDoe, null, 2));
}
</code></pre>

<p>The console output of this demo code is:</p>

<pre><code>========================================================
           SimpleFactory sample
========================================================
The factory is called: [SimpleEmployeeFactory]  
We have a new sales colleague:  
{
  "firstName": "Jane",
  "lastName": "Doe",
  "comission": 0,
  "salary": 100,
  "projects": [],
  "type": "sales"
}

We have a new engineer colleague:  
{
  "firstName": "Bill",
  "lastName": "Doe",
  "salary": 150,
  "manager": "",
  "technologies": [],
  "projects": [],
  "type": "engineer"
}
</code></pre>

<h6 id="howtouseconfigurablefactory">How to use <code>ConfigurableFactory</code>?</h6>

<p>In the same <a href="https://github.com/gergob/jsFactory/blob/master/FactoryDemo.js"><code>FactoryDemo</code></a> file, there is the <code>demoConfigurableFactory</code> function:</p>

<pre><code>demoConfigurableFactory: function() {  
    console.log(SEPARATOR);
    console.log(HEADER_PREFIX, 'ConfigurableFactory sample')
    console.log(SEPARATOR);

    var employeeFactory = ConfigurableFactory.getInstance('EmployeeFactory');

    employeeFactory.addTypeSupport('sales', function createSales() {
        return {
            firstName: '',
            lastName: '',
            comission: 0,
            projects: [],
            type: 'sales'
        };
    });

    employeeFactory.addTypeSupport('engineer', function createEngineer() {
        return {
            firstName: '',
            lastName: '',
            salary: 150,
            manager: '',
            technologies: [],
            projects: [],
            type: 'engineer'
        };
    });

    console.log('The factory is called: [' + employeeFactory.getName() + ']');

    var johnDoe = employeeFactory.get('sales');
    console.log('John Doe is:');
    console.log(JSON.stringify(johnDoe, null, 2));

    try {
        console.log('Trying to build CEO...');
        var dannyDoe = employeeFactory.get('ceo');
    } catch (e) {
        console.error(e.message);
    }
}
</code></pre>

<p>I used the <code>addTypeSupport</code> function to extend the factory's functionality so this can create <code>sales</code> and <code>engineer</code> employees.</p>

<p>The console content after running the <code>demoConfigurableFactory</code> is:</p>

<pre><code>========================================================
           ConfigurableFactory sample
========================================================
The factory is called: [EmployeeFactory]  
John Doe is:  
{
  "firstName": "",
  "lastName": "",
  "comission": 0,
  "projects": [],
  "type": "sales"
}
Trying to build CEO...  
Cannot build type:[ceo], does not know how to...  
</code></pre>

<p>I hope you enjoyed this blog post, if you think this has useful information and it can help others to learn, please share it.</p>

<p>If you want to get notifications about my upcoming articles please follow me on <a href="https://twitter.com/GergoB">@gergob</a>.</p>

<div class="footnotes"><ol><li class="footnote" id="fn:1"><p>Source: <a href="https://en.wikipedia.org/wiki/Design_pattern">https://en.wikipedia.org/wiki/Design_pattern</a> <a href="#fnref:1" title="return to article">↩</a></p></li></ol></div>
        </section>
					</div>
				</article>
				<!--================= END :: Tutorial =================-->
				
				<!--================= START :: Tutorial =================-->
				<article>
					<a id="t-63" name="t-63"></a><h1>63 : Demystifying JavaScript Variable Scope and Hoisting</h1>
					<span class="ref-site">https://www.sitepoint.com/demystifying-javascript-variable-scope-hoisting/</span>
					<div class="tutorial__content">

 <p>Every building needs strong foundation to build on. Understanding variable scope in JavaScript is one of the keys to building a solid foundation. This article will explain how JavaScript&#8217;s scoping system works. We&#8217;ll also cover a related topic known as <a href="http://www.sitepoint.com/back-to-basics-javascript-hoisting/">hoisting</a>.</p>
<h2 id="variable-scope">Variable Scope</h2>
<p>To work with JavaScript efficiently, one of the first things you need to understand is the concept of variable scope. The scope of a variable is controlled by the location of the variable declaration, and defines the part of the program where a particular variable is accessible.</p>
<p>Scoping rules vary from language to language. JavaScript has two scopes &#8211; <em>global</em> and <em>local</em>. Any variable declared outside of a function belongs to the global scope, and is therefore accessible from anywhere in your code. Each function has its own scope, and any variable declared within that function is only accessible from that function and any nested functions. Because local scope in JavaScript is created by functions, it&#8217;s also called function scope. When we put a function inside another function, then we create nested scope.</p>
<p>Currently, JavaScript, unlike many other languages, does not support block level scoping. This means that declaring a variable inside of a block structure like a <code>for</code> loop, does not restrict that variable to the loop. Instead, the variable will be accessible from the entire function. It&#8217;s worth noting that the upcoming <a href="http://www.sitepoint.com/preparing-ecmascript-6-let-const/">ECMAScript 6 will support block level scopes via the <code>let</code> keyword</a>.</p>
<p>To make things clear let&#8217;s use a simple metaphor. Every country in our world has frontiers. Everything inside these frontiers belongs to the country&#8217;s scope. In every country there are many cities, and each one of them has its own city&#8217;s scope. The countries and cities are just like JavaScript functions &#8211; they have their local scopes. The same is true for the continents. Although they are huge in size they also can be defined as locales. On the other hand, the world&#8217;s oceans can&#8217;t be defined as having local scope, because it actually wraps all local objects &#8211; continents, countries, and cities &#8211; and thus, its scope is defined as global. Let&#8217;s visualize this in the next example:</p>
<pre><code class='language-javascript'>var locales = {
  europe: function() {          // The Europe continent's local scope
    var myFriend = &quot;Monique&quot;;

    var france = function() {   // The France country's local scope
      var paris = function() {  // The Paris city's local scope
        console.log(myFriend);
      };

      paris();
    };

    france();
  }
};

locales.europe();</code></pre>
<p><a href="http://jsbin.com/lewufuroqi/1/edit?js,console,output">Try out the example in JS Bin</a></p>
<p>Now that we understand what local and global scopes are, and how they are created, it&#8217;s time to learn how the JavaScript interpreter uses them to find a particular variable.</p>
<p>Back to the given metaphor, let&#8217;s say I want to find a friend of mine whose name is Monique. I know that she lives in Paris, so I start my searching from there. When I can&#8217;t find her in Paris I go one level up and expand my searching in all of France. But again, she is not there. Next, I expand my searching again by going another level up. Finally, I found her in Italy, which in our case is the local scope of Europe. </p>
<p>In the previous example my friend Monique is represented by the variable <code>myFriend</code>. In the last line we call the <code>europe()</code> function, which calls <code>france()</code>, and finally when the <code>paris()</code> function is called, the searching begins. The JavaScript interpreter works from the currently executing scope and works it way out until it finds the variable in question. If the variable is not found in any scope, then an exception is thrown.</p>
<p>This type of look up is called <a href="http://en.wikipedia.org/wiki/Lexical_scoping#Lexical_scoping">lexical (static) scope</a>. The static structure of a program determines the variable scope. The scope of a variable is defined by its location within the source code, and nested functions have access to variables declared in their outer scope. No matter where a function is called from, or even how it&#8217;s called, its lexical scope depends only by where the function was declared.</p>
<p>In JavaScript, variables with the same name can be specified at multiple layers of nested scope. In such case local variables gain priority over global variables. If you declare a local variable and a global variable with the same name, the local variable will take precedence when you use it inside a function. This type of behavior is called <em>shadowing</em>. Simply put, the inner variable shadows the outer.</p>
<p>That&#8217;s the exact mechanism used when a JavaScript interpreter is trying to find a particular variable. It starts at the innermost scope being executed at the time, and continue until the first match is found, no matter whether there are other variables with the same name in the outer levels or not. Let&#8217;s see an example:</p>
<pre><code class='language-javascript'>var test = &quot;I'm global&quot;;

function testScope() {
  var test = &quot;I'm local&quot;;

  console.log (test);     
}

testScope();           // output: I'm local

console.log(test);     // output: I'm global</code></pre>
<p><a href="http://jsbin.com/lewufuroqi/2/edit?js,console,output">Try out the example in JS Bin</a></p>
<p>As we can see even with the same name the local variable doesn&#8217;t overwrite the global one after the execution of <code>testScope()</code> function. But this is not always the truth. Let&#8217;s consider this:</p>
<pre><code class='language-javascript'>var test = &quot;I'm global&quot;;

function testScope() {
  test = &quot;I'm local&quot;;

  console.log(test);     
}

console.log(test);     // output: I'm global

testScope();           // output: I'm local

console.log(test);     // output: I'm local (the global variable is reassigned)</code></pre>
<p><a href="http://jsbin.com/lewufuroqi/3/edit?js,console,output">Try out the example in JS Bin</a></p>
<p>This time the local variable <code>test</code> overwrites the global variable with the same name. When we run the code inside <code>testScope()</code> function the global variable is reassigned. If a local variable is assigned without first being declared with the <code>var</code> keyword, it becomes a global variable. To avoid such unwanted behavior you should always declare your local variables before you use them. Any variable declared with the <code>var</code> keyword inside of a function is a local variable. It&#8217;s considered best practice to declare your variables.</p>
<p>Note &#8211; In <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Strict_mode">strict mode</a>, it is an error, if you assign value to variable without first declaring the variable.</p>
<h2 id="hoisting">Hoisting</h2>
<p>A JavaScript interpreter performs many things behind the scene, and one of them is called hoisting. If you are not aware of this &#8220;hidden&#8221; behavior, it can cause a lot of confusion. The best way of thinking about the behavior of JavaScript variables is to always visualize them as consisting of two parts: a declaration and an assignment:</p>
<pre><code class='language-javascript'>var state;             // variable declaration
state = &quot;ready&quot;;       // variable definition (assignment)

var state = &quot;ready&quot;;   // declaration plus definition</code></pre>
<p>In the above code we first declare variable <code>state</code>, and then we assign the value &#8220;ready&#8221; to it. And in the last line of code we see that these two steps can be combined. But what you need to bear in mind is, even though they seem like one statement, in practice, the JavaScript engine treats that single statement as two separate statements, just like in the first two lines in the example.</p>
<p>We already know that any variable declared within a scope belongs to that scope. But what we don&#8217;t know yet, is that no matter where variables are declared within a particular scope, all variable declarations are moved to the top of their scope (global or local). This is called <em>hoisting</em>, as the variable declarations are hoisted to the top of the scope. Note that hoisting only moves the declaration. Any assignments are left in place. Let&#8217;s see an example:</p>
<pre><code class='language-javascript'>console.log(state);   // output: undefined
var state = &quot;ready&quot;;</code></pre>
<p><a href="http://jsbin.com/lewufuroqi/4/edit?js,console,output">Try out the example in JS Bin</a></p>
<p>As you can see when we log the value of <code>state</code>, the output is <code>undefined</code>, because we reference it before the actual assignment. You may have expected a ReferenceError to be thrown because <code>state</code> is not declared yet. But what you don&#8217;t know is that the variable <em>is</em> declared behind the scene. Here is how the code is interpreted by a JavaScript engine:</p>
<pre><code class='language-javascript'>var state;           // moved to the top
console.log(state);   
state = &quot;ready&quot;;     // left in place</code></pre>
<p>Hoisting also affects function declarations. But before we see some examples, let&#8217;s first learn the difference between function declaration and function expression.</p>
<pre><code class='language-javascript'>function showState() {}          // function declaration
var showState = function() {};   // function expression</code></pre>
<p>The easiest way to distinguish a function declaration from a function expression is to check the position of the word <code>function</code> in the statement. If <code>function</code> is the very first thing in the statement, then it&#8217;s a function declaration. Otherwise, it&#8217;s a function expression.</p>
<p>Function declarations are hoisted completely. This means that the entire function&#8217;s body is moved to the top. This allows you to call a function before it has been declared:</p>
<pre><code class='language-javascript'>showState();            // output: Ready

function showState() {
  console.log(&quot;Ready&quot;);
} 

var showState = function() {
  console.log(&quot;Idle&quot;);
};</code></pre>
<p><a href="http://jsbin.com/lewufuroqi/5/edit?js,console,output">Try out the example in JS Bin</a></p>
<p>The reason the preceding code works is that JavaScript engine moves the declaration of <code>showState()</code> function, and all its content, to the beginning of the scope. The code is interpreted like this:</p>
<pre><code class='language-javascript'>function showState() {     // moved to the top (function declaration)
  console.log(&quot;Ready&quot;);
} 

var showState;            // moved to the top (variable declaration)

showState();  

showState = function() {   // left in place (variable assignment)
  console.log(&quot;Idle&quot;);
};</code></pre>
<p>As you may have noticed, only the function declaration is hoisted, but the function expression is not. When a function is assigned to a variable, the rules are the same as for variable hoisting (only the declaration is moved, while the assignment is left in place).</p>
<p>In the code above we saw that the function declaration takes precedence over the variable declaration. And in the next example we&#8217;ll see that when we have function declaration versus variable assignment, the last takes priority.</p>
<pre><code class='language-javascript'>var showState = function() {
  console.log(&quot;Idle&quot;);
};

function showState() {
  console.log(&quot;Ready&quot;);
} 

showState();            // output: Idle</code></pre>
<p><a href="http://jsbin.com/lewufuroqi/6/edit?js,console,output">Try out the example in JS Bin</a></p>
<p>This time we call <code>showState()</code> function in the last line of code which change the situation. Now we get output &#8220;Idle&#8221;. Here is how it looks when interpreted by JavaScript engine:</p>
<pre><code class='language-javascript'>function showState(){        // moved to the top (function declaration)
  console.log(&quot;Ready&quot;);
} 

var showState;               // moved to the top (variable declaration)

showState = function(){      // left in place (variable assignment)
  console.log(&quot;Idle&quot;);
};

showState();</code></pre>
<h2 id="things-to-remember">Things to Remember</h2>
<ul>
<li>All declarations, both functions and variables, are hoisted to the top of the containing scope, before any part of your code is executed. </li>
<li>Functions are hoisted first, and then variables. </li>
<li>Function declarations have priority over variable declarations, but not over variable assignments.</li>
</ul>
					
					</div>
				</article>
				<!--================= END :: Tutorial =================-->
				
				<!--================= START :: Tutorial =================-->
				<article>
					<a id="t-64" name="t-64"></a><h1>64 : A Plain English Guide to JavaScript Prototypes</h1>
					<span class="ref-site">http://sporto.github.io/blog/2013/02/22/a-plain-english-guide-to-javascript-prototypes/</span>
					<div class="tutorial__content">
<div class="entry-content"><p>When I first started learning about JavaScript object model my reaction was of horror and disbelief. I was totally puzzled by its prototype nature as it was my first encounter with a prototype based language. I didn't help that JavaScript has a unique take on prototypes as it adds the concept of <strong>function constructors</strong>. I bet that many of you have had similar experience.</p>

<p>But as I used JavaScript more I didn't just learn to understand its object model but also started love parts of it. Thanks to JavaScript I have find out the elegance and flexibility of prototypes languages. I am now quite fond of prototype languages because they have a simpler and more flexible object model than class based languages.</p>

<h2>Prototypes in Javascript</h2>

<p>Most guides / tutorials start explaining JavaScript objects by going directly to '<strong>constructor functions</strong>', I think this is a mistake, as they introduce a fairly complex concept early on making Javascript look difficult and confusing from the start. Let's leave this for later. First let's start with the basics of prototypes.</p>

<h2>Prototype chains (aka prototype inheritance)</h2>

<p>Every object in Javascript has a <strong>prototype</strong>. When a messages reaches an object, JavaScript will attempt to find a property in that object first, if it cannot find it then the message will be sent to the object's prototype and so on. This works just like single parent inheritance in a class based language.</p>

<p><img src="https://docs.google.com/drawings/d/1NdiIkHd9Cg2j6W4QcJ1X3DEhGXD2gacMXRuURcoE5T4/pub?w=960&amp;h=720"></p>

<p>Prototype inheritance chains can go as long as you want. But in general it is not a good idea to make long chains as your code can get difficult to understand and maintain.</p>

<h2>The __proto__ object</h2>

<p>To understand prototype chains in JavaScript there is nothing as simple as the <strong>__proto__</strong> property. Unfortunately <strong>__proto__</strong> is not part of the standard interface of JavaScript, not at least until ES6. So you shouldn't use it in production code. But anyway it makes explaining prototypes easy.</p>

<figure class="code"><figcaption><span></span></figcaption><pre><code>// let's create an alien object
var alien = {
  kind: 'alien'
}

// and a person object
var person = {
  kind: 'person'
}

// and an object called 'zack'
var zack = {};

// assign alien as the prototype of zack
zack.__proto__ = alien

// zack is now linked to alien
// it 'inherits' the properties of alien
console.log(zack.kind); //=&gt; 'alien'

// assign person as the prototype of zack
zack.__proto__ = person

// and now zack is linked to person
console.log(zack.kind); //=&gt; 'person'
</code></pre></figure>


<p>As you can see the <strong>__proto__</strong> property is very straightforward to understand and use. Even if we shouldn't use <strong>__proto__</strong> in production code, I think that these examples give the best foundation to understand the JavaScript object model.</p>

<p>You can check that one object is the prototype of another by doing:</p>

<figure class="code"><figcaption><span></span></figcaption><pre><code>console.log(alien.isPrototypeOf(zack))
//=&gt; true
</code></pre></figure>


<h3>Prototype lookups are dynamic</h3>

<p>You can add properties to the prototype of an object at any time, the prototype chain lookup will find the new  property as expected.</p>

<figure class="code"><figcaption><span></span></figcaption><pre><code>var person = {}

var zack = {}
zack.__proto__ = person

// zack doesn't respond to kind at this point
console.log(zack.kind); //=&gt; undefined

// let's add kind to person
person.kind = 'person'

// now zack responds to kind
// because it finds 'kind' in person
console.log(zack.kind); //=&gt; 'person'
</code></pre></figure>


<h3>New / updated properties are assigned to the object, not to the prototype</h3>

<p>What happens if you update a property that already exists in the prototype? Let's see:</p>

<figure class="code"><figcaption><span></span></figcaption><pre><code>var person = {
  kind: 'person'
}

var zack = {}
zack.__proto__ = person

zack.kind = 'zack'

console.log(zack.kind); //=&gt; 'zack'
// zack now has a 'kind' property

console.log(person.kind); //=&gt; 'person'
// person has not being modified
</code></pre></figure>


<p>Note that the property 'kind' now exists in both person and zack.</p>

<h2>Object.create</h2>

<p>As explained before <strong>__proto__</strong> is not a well supported way of assigning prototypes to objects. So the next simplest way is using <strong>Object.create()</strong>. This is available in ES5, but old browsers / engines can be shimmed using this <a href="https://github.com/kriskowal/es5-shim">es5-shim</a>.</p>

<figure class="code"><figcaption><span></span></figcaption><pre><code>var person = {
  kind: 'person'
}

// creates a new object which prototype is person
var zack = Object.create(person);
  
console.log(zack.kind); // =&gt; 'person'
</code></pre></figure>


<p>You can pass an object to Object.create to add specific properties for the new object</p>

<figure class="code"><figcaption><span></span></figcaption><pre><code>var zack = Object.create(person, {age: {value:  13} });
console.log(zack.age); // =&gt; '13'
</code></pre></figure>


<p>Yes, the object you need to pass is a bit convoluted, but that is the way it is. See the docs <a href="https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Object/create">here</a>.</p>

<h3>Object.getPrototype</h3>

<p>You can get the prototype of an object using Object.getPrototypeOf</p>

<figure class="code"><figcaption><span></span></figcaption><pre><code>var zack = Object.create(person);
Object.getPrototypeOf(zack); //=&gt; person
</code></pre></figure>


<p>There is no such thing as Object.setPrototype.</p>

<h2>Constructor Functions</h2>

<p><strong>Constructor functions</strong> are the most used way in JavaScript to construct prototype chains. The popularity of <strong>constructor functions</strong> comes from the fact that this was the only original way for constructing types. It is also an important consideration the fact that many engines are highly optimized for constructor functions.</p>

<p>Unfortunately they can get confusing, they are in my opinion one of the main reasons why new comers find JavaScript puzzling, but they are a big part of the language and we need to understand them well.</p>

<h3>Functions as constructors</h3>

<p>In JavaScript you create an instance of a function like this:</p>

<figure class="code"><figcaption><span></span></figcaption><pre><code>function Foo(){}

var foo = new Foo();

//foo is now an instance of Foo
console.log(foo instanceof Foo ) //=&gt; true
</code></pre></figure>


<p>In essence functions when used with the keyword <strong>new</strong> behave like factories, meaning that they create new objects. The new object they create is linked to the function by its prototype, more on this later. So in JavaScript we call this an <strong>instance</strong> of the function.</p>

<h3>'this' is assigned implicitly</h3>

<p>When we use '<strong>new</strong>', JavaScript injects an implicit reference to the new object being created in the form of the '<strong>this</strong>' keyword. It also returns this reference implicitly at the end of the function.</p>

<p>When we do this:</p>

<figure class="code"><figcaption><span></span></figcaption><pre><code>function Foo() {
  this.kind = 'foo'
}

var foo = new Foo(); 
foo.kind //=&gt; 'foo'
</code></pre></figure>


<p>Behind the scenes it is like doing something like this:</p>

<figure class="code"><figcaption><span></span></figcaption><pre><code>function Foo() {
  var this = {}; // this is not valid, just for illustration
  this.__proto__ = Foo.prototype;
  
  this.kind = 'foo'
  
  return this;
}
</code></pre></figure>


<p>But keep in mind that the implicit '<strong>this</strong>' is only assigned to a new object when using '<strong>new</strong>'. If you forget '<strong>new</strong>' keyword then '<strong>this</strong>' will be the global object. Of course forgetting <strong>new</strong> is a cause of multiple bugs, so don't forget <strong>new</strong>.</p>

<p>One convention that I like is capitalizing the first letter of a function when it is intented to be used as a function constructor, so you now straightaway to you are missing the <strong>new</strong> keyword.</p>

<h3>The 'function prototype'</h3>

<p>Every function in JavaScript has a special property called '<strong>prototype</strong>'.</p>

<figure class="code"><figcaption><span></span></figcaption><pre><code>function Foo(){
}

Foo.prototype
</code></pre></figure>


<p>As confusing as it may sound, this '<strong>prototype</strong>' property is not the real prototype (<strong>__proto__</strong>) of the function.</p>

<figure class="code"><figcaption><span></span></figcaption><pre><code>Foo.__proto__ === Foo.prototype //=&gt; false
</code></pre></figure>


<p>This of course generates a lot of confusion as people use the term '<strong>prototype</strong>' to refer to different things. I think that a good clarification is to always refer to the special '<strong>prototype</strong>' property of functions as '<strong>the function prototype</strong>', never just '<strong>prototype</strong>'.</p>

<p>The '<strong>prototype</strong>' property points to the object that will be asigned as the prototype of instances created with that function when using '<strong>new</strong>'. Confusing? This is easier to explain with an example:</p>

<figure class="code"><figcaption><span></span></figcaption><pre><code>function Person(name) {
  this.name = name;
}

// the function person has a prototype property
// we can add properties to this function prototype
Person.prototype.kind = 'person'

// when we create a new object using new
var zack = new Person('Zack');

// the prototype of the new object points to person.prototype
zack.__proto__ == Person.prototype //=&gt; true

// in the new object we have access to properties defined in Person.prototype
zack.kind //=&gt; person
</code></pre></figure>


<p>That is mostly everything there is to know about the JavaScript object model. Understanding how <strong>__proto__</strong> and <strong>function.prototype</strong> are related will give you countless hours of joy and satisfaction, or maybe not.</p>

<p>Mistakes, confusing? Let me know.</p>
</div>
					</div>
				</article>
				<!--================= END :: Tutorial =================-->
				
				<!--================= START :: Tutorial =================-->
				<article>
					<a id="t-65" name="t-65"></a><h1>65 : The Intuitive Proto Object in JavaScript</h1>
					<span class="ref-site">http://sporto.github.io/blog/2011/11/06/the-intuitive-proto-object-in-javascript/</span>
					<div class="tutorial__content">
<div class="entry-content"><p>Javascript is meant to be a prototypical language. But unfortunately it is a half done prototypical language. Internally it works like this but externally it tries to looks like something else. To understand this let's look at the <strong>proto</strong> property.</p>

<p>Take the following code</p>

<figure class="code"><figcaption><span></span></figcaption><pre><code>Animal = {
    alive:true,
    legs:4
}

person = {
    legs:2
}
person.__proto__ = Animal;

console.log(person.alive);
//true
</code></pre></figure>


<p>It is extremely easy to see what is happening here. We have just created a prototype inheritance chain between 'person' and 'Animal'. If you ask for a property or method in 'person' it will be looked up in that object first, if it is not found there it then will be looked up in the prototype.</p>

<p><strong>proto</strong> looks scary because of all the underscores around the name, but in reality it is quite easy and straightforward to understand and use. Unfortunately the <strong>proto</strong> property is an internal properties only exposed by some browsers (e.g. Chrome, Firefox). So it cannot be used safely.</p>

<p>So sadly we are left with this:</p>

<figure class="code"><figcaption><span></span></figcaption><pre><code>Animal = {
  alive:true,
  legs:4
}

Person = function(){
  this.legs = 2;
}
Person.prototype = Animal;
person = new Person();

console.log(person.alive); //true
console.log(person.legs); //2
</code></pre></figure>


<p>Note what is happening here:</p>

<ul>
<li>We need to create a constructor function</li>
<li>Then we assign 'Animal' as the prototype of that constructor</li>
<li>Then we run the function to get the instance we want</li>
</ul>


<p>This is an extremely convoluted process to get to what we want, which is to have an object that inherits from another.</p>

<h2>Object.create</h2>

<p>There is another alternative which is using Object.create:</p>

<figure class="code"><figcaption><span></span></figcaption><pre><code>Animal = {
    alive:true,
    legs:4
}

person = Object.create(Animal);
person.legs = 2;

console.log(person.alive); //true
console.log(person.legs); //2
</code></pre></figure>


<p>Object.create makes a new object with the prototype set to the given object. This is heaps better than the function prototype work around. But still using <strong>proto</strong> is a lot more intuitive.</p>
</div>

					</div>
				</article>
				<!--================= END :: Tutorial =================-->
				
				<!--================= START :: Tutorial =================-->
				<article>
					<a id="t-66" name="t-66"></a><h1>66 : Understanding the JavaScript Prototype Chain & Inheritance</h1>
					<span class="ref-site">https://community.risingstack.com/javascript-prototype-chain-inheritance/</span>
					<div class="tutorial__content">
<section class="post-content">
<p>In this two-part article, I will explain the JavaScript prototype chain, <a href="https://community.risingstack.com/explaining-javascript-closure-scope-chain-examples/" class="js-ajax-link">JavaScript closures and the scope chain</a> so that you can understand how to debug specific issues and how to use them to your advantage.</p>
<h2 id="javascriptadespisedprogramminglanguage">JavaScript: a Despised Programming Language</h2>
<p>It can be said that <strong>Javascript is one of the most despised programming languages.</strong> However, <strong>it is also one of the most popular languages</strong>, and we regularly encounter it every day in various forms. </p>
<p><strong>A lot of this animosity comes from confusion about two key components of the language:</strong> the prototype chain and scoping. While Javascript's inheritance and scoping is different from most languages, I think that with proper understanding, these quirks can be embraced and used to their full potential.</p>
<div class="click-to-tweet">
<p class="click-to-tweet-text">
<a href="https://twitter.com/share?text=%23JavaScript%20is%201%20of%20the%20most%20despised%20languages.%20Is%20it%20because%20of%20the%20confusion%20about%20the%20prototype%20chain%20%26%20scoping%3F;url=https://community.risingstack.com/javascript-prototype-chain-inheritance/" target="_blank">#JavaScript is 1 of the most despised languages. Is it because of the confusion about the prototype chain &amp; scoping?</a>
</p>

</div>
<h2 id="thejavascriptprototypechain">The JavaScript Prototype Chain</h2>
<p>Javascript has an interesting inheritance model, which happens to be completely different from most OOP languages. While it is object-oriented, an object doesn't have a type or a class that it gets its methods from, it has a prototype. It is important to understand the differences between these two, as they are not equivalent, and lead to much confusion down the line.</p>
<h3 id="javascriptconstructors">JavaScript Constructors</h3>
<p>To create an object in Javascript, you first must define its constructor function.</p>
<pre><code>//Constructor
var LivingEntity = function(location){  
    this.x = location.x;
    this.y = location.y;
    this.z = location.z;
};

//New instance
var dog = new LivingEntity({  
    x: 5,
    y: 0,
    z: 1
});
</code></pre>
<p><strong>The constructor function is nothing more than a normal function.</strong> You may notice that we are referencing <code>this</code> in the constructor function above. <code>this</code> is not specific to constructor functions, and can be referenced in any function. Normally it points to the function's scope of execution, which we will get to in the next section.</p>
<p>To create a new instance of this object, call the constructor with the <code>new</code> keyword in front of it.</p>
<h3 id="methods">Methods</h3>
<p>Let's say we want to add a method to <code>LivingEntity</code> called <code>moveWest</code> that will decrease the entity's x component by 1. Since an object is just a map in Javascript, you might be tempted to add it to the instance of the object during or after construction.</p>
<pre><code>//During construction
var LivingEntity = function(location){  
    this.x = location.x;
    this.y = location.y;
    this.z = location.z;
    this.moveWest = function(){
        this.x--;
    }
};

//OR after construction
dog.moveWest = function(){  
    this.x--;
}
</code></pre>
<p>Doing so is not the way to construct objects using prototypes, and both of these methods add unnecessary anonymous functions to memory.</p>
<p>Instead, we can add a single anonymous function to the prototype chain!</p>
<pre><code>LivingEntity.prototype.moveWest = function(){  
    this.x--;
}
</code></pre>
<p>If we do this, there is only one anonymous function, whose reference is passed around to all <code>LivingEntity</code> objects.</p>
<p>But what is <code>&lt;Function&gt;.prototype</code>? <code>prototype</code> is an attribute of all functions, and points to a map where attributes can be assigned that should be able to be accessed from all objects created with that function as the constructor.</p>
<p>Every object has a prototype that can be modified through the constructor's <code>prototype</code>, even <code>Object</code>.</p>
<pre><code>Object.prototype.a = 5;

var v = {};  
console.log(v.a); //5  
</code></pre>
<p>The prototype of an object is a way to store common attributes across all instances of a class, but in a way that is overwritable. If an object doesn't have a reference to an attribute, that object's prototype will be checked for the attribute.</p>
<pre><code>LivingEntity.prototype.makeSound = function(){  
    console.log('meow');
}

//dog uses its prototype because it doesn't have makeSound as an attribute
dog.makeSound(); //meow

dog.makeSound = function(){  
    console.log('woof');
}

//now dog has makeSound as an attribute, it will use that instead of it's prototype
dog.makeSound(); //woof  
</code></pre>
<h3 id="theprototypechain">The Prototype Chain</h3>
<p>Every object has a prototype, including the prototype object. This "chain" goes all the way back until it reaches an object that has no prototype, usually <code>Object</code>'s prototype. Prototype's version of "Inheritance" involves adding another link to the end of this prototype chain, as shown below.</p>
<pre><code>var Dragon = function(location){  
    /*
     * &lt;Function&gt;.call is a method that executes the defined function,
     * but with the "this" variable pointing to the first argument,
     * and the rest of the arguments being arguments of the function
     * that is being "called". This essentially performs all of
     * LivingEntity's constructor logic on Dragon's "this".
     */
    LivingEntity.call(this, location);
    //canFly is an attribute of the constructed object and not Dragon's prototype
    this.canFly = true;
};

/*
 * Object.create(object) creates an object with a prototype of the
 * passed in object. This example will return an object
 * with a prototype that has the "moveWest" and "makeSound" functions,
 * but not x, y, or z attributes.
 */
Dragon.prototype = Object.create(LivingEntity.prototype);

/*
 * If we didn't reset the prototype's constructor
 * attribute, it would look like any Dragon objects
 * were constructed with a LivingEntity constructor
 */
Dragon.prototype.constructor = Dragon;

/*
 * Now we can assign prototype attributes to Dragon without affecting
 * the prototype of LivingEntity.
 */
Dragon.prototype.fly = function(y){  
    this.y += y;
}

var sparky = new Dragon({  
    x: 0,
    y: 0,
    z: 0
});  
</code></pre>
<p>When an attribute is called on an object, the object is first checked for that attribute, and if it doesn't exist, then each link in its prototype chain is traversed until the attribute is found or the end is reached. In this way, sparky can use <code>moveWest</code> even though <code>moveWest</code> was not defined in its immediate prototype.</p>
<p>What does sparky and its prototype chain look like with only each object's specific attributes listed?</p>
<ul>
<li>sparky
<ul><li>x</li>
<li>y</li>
<li>z</li>
<li>canFly</li></ul></li>
<li>sparky.prototype (Dragon.prototype)
<ul><li>fly</li></ul></li>
<li>sparky.prototype.prototype (LivingEntity.prototype)
<ul><li>makeSound</li>
<li>moveWest</li></ul></li>
<li>sparky.prototype.prototype.prototype (Object.prototype)
<ul><li>create</li>
<li>toString</li>
<li>etc...</li></ul></li>
</ul>
<h2 id="nextup">Next Up</h2>
<p>The second part of this article will discuss <a href="https://community.risingstack.com/explaining-javascript-closure-scope-chain-examples/" class="js-ajax-link">JavaScript closures and scope chains with examples</a>, and help you to increase your confidence when using these features of the language. <strong>If you have questions about the prototype chain, I'll be glad to answer them in the comments!</strong></p>
<p>Stay Tuned!</p>
</section>
					</div>
				</article>
				<!--================= END :: Tutorial =================-->
				
				<!--================= START :: Tutorial =================-->
				<article>
					<a id="t-67" name="t-67"></a><h1>67 : Explaining JavaScript Closure & Scope Chain with Examples</h1>
					<span class="ref-site">https://community.risingstack.com/explaining-javascript-closure-scope-chain-examples/</span>
					<div class="tutorial__content">
<section class="post-content">
<p>In this article, <strong>I will attempt to explain JavaScript Closures &amp; the Scope Chain with examples</strong>, so that you will understand how to debug specific issues and how to use them to your advantage.</p>
<p>While Javascript's inheritance and scoping is different from most languages, I think that with proper understanding, these quirks can be embraced and used to their full potential. </p>
<p><em>The first part of the series explains the <a href="https://community.risingstack.com/javascript-prototype-chain-inheritance/" class="js-ajax-link">JavaScript Prototype Chain and Inheritance</a>.</em></p>
<h2 id="javascriptscopechainexplained">JavaScript Scope Chain Explained</h2>
<p>Every Javascript developer has at one point or another run into a bug (most of the time when trying to write asynchronously), that is described mysteriously online as the result of incorrect "closure". As a result, most developers have learned not to write functions in certain ways, for fear of awakening the beast once more. </p>
<p>However, knowledge of closure and the scope chain can make Javascript's biggest headache into a great ally.</p>
<h3 id="anonymousfunctionsandstate">Anonymous Functions and State</h3>
<p>The root of the problem is that functions have a state. We call this state the scope of the function, and it stores references to all of the variables that were declared at the time the function was created. Due to hoisting, named functions have the scope present at the top of whatever block they belong to, but anonymous functions have whatever scope exists at the line they are initialized.</p>
<h3 id="javascriptclosureexample">JavaScript Closure Example</h3>
<p>Closure is the act of capturing an object and separating it from its original scope, making it available to the capturing function forever. The example below illustrates accidental closure.</p>
<pre><code>var helloStr = 'world';

//I want to make a function which returns a function that will print out
//a hello message when I execute it.
var sayHello = function(name){  
    return function(){
        console.log('Hello ' + name + '!');
    }
}

var sayGreeting = sayHello(helloStr);

//woops, I meant to greet Bob
helloStr = 'Bob';  
sayGreeting();//Hello world!  
</code></pre>
<p>This is an example of assuming that your function will use a reference to the string <code>helloStr</code> when in reality you have accidentally captured the specific value of that string at the time of function execution.</p>
<p>What about this next example of an asynchronous counter? What do you expect it to output?</p>
<pre><code>for (var i = 0; i &lt; 10; i++){  
    setTimeout(function(){
        console.log(i);
    }, 1000);
}
</code></pre>
<p>Output: </p>
<pre><code>10  
10  
10  
10  
10  
10  
10  
10  
10  
10  
</code></pre>
<p>In this example, closure was needed and did not happen. When the function goes to print out the values one second later, it references the current value of <code>i</code>, which has long ago been incremented to <code>10</code>. To understand when a function will capture a variable and when it will not, we need to understand scope.</p>
<h3 id="whatisscope">What is Scope?</h3>
<p>If you think of functions in Javascript as state machines, scope is that state. Wherever the cursor in your Javascript program is, it has a scope. If it is inside a function, it is that function's scope. If it doesn't have a scope, it is said to have the global scope. You can think of scope as an object structured like so:</p>
<pre><code>{
    _scope,
    variables
}
</code></pre>
<p>The <code>_scope</code> variable points to the scope that the program cursor was at when the function was created, or null in the case of the global scope. This creates a chain of scopes called the Scope Chain. The <code>variables</code> variable is a map of all variable that are passed into the function or will be declared in the function (due to hoisting, they are all declared at the top of the function even though you may write them as being declared at other points). Whenever a variable is changed in the function, its entry in the variables map is changed too.</p>
<h3 id="howareclosuresrelatedtothescopechain">How are Closures related to the Scope Chain?</h3>
<p>When a variable is used, the program traverses the scope chain until it finds an entry for that variable. Redeclaring a variable or passing it into a function is a way of separating it from its previous existence in the scope chain.</p>
<pre><code>var str1 = 'hello';  
//Redeclaring the variable
var str2 = str1;  
str1 = 'goodbye';  
//Redeclaring the variable has separated it from its original reference
console.log(str2);//hello

var str1 = 'hello';  
var printVar = function(v){  
    return function(){
        console.log(v);
    };
};
//Passing in variable into a function
var printHello = printVar(str1);  
str1 = 'goodbye';  
//Passing the variable into a function has saved it in the function's scope
printHello();//hello  
</code></pre>
<p>In the Hello Bob example, the original string was preserved because it was passed into a function and persisted in the function's scope, even though its variable outside the function was reassigned.</p>
<p>At the last line of the Hello Bob example, this is what the scope chain looks like when the program cursor is at the <code>console.log</code> statement.</p>
<ul>
<li>scope (nothing here)</li>
<li>scope.scope
<ul><li>name: 'world'</li></ul></li>
<li>scope.scope.scope (global for this program)
<ul><li>sayHello: function</li>
<li>helloStr: 'Bob'</li>
<li>sayGreeting: function</li></ul></li>
</ul>
<p>In the async counting example, after one second when the program cursor starts to execute the <code>console.log</code> statements, this is the scope chain at each execution.</p>
<ul>
<li>scope (nothing here)</li>
<li>scope.scope (global for this program)
<ul><li>i: 10</li></ul></li>
</ul>
<p>If we wanted to rewrite the async counting example correctly, we would write it so that it captured the current value of <code>i</code> instead of using the final value.</p>
<pre><code>//Even though the name of the variable is the same, we are using the
//value that is passed into the function, not the value that keeps incrementing
var logI = function(i){  
    return function(){
        console.log(i);
    };
};

for (var i = 0; i &lt; 10; i++){  
    setTimeout(logI(i), 1000);
}
</code></pre>
<p>The value of <code>i</code> that has been captured in the function returned by <code>logI</code> is now ungettable and unsettable outside of the scope of the returned function. This is one way of making private variables in Javascript.</p>
<h3 id="advancedimmediatelyinvokedfunctionalexpression">Advanced: Immediately Invoked Functional Expression</h3>
<p>Immediately Invoked Functional Expressions (IIFE) are a pattern in Javascript that allow variables and methods to be made private by declaring them inside a scope. This is how libraries like jQuery are structured. Passing the window object into these functions allows specific parts of the IIFE to be exported to the global namespace.</p>
<pre><code>(function(global){
    var privateVariable = 'No one can ever see me or change me outside of this scope';
    var publicVariable = 'No one can change me, but some can see me';

    global.getPublicVariable = function(){
        return publicVariable;
    };
})(window);
</code></pre>
<p>Now the window object has a <code>getPublicVariable</code> method.</p>
<h2 id="conclusion">Conclusion</h2>
<p>When using Javascript, it can sometimes get confusing to determine exactly which variable you are referencing at any given line. With an object attribute it can be anywhere along the prototype chain, and with a variable, it can be anywhere along the scope chain. </p>
<p>Hopefully, this primer on the <a href="https://community.risingstack.com/javascript-prototype-chain-inheritance/" class="js-ajax-link">JavaScript Prototype Chain</a> and scope chains will increase your confidence when using these features of the language.</p>
<div class="click-to-tweet">
<p class="click-to-tweet-text">
<a href="https://twitter.com/share?text=%22Knowledge%20of%20closure%20%26%20the%20scope%20chain%20can%20make%20the%20biggest%20%23JavaScript%20headache%20into%20a%20great%20ally.%22%20%40RisingStack;url=https://community.risingstack.com/explaining-javascript-closure-scope-chain-examples/" target="_blank">"Knowledge of closure &amp; the scope chain can make the biggest #JavaScript headache into a great ally." @RisingStack</a>
</p>

</div>
<p>Let me know in the comments if you have any questions!</p>
</section>
					</div>
				</article>
				<!--================= END :: Tutorial =================-->
				
				<!--================= START :: Tutorial =================-->
				<article>
					<a id="t-68" name="t-68"></a><h1>68 : JavaScript: Why Understanding Scope And Closures Matter</h1>
					<span class="ref-site">http://doctrina.org/JavaScript:Why-Understanding-Scope-And-Closures-Matter.html</span>
					<div class="tutorial__content">
<div class="article-content">
		<p>When first learning how to program, a fundamental aspect is to learn about scope. Many languages copy the C <em>syntax</em> for scope, including JavaScript. But while these language copy the C rules for scope, JavaScript does not. This results in frustration and potentially problematic code. JavaScript instead implements scope in a way that forces programmers to think a little differently.</p>
<p>This post will explain how JavaScript implements scope and explains a very useful result of its scoping: Closures. It motivates the utility of JavaScript's scope model by explaining its role in asynchronous programming.</p>
<h1 id="scope">Scope<a href="#scope" title="Permanent link" class="headerlink"></a></h1>
<p>C implements scope using the block operators: <code>{}</code>. The type of scope it implements is called <em>block scope</em> and where ever the block operators <code>{}</code> are declared, the compiler will create scope. Languages (besides JavaScript) that copy this notation follow more-or-less the same block scope rules (e.g. Java).</p>
<p>JavaScript uses block operators <code>{}</code> but it does <strong>not</strong> implement block scope. Coming from C/C++, the following code makes perfect sense (<em>please do not try run this JavaScript code</em>):</p>
<pre><code>for (i=0; i &lt; 4; i++) { //Outer loop
    for (i=0; i &lt; 2; i++) { //Inner loop
        document.write("Hello World"); 
    }
}
</code></pre>

<p>Firstly, note that the above will cause an error in Java, but in C/C++ (whose scope syntax JavaScript has copied), it works fine. This looks like it will output <code>Hello World</code> eight times. It won't! It will instead loop endlessly, outputting <code>Hello World</code> forever. This is because JavaScript does not implement <em>block scope</em>; the <code>i</code> of the inner loop keeps resetting the <code>i</code> of the outer loop, and so the outer loop's end condition is never achieved. This is confusing for people experienced with block scope, and JavaScript should have copied the block scope rules if it copied the operators. JavaScript realises their mistake and so the <a href="http://wiki.ecmascript.org/doku.php?id=harmony:let" target="_blank">let</a><sup class="print">L1</sup> operator, which implements block scope, has been approved for future JavaScript releases. </p>
<p>I feel that adding block scope solves the problem in a haphazard way. Firstly, it alters the way block scope in the C style is used, and secondly, it will entice programmers with experience of block scope to use <code>let</code> instead of something better.</p>
<p>But is there <em>something better</em>? Scope has traditionally been implemented in JavaScript via functions and is known as <em>function scope</em>. There is an argument to be made that when used correctly, function scope can be very elegant and achieve most of what block scope does. But first, an explanation of function scope is in order...</p>
<h3 id="function-scope">Function Scope<a href="#function-scope" title="Permanent link" class="headerlink"></a></h3>
<p>Function scope means that everything between bracket operators <code>{}</code> is scoped <em>as long as it is part of a function</em>.</p>
<pre><code>var foo = "Goodbye";
var message = function() {
    var foo = "Hello";
    document.write(foo);
}

message(); //Hello
document.write(foo); //Goodbye
</code></pre>

<p>The code snippet above demonstrates function scoping: inside the function <code>message</code>, the variable <code>foo</code> is scoped and is distinct to the variable <code>foo</code> outside the function. <em>Function scope</em> is used heavily in JavaScript. In fact, there is a common pattern to create a function just for the purpose of scope. As an example, the standard advice for writing JQuery plugins is to use the following pattern:</p>
<pre><code>(function($) {
    //Do things here - they are scoped
}(JQuery))
</code></pre>

<p>In the above example, the last line invokes the function by using the invocation operator <code>()</code> with the input parameter <code>JQuery</code>. It immediately executes code inside the function which is scoped. In JQuery, a short cut for the <code>JQuery</code> function is <code>$</code>. Unfortunately, <code>$</code> is a shortcut for other JavaScript libraries as well (e.g. ProtoTypeJS). To prevent polluting the global namespace with JQuery's <code>$</code> (and also avoiding clashes with plugins that may be written for other JavaScript libraries), <em>scope</em> is required. The above code snippet achieves the desired scope.</p>
<h3 id="functions-within-functions">Functions Within Functions<a href="#functions-within-functions" title="Permanent link" class="headerlink"></a></h3>
<p>Since functions have scope, declaring a function within another function provides another level of scope:</p>
<pre><code>var func1 = function() { //outer function
    var msg = "foo";

    var func2 = function() { //inner function
        var msg = "bar";
        document.write(msg); //bar
    }

    func2();
    document.write(msg); //foo
}
func1();
</code></pre>

<p>I will use the term <em>inner function</em> to mean a function declared within another function and <em>outer function</em> to refer to the function it is declared in (see code snippet above). </p>
<p>In addition to its own scope, an inner function has access to the variables of the outer function as long as it does not declare variables with identical names (in which case it will overwrite the variables, but just within that function scope). For example:</p>
<pre><code>var foo = function() {
    var msg = "bar";

    var inner = function() {
        document.write(msg); //bar - msg can be accessed here
    }
}
foo();
</code></pre>

<p>The above seems intuitive and obvious, and I understand the reader not being <em>blown away</em> by its utility. But the pattern of having an inner function that has access to an outer function's variable is the basis of a closure, which is very useful.</p>
<h1 id="closures">Closures <a id="closures"></a><a href="#closures" title="Permanent link" class="headerlink"></a></h1>
<h2 id="a-technical-definition">A Technical Definition<a href="#a-technical-definition" title="Permanent link" class="headerlink"></a></h2>
<p>A variable that is assigned to a function is a <em>structure</em> in memory that is used to represent the function. For many languages, this <em>structure</em> is the memory address of the function, resulting in the variable only being able to invoke the function. Some languages like JavaScript implement a slightly more complex setup for the <em>structure</em>. For these languages, the <em>structure</em> holds both the address of the function and its <em>referencing environment</em>. The referencing environment means the environment the function was originally declared in. If the function was originally declared within another function, then the referencing environment will mean the function that the original function was declared in.</p>
<p>Having access to the referencing environment means access to certain non-local variables. Normally, a function has access to its own local variables and to the global variables. With the <em>referencing environment</em> at the structure's disposal, calls to certain non-local variables (i.e. variables that were not declared in the function, but were declared in the function where it was defined) are possible. JavaScript implementors refer to the <em>referencing environment</em> as the function's <em>context</em>. When the <em>structure</em> that points to a function also contains its original context (<em>referencing environment</em>), it is called a closure. The image below demonstrates the concept, whereby the <em>context</em> points to the original function (outer) that the function variable inner was declared in:</p>
<p><img src="http://doctrina.org/images/closure.png"></p>
<h2 id="how-closures-work-and-are-used-not-too-technical">How Closures Work And Are Used (Not Too Technical)<a href="#how-closures-work-and-are-used-not-too-technical" title="Permanent link" class="headerlink"></a></h2>
<p>In more laymen's terms, an inner function defined within an outer function has access to all variables within the outer function. In JavaScript, the inner function is a closure because JavaScript includes its <em>context</em>. Both the inner and outer functions are scoped.</p>
<pre><code>var closureExample = function() { //outer function
    //declare variables within the outer function

    var closureFunction = function() { //inner function
        //Do things here, and have access to outer function's stuff
    }

    return closureFunction;
}
var closure = closureExample();
</code></pre>

<p>When presented like this, closures do not seem interesting. But, when the <em>inner</em> function lives longer than the <em>outer</em> function, the inner function (i.e. the closure) will have access to state from that outer function that is not accessible anywhere else. Therefore closures have the ability to implement something that is taken for granted in classical object oriented languages: <em>Private State</em>.</p>
<h3 id="keeping-things-private">Keeping Things Private<a href="#keeping-things-private" title="Permanent link" class="headerlink"></a></h3>
<p>In a classical object oriented language, it is easy to keep methods and state private: Put the <code>private</code> keyword in front of such state and methods. Modern object oriented scripting languages do not have this functionality. In that sense, JavaScript is in good company with the likes of Python and Ruby.</p>
<p>But private state and methods are very useful at times. And it can be achieved in JavaScript by using a closure:</p>
<pre><code>var closure = function() {
    //This is a private variable
    var counter = 0;

    return { //This object being returned is assigned to closure
        getCounter : function() { return counter;},
        increment : function(inc) {
            if (typeof inc !== 'number')
                inc = 1;

            counter += inc;
        }
    };
}();

closure.increment(10);
alert(closure.getCounter()); //10
</code></pre>

<p>There is a lot of things happening in the above example:</p>
<ol>
<li>First, notice on the last line the <code>();</code> - the function is being invoked, the result of which is being assigned to <code>closure</code>. To hammer this point home: We are <strong>not</strong> assigning the variable <code>closure</code> to a function, we are instead assigning it the result of the invoked function (what is returned from the function). This common pattern was mentioned above whereby a function is created only to create scope.</li>
<li>The result assigned to <code>closure</code> is an <a href="http://doctrina.org/Javascript-Objects-Prototypes.html#cofl" target="_blank">Object Literal</a><sup class="print">L2</sup> that consists of two functions which are closures. They are closures because they have access to the context in which they were declared.</li>
</ol>
<p>In the code snippet above, once the outer function is invoked it cannot be accessed again because it is an anonymous function. The pattern of an <em>inner</em> function living longer than the outer function <em>is the useful pattern for closures</em> because it implements private state. The two closure functions within the object assigned to <code>closure</code> have access to <code>counter</code>. <code>counter</code> is private: It cannot be altered nor accessed except through the closure functions. </p>
<p>I will say it again: Closure functions are interesting when the <em>inner</em> functions "outlives" the <em>outer</em> object where it was declared. This is specially useful for asynchronicity.</p>
<h1 id="why-closures-are-so-useful-the-big-picture">Why Closures Are So Useful: The Big Picture<a href="#why-closures-are-so-useful-the-big-picture" title="Permanent link" class="headerlink"></a></h1>
<p>One of JavaScript's most appealing features is that it is asynchronous from "the ground up". Asynchronicity is achieved by using an <em>event driven programming model</em>: A function is executed only when an event occurs. That function is passed as an argument to the event handler. Functions used in this manner are called <em>callback</em> functions. The <em>callback</em> function, like any JavaScript function, will have access to the context where it was declared in. If the callback function is an inner function, it is a closure that is able to access variables in the outer function. As was shown above, closures can be used to maintain private state. So by using closure callback functions, you get the best of both worlds: <strong>You can implement event driven programming without having to maintain any state by passing it via the event handler</strong>. This is extremely elegant and will decrease programmer errors. And this is a killer reason (amongst others I am sure) that function scope along with closures are so useful. </p>
<p>JavaScript should not be used like classical object oriented languages. Its power lies in the fact that it should be able to handle more load (on both the server and the client) by using an event driven approach that does not block IO. Therefore I think the JavaScript programmer should be thinking in callback functions that are closures. And for this, function scope becomes essential and in a way, elegant.</p>
<h2 id="watch-out-callbacks-and-closures-sometimes-do-not-play-nicely">Watch Out: Callbacks And Closures Sometimes Do Not Play Nicely <a id="closureandconstructor"></a><a href="#watch-out-callbacks-and-closures-sometimes-do-not-play-nicely" title="Permanent link" class="headerlink"></a></h2>
<p>Of course there are always <em>gotchas</em> with JavaScript. Lets define a callback function:</p>
<pre><code>var createCallBack = function() { //First function
    return new function() { //Second function
        this.message = "Hello World";

        return function() { //Third function
            alert(this.message);
        }
    }
}

window.onload = createCallBack(); //Invoke the function assigned to createCallBack
</code></pre>

<p>Lets examine the above code. There are three <code>function</code> operators:</p>
<ol>
<li>The first <code>function</code> operator creates a <em>function object</em> and is assigned to <code>creatCallBack</code>.</li>
<li>The second <code>function</code> operator uses the <a href="http://doctrina.org/Javascript-Function-Invocation-Patterns.html#ci" target="_blank">constructor invocation pattern</a><sup class="print">L3</sup> to create a new object.</li>
<li>The third <code>function</code> operator is the result of the return statement. It is a <em>function object</em> and because it is an instance of <code>Object</code>, it gets returned instead of a new object (even though though the function was invoked with <code>new</code> - read <a href="http://doctrina.org/Javascript-Function-Invocation-Patterns.html#ci" target="_blank">constructor invocation pattern</a><sup class="print">L3</sup> for more info).</li>
</ol>
<p>When invoking the <code>createCallBack</code> variable, what gets passed to the <code>window.onload</code> event handler is the result of what is returned by the <em>seond</em> <code>function</code> operator, which is the code in the <em>third</em> <code>function</code> operator. Did you get that? Read this paragraph again until you understand, and if not, stick this code into your browser and play with it.</p>
<p>The above code looks alright, except that <em>undefined</em> gets alerted to the screen (try it for yourself). It turns out that when an event handler invokes a callback function, the <a href="http://doctrina.org/Javascript-Function-Invocation-Patterns.html#fi" target="_blank">function invocation pattern</a><sup class="print">L4</sup> is used. This results in the <code>this</code> parameter being bound to the <code>global object</code> (it is one of the pitfalls of the <a href="http://doctrina.org/Javascript-Function-Invocation-Patterns.html#fi" target="_blank">function invocation pattern</a><sup class="print">L4</sup>) instead of to the object that was created with the <a href="http://doctrina.org/Javascript-Function-Invocation-Patterns.html#ci" target="_blank">constructor invocation pattern</a><sup class="print">L3</sup>. To note that this problem only occurs when one uses the <a href="http://doctrina.org/Javascript-Function-Invocation-Patterns.html#ci" target="_blank">constructor invocation pattern</a><sup class="print">L3</sup> with callbacks like I have illustrated above. To get around this, apply the <a href="http://doctrina.org/Javascript-Function-Invocation-Patterns.html#standardfix" target="_blank">standard fix</a><sup class="print">L5</sup> for function invocation by declaring a <code>that</code> variable to point to <code>this</code>:</p>
<pre><code>var createCallBack = function() { //First function
    return new function() { //Second function
        var that = this;
        this.message = "Hello World";

        return function() { //Third function
            alert(that.message);
        }
    }
}

window.onload = createCallBack(); //Invoke the function assigned to createCallBack
</code></pre>

<p>Since the function invoked by the event handler (the third function) is a closure, it has access to the <code>that</code> variable (which is private), and so it has access to the new object created by the constructor invocation pattern.</p>
<h2 id="why-would-one-want-to-use-the-constructor-invocation-pattern-with-callbacks">Why Would One Want To Use The Constructor Invocation Pattern With Callbacks?<a href="#why-would-one-want-to-use-the-constructor-invocation-pattern-with-callbacks" title="Permanent link" class="headerlink"></a></h2>
<p>To tell you the truth, there is no good reason to mix the <a href="http://doctrina.org/Javascript-Function-Invocation-Patterns.html#ci" target="_blank">constructor invocation pattern</a><sup class="print">L3</sup> with a callback. I included it above as a pitfall because it is sometimes used (and misused). Using the <a href="http://doctrina.org/Javascript-Function-Invocation-Patterns.html#ci" target="_blank">constructor invocation pattern</a><sup class="print">L3</sup> is necessary when one wants to be able to change the default prototype linkings (see <a href="http://doctrina.org/Javascript-Objects-Prototypes.html#coff" target="_blank">here</a><sup class="print">L6</sup> for an example of this). This is only necessary when one wants to create objects that are inherited from another object. It is not necessary for creating new objects because new objects can be created via a closure.</p>
<p>For example, here is a code snippet that uses the <a href="http://doctrina.org/Javascript-Function-Invocation-Patterns.html#ci" target="_blank">constructor invocation pattern</a><sup class="print">L3</sup> in order to create separate objects for each callback:</p>
<pre><code>var createCallBack = function(init) { //First function
    return new function() { //Second function
        var that = this;
        this.message = init;

        return function() { //Third function
            alert(that.message);
        }
    }
}

window.addEventListener('load', createCallBack("First Message"));
window.addEventListener('load', createCallBack("Second Message"));
</code></pre>

<p>But instead of using <a href="http://doctrina.org/Javascript-Function-Invocation-Patterns.html#ci" target="_blank">constructor invocation pattern</a><sup class="print">L3</sup>, the snippet can be rewritten by just using closures:</p>
<pre><code>var createCallBack = function(init) { //First function
    var obj = { //This object is created within the first function and is accessible
                //to the second function due to the closure
        'message':init
    };

    return function() { //Second function
        alert(obj.message);
    }
}

window.addEventListener('load', createCallBack("First Message"));
window.addEventListener('load', createCallBack("Second Message"));
</code></pre>

<p>The two code snippets above are equivalent, but the latter example is so much more concise and easier to read! Each code snippet demonstrates objects that have their own internal state. The <code>load</code> event is given two callback functions, each an instance of an object with its own state (note this example may not work for Internet Explorer older than version 9).</p>
<h1 id="conclusion">Conclusion<a href="#conclusion" title="Permanent link" class="headerlink"></a></h1>
<p>Closures make asynchronous programming elegant. In order to understand closures, it is vital to understand <em>function scope</em>. JavaScript being functionally scoped encourages event driven programming, the mainstay of asynchronicity. </p>

	</div>
					</div>
				</article>
				<!--================= END :: Tutorial =================-->
				
				<!--================= START :: Tutorial =================-->
				<article>
					<a id="t-69" name="t-69"></a><h1>69 : Prototype and Prototypal Inheritance</h1>
					<span class="ref-site">http://scriptonitejs.com/prototype-and-prototypal-inheritance/</span>
					<div class="tutorial__content">

<div class="entry-content">
	<p>Content List</p>
<ol>
<li><a href="#introduction">Introduction</a></li>
<li><a href="#function-constructors">Function Constructors and Prototypes</a></li>
<li><a href="#protoprops">Prototype Properties</a></li>
<li><a href="#change-func-proto">Changing a functions prototype</a></li>
<li><a href="#multi-inherit">Multiple Inheritance</a></li>
<li><a href="#proto-chain">Using Classes to create the prototype chain</a></li>
<li><a href="#extend-objects">Extending built-in Objects</a></li>
</ol>
<h2 id="introduction">Introduction</h2>
<p>In my&nbsp;<a href="http://scriptonitejs.com/javascript-objects/" target="_blank">previous post</a>, i mentioned that ALL&nbsp;javascript objects have a prototype property. This&nbsp;prototype property is only a reference to another object (it does not live on the object). What happens is, if you ask javascript for a property on an object&nbsp;and it does not find it, the&nbsp;prototype object will be searched for that property. If it exists, that value will get returned. If you are familiar with the concept of inheritance, then this is how it works in javascript. Meaning an object in javascript inherits from its prototype (or prototype chain).&nbsp;This is why inheritance in javascript is called&nbsp;prototypal inheritance. Inheritance has a very simple meaning, it means <span class="s1">one object gets access to the properties and methods of another object.</span> In javascript that would be its&nbsp;prototype object.</p>
<p>Let us&nbsp;continue using our book object to demonstrate this.</p>
<pre><code>var book&nbsp;= {};</code></pre>
<p>Since you now know how to add properties and methods to objects, lets add some.</p>
<pre><code>var book = {
&nbsp; title : 'Book Name',
&nbsp; author: 'Book Author',
  showBookInfo: function(){
    return this.title + ' by ' + this.author;
  }
};

</code></pre>
<p><span id="more-280"></span></p>
<p>We&nbsp;added 2 properties, <strong>title</strong> and <strong>author,&nbsp;</strong>and a method <strong>showBookInfo</strong>. Now remember i mentioned that ALL objects have a prototype property? Lets call this prototype object&nbsp;<em>proto </em>(for now). Because <em>proto</em> is object, we can added other properties and methods to it as well. Lets&nbsp;add a property called <strong><em>mySecretProperty</em></strong>&nbsp;to this <em>proto</em> object. What happens when you try to console.log this newly added property?</p>
<pre><code>console.log( book.mySecretProperty );</code></pre>
<p>Can you guess? Here is what happens. Book tries to look for a property called <em>mySecretProperty</em> on itself. If it doesnt find it, then it will look inside the <em>proto</em> object attached to it to see if it finds a <em>mySecretProperty</em> property( think of it like this <strong>book.proto.mySecretProperty</strong>). This is not the exact&nbsp;syntax, but i want you to think of it that way only for now.&nbsp;Our console.log will return the value assigned to it&nbsp;in the <em>proto</em> object. Now,&nbsp;the prototype object (proto) can also point to yet another object, and so on. This can form what we call the <strong>prototype chain</strong>. A prototype can have another prototype, and that prototype can have yet another prototype. Remember they are objects, so they can have a prototype. So the search will go on and on up the chain looking&nbsp;for that property until the prototype returns undefined. When trying to&nbsp;access&nbsp;a property, we dont need to access the prototype object directly, javascript will look in the chain for us. Its important to remember; the prototype object does NOT live on the object; the object has reference to it. This can be a great thing, because you dont have to put everything on your objects. Imagine have 100 methods on one object. Try instantiating that many times (evil laugh)</p>
<p>Lets see some code samples setting the prototype object. We are going to use a property called DUNDER PROTO. A little disclaimer before we do this… you should <span style="color: #993300;"><strong>NEVER EVER!</strong></span> do it&nbsp;in your code. We will be talking about better ways to build objects and set its&nbsp;prototype. Even though the concept of prototypes is simple, it is the downfall of many javascript programmers, so to get the point across i have to break a few rules to get your mind to start seeing prototypes for what they really are before we look at the right way of using them. The next few examples&nbsp;are for demonstration purposes only, because i feel its the best way to understand prototypes.</p>
<p>Modern browsers provide a way for us to directly set the prototype, and that is what we will be looking at first, so you&nbsp;get the idea. Later on will will get into doing it the right way. Again do not use it as it can slow down your javascript application. Just because browser manufacturers have given us this access does not mean we can go ahead an use them in our apps.</p>
<p>Ok, so we already have a book object. Let us create another object</p>
<pre><code>var cinderella = {
&nbsp; title : 'Cinderella',
&nbsp; author: 'Charles P.'
};</code></pre>
<p>Now let us set the prototype of cinderella to the book object. This will allow cinderella to access methods on <strong>book</strong>. Book&nbsp;is now the parent. The way we access the prototype in modern browsers is by using what is call <strong>dunder proto</strong>. It is written like this ( <strong>__proto__</strong> ). Two underscores followed by the word proto, followed by two more underscores. It is done this way to alert the developer that this should <strong>NOT</strong> be accessed! Its for the browser only. The reason why we use dunder prototype is because when we do <strong>cinderella.prototype</strong>, it may not always be accessible. Yes all object have a prototype, but they are not always accessible. So browser manufacturers have given us a way to set&nbsp;it on demand! Aren't they nice? Lets see it in action!</p>
<pre><code>cinderella.__proto__ = book;</code></pre>
<p>Cinderella now inherits from Book. Meaning that we can call the <em>showBookInfo</em> method even though it does not exist on the cinderella object.</p>
<pre><code>console.log(cinderella.showBookInfo());</code></pre>
<p>Our console outputs "Cinderella by Charles P." Which is exactly what we want. Remember, before <em>showBookInfo</em> does not exist on cinderella, it looks at its prototype which we just set to book, and find that method there.</p>
<p>We need to talk about the <strong><em>this</em></strong> keyword and how that is affected. Notice that even though the <em>showBookInfo</em> function was executed it didn't not use the <strong>title</strong> and <strong>author</strong> in the book object. The this variable knows which object originally executed it. In this case it was the <strong>cinderella</strong> object. Lets look at accessing other property members. When we call cinderella.title, we get "Cinderella". If we set the prototype to book, why does it not return "Book Name". Remember because we are asking it for cinderella's title, it will first look in that object. IF it does not find it, then alone will it go down the prototype chain and hunt for that property. Lets create another object and set its prototype</p>
<pre><code>var tarzan = {
&nbsp; title : 'Tarzan'
};
tarzan.__proto__ = book;</code></pre>
<p>Now that this&nbsp;prototype has been set, we can call <em>showBookInfo</em>&nbsp;on the tarzan object. Can you guess what the output will be?</p>
<pre><code>console.log( tarzan.showBookInfo() );</code></pre>
<p>The console returns "Tarzan by Book Author". Did you guess this? Do you know why? When we call showBookInfo on the tarzan object, it first looks for showBookInfo on itself. Because that method does not exist, it will look in the prototype chain. It finds that book is its prototype, so it searches for this method on that object. It finds it and executes the function. Within that function we have references to <strong><em>this.title</em>&nbsp;</strong>and <strong><em>this.author</em></strong>. The tarzan object has a <strong>title</strong> property, so that value is returned (remember tarzan is the object the executed the code). However the tarzan object does not have an <strong>author</strong> property. Again javascript looks down the prototype chain and finds that the prototype has that property 'Book Author', and therefor it returns that value.</p>
<p>Do you have a better understand of the object prototype? I would love to hear your thoughts on this. Lets move on</p>
<pre><code>You may have heard that almost everything is javascript is an object. And lets not forget what an object is in javascript. See my previous post. Objects are just containers with key-value pairs. Things like&nbsp;undefined, null, boolean, string and&nbsp;number are what we call primitive types in javascript. There is actually a 6th primitive type introduced in ES6 called symbol. Everything else is an object. Now there is a base object that every object inherits from. This base object, is called Object&nbsp;and does NOT have a prototype. Lets create some sample objects&nbsp;and see their prototypes

var myObject = {};
var myFunction = function(){}; 
var myArray = [];

Lets use our console to see what the prototype for this objects are</code></pre>
<pre><code>console.log( myObject.__proto__ );
console.log( myFunction.__proto__ );
console.log( myArray.__proto__ );</code></pre>
<p>Lets look at this one by one. We notice that <strong><em>myObject.__proto__</em></strong> returns <strong>Object {}</strong> in the console. This is the base object being returned to us. You&nbsp;should know that this base object has methods and properties attached to it. Because myObject is now this base object, it can access all the base objects properties and methods.</p>
<p><a href="http://scriptonitejs.com/wp-content/uploads/2016/01/ss1.png" rel="attachment wp-att-271"><img class="alignnone size-full wp-image-271" src="http://scriptonitejs.com/wp-content/uploads/2016/01/ss1.png" alt="ss1" width="258" height="244"></a></p>
<p>When i type <strong>myObject.</strong> in my console, i can see ALL the properties and methods of the base class. This means ALL objects have access to these&nbsp;methods you see in the screenshot. Do any of them look familiar to you? I bet! Lets say i called <strong>book.toString()</strong> on our book object. As you already know toString does not exist on the book object, however because the base <strong>Object</strong> is its prototype, it is able to find the toString() method there and execute it.</p>
<p>Lets look at the second console.log. We notice it returns <em><strong>function () {}</strong></em>. This is an empty function. So all functions have a prototype, which is this empty function. Since this is an object,&nbsp;it too has properties and methods on it.</p>
<p><a href="http://scriptonitejs.com/wp-content/uploads/2016/01/ss2.png" rel="attachment wp-att-272"><img class="alignnone size-medium wp-image-272" src="http://scriptonitejs.com/wp-content/uploads/2016/01/ss2-223x300.png" alt="ss2" width="223" height="300" srcset="http://scriptonitejs.com/wp-content/uploads/2016/01/ss2-223x300.png 223w, http://scriptonitejs.com/wp-content/uploads/2016/01/ss2.png 277w" sizes="(max-width: 223px) 100vw, 223px"></a></p>
<p>As can you see from above, the function prototype has properties and methods. That means that ALL functions have access to these. For example every function has a <strong>bind</strong>, <strong>call,</strong> <strong>apply</strong>&nbsp;etc defined on it, because they exist on&nbsp;the prototype chain.</p>
<p>Finally lets look at the <strong>myArray</strong> objects prototype. Our console returns this, <strong>[ ]</strong>. Which is an empty array. So the prototype of all arrays is this empty array. Lets see if this array has methods and properties defined on it</p>
<p><a href="http://scriptonitejs.com/wp-content/uploads/2016/01/ss3.png" rel="attachment wp-att-274"><img class="alignnone size-medium wp-image-274" src="http://scriptonitejs.com/wp-content/uploads/2016/01/ss3-102x300.png" alt="ss3" width="102" height="300" srcset="http://scriptonitejs.com/wp-content/uploads/2016/01/ss3-102x300.png 102w, http://scriptonitejs.com/wp-content/uploads/2016/01/ss3.png 239w" sizes="(max-width: 102px) 100vw, 102px"></a></p>
<p>Look at all those methods defined on the array. There is <strong>push, length, pop</strong> and many many more. This means all arrays in javascript have access to these&nbsp;methods, because they live on its&nbsp;prototype. I ask again, have you seen these methods before? The ONLY reason you are able to call them is because they exist on the objects prototype.</p>
<p>Finally dont forget that the prototype chain is never ending, even though the function and array returned an empty function and empty array as their prototype, you can then again find the prototype of those objects as well. You would however, eventually get down to the base object, which is Object</p>
<pre><code>console.log( myFunction.__proto__.__proto__ ); //returns Object {}
console.log( myArray.__proto__.__proto__ ); // returns Object {}</code></pre>
<p>What do you think will happen if you tried to go up the chain one more time? Yep, you get a <strong>null</strong>. Remember the base object does not have a prototype. Remember,&nbsp;<strong><span style="color: #993300;">do not</span></strong>&nbsp;use the dunder prototype. We are about to see how to do it the proper way… now that you understand what is <span style="color: #000000;">going</span> on when you set an objects prototype. Yiiiihaaa !</p>
<h2 id="function-constructors">Function Constructors and Prototypes</h2>
<p>Previously i mentioned that all objects have a prototype but they are not always accessible unless we use dunder proto. Well, functions are a little <em>more</em> special. All functions have a property called <strong>prototype</strong>. Let me say that in another way. Functions are objects, so of course they have a prototype, HOWEVER they also have a <em><strong>property</strong></em> on them called prototype. This property is <strong>NOT</strong> the prototype of the function (its a property, i know kind of confusing), ANYWAY,&nbsp;when the function is used as a constructor function to create new objects&nbsp;THEN objects created from this constructor will have a prototype that points to the&nbsp;prototype property of the function. New objects created will automatically get their prototypes set for you. We will look at this in action. Lets go on….</p>
<p>So, not only can you access a functions dunder proto (which you should not use <strong>.__proto__</strong>), you can also access its&nbsp;<strong>.prototype</strong>&nbsp;property.</p>
<pre><code>var myFunction = function(){};
console.log( myFunction.prototype ); // returns { }</code></pre>
<p>Notice it returns an empty object<em>.</em> This <strong>.prototype</strong> property&nbsp;is completely visible to you, meaning you can access it, and are encourage to use this property. Lets see what happens when you try to access this prototype of an object built with JSON.</p>
<pre><code>var tarzan = {
&nbsp; title : 'Tarzan'
};
console.log(tarzan.prototype); //undefined
console.log(tarzan.__proto__); //returns object</code></pre>
<p>When we call tarzan.prototype we get <strong>undefined</strong>. It is not visible, because&nbsp;a prototype is more of an inside javascript field.&nbsp;So its not that tarzan does not have a prototype…We dont get access to it unless we use dunder proto (like we saw before).</p>
<p>Lets play with more code</p>
<pre><code>console.log(tarzan.__proto__ === Object); //returns false
console.log(tarzan.__proto__ === Object.prototype); //returns true</code></pre>
<p>Here we wanted to see if what tarzans dunder proto is equivalent to. Clearly it is not equal to the global Object. You should know that the global Object IS a constructor function used to create new objects, so it does have a valid prototype field(all functions have a prototype property, remember?). This is why we see a result of true in our second console.</p>
<pre><code>console.log(typeof Object); //returns function</code></pre>
<p>A common convention&nbsp;used in javascript is to use an uppercase letter for constructor functions. <strong>typeof</strong>&nbsp;basically returns a string that identifies the data type of an expression. It reports back that Object IS a function.</p>
<p>Getting back to our tarzan example,&nbsp;when we create an object with JSON notation / or object literals, that objects&nbsp;prototype will be set to Object.prototype. <strong>This is very very important to note</strong>. An objects prototype, is the object instance from which the object is inherited. If we want to change this prototype we can use Object.create passing in the object(prototype)&nbsp;to inherit. Please see the <a href="http://scriptonitejs.com/javascript-objects/">previous tutorial</a> on creating javascript objects(where i first introduced you to Object.create).</p>
<p>Lets see some&nbsp;differences in the definition of prototypes (ones i have found useful)</p>
<pre><code>"A functions prototype is the object instance that will become the prototype for all objects created using this function as a constructor."</code></pre>
<pre><code>"An objects prototype is the object instance from which the object is inherited."</code></pre>
<p>What does all this mean? All functions that are created, get a prototype property attached to it behind the scenes. If that function is then used as a constructor function with the <strong>new</strong> keyword, the object that is created has a <strong>proto</strong> property that is pointing to the same object that is the functions prototype.</p>
<p>Lets&nbsp;see that in action…</p>
<pre><code>//lets define a constructor function
function Book(title, author){
 this.title = title;
 this.author = author;
 this.showBookInfo = function(){
    return this.title + ' by ' + this.author;
  }
} 
console.log(typeof Book.prototype); //object
console.log(Book.prototype); // Book { }</code></pre>
<p>Notice that this time we are able to call the <strong>.prototype</strong> on the constructor function without error. The prototype of the constructor function is the Book object, and you can also see that the <strong>typeof</strong> Book.prototype is an object. We cannot use this .prototype on a JSON objects, only constructor functions. What do you think we will get if we did this?</p>
<pre><code>console.log(Book.prototype === Object.prototype);</code></pre>
<p>Can you guess? We get FALSE! When we are using JSON Objects / or object literals, its prototype is set to Object.prototype (remember, we saw that before?). However when you are using function constructors, Book will get its own prototype object.</p>
<p>Lets create an object from this constructor function, so we can understand our definition better</p>
<pre><code>var myBook = new Book('tarzan', 'Edgar R.');</code></pre>
<p>For objects&nbsp;created with the function&nbsp;constructor, lets see what its prototype is</p>
<pre><code>console.log( myBook.__proto__ ); // Book { }</code></pre>
<p>Notice here that</p>
<pre><code>Book.prototype === myBook.__proto__;</code></pre>
<p>Remember our definition from earlier? "the object that is created has a <strong>proto</strong> property that is pointing to the same object that is the functions prototype". Book.prototype and myBook dundar proto are all pointing to the same object! So changing a property on the prototype will affect the instantiated objects prototype, since they point to the same object.</p>
<pre><code>Book.prototype.bookColor = "red";
Book.prototype.deliverBook = function(){}</code></pre>
<p>It doesnt matter how many instances of Book you created. They will all point to that protoype object.</p>
<pre><code>var mySecondBook = new Book("James Bond", "Ian Fleming");
console.log(&nbsp;Book.prototype === mySecondBook.__proto__ ); //true</code></pre>
<p>Returns true because&nbsp;mySecondBook.__proto__ is poing to the Book object. Notice that because instantiated objects have access to the prototype, it is best to keep properties and methods that will&nbsp;be shared amongst instantiated objects there. We may need to optimize our objects and keep them as small as possible and delegate shared tasks to the prototype.&nbsp;Keeping the methods on the prototype make instantiating objects light and performant. If they dont have a method, they know exactly where to find them We can now optimize our Book construtor to look like this</p>
<pre><code>function Book(title, author){
 this.title = title;
 this.author = author;
}
Book.prototype.showBookInfo = function(){
  return this.title + ' By ' + this.author.
}</code></pre>
<p>The <em>showBookInfo</em> method has now been put into the prototype, and Book is now better optimized. If you instantiate a thousand book objects now, each of them will not contain the <em>showBookInfo</em> on the instantiated object itself. However when it needs it, the object knows how to find it on its prototype.</p>
<h2 id="protoprops">Prototype Properties</h2>
<p>Let see how adding properties affects all objects constructed using that function.</p>
<pre><code>function Book(title, author){
 this.title = title;
 this.author = author;
}
Book.prototype.pageCount = 300;

var book1 = new Book("James Bond", "Ian Fleming");
var book2 = new Book("Cinderella", "Charles P");
</code></pre>
<p>Because book1 and book2 share &nbsp;the same prototype, what happens we you try to access the pageCount</p>
<pre><code>console.log( book1.pageCount === book2.pageCount ); // true</code></pre>
<p>You get true for both of them. How one can override pageCount for each object. The way objects work is that if they cannot find a property on themselves, they will look on the prototype object. In this case since both of them point to the same object, they return the same thing. So if we want book1 to have its unique pageCount, we have to make pageCount immediately available on that object, before it begins to search its prototype.</p>
<pre><code>book1.pageCount = 400
book2.pageCount = 500;</code></pre>
<pre><code>//now lets get the values of book1 and book2 pageCount
console.log(book1.pageCount); //400
console.log(book2.pageCount); // 500
console.log( book1.pageCount === book2.pageCount ); //false</code></pre>
<p>We see that because the pageCount properties are set on the object, they return the pageCount directly from the object and not the prototype. However try to access the pageCount on the prototype:</p>
<pre><code>console.log( book1.__proto__.pageCount );
console.log( book2.__proto__.pageCount ); 
console.log( Book.prototype.pageCount ); // All logs output 300</code></pre>
<p>We see that the prototype still has the 300 value for page count. If we wanted it changed for all objects then we have to change the prototype value itself.</p>
<p>There are some <span style="color: #993300;"><strong>dangers</strong></span> with setting properties i want talk about. If you try to set a property on an object and that property does not exist, the property will <strong>still</strong> get added onto it. That just how javascript works. For that reason you may want to check to see if that property exists on an object before trying to set it. We use the objects <strong>hasOwnProperty</strong> to check if a property exists on an object.</p>
<pre><code>if( book1.hasOwnProperty('title') ) {
&nbsp; book1.pageCount = 400;
}</code></pre>
<p>This will double check to see if that property(title) originally existed on the book1 object instance. If it does, only then will it set the pageCount. If it doesnt, then nothing will happen. If you dont do think, javascript will add that property on the object. This is very important to note. Just because object gives you an answer doesnt mean its right, it may be that the answer is coming from another object down in the prototype chain.</p>
<h2 id="change-func-proto">Changing a functions prototype</h2>
<p>We saw how to change an objects prototype with Object.create in the previous <a href="http://scriptonitejs.com/javascript-objects/" target="_blank">post</a>. How do we do this for a function. How do we change a functions prototype. Lets go back to our book constructor.</p>
<pre><code>function Book(title, author){
 this.title = title;
 this.author = author;
}
Book.prototype.pageCount = 300;

var book1 = new Book("James Bond", "Ian Fleming");
var book2 = new Book("Cinderella", "Charles P");

console.log(book1.pageCount); //300
console.log(book2.pageCount); //outputs 300</code></pre>
<p>We see that book1 and book2 are return pageCount which is found on the prototype. Let me change this prototype now</p>
<pre><code>Book.prototype = {
  pageCount: 1000;
};</code></pre>
<p>What we have done here is created a brand new object and assigned it to the Book prototype. The object being <strong>{ pageCount: 1000 }</strong>. Please note, it is a brand new object with new memory allocation, WE HAVE NOT OVERRIDDEN the other initial prototype object. It still lives in memory. Lets find out.</p>
<pre><code>console.log(book1.pageCount); //300
console.log(book2.pageCount); //outputs 300</code></pre>
<p>Even though have a new prototype set to that object, book1 and book2 still point to the old object instance. However lets create a new object</p>
<pre><code>var book3 = new Book("Art of Ware", "J.H Huang");
console.log(book3.pageCount); //1000</code></pre>
<p>We see now that book3 outputs the new pageCount property in our new prototype. Because book1 and book2 were created with an object whose prototype was already in memory, they retained that object reference. Book3 was created after a new prototype was created and assigned to Book; at this point all objects created after pointed to the new object reference. You can also look at it this way,&nbsp;Book.prototype.pageCount changes based on where you call it. Call it after the first prototype assignment, and it will be that objects pageCount value. Call after the second prototype was created, and it gets that prototypes value. Simple? Lets get into deep waters.</p>
<h2 id="multi-inherit">Multiple Inheritance</h2>
<p>Lets look at how to implement multiple inheritance in javascript. In a sense we have already looked at this,&nbsp;since we have talked&nbsp;about the prototype chain. Lets go back to&nbsp;our Books example:</p>
<pre><code>function Book(title, author){
 this.title = title;
 this.author = author;
}
var book1 = new Book("James Bond", "Ian Fleming");</code></pre>
<p>We see that we can look up the inheritance chain.</p>
<pre><code>console.log( book1.__proto__); //returns Book{}
console.log(book1.__proto__.__proto__); //returns Object{}</code></pre>
<p>We see that the prototype of book1 is the Book Object… and the prototype of that is Object { }. The prototype of Object is null. There is no prototype there remember? So already we see&nbsp;some inheritance going on. Lets take this knowledge to new heights. Lets create a new book constructor&nbsp;and create objects that inherit from it</p>
<pre><code>function Book(type){
 this.type = type || 'Backend';
}
Book.prototype.write = function(){
  console.log("Writing a " + this.type + " Book!");
}</code></pre>
<p>We have created a parent class <strong>Book</strong> and set its prototype. Lets create a <strong>JavascriptBook</strong>&nbsp;object that inherits&nbsp;from Book</p>
<pre><code>function JavascriptBook(title, author){
 this.title = title;
 this.author = author;
}
JavascriptBook.prototype = Object.create(Book.prototype);
var jsBook = new JavascriptBook("The Good Part", "Doug C");</code></pre>
<p>We created a new constructor function(JavascriptBook) and set its&nbsp;prototype to&nbsp;Book. This way objects instantiated from&nbsp;the JavascriptBook object&nbsp;will have the write method</p>
<pre><code>jsBook.write();</code></pre>
<p>Its worth speaking about why we use <strong>Object.create</strong> here instead of <strong>new.</strong>&nbsp;We could have used new. The only difference is that <strong>Object.create</strong>&nbsp;is NOT going to call the Book constructor function. Its just going to set the function as the prototype and setup the prototype chain. Remember <strong>new</strong> will ALSO&nbsp;execute the Book function when used, and we just might not want to do that yet. At least not when we are setting the prototype of JavascriptBook. If we were setting up new instances of JavascriptBook, then we want to call <strong>new</strong>. In setting up multiple inheritance like we are trying to do here, when we create JavascriptBook objects we need to also call Book as well&nbsp;(its parent). This way if anything needs to happen on a Book&nbsp;upon&nbsp;construction, then it can happen. Lets see this in code?</p>
<pre><code>function JavascriptBook(title, author){
 Book.call(this);
 this.title = title;
 this.author = author;
}</code></pre>
<p>This will call the Book constructor, passing in JavascriptBook(this) as the Book being constructed so any Book related initialization can occur if need be. Why are we calling the parent to do any kind of setup/initialization? Because JavascriptBook inherits from Book, maybe anytime we create a JavascriptBook object, we want to setup the book type. Since javascript is a frontend language, we might want to set a type on the parent( the type of book ). This way when we call our write() function it will out the right message(since the parent knows what type it is when it was constructed). We dont want to construct a Javascript book and have it report back as a backend book. <em><strong>Side Note</strong></em>: Yes technically speaking javascript can be used on the backend. But you get the point i am trying to make. In the real world we might want to initialize&nbsp;some things when we construct our objects. Its all depends on what you are creating</p>
<pre><code>function JavascriptBook(title, author){
 Book.call(this, 'Frontend');
 this.title = title;
 this.author = author;
}</code></pre>
<p>So now when we call our parent object we can pass in any parameter it needs to initialize the object. When we call the write() function after creating a JavascriptBook instance, it will output "Frontend" as part of that method. Try it out for youself.</p>
<pre><code>var jsBook = new JavascriptBook("The Good Part", "Doug C");
jsBook.write();</code></pre>
<p>Works like a charm. Lets move on. We now want to see if the jsBook object is really a constructed&nbsp;from JavascriptBook. And also whether it is a Book</p>
<pre><code>console.log(jsBook instanceof JavascriptBook);
console.log(jsBook instanceof Book);</code></pre>
<p>We use the <strong><code>instanceof</code> operator</strong>&nbsp;which tests whether an object has in its prototype chain, the <code>prototype&nbsp;</code>property of a constructor.&nbsp;In other words it checks to see if an object from created from a certain constructor function. jsBook was constructed with the JavascriptBook constructor, NOT the Book constructor even though Book is in it prototype chain. We have to make a few changes AFTER we set the prototype of the JavascriptBook object. Lets re-write that.</p>
<pre><code>JavascriptBook.prototype = Object.create(Book.prototype);
JavscriptBook.prototype.constructor = JavascriptBook;</code></pre>
<p>If we dont do this, and we check what constructor jsBook, we get the Book object, which is wrong. It should be JavascriptBook</p>
<pre><code>console.log(jsBook.constructor); // returns Book if&nbsp;we DONT&nbsp;set constructor</code></pre>
<p>Another problem we encounter if we dont set the constructor property is we get the wrong prototype chain</p>
<pre><code>console.log(jsBook.__proto__); // returns Book
console.log(jsBook.__proto__.__proto__); //also returns Book</code></pre>
<p>The first proto should be JavascriptBook, but it returns book. The second is correct. This is all because we did not set the constructor of JavascriptBook. This is the confusing part about doing multiple inheritance. What should you take from here? Whenever you are creating&nbsp;a prototype chain you have&nbsp;to</p>
<ol>
<li>Set the prototype of the object using Object.create like we saw earlier</li>
<li>Set the constructor of the prototype to the object you are creating</li>
<li>Call the parent class when instantiating the object</li>
</ol>
<h2 id="proto-chain">Using Classes to create the prototype chain</h2>
<p>We can also use class to create the prototype chain. Classes were introduced as of ES6. Lets recreate our Book to be a class</p>
<pre><code>class Book {
 constructor(type){
  this.type = type || 'Backend';
 }
 write(){
  console.log("Writing a " + this.type + " Book!");
 }
}

class JavascriptBook extends Book {
 constructor(title, author){
  super('FrontEnd');
  this.title = title;
  this.author = author;
 }
}
</code></pre>
<pre><code>var jsBook = new JavascriptBook("The Good Part", "Doug C");
jsBook.write();</code></pre>
<p>This does exactly the same thing as we did with constructor functions. Do you think its easier to understand? Go ahead and play around with it. Notice we declare our constructor in the class as well as methods of that class. The way we write them is a little different however. You should know the class keyword is only syntactic sugar for Object.create. The syntax is only to appeal to programmers coming from classical languages like Java, C++, etc. If you would like me to go in-depth about the class keyword, do leave me a message.</p>
<h2 id="extend-objects">Extending built-in Objects</h2>
<p>Lets see what we have learned about prototypes to see how we can extend built-in objects, likes arrays. Given the following books array</p>
<pre><code>var books = ["tarzan", "jungle book", "cinderella"];</code></pre>
<p>How would you get the last element of this array. You could something like this</p>
<pre><code>var lastBook = books[books.length-1] ;
console.log ( lastBook );</code></pre>
<p>Pretty self explanatory. But what if you wanted this to have a method on books array… like a method called&nbsp;<strong>last</strong> that automatically returned this value.</p>
<pre><code>Instead of</code></pre>
<p><code>var lastBook = books[books.length-1] ;</code></p>
<pre><code>We would have
var lastBook = books.last;</code></pre>
<p>We can use defineProperty like we learned in the <a href="http://scriptonitejs.com/javascript-objects/">previous</a>&nbsp;tutorial</p>
<pre><code>Object.defineProperty(books, 'last', {
  get: function(){
   return this[this.length-1];
  }
});</code></pre>
<p>With this is place we can call books.last</p>
<pre><code>var lastBook = books.last;
console.log(lastBook);</code></pre>
<p>Remember we covered defineProperty in the <a href="http://scriptonitejs.com/javascript-objects/">previous</a> tutorial. Our <strong>last</strong>&nbsp;method works with no problems, however if we create a new array</p>
<pre><code>var morebook = ["American Ninja", "Superman", "Batman"];</code></pre>
<p>and&nbsp;tried to access morebook.last that would not work! Why? Because the last method only works for one array; books. How can we extend this to all arrays? Here is where prototypes comes in. We need to put this method on the Array objects prototype. All we do is this</p>
<pre><code>Object.defineProperty(Array.prototype, 'last', {
  get: function(){
   return this[this.length-1];
  }
});</code></pre>
<p>Now we can call morebook.last and we get Batman as a result.</p>
<p>OK! Like previous tutorials, that was a lot to cover. Knowledge is prototypal inheritance is vital if you are going to be a true javascript ninja. This topic most definitely causes a lot of confusion among-st&nbsp;javascript developers, so its important you understand it.&nbsp;I certainly do not call myself an expert on the subject. I am still&nbsp;learning, just like you  If you feel i missed certain things, i urge you to mention them. I am always in a good mood to learn something new. Please follow or reach out to me on social media or reply back on this post if you have to. Thank you,&nbsp;and please come back for updated tutorials.</p>
<div class="sharedaddy sd-sharing-enabled"><div class="robots-nocontent sd-block sd-social sd-social-text sd-sharing"><h3 class="sd-title">Share this:</h3><div class="sd-content"><ul><li><a href="#" class="sharing-anchor sd-button share-more"><span>Share</span></a></li><li class="share-end"></li></ul><div class="sharing-hidden"><div class="inner" style="left: 591.5px; top: 22502px; display: none;"><ul><li class="share-facebook"><a rel="nofollow" data-shared="sharing-facebook-280" class="share-facebook sd-button no-icon" href="http://scriptonitejs.com/prototype-and-prototypal-inheritance/?share=facebook&amp;nb=1" target="_blank" title="Click to share on Facebook"><span>Facebook<span class="share-count">28</span></span></a></li><li class="share-twitter"><a rel="nofollow" data-shared="sharing-twitter-280" class="share-twitter sd-button no-icon" href="http://scriptonitejs.com/prototype-and-prototypal-inheritance/?share=twitter&amp;nb=1" target="_blank" title="Click to share on Twitter"><span>Twitter</span></a></li><li class="share-end"></li><li class="share-google-plus-1"><a rel="nofollow" data-shared="sharing-google-280" class="share-google-plus-1 sd-button no-icon" href="http://scriptonitejs.com/prototype-and-prototypal-inheritance/?share=google-plus-1&amp;nb=1" target="_blank" title="Click to share on Google+"><span>Google</span></a></li><li class="share-linkedin"><a rel="nofollow" data-shared="sharing-linkedin-280" class="share-linkedin sd-button no-icon" href="http://scriptonitejs.com/prototype-and-prototypal-inheritance/?share=linkedin&amp;nb=1" target="_blank" title="Click to share on LinkedIn"><span>LinkedIn</span></a></li><li class="share-end"></li><li class="share-print"><a rel="nofollow" data-shared="" class="share-print sd-button no-icon" href="http://scriptonitejs.com/prototype-and-prototypal-inheritance/#print" target="_blank" title="Click to print"><span>Print</span></a></li><li class="share-email share-service-visible"><a rel="nofollow" data-shared="" class="share-email sd-button no-icon" href="http://scriptonitejs.com/prototype-and-prototypal-inheritance/?share=email&amp;nb=1" target="_blank" title="Click to email this to a friend"><span>Email</span></a></li><li class="share-end"></li><li class="share-end"></li></ul></div></div></div></div></div>		</div>
					
					</div>
				</article>
				<!--================= END :: Tutorial =================-->
				
				<!--================= START :: Tutorial =================-->
				<article>
					<a id="t-70" name="t-70"></a><h1>70 : JavaScript Algorithms : Singly Linked List</h1>
					<span class="ref-site">http://scriptonitejs.com/js-singly-linked-list/</span>
					<div class="tutorial__content">
<div class="entry-content">
			<p>This is going to be the first post in a series called&nbsp;"javascript data structures and algorithms". I plan to cover most of the algorithms found in computer science classes, using javascript as a language of choice. This is no easy feat to take on, but it is a goal i have set. It may take a while to complete as i have a full time job, but i will do my best. I do not consider myself an expert on the subject matter, so kindly advise if you ever think something can be coded in a much more efficient manner. The only reason i write this post, like all other posts, is to get a better understanding of the subject matter. We start our journey with linked lists, particularly javascript singly linked list.<span id="more-576"></span></p>
<p>Lets get to it! A data structure is a way of organizing and storing data. A Javascript Linked List is a type of data structure. There are many different types, each representing different ways or storing and accessing data. As a software developer, understanding these structures is crucial when&nbsp;solving problems. Choosing a wrong data structure can lead to bad application performance and efficiency, so its important that we understand them in order to properly use them. Not all data structures are created equally. One might be better at doing one thing than another, or&nbsp;vice versa.&nbsp;Knowing the strengths and weakness of the data structures you choose will help you build highly efficient applications. For example some data structures can store data very fast, but are poor at&nbsp;searching through them. If fast storage&nbsp;is the highest priority in your app requirements then maybe this might be the best data structure to use. Perhaps, searching and retrieving data is more important, in which case a data structure that is great at searching might be preferred. In an ideal world we would have just one data structure. But that is not the case. We have a plethora of data structures to choose from, we only need to choose them&nbsp;wisely.</p>
<p>Before reading this post make sure you have a good understand of javascript object and prototypal inheritance. If you do not, you have read my post</p>
<ol>
<li><a href="http://scriptonitejs.com/javascript-objects/">Javascript Objects</a></li>
<li><a href="http://scriptonitejs.com/prototype-and-prototypal-inheritance/">Prototype and Prototypal Inheritance&nbsp;</a></li>
</ol>
<p>You can download or clone the source from github : <a href="https://github.com/scriptonian/algorithms.git" target="_blank">HERE!</a></p>
<p>Perhaps&nbsp;the most commonly used data structure is an array. We have all used them (they are sometimes even called <em>lists</em>). Arrays store linear&nbsp;collections of data&nbsp;where elements can be accessed through their indices (non-negative integers e.g. 0, 1, 2, 3, etc). Because data is located via index numbers&nbsp;you can retrieve them very fast! Ask for data located in index 3 and you get it pronto!</p>
<p><a href="http://scriptonitejs.com/wp-content/uploads/2017/02/IMG_20170207_094749.jpg"><img class="size-large wp-image-589 aligncenter" src="http://scriptonitejs.com/wp-content/uploads/2017/02/IMG_20170207_094749-1024x910.jpg" alt="" width="720" height="640" srcset="http://scriptonitejs.com/wp-content/uploads/2017/02/IMG_20170207_094749-1024x910.jpg 1024w, http://scriptonitejs.com/wp-content/uploads/2017/02/IMG_20170207_094749-300x267.jpg 300w, http://scriptonitejs.com/wp-content/uploads/2017/02/IMG_20170207_094749-768x683.jpg 768w, http://scriptonitejs.com/wp-content/uploads/2017/02/IMG_20170207_094749-960x853.jpg 960w" sizes="(max-width: 720px) 100vw, 720px"></a></p>

<p>Notice how data sits next to each other. The figure above is a visual presentation of how arrays look like in memory. This is how data is stored in an Array (next to each other). In figure 1c, notice to retrieve "Peach", you have to access the array at index 4. Take a look at the diagram and make sure you understand it.</p>
<p>A linked list also stores a sequential collections of data, but the way it does this is different from arrays. <strong>Within</strong> a linked list, you will find a collection of nodes. See image below, each <strong>circle</strong> represents a node that stores information about itself and have a reference pointing to the next node. The data found in the node is sometimes called an <strong>element</strong>. &nbsp;Imagine that all these nodes are located in a container. This&nbsp;container&nbsp;<strong>IS</strong>&nbsp;what we will call our linked list (it is a collection of nodes).</p>
<figure id="attachment_611" style="width: 720px" class="wp-caption aligncenter"><a href="http://scriptonitejs.com/wp-content/uploads/2017/02/IMG_20170212_153144.jpg"><img class="size-large wp-image-611" src="http://scriptonitejs.com/wp-content/uploads/2017/02/IMG_20170212_153144-1024x441.jpg" alt="Linked List Diagram" width="720" height="310" srcset="http://scriptonitejs.com/wp-content/uploads/2017/02/IMG_20170212_153144-1024x441.jpg 1024w, http://scriptonitejs.com/wp-content/uploads/2017/02/IMG_20170212_153144-300x129.jpg 300w, http://scriptonitejs.com/wp-content/uploads/2017/02/IMG_20170212_153144-768x331.jpg 768w, http://scriptonitejs.com/wp-content/uploads/2017/02/IMG_20170212_153144-960x413.jpg 960w" sizes="(max-width: 720px) 100vw, 720px"></a><figcaption class="wp-caption-text">Linked List Diagram</figcaption></figure>
<p>A Linked List is faster at adding&nbsp;data quickly, than it is at retrieving. So if saving data is more prevalent in your app than searching, then this might be the best for you. Its not that a&nbsp;linked list is terrible at searching, however there are data structures that are faster at doing that, like a hash table. It also does not mean that hash table is the best. Again all data structures come with their pros and cons. Lets see another representation of the above diagram to prove a point.</p>
<figure id="attachment_595" style="width: 720px" class="wp-caption aligncenter"><a href="http://scriptonitejs.com/wp-content/uploads/2017/02/IMG_20170211_092321.jpg"><img class="size-large wp-image-595" src="http://scriptonitejs.com/wp-content/uploads/2017/02/IMG_20170211_092321-1024x720.jpg" alt="Javascript Linked List" width="720" height="506" srcset="http://scriptonitejs.com/wp-content/uploads/2017/02/IMG_20170211_092321-1024x720.jpg 1024w, http://scriptonitejs.com/wp-content/uploads/2017/02/IMG_20170211_092321-300x211.jpg 300w, http://scriptonitejs.com/wp-content/uploads/2017/02/IMG_20170211_092321-768x540.jpg 768w, http://scriptonitejs.com/wp-content/uploads/2017/02/IMG_20170211_092321-960x675.jpg 960w" sizes="(max-width: 720px) 100vw, 720px"></a><figcaption class="wp-caption-text">Linked List Diagram</figcaption></figure>
<p>Note that Linked Lists(LL)&nbsp;do not need to sit next to each other like arrays do. The nodes are "linked" together by a pointer. In a singly linked list (which is a type of LL, other types are doubly and circular linked list), each node ONLY has a reference to the node after it (the next pointer). In a doubly linked list, the LL nodes have two pointers (one to the next node, the other to the previous). We will cover doubly linked lists later. The point i am making here is, when a node is added to a linked list, it can sit anywhere in memory.&nbsp;In the diagram above, the node with value 1 knows how to reach its next node 2. It knows where in memory it sits, as node 4 know where node 5 sits. If lets say you wanted to add node 6 to the above diagram, you would have to tell node 5 to update its next pointer. If you want to add a node in between already existing nodes, for example you want to add 4a in between 4 and 5, then you would change the next point on 4 to point to 4a and tell 4a to point to 5.</p>
<p>If you did this in an array the JS engine would have to reindex the entire array collection, which can be expensive depending on size of the array. Most developers are blind to this behind the scene operation. But in a linked list implementation, we only update the pointers, which will have a constant time complexity. With arrays, the size of the array determines how much work needs to be done in the background to reindex. Hence the reason why Linked Lists are faster at add and remove operations.</p>
<p>For simplicity however, when diagramming in this post we will use a straight line to represent linked lists. But know that they sit in different locations in memory.</p>
<h2>Head and Tail</h2>
<p>For a linked list to function properly, it only needs to know about 2 nodes in the entire collection. It needs to know about the head and tail node pointers. The head node&nbsp;pointer marks the beginning of the node, and the tail node pointer marks the end. In most&nbsp;implementations of the LinkedList you will not see a tail. Why? A tail is really not needed as the next pointer of the last element in a singly or doubly linked list is always <strong>null</strong>. We include it in our implementation because it gives us certain benefits. If we can always know what the tail is in our linked list, we can perform certain operations faster. Linked list operations that do not keep a reference to the tail have a O(n) for adding/removing from the tail or end of list. But we can change that to O(1), by keeping a reference to it. Lets see how this looks visually.</p>
<figure id="attachment_599" style="width: 720px" class="wp-caption aligncenter"><a href="http://scriptonitejs.com/wp-content/uploads/2017/02/IMG_20170211_105955.jpg"><img class="size-large wp-image-599" src="http://scriptonitejs.com/wp-content/uploads/2017/02/IMG_20170211_105955-1024x439.jpg" alt="Linked List Head and Tail" width="720" height="309" srcset="http://scriptonitejs.com/wp-content/uploads/2017/02/IMG_20170211_105955-1024x439.jpg 1024w, http://scriptonitejs.com/wp-content/uploads/2017/02/IMG_20170211_105955-300x129.jpg 300w, http://scriptonitejs.com/wp-content/uploads/2017/02/IMG_20170211_105955-768x329.jpg 768w, http://scriptonitejs.com/wp-content/uploads/2017/02/IMG_20170211_105955-960x411.jpg 960w" sizes="(max-width: 720px) 100vw, 720px"></a><figcaption class="wp-caption-text">Linked List Head and Tail</figcaption></figure>
<p>As you can see, we have a linked list with nodes. Nothing new here. However we see added new elements to our collection. We now have a head which points to node 1 and a tail, which points to node 5. The tails next is always null. The linked list data structure is really concerned about these two node. If we wanted to perform a search on linked list for example(to find data), we would need to know where to begin or perhaps where to end. The head and tail pointer helps the linked list make this&nbsp;decision. So what kind of&nbsp;things(operations) we can perform on a linked list?&nbsp;We maybe want to add a new node to mark the beginning of our linked list, in which case the header now points to that node, or we may want to add a new node to the end of the linked list, in which case the tail now points to that node.</p>
<p>The best way to think of&nbsp;it is this: Look at the Linked list above with the head and tail. Now imagine we add a new node to this collection that we want to mark as the beginning. Lets say this node is called zero(0). When you add this node, you will change the pointer of head,&nbsp;to point to zero and <strong>not</strong> 1. The same for the tail. Lets add a node called 6 that we want to mark as the end of the list. Adding 6, we will now change our tail pointer to 6. We know we are at the tail because its next is null. Perhaps a diagram will be better for clarity.</p>
<figure id="attachment_600" style="width: 720px" class="wp-caption aligncenter"><a href="http://scriptonitejs.com/wp-content/uploads/2017/02/IMG_20170211_112631.jpg"><img class="size-large wp-image-600" src="http://scriptonitejs.com/wp-content/uploads/2017/02/IMG_20170211_112631-1024x424.jpg" alt="Changing Head and Tail" width="720" height="298" srcset="http://scriptonitejs.com/wp-content/uploads/2017/02/IMG_20170211_112631-1024x424.jpg 1024w, http://scriptonitejs.com/wp-content/uploads/2017/02/IMG_20170211_112631-300x124.jpg 300w, http://scriptonitejs.com/wp-content/uploads/2017/02/IMG_20170211_112631-768x318.jpg 768w, http://scriptonitejs.com/wp-content/uploads/2017/02/IMG_20170211_112631-960x398.jpg 960w" sizes="(max-width: 720px) 100vw, 720px"></a><figcaption class="wp-caption-text">Changing Head and Tail</figcaption></figure>
<p>Notice that the head and tail now point to the new nodes(no longer 1 and 5). This may be be what you might want to do in your collection. Perhaps you want to add a new node in the middle, before or after a particular node. Or maybe you want to delete a node from the middle. There are many things one might want. Lets take a look at add and remove.</p>
<figure id="attachment_602" style="width: 720px" class="wp-caption aligncenter"><a href="http://scriptonitejs.com/wp-content/uploads/2017/02/IMG_20170211_115810.jpg"><img class="size-large wp-image-602" src="http://scriptonitejs.com/wp-content/uploads/2017/02/IMG_20170211_115810-960x1024.jpg" alt="Linked List Add and Remove" width="720" height="768" srcset="http://scriptonitejs.com/wp-content/uploads/2017/02/IMG_20170211_115810-960x1024.jpg 960w, http://scriptonitejs.com/wp-content/uploads/2017/02/IMG_20170211_115810-281x300.jpg 281w, http://scriptonitejs.com/wp-content/uploads/2017/02/IMG_20170211_115810-768x819.jpg 768w" sizes="(max-width: 720px) 100vw, 720px"></a><figcaption class="wp-caption-text">Linked List Add and Remove</figcaption></figure>
<p>See what is going on here? In the add operation, we wanted to add 2a to our collection. The next node for 2 was originally 3, however we changed that node to point to our new node 2a and we set the next of 2a&nbsp;to be 3. If we decided to remove 2a, we set the pointer of the node before 2a (which is 2) to point to the next node of 2a ( the node being removed) which is 3. See now 2a is not part of our linked list collection (in diagram there is no pointer). When this happens that object is lost in the computer memory and it will be cleaned up by the garbage collector. You can also choose to set that node to null.</p>
<p>It is always good practice to draw these out&nbsp;as they help you write your code when the times comes. Enough talk already, lets get coding.</p>
<h2>Singly Linked List Classes</h2>
<p>We will be creating two classes (functions) for our linked list. Remember a linked list is a collection of nodes. We will create a Node class, and a LinkedList class which provides operations for&nbsp;nodes(such as adding, removing, displaying, etc). Optionally you could create just one class (LinkedList) and define a Node&nbsp;object&nbsp;inside. I will create two classes just so our implementation is a bit more modular. First the Node class</p>
<h3>Node Class</h3>
<p>The node class represents the object we want to add to our Linked List (remember the circular objects in our&nbsp;diagrams?). It is the basic building block block of a Linked List. It has an <strong>element</strong>&nbsp;property which is the data/value we want to add to the node. It also has a <strong>next</strong> property, which stores a link to the next node in the linked list. The&nbsp;node class is we are talking about now is that of a <strong><em>singly linked list</em></strong>. Lets starts with this type of linked list,&nbsp;and moved to more advanced ones later. Here is&nbsp;our Node class constructor function</p>
<pre><code>function Node(element) {
 this.element = element;
 this.next = null;
}</code></pre>
<p>This should be clear and simple. We created a class that has two properties (element and next). You already know their purpose.</p>
<h3>LinkedList&nbsp;Class</h3>
<p>Next we create a linked list class (a container for our node objects). Remember a linked list really only cares about two properties. The head and tail nodes, so we will create these properties.</p>
<pre><code>function LinkedList() {
 this.head = null;
 this.tail = null;
 this._length = 0;
}</code></pre>
<p>Here we have our LinkedList constructor function with properties defined. When you create a linked list, it is only natural that it is empty(length property of zeo). This is why the head and tail properties are set to <strong>null</strong>&nbsp;( clearly there are no nodes yet ). I have mentioned a few times that we really don't need to track the tail.&nbsp;But it gives us certain performance benefits. We may talk a bit about Big-O Notation later on. We also add the length property so that the linked list always knows how many nodes there are.</p>
<h2>Linked List Operations</h2>
<p>A linked list also has operations it needs to perform as mentioned earlier. Here are the operations we want to add to our linked list. We want to be able to <strong>addToHead, addToTail, insert, removeHead, removeTail, delete, indexOf, isEmpty, size, find, findPrevious, and display</strong>. Thats 12 operations we will be looking at. Notice i have a method&nbsp;to return the&nbsp;<strong>size</strong> of the linked list. Its only natural that at some point we will need to find exactly how many nodes there are in our list. When we add nodes to our LinkedList the <strong>length</strong> property is incremented. Our <strong>size()</strong> method returns the value of <strong>length.</strong></p>
<p>Before we create all these&nbsp;operations on our javascript linked list prototype, let us test the code we have by creating a linked list and node object instances.</p>
<pre><code>var foodList = new LinkedList(),
    pizzaNode = new Node("pizza");

console.log(foodList);  //LinkedList { head: null, tail: null }
console.log(pizzaNode);  //Node { element: 'pizza', next: null }</code></pre>
<p>We create two objects. A LinkedList, and a Node object and console log them. Our console shows us that <strong>foodList</strong> is an empty linked list with head and tail equals null, and the <strong>pizzaNode</strong> has an element value&nbsp;of "pizza",&nbsp;and a next pointer of null. Notice we don't have any nodes in the LinkedList. Yes we have a pizza node, but its not in the linked list collection yet. For that to happen we will need to create methods on our LinkedList class to perform these operations.</p>
<pre><code>LinkedList.prototype = {
 addToHead: function(element) {},
 addToTail: function(element) {},
 insert: function(position, element) {},
 find: function(element) {},
 removeHead: function() {},
 removeTail: function() {},
 delete: function(position) {},
 indexOf: function(element) {},
 isEmpty: function() {},
 size: function() {},
 display: function() {}
};</code></pre>
<p>If you like, you can add each operation individually to the prototype this way instead:</p>
<pre><code>LinkedList.prototype.append = function(element) {
 //do append operation
};</code></pre>
<p>I find the above a little verbose. Having to write LinkedList.prototype every single time is a bit much.&nbsp;In a real world project i would use the first style. But for demonstration purposes, i will use the&nbsp;long way so we can focus on each other individually. You can choose whichever way you like.</p>
<h3>Add To Head</h3>
<p>Our first operation will be the adding to the head. All this does is add a new element to the beginning&nbsp;of the linked list. Lets take a look at this visually.</p>
<figure id="attachment_616" style="width: 720px" class="wp-caption aligncenter"><a href="http://scriptonitejs.com/wp-content/uploads/2017/02/IMG_20170212_223018.jpg"><img class="size-large wp-image-616" src="http://scriptonitejs.com/wp-content/uploads/2017/02/IMG_20170212_223018-1024x745.jpg" alt="Heading to Head of Linked List" width="720" height="524" srcset="http://scriptonitejs.com/wp-content/uploads/2017/02/IMG_20170212_223018-1024x745.jpg 1024w, http://scriptonitejs.com/wp-content/uploads/2017/02/IMG_20170212_223018-300x218.jpg 300w, http://scriptonitejs.com/wp-content/uploads/2017/02/IMG_20170212_223018-768x559.jpg 768w, http://scriptonitejs.com/wp-content/uploads/2017/02/IMG_20170212_223018-960x698.jpg 960w" sizes="(max-width: 720px) 100vw, 720px"></a><figcaption class="wp-caption-text">Heading to Head of Linked List</figcaption></figure>
<p>Lets say you have a linked list with 3 elements (figure 3a). The head of the linked list is the item with value 10. Then you decide you want to add a new node to&nbsp;the linked list (figure 3b). You add node 5 to the beginning of the linked list and then you update the head to point to 5, and the new node's next to point to 10 &nbsp;(figure 3c). This is the operation we need to perform. When adding to the head, there are also two things to consider</p>
<ol>
<li>The linked list is empty and therefore this is the first element to be added</li>
<li>&nbsp;The linked list is NOT empty, and we want to append to the list.</li>
</ol>
<p>Lets write the code for this.</p>
<pre><code>LinkedList.prototype.addToHead = function(element) {
 //create a new Node
 var newNode = new Node(element);
 // Hand case for when linked list is not empty
 if (this.head) { 
   newNode.next = this.head;
   //this.head = newNode;
 } else { // Linked list is empty
   this.tail = newNode;
   //this.head = newNode;
 }
 //set the head to the new node
 this.head = newNode;
 //increment count
 this._length++;
};</code></pre>
<p>The code is a representation of figure 3. In order to add a node to the head of the LinkedList, we first create a new node. Then we check to see if the linked list is empty or if there are already existing nodes. If there is a head, then clearly there is already a node(s) in the list. So we update the next pointer of the new node to point to the current head, and we update the head node to point to the new node. If there is no head then there is/are no node(s) in the list and we can perform certain actions, like make the tail of the LinkedList point to the the new node as well as update the head to point to the new node. Remember if there is only one node in a LinkedList, the both the head and tail point to the same node. Notice that in the code i have commented out two nodes. See below (red arrows)</p>

<p><a href="http://scriptonitejs.com/wp-content/uploads/2017/02/git1-1.png"><img class="size-large wp-image-648 aligncenter" src="http://scriptonitejs.com/wp-content/uploads/2017/02/git1-1-1024x765.png" alt="Linked List Add To Head" width="720" height="538" srcset="http://scriptonitejs.com/wp-content/uploads/2017/02/git1-1-1024x765.png 1024w, http://scriptonitejs.com/wp-content/uploads/2017/02/git1-1-300x224.png 300w, http://scriptonitejs.com/wp-content/uploads/2017/02/git1-1-768x573.png 768w, http://scriptonitejs.com/wp-content/uploads/2017/02/git1-1-960x717.png 960w, http://scriptonitejs.com/wp-content/uploads/2017/02/git1-1.png 1129w" sizes="(max-width: 720px) 100vw, 720px"></a></p>
<p>Notice that i commented some code out in the if/else statement. This is because they are the same code. This means we can strip them out of the conditional block. It doesn't matter whether the LinkedList is empty or there are already existing nodes. If we add a node to it to the head, there&nbsp;will always <strong>be</strong>&nbsp;a new node. So we pull it out of the block and define it elsewhere (below). Lets take a closer look at our <strong>Debug Console</strong>&nbsp;in the screenshot above. You can see that i created a foodList LinkedLink and&nbsp;added the pizza node to the head of the foodList LinkedList(via addToHead method). Lets see how this looks like in the console by creating a linked list and added a node to the head.</p>
<p><a href="http://scriptonitejs.com/wp-content/uploads/2017/02/git2.png"><img class="size-full wp-image-650 aligncenter" src="http://scriptonitejs.com/wp-content/uploads/2017/02/git2.png" alt="linked list add to head" width="713" height="433" srcset="http://scriptonitejs.com/wp-content/uploads/2017/02/git2.png 713w, http://scriptonitejs.com/wp-content/uploads/2017/02/git2-300x182.png 300w" sizes="(max-width: 713px) 100vw, 713px"></a></p>
<p>You can see that both the head and the tail have point to the pizza object. It only makes sense that if we add another food node to this list, that the pizza object will now because the tail (next node) and the new food object will become the head. Lets prove this.</p>
<p><a href="http://scriptonitejs.com/wp-content/uploads/2017/02/git3-1.png"><img class="size-full wp-image-652 aligncenter" src="http://scriptonitejs.com/wp-content/uploads/2017/02/git3-1.png" alt="" width="739" height="457" srcset="http://scriptonitejs.com/wp-content/uploads/2017/02/git3-1.png 739w, http://scriptonitejs.com/wp-content/uploads/2017/02/git3-1-300x186.png 300w" sizes="(max-width: 739px) 100vw, 739px"></a></p>
<p>All i did above was to add a new node by calling addToHead (we pass in the name of the node we want to add). You can see that Spinach is now the new head, and its&nbsp;next pointer is pointing to pizza! This makes total sense. We also see that the LinkedLists tail is also the pizza node. There is no next node after pizza (so that is null). Does that make any sense?</p>
<h3>Add To Tail</h3>
<p>Add to tail is like add to head. This is the opposite of add to head. Instead of adding to the front of the list, you add to to the back. Lets update figure 3.</p>
<figure id="attachment_625" style="width: 720px" class="wp-caption aligncenter"><a href="http://scriptonitejs.com/wp-content/uploads/2017/02/IMG_20170219_204032.jpg"><img class="size-large wp-image-625" src="http://scriptonitejs.com/wp-content/uploads/2017/02/IMG_20170219_204032-1024x756.jpg" alt="Linked List Add to Tail" width="720" height="532" srcset="http://scriptonitejs.com/wp-content/uploads/2017/02/IMG_20170219_204032-1024x756.jpg 1024w, http://scriptonitejs.com/wp-content/uploads/2017/02/IMG_20170219_204032-300x221.jpg 300w, http://scriptonitejs.com/wp-content/uploads/2017/02/IMG_20170219_204032-768x567.jpg 768w, http://scriptonitejs.com/wp-content/uploads/2017/02/IMG_20170219_204032-960x709.jpg 960w" sizes="(max-width: 720px) 100vw, 720px"></a><figcaption class="wp-caption-text">Linked List Add to Tail</figcaption></figure>
<p>This time we add a new node 40 to the tail of the list. Before we did this, the tail of the list was 30, with a next value of null (figure 4a). We added a new node to the LinkedList ( figure 4b), and finally updated the pointers ( 4c). Lets write the code for this</p>
<pre><code>LinkedList.prototype.addToTail = function(element) {
 //create a new Node
 var newNode = new Node(element);
 // Handle case for when linked list is not empty
 if (this.tail) {
  this.tail.next = newNode;
  //this.tail = newNode;
 } else {
  this.head = newNode
  //this.tail = newNode;
 }
  this.tail = newNode;
  //increment count
  //this._length++;
}</code></pre>
<p>This code looks very similar to addToHead. We add a new node to our LinkedList collection. Check to see if there is already a tail. If there is, we change that current tails next node to point to the new node, and we update the tail node of the linked list to point to the new node. If there is no tail, then it means there is no head, so we set both the head and the tail of the LinkedList to be the new node. Simple stuff. Make sure you look at the diagrams when you try to solve these, its very simple to see how the operations works. Lets test our code by adding something to the tail. We already have pizza and spinach. Lets add pasta</p>
<pre><code>foodList.addToTail("Pasta");
console.log(foodList);</code></pre>
<p>Lets see what the console log looks like.</p>
<p><a href="http://scriptonitejs.com/wp-content/uploads/2017/02/git5.png"><img class="size-full wp-image-655 aligncenter" src="http://scriptonitejs.com/wp-content/uploads/2017/02/git5.png" alt="" width="624" height="388" srcset="http://scriptonitejs.com/wp-content/uploads/2017/02/git5.png 624w, http://scriptonitejs.com/wp-content/uploads/2017/02/git5-300x187.png 300w" sizes="(max-width: 624px) 100vw, 624px"></a></p>
<p>Under the head tree you can see the first element in the linked list ( Spinach ). This was the second thing we added to our linked list and thus became the head. Notice that the tail is pasta. If you trace the nodes within the head as well, you notice that the last node (which is the tail) is also pasta. This makes sense as we added pasta using the <strong>addToTail</strong> method (so it must be added as the last node in the linked list). Now lets see how to remove the head or tail.</p>
<h3>Remove Head or Tail</h3>
<p>Removing the head is quite simple. Within a linked list, if there is a head, then its possible to remove&nbsp;it (see figure 5 below). If there is no head, it only means the linked list is empty. If however there is a head, it is also possible that there is only one node (the head) or there are multiple nodes. If there is only one node, then removing the head means the head and tail now point to null after removal. If there are multiple nodes then we want to make the next node of the current head the new head and set the old head to null.</p>
<p><img class="size-large wp-image-644 aligncenter" src="http://scriptonitejs.com/wp-content/uploads/2017/02/IMG_20170223_224154-1024x686.jpg" alt="Linked List Remove Head" width="720" height="482" srcset="http://scriptonitejs.com/wp-content/uploads/2017/02/IMG_20170223_224154-1024x686.jpg 1024w, http://scriptonitejs.com/wp-content/uploads/2017/02/IMG_20170223_224154-300x201.jpg 300w, http://scriptonitejs.com/wp-content/uploads/2017/02/IMG_20170223_224154-768x515.jpg 768w, http://scriptonitejs.com/wp-content/uploads/2017/02/IMG_20170223_224154-960x643.jpg 960w" sizes="(max-width: 720px) 100vw, 720px"></p>
<p>Figure 5 demonstrates the case where the linked list either has one node or multiple. However remember that if there is no head, then there is nothing at all to remove. Lets see the code for this</p>
<pre><code>LinkedList.prototype.removeHead = function() {
 //if there is a head, then there is a node or possibly nodes in the list
 var headExists = this.head;
 if(headExists) {

 //save the current value of the head
 var value = this.head.element;

 //case 1: there are multiple nodes
 if(this.head.next != null) { 
   var temp = this.head;
   // there is another node so set that to the head
   this.head = this.head.next;
   //set the temp (previous) to null
   temp = null;
 } else { 
   //this.head.next is a null, means there is only one node
   this.head = null;
   this.tail = null;
 }
 //since headExists
 this._length--;
 } else {
   //there is no head OR !this.head... So linked list is empty
   return null;
 }

 return value;
};</code></pre>
<p>This should be relatively simple to understand. Also take note that this time we are not adding to the length. If a head exists we are always sure to decrement the count in our linked list. Lets see an example where we remove the head node.</p>
<p><a href="http://scriptonitejs.com/wp-content/uploads/2017/02/git6.png"><img class="size-full wp-image-657 aligncenter" src="http://scriptonitejs.com/wp-content/uploads/2017/02/git6.png" alt="" width="518" height="523" srcset="http://scriptonitejs.com/wp-content/uploads/2017/02/git6.png 518w, http://scriptonitejs.com/wp-content/uploads/2017/02/git6-150x150.png 150w, http://scriptonitejs.com/wp-content/uploads/2017/02/git6-297x300.png 297w" sizes="(max-width: 518px) 100vw, 518px"></a></p>
<p>We added 3 nodes to the linked list. Since the last node added using the addToHead method was pasta and we called the removeHead function, we no longer see the pasta node in our console. Meaning it works!</p>
<h3>size() &amp; isEmpty()</h3>
<p>Two other very simple operations worth mentioning is size and isEmpty. <strong>size()</strong> returns the number of nodes in the linked list. If you have been looking carefully at the console log you can see that the linked property is always incremented or decremented when you add or remove from head/tail. <strong>isEmpty()</strong> returns a boolean of whether the linked list is empty or not. Its good to have these methods, as we can use them to help write better algorithms. For example, you may want to find out if the linked list isEmpty before performing certain actions. We can actually re-write some of our existing code with this in mind. Here is how they look like in code.</p>
<pre><code>LinkedList.prototype.size = function() {
 return "LinkedList Size Is: " + this._length;
};

LinkedList.prototype.isEmpty = function() {
 return this._length === 0;
};</code></pre>
<p>isEmpty returns a boolean and you can test for true or false based on what is returned and perform some action. So far all the examples we have looked at are&nbsp;very simple.&nbsp;We are starting our journey into linked lists by first looking at the simplest of linked lists, the singly linked list. I felt this was important before starting to look at real world applications (that of doubly and circular linked lists). I am trying to get your mind used to operation flow of these systems. Notice that there is the idea of a previous node in a linked list, but for simplicity we have left them out for now.And its not that singly linked listed are not real world, they indeed have real world applications. For example, you may find scenarios where it is not necessary to track the previous node. When we start with the more advanced linked lists, you will see that it is much easier to understand because you have conquered singly linked lists.</p>
<h3>insert(), find() and display()</h3>
<p>Insert is a special operation. Its special because it allows us to add a new node anywhere in the middle of our LinkedList (we already know how to add to head and tail) .&nbsp;To be able to insert a new node, you must of course know where you want to add it. You must be able to find the position in-between&nbsp;first. Say in our linked list, we have 3 names: "Kofi", "Tania", and "Julie" and you wanted to insert a new node called "Tarik" in between "Tania" and "Julie", then you must first be able to find where Tania is in the linked list, update Tania's next pointer to point to Tarik, then update Tarik's next pointer to point to Julie. Lets see this in illustration.</p>
<p><a href="http://scriptonitejs.com/wp-content/uploads/2017/02/IMG_20170226_114343.jpg"><img class="size-large wp-image-660 aligncenter" src="http://scriptonitejs.com/wp-content/uploads/2017/02/IMG_20170226_114343-1024x632.jpg" alt="Linked List Insert Anywhere" width="720" height="444" srcset="http://scriptonitejs.com/wp-content/uploads/2017/02/IMG_20170226_114343-1024x632.jpg 1024w, http://scriptonitejs.com/wp-content/uploads/2017/02/IMG_20170226_114343-300x185.jpg 300w, http://scriptonitejs.com/wp-content/uploads/2017/02/IMG_20170226_114343-768x474.jpg 768w, http://scriptonitejs.com/wp-content/uploads/2017/02/IMG_20170226_114343-960x592.jpg 960w" sizes="(max-width: 720px) 100vw, 720px"></a></p>
<p>Notice&nbsp;here that our original list does not include Tarik. But we want to add him. So we find Tania and update her pointers. We also update Tarik's next pointer. Lets see how to perform this search:</p>
<pre><code>LinkedList.prototype.find = function(item) {
 var currentNode = this.head;
 while(currentNode) {
   if(currentNode.element === item) {
     return currentNode;
   }
   currentNode = currentNode.next;
 }
 return null;
};</code></pre>
<p>So what is going on here? When we call find, we tell it what item we want to find (eg Tania). In order to start our search we start from the head of the linked list! We could have started from the end as well. We get what the head node is (a the current node we are starting on), and run a while loop. As long as a current node exists we check to see if the element or value property of that node is the same as the item we are searching for. If they are the same, then we have found what we are looking for and we return that node to whoever called it (our search function). With this function, you can find any item in a linked list.</p>
<p>For our singly linked list implementation we will not be using the <strong>insert</strong>&nbsp;method to add to the head or tail (we already wrote the code for that: <strong>addToHead</strong> and <strong>addToTail).</strong>&nbsp;So insert here only means adding nodes in-between. This does not mean that we wont handle cases where we want to remove the head or tail. If we do, we will simply call those methods from within our insert method. However when we start looking at more advanced linked lists (like the doubly),&nbsp;we will rewrite this operation to insert at any position natively. For now if we want to add to head or tail, we will use already existing methods.</p>
<p>Before showing you the insert operation logic, i wanted to point that we still don't have any operations to display nodes in our linked list. Lets write that now as its easier.</p>
<pre><code>LinkedList.prototype.display = function() {
 var currentNode = this.head;
 while(currentNode) {
   console.log(currentNode.element);
   currentNode = currentNode.next;
 }
};</code></pre>
<p><strong>display</strong> is responsible for displaying nodes in a linked list. Its similar to find. We start at the head of the linked list and as long as there is a current node next property that is not null, we display the value or element of that node to our console. Lets move onto the next.</p>
<p>Our insert function uses both find and display as helper methods to do its operation. Lets take a look at insert</p>
<pre><code>LinkedList.prototype.insert = function(position, element) {
   //create the new node based on the name passed
   var newNode = new Node(element);
   //find the position or item node we want to insert after.
   var positionNode = this.find(position);
   //if the position node is found update pointers
   if (positionNode != null) {
     //first set the next pointer of new node to be that of position nodes next
     newNode.next = positionNode.next;
     //finally update the positionNode's next to be the new node
     positionNode.next = newNode;
     this._length++;
   } else {
     //position not found, return error
     throw new Error("Position Node Doesnt Exist!")
   }
};</code></pre>
<p>The insert operation takes two parameters. The first is the value of the position "<strong>after</strong>" which we want to insert, and the second is the new nodes value. So in our example earlier, if we want to insert a name after Tania, we pass Tania as an argument position. This tells the linked list, find Tania and insert a node&nbsp;after her. If we choose to insert it before Tania we could pass Kofi instead as the position. Well you might think, why don't we have <strong>insertAfter</strong> and <strong>insertBefore</strong> operations? WE COULD! But i will leave that to you to do. Doesn't really matter, you can write as many methods are you want. I wont write them because later on i will write an insert function that handles all case. But if you are curious, do write those two functions as exercise. Lets get back to our current insert implementation.</p>
<p>In this method&nbsp;we first create a new node that has the name of the element value passed in as a parameter. Then we search to see if the position of the node passed in exists. So we are going through our list to see if that node exists. If it does we perform some actions, if it doesn't we throw an error. If the position node exists then we update our pointers:&nbsp;first set the next pointer of new node to be that of current position nodes next and then&nbsp;update the positionNode's next to be the new node. If you have the diagram in front of you it is super simple to follow&nbsp;what is going on. Let us test our new function. We will create a <strong>peopleList</strong> linked list. Add some names and then insert new names at specified positions.</p>
<pre><code>var peopleList = new LinkedList();
peopleList.addToTail("Kofi");
peopleList.addToTail("Tani");
peopleList.addToTail("Julie");
peopleList.insert("Tani", "Tarik");
peopleList.insert("Julie", "Charles");
peopleList.display();</code></pre>
<p>We added Kofi, Tani and Julie using the addToTail methods. You can use addToHead of you like. Then we insert Tarik after Tani and Charles after Julie.</p>
<p><a href="http://scriptonitejs.com/wp-content/uploads/2017/02/Screen-Shot-2017-02-26-at-3.07.42-PM.png"><img class="size-full wp-image-663 aligncenter" src="http://scriptonitejs.com/wp-content/uploads/2017/02/Screen-Shot-2017-02-26-at-3.07.42-PM.png" alt="linked list insert" width="641" height="208" srcset="http://scriptonitejs.com/wp-content/uploads/2017/02/Screen-Shot-2017-02-26-at-3.07.42-PM.png 641w, http://scriptonitejs.com/wp-content/uploads/2017/02/Screen-Shot-2017-02-26-at-3.07.42-PM-300x97.png 300w" sizes="(max-width: 641px) 100vw, 641px"></a></p>
<p>Our display function outputs everything in our linked list. You can see things are in the right order. Tarik exists after Tani and Charles after Julie. What if we insert a node at a position that is not valid?</p>
<p><a href="http://scriptonitejs.com/wp-content/uploads/2017/02/Screen-Shot-2017-02-26-at-3.10.50-PM.png"><img class="size-full wp-image-664 aligncenter" src="http://scriptonitejs.com/wp-content/uploads/2017/02/Screen-Shot-2017-02-26-at-3.10.50-PM.png" alt="linked list invalid node" width="627" height="164" srcset="http://scriptonitejs.com/wp-content/uploads/2017/02/Screen-Shot-2017-02-26-at-3.10.50-PM.png 627w, http://scriptonitejs.com/wp-content/uploads/2017/02/Screen-Shot-2017-02-26-at-3.10.50-PM-300x78.png 300w" sizes="(max-width: 627px) 100vw, 627px"></a></p>
<p>As you can see, an error is thrown ("Position Node Doesn't Exist"). Which is what we want </p>
<p>We are very close to finishing our singly linked list. We have a few operations left. One of them is&nbsp;<strong>removeTail</strong>. We delayed&nbsp;removeTail for later, as we needed a way to find the previous nodes in a linked list. In a double linked list this is easy, but as straight forward in a singl. Since we now have an idea of how to traverse our list, we can address removing the tail by finding the previous node to it. Note that in a doubly linked list every node has a next and previous pointer (so the previous is always available to you_. In a singly linked list, we don't have a previous variable, like we have next, so we have to be a bit more&nbsp;creative.</p>
<h3>removeTail</h3>
<p>Lets start with a diagram</p>
<figure id="attachment_666" style="width: 720px" class="wp-caption aligncenter"><a href="http://scriptonitejs.com/wp-content/uploads/2017/02/IMG_20170226_152133.jpg"><img class="size-large wp-image-666" src="http://scriptonitejs.com/wp-content/uploads/2017/02/IMG_20170226_152133-1024x586.jpg" alt="Remove Tail" width="720" height="412" srcset="http://scriptonitejs.com/wp-content/uploads/2017/02/IMG_20170226_152133-1024x586.jpg 1024w, http://scriptonitejs.com/wp-content/uploads/2017/02/IMG_20170226_152133-300x172.jpg 300w, http://scriptonitejs.com/wp-content/uploads/2017/02/IMG_20170226_152133-768x440.jpg 768w, http://scriptonitejs.com/wp-content/uploads/2017/02/IMG_20170226_152133-960x550.jpg 960w" sizes="(max-width: 720px) 100vw, 720px"></a><figcaption class="wp-caption-text">Remove Tail</figcaption></figure>
<p>Here we remove from the last node&nbsp;in our linked list.&nbsp;In order to remove the tail, the challenge you will face is that you have to update the node that is previous to it. The only way to access this for a singly linked list is to <strong>entire</strong> traverse the list to&nbsp;find that node. I will&nbsp;introduced a new method called findPrevious.</p>
<pre><code>LinkedList.prototype.findPrevious = function(item) {
 //start search from the beginning
 var currentNode = this.head;

 while(currentNode.next != null) {
   if(currentNode.next == item) {
     return currentNode;
   }
   currentNode = currentNode.next
 }
 return currentNode;
};</code></pre>
<p>You pass the node you want to remove to this function. In this case the tail node. We create a while loop to start from the beginning of the linked list as long as the current nodes next is not null. Why? Well because if the current nodes next is null, then that is the tail node. But we want the one before the tail node. While this loop is going, for each validate iteration we check to see if that current nodes next is equal to the tail node. If it is so then it means we are on the previous node, and we return that node. We use this method in the remove tail operation.</p>
<pre><code>LinkedList.prototype.removeTail = function() {
 var previousNode = this.findPrevious(this.tail);
 //case 1. there is only one node because next is null
 if(previousNode.next === null) {
   //reset both head and tail to null
   this.head = null;
   this.tail = null;
 } else { //case 2 (multiple nodes)
   //update the next node (tail) to be null
   previousNode.next = null;
   //set the previousNode as the new tail
   this.tail = previousNode;
 }
  this._length--;
};</code></pre>
<p>RemoveTail first calls the findPrevious function to get the previous to last node. With&nbsp;that node, two things possible. Either that the returned node is the only node in the linked list, or there are multiple node remaining. If it is the only, then we just set the head and tail to null (which removes it from list), then decrement the linked list length property. If there are multiple nodes then the next pointer of the previous node will not be null. &nbsp;In that case we update the previous nodes next pointer to null (removing the tail) and set the new tail to the previous node. Lets move to our last operations.</p>
<h3>indexOf(), remove() &amp; removeAt()</h3>
<p>indexOf is similar to find (so its used to search for nodes). What it does differently is return the index number(zero based) of the element within the linked list. If it doesn't find it, it simply returns the value of -1. You pass the function the element you want's index and the function takes care of the rest.</p>
<pre><code>LinkedList.prototype.indexOf = function(element) {
 var currentNode = this.head,
     index = 0;
 while(currentNode) {
   if(currentNode.element === element) {
     return index;
   }
   index++;
   currentNode = currentNode.next;
 }
   return -1;
};</code></pre>
<p>This should be straight forward. You start searching from the head of the linked list until you find a node that is equal to the element that was passed in. During this search you keep count of the index numbers for the nodes and return that index number when a match is made.</p>
<p><strong>remove</strong> and <strong>removeAt</strong> are used to remove nodes from a linked list. Lets take a look at their code</p>
<div>
<pre><code>LinkedList.prototype.remove&nbsp;=&nbsp;function(element)&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;//find&nbsp;element&nbsp;to&nbsp;remove&nbsp;index
&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;elementIndex&nbsp;=&nbsp;this.indexOf(element);
&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;this.removeAt(elementIndex)
};</code></pre>
</div>
<p>Very simple. But there are some foreign methods in there. remove uses the indexOf operation to return the index of the element we want to remove from the linked list. Then removeAt gets that index and call removeAt with that index. Lets take a look at that code</p>
<div>
<pre><code>LinkedList.prototype.removeAt&nbsp;=&nbsp;function(position)&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;length&nbsp;=&nbsp;this._length&nbsp;-&nbsp;1;
&nbsp;&nbsp;&nbsp;&nbsp;//check&nbsp;removal&nbsp;bounds.&nbsp;check&nbsp;if&nbsp;position&nbsp;is&nbsp;valid
&nbsp;&nbsp;&nbsp;&nbsp;if(position&nbsp;&gt;&nbsp;-1&nbsp;&amp;&amp;&nbsp;position&nbsp;&lt;=&nbsp;length)&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;currentNode&nbsp;=&nbsp;this.head,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;currentIndex&nbsp;=&nbsp;0,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nextIndex&nbsp;=&nbsp;currentIndex&nbsp;+&nbsp;1;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(position&nbsp;===&nbsp;0)&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;this.removeHead();
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(position&nbsp;===&nbsp;length)&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;this.removeTail();
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;while(currentNode)&nbsp;{&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//if&nbsp;the&nbsp;next&nbsp;is&nbsp;equal&nbsp;to&nbsp;position&nbsp;then&nbsp;update&nbsp;the&nbsp;current&nbsp;header
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(nextIndex&nbsp;===&nbsp;position)&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//set&nbsp;the&nbsp;current&nbsp;next&nbsp;to&nbsp;pointer&nbsp;to&nbsp;the&nbsp;nexts&nbsp;next.
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;temp&nbsp;=&nbsp;currentNode.next.next;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//set&nbsp;temp&nbsp;to&nbsp;null
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;currentNode.next&nbsp;=&nbsp;null;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//finally&nbsp;set&nbsp;the&nbsp;current&nbsp;next&nbsp;to&nbsp;the&nbsp;object
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;currentNode.next&nbsp;=&nbsp;temp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;currentNode;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;{&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;currentNode&nbsp;=&nbsp;currentNode.next;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;currentIndex++;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;null;
&nbsp;&nbsp;&nbsp;&nbsp;}
};</code></pre>
</div>
<p>Probably the most lengthy operation we have written (hence the reason i saved it for last). I highly advice you take a look at the source code to this project on github which has a lot of&nbsp;code commenting. In the <strong>removeAt</strong> operation the function first checks to see if the position of the element you are passing in is valid. This is a good thing to do. You don't want your code executing if passing in params are not valid. Its a waste of resources. We check to see if the position is greater than -1 and less than or equal to the total items&nbsp;in the linked list. For example if there are 5 items in the list and you want to remove item 7, then we don't even waste time and return null. We can also choose to return an error (like invalid position passed). If the position is valid we check to see if the position is the head or tail. Since we already have functions already build, if the position meets this criteria we call our inbuilt functions. If position is not head or tail, then it means we have to search the list. We start our search from the head, and if the next index in the loop is equal to the position we are interested in, we update the pointers, if not we move to the next node and continue our search for the right position. Please review code comments for further clarification.</p>
<p>Ok we are approaching almost 6k words in this post. Time to wrap up! Understanding linked lists is crucial in any programming language. It is also important if you are planning on interviewing with top companies like Facebook, Amazon, or Google (my dream companies). You are more likely to use doubly or circular linked lists in the real word, but understand where they originate from; the <em><strong>singly linked list</strong></em> is key. There are many implementations out there. You can either write your own (i highly recommend if you truly want to understand it) or use an existing library. It all depends on what you want. I wrote this post so i could better understand them. If you think i should have done something differently, please comment on the post, i will be sure to update the code.</p>
<p>Lets continue to&nbsp;learn about doubly linked lists.&nbsp;We will write some of the code here and make it more solid for real world use. Thanks for reading.</p>
		</div>
					</div>
				</article>
				<!--================= END :: Tutorial =================-->
				
				<!--================= START :: Tutorial =================-->
				<article>
					<a id="t-71" name="t-71"></a><h1>71 : Call, Apply and Bind</h1>
					<span class="ref-site">http://scriptonitejs.com/js-call-apply-bind/</span>
					<div class="tutorial__content">

<div class="entry-content">
	<p><strong>Call, Apply and Bind</strong> seems to come across as mysterious for&nbsp;many javascript developers. I know it did for me in my early years. Even till today, i come across senior developers who (for lack of a better understanding) try to avoid using these methods all together. <strong>Call, Apply and&nbsp;Bind</strong>, have everything to do with the <em>this</em> keyword in javascript. Yet another confusing topic in javascript. Since this post is not about understanding the <em>this</em> keyword, i will assume that you understand the idea of <em>this</em> in javascript (Or maybe i should write a post about this in the future). In a nutshell, <em>this </em>points to either the global object OR the object that contains the function that is called(this always refers to an object). <em>this </em>can be unpredictable, unless you truly understand it. If we want to control what the <em>this </em>points to in javascript,&nbsp;<strong>Call, Apply and&nbsp;Bind</strong>&nbsp;can be shining stars.</p>
<p><span id="more-532"></span></p>
<p>Almost everything is an object in javascript. This includes functions. So what does it mean for a function to be an object? An object can have properties and methods. Lets take a quick look at an example</p>
<pre><code>var Food = {
 name: "kiwi",
 category: "Fruit",
 makeJuice: function() {
  var message = "Making " + this.name + " juice";
  return message;
 }
}</code></pre>
<p>Here we have a basic object with&nbsp;properties and methods. Because functions in javascript are objects, we can attach properties and objects to it. Lets take a look</p>
<pre><code>function Food() {
 //Logic Goes Here
}
Food.name = "kiwi";
Food.category = "Fruit";
Food.makeJuice = function() {
 var message = "Making " + this.name + " juice";
  return message;
};</code></pre>
<p>See what is going on ? Even though Food is a function, we are able to write properties as well as methods on them. How cool is that? One of the reasons i love javascript!… You can write a function on a function!</p>
<p>Because functions in javascript are objects, they ALSO&nbsp;get special inbuilt methods. Call, Apply and&nbsp;Bind are methods that live on EVERY&nbsp;function. You can even write your own methods on a functions if you understand ( <a href="http://scriptonitejs.com/prototype-and-prototypal-inheritance/">prototype and prototypal inheritance</a> ). All you need to do is add your custom method on the Function prototype object. Like this</p>
<pre><code>Function.prototype.makeJuice = function() {
 console.log("Making " + this.name + " juice"); 
}

var myFruit = function Food() {
 this.name = "kiwi";
}.makeJuice();</code></pre>
<p>Because make juice is on the prototype, we can call it on ANY function in our application. Call, Apply and Bind exist on functions so we can control how the <em>this</em> behaves behaves in them.</p>
<p>Lets see how to use this methods! First&nbsp;bind().</p>
<h2>bind()</h2>
<p>Earlier on we defined a <strong>Food</strong> object. This object had a method called <strong>makeJuice</strong>. Let us try calling this function elsewhere (i am sure you know what will happen)</p>
<pre><code>var myFruit = function() {
 return this.makeJuice();
}
console.log( myFruit() );</code></pre>
<p>What happens? Well <i>undefined</i>! this.makeJuice() cannot be found within myFruit because <em>this </em>is pointing to the wrong object( or makeJuice does not exist in myFruit). We could have called the makeJuice function with <strong>Food.makeJuice()</strong>&nbsp;however the <em>this</em> would have pointed to the Food object, which <em><strong>may</strong> </em>not be what we want. Now let us change what the <em>this</em> keyword points to using bind(). One could think of it this way, "I want the <em>this</em>&nbsp;object in myFruit to point to the Food object's <em>this</em>". Bind can take my arguments, but the first one is always which object the <em>this</em> should point to. <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function/bind">MDN</a>&nbsp;defines Bind like this</p>
<p><code><var>fun</var>.bind(<var>thisArg</var>[, <var>arg1</var>[, <var>arg2</var>[, ...]]])</code></p>
<p>Looking at this definition, you have a function object and you call the bind method, passing in the <em>this</em> object and other potential arguments to the function IF there are any. We will use bind like this</p>
<pre><code>var myPineapple = myFruit.bind(Food);
console.log( myPineapple() );</code></pre>
<p>We use the bind method on myFruit and tell it what to use for <em>this</em>. Then we assign the result to myPineapple and execute it (the results are shown in the console). The reason we can execute myPineapple,&nbsp;is because bind returns a function. It does <strong>not execute</strong> the function by calling it. <span style="color: #ff0000;">It only returns a copy of the function</span>. This is <strong>important</strong> to note as Call and Apply do it differently. We can even re-write our code like this</p>
<pre><code>var myFruit = function() {
 return this.makeJuice();
}.bind(Food)
console.log(myFruit());</code></pre>
<p>A little fancier, but this is possible. We already saw this earlier. This is what bind() does. It allows you to change the <em>this</em> within a function scope and it creates a copy of the function you bind to (which is returned). Lets look at how call() allows us to set the <em>this</em> keyword.</p>
<h2>call()</h2>
<p>Call is a no brainer. It calls a function. Have you ever called a function in javascript. How do you do that?</p>
<pre><code>function myFunction() {
 console.log("Do Something");
}
//call myFunction
myFunction();</code></pre>
<p>To call myFunction, you simply call it like this myFunction(). We have all written code like this. But there is another way to do it in javascript!</p>
<pre><code>myFunction.call();</code></pre>
<p>.call() allows us to call a function. But in doing that, we can ALSO set what object the <em>this</em> keyword points to(as well as pass parameters). Back to our earlier <strong>myFruit</strong> example, we can now call it this way.</p>
<pre><code>var anotherPineapple = myFruit.call(Food);
console.log(anotherPineapple);</code></pre>
<p>Notice in our console.log we are not executing anotherPineapple. This is because call does not make a copy of the function and return it. It simply executes the function.&nbsp;We console log what was returned from executing <strong>myFruit</strong>. Lets redefine <strong>myFruit</strong> to take some arguments. This is so you can see Call, Apply and Bind handle these.</p>
<pre><code>var myNewFruit = function(arg1, arg2) { 
 this.arg1 = arg1;
 this.arg2 = arg2;
 console.log("Arguments:" + arg1 + ' and ' + arg2);
 return this.makeJuice();
}</code></pre>
<p>We create a new fruit function and have it accept parameters. We can now use call like this</p>
<pre><code>myNewFruit.call(Food, "Strawberry", "Blackberry");</code></pre>
<p>our console now outputs the names of the berries. Or we can assign what is returned and log that instead.</p>
<pre><code>var output = myNewFruit.call(Food, "Strawberry", "Blackberry");
console.log(output);</code></pre>
<h2>apply()</h2>
<p>apply() is just like call(). The only difference is that&nbsp;we cannot pass in arguments the same way we did for call(). It accepts an array as the parameter. Earlier on we looked at how to call a function with .call(). Here is how we do it with apply().</p>
<pre><code>myFunction.apply();</code></pre>
<p>Again apply() is just like call() with only a one difference. Let us modify myFruit and&nbsp;make it more advanced by looking at a scenario where the <em>this</em> object changes context.</p>
<pre><code>var myBetterFruit = function() {
 this.name = 'Mango';
 return this.makeJuice();
}</code></pre>
<p>In this version, we add a new property to our function (this.name). What happens now is that when this.makeJuice is called (even though from the Food object) it first checks to see if <strong>this.name</strong> exists on its parent object, before checking on the Food object. Why does it do this? This is mainly due to how prototypal inheritance works. Within this.makeJuice we see logic like this</p>
<pre><code>var message = "Making " + this.name + " juice";</code></pre>
<p>When this.makeJuice executes, it first checks to see if this.name is on the object that called it (myBetterFruit). If this.name is not on there, it will use the this.name found on Food. Since we have upgraded our code to have this.name point to the myBetterFruit function, Mango will be displayed in our output.</p>
<pre><code>var mango = myBetterFruit.apply(Food);
console.log(mango);</code></pre>
<p>Even though <em>this</em> points to the Food object, it still borrows the <em>this.name</em> from the myBetterFruit function. Understanding this concept means your javascript skills are really beginning to grow. We are executing&nbsp;makeJuice from the Food object but using the <em>this</em>&nbsp;from the myBetterFruit function object only for the name variable.</p>
<p>I said the the only difference better Call and Apply was that apply accepted an array as an argument. Doing this with apply with give you an error</p>
<pre><code>myNewFruit.apply(Food, "Strawberry", "Blackberry")</code></pre>
<p>This is wrong. you need to pass the arguments and an array when using <strong>apply()</strong>.</p>
<pre><code>myNewFruit.apply(Food, ["Strawberry", "Blackberry"])</code></pre>
<p><strong>apply()</strong> wants an array as an argument list. And this makes sense because applications have different needs. And there is the need to call a function passing in an array. So for cases where you want to change where the <em>this</em> points to and you want to pass in an array, you have to use apply() and not call().</p>
<p>We can even use Call, Apply and Bind on IIFE's (immediately invoked function expressions)</p>
<pre><code>var SuperFood = {
 makeJuice: function(fruit) {
 console.log("Making some awesome " + fruit + " juice");
 }
};

(function(arg1) {
 this.makeJuice('Chia Seed');
 console.log("Another option is " + arg1 + " juice");
}).call(SuperFood, 'Mango');//or use apply and pass array</code></pre>
<p>Here is a slightly more advanced exam. We create a new object SuperFood that we want to use as <em>this</em>. Then we call an IIFE and change its&nbsp;<em>this</em> to that new object. Within the IIFE we call makeJuice passing in an argument. We can do this because we use call() to set <em>this</em>. And within the call we pass arguments to the IIFE. Take a hard look at this. A little tricky but i trust you can see what is going on.</p>
<p>Why would you ever want to use Call, Apply and Bind? Well there might be cases in your code that you just want to <strong>borrow</strong> a function from somewhere else! It makes sense. Why recreate a function when you can borrow it from else where. Another reason has to do with <strong>function currying</strong>. Now what on earth is that?&nbsp;Currying is a useful technique, with which you can <em><strong>partially</strong> evaluate</em> functions. Again what does this mean? Its like creating a copy of a function, but with some preset parameters already set (so you dont set them again) Lets see if we can understand with an example. First f</p>
<h2>Function borrowing with bind()</h2>
<p>As mentioned before we have an object, and we want to borrow a function that lives elsewhere in&nbsp;our object. Lets create such an object.</p>
<pre><code>var healthyfoods = {
 items: [
 {name:"apple", category:"fruit"},
 {name:"spinach", category:"vegetable"}
 ],
 displayFirstFood: function(){
 return this.items[0].name;
 }
}
console.log('First food is : ' + healthyfoods.displayFirstFood());</code></pre>
<p>We have a <strong>healthyfoods</strong> object that has some items, and a displayFirstFood method. We console log to display a message with the first food in the object. What if we created another object called junkFoods that had no display displayFirstFood method? Well this is where function borrowing comes into play.</p>
<pre><code>var junkfoods = {
 items: [
 {name:"mac &amp; cheese", category:"carbs"},
 {name:"steak", category:"meats"}
 ]
}</code></pre>
<p>As you can see. There is no displayFirstFood method. Let see how to borrow this method.</p>
<pre><code>var displayFirstJunk = healthyfoods.displayFirstFood.bind(junkfoods);
console.log("First Junk is " + displayFirstJunk());</code></pre>
<p>We use bind, which returns a copy of the function and tell it which object to use as <em>this</em>. Notice that <em>this</em>&nbsp;allows using the items array found in the junkfoods object.</p>
<h2>Function Currying with bind()</h2>
<p>Take a function&nbsp;cookFood</p>
<pre><code>function cookFood(ingredient1, ingredient2) {
 console.log('Adding ' + ingredient1 + ' to bowl');
 console.log('Adding ' + ingredient2 + ' to bowl');
}</code></pre>
<p>To execute this function you will have to pass some arguments to it</p>
<pre><code>cookFood("Oil", "Onion");</code></pre>
<p>Easy enough. But what if you want to call the function with ONLY one argument and expect the same output? And yes WITHOUT making any edits to the cookFood function. Tricky huh?&nbsp;Remember bind copies a function and does not execute it? We can write a statement like this</p>
<pre><code>var cookWithOil = cookFood.bind(this, 'Oil');</code></pre>
<p>We have now copied cookFood with one parameter already passed to it! And saved it into cookWithOil. We can now call cookFood with only one parameter. Notice that <em>this</em> here points to the global object.</p>
<pre><code>cookWithOil("Onion");</code></pre>
<p>Cool isnt it? Without using bind, we could modify our original function&nbsp;to something like this.</p>
<pre><code>function cookFood(ingredient2) {
 var ingredient1 = "Oil";
 console.log('Adding ' + ingredient1 + ' to bowl');
 console.log('Adding ' + ingredient2 + ' to bowl');
}
cookFood("Onion");</code></pre>
<p>But since you now know currying… that code looks like child's play Here is another good example</p>
<pre><code>function multiply(a,b) {
 return a*b;
}
var multiplyByThree = multiply.bind(this, 3);
console.log( multiplyByThree(4) );</code></pre>
<p>This should now be self explanatory by now. You can even pass 2 or more arguments.</p>
<pre><code>var multiplyByThree = multiply.bind(this, 3, 2);
console.log( multiplyByThree() );</code></pre>
<p>It all depends on your application needs.</p>
<h2>Nested functions</h2>
<p>We know that the <strong><em>this</em> </strong>represents what(object) owns the function or scope. We also know that <em><strong>this</strong></em> can be weird a lot of times and can change scope depending of how it is used. Hear is something very important for you to know: <strong>When you nest functions in an object, it disassociates the inner function from the surrounding object</strong>. What happens when this happens in javascript is that all unscoped functions become a property of the global object. Lets see some code</p>
<pre><code>(function(){
  this.name = "windowObject";
  console.log("Outside object : " + this.name);
  var foodObject = {
    name : "foodObject",
    makeFood : function() {
      console.log("Making: " + this.name);
    }
  };
  foodObject.makeFood();
 }).call(this);</code></pre>
<p>Not much is going on here. We create an IIFE to help ensure there are no clashes to things exposed in the global scope. We set a name property&nbsp;for the window object, and create an object called foodObject within this window object. Within the foodObject we define another name property. So there are two name properties: One for the global object and the other for the food object. We also create a method in the food object which outputs the name properties. Finally we execute the function ( foodObject.makeFood() ). What do you think will be shown in the console?</p>
<pre><code>Outside object : windowObject
Making: foodObject</code></pre>
<p>We get the above in the console. First the IIFE is invoked, causing the first console to fire (windowObject). Then foodObject.makeFood() is executed in the IIFE it outputs the name property in the object. I am sure this is what you expected, and you were right, but now let us add a nested function.</p>
<pre><code>(function(){
 this.name = "windowObject";
 console.log("Outside object : " + this.name);
 var foodObject = {
   name : "foodObject",
   makeFood : function() {
     console.log("Making: " + this.name);
     var makingAnotherFood = function() {
       console.log("Making Another: " + this.name);
     }
   makingAnotherFood();
  }
 };
  foodObject.makeFood();
 }).call(this);</code></pre>
<p>We added another function <strong>makeAnotherFood</strong>.&nbsp;All is does is console log what the <strong>this.name</strong> property is. What do you think will happen? Most of us would think the output would be foodObject, but shockingly this is false. Which bring me to the point i am trying to make.&nbsp;<strong>When you nest functions in an object, it disassociates the inner function from the surrounding object</strong>. Our console outputs</p>
<pre><code>Making Another: windowObject</code></pre>
<p>Well, bind() to the rescue! We use bind, passing in this to bind which binds the parent object to&nbsp;the function instead.</p>
<pre><code>(function(){
 this.name = "windowObject";
 console.log("Outside object : " + this.name);
 var foodObject = {
   name : "foodObject",
   makeFood : function() {
     console.log("Making: " + this.name);
     var makingAnotherFood = function() {
       console.log("Making Another: " + this.name);
   }.bind(this);
   makingAnotherFood();
  }
 };
 foodObject.makeFood();
 }).call(this);</code></pre>
<p>Now our console log will output</p>
<pre><code>Outside object : windowObject
Making: foodObject
Making Another: foodObject</code></pre>
<p>Hope you understand this Lets move on.</p>
<h2>What else?</h2>
<p>Well that is borrowing and currying with bind(), what about Call() and Apply()? We can use it exactly the same way. But we can we also do some interesting things. We can borrow functions from inbuilt classes like the Array and String object. Think of all the methods available to arrays or strings in javascript, yes we can "borrow" some of them depending on application needs. We saw a little bit of these earlier, where i added a method to the inbuilt Function object(to its prototype). The same goes for Array or String (for eg Array.prototype). For&nbsp;example, you want an object to have array-like behavior. An object doesn't have a length property like an array. But what if you wanted to have a length property on your object? Objects in javascript do not really have a lot of native methods. But you can most certainly build your object like an array (with its keys being non-negative integers). Matter of fact, jQuery uses this pattern as their core architecture(<a href="https://addyosmani.com/resources/essentialjsdesignpatterns/book/#compositepatternjquery">Composite Architecture</a>). Anytime you use $() it returns an array-like object, a collection of elements. Lets move on.</p>
<pre><code>var myArrayObject = {
 key1: "value 1",
 key2: "value 1",
 method1: function() {},
 method2: function() {},
 0: "Boobie Flay",
 1: "40",
 2: ["rice", "beans", "broccoli"],
 length: 3 
};</code></pre>
<p>Here we have an interesting looking object. Not only does it have normal key/value pairs it also has some kind of array indexing as key/value pairs… (array-like object). We also have a length property on that object. Lets see how we can use some arrays methods on this object. Starting with the Array.prototype.slice().</p>
<p>The <code><strong><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/slice">slice</a>()</strong></code> method returns a shallow copy of a portion of an array into a new array object selected from <code>begin</code> to <code>end</code> (<code>end</code> not included). The original array will not be modified. Lets see some examples</p>
<pre><code>var a = ['zero', 'one', 'two', 'three'];
var sliced = a.slice(1, 3);

console.log(a); // ['zero', 'one', 'two', 'three']
console.log(sliced); // ['one', 'two']</code></pre>
<p>Above is how we use the slice() method.</p>
<p>Let us borrow this method on our array-like object. Note: our object is NOT an array, but we are going to borrow and array method and use it on the object.</p>
<pre><code>var newArray = Array.prototype.slice.call(myArrayObject, 0);
console.log(newArray);</code></pre>
<p>We use the Array.Prototype.slice.call() method first passing in the <em>myArrayObject as this</em>&nbsp;object and a first parameter. Doing this will start from index 0 to the last index. Note: slice will only perform this operation on the non-negative key/value indexing in your object(0,1,2).&nbsp;We cannot call slice() directly on an object, so we have to use the Array.prototype route. Our console log outputs ["Boobie Flay", "40", Array[3]]!! The method was smart enough to know which keys in the object to work with. This opens up a whole new world. Lets try out other Array methods on our object. Lets try <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/indexOf">indexOf</a>().</p>
<pre><code>var myIndexOf = Array.prototype.indexOf.call(myArrayObject, "Boobie Flay");
console.log("index of " + myIndexOf);
if(myIndexOf === -1) {
 console.log('user not found');
} else {
 console.log('found user');
}</code></pre>
<p>The we can use pop(), reverse(), push(), and more. Try these methods out</p>
<pre><code>var myReverse = Array.prototype.reverse.call(myArrayObject);
console.log(myReverse);
var myPush = Array.prototype.push.call(myArrayObject, "push test");
console.log(myArrayObject);
var myPop = Array.prototype.pop.call(myArrayObject);
console.log(myArrayObject);</code></pre>
<p>This is very powerful. Do something else, use the array push method to add more items to your object. Something interesting happens, your length property increments automatically!</p>
<p>Where else might we want to borrow methods from Call, Apply and Bind? When coding in javascript, there is <strong>implicit</strong> argument that gets passed to all functions. Its called&nbsp;<strong><em>arguments</em>&nbsp;</strong>(go figure). Lets write out a function to see how this looks like.</p>
<pre><code>function funcArguments(params) {
 console.log("Params ", params); //Params a
 console.log("Arguments ", arguments); //Arguments { '0': 'a', '1': 'b', '2': 'c', '3': 'd' }
}
funcArguments("a", "b", "c", "d");</code></pre>
<p>We create a basic function here that accepts one parameter. We log that parameter to the console. But we do something else. We also log out a parameter that was never passed into the function! This is because javascript adds it for you(behind the scenes). Its <em>implicitly</em> added. All functions get this automatically. Notice however that <strong>params</strong> outputs only one thing ( the first parameter passed to the function ). But what if you want to pass more parameters to your function without updating the function definition. You can still call your functon with as many parameters as you like, you just have to access them with the <strong>arguments</strong> variable. Arguments is an array-like object! This bring us to why we are&nbsp;talking about this? If a function receives such an object, we can use Array prototype methods to access the arguments.</p>
<pre><code>function funcArguments(params) {
 var args = Array.prototype.slice.call(arguments, 0);
 console.log(args); //[ 'a', 'b', 'c', 'd' ]
}
funcArguments("a", "b", "c", "d");</code></pre>
<p>Notice args is not an array-like object now. Its an Array! There is so much you can do with this. There is one final thing i would like to talk about on how else we can use Call, Apply and Bind. Have you ever wanted to find the max number in an array? Well arrays in javascript do not have this method. You would have to write your own method to be able to do this. But if you know of the <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Math/max">Math.max()</a> method in javascript, you are able to borrow this method, which takes an array of numbers as a parameter.</p>
<pre><code>var myMagicNums = [2, 3, 45, 78, 123, 37, 111];
var maxMagic = Math.max.apply(Math, myMagicNums);
console.log(maxMagic)</code></pre>
<p>We borrow the max method from the Math class. Notice we pass a <strong>Math</strong>&nbsp;for <em>this</em> in the <em>apply</em> method. apply() needs to have a <em>this</em> to point to(along with a parameter, which is our array myMagicNums), this <em>this</em> is the Math Object. You could also set it to null. Its really not needed, however you still have to set a value in there.</p>
<h2>Call, Apply and Bind – Wrap Up!</h2>
<p>Ok, you should be an expert now and using Call, Apply and Bind. The next time you see it in code, you can laugh in its face. Hope you enjoyed this post. Thank you.</p>
<p>Here is a link to the JS file i was working in ( not tidy – its more a playground with code snippets&nbsp;)<br>
https://github.com/scriptonian/call-apply-bind.git</p>

	</div>
					
					</div>
				</article>
				<!--================= END :: Tutorial =================-->
				
				<!--================= START :: Tutorial =================-->
				<article>
					<a id="t-72" name="t-72"></a><h1>72 : JavaScript constructors, prototypes, and the `new` keyword</h1>
					<span class="ref-site">https://content.pivotal.io/blog/javascript-constructors-prototypes-and-the-new-keyword</span>
					<div class="tutorial__content">

<div class="entry">
	<p>Are you baffled by the <code>new</code> operator in JavaScript? Wonder what the difference between a function and a constructor is? Or what the heck a prototype is used for?</p>

<p>I'm going to lay it out straight.</p>

<p>Now, there's been a lot of talk for a long time about so-called "pseudo-classical" JavaScript. Mostly, the new guard of JavaScript folk don't like to use the <code>new</code> keyword. It was written into the language to act more like Java, and its use is a little confusing. I'm not going to take sides here. I'm just going to explain how it works. It's a tool; use it if it's practical.</p>

<h2>What is a constructor?</h2>

<p>A constructor is any function which is used as a constructor. The language doesn't make a distinction. A function can be written to be used as a constructor or to be called as a normal function, or to be used either way.</p>

<p>A constructor is used with the <code>new</code> keyword:</p>

<pre><code>var Vehicle = function Vehicle() {
  // ...
}

var vehicle = new Vehicle();
</code></pre>

<h2>What happens when a constructor is called?</h2>

<p>When <code>new Vehicle()</code> is called, JavaScript does four things:</p>

<ol>
	<li>It creates a new object.</li>
	<li>It sets the <code>constructor</code> property of the object to <code>Vehicle</code>.</li>
	<li>It sets up the object to delegate to <code>Vehicle.prototype</code>.</li>
	<li>It calls <code>Vehicle()</code> in the context of the new object.</li>
</ol>

<p>The result of <code>new Vehicle()</code> is this new object.</p>

<p><strong>1. It creates the new object.</strong></p>

<p>This is nothing special, just a fresh, new object: <code>{}</code>.</p>

<p><strong>2. It sets the <code>constructor</code> property of the object to <code>Vehicle</code>.</strong></p>

<p>This means two things:</p>

<pre><code>vehicle.constructor == Vehicle  // true
vehicle instanceof Vehicle      // true
</code></pre>

<p>This isn't an ordinary property. It won't show up if you enumerate the properties of the object. Also, you can try to set <code>constructor</code>, but you'll just set a normal property on top of this special one. To wit:</p>

<pre><code>vehicle;                          // {}

var FuzzyBear = function FuzzyBear() { };
vehicle.constructor = FuzzyBear;

vehicle;                          // { constructor: function FuzzyBear() }
vehicle.constructor == FuzzyBear; // true
vehicle instanceof FuzzyBear      // false
vehicle instanceof Vehicle        // true
</code></pre>

<p>The underlying, built in <code>constructor</code> property is something you can't set manually. It can only be set for you, as part of construction with the <code>new</code> keyword.</p>

<p><strong>3. It sets up the object to delegate to <code>Vehicle.prototype</code>.</strong></p>

<p>Now it gets interesting.</p>

<p>A function is just a special kind of object, and like any object a function can have properties. Functions automatically get a property called <code>prototype</code>, which is just an empty object. This object gets some special treatment.</p>

<p>When an object is constructed, <strong>it inherits all of the properties of its constructor's prototype</strong>. I know, it's a brainful. Here.</p>

<pre><code>Vehicle.prototype.wheelCount = 4;
var vehicle = new Vehicle;
vehicle.wheelCount;         // 4
</code></pre>

<p>The Vehicle instance picked up the <code>wheelCount</code> from <code>Vehicle</code>'s prototype</p>

<p>Now this "inheritance" is more than simply copying properties to the new objects. The object is set up to <em>delegate</em> any properties which haven't been explicitly set up to its constructor's prototype. That means that we can change the prototype later, and still see the changes in the instance.</p>

<pre><code>Vehicle.prototype.wheelCount = 6;
vehicle.wheelCount;         // 6
</code></pre>

<p>But if we like, we can always override it.</p>

<pre><code>vehicle.wheelCount = 8;
vehicle.wheelCount          // 8
(new Vehicle()).wheelCount  // 6;
</code></pre>

<p>We can do the same thing with methods. After all, a method is just a function assigned to a property. Check it.</p>

<pre><code>Vehicle.prototype.go = function go() { return "Vroom!" };
vehicle.go();                              // "Vroom!"
</code></pre>

<p><strong>4. It calls <code>Vehicle()</code> in the context of the new object.</strong></p>

<p>Finally, the constructor function itself is called. Inside the function, <code>this</code> is set to the object we're constructing. (Why? Because that's what Java does.) So,</p>

<pre><code>var Vehicle = function Vehicle(color) {
  this.constructor;       // function Vehicle()
  this.color = color;
}

(new Vehicle("tan")).color;   // "tan"
</code></pre>

<blockquote>
<p><em>Side note</em>: Above, I said the use of the <code>new</code> keyword returned the constructed object. This is correct <em>unless</em> the constructor returns something explicitly. Then <em>that</em> object is returned, and the constructed object is just dropped. But really. JavaScript slaves over a hot CPU to create this object for you and then you just throw it away? Rude. And confusing to people who use your constructor. So unless you have a really good reason, don't return anything from constructor functions.</p>
</blockquote>

<h2>Putting it all together</h2>

<p>Given this tool, here's one way (the intended way, but not the only way) to implement something like classes in JavaScript.</p>

<pre><code>// Class definition / constructor
var Vehicle = function Vehicle(color) {
  // Initialization
  this.color = color;
}

// Instance methods
Vehicle.prototype = {
  go: function go() {
    return "Vroom!";
  }
}
</code></pre>

<h2>"Subclassing"</h2>

<p>This "pseudoclassical" style doesn't have an exact way to make subclasses, but it comes close. We can set the prototype of our "subclass" to an instance of the "superclass".</p>

<pre><code>var Car = function Car() {};
Car.prototype = new Vehicle("tan");
Car.prototype.honk = function honk() { return "BEEP!" };
var car = new Car();
car.honk();             // "BEEP!"
car.go();               // "Vroom!"
car.color;              // "tan"
car instanceof Car;     // true
car instanceof Vehicle; // true
</code></pre>

<p>Now, there's a problem here. The <code>Vehicle</code> constructor only gets called once, to set up <code>Car</code>'s prototype. We need to give it a color there. We can't make different cars have different colors, which is not ideal. Some JavaScript frameworks have gotten around this by defining their own implementations of classes.</p>

<h2>And for my last trick…</h2>

<p>Sometimes you don't want a notion of classes. Sometimes you just want one object to inherit the properties of another (but be able to override them). This is how most prototype-based languages work, but not JavaScript. At least, not without a little massaging.</p>

<p>This function lets us accomplish it. It's been tossed around for a long time and is sometimes called "<code>create</code>" and sometimes "<code>clone</code>" and sometimes other things.</p>

<pre><code>function create(parent) {
  var F = function() {};
  F.prototype = parent;
  return new F();
}

var masterObject = {a: "masterObject value"}

var object1 = create(masterObject);
var object2 = create(masterObject);
var object3 = create(masterObject);
var object3.a = "overridden value";

object1.a; // "masterObject value"
object2.a; // "masterObject value"
object3.a; // "overridden value"

masterObject.a = "new masterObject value"

object1.a; // "new masterObject value"
object2.a; // "new masterObject value"
object3.a; // "overridden value"
</code></pre>

<h2>You said a mouthful.</h2>

<p>The JavaScript prototype chain is a little different than how most languages work, so it can be tricky understand. It doesn't make it any easier when JavaScript gets syntax that makes it looks more like other languages, like inheriting Java's <code>new</code> operator. But if you know what you're doing, you can do some crazy-cool things with it.</p>



            	        
	        <blockquote class="author">
    <h2>About the Author</h2>
        <p>Biography</p>
            <a class="author-bio-link btn hooked" data-internal="standard" href="https://content.pivotal.io/authors/pivotal-labs" target="_self">More Content by Pivotal Labs</a>
</blockquote>
	        
        </div>
					
					</div>
				</article>
				<!--================= END :: Tutorial =================-->
				
				<!--================= START :: Tutorial =================-->
				<article>
					<a id="t-73" name="t-73"></a><h1>73 : Understanding the prototype property in JavaScript</h1>
					<span class="ref-site">https://bytearcher.com/articles/understanding-prototype-property-in-javascript/</span>
					<div class="tutorial__content">
<div class="overflow-sanitizer"> <h1>Understanding the prototype property in JavaScript</h1> <p>You're having difficulty understanding the <code>prototype</code>
 property in JavaScript. You know it has got to do with object-oriented programming (OOP) and object inheritance, but you're not sure of the mechanics of how it works.</p> <h2 id="prototypal-inheritance">Prototypal inheritance</h2> <p>Object-oriented programming can be implemented in many ways. Other languages, such as Java, use class-based model where the language separates classes and instances of objects. In JavaScript there aren't any classes, but instead everything is an object. Inheritance in JavaScript is based on prototypal inheritance where objects inherit directly from other objects. An object contains reference to its ancestor in inheritance hierarchy - the <em>prototype</em> of the object.</p> <blockquote> <p>ES6 introduces the <code>class</code> keyword into the language. It does not, however, introduce a new model of object-oriented inheritance. The <code>class</code>
 keyword provides syntactic sugar for expressing prototype properties and constructor functions as described in this article.</p> </blockquote> <h2 id="javascript-features-that-make-inheritance-work">JavaScript features that make inheritance work</h2> <p>There are few language features that in concert make inheritance work.</p> <ul> <li><strong>Accessing a non-existent property from a JavaScript object causes the runtime to look for a match in the object's prototype.</strong> For example <code>car.toString()</code> results in using the <code>toString</code> method from the car object's prototype if <code>car</code> itself doesn't contain such method. The search continues recursively to the prototype of the prototype until a match is found or the chain is exhausted.</li> <li><strong>Calling <code>new Car()</code> creates a new object with prototype set to the value of <code>Car.prototype</code>.</strong> This allows setting up prototype chain for new objects. Note that 
<code>new Car()</code> only makes sense when <code>Car</code> is a function. Such function is also known as a <em>constructor function</em>.</li> <li><strong>Calling a function property of an object, the value of <code>this</code> is bound to the containing object.</strong> For example <code>"abc".toString()</code> calls the <code>toString</code> function with <code>this</code> value set to <code>"abc"</code>. This allows code reuse - executing the same code lines with different value of <code>this</code>. A function property of an object is also called a <em>method</em>.</li> </ul> <h2 id="an-example">An example</h2> <p>Let's create an example that calculates the perimeter of a rectangle with object-oriented programming.</p> 
<figure>
<pre><code>function Rectangle(x, y) {
    this.x = x;
    this.y = y;
}

Rectangle.prototype.perimeter = function() {
    return 2 * (this.x + this.y);
}

 var rect = new Rectangle(1, 2);
 console.log(rect.perimeter()); // outputs '6'</code></pre>
 </figure>
 <p>First a constructor function <code>Rectangle</code> is defined. The convention is to capitalize function names that are to be called with <code>new</code> to separate them from other functions. The constructor function is initially given an empty object as the value of <code>this</code> and the code populates it with <code>x</code> and <code>y</code> properties for later use.</p> <p>Then, a function property is added to <code>Rectangle.prototype</code> that calculates the perimeter using the object's <code>x</code> and <code>y</code> properties. Notice the use of <code>this</code> that allows the same code to work on multiple objects with different values for the variables.</p> <p>Finally, a new <code>Rectangle</code> object called <code>rect</code> is created. It inherits from <code>Rectangle.prototype</code> and allows us to call <code>rect.perimeter()</code>
 and print the results to the console.</p> <h2 id="misleading-prototype-property-name">Misleading prototype property name</h2> <p>There is something misleading in JavaScript regarding prototypes. The prototype of an object is not the same thing as the <code>prototype</code> property of the object. The former is used when looking up non-existent properties in the prototype chain. The latter is used for objects created using <code>new</code>, it will be the prototype of the newly created object. <strong>Understanding this difference allows you to fully understand the prototype property in JavaScript</strong>.</p> <p>In our example, <code>Rectangle.prototype</code> will be the the prototype value used for objects created with <code>new Rectangle()</code> and the prototype of <code>Rectangle</code> itself is actually JavaScript's internal <code>Function.prototype</code>.</p> <p>The value holding the prototype of an object is sometimes called <em>the internal prototype link</em>
. It's also been historically called <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/proto">__proto__</a>, a name that has some controversy. To be politically correct, it can be called the value that's returned from <code>Object.getPrototypeOf(...)</code>.</p>      </div>
					</div>
				</article>
				<!--================= END :: Tutorial =================-->
				
				<!--================= START :: Tutorial =================-->
				<article>
					<a id="t-74" name="t-74"></a><h1>74 : Prototypal Object-Oriented Programming using JavaScript</h1>
					<span class="ref-site">https://alistapart.com/article/prototypal-object-oriented-programming-using-javascript</span>
					<div class="tutorial__content">
<div class="main-content" itemprop="articleBody">

				<p>Douglas Crockford accurately described JavaScript as the world's most misunderstood language. A lot of programmers tend to think of it as not a "proper" language because it lacks the common object-oriented programming concepts. I myself developed the same opinion after my first JavaScript project ended up a hodgepodge, as I couldn't find a way to organize code into classes. But as we will see, JavaScript comes packed with a rich system of object-oriented programming that many programmers don't know about.</p>

			<p>Back in the time of the <a href="https://en.wikipedia.org/wiki/Browser_wars#First_browser_war">First Browser War</a>, executives at Netscape hired a smart guy called Brendan Eich to put together a language that would run in the browser. Unlike class-based languages like C++ and Java, this language, which was at some point called LiveScript, was designed to implement a prototype-based inheritance model. Prototypal OOP, which is conceptually different from the class-based systems, had been invented just a few years before to solve some problems that class-based OOP presented and it fit very well with LiveScript's dynamic nature.</p>

<p>Unfortunately, this new language had to "look like Java" for marketing reasons. Java was the cool new thing in the tech world and Netscape's executives wanted to market their shiny new language as "Java's little brother." This seems to be why its name was changed to JavaScript. The prototype-based OOP system, however, didn't look anything like Java's classes. To make this prototype-based system look like a class-based system, JavaScript's designers came up with the keyword <code>new</code> and a novel way to use constructor functions. The existence of this pattern and the ability to write "pseudo class-based" code has led to a lot of confusion among developers.</p>

<p>Understanding the rationale behind prototype-based programming was my "aha" moment with JavaScript and resolved most of the gripes I had with the language. I hope learning about prototype-based OOP brings you the same peace of mind it brought me. And I hope that exploring a technique that has not been fully explored excites you as much as it excites me.</p>

<h2 id="section1">Prototype-based OOP<a class="subhead-anchor" href="#section1">#section1</a></h2>

<p>Conceptually, in class-based OOP, we first create a class to serve as a "blueprint" for objects, and then create objects based on this blueprint. To build more specific types of objects, we create "child" classes; i.e., we make some changes to the blueprint and use the resulting new blueprint to construct the more specific objects.</p>

<p>For a real-world analogy, if you were to build a chair, you would first create a blueprint on paper and then manufacture chairs based on this blueprint. The blueprint here is the class, and chairs are the objects. If you wanted to build a rocking chair, you would take the blueprint, make some modifications, and manufacture rocking chairs using the new blueprint.</p>

<p>Now take this example into the world of prototypes: you don't create blueprints or classes here, you just create the object. You take some wood and hack together a chair. This chair, an actual object, can function fully as a chair and also serve as a prototype for future chairs. In the world of prototypes, you build a chair and simply create "clones" of it. If you want to build a rocking chair, all you have to do is pick a chair you've manufactured earlier, attach two rockers to it, and voilà! You have a rocking chair. You didn't really need a blueprint for that. Now you can just use this rocking chair for yourself, or perhaps use it as a prototype to create more rocking chairs.</p>

<h2 id="section2">JavaScript and prototype-based OOP<a class="subhead-anchor" href="#section2">#section2</a></h2>

<p>Following is an example that demonstrates this kind of OOP in JavaScript. We start by creating an <code>animal</code> object:</p>

<pre><code>var genericAnimal = Object.create(null);</code></pre>

<p><code>Object.create(null)</code> creates a new empty object. (We will discuss <code>Object.create()</code> in further detail later.) Next, we add some properties and functions to our new object:</p>

<pre><code>genericAnimal.name = 'Animal';
genericAnimal.gender = 'female';
genericAnimal.description = function() {
	return 'Gender: ' + this.gender + '; Name: ' + this.name;
};</code></pre>

<p><code>genericAnimal</code> is a proper object and can be used like one:</p>

<pre><code>console.log(genericAnimal.description());
//Gender: female; Name: Animal</code></pre>

<p>We can create other, more specific animals by using our sample object as a prototype. Think of this as cloning the object, just like we took a chair and created a clone in the real world.</p>

<pre><code>var cat = Object.create(genericAnimal);</code></pre><p> </p>

<p>We just created a cat as a clone of the generic animal. We can add properties and functions to this:</p>

<pre><code>cat.purr = function() {
	return 'Purrrr!';
};</code></pre>

<p>We can use our cat as a prototype and create a few more cats:</p>

<pre><code>var colonel = Object.create(cat);
colonel.name = 'Colonel Meow';

var puff = Object.create(cat);
puff.name = 'Puffy';</code></pre>

<p>You can also observe that properties/methods from parents were properly carried over:</p>

<pre><code>console.log(puff.description());
//Gender: female; Name: Puffy</code></pre>

<h2 id="section3">The <code>new</code> keyword and the constructor function<a class="subhead-anchor" href="#section3">#section3</a></h2>

<p>JavaScript has the concept of a <code>new</code> keyword used in conjunction with constructor functions. This feature was built into JavaScript to make it look familiar to people trained in class-based programming. You may have seen JavaScript OOP code that looks like this:</p>

<pre><code>function Person(name) {
	this.name = name;
	this.sayName = function() {
		return "Hi, I'm " + this.name;
	};
}
var adam = new Person('Adam');</code></pre>

<p>Implementing inheritance using JavaScript's default method looks more complicated. We define <code>Ninja</code> as a sub-class of <code>Person</code>. Ninjas can have a name as they are a person, and they can also have a primary weapon, such as shuriken.</p>

<pre><code>function Ninja(name, weapon) {
  Person.call(this, name);
  this.weapon = weapon;
}
Ninja.prototype = Object.create(Person.prototype);
Ninja.prototype.constructor = Ninja;</code></pre>

<p>While the constructor pattern might look more attractive to an eye that's familiar with class-based OOP, it is considered problematic by many. What's happening behind the scenes is prototypal OOP, and the constructor function obfuscates the language's natural implementation of OOP. This just looks like an odd way of doing class-based OOP without real classes, and leaves the programmer wondering why they didn't implement proper class-based OOP.</p>

<p>Since it's not really a class, it's important to understand what a call to a constructor does. It first creates an empty object, then sets the prototype of this object to the prototype property of the constructor, then calls the constructor function with <code>this</code> pointing to the newly-created object, and finally returns the object. It's an indirect way of doing prototype-based OOP that looks like class-based OOP.</p>

<p>The problem with JavaScript's constructor pattern is succinctly summed up by Douglas Crockford: </p>

<figure class="quote" id="figure1">
<blockquote><p>JavaScript's constructor pattern did not appeal to the classical crowd. It also obscured JavaScript's true prototypal nature. As a result, there are very few programmers who know how to use the language effectively.</p>
</blockquote>
</figure>

<p>The most effective way to work with OOP in JavaScript is to understand prototypal OOP, whether the constructor pattern is used or not.</p>

<h2 id="section4">Understanding delegation and the implementation of prototypes<a class="subhead-anchor" href="#section4">#section4</a></h2>

<p>So far, we've seen how prototypal OOP differs from traditional OOP in that there are no classes—only objects that can inherit from other objects.</p>

<p>Every object in JavaScript holds a reference to its parent (prototype) object. When an object is created through <code>Object.create</code>, the passed object—meant to be the prototype for the new object—is set as the new object's prototype. For the purpose of understanding, let's assume that this reference is called <code>__proto__</code><sup data-footnote=""><a id="ref1" href="#note1">1</a></sup>. Some examples from the previous code can illustrate this point:</p>

<p>The line below creates a new empty object with <code>__proto__</code> as null.</p>

<figure class="code" id="figure2"><pre><code>var genericAnimal = Object.create(null); </code></pre></figure>

<p>The code below then creates a new empty object with <code>__proto__</code> set to the <code>genericAnimal</code> object, i.e. <code>rodent.__proto__</code> points to <code>genericAnimal</code>.</p><figure class="code" id="figure3"><pre><code>var rodent = Object.create(genericAnimal);
 rodent.size = 'S';</code></pre>
</figure><p> </p>

<p>The following line will create an empty object with <code>__proto__</code> pointing to rodent.</p>

<figure class="code" id="figure4">
<pre><code>var capybara = Object.create(rodent);
//capybara.__proto__ points to rodent
//capybara.__proto__.__proto__ points to genericAnimal
//capybara.__proto__.__proto__.__proto__ is null</code></pre></figure>

<p>As we can see, every object holds a reference to its prototype. Looking at <code>Object.create</code> without knowing what exactly it does, it might look like the function actually "clones" from the parent object, and that properties of the parent are copied over to the child, but this is not true. When <code>capybara</code> is created from <code>rodent</code>, <code>capybara</code> is an empty object with only a reference to <code>rodent</code>.</p>

<p>But then—if we were to call <code>capybara.size</code> right after creation, we would get <code>S</code>, which was the size we had set in the parent object. What blood-magic is that? <code>capybara</code> doesn't have a size property yet. But still, when we write <code>capybara.size</code>, we somehow manage to see the prototype's size property.</p>

<p>The answer is in JavaScript's method of implementing inheritance: delegation. When we call <code>capybara.size</code>, JavaScript first looks for that property in the <code>capybara</code> object. If not found, it looks for the property in <code>capybara.__proto__</code>. If it didn't find it in <code>capybara.__proto__</code>, it would look in <code>capybara.__proto__.__proto__</code>. This is known as the prototype chain.</p>

<p>If we called <code>capybara.description()</code>, the JavaScript engine would start searching up the prototype chain for the <code>description</code> function and finally discover it in <code>capybara.__proto__.__proto__</code> as it was defined in <code>genericAnimal</code>. The function would then be called with <code>this</code> pointing to <code>capybara</code>.</p>

<p>Setting a property is a little different. When we set <code><a href="https://youtu.be/BOv5ZjAOpC8">capybara.size = 'XXL'</a></code>, a new property called <code>size</code> is created in the <code>capybara</code> object. Next time we try to access <code>capybara.size</code>, we find it directly in the object, set to <code>'XXL'</code>.</p>

<p>Since the prototype property is a reference, changing the prototype object's properties at runtime will affect all objects using the prototype. For example, if we rewrote the <code>description</code> function or added a new function in <code>genericAnimal</code> after creating <code>rodent</code> and <code>capybara</code>, they would be immediately available for use in <code>rodent</code> and <code>capybara</code>, thanks to delegation.</p>

<h2 id="section5">Creating <code>Object.create</code><a class="subhead-anchor" href="#section5">#section5</a></h2>

<p>When JavaScript was developed, its default way of creating objects was the keyword <code>new</code>. Then many notable JavaScript developers campaigned for <code>Object.create</code>, and eventually it was included in the standard. However, <em>some</em> browsers don't support <code>Object.create</code> (you know the one I mean). For that reason, Douglas Crockford recommends including the following code in your JavaScript applications to ensure that <code>Object.create</code> is created if it is not there:</p>

<pre><code>if (typeof Object.create !== 'function') {
	Object.create = function (o) {
		function F() {}
		F.prototype = o;
		return new F();
	};
}</code></pre>

<h2 id="section6"><code>Object.create</code> in action<a class="subhead-anchor" href="#section6">#section6</a></h2>

<p>If you wanted to extend JavaScript's <code>Math</code> object, how would you do it? Suppose that we would like to redefine the random function without modifying the original <code>Math</code> object, as other scripts might be using it. JavaScript's flexibility provides many options. But I find using <code>Object.create</code> a breeze:</p>

<pre><code>var myMath = Object.create(Math);</code></pre>

<p>Couldn't possibly get any simpler than that. You could, if you prefer, write a new constructor, set its prototype to a clone of <code>Math</code>, augment the prototype with the functions you like, and then construct the actual object. But why go through all that pain to make it look like a class, when prototypes are so simple?</p>

<p>We can now redefine the <code>random</code> function in our <code>myMath</code> object. In this case, I wrote a function that returns random whole numbers within a range if the user specifies one. Otherwise, it just calls the parent's <code>random</code> function.</p>

<pre><code>myMath.random = function() {
	var uber = Object.getPrototypeOf(this);
if (typeof(arguments[0]) === 'number' &amp;&amp; typeof(arguments[1]) === 'number' &amp;&amp; arguments[0] &lt; arguments[1]) {
		var rand = uber.random();
		var min = Math.floor(arguments[0]);
		var max = Math.ceil(arguments[1]);
		return this.round(rand * (max - min)) + min;
	}
	return uber.random();
};</code></pre>

<p>There! Now <code>myMath.random(-5,5)</code> gets you a random whole number between −5 and 5, while <code>myMath.random()</code> gets the usual. And since <code>myMath</code> has <code>Math</code> as its prototype, it has all the functionality of the <code>Math</code> object built into it.</p>

<h2 id="section7">Class-based OOP vs. prototype-based OOP<a class="subhead-anchor" href="#section7">#section7</a></h2>

<p>Prototype-based OOP and class-based OOP are both great ways of doing OOP; both approaches have pros and cons. Both have been researched and debated in the academic world since before I was born. Is one better than the other? There is no consensus on that. But the key points everyone can agree on are that prototypal OOP is simpler to understand, more flexible, and more dynamic.</p>

<p>To get a glimpse of its dynamic nature, take the following example: you write code that extensively uses the <code>indexOf</code> function in arrays. After writing it all down and testing in a good browser, you grudgingly test it out in Internet Explorer 8. As expected, you face problems. This time it's because <code>indexOf</code> is not defined in IE8.</p>

<p>So what do you do? In the class-based world, you could solve this by defining the function, perhaps in another "helper" class which takes an array or List or ArrayList or whatever as input, and replacing all the calls in your code. Or perhaps you could sub-class the List or ArrayList and define the function in the sub-class, and use your new sub-class instead of the ArrayList.</p>

<p>But JavaScript and prototype-based OOP's dynamic nature makes it simple. Every array is an object and points to a parent prototype object. If we can define the function in the prototype, then our code will work as is without any modification!</p>

<pre><code>if (!Array.prototype.indexOf) {
	Array.prototype.indexOf = function(elem) {
		//Your magical fix code goes here.
};
}</code></pre>

<p>You can do many cool things once you ditch classes and objects for JavaScript's prototypes and dynamic objects. You can extend existing prototypes to add new functionality—extending prototypes like we did above is how the well known and aptly named library Prototype.js adds its magic to JavaScript's built-in objects. You can create all sorts of interesting inheritance schemes, such as one that inherits selectively from multiple objects. Its dynamic nature means you don't even run into the problems with inheritance that the <a href="https://en.wikipedia.org/wiki/Design_Patterns">Gang of Four book</a> famously warns about. (In fact, solving these problems with inheritance was what prompted researchers to invent prototype-based OOP—but all that is beyond our scope for this article.)</p>

<h2 id="section8">Class-based OOP emulation can go wrong<a class="subhead-anchor" href="#section8">#section8</a></h2>

<p>Consider the following very simple example written with pseudo-classes:</p>

<pre><code>function Animal(){
    this.offspring=[];
}

Animal.prototype.makeBaby = function(){ 
    var baby = new Animal();
    this.offspring.push(baby);
    return baby;
};

//create Cat as a sub-class of Animal
function Cat() {
}

//Inherit from Animal
Cat.prototype = new Animal();

var puff = new Cat();
puff.makeBaby();
var colonel = new Cat();
colonel.makeBaby();</code></pre>

<p>The example looks innocent enough. This is an inheritance pattern that you will see in many places all over the internet. However, something funny is going on here—if you check <code>colonel.offspring</code> and <code>puff.offspring</code>, you will notice that each of them contains the same two babies! That's probably not what you intended—unless you are coding a quantum physics thought experiment.</p>

<p>JavaScript tried to make our lives easier by making it look like we have good old class-based OOP going on. But it turns out it's not that simple. Simulating class-based OOP without completely understanding prototype-based OOP can lead to unexpected results. To understand why this problem occurred, you must understand prototypes and how constructors are just one way to build objects from other objects.</p>

<p>What happened in the above code is very clear if you think in terms of prototypes. The variable <var>offspring</var> is created when the <code>Animal</code> constructor is called—and it is created in the <code>Cat.prototype</code> object. All individual objects created with the <code>Cat</code> constructor use <code>Cat.prototype</code> as their prototype, and <code>Cat.prototype</code> is where <var>offspring</var> resides. When we call <code>makeBaby</code>, the JavaScript engine searches for the <code>offspring</code> property in the <code>Cat</code> object and fails to find it. It then finds the property in <code>Cat.prototype</code>—and adds the new baby in the shared object that both individual <code>Cat</code> objects inherit from.</p>

<p>So now that we understand what the problem is, thanks to our knowledge of the prototype-based system, how do we solve it? The solution is that the <code>offspring</code> property needs to be created in the object itself rather than somewhere in the prototype chain. There are many ways to solve it. One way is that <code>makeBaby</code> ensures that the object on which the function is called has its own <code>offspring</code> property:</p>

<pre><code>Animal.prototype.makeBaby=function(){
	var baby=new Animal(); 
	if(!this.hasOwnProperty('offspring')){
		this.offspring=[]; }
	this.offspring.push(baby); 
	return baby;
};
</code></pre>

<p>Backbone.js runs into a similar trap. In Backbone.js, you build views by extending the base <code>Backbone.View</code> "class." You then instantiate views using the constructor pattern. This model is very good at emulating class-based OOP in JavaScript:</p>

<pre><code>//Create a HideableView "sub-class" of Backbone.View
var HideableView = Backbone.View.extend({
    el: '#hideable', //the view will bind to this selector
    events : {
        'click .hide': 'hide'
    },
    //this function was referenced in the click handler above
    hide: function() {
      //hide the entire view
    	$(this.el).hide();
    }
});

var hideable = new HideableView();</code></pre>

<p>This looks like simple class-based OOP. We inherited from the base <code>Backbone.View</code> class to create a <code>HideableView</code> child class. Next, we created an object of type <code>HideableView</code>.</p>

<p>Since this looks like simple class-based OOP, we can use this functionality to conveniently build inheritance hierarchies, as shown in the following example:</p>

<pre><code>var HideableTableView = HideableView.extend({
    //Some view that is hideable and rendered as a table.
});

var HideableExpandableView = HideableView.extend({
    initialize: function() {
        //add an expand click handler. We didn't create a separate
        //events object because we need to add to the
        //inherited events.
        this.events['click .expand'] = 'expand';
    },
    expand: function () {
    	//handle expand
    }
});

var table = new HideableTableView();
var expandable = new HideableExpandableView();</code></pre>

<p>This all looks good while you're thinking in class-based OOP. But if you try <code>table.events['click .expand']</code> in the console, you will see "expand"! Somehow, <code>HideableTableView</code> has an <code>expand</code> click handler, even though it was never defined in this class. </p>

<p>You can see the problem in action here: <a href="http://codepen.io/anon/pen/qbYJeZ">http://codepen.io/anon/pen/qbYJeZ</a></p>

<p>The problem above occurred because of the same reason outlined in the earlier example. In Backbone.js, you need to work against the indirection created by trying to make it look like classes, to see the prototype chain hidden in the background. Once you comprehend how the prototype chain would be structured, you will be able to find a simple fix for the problem.</p>

<h2 id="section9">In conclusion<a class="subhead-anchor" href="#section9">#section9</a></h2>

<p>Despite prototypal OOP underpinning one of the most popular languages out there today, programmers are largely unfamiliar with what exactly prototype-based OOP is. JavaScript itself may be partly to blame because of its attempts to masquerade as a class-based language. </p>

<p>This needs to change. To work effectively with JavaScript, developers need to understand the how and why of prototype-based programming—and there's much more to it than this article. Beyond mastering JavaScript, in learning about prototype-based programming you can also learn a lot of things about class-based programming as you get to compare and contrast the two different methods.</p>

<h2 id="section10">Further Reading<a class="subhead-anchor" href="#section10">#section10</a></h2>

<p>Douglas Crockford's <a href="http://javascript.crockford.com/prototypal.html">note on protoypal programming</a> was written before <code>Object.create</code> was added to the standard.</p>

<p><a href="http://www.ibm.com/developerworks/library/wa-protoop/">An article on IBM's developerWorks</a> reinforces the same point on prototypal OOP. This article was the prototypal "aha" moment for me.</p>

<p>The following three texts will be interesting reads if you're willing to dive into the academic roots of prototype-based programming:</p>

<p>Henry Lieberman of MIT Media Labs <a href="http://web.media.mit.edu/~lieber/Lieberary/OOP/Delegation/Delegation.html">compares class-based inheritance with prototype-based delegation</a> and argues that prototype-based delegation is the more flexible of the two concepts.</p>

<p><cite><a href="ftp://ftp.cs.washington.edu/pub/constraints/papers/fjcc-86.pdf" type="PDF">Classes versus Prototypes in Object-Oriented Languages</a></cite> is a proposal to use prototypes instead of classes by the University of Washington's Alan Borning.</p>

<p>Lieberman's and Borning's work in the 1980s appears to have influenced the work that David Ungar and Randall Smith did to create the first prototype-based programming language: Self. Self went on to become the basis for the prototype-based system in JavaScript. <a href="http://bibliography.selflanguage.org/_static/self-power.pdf" type="PDF">This paper describes their language</a> and how it omits classes in favor of prototypes.</p>


				
				<section class="entry-footnotes">

					<h1>Notes</h1>

					<ul class="the-footnotes">
						
						<li id="note1"><a class="count" href="#ref1">1. </a>The __proto__ property is used by some browsers to expose an object's prototype, but it is not standard and is considered obsolete. Use <code>Object.getPrototypeOf()</code> as a standards-compliant way of obtaining an object's prototype in modern browsers.</li>
						
					</ul>

				</section>
			</div>
					</div>
				</article>
				<!--================= END :: Tutorial =================-->
				
				<!--================= START :: Tutorial =================-->
				<article>
					<a id="t-75" name="t-75"></a><h1>75 : A Deeper Look at Objects in JavaScript</h1>
					<span class="ref-site">https://www.kirupa.com/html5/a_deeper_look_at_objects_in_javascript.htm</span>
					<div class="tutorial__content">
<div id="mainContent">


		<p>In the
		<a class="blueEmphasis" href="//www.kirupa.com/html5/introduction_to_objects_in_javascript.htm">
		Introduction to Objects in JavaScript</a> tutorial, I provided a very 
		high level overview of what objects in JavaScript are and how to think 
		about them. In this tutorial, we will make that tutorial seem like the tip of a ginormous 
		iceberg:</p>
		<p class="centerImageNoBorder">
		<img alt="you haven't seen anything yet" height="398" src="https://www.kirupa.com/images/iceberg_72.png" width="558"></p>
		<p class="centerImageNoBorder">&nbsp;
		</p>
		<p>What we are going to do here is have a re-look at objects in greater 
		detail and touch on the more advanced topics such as using the
		<span class="inlineCode">Object</span> object, creating your own custom 
		objects, inheritance, prototypes, and the <span class="inlineCode">this</span> 
		keyword. If all that I've listed so far makes no sense, it will after 
		you've reached the end of this tutorial...I hope.</p>
		<p>Onwards!</p>

		<h2>Meet the Object</h2>
		<p>At the very bottom of the food chain, you have the
		<span class="inlineCode">Object</span> type that lays the 
		groundwork for both custom objects as well as built-in types like
		<span class="inlineCode">Function</span>, <span class="inlineCode">Array</span>, 
		and <span class="inlineCode">RegExp</span>. Pretty much everything 
		except <span class="inlineCode">null</span> and <span class="inlineCode">
		undefined</span> are directly related to an <span class="inlineCode">
		Object</span> or can become one as needed.</p>
		<p>As you saw from the introduction, the functionality the
		<span class="inlineCode">Object</span> brings to the table is pretty 
		minimal. It allows you to specify a bunch of named key and value pairs 
		that we lovingly call <strong>properties</strong>. This isn't all that 
		different from what you see in other languages with data structures like hashtables, 
		associate arrays, and dictionaries.</p>
		<p>Anyway, all of this is pretty boring. Let's get to some of the more 
		exciting stuff!</p>
		<h3>Creating Objects</h3>
		<p>The way all the cool kids are creating objects these days is by using the funny-looking 
		(yet 
		compact) <strong>object initializer</strong> syntax:</p>
		<div><pre><code>var funnyGuy = {};
</code></pre></div>
		<p>That's right. Instead of typing in "<span class="inlineCode">new 
		Object()</span>" like you may have seen in old-timey books, you can just initialize your object by saying "<span class="inlineCode">{}</span>". 
		At the end of this line getting executed, you will have created an 
		object called <span class="inlineCode">funnyGuy</span> whose type is
		<span class="inlineCode">Object</span>. If all of this makes sense so 
		far, great!</p>
		<p>This <span class="inlineCode">funnyGuy</span> object isn't as simple 
		as it looks. Let's dive a little bit deeper and visualize what exactly 
		is going on. On the surface, you just have the <span class="inlineCode">
		funnyGuy</span> object:</p>
		<p class="centerImageNoBorder">
		<img alt="what a funny little, round guy" height="259" src="https://www.kirupa.com/html5/images/funnyGuy_1_72.png" width="306"></p>
		<p>If you back up and look more broadly at the funnyGuy object, you'll 
		realize that it isn't alone here. Because it is an object, is has a 
		connection to the main <span class="inlineCode">Object</span> type that it derives from:</p>
		<p class="centerImageNoBorder">
		<img alt="meet the object" height="175" src="https://www.kirupa.com/html5/images/funnyGuy_2_72.png" width="545"></p>
		<p>What this connection means is pretty significant. Let's add some more 
		detail to what we have provided so far:</p>
		
		<p class="centerImageNoBorder">
		<img alt="funnyGuy Objectified!" height="217" src="https://www.kirupa.com/html5/images/funnyGuy_Object_72.png" width="501"></p>
		<p class="centerImageNoBorder">&nbsp;</p>
		<p>The <span class="inlineCode">funnyGuy</span> object has no properties 
		defined. That makes sense given what we specified in code (and can see 
		in the diagram above):</p>
		<div><pre><code>var funnyGuy = {};
</code></pre></div>
		<p>Our <span class="inlineCode">funnyGuy</span> is simply an empty object. While there may not be any 
		properties <strong>we defined</strong> on it, there is a 
		special internal property that exists called <span class="inlineCode">
		__proto__</span> and often represented as <span class="inlineCode">
		[[Prototype]]</span> that points to our <span class="inlineCode">Object</span>. 
		If your mind just melted for a second, let me slow down and explain what 
		is going on here.</p>
		<p>What the <span class="inlineCode">[[Prototype]]</span> property 
		references is what is known as a <strong>prototype object</strong>:</p>
		<p class="centerImageNoBorder">
		<img alt="meet the prototype" height="277" src="https://www.kirupa.com/html5/images/funnyGuy_Object_prototype_72.png" width="501"></p>
		
		<p>A prototype object is the source that another object is based on. In 
		our case, the <span class="inlineCode">funnyGuy</span> object is created 
		in the likeness of our <span class="inlineCode">Object</span> type. What 
		this means is best highlighted by looking at an example. We know that
		<span class="inlineCode">funnyGuy</span> contains no properties of its 
		own. Because it is "derived" from our <span class="inlineCode">Object</span> 
		type, you can access any properties the <span class="inlineCode">Object</span> contains through
		<span class="inlineCode">funnyGuy</span> itself.</p>
		<p>For example, I can do something like this:</p>
		<div><pre><code>var funnyGuy = {};
funnyGuy.toString();&nbsp; // [object Object]
</code></pre></div>
		<p>I am calling the <span class="inlineCode">toString()</span> method on 
		our <span class="inlineCode">funnyGuy</span> object. Despite
		<span class="inlineCode">funnyGuy</span> not having any property called
		<span class="inlineCode">toString</span> on it, what gets returned isn't 
		an error or <span class="inlineCode">undefined</span>. You actually see the results of the
		<span class="inlineCode">toString()</span> method having acted on our
		<span class="inlineCode">funnyGuy</span> object.</p>
		<p>Think about this in a different way. Your <span class="inlineCode">
		funnyGuy</span> object is like a little kid. It doesn't have any money 
		of its own to buy big and expensive things. What the
		<span class="inlineCode">funnyGuy</span> object/kid does have is a 
		parent with a credit card. Having access to this credit card allows the 
		kid to go and buy things that he/she wouldn't otherwise be able to do. 
		The <span class="inlineCode">funnyGuy</span> / <span class="inlineCode">
		Object</span> relationship is very much like a child / parent 
		relationship where if the child doesn't have something, he / she can 
		check with a parent next.</p>
		<p>Getting back to our example and looking at it all one more time, what happened is this. 
		Let's act this out.</p>
		<div class="callout">
			<p>&nbsp;Our JavaScript engine was like,
		<span class="blueEmphasis">Hey, funnyGuy! I'm going to call toString() 
		on you.</span></p>
			<p>The <span class="inlineCode">funnyGuy</span> object replied with 
			a, <span class="greenEmphasis">Yo...dawg. I don't know what you are 
		talking about.</span></p>
			<p>The JavaScript engine then said,
		<span class="blueEmphasis">Well, I'm going to check your prototype 
		object and see if it contains a property called toString().</span></p>
			<p>A 
		few milliseconds later, after finding the prototype object thanks to the
		<span class="inlineCode">[[Prototype]]</span> property, our JavaScript 
		engine says, <span class="blueEmphasis">Object, my old chum! Do you 
		have a toString() property?</span></p>
			<p>The <span class="inlineCode">Object</span> 
		quickly replies with a <span class="redEmphasis">Yep.</span> and 
		calls the <span class="inlineCode">toString</span> method.</p>
		</div>
		<p>This entire (very dramatic) interaction is part of what is known as a <strong>
		prototype chain</strong>. If an object doesn't have what you are looking 
		for, the JavaScript engine will navigate to the next object as determined by 
		the <span class="inlineCode">[[Prototype]]</span> property and keep 
		going until it reaches the very end. The very end is when you try to 
		access the <span class="inlineCode">[[Prototype]]</span> property on the
		<span class="inlineCode">Object</span> itself. You can't go any further 
		beyond <span class="inlineCode">Object</span>, since that is as basic of 
		a type as you can get. I highlight this in the diagrams by having your
		<span class="inlineCode">Object</span>'s <span class="inlineCode">
		[[Prototype]]</span> refer to <strong>null</strong>.</p>
		<p>If you've ever heard of the term <strong>inheritance</strong> as it 
		applies to programming before, what you've just seen is a simple example 
		of it!</p>
		<h3>Specifying Properties</h3>
		<p>I bet you didn't imagine that a single line of JavaScript would 
		result in that much explanation, did you? Well, the nice thing is, I 
		front loaded a lot of conceptual data on you. Hopefully that makes 
		everything else that you see from here on out make a lot more sense.</p>
		<p>Right now, we still just have an empty object:</p>
		<div><pre><code>var funnyGuy = {};
</code></pre></div>
		<p>Let's specify some properties on it called <span class="inlineCode">
		firstName</span> and <span class="inlineCode">lastName</span>. As with 
		all things in JavaScript, you have multiple ways of defining properties 
		on an element. The way you've seen so far is by using the dot notation:</p>
		<div><pre><code>var funnyGuy = {};
funnyGuy.firstName = "Conan";
funnyGuy.lastName = "O'Brien";
</code></pre></div>
		<p>Another approach involves using the square bracket syntax:</p>
		<div><pre><code>var funnyGuy = {};
funnyGuy["firstName"] = "Conan";
funnyGuy["lastName"] = "O'Brien";
</code></pre></div>
		<p>The final approach is by extending our object initializer syntax with 
		the <strong>literal notation</strong> for declaring properties:</p>
		<div><pre><code>var funnyGuy = {
&nbsp;&nbsp;&nbsp;&nbsp;firstName: "Conan",
&nbsp;&nbsp;&nbsp;&nbsp;lastName: "O'Brien"
};
</code></pre></div>
		<p>There is no right or wrong approach in how you want to specify 
		properties, so be aware of all three variants and go with one that works 
		best for the situation you find yourself in. In general, I use...</p>
		<ol>
			<li>The literal notation when I am specifying properties 
			directly with a value.</li>
			<li>The dot notation if I am specifying a property whose values are 
			provided as part of an argument or expression.</li>
			<li>The square bracket notation if the property name itself is 
			something that is part of an argument or expression.</li>
		</ol>
		<p>Regardless of which of the three approaches you used for specifying 
		your properties, the end result is that your <span class="inlineCode">
		funnyGuy</span> object will have these properties (and values) defined 
		on itself:</p>
		<p class="centerImageNoBorder">
		<img alt="and now we have properties" height="217" src="https://www.kirupa.com/html5/images/funnyGuy_Object_plus_properties_72.png" width="501"></p>
		
		<p>All of this should be straightforward. Let's just do one more thing 
		before we move on bigger and greener pastures. Let's create a method called 
		<strong>getName</strong> on <span class="inlineCode">funnyGuy</span> that will return the value of the
		<span class="inlineCode">firstName</span> and <span class="inlineCode">
		lastName</span> properties. I will just show what this looks like using 
		the literal notation, for it is easy in the other approaches:</p>
		<div><pre><code>var funnyGuy = {
&nbsp;&nbsp;&nbsp;&nbsp;firstName: "Conan",
&nbsp;&nbsp;&nbsp;&nbsp;lastName: "O'Brien",
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;getName: function() {
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return "Name is: " + this.firstName + " " + this.lastName;
&nbsp;&nbsp;&nbsp;&nbsp;}
};
</code></pre></div>
		<p>Our <span class="inlineCode">getName</span> property's value is a 
		function whose body simply returns a string that includes the value of 
		our <span class="inlineCode">firstName</span> and
		<span class="inlineCode">lastName</span> properties. To call the 
		<span class="inlineCode">getName</span> 
		property, ahem...method, this is all you have to do:</p>
		<div><pre><code>var funnyGuy = {
&nbsp;&nbsp;&nbsp;&nbsp;firstName: "Conan",
&nbsp;&nbsp;&nbsp;&nbsp;lastName: "O'Brien",
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;getName: function() {
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return "Name is: " + this.firstName + " " + this.lastName;
&nbsp;&nbsp;&nbsp;&nbsp;}
};
&nbsp;
alert(funnyGuy.getName()); // displays "Name is Conan O'Brien"
</code></pre></div>
		<p>Yep, that's all there is to declaring an object and setting 
		properties on it. Indirectly, you learned a whole lot about what 
		goes on behind the scenes when a simple object is created. You'll need 
		all of this fancy learnin' in the next section when we kick everything 
		up a few notches.</p>
		<h2>Creating Custom Objects</h2>
		<p>Working with the generic <span class="inlineCode">Object</span> and 
		putting properties on it serves a useful purpose, but its awesomeness 
		fades away really quickly when you are creating many objects that are 
		basically the same thing:</p>
		<div><pre><code>var funnyGuy = {
&nbsp;&nbsp;&nbsp;&nbsp;firstName: "Conan",
&nbsp;&nbsp;&nbsp;&nbsp;lastName: "O'Brien",
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;getName: function () {
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return "Name is: " + this.firstName + " " + this.lastName;
&nbsp;&nbsp;&nbsp;&nbsp;}
};
&nbsp;
var theDude = {
&nbsp;&nbsp;&nbsp;&nbsp;firstName: "Jeffrey",
&nbsp;&nbsp;&nbsp;&nbsp;lastName: "Lebowski",
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;getName: function () {
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return "Name is: " + this.firstName + " " + this.lastName;
&nbsp;&nbsp;&nbsp;&nbsp;}
};
&nbsp;
var detective = {
&nbsp;&nbsp;&nbsp;&nbsp;firstName: "Adrian",
&nbsp;&nbsp;&nbsp;&nbsp;lastName: "Monk",
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;getName: function () {
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return "Name is: " + this.firstName + " " + this.lastName;
&nbsp;&nbsp;&nbsp;&nbsp;}
};
</code></pre></div>
		<p>Currently, if we had to visualize what he have right now, this is 
		what you will see:</p>
		<p class="centerImageNoBorder">
		<img alt="what your new object looks like" height="542" src="https://www.kirupa.com/html5/images/newObject_properties_72.png" width="501"></p>
		<p>There is a lot of duplicated stuff here that is, frankly, 
		unnecessary. Let's fix that using what we've learned about inheritance 
		and the prototype chain.</p>
		<p>What we want to do is create an intermediate <strong>parent</strong> 
		object that contains the properties that are more generic and not 
		necessary to be on the <strong>child</strong> object itself. From what 
		we have here, the <span class="inlineCode">firstName</span> and
		<span class="inlineCode">lastName</span> properties are going to be 
		unique for each object we create. Because of that, these two properties still belong on 
		the <span class="inlineCode">funnyGuy</span>, <span class="inlineCode">
		theDude</span>, and <span class="inlineCode">detective</span> objects.</p>
		<p>Our <span class="inlineCode">getName</span> property, though, does 
		not have to be duplicated for each object. This is something we can 
		parcel off into a parent object that 
		the rest of the objects can inherit from. Let's call this object
		<span class="inlineCode">person</span>:</p>
		<p class="centerImageNoBorder">
		<img alt="and the person appears" height="519" src="https://www.kirupa.com/html5/images/newObject_properties_person_72.png" width="685"></p>
		<p class="centerImageNoBorder">&nbsp;</p>
		<p>Visually, this makes sense. How do we end up creating something like 
		this?</p>
		<p>Well, thinking out loud, we need to create our <span class="inlineCode">funnyGuy</span>,
		<span class="inlineCode">theDude</span>, and <span class="inlineCode">
		detective</span> objects and ensure the <span class="inlineCode">
		firstName</span> and <span class="inlineCode">lastName</span> properties 
		are defined on them. That's easy. Of course, if this is all we did, this wouldn't be adequate. 
		The prototype for these objects will be <span class="inlineCode">Object</span>, and we don't want that. 
		We want the <span class="inlineCode">person</span> object with the <span class="inlineCode">getName</span> 
		property to be a part of our prototype chain as the immediate parent. The way we do that is by 
		ensuring the <span class="inlineCode">[[Prototype]]</span> property on
		<span class="inlineCode">funnyGuy</span>, <span class="inlineCode">
		theDude</span>, and <span class="inlineCode">detective</span> references
		<span class="inlineCode">person</span>.</p>
		<p>In order to do this, we use the extremely awesome
		<span class="inlineCode">Object.create</span> method. Let me quickly 
		explain what it does before we see it in action. The
		<span class="inlineCode">Object.create</span> method, as its name 
		implies, creates a new object. As part of creating the object, it allows 
		you to specify what your newly created object's prototype will be. 
		Strange how what we are wanting to do and what <span class="inlineCode">
		Object.create</span> provides are identical! :P</p>
		<p>Let's use <span class="inlineCode">Object.create</span> and the rest 
		of the code that brings the diagram and the explanation you've seen to 
		life:</p>
		<div><pre><code>var person = {
&nbsp;&nbsp;&nbsp;&nbsp;getName: function () {
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return "The name is " + this.firstName + " " + this.lastName;
&nbsp;&nbsp;&nbsp;&nbsp;}
};
&nbsp;
var funnyGuy = Object.create(person);
funnyGuy.firstName = "Conan";
funnyGuy.lastName = "O'Brien";
&nbsp;
var theDude = Object.create(person,
&nbsp;&nbsp;&nbsp;&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;firstName:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;value: "Jeffrey"
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;},
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lastName:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;value: "Lebowski"
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;&nbsp;&nbsp;});
&nbsp;
var detective = Object.create(person,
&nbsp;&nbsp;&nbsp;&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;firstName: { value: "Adrian" },
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lastName: { value: "Monk" }
&nbsp;&nbsp;&nbsp;&nbsp;});
</code></pre></div>
		<p>Let's look at all of this code in greater detail. First, we have our
		<span class="inlineCode">person</span> object:</p>
		<div><pre><code>var person = {
&nbsp;&nbsp;&nbsp;&nbsp;getName: function () {
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return "The name is " + this.firstName + " " + this.lastName;
&nbsp;&nbsp;&nbsp;&nbsp;}
};
</code></pre></div>
		<p>There is nothing special going on here. We create a new
		<span class="inlineCode">person</span> object whose type is
		<span class="inlineCode">Object</span>. It's <span class="inlineCode">
		[[Prototype]]</span> property will point you to the
		<span class="inlineCode">Object</span> type. It contains a method called
		<span class="inlineCode">getName</span> that returns some string 
		involving <span class="inlineCode">this.firstName</span> and
		<span class="inlineCode">this.lastName</span>. We'll come back to the
		<span class="inlineCode">this</span> keyword shortly and how this works, so keep that one 
		under your hat for now.</p>
		<p>After creating our person object, this is what our world looks like 
		right now:</p>
		<p class="centerImageNoBorder">
		<img alt="just the person and the object" height="287" src="https://www.kirupa.com/html5/images/person_object_72.png" width="422"></p>
		
		<p>In the next line, we declare our <span class="inlineCode">funnyGuy</span> 
		variable and initialize it to the object that gets returned by
		<span class="inlineCode">Object.create</span>:</p>
		<div><pre><code>var funnyGuy = Object.create(person);
</code></pre></div>
		<p>Notice that I pass in the <span class="inlineCode">person</span> 
		object as an argument to <span class="inlineCode">Object.create</span>. 
		Like I mentioned earlier, what this means is you create a new object 
		with the <span class="inlineCode">[[Prototype]]</span> value pointing to 
		our <span class="inlineCode">person</span> object. This is how things 
		look now:</p>
		<p class="centerImageNoBorder">
		<img alt="just a funnyGuy and a person" height="287" src="https://www.kirupa.com/html5/images/funnyGuy_person_noproperties_72.png" width="685"></p>
		<p>We created our <span class="inlineCode">funnyGuy</span> object with 
		the <span class="inlineCode">person</span> object set as its prototype 
		object. In the next two lines in our code, I define the <span class="inlineCode">
		firstName</span> and <span class="inlineCode">lastName</span> properties 
		on the object:</p>
		<div><pre><code>var funnyGuy = Object.create(person);
funnyGuy.firstName = "Conan";
funnyGuy.lastName = "O'Brien";
</code></pre></div>
		<p>This is your standard, run-of-the-mill property declaration on an 
		object using a name and value. What happens should be of no surprise to 
		you:</p>
		<p>
		<img alt="what our funnyGuy property looks like" height="305" src="https://www.kirupa.com/html5/images/funnyGuy_person_bothproperties_72.png" width="685"></p>
		
		<p>We just created our <span class="inlineCode">funnyGuy</span> object 
		and set the <span class="inlineCode">firstName</span> and
		<span class="inlineCode">lastName</span> properties on it. We just have 
		our <span class="inlineCode">theDude</span> and <span class="inlineCode">
		detective</span> objects left. For these two remaining objects, I use 
		the <span class="inlineCode">Object.create</span> method's second 
		argument to pass in default values to set on our object. Let's take a 
		look.</p>
		<p>Our <span class="inlineCode">theDude</span> object is defined by the 
		following chunk of code:</p>
		<div><pre><code>var theDude = Object.create(person,
&nbsp;&nbsp;&nbsp;&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;firstName:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;value: "Jeffrey"
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;},
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lastName:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;value: "Lebowski"
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;&nbsp;&nbsp;});
</code></pre></div>
		<p>Just like with <span class="inlineCode">funnyGuy</span>, I declare a 
		variable and initialize to <span class="inlineCode">Object.create</span>. 
		The first argument is our <span class="inlineCode">person</span> object 
		that will act as this newly created object's prototype. The second 
		argument is me specifying the <span class="inlineCode">firstName</span> 
		and <span class="inlineCode">lastName</span> properties and their 
		values.</p>
		<p>You would think that you could just use the object literal notation 
		that you saw earlier to specify the properties:</p>
		<div><pre><code>var theDude = Object.create(person,
&nbsp;&nbsp;&nbsp;&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;firstName: "Jeffrey",
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lastName: "Lebowski"
&nbsp;&nbsp;&nbsp;&nbsp;});
</code></pre></div>
		<p>Unfortunately, you can't be quite that brief. This will throw an 
		error, for every simple property defined via <span class="inlineCode">
		Object.create</span> has to be an object with a <span class="inlineCode">
		value</span> property containing the value you care about.</p>
		<p>Once you've figured that out and specified the properties to set once 
		this object has been created, the end result is identical to what you 
		saw earlier when creating the <span class="inlineCode">funnyDude</span> 
		object. You will have created a <span class="inlineCode">theDude</span> 
		object whose prototype object is <span class="inlineCode">person</span> 
		with the <span class="inlineCode">firstName</span> and
		<span class="inlineCode">lastName</span> properties storing the 
		appropriate value.</p>
		<p>One more object remaining! For our last <span class="inlineCode">
		detective</span> object, just to try something similar...yet different, 
		I try to create a more compact way of defining the initial properties as 
		part of creating the object via <span class="inlineCode">Object.create</span>:</p>
		<div><pre><code>var detective = Object.create(person,
&nbsp;&nbsp;&nbsp;&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;firstName: { value: "Adrian" },
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lastName: { value: "Monk" }
&nbsp;&nbsp;&nbsp;&nbsp;});
</code></pre></div>
		<p>By now, you know exactly what is going on. I won't repeat myself 
		here. At the end of all this, you will end up with your child objects 
		created, chained to the parent <span class="inlineCode">person</span> 
		object, which is in turn chained to the <span class="inlineCode">Object</span>:</p>
		<p>
		<img alt="and the person appears" height="519" src="https://www.kirupa.com/html5/images/newObject_properties_person_72.png" width="685"></p>
		
		<p>At this point, if you've been following along and understand what is 
		going on, you should be quite impressed with yourself. Many people who 
		work with JavaScript for a very long time have difficulty grasping how 
		inheritance and prototypes tie in to object creation. Wrapping your head 
		around all of this is quite an accomplishment.</p>
		<p>Before you pop the champagne bottle and start celebrating, we are not 
		done yet. There is one last thing we need to look at before we call it a 
		day.</p>
		<h2>The <span class="inlineCode">this</span> Keyword</h2>
		<p>Let's go back to our <span class="inlineCode">person</span> object 
		and, more specifically, the <span class="inlineCode">getName</span> 
		property:</p>
		<div><pre><code>var person = {
&nbsp;&nbsp;&nbsp;&nbsp;getName: function () {
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return "The name is " + this.firstName + " " + this.lastName;
&nbsp;&nbsp;&nbsp;&nbsp;}
};
</code></pre></div>
		<p>When you call <span class="inlineCode">getName</span>, depending on 
		which object you called it from, you'll see the appropriate name 
		returned. For example, let's say you do the following:</p>
		<div><pre><code>var funnyGuy = Object.create(person);
funnyGuy.firstName = "Conan";
funnyGuy.lastName = "O'Brien";
&nbsp;
alert(funnyGuy.getName());
</code></pre></div>
		<p>When you run this, you'll see something that looks as follows:</p>
		<p class="centerImageNoBorder">
		<img alt="this is conan o'brien" height="249" src="https://www.kirupa.com/html5/images/this_is_conan_obrien.png" width="435"></p>
		<p>If you look at the <span class="inlineCode">getName</span> property 
		again, there is absolutely no existence of the <span class="inlineCode">
		firstName</span> or <span class="inlineCode">lastName</span> properties 
		on the <span class="inlineCode">person</span> object. When a property 
		doesn't exist, I mentioned that we walk down the prototype chain from 
		parent to parent. In this case, that would be <span class="inlineCode">
		Object</span>:</p>
		<p class="centerImageNoBorder">
		<img alt="just the person and the object" height="287" src="https://www.kirupa.com/html5/images/person_object_72.png" width="422"></p>
		<p class="centerImageNoBorder">&nbsp;</p>
		<p>There is no existence of the <span class="inlineCode">firstName</span> 
		or <span class="inlineCode">lastName</span> properties on
		<span class="inlineCode">Object</span> either. How is it that this
		<span class="inlineCode">getName</span> method happens to work and 
		return the right values?</p>
		<p>The answer has to do with the <span class="inlineCode">this</span> 
		keyword that precedes <span class="inlineCode">firstName</span> and
		<span class="inlineCode">lastName</span>. The <span class="inlineCode">
		this</span> keyword refers to the object that our
		<span class="inlineCode">getName</span> method is bound to. That object 
		is, in this case, <span class="inlineCode">funnyGuy</span>:</p>
		<p class="centerImageNoBorder">
		<img alt="the this keyword and funnyGuy" height="434" src="https://www.kirupa.com/html5/images/this_funny_guy_72.png" width="685"></p>
		
		<p>At the point where the <span class="inlineCode">getName</span> method 
		is evaluated and the <span class="inlineCode">firstName</span> and
		<span class="inlineCode">lastName</span> properties have to be resolved, 
		the lookup starts at whatever the <span class="inlineCode">this</span> 
		keyword is pointing to. In our case, the <span class="inlineCode">this</span> 
		keyword is pointing to the <span class="inlineCode">funnyGuy</span> 
		object - an object that contains the <span class="inlineCode">firstName</span> 
		and <span class="inlineCode">lastName</span> properties!</p>
		<p>Knowing what the <span class="inlineCode">this</span> keyword refers 
		to is something we'll devote more time to in a later tutorial, but what 
		you've seen now will you get you pretty far.</p>
		<h2>Conclusion</h2>
		<p>Because so much fuss is made about JavaScript's object orientedness, 
		it is only natural that a topic that covers it would be as wide and deep 
		as what you've seen here. A bulk of what you saw here dealt with 
		inheritance directly or indirectly where objects are derived and based 
		on other objects. Unlike other, more class-ical languages that use 
		classes as templates for objects, JavaScript has no such concept of a 
		class. JavaScript uses what is known as a <strong>prototypical 
		inheritance model</strong>. You don't instantiate objects from a 
		template. Instead, you create objects either from scratch or, more 
		commonly, by copying / cloning another object.</p>
		<p>In the bazillion pages here, I tried to reinforce JavaScript's new 
		functionality for working with objects and extending them for your own 
		needs. There is still more to cover, so take a break and we'll touch 
		upon some more interesting topics in the near future that extend what 
		you've seen in more powerful, expressive, and awesome ways.</p>
		<p>
		</p><p>If you have a question about this or any other topic, the easiest thing is to drop by <a class="blueEmphasis" href="http://forum.kirupa.com">our forums</a> where a bunch of the friendliest people you'll ever run into will be happy to help you out!</p>
        
</div>
					</div>
				</article>
				<!--================= END :: Tutorial =================-->
				
				<!--================= START :: Tutorial =================-->
				<article>
					<a id="t-76" name="t-76"></a><h1>76 : Javascript Promises</h1>
					<span class="ref-site">http://scriptonitejs.com/javascript-promises/</span>
					<div class="tutorial__content">
<div class="entry-content">
			<p class="p1"><span class="s1">Let us dive a little deeper into promises and asynchronous programming. If you already understand how asynchronous programming works in javascript, you can jump to the <a href="#promises">promises</a> section. However if you want to under the history behind why promises exist, then read on. Javascript Promises are a much needed feature to have. They address a problem known as callback hell, which one is bound to face if they do any kind of&nbsp;asynchronous programming. As a web developer, this is something you cannot run away from as the browsers internal operations are asynchronous. Asynchronous here means more than one thing is happening at a time within a browsers engine. You might also hear the term synchronous in a similar&nbsp;manner. It means one thing happening at a time. For example, you may have heard that javascript is&nbsp;synchronous. This means that when executing javascript you cannot execute multiple statements at a time. Every statement that begins to execute MUST complete before another is run. This is why you hear that javascript is single threaded. Code execution is run line by line. </span></p>
<p class="p1"><span class="s1">Other languages like Java have the ability to run multiple commands at a same time by delegating them to a different memory on the system (known as multi threading). By default this asynchronous functionality comes out of the box with the language. So how does javascript do asynchronous programming? Let me try clarify that here. You see, within a browser, many things are happening. There are many engines running simultaneously within it. The javascript engine is one of them. Another might be the rendering engine, which displays HTML document and images. The browser also has networking capabilities. So when you decide to make HTTP requests, it uses this component found in the browser to make that request. Check out how the browser works <a href="http://www.html5rocks.com/en/tutorials/internals/howbrowserswork/">here</a>. Ok, so now u see that everything going in the browser is asynchronous. But within the javascript engine itself, everything is synchronous. </span><span id="more-462"></span></p>
<p class="p1"><span class="s1">Javascript however has hooks into browser, making it capable of communicating with it. Depending of what app you are writing, you may have to delegate some tasks so that the browser handles them as the javascript code continues. Like "Hey browser, use your HTTP request component to fetch me some data". When javascript asks for something from the browser and it gets returned, that answer is put in what we call the "Event Queue". This queue stores notifications of events that happen in the browser (like clicks,&nbsp;mouse events, key strokes, and callbacks from other async tasks, etc). So if you wanted a function to run after a user clicked on that button, that function or callback would get added to this queue when event happens. Remember clicks are not part of javascript, a click is a browser event! Javascript has what we call the execution stack. Imagine this stack is what runs every line of code you write. So in your code if you execute a function, it gets added onto this stack. When that code is done executing, it is popped off the stack, and the next line of code is run. Javascript will run everything on that stack, and when done will it turn to the event queue. If anything is in the queue its starts running those tasks, one by one until its empty.</span><span class="s3">&nbsp;This is a continuous cycle called the event loop.</span><span class="s1">&nbsp;So you see, its not javascript that is asynchronous, its the browser that is putting things in the event queue so that javascript can attend to it can. It is also worth noting, that&nbsp;when the callback is added to the queue there is no guarantee how long it will have to wait. How long it takes the current code(on the execution stack) to run to completion, and what else is already in the queue controls the time. &nbsp;</span></p>
<h1 class="p1"><span class="s1">The Callback – Asynchronous Javascript&nbsp;</span></h1>
<p class="p1"><span class="s1">The cornerstone of asynchronous programming in javascript are callbacks. A callback is a function that is delegated to another function or piece of code, to run. This might seem a mouthful but is very simple… for example we can tell a function, after you do your task of fetching some data, display it. Displaying the data will be the callback function. Another example is clicking a button. When you click the button, show an alert box. The click event receives a callback function as to what to do when a click is received. As a final example, javascript has a <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/forEach">foreach</a>&nbsp;method</span><span class="s1">&nbsp;for array objects that execute a function for each item iterated in the array.&nbsp;Here is the callback in action again. Callbacks can be used to manage the order in which code gets executed if thought about properly. Without the ability to write synchronous code, things such as network traffic, long running processes, etc. can potentially block parts of our code. Imagine everytime we make a request for data, we have to wait until the data comes back before moving forward with what we are doing. Not cool. Callbacks allow us to continue doing what we are doing and they get executed when those long tasks are complete.</span></p>
<h1 class="p1"><span class="s1">Callbacks in Action!</span></h1>
<p class="p1"><span class="s1">Lets begin looking at some code. I mentioned earlier that events are added to a&nbsp;queue. Lets create a simple click event as it demonstrates a very simple idea of asynchronous programming. When you click on a button, something should happen (callback gets fired).</span></p>
<pre><code>var button = document.getElementById('sButton');
button.onClick = function(event){
&nbsp; console.log("the button was clicked");
};</code></pre>
<p class="p1"><span class="s1">When the button is clicked, something interesting happens. The callback function is pushed onto this event queue(to the back of it). If the current execution stack gets emptied (all tasks get run), it will jump into the event queue and begins executing callbacks there. Can you think of what will happen if the button is clicked before the event is attached? Yes, it will not fired! This will probably not happen for such a simple user interactions. But you can begin to imagine&nbsp;that things can get complicated if we decide to nest or chain asynchronous calls. The order in which things happen become more and more important. Lets look at another example that really demonstrates that callbacks are put on a back burner (event queue)</span></p>
<pre><code>function performLongTask(){
 var ms = 4000 + new Date().getTime();
 while( new Date &lt; ms );
 console.log('Long Task Finished');
}

function clickHandler(){
 console.log('Something was clicked!');
}

//listen for the click event
document.addEventListener('click', clickHandler);

performLongTask();
console.log('Finished Executing');</code></pre>
<p class="p1"><span class="s1">We have a function called 'performLongTask' that performs some task for 4 seconds (yes very long indeed). We wire-up a click event on the document and run&nbsp;the long task function. What do you think will happen? You have go ahead and run this in your browser. Because the long running task takes&nbsp;4 seconds, that will give you enough time to click anywhere on the document body. After 4 seconds, the console outputs the results. It may or may not surprise you BUT the button event appears last! Its almost as if you clicked on the button last. But no, you clicked on the button whiles the long task was performing. When you did that, the callback was put on the event queue. Only after all the javascript running on the execution stack was done did the callback function execute. Next example.</span></p>
<pre><code>var http = require('http');
http.get('http://www.scriptonitejs.com', function(){ console.log('got a response');});
console.log('all done here');</code></pre>
<p class="p1"><span class="s1">The&nbsp;http.get call, it is delegated to the browser. When the task is completed, it is passed back to the javascript event queue to handle. An important quick remember here. If something is in the event queue, and there is javascript currently&nbsp;running, the callback in the event queue will not fire until everything in the execution is run.</span></p>
<p class="p1"><span class="s1">With that in mind, looks look at something a little trickier. In the project files for this chapter ( folder eight ), locate xhr-tmeout.js. The contents are located below</span></p>
<pre><code>var myXHR = new XMLHttpRequest();
myXHR.open('get', 'data.json', true);
myXHR.send();

// Scenario #1
function performLongTask(){
 var ms = 4000 + new Date().getTime();
 while( new Date &lt; ms );
}
performLongTask();

function xhrListener(){
 console.log('XHR Event has been handled');
}

myXHR.addEventListener('load', xhrListener);
myXHR.addEventListener('error', xhrListener);
// End Scenario #1</code></pre>
<p class="p1"><span class="s1">Lets see what is going on here. We have a scenario. We make an Ajax request to get that data. Then we start our long task we saw earlier on. We perform that task for 4 seconds then we register our Ajax event handlers to register for when the request loads or fails. What do you think will happen? Will the load event ever fire? It turns out that…. YES the load will fire every single time. Can you think of a reason why from everything you have learned so far? After the send function on the xhr is run, execution of javascript continues. Remember javascript is synchronous. When you make an Ajax request, javascript send that request to the browser and continues executing the rest of its code. In doing so, EVERYTHING in the execution has to finish running. And this included registering the Ajax event handlers.&nbsp;</span></p>
<p class="p1"><span class="s1">Lets look at how to cause a true delay so that the execution is paused after the send command.</span></p>
<pre><code>var myXHR = new XMLHttpRequest();
myXHR.open('get', 'data.json', true);
myXHR.send();
//call setTimeout
setTimeout(function delayed(){
 console.log('setTimeout started!')
 function xhrListener(){
   console.log('XHR Event has been handled');
 }
 myXHR.addEventListener('load', xhrListener);
 myXHR.addEventListener('error', xhrListener);
}, 4000);</code></pre>
<p class="p1"><span class="s1">Now after the send method is called, the setTimeout will actually wait 4 seconds, before it registers the other functions. In the other case javascript continues running after the send command. In this case, there is a pause which then registers everything after 4seconds. Note that the Ajax request gets added to the event queue. Because nothing is running, the file will be loaded. If we register a load after this, then it will not work. What we are interested in has already happened.&nbsp;</span></p>
<p class="p1"><span class="s1">It is important to understand how the internal operations of the browser and javascript work. With this knowledge you are able to write application that response timely to your requests.</span></p>
<h1 class="p1"><span class="s1">The callback pattern.</span></h1>
<p class="p1"><span class="s1">The introduction of node came the rise of the callback pattern. If you are a node developer a lot of code you write involves using this pattern. You call a function passing it a callback, which get executed in response to events. It is quite similar to the event model(like listening for a click), but in this pattern the function is passed as an argument. Your callback might be waiting for data to load, or a response from an http request. It is worth to say node is also single threaded, however it uses what we call non-blocking techniques. Rather than doing everything one command at a time you create a callback function that gets invoked when your operation is successful or fails. Lets look at some node code that uses this pattern.</span></p>
<pre><code>var fs = require('fs');
var fileContent = "Data to be written to file";
fs.writeFile("kofi.txt", fileContent, function(err) {
  if (err) { 
    throw err; 
  }
});
console.log("Done Executing");</code></pre>
<p class="p1"><span class="s1">What we are doing here is very simple. We are require the node file system module. This will enable us to read and write data to the file system (it is like using import in other languages). We use the writeFile method to write/create a new file in our working directory. We call this file called 'kofi.txt'. We then pass a callback to our writeFile method. As you already know this will simply execute that function once the file is written. All we do in our callback is to console log a successful message. Lets kick this up notch. How about instead of using console log, we use native node methods to reads the file after the file is written to disk. This means that when the writeFile is successful, we read that content. Like this&nbsp;</span></p>
<pre><code>var fs = require('fs');
var fileContent = "Data to be written to file";
fs.writeFile("kofi.txt", fileContent, function(err) {
  if (err) { 
    throw err; 
  }
  //nested callback
  fs.readFile("kofi.txt", function(err, fileContent) {
    if (err) {
      throw err;
    }
    console.log("About to Read Contents:")
    console.log(fileContent);
  });
});
console.log("Done Executing");</code></pre>
<p class="p1"><span class="s1">See what just happen? We have nested another callback within our successful call! And why not? We do want to read that file and do something with it. How about, when we read the file write that content into yet another file. Note here that the possibilities are endless. If we did that our code would look like this</span></p>
<pre><code>var fs = require('fs');
var fileContent = "Data to be written to file";
fs.writeFile("kofi.txt", fileContent, function(err) {
  if (err) { 
    throw err; 
  }
  //nested callback
  fs.readFile("kofi.txt", function(err, fileContent) {
    if (err) {
      throw err;
    }
    console.log("About to Data Contents:")
    console.log(fileContent);
    fs.writeFile("kofi-two.txt", fileContent, function(err) {
      if (err) { 
        throw err; 
      }
      console.log('kofi-two successfully written to disk');
   });
 });
});
console.log("Done Executing");</code></pre>
<p class="p1"><span class="s1">By now it is evident you can see how ugly this can be. Ladies and gentlemen, here we have what is called callback hell! Code like this can be hard to understand. Just imagine how this will get once complexity within your application starts growing. Imagine doing something like firing off 3 async calls that there are conditions in which those calls must be handled. This is why we have javascript promises. They give you a way to organize your callbacks that are easier to maintain. Enough talk… lets get into javascript promises.</span></p>
<h1 id="promises" class="p1"><span class="s1">Javascript Promises</span></h1>
<p class="p1"><span class="s1">So you see why a better solution is needed for asynchronous programming in javascript. What exactly&nbsp;is a javascript promise? A javascript promise is simply an object that is used as a placeholder for an asynchronous operation. We have talked about many such operations, like when we create or read&nbsp;a file on a&nbsp;disk, or make an HTTP request in a browser, etc. When we do this&nbsp;we are running an asynchronous function that takes in a callback to be executed when completed. The moment we call an async&nbsp;function(operation), we immediately return what we call a promise. When the&nbsp;operation is done this&nbsp;promise will be resolved or rejected. Before using javascript promises in its truest sense… consider how this translates to using callbacks. Lets consider a mkdir function.</span></p>
<pre><code>mkdir("my_project_folder", success, fail);</code></pre>
<p class="p1">Lets say, that<strong> mkdir</strong>&nbsp;is an asynchronous operation used to make directories in a web application.&nbsp;In the code above mkdir takes two callback functions (success and fail) INSTEAD of immediately creating&nbsp;the directory folder( remember its an asynchronous operation ). Traditionally this is how we do it with callbacks. But&nbsp;what if we change the internal operations of mkdir, so that it would return an object (promise) that you could then attach your&nbsp;callbacks to? That is the idea behind javascript promises </p>
<pre><code>var promise = mkdir("my_project_folder");</code></pre>
<p class="p1">Now the promise returned from <strong>mkdir</strong> is assigned to our promise variable&nbsp;so&nbsp;we can attach our callbacks to it. It is worth knowing that there are life cycles that a promise object goes through. Before the async operation is complete, the promise is said to be in a&nbsp;<strong>pending</strong> state. Though if the operation has not began, its also said to be pending. &nbsp;Once the operation completes, the promise is settled, however it enters yet another state of whether the operation was successful or it failed. If successful, we say the promise is in a&nbsp;<strong>fulfilled</strong>&nbsp;state. If it failed then it has a state of <strong>rejected</strong>. Once the state of a promise has been fulfilled, it cannot be changed.</p>
<p class="p1">So back to our mkdir function, imagine that a promise is returned, we attach our callbacks by using the <strong>then()</strong> method on our object. Something like this</p>
<pre><code>promise.then(function(dirName){
  //perform success/fulfillment functionality
}, function(err){
  //perform failed/rejected functionality
});</code></pre>
<p class="p1">The .then() method of a promise object takes two parameters. They are handlers for a fulfilled and rejected state, respectively The promise object also has a catch method&nbsp;for handling errors. You would normally see it chained together with .then(). Its best to always try to handle errors in your application. If you don't do this, you could potential get an error in your app and not detect it.</p>
<pre><code>promise.then(function(dirName){
  //perform success/fulfillment functionality
}, function(err){
  //perform failed/rejected functionality
}).catch(function(err){
  //perform failed/rejected functionality
});</code></pre>
<p class="p1">So we have a promise returned from mkdir, but internally what does that function look like? Lets take a quick peek under the hood.</p>
<pre><code>function mkdir(dirName){</code></pre>
<p class="p1">The mkdir function creates a promise object from the global promise constructor, then returns it. Its that simple. But, there is more to this Promise constructor. Lets look at that. A promise constructor expects a callback known as the <strong>resolver</strong> function. This function receives two arguments (resolve and reject).</p>
<pre><code>function mkdir(dirName){</code></pre>
<p class="p1">Can you see where this is going? &nbsp;Look at&nbsp;arguments that are sent to the resolver function. Resolve is called when the operation is successful <strong>resolve(make_dir)</strong> and Reject is called when it fails. So its the resolver thats really doing the magic. In the example i have <strong>onSuccess</strong> and <strong>onFail</strong>. We are assuming that these are methods that exists on the object (for example if it was&nbsp;an image object, such a method would be onLoad). So when those events are fired by the object, then we can finally handle our success or failure.</p>
<pre><code>var promise = mkdir("my_project_folder");</code></pre>
<p class="p1">Another useful tip is that you can save your promise for later use. Think reusability here.&nbsp;Imagine&nbsp;that you had an application that grabbed data externally. Lets just say it returns some kind of user account information&nbsp;after an async operation. We could save this data in an object. Within that object, we have access to thinks like their balance, age, profile info, etc. We can&nbsp;cache this promise object in our application, and use it throughout our app as needed. Once cached, its available for us to use. We could create a helper method that can be accessed at will.</p>
<h1 class="p1">The promise constructor</h1>
<p class="p1">Lets dive a little bit deeper into the promise constructor and how it is used on another level. Earlier on i spoke about the event queue and how that works. Promises when resolved or rejected, also get put into this queue. Remember the the <strong>resolver</strong> takes in two callbacks (resolve and reject). When any of them are called, they are added to the queue. Since this operation is asynchronous, they are added to the queue when&nbsp;certain conditions are met. You can invoke a promise to <strong>resolve</strong> or <strong>reject</strong>&nbsp;by executing those callbacks immediately. The way we have done it so far is to wait for some kind of event to fire then we resolve or reject the project, for the most part this is what you want to it. But lets give ourselves more power and invoke them ourselves in the promise constructor.</p>
<pre><code>var myPromise = new Promise(function(resolve, reject){</code></pre>
<p class="p1">Let take a look at this slowly.&nbsp;We know&nbsp;that our declaration above returns a promise object immediately. We can even tell if we run this in the solve, we notice that "my promise to you" in executed. The resolve function does not run though. We have not yet written that functionality (if you comment it out, we still get the console message). Lets tell it what to do</p>
<pre><code>myPromise.then(function(){</code></pre>
<p class="p1">In the console, we first see "my promise to you", then "..promise resolved". Do you know why? Because the promise is first returned immediately (that execution runs as it returns the promise). When we resolve the promise, it is added to the queue. If all currently&nbsp;running code is done, then only will the&nbsp;resolve function fire. See you can tell what the execution order will be for this piece of logic</p>
<pre><code>var myPromise = new Promise(function(resolve, reject){</code></pre>
<pre><code>myPromise.then(function(){</code></pre>
<pre><code>console.log("test1");</code></pre>
<p>Did you figure it out right away? Yep! Our output looks like this</p>
<pre><code>my promise to you</code></pre>
<p>Because resolve is added to the queue, it doesnt first right away until all running tasks are done. With this knowledge, you can do some pretty exciting stuff as you have a better understanding of how and when you can resolve asynchronous operations.</p>
<p>Its important to note, that once you resolve or reject a promise, you have changed the internal state of it and it cannot be changed again. So in our first sample, if we executed reject as well as resolve, reject will never be called.</p>
<pre><code>var myPromise = new Promise(function(resolve, reject){</code></pre>
<p><strong>reject()</strong> will never be called because the state of the promise has been fulfilled. This is a good thing, as you would not want the state to change once settled (as resolved or rejected) to prevent race conditions ( other resolver functions running to possibly resolve or reject again, no no! ).</p>
<p>Sometimes you want your promise to represent just a single value. This way when resolved or rejected, that value is passed to the callback function.</p>
<pre><code>var promise = Promise.resolve("My String Param");</code></pre>
<pre><code>or use the constructor</code></pre>
<pre><code>new Promise(function(param){</code></pre>
<p>This also applies if you wanted to pass a rejected parameter. In the above code samples the resolved or rejected callbacks already have the passed in values. Pretty neat.</p>
<p>Now here is something new and interesting i want to try and explain, remember that <strong>Promise.resolve(value)</strong> returns a <code>Promise</code> object that is resolved with the given value.&nbsp;If the value <em>returned</em> is a <strong>thenable</strong> (meaning it&nbsp;has a <code>then</code> method), the returned promise will "follow" that <strong>thenable</strong>, adopting its eventual state; otherwise the returned promise will be fulfilled with the value. Generally, if you want to know if a value returned is a promise or not – <code>Promise.resolve(value)</code> it instead and work with the return value as a promise. So now lets create a <strong>thenable</strong> and pass it to our promise.</p>
<pre><code>var thenable = {</code></pre>
<p>Lets pass the thenable to our resolve.</p>
<pre><code>var myPromise = Promise.resolve(thenable);</code></pre>
<p>Lets see what happens. The Promise.resolve will call the thenable.then(). Whatever is returned is passed to Promise.resolve(). We have already seen what happens when passed to resolve(). It returns "my param". We can now use that value in the&nbsp;<em><strong>myPromise</strong></em>&nbsp;variable. Which also returns "my param". <em>Isn't that beautiful?</em> </p>
<p>So whats the use case for this? &nbsp;Well, what if you were expecting a promise from say a different library or API? Sometimes you dont know if what is being received has a then which needs to be run before doing anything. This approach is what helps us in such situations!</p>
<p>Whew, we have barely scratched the surface when it comes to javascript promises. I am going to stop here, but stay tuned for part 2!!</p>
		</div>
					</div>
				</article>
				<!--================= END :: Tutorial =================-->
				
				<!--================= START :: Tutorial =================-->
				<article>
					<a id="t-77" name="t-77"></a><h1>77 : About null and undefined</h1>
					<span class="ref-site">https://www.kirupa.com/html5/null_and_undefined.htm</span>
					<div class="tutorial__content">
<div id="mainContent">



		<p>One of the great mysteries of the world revolves around making sense 
		of <span class="inlineCode">null</span> and <span class="inlineCode">
		undefined</span>. Most code you see is littered with them, and you've 
		probably run into them yourself a few times. As mysteries go, making 
		sense of <span class="inlineCode">null</span> and
		<span class="inlineCode">undefined</span> isn't particulary bizarre. It 
		is just dreadfully boring...like the most boring (yet important) thing 
		about JavaScript you'll ever have to learn.</p>
		
		
		<h2>Null</h2>
		<p>Let's start with <span class="inlineCode">null</span>. The
		<span class="inlineCode">null</span> keyword is sort of also a primitive 
		that fills a special role in the world of JavaScript. It is an explicit 
		definition that stands for <strong>no value</strong>. If you've ever 
		browsed through code others have written, you'll probably see
		<span class="inlineCode">null</span> appear quite a number of times. It 
		is quite popular, for the advantage of <span class="inlineCode">null</span> 
		lies in its definitiveness. Instead of having variables contain stale 
		values or mystery undefined values, setting it to
		<span class="inlineCode">null</span> is a clear indication that you
		<strong>want the value to not exist</strong>.</p>
		<p>This advantage 
		is important when you are writing code and want to initialize or clear a 
		variable to something that represents nothing.</p>
		<p>Here is an example:</p>
		<div><pre><code>var name = null;
&nbsp;
if (name === null) {
&nbsp;&nbsp;&nbsp;&nbsp;name = "Peter Griffin";
} else {
&nbsp;&nbsp;&nbsp;&nbsp;name = null;
}
</code></pre></div>
		<p>The <span class="inlineCode">null</span> primitive isn't a naturally 
		occuring resource. It is something something you consciously assign, so 
		you will often see it used as part of variable declarations or passed in 
		as arguments to function calls. Using <span class="inlineCode">null</span> 
		is easy. Checking for its existience is pretty easy as well:</p>
		<div><pre><code>if (name === null) {
&nbsp;&nbsp;&nbsp;&nbsp;// do something interesting...or not
}
</code></pre></div>
		<p>The only thing to note is that you should use the
		<span class="inlineCode">===</span> operator instead of the lowly
		<span class="inlineCode">==</span> one. While the world won't end if you 
		use <span class="inlineCode">==</span>, it's good practice to check for 
		both type and value when working with null.</p>
		<div class="callout">
			<h4>Is <span class="inlineCode">null</span> a primitive or an 
			object?</h4>
			<p>The <span class="inlineCode">null</span> primitive is similar to your
		<span class="inlineCode">string</span> and <span class="inlineCode">
		boolean</span> built-in types in that it also has an object 
		representation. There is one quirk you need to note, though. Despite what I just said, doing <span class="inlineCode">
		typeof null</span> at any given time will show it as being an <strong>
		object</strong>. That isn't how a primitive behaves, and the reason for 
		this behavior has to do with a longstanding bug in the JavaScript 
			language. The word on the street is that this bug may get fixed in 
			the future, so...yeah!</p>
		</div>
		<h2>Undefined</h2>
		<p>Here is where things get a little interesting. To represent something 
		that isn't defined, you have the <span class="inlineCode">undefined</span> 
		primitive. You see undefined in a few cases. The most common ones are 
		when you try to access a variable that hasn't been initialized or when 
		accessing the value of a function that doesn't actually return anything.</p>
		<p>Here is a code snippet that points out <span class="inlineCode">
		undefined</span> in a few of its natural habitats:</p>
		<div><pre><code>var myVariable;
alert(myVariable); // undefined
&nbsp;
function doNothing() {
&nbsp;&nbsp;&nbsp;&nbsp;// watch paint dry
&nbsp;&nbsp;&nbsp;&nbsp;return;
}
&nbsp;
var weekendPlans = doNothing();
alert(weekendPlans); // undefined
</code></pre></div>
		<p>In your code, you probably won't be assigning
		<span class="inlineCode">undefined</span> to anything. Instead, you will 
		spend time checking to see if the value of something is
		<span class="inlineCode">undefined</span>. You have several ways to 
		perform this check. The first is a naive way that usually almost always 
		works:</p>
		<div><pre><code>if (myVariable == undefined) {
&nbsp;&nbsp;&nbsp;&nbsp;// do something
}
</code></pre></div>
		<p>The downside of this approach is that you could potentially overwrite
		<span class="inlineCode">undefined</span> to something like <strong>true</strong>, 
		and that would break your code. The safest way to perform a check for 
		undefined involves <span class="inlineCode">typeof</span> and the
		<span class="inlineCode">===</span> operator:</p>
		<div><pre><code>var myVariable;
&nbsp;
if (typeof myVariable === "undefined") {
&nbsp;&nbsp;&nbsp;&nbsp;alert("Define me!!!");
}
</code></pre></div>
		<p>This ensures that you will perform a check for
		<span class="inlineCode">undefined</span> and always return the correct 
		answer.</p>
		<div class="callout">
			<h4>null == undefined, but null !== undefined</h4>
			<p>Continuing the == and === weirdnesses, if you ever check for
			<span class="inlineCode">null == undefined</span>, the answer will 
			be a <strong>true</strong>. If you use <span class="inlineCode">===</span> 
			and have <span class="inlineCode">null === undefined</span>, the 
			answer in this case will be <strong>false</strong>.</p>
			<p>The reason is that <span class="inlineCode">==</span> does type 
			coercion where it armtwists types to conform to what JavaScript 
			thinks the value should be. Using <span class="inlineCode">===</span>, 
			you check for both type and value. This is a more comprehensive 
			check that detects that <span class="inlineCode">undefined</span> 
			and <span class="inlineCode">null</span> are indeed two different 
			things.</p>
			<p>A hat tip to
			<a class="blueEmphasis" href="http://www.senocular.com">senocular</a> 
			(aka Trevor McCauley) for pointing this out!</p>
		</div>
		<h2>Conclusion</h2>
		<p>There is a reason why I saved these built-in types for last.
		<span class="inlineCode">Null</span> and <span class="inlineCode">
		undefined</span> are the least exciting of the bunch, but they are also 
		often the ones that are the most misunderstood. Knowing how to use
		<span class="inlineCode">null</span> and detecting for it and
		<span class="inlineCode">undefined</span> is a very important skill to 
		get right. Not getting it right will lead to very subtle errors that are 
		going to be hard to pinpoint.</p>
		<p>
		</p><p>If you have a question about this or any other topic, the easiest thing is to drop by <a class="blueEmphasis" href="http://forum.kirupa.com">our forums</a> where a bunch of the friendliest people you'll ever run into will be happy to help you out!</p>
	</div>
					</div>
				</article>
				<!--================= END :: Tutorial =================-->
				
				<!--================= START :: Tutorial =================-->
				<article>
					<a id="t-78" name="t-78"></a><h1>78 : How to avoid infinite nesting callbacks</h1>
					<span class="ref-site">https://bytearcher.com/articles/how-to-avoid-infinite-nesting-callbacks/</span>
					<div class="tutorial__content">
<div class="overflow-sanitizer">  <p>Performing something after an asynchronous call has ended requires you to place subsequent program logic inside a callback. Performing multiple steps leads to deeply nested callbacks.</p> <p>Is there any way avoid deeply nested callbacks?</p> <p>There are two good ways to flatten nested callbacks. They both have to do with waiting for a Promise to resolve a value. The first one uses ES6 generators and the <code>yield</code>
 keyword. The second one builds on top of that with async functions and the <code>await</code> keyword. Both methods allow you to write flat program code free of nested callbacks.</p> <h2 id="placing-logic-inside-callback">Placing logic inside callback</h2> <p>When using callbacks, you're required to put dependent program logic that is to be executed after an asynchronous operation has completed logic inside a callback. When you combine multiple such calls, you end up with deeply nested code.</p> <p>Let's write a program that reads two files and prints their lengths. When using callbacks, our example looks like the following.</p> <figure><pre><code>1
 var fs = require('fs');
2 
3 fs.readFile('file1.txt', 'utf8', (err, file1) =&gt; {
4     fs.readFile('file2.txt', 'utf8', (err, file2) =&gt; {
5         console.log(`total length: ${file1.length + file2.length}`);
6     });
7 });</code></pre> </figure><h2 id="yield">Yield</h2> <p>ES6 generators and the <code>yield</code>
 keyword can be used write flat asynchronous code. You need a Promises-based version of your API together with a special helper function. The responsibility of the helper function (also known as co/coroutine/spawn function) is to coordinate <code>yield</code> and waiting for Promises to resolve to a value. One implementation of such helper function is <a href="http://bluebirdjs.com/docs/api/promise.coroutine.html">Bluebird.coroutine</a>.</p> <p>The example using generators and yield would look like the following. Notice how flat the program structure is - there are no callbacks. The <code>function* () {}</code> denotes a generator function where you can use the <code>yield</code> keyword.</p> <figure><pre><code>1 var fs = require('fs-promise');
2 var bluebird = require('bluebird');
3 
4 bluebird.coroutine(function* () {
5     var file1 = yield fs.readFile('file1.txt', 'utf8');
6     var file2 = yield fs.readFile('file2.txt', 'utf8');
7 
8     console.log(`total length: ${file1.length + file2.length}`);
9 })();</code></pre> </figure><h2 id="await">Await</h2> <p>The approach of using generators to yield Promises seen previously is so good that there will be built-in language support for it in ES2017. It will be called async functions and they will use the <code>await</code> keyword instead of <code>yield</code>.</p> <p>The example using async functions and the <code>await</code> keyword looks like the following. Notice how the call to <code>coroutine</code> and passing of a generator function has been replaced with <code>async function</code>.</p> <figure><pre><code>1 var fs = require('fs-promise');
2 
3 (async function() 
{
4     var file1 = await fs.readFile('file1.txt', 'utf8');
5     var file2 = await fs.readFile('file2.txt', 'utf8');
6 
7     console.log(`total length: ${file1.length + file2.length}`);
8 })();</code></pre> </figure><p>You can use async functions and the <code>await</code> keyword natively in new JS engines that support it or use TypeScript or Babel to convert code into the preceding specification of JavaScript.</p> <h2 id="avoid-infinite-nesting-callbacks">Avoid infinite nesting callbacks</h2> <p>Use ES6 generators and <code>yield</code> or ES2017 async functions and <code>await</code> to write flat asynchronous code instead of infinite nesting callbacks. You can use <code>yield</code> in native today and async functions with the help of TypeScript or Babel.</p> <p>Related articles</p> <ul class="caret"> <li><a href="/articles/blocking-vs-non-blocking-in-node.js/">Blocking and Non-Blocking in Node.js</a></li> <li><a href="/articles/es6-promise-then-beginner-tutorial/">Promises - A gentle introduction</a></li> </ul>      </div>
					</div>
				</article>
				<!--================= END :: Tutorial =================-->
				
				<!--================= START :: Tutorial =================-->
				<article>
					<a id="t-79" name="t-79"></a><h1>79 : Should I use === or == equality comparison operator in JavaScript?</h1>
					<span class="ref-site">https://bytearcher.com/articles/equality-comparison-operator-javascript/</span>
					<div class="tutorial__content">
<div class="overflow-sanitizer">  <p>You know there are two different equality comparison operators in JavaScript: the <code>===</code> and <code>==</code> operators, or the <em>triple equals</em> and <em>double equals</em> as they're called. You've seen both used but aren't sure which one to pick for your code. You'd like to know a sure fire way to decide over one or the other.</p> <p>As it turns out, there is a straightforward way to decide which one to use. And the same logic works for inequality comparison operators <code>!==</code> and <code>!=</code> as well.</p> <h2 id="compare-equal-and-of-same-type-with-">Compare equal and of same type with ===</h2> <figure><pre><code>1 x === y</code></pre> </figure><p>The triple equals operator (<code>===</code>
) returns true if both operands are of the same type and contain the same value. If comparing different types for equality, the result is false.</p> <p>This definition of equality is enough for most use cases. When comparing the string <code>"0"</code> and the number <code>0</code> the result is false as expected.</p> <p>Sources such as <a href="/articles/douglas-crockford-javascript-good-parts-book-review/">D. Crockford</a> and <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Equality_comparisons_and_sameness#Loose_equality_using">MDN</a> both advise that only triple equals operator should be used when programming in JavaScript and double equals operator be ignored altogether.</p> <h2 id="complex-type-conversions-take-place-with-">Complex type conversions take place with ==</h2> <figure><pre><code>1 x == y</code></pre> </figure><p>The double equals operator (<code>==</code>
) tries to perform type conversion if the types differ and then compare for equality. If the types differ, either or both operands are first converted to a common type. The conversion rules are complex and depend on the argument types. For a full comparison table, see for example <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Equality_comparisons_and_sameness#Loose_equality_using">MDN</a> or the <a href="http://ecma-international.org/ecma-262/5.1/#sec-11.9.3">ECMAScript specification</a>.</p> <p>For example, when comparing the string <code>"0"</code> and the number <code>0</code>, the first argument is first converted to a number.</p> <figure><pre><code>1 "0" == 0 // becomes
2 ToNumber("0") === 0</code></pre> </figure><p>
While the string and number comparison is understandable, the complex rules for other types lead to illogical results. For example, see the comparisons between <code>null</code>, <code>undefined</code> and <code>false</code>:</p> <figure><pre><code>1 false == undefined // false
2 false == null      // false
3 null == undefined  // true</code></pre> </figure><h2 id="now-you-know-only-use-">Now you know - only use ===</h2> <p>Use the triple equals (<code>===</code>
) equality comparison operator. When trying to compare different types with triple equals, the result is always false. You will get the results you expect that are not subject to hard to memorize conversion rules. Comparing apples to oranges is false as expected.</p> <p>Note that these comparison operators are for comparing primitive types. For comparing deep equality of objects or arrays a different approach is needed that compares the operands structurally.</p>      </div>
					</div>
				</article>
				<!--================= END :: Tutorial =================-->
				
				<!--================= START :: Tutorial =================-->
				<article>
					<a id="t-80" name="t-80"></a><h1>80 : Prototypes are Objects (and why that matters)</h1>
					<span class="ref-site">http://raganwald.com/2015/06/10/mixins.html</span>
					<div class="tutorial__content">
<section id="main_content">
          <p><em>Prerequisite: This post presumes that readers are familiar with JavaScript's objects, know how a prototype defines behaviour for an object, know what a constructor function is, and how a constructor's <code class="highlighter-rouge">.prototype</code> property is related to the objects it constructs. Passing familiarity with ECMAScript 2015 syntax will be  helpful.</em></p>

<p>We have always been able to create a JavaScript class like this:</p>

<pre><code>function Person (first, last) {
  this.rename(first, last);
}

Person.prototype.fullName = function fullName () {
  return this.firstName + " " + this.lastName;
};


Person.prototype.rename = function rename (first, last) {
  this.firstName = first;
  this.lastName = last;
  return this;
}
</code></pre>

<p><code class="highlighter-rouge">Person</code> is a constructor function, and it's also a class, in the JavaScript sense of the word "<a href="http://raganwald.com/2015/05/11/javascript-classes.html">class</a>."</p>

<p>ECMAScript 2015 provides the <code class="highlighter-rouge">class</code> keyword and "compact method notation" as syntactic sugar for writing a function and assigning methods to its prototype (there is a little more involved, but that isn't relevant here). So we can now write our <code class="highlighter-rouge">Person</code> class like this:</p>

<pre><code>class Person {
  constructor (first, last) {
    this.rename(first, last);
  }
  fullName () {
    return this.firstName + " " + this.lastName;
  }
  rename (first, last) {
    this.firstName = first;
    this.lastName = last;
    return this;
  }
};
</code></pre>

<p>Nice. But behind the scenes, you still wind up with a constructor function bound to the name <code class="highlighter-rouge">Person</code>, and with <code class="highlighter-rouge">Person.prototype</code> being an object that looks like this:</p>

<pre><code>{
  fullName: function fullName () {
    return this.firstName + " " + this.lastName;
  },
  rename: function rename (first, last) {
    this.firstName = first;
    this.lastName = last;
    return this;
  }
}
</code></pre>

<h3 id="prototypes-are-objects">prototypes are objects</h3>

<p>If we want to change the behaviour of a JavaScript object, we can add, remove, or modify methods of the object by adding, removing, or modifying the functions bound to properties of the object. This differs from most classical languages, they have a special form (e.g. Ruby's <code class="highlighter-rouge">def</code>) for defining methods.</p>

<p>Prototypes in JavaScript are "just objects," and since they are "just objects," we can add, remove, or modify methods of the prototype by adding, removing, or modifying the functions bound to properties of the prototype.</p>

<p>That's exactly what the ECMAScript 5 code above does, and the ECMAScript 2015 <code class="highlighter-rouge">class</code> syntax "desugars" to equivalent code.</p>

<p>Prototypes being "just objects" means we can use any technique that works on objects on prototypes. For example, instead of binding functions to a prototype one-at-a-time, we can bind them <em>en masse</em> using <code class="highlighter-rouge">Object.assign</code>:</p>

<pre><code>function Person (first, last) {
  this.rename(first, last);
}

Object.assign(Person.prototype, {
  fullName: function fullName () {
    return this.firstName + " " + this.lastName;
  },
  rename: function rename (first, last) {
    this.firstName = first;
    this.lastName = last;
    return this;
  }
})
</code></pre>

<p>And of course, we could use compact method syntax<sup id="fnref:super"><a href="#fn:super" class="footnote">1</a></sup> if we like:</p>

<pre><code>function Person (first, last) {
  this.rename(first, last);
}

Object.assign(Person.prototype, {
  fullName () {
    return this.firstName + " " + this.lastName;
  },
  rename (first, last) {
    this.firstName = first;
    this.lastName = last;
    return this;
  }
})
</code></pre>

<h3 id="mixins">mixins</h3>

<p>Since <code class="highlighter-rouge">class</code> desugars to constructor functions and prototypes, we can mix and match techniques:</p>

<pre><code>class Person {
  constructor (first, last) {
    this.rename(first, last);
  }
  fullName () {
    return this.firstName + " " + this.lastName;
  }
  rename (first, last) {
    this.firstName = first;
    this.lastName = last;
    return this;
  }
};

Object.assign(Person.prototype, {
  addToCollection (name) {
    this.collection().push(name);
    return this;
  },
  collection () {
    return this._collected_books || (this._collected_books = []);
  }
})
</code></pre>

<p>We have just "mixed" methods concerned with collecting books into our <code class="highlighter-rouge">Person</code> class. It's great that we can write code in a very "point-free" style, but naming things is also great:</p>

<pre><code>const BookCollector = {
  addToCollection (name) {
    this.collection().push(name);
    return this;
  },
  collection () {
    return this._collected_books || (this._collected_books = []);
  }
};

class Person {
  constructor (first, last) {
    this.rename(first, last);
  }
  fullName () {
    return this.firstName + " " + this.lastName;
  }
  rename (first, last) {
    this.firstName = first;
    this.lastName = last;
    return this;
  }
};

Object.assign(Person.prototype, BookCollector);
</code></pre>

<p>We can do this as much as we like:</p>

<pre><code>const BookCollector = {
  addToCollection (name) {
    this.collection().push(name);
    return this;
  },
  collection () {
    return this._collected_books || (this._collected_books = []);
  }
};

const Author = {
  writeBook (name) {
    this.books().push(name);
    return this;
  },
  books () {
    return this._books_written || (this._books_written = []);
  }
};

class Person {
  constructor (first, last) {
    this.rename(first, last);
  }
  fullName () {
    return this.firstName + " " + this.lastName;
  }
  rename (first, last) {
    this.firstName = first;
    this.lastName = last;
    return this;
  }
};

Object.assign(Person.prototype, BookCollector, Author);
</code></pre>

<h3 id="why-we-might-want-to-use-mixins">why we might want to use mixins</h3>

<p>Composing classes out of base functionality (<code class="highlighter-rouge">Person</code>) and mixins (<code class="highlighter-rouge">BookCollector</code> and <code class="highlighter-rouge">Author</code>) provides several benefits.</p>

<p>First, sometimes functionality does not neatly decompose in a tree-like form. Book authors are sometimes corporations, not persons. And antiquarian book stores collect books just like bibliophiles.</p>

<p>A "mixin" like <code class="highlighter-rouge">BookCollector</code> or <code class="highlighter-rouge">Author</code> can be mixed into more than one class. Trying to compose functionality using "inheritance" doesn't always work cleanly.</p>

<p>Another benefit is not obvious from a toy example, but in production systems classes can grow to be very large. Even if a mixin is not used in more than one class, decomposing a large class into mixins helps fulfil the <a href="https://en.wikipedia.org/wiki/Single_responsibility_principle">Single Responsibility Principle</a>. Each mixin can handle exactly one responsibility. That makes things easier to understand, and much easier to test.</p>

<h3 id="why-this-matters">why this matters</h3>

<p>There are other ways to decompose responsibilities for classes (such as delegation and composition), but the point here is that if we wish to use mixins, it is very simple and easy to do, because JavaScript does not have a large and complicated OOP mechanism that imposes a rigid model on programs.</p>

<p>In Ruby, for example, mixins are easy because a special feature, <em>modules</em> was baked into Ruby from the start. In other OO languages, mixins are difficult, because the class system does not support them and they are not particularly friendly to metaprogramming.</p>

<p>JavaScript's choice to build OOP out of simple parts–objects, functions, and properties–makes the development of new ideas possible.</p>

<p>(discuss on <a href="https://news.ycombinator.com/item?id=9713076">hacker news</a>)</p>

<p>notes:</p>

<div class="footnotes">
  <ol>
    <li id="fn:super">
      <p>There are subtleties involving the <code class="highlighter-rouge">super</code> keyword to consider, but that is not the point of this article.&nbsp;<a href="#fnref:super" class="reversefootnote">↩</a></p>
    </li>
  </ol>
</div>

        </section>
					</div>
				</article>
				<!--================= END :: Tutorial =================-->
				
				<!--================= START :: Tutorial =================-->
				<article>
					<a id="t-81" name="t-81"></a><h1>81 : Introduction to the Principles of Object-Oriented Design. Classes</h1>
					<span class="ref-site">https://www.barbarianmeetscoding.com/blog/2010/12/02/introduction-to-principles-of-object-oriented-design/</span>
					<div class="tutorial__content">
<div class="entry-content"><p><em>This is an article was first published in the antique Barbarian Meets Coding website</em></p>

<p>When you start learning any object-oriented programming language, you usually go through the
very basic OOP concepts: abstraction, encapsulation, messaging, modularity, inheritance and
polymorphism. You learn these concepts, these mechanisms for code reuse and maintainability,
how to use them, the syntax but they don't usually teach you how to leverage them. In other words,
you don't really learn how to use them well. So in this post, I'll try to remedy that by giving an
introduction to <a href="http://butunclebob.com/ArticleS.UncleBob.PrinciplesOfOod" title="The Principles of OOD">the principles of object oriented design</a> as devised by Robert C. Martin (a.k.a. Uncle
Bob).</p>

<h2>Introduction</h2>

<p>I've been thinking it for a while, and I believe it would be a great idea to start a series of posts about
programming best-practices, do's and dont's, conventions, and design patterns, both to create more
awareness and share this wonderful knowledge with other developers that might not have heard of
them yet, and also so I have a nice quick reference that I can come back to at any given time. Let's
jump into it!</p>

<h2>The Principles of Object Oriented Design. Classes</h2>

<p>The principles of object oriented design are condensed under the famous and catchy acronym of
acronyms SOLID which stands for:</p>

<ul>
<li> S – The Single Responsibility Principle (SRP)</li>
<li> O- The Open Closed Principle (OCP)</li>
<li> L – The Liskov Substitution Principle (LSP)</li>
<li> I – The Interface Segretation Principle (ISP)</li>
<li> D – The Dependency Inversion Principle (DIP)</li>
</ul>


<p>These principles represent a set of rules that allows us to improve the way we design and set up the
dependencies between our classes and, in term, allow us to create more flexible, reusable and robust
code. In the next following paragraphs I'll be explaining shortly what they are all about, and how they
can improve the code we write.</p>

<h2>The Single Responsibility Principle</h2>

<blockquote><p>"A class should have one, and only one, reason to change or,<br>there should never be more than one reason for a class to change."</p><footer><strong>Robert C. Martin</strong></footer></blockquote>


<p>This principle is based upon the fact that whenever a class handles more than one responsibility then
there will be more than one reason for it to change. The consequences are pretty clear, if we need
to change a given class for a number of different reasons, then this class is not going to be robust nor
easy to maintain. In this case, there is what we call a coupling of responsibilities that will lead to a
number of problems: modifying one of them, may have a negative effect on the others, it will imply
the need to recompile code that wouldn't be necessary if the responsibilities were decoupled, and
it will allow the client of the class to access other responsibilities which it might not care for, are just
some examples.</p>

<p>Applying this principle, may be hard at first, as we usually tend to group functionalities within our
classes in the abstraction phase of our development cycle, but it is a great guideline nonetheless
when we refactor. Use this principle, and you'll end up with smaller, well-defined, robust and
maintainable classes.</p>

<p>An example of a SRP violation could be a given Rectangle class which has a Draw method and
a CalculateArea method. In this context, the class is handling two responsibilities, it has two
reasons to change and thus is violating SRP. A way to decouple these responsibilities would be to
extract separate interfaces, and make the clients depend upon these interfaces.</p>

<h2>The Open Closed Principle</h2>

<blockquote><p>"You should be able to extend a class behavior, without modifying<br>it.<br>or,<br>A class should be open for extension but closed to<br>modification."</p><footer><strong>Robert C. Martin and Bertrand Meyer</strong></footer></blockquote>


<p>If you have been working in any brand of software development for any reasonable amount of time
you'll have notice that one thing that characterises most projects is that your software, for one
reason or another, is going to change during its life cycle. Thus, it is pretty important to design your
software so it will be flexible (i.e. receives changes well) but also so it is robust (it doesn't break, a
single change doesn't result in an endless chain of changes). The Open Closed Principle does just
that, it leads our efforts when tackling this particular problem, saying that, whenever our application
needs changes, we should never modify old code that already works and is tested, but extend it with
brand new functionalities and code.</p>

<p>The Open Closed Principle is comprised by two main concepts or corollaries:</p>

<ul>
<li>  A class should be open for extension, which basically means that you should be able to
extend the behavior or functionality of this given class.</li>
<li>  A class should be closed for modification, which means that you should never modify the
existing code of a class</li>
</ul>


<p>But how do we obtain classes that adhere to the OCP? How do we achieve this? The answer is
through abstraction. Using interfaces or abstract classes we can define a fixed contract to follow
whilst being able to extend the behavior with as many implementations of those interfaces as we
want or need. It is to be noted though, that designing a class that is completely closed to any possible
change, it is quite an impossible task. Most of the times, you'll have to decide strategically which kind
of changes your class will be prepared to handle (strategic closure).</p>

<p>As Robert C. Martin states, there are a great number of heuristics and common practices we use
daily that derive directly from this principle. For instance, never use global variables, as no module
that depends on a given global variable can be closed in relation to other module that might write
into it. Also, making all members of a class private (alas encapsulation) prevents others classes from
depending on these members and thus closes them.</p>

<p>You can get some extended information within this <a href="http://www.objectmentor.com/resources/articles/ocp.pdf" title="The Open-Closed Principle">OCP article</a>.</p>

<p>As a last note of interest, although I have been mainly talking about classes, you should know that</p>

<p>you can apply the OCP not only to classes, but to any software entity that you can think of, methods,
modules, anything. Use this principle, and you'll improve the maintainability of your code drastically.</p>

<h2>The Liskov Substitution Principle</h2>

<blockquote><p>"Derived classes must be substitutable for their base classes or,<br>What is wanted here is something like the following substitution<br>property: If for each object o1 of type S there is an object o2 of<br>type T such that for all programs P defined in terms of T, the<br>behavior of P is unchanged when o1 is substituted for o2 then S is<br>a subtype of T."</p><footer><strong>Robert C. Martin and Barbara Liskov</strong></footer></blockquote>


<p>As mentioned in the previous section, we make use of abstractions (and polymorphism) to let our
classes adhere to the Open-Closed Principle. In order to make a proper use of inheritance, so our
derived classes will still subscribe to OCP, we guide ourselves by the Liskov Substitution Principle.</p>

<p>The whole point here is that a derived class should work as expected i.e. should behave (at a
minimum common denominator) as portrayed by the base class, so that, classes or methods that
have a reference to the base class, will be able to use instances of the derived classes without being
aware of it(thus avoiding hard-coded dependencies).</p>

<p>If you listen to Hanselminutes podcast featuring Robert C. Martin, Robert puts the classical example
of the Rectangle base class and the Square class that derives from it. So you have a Rectangle class
in your application, and you want to use a new Square class, so you think… well a Square "is-a"
Rectangle isn't it? (it just has the same width and height) So you make it derive from the Rectangle
class and wire it up so when you set the width, the height will be set as well and vice versa. Bang!
Problem is that another developer that is working with Rectangles, doesn't need to know what
Rectangles really are at runtime, but still expects them to behave according to the base class
definition. In this case, Square doesn't conform to LSP and may end up causing problems based on
unfulfilled assumptions. The point here is that, while it is a valid logical premise to relate a square
with a rectangle, it might not be as useful from a code perspective. This example is also known as the
circle-ellipse problem.</p>

<p>This was a pretty subtle violation of LSP. However, in practice, any time you use the common switch
statement to check the type of an object at runtime in order to do this or that, you are violating LSP
and OCP (new derived types will force you to modify that switch block).</p>

<h2>The Interface Segregation Principle</h2>

<blockquote><p>"Make fine grained interfaces that are client specific or, Clients<br>should not be forced to depend upon interfaces that they do not<br>use"</p><footer><strong>Robert C. Martin</strong></footer></blockquote>


<p>This principle may be one of the least importance due to its very focused field of application: fat
interfaces. The whole point is that, when we have a class that has a fat interface (an interface with</p>

<p>a lot of methods) and a series of clients that depend upon this interface, we should refactor our
solution so that, any given client only depends on a new interface that comprises only those methods
of the original interface that the client needs to use. This is, the solution is to group the methods of
the fat interface, into smaller and more cohesive interfaces.</p>

<p>The problem of using fat non-cohesive interfaces is that, they create a coupling between its clients,
i.e. a given client may force changes on the interface that will impact another client even if they use
non-related methods. Again, the solution to this problem is to extract smaller interfaces for each
client to depend upon. This way, changes will be more contained and decoupled, as clients will only
depend on their respective interfaces.</p>

<h2>The Dependency Inversion Principle</h2>

<blockquote><p>"Depend on abstractions, not on concretions or, A. High level<br>modules should not depend upon low level modules. Both should<br>depend upon abstractions. Abstractions should not depend upon<br>details B. Abstraction should not depend upon details. Details<br>should depend upon abstractions."</p><footer><strong>Robert C. Martin</strong></footer></blockquote>


<p>When I introduced the OCP before in this article, I said that the way to implement it was to make
use of abstractions and polymorphism. I also introduced LSP in order to guide the implementation of
inheritance so our derived classes won't break OCP. So, if you use both OCP and LSP strictly, you will
notice how a new pattern or structure emerges from it that can be generalized into what is known as
the Dependency Inversion Principle.</p>

<p>This is one of the most useful principles, as it allow us to design software that is flexible (easy to
change or extend), robust (reacts well to changes i.e. doesn't break everywhere) and reusable (the
parts of the system are very decoupled and we can extract them and use them in other projects),
and whose main aim is to address bad design. The cause of bad designed software – software that
is rigid, fragile and inmobile (opposite to flexible, robust and reusable in this case) – is the heavy
hard-coded dependencies between its modules. These dependencies can in turn force the need of
a cascade of changes when we want to introduce a tiny little change in the system (rigidity), or can
result in a chain of unexpected errors (fragility), and of course, make impossible to reuse code in
other applications because everything is so entwined that we might as well bring together the whole
system.</p>

<p>The DIP addresses this problem saying no to hard-coded and top-down dependencies. The high-
level modules should not depend upon the low-level modules, everything has to depend upon
abstractions (thereby we get and "inverted" dependency). This way, the high level modules don't
know exactly what they depend upon, they just know they are using something that must adhere
to a given interface, and thus, everything that follows that interface contract can be plugged in
(or plugged out). If you extend the principle to the whole system you end up with a set of highly
decoupled modules, that are completely isolated from changes in other modules and that can be
easily reused. You end up with a well defined set of interfaces or abstractions that define the policy
of your system, and a set of concrete implementations that are connected via these abstractions.</p>

<h2>Where Can I Find Out More?</h2>

<p>As you might have inferred already, the main reference within this field is Robert C. Martin. You can
find a lot of extra information and examples at his object-oriented design website and the related
Object Mentor website. You might also want to take a look at his best-practices books:</p>

<ul>
<li>  <a href="http://www.amazon.com/Software-Development-Principles-Patterns-Practices/dp/0135974445" title="Agile Software Development, Principles, Patterns and Practices">Agile Software Development, Principles, Patterns and Practices</a> (C++ and Java)</li>
<li>  <a href="http://www.amazon.com/Agile-Principles-Patterns-Practices-C/dp/0131857258/ref=sr_1_1?s=books&amp;ie=UTF8&amp;qid=1339374918&amp;sr=1-1" title="Agile Principles, Patterns and Practices in C#">Agile Principles, Patterns and Practices in C#</a></li>
</ul>


<p>And last but not least, there is also a very interesting <a href="http://hanselminutes.com/145/solid-principles-with-uncle-bob-robert-c-martin" title="Hanselminutes with Robert C. Martin on SOLID">Hanselminutes podcast</a> featuring Uncle Bob and
the SOLID principles.</p>

<h2>Afterword</h2>

<p>So, I hope you have enjoyed this introduction to the principles of OOD, and learnt a little in the
process. I'll be writing more best-practices stuff in the non-too-distant future ^_^.</p>
</div>
					</div>
				</article>
				<!--================= END :: Tutorial =================-->
				
				<!--================= START :: Tutorial =================-->
				<article>
					<a id="t-82" name="t-82"></a><h1>82 : Object-oriented JavaScript for C# Developers</h1>
					<span class="ref-site">https://www.barbarianmeetscoding.com/blog/2014/08/20/object-oriented-javascript-for-c-sharp-developers/</span>
					<div class="tutorial__content">
<div class="entry-content">

<p>Through the last couple of years I have been working on improving my JavaScript-Fu. From looking down at JavaScript with contempt, I have come to love the language and its little idiosyncrasies. In this article, I will attempt to write the article I would have loved to read, the first time I set my mind to re-learn JavaScript the proper way.</p>

<p>Ey You C# developer! Wanting to learn you some JavaScript? You've come to the right place! In this article you will learn how to map all those OOP C# concepts you have come to know and love to JavaScript, the ever growing language of the web! I will help you traverse the waters of Object-oriented programming by going through the pillars of OOP (<em>encapsulation</em>, <em>inheritance</em> and <em>polymorphism</em>) and trying to work out how they can be achieved in JavaScript.</p>

<p><em>Note: In this article I will use two types of code samples. Some that you can type in a text editor, and others that you can run directly in any JavaScript REPL (in the Chrome Dev Tools console for instance). In these second type of examples every line will be preceded by a <code>&gt;</code> followed by the result of evaluating an statement, and that's how you will be able to differentiate them. I recommend the Chrome Dev Tools REPL (Console) because it will let you copy/paste even the first type – biggish – code examples on the REPL.</em></p>

<h2>Encapsulation</h2>

<blockquote><p>Encapsulation is the packing of data and functions into a single component.</p><footer><strong>Wikipedia - Encapsulation</strong> <cite><a href="http://en.wikipedia.org/wiki/Encapsulation_(object-oriented_programming)">en.wikipedia.org/wiki/…</a></cite></footer></blockquote>


<p>The easiest way to achieve encapsulation in JavaScript is by using <a href="https://developer.mozilla.org/en/docs/Web/JavaScript/Guide/Values,_variables,_and_literals#Object_literals">object literals</a>:</p>

<pre><code>var conan = {
    name: "Conan, The Barbarian",
    "character class": "barbarian",
    hp : 200,
    weapons: [{
        name: "two-handed sword",
        type: "sword",
        damage: "2d20+10",
        material: "cimmerian steel",
        status: "well maintained",
        equipped: true
    }],
    talk: function(){ console.log("I am " + this.name + " !!!");}
}
</code></pre>


<p>This will look familiar to you since we also have object literals in C#:</p>

<pre><code>var conan = new Barbarian
    {
    Name = "Conan, The Barbarian",
    CharacterClass = "barbarian",
    Hp = 200,
    Weapons = new List&lt;Weapon&gt;
    {
        new Weapon {
            Name = "Two-handed sword",
            Type = "sword",
            ...
        }
    }
};

// Somewhere else we have the class definition
public class Barbarian{
    public string Name {get; set;}
    public string CharacterClass {get; set;}
    ...
}
</code></pre>


<p>However if you look closely at the JavaScript example you will notice that there's no class identifier. What!? Welcome to the Jungle! There are no classes in JavaScript! (<a href="#appendix-a-classes-in-javascript-welcome-ECMAScript-6">Although that may not hold true soon enough…</a>).</p>

<p>An object literal in JavaScript is an easy way to create a single instance of an object with whichever arbitrary properties that you desire. All object literals and (all objects in JavaScript for that matter) are instances of the base <code>Object</code> type.</p>

<pre><code>&gt; var conan = {
    name: "conan"
};
undefined
&gt; conan instanceof Object
true
</code></pre>


<p>Ok, so what happens if you want to create multiple similar objects? Do you need to instantiate them via literal objects one at a time? Nope, JavaScript provides <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Inheritance_and_the_prototype_chain#With_a_constructor">Constructor Functions</a> for just this purpose.</p>

<h3>Constructor Functions</h3>

<p>Constructor functions are JavaScript functions that allow us to create multiple instances which share the same properties. They work as a recipe for object creation and they represent a custom type (<em>yep, this starts feeling like a class</em>). Let's see an example!:</p>

<pre><code>function Barbarian(name){
    this.name = name;
    this["character class"] = "barbarian";
    this.hp = 200;
    this.weapons = [];
    this.talk = function(){
        console.log("I am " + this.name + " !!!");
    };
    this.equipWeapon = function(weapon){
        weapon.equipped = true;
        this.weapons.push(weapon);
    };
}
</code></pre>


<p>Notice how the constructor, not only initializes an object with a set of values like in C#, but it also determines which properties an object is going to have. Effectively it works both as a <em>constructor</em> and a <em>class</em> definition (if we were to draw a parallelism with C#).</p>

<p>To create a new instance of a <code>Barbarian</code> we use the <code>new</code> keyword just like in C#:</p>

<pre><code>var conan = new Barbarian("Conan, the Barbarian");
conan.equipWeapon({
        name: "two-handed sword",
        type: "sword",
        damage: "2d20+10",
        material: "cimmerian steel",
        status: "well maintained"
    });
</code></pre>


<p>This new instance is of type <code>Barbarian</code> and all its properties are publicly available:</p>

<pre><code>&gt; var conan = new Barbarian("Conan, the Barbarian");
undefined
&gt; conan instanceof Barbarian
true
&gt; conan instanceof Object
true
&gt; conan.talk();
I am Conan, the Barbarian!!!
&gt; conan.name;
"Conan, The Barbarian"
&gt; conan.weapons;
[]
</code></pre>


<h3>Data/Information Hiding</h3>

<blockquote><p>Information hiding is the principle of segregation of the design decisions in a computer program that are most likely to change, thus protecting other parts of the program from extensive modification if the design decision is changed.</p><footer><strong>Wikipedia - Information hiding</strong> <cite><a href="http://en.wikipedia.org/wiki/Information_hiding">en.wikipedia.org/wiki/…</a></cite></footer></blockquote>


<p>In the previous function constructor example we saw how all properties that we defined in the constructor function where publicly available. We may not want to have all our object implementation details out in the open, right? How do we then achieve private properties in JavaScript? We take advantage of <strong><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Closures">closures</a></strong>, <em>functions that refer to <a href="http://c2.com/cgi/wiki?FreeVariable">free variables</a> from an outer scope</em>.</p>

<p>We have closures in C# so I will not delve a lot on them but for this teeny tiny example:</p>

<pre><code>using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace ConsoleApplication1
{
    class Program
    {
        static void Main(string[] args)
        {
            var Add5 = AddX(5);
            var number = 0;
            Console.WriteLine(string.Format("Initial Number: {0}", number)); // Initial Number: 0
            number = Add5(number);
            Console.WriteLine(string.Format("Add 5 and it becomes: {0}", number)); // Add 5 and it becomes: 5
            number = Add5(number);
            Console.WriteLine(string.Format("Add 5 and it becomes: {0}", number)); // Add 5 and it becomes: 10

            var Add100 = AddX(100);
            number = Add100(number);
            Console.WriteLine(string.Format("Add 100 and it becomes: {0}", number)); // Add 100 and it becomes: 110
        }

        /// &lt;summary&gt;
        /// A function that creates another function that adds a given number X to another number
        /// 
        /// The returned function is a closure over the free variable 'x'. As you can see in the
        /// example above, the created function retains the value of the variable it encloses.
        /// &lt;/summary&gt;
        /// &lt;param name="x"&gt;&lt;/param&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        public static Func&lt;int, int&gt; AddX(int x)
        {
            return number =&gt; number + x;
        }

    }
}
</code></pre>


<p>In JavaScript we can create a closure like this:</p>

<pre><code>function Barbarian(name){
    // this variables are only available in the scope
    // of this function.
    // Remember, in JavaScript, only functions create new scopes!
    var weapons = [],
        characterClass = "barbarian",
        hp = 200;

    this.name = name;
    this.talk = function(){
        console.log("I am " + this.name + " !!!");
    };
    this.equipWeapon = function(weapon){
        weapon.equipped = true;
        // Now we reference the weapons variable directly
        // creating a closure.
        // You cannot use this.weapons to access this variable any more
        // It is so private that the only way to access it is via closure
        weapons.push(weapon);
    };
}
</code></pre>


<p>Which makes the <code>weapons</code>, <code>characterClass</code> and <code>hp</code> variables effectively private: <em>They are no longer accessible from the outside</em>.</p>

<pre><code>&gt; var conan = new Barbarian("conan");
undefined
&gt; conan.name;
"conan"
&gt; conan.weapons;
undefined
</code></pre>


<h3>Method Overloading</h3>

<p>There is no such thing as <a href="http://en.wikipedia.org/wiki/Function_overloading">method overloading</a> in JavaScript, or at least <em>method overloading</em> as we know it in C#. If you define a method within an object twice, the second method will overwrite the first (<em>ups!</em>):</p>

<pre><code>&gt; var barbarian = {
    sayHi: function(){console.log("hi!";)},
    sayHi: function(){console.log("WaaaaZaaaa!");}
}
undefined
&gt; barbarian.sayHi();
"WaaaaZaaaa!"
</code></pre>


<p>In fact, you can call any function with any number of arguments and JavaScript will just run with it:</p>

<pre><code>&gt; var barbarian = {
    sayHi: function(){console.log("hi!";)},
    sayHi: function(message, message2){console.log("hi! " + message + ", " + message2);}
}
undefined
&gt; barbarian.sayHi();
"hi! undefined, undefined"
&gt; barbarian.sayHi("I am Groot!");
"hi! I am Groot!, undefined"
&gt; barbarian.sayHi("I am Groot!", "Waaaaa....")
"hi! I am Groot!, Waaaaa...."
</code></pre>


<p>How do we then provide support for method overloading in JavaScript? Well, we handle it in kind of a rudimentary way. Every function scope in JavaScript has a special variable called <code>arguments</code>, which <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Functions_and_function_scope/arguments">behaves sort of like an array, but it is not an array</a>, which contains all arguments passed to the function, and which can be used in the fashion below to mimic method overloading:</p>

<pre><code>&gt; var barbarian = {
    sayHi: function(){
        var args;
        if (arguments.length === 0) {
            console.log("hi!");
        }
        if (arguments.length === 1){
            console.log(arguments[0]);
        }
        if (arguments.length &gt; 1){
            // this is like type casting the arguments array-like variable
            // to an actual array so that I can use the join method
            args = Array.prototype.slice.call(arguments);
            console.log("hi " + args.join(", "));
        }
    }
}
undefined
&gt; barbarian.sayHi();
hi!
&gt; barbarian.sayHi("I am Groot!");
I am Groot!
&gt; barbarian.sayHi("I am Groot!", "Waaaaa....", "For Great Justice!")
hi! I am Groot!, Waaaaa...., For Great Justice!
</code></pre>


<ul>
<li><strong>Fun Fact</strong>: the <code>length</code> property of any function returns the number of arguments it expects (<em>its arity</em>). Isn't that unexpected? XD</li>
</ul>


<h3>Object Augmentation</h3>

<p>An interesting feature of JavaScript is that you can add or remove properties from objects at any point in time. This enables interesting object composition patterns like <a href="http://addyosmani.com/resources/essentialjsdesignpatterns/book/#mixinpatternjavascript">mixins</a>.</p>

<p>You can add new properties to any object by using the <code>.</code> notation:</p>

<pre><code>&gt; var conan = { name : "conan"};
undefined
&gt; conan.title = "the barbarian";
undefined
&gt; conan.title
the barbarian
&gt; conan.sayHi = function(){console.log("HI! I am " + this.name + ", " + this.title)};
undefined
&gt; conan.sayHi()
Hi! I am conan, the barbarian
</code></pre>


<p>And remove properties by using the <code>delete</code> keyword:</p>

<pre><code>&gt; var conan = { name : "conan"};
undefined
&gt; conan.name
conan
&gt; delete conan.name
true // delete always returns true
&gt; conan.name
undefined
</code></pre>


<h2>Inheritance</h2>

<blockquote><p>In object-oriented programming (OOP), inheritance is when an object or class is based on another object or class, using the same implementation (inheriting from a class) or specifying implementation to maintain the same behavior (realizing an interface; inheriting behavior). It is a mechanism for code reuse and to allow independent extensions of the original software via public classes and interfaces.</p><footer><strong>wikipedia - Inheritance</strong> <cite><a href="http://en.wikipedia.org/wiki/Inheritance_(object-oriented_programming)">en.wikipedia.org/wiki/…</a></cite></footer></blockquote>


<p><a href="http://en.wikipedia.org/wiki/Inheritance_(object-oriented_programming">Inheritance</a> in JavaScript is slightly different than what we are accostumed to in C#. For one, there are no classes (<em>ouch!</em>), furthermore, inheritance doesn't play as big a part in polymorphism since JavaScript is a dynamically typed language that relies in <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Inheritance_and_the_prototype_chain">duck typing</a> instead (as we will see in the next section). JavaScript is all about objects, and achieves inheritance not via class inheritance but via <strong><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Inheritance_and_the_prototype_chain">prototypical inheritance</a></strong>, that is, objects that inherit from other objects which act as prototypes (a sort of blueprint).</p>

<h3>Prototypes</h3>

<p>Every function in javascript has a <code>prototype</code> property that holds an object that will act as a <em>prototype</em> – will provide shared properties – for all objects created via that function and the <code>new</code> keyword. The <code>prototype</code> object has in its turn a <code>constructor</code> property that points back to the <em>constructor</em> function:</p>

<pre><code>&gt; function Barbarian(name) { this.name = name; }
undefined
&gt; Barbarian.prototype
Barbarian {}
&gt; Barbarian.prototype.constructor
function Barbarian(name) { this.name = name; }
&gt; Barbarian.prototype = {}
undefined
&gt; Barbarian.prototype
</code></pre>


<p>In the simplest inheritance scenario, you can create an inheritance hierarchy by setting the <code>prototype</code> property of a <code>constructor</code> function. By doing that, all objects instantiated using that <code>constructor</code> function will inherit properties and methods from the <code>prototype</code> object:</p>

<pre><code>&gt; function Barbarian(name){ this.name = name; }
undefined
&gt; Barbarian.prototype.sayHi = function (){ console.log("Hi! I am " + this.name);}
undefined
&gt; var krull = new Barbarian("krull");
undefined
&gt; krull.sayHi()
Hi! I am krull
</code></pre>


<p>In a more common scenario you may have several custom prototypes in your inheritance hierarchy:</p>

<pre><code>// Inheritance Hierarchy:
//   Barbarian -&gt; DrawableGameObject -&gt; GameObject -&gt; Object

function GameObject(){
    // game object ctor  
}
function DrawableGameObject(){
    // drawable object ctor
}

DrawableGameObject.prototype = Object.create(GameObject.prototype);
DrawableGameObject.constructor = DrawableGameObject;

function Barbarian(){
    // barbarian ctor
}
Barbarian.prototype = Object.create(DrawableGameObject.prototype);
Barbarian.prototype.constructor = Barbarian;
</code></pre>




<pre><code>// copy paste code from the example of the Chrome Dev Tools console
&gt; var conan = new Barbarian();
undefined
&gt; conan instanceof Barbarian
true
&gt; conan instanceof DrawableGameObject
true
&gt; conan instanceof GameObject
true
</code></pre>


<p>It is important to note that each property defined in the <code>constructor</code> function will be part of every single object instance, whilst each property defined in the <code>prototype</code> will be shared amongst all object instances. Again:</p>

<ul>
<li><code>constructor</code> properties and methods are defined in each instance</li>
<li><code>prototype</code> properties and methods are only defined in the prototype. This emulates <code>static</code> variables <del>properties</del>. Methods can still refer to a particular instance by using the <code>this</code> keyword.</li>
</ul>


<p>A common idiom to avoid needing to write the <code>Function.prototype.property</code> each time you want to update the prototype is to assign the <em>prototype</em> to a new object:</p>

<pre><code>&gt; function Barbarian(name){ this.name = name; }
undefined
&gt; Barbarian.prototype = {
  constructor: Barbarian
  sayHi: function(){console.log("Hi! I am " + this.name);}
}
undefined
&gt; var conan = new Barbarian("conan");
undefined
&gt; conan.sayHi()
Hi! I am conan
&gt; conan instanceof Barbarian
true
</code></pre>


<p>In summary once more, because this was weird as hell the first time I saw it, <strong>to emulate a C# class you would need to create a <code>constructor</code> function that will contain the specific properties of each particular instance and a <code>prototype</code> that will provide a series of shared methods and static members that will be shared across of all instances of a given type</strong>.</p>

<p><img class="center" src="https://www.barbarianmeetscoding.com/images/c-sharp-class-equivalent-to-javascript-constructor-plus-prototype.jpg" title="A C# class is equivalent to a javascript constructor and prototype pair" alt="A C# class is equivalent to a javascript constructor and prototype pair"></p>

<h3>The Prototype Chain</h3>

<p>When we use prototype inheritance as a method of code reuse, to reduce duplication and optimize memory, a prototype chain is built between object and the different prototypes in the inheritance hierarchy. When we call a method on a particular object instance, the JavaScript runtime tries to find that method in the object itself and if it can't find it, it follows the prototype chain until it does:</p>

<pre><code>&gt; function Barbarian(name){this.name = name;}
undefined
&gt; Barbarian.prototype.ravage = function(){console.log(this.name + "attaaaaack!!");}
undefined
&gt; var conan = new Barbarian("conan");
undefined
&gt; conan isintanceof Barbarian
true
&gt; Barbarian.prototype.isPrototypeOf(conan)
true
&gt; conan.ravage === Barbarian.prototype.ravage
true
&gt; conan isintanceof Object
true
&gt; Object.prototype.isPrototypeOf(conan)
true
&gt; conan.toString === Object.prototype.toString
true
</code></pre>


<p>In the example above, we can appreciate how within the <code>conan</code> object instance, the <code>ravage</code> method is part of the <code>Barbarian.prototype</code> and the <code>toString</code> method is part of the <code>Object.prototype</code>.</p>

<p><img class="center" src="https://www.barbarianmeetscoding.com/images/javascript-prototype-chain.jpg" title="JavaScript prototype chain" alt="JavaScript prototype chain"></p>

<h3>Differentiating Between Object Properties and Prototype Properties</h3>

<p>In order to know whether a property is part of the object itself or part of the prototype you can use the <code>hasOwnProperty</code> method:</p>

<pre><code>&gt; function Barbarian(name){this.name = name;}
undefined
&gt; Barbarian.prototype.ravage = function(){console.log(this.name + "attaaaaack!!");}
undefined
&gt; var conan = new Barbarian("conan");
undefined
&gt; conan.hasOwnProperty("name")
true
&gt; conan.hasOwnProperty("ravage")
false
</code></pre>


<h3>Object Augmentation in Prototypes</h3>

<p>In the same way we used object augmentation to add new properties to an object, we can use the same concept to add new properties to a prototype and, hence, make those properties available to any object that has that prototype:</p>

<pre><code>&gt; function Barbarian(name){this.name = name;}
undefined
&gt; var conan = new Barbarian("conan");
undefined
&gt; var logenNinefingers = new Barbarian("The Bloody Nine")
undefined
&gt; var shivers = new Barbarian("Caul Shivers");
undefined
&gt; shivers.ravage
undefined
&gt; Barbarian.prototype.ravage = function(){console.log(this.name + " attaaaaack!!");}
&gt; conan.ravage()
"conan attaaaaack!!"
&gt; logenNinefingers.ravage()
"The Bloody Nine aattaaaaack!!"
&gt; shivers.ravage()
"Caul Shivers attack!!"
</code></pre>


<p>And so, we can see how after adding the <code>ravage</code> method to the prototype, instances of <code>Barbarian</code> that had been created previously, suddenly and auto-ma-gi-ca-lly get a new method. :O</p>

<h3>Method Overriding</h3>

<p>In order to override a method in JavaScript you will need to provide a new implementation of the method in your <code>constructor</code>:</p>

<pre><code>&gt; function Barbarian(name){
    this.name = name;
}
undefined
&gt; var conanTheBarbarian = new Barbarian("Conan The Barbarian");
undefined
&gt; conanTheBarbarian.toString()
"[object Object]"
&gt; function Barbarian(name){
    this.name = name;
    this.toString = function(){
        return "Barbarian: " + name;
    };
}
undefined
&gt; var conanTheDestroyer = new Barbarian("Conan The Destroyer!!!");
undefined
&gt; conan.toString()
"Barbarian: Conan The Destroyer!!!"
</code></pre>


<p>Or in one of the prototypes in the prototype chain:</p>

<pre><code>&gt; function Barbarian(name){
    this.name = name;
}
undefined
&gt; var conan = new Barbarian("Conan The Barbarian");
undefined
&gt; conan.toString()
"[object Object]"
&gt; Barbarian.prototype.toString = function (){
        return "Barbarian: " + name;
};
undefined
&gt; conan.toString()
"Barbarian: Conan The Destroyer!!!"
</code></pre>


<p>This is called <code>shadowing</code> just like in C#. Additionally, you can call your base prototype method by making use of JavaScript <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function/apply">apply</a> and <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function/call">call</a> functions as illustrated in the example below:</p>

<pre><code>// Create an inheritance hierarchy:
//   BarbarianKing -&gt; Barbarian -&gt; Object
function Barbarian(){
    this.title = "the Scavenger from the Highlands"
}
Barbarian.prototype.warCry = function(message){
    console.log(message);
    console.log("Waaaaaaaaaaahhhhh!");
};

function BarbarianKing(){
   this.title = "the King of Thieves";
}
BarbarianKing.prototype = Object.create(Barbarian.prototype);
BarbarianKing.prototype.constructor = BarbarianKing;

// Override method warCry and call method from super prototype
BarbarianKing.prototype.warCry = function(message){
    Barbarian.prototype.warCry.call(this, message);
    console.log("I am the " + this.title + "!!!!");
};
</code></pre>




<pre><code>// execute previous file by copy-pasting on chrome dev tools console
&gt; var conan = new Barbarian()
undefined
&gt; conan.warCry("Good morning, how are you doing good sir? Now Die!")
Good morning, how are you doing good sir? Now Die!
Waaaaaaaaaaaaaaaaah!
&gt; var kingConan = new BarbarianKing()
undefined
&gt; kingConan.warCry("!!!!hhhhhhaaaaaaW")
!!!!hhhhhhaaaaaaW
Waaaaaaaaaaaaaaaaah!
I am the King of the Thieves!
</code></pre>


<p>If you are not familiar with the <code>apply</code> and <code>call</code> methods, you just need to know that they let you call a function and explicitly specify the object that <code>this</code> will refer to within the scope of the function:</p>

<pre><code>&gt; var conan = {
    name: "conan",
    sayHi: function(message){console.log(message + " " + this.name);}
}
undefined
&gt; var logen = {
    name: "logen"
}
undefined
&gt; conan.sayHi("hello I am")
hello I am conan
&gt; conan.sayHi.call(logen, /* message */ "hello I am")
hello I am logen
&gt; conan.sayHi.apply(logen, /*arguments*/["hello I am"])
hello I am logen
&gt; conan.sayHi("hello I am")
hello I am conan
</code></pre>


<p>In the previous example you can see how, even though we have defined the <code>sayHi</code> method in the <code>conan</code> object, by using <code>apply</code> and <code>call</code> we can borrow the method and use it on a different object <code>logen</code>. For additional information, take a look at the awesome MDN docs on <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function/apply">apply</a> and <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function/call">call</a>.</p>

<h3>Emulating Classical Inheritance in JavaScript</h3>

<p>Building on what we have learned so far, we can emulate classical inheritance as we known it in C# by:</p>

<ol>
<li>Making use of <em>prototypical inheritance</em> to ensure that any instance of an object inherits methods from its prototypes</li>
<li>Making sure that each <em>constructor function</em> calls its base type constructor function using <code>call</code> or <code>apply</code> so that any instance of an object contains all properties defined in each and every constructor.</li>
</ol>


<p>I'll illustrate this through an example:</p>

<pre><code>// Inheritance Hierarchy:
//   Barbarian -&gt; DrawableGameObject -&gt; MobileGameObject

function Position(x,y){
    this.x = x;
    this.y = y;
}
Position.prototype.toString = function(){
    return "[" + this.x + "," + this.y + "]";
}

function MobileGameObject(position){
    this.position = position;
}
MobileGameObject.prototype.move = function(newPosition){
    console.log("moving " + this + " to " + newPosition);
    this.position = newPosition;
}

function DrawableGameObject(position, sprite){
    // call base type constructor function
    MobileGameObject.apply(this, position);
    this.sprite = sprite;
}
// establish prototypical inheritance 
// between DrawableGameObject and MobileGameObject
DrawableGameObject.prototype = Object.create(MobileGameObject.prototype);
DrawableGameObject.prototype.constructor = DrawableGameObject;
DrawableGameObject.prototype.draw = function(){
    console.log("drawing sprite: " + this.sprite);
    // draw sprite
};


function Barbarian(name, position, sprite){
    // call base type constructor function
    DrawableGameObject.call(this, position, sprite);
    this.name = name;
}
// establish prototypical inheritance 
// between Barbarian and DrawableGameObject
Barbarian.prototype = Object.create(DrawableGameObject.prototype);
Barbarian.prototype.constructor = Barbarian;
Barbarian.prototype.toString = function(){
    return this.name + "!!!";
};
</code></pre>




<pre><code>// copy paste code from the example of the Chrome Dev Tools console
&gt; var conan = new Barbarian("Conan", new Position(0,0), "conan.jpg");
undefined
&gt; conan.move(new Position(5,5))
moving Conan!!! to [5,5]
&gt; conan.draw()
drawing sprite: conan.jpg
</code></pre>


<h2>Polymorphism<a id="object-oriented-javascript-for-csharp-developers-polymorphism"></a></h2>

<blockquote><p>*Polymorphism* allows a function to be written to take an object of a certain type T, but also work correctly if passed an object that belongs to a type S that is a subtype of T</p><footer><strong>Wikipedia - Polymorphism</strong> <cite><a href="http://en.wikipedia.org/wiki/Polymorphism_(computer_science)">en.wikipedia.org/wiki/…</a></cite></footer></blockquote>


<p>Polymorphism in JavaScript will be the least of your problems. As a dynamically typed language, JavaScript exhibits what is known as <em><a href="http://en.wikipedia.org/wiki/Duck_typing">duck typing</a></em>, whereby an object's semantics are based on the object's own methods and properties and not on the inheritance chain or interface implementations (like in C#).</p>

<p>But this is probably best illustrated through an example. Imagine a roguelike RPG, and a game scene with our mighty hero bravely venturing herself inside an eery dungeon, risking her life for adventure and profit, turning a corner into a host of ravenous ghouls…</p>

<pre><code>function Character(name){
    this.name = "",
    this.draw = function(){ // draw a character }
}
function Zombie(){
    this.eatBrains = function(){ // mmmmm braaains }
    this.draw = function() { // draw a zombie }
}
function Skeleton(){
    this.creepyLaugh = function(){ // muhahahaha }
    this.draw = function() { // draw a skeleton}
}
// etc

var redSonja = new Character("red sonja");
var zombie = new Zombie();
var skeleton = new Skeleton();
// etc

var scene = {
    entities :[
        redSonja, ghouls, zombie, skeleton, orc, dragon, priest, warlock, walls, pottery, tapestries
    ],
    draw() : {
        entities.forEach(function(entity){
            entity.draw(); // duck typing style polymorphism right here
        });
    }
}
</code></pre>


<p>So, as long as an object has the <code>draw</code> method, it will behave as something that can be drawn regardless of inheritance. And thus the popular saying that you may have heard in the past…</p>

<blockquote><p>If it walks like a duck, swims like a duck and quacks like a duck, I call it a duck.</p></blockquote>


<h2>Appendix A. Classes in JavaScript, Welcome ECMAScript 6 <a id="appendix-a-classes-in-javascript-welcome-ECMAScript-6"></a></h2>

<p>Somewhere above in this article I said something like <em>"… there are not such thing as classes in JavaScript…"</em> and I was telling the truth. You may be interesting in knowing that <em>classes</em> are a part of the specification of the next version of JavaScript – ECMAScript6 <em>Harmony</em>.</p>

<pre><code>class MobileGameObject {
  constructor(position) {
    this.position = position;
  }
  move(newPosition) {
    // draw sprite
  }
}

class DrawableGameObject extends MobileGameObject {
  constructor(position, sprite) {
    super(position);
    this.sprite = sprite;
  }
  draw() {
    // draw sprite
  }
}

class Barbarian extends DrawableGameObject {
  constructor(name, sprite) {
    super(new Position(0,0), sprite);
    this.name = name;
  }
  toString(message) {
    //...
  }
}
</code></pre>


<p>It looks awesome, doesn't it? (Even though it is just syntactic sugar over all the concepts you have seen in this article).</p>

<p>For more information regarding ECMAScript 6 <em>Harmony</em> take a look at <a href="https://github.com/lukehoban/es6features#">@lukehoban great summary at GitHub</a></p>

<h2>Appendix B. A Note About <code>this</code> in JavaScript</h2>

<p>To us C# developers used to the reliable value of <code>this</code>, JavaScript can be a little bit crazy and confusing. The only thing you need to know to be able to use <code>this</code> without fear in JavaScript is to forget how it works in C# and understand the following:</p>

<blockquote><p>The `this` parameter refers to an object that's implicitly associated with the function invocation as is termed the *function context*. (…)</p><p>(…)as it turns out, what this parameter points to isn't, as in Java, defined by how the function is declared, but by how it is *invoked*.</p><footer><strong>Secrets of The JavaScript Ninja - The "this" parameter</strong></footer></blockquote>


<p>So:</p>

<ul>
<li>If a function is <em>invoked as a method</em> in the context of an object (e.g. <code>conan.sayHi()</code>) <code>this</code> will point to the object itself. (Like in C#)</li>
<li>If a function is <em>invoked as a function</em> (e.g. helloWorld()) <code>this</code> will be set to <code>window</code>. If you are using <em>strict mode</em> (<code>"use strict";</code>), <code>this</code> will be <code>undefined</code> saving you from unexpected errors.</li>
<li>If a function is <em>invoked as a constructor</em> with the <em>new</em> keyword then <code>this</code> will be a new object.</li>
<li>If a function is <em>invoked with <code>call</code> or <code>apply</code></em> we can set the <code>this</code> to point at whatever our heart desires</li>
</ul>


<pre><code>&gt; var conan = {whosThis : function(){console.log(this);}}
undefined
// 1) invoke as a method
&gt; conan.whosThis()
Object {whosThis: function}
// 2) invoke as a function
&gt; var whosThis = conan.whosThis
undefined
&gt; whosThis()
Window {top: Window, window: Window, location: Location, external: Object, chrome: Object…}
// 3) invoke as a constructor
&gt; var o = new whosThis();
conan.whosThis {}
// 4.a) invoke with call
&gt; whosThis.call({a: "1", b: "2"})
Object {a: "a", b: "b"}
// 4.b) invoke with apply
&gt; whosThis.apply({a: "1", b: "2"})
Object {a: "a", b: "b"}
</code></pre>


<p>For more detailed information about <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/this">the uses of <code>this</code> in JavaScript visit the MDN documentation</a>. In addition to the above, you can use the <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function/bind"><code>bind</code></a> method to create functions that are for ever bound to a specific object.</p>

<h2>In Closing</h2>

<p>So finally! Now that you are able to master the unwieldy JavaScript OOP arcane and take advantage of all the <a href="https://leanpub.com/javascript-allonge/read">freedom and craziness</a> this beautiful language has to offer, go off and build something awesome!</p>

<p>Fare thee well friend! ^ _ ^</p>

<p><em>P.S.1. I had envisioned writing something more about higher level constructs to organize your code, and common design patterns, drawing parallels to the .NET world but I fear this article would have become undesirably long. I hope you will share my opinion and won't be to hard on me if I leave it for a future article.</em></p>

<p><em>P.S.2. Still Not Liking JavaScript? Take a look at <a href="http://www.typescriptlang.org/">TypeScript</a> then! :)</em></p>
</div>
					</div>
				</article>
				<!--================= END :: Tutorial =================-->
				
				<!--================= START :: Tutorial =================-->
				<article>
					<a id="t-83" name="t-83"></a><h1>83 : The Basic Ingredients of JavaScript-Mancy: An Introduction to JavaScript and ES 6 for C# Developers</h1>
					<span class="ref-site">https://www.barbarianmeetscoding.com/blog/2015/09/06/the-basic-ingredients-of-javascript-mancy-an-introduction-to-javascript-and-ecmascript-6-for-c-sharp-developers/</span>
					<div class="tutorial__content">
<div class="entry-content">

<p>Hi All! I am going to transmute <a href="https://leanpub.com/javascriptmancy-mastering-arcane-art-of-writing-awesome-javascript-for-csharp-developers">the JavaScript-mancy series into book format</a> and write the missing/ultimate JavaScript manual for C# developers with a pinch of humor and a bit of fantasy in the mix.</p>



<p>I'll bring you more news soon! In the meantime, the following is a draft of the first chapter of the book. Enjoy! And feedback is always welcomed!</p>

<h2>An Introduction to JavaScript-Mancy</h2>

<p>I expect the reader of this manuscript to be well acquainted with the basics of programming, but I couldn't, in good faith, start the series without some sort of introduction to the arts of JavaScript. This first chapter therefore, will take you through the whole breadth of the JavaScript language, albeit in a superficial way. I will show you all the basic features of JavaScript, even those of its latest incarnation ECMAScript 6, and how they differ or are similar to C#. I abhorr starting a series with pages after pages on <code>for</code> loops and <code>if</code> statements so I will attempt to be as interesting, short and sweet and entertaining as I can.</p>

<!-- more -->


<h2>JavaScript</h2>

<p>JavaScript, as we the guardians of JavaScript-mancy usually call the arts, is a multi-paradigm dynamic programming language. The multi-paradigm bit means that JavaScript lends itself well to different styles (paradigms) of programming like object-oriented or functional programming. The dynamic part means that… well the dynamic part is widely disputed even today… but for all intents and purposes we can say that JavaScript is evaluated as it is executed, there's no compilation step in which variables are bound, types are checked and expressions analyzed for correctness. The JavaScript runtime defers all this work until the code itself is being executed and this allows for a lot more freedom and interesting applications like metaprogramming <sup id="fnref:1"><a href="#fn:1" rel="footnote">1</a></sup>.</p>

<p>JavaScript is also <strong>dynamically typed</strong> so a variable can reference many different types during its lifetime and you can augment objects with new methods or properties at any point in time.</p>

<p>I can summon a minion from the depths of hell, for example, and let it be a number using the <code>var</code> keyword:</p>

<pre><code>&gt; var minion = 1
&gt; minion
// =&gt; 1
</code></pre>


<p>And I can do some alchemy thereafter and transform the minion into something else, a string, for example:</p>

<pre><code>&gt; minion = "bunny";
// =&gt; "bunny"
</code></pre>


<p>I can keep doing that for as long as I want (as long as I have enough mana of course):</p>

<pre><code>&gt; minion = {name: 'bugs', type: 'bunny'};
// =&gt; Object {name: 'bugs', type: 'bunny'}
</code></pre>


<p>An object in JavaScript isn't defined by a blueprint class like in C# and I can augment <sup id="fnref:2"><a href="#fn:2" rel="footnote">2</a></sup> it with new properties to my heart's content:</p>

<pre><code>&gt; minion.description = 'A mean looking bunny';
&gt; console.log(minion);
// =&gt; Object {name: bugs, type: bunny, description: A mean looking bunny}
</code></pre>


<h2>JavaScript Has Some Types</h2>

<p>JavaScript supports the following types: <code>Number</code>, <code>String</code>, <code>Object</code>, <code>Boolean</code>, <code>undefined</code>, <code>null</code> and <code>Symbol</code>.</p>

<p>As you may have guessed, JavaScript has a single type to represent all numbers, which is pretty nice if you ask me, not having to ever think about doubles, and shorts, and longs and floats…</p>

<pre><code>&gt; var one = 1
&gt; typeof(one)
// =&gt; "number"

&gt; var oneAndAHalf = 1.5
&gt; typeof(1.5)
// =&gt; "number"
</code></pre>


<p>There's a string type that works as you would expect of any respectable string letting you store string literals. Interestingly enough, JavaScript strings support both single (<code>'</code>) and double quotes (<code>'</code>):</p>

<pre><code>&gt; var text = "Thou shalt not pass!"
&gt; text
// =&gt; "string"

&gt; var anotherBitOfText = 'No! Thou Shalt Not Pass!'
&gt; anotherBitOfText
// =&gt; "string"
</code></pre>


<p>It has a boolean type to represent <code>true</code> and <code>false</code> values:</p>

<pre><code>&gt; var always = true
&gt; var never = false
&gt; typeof(always)
// =&gt; "boolean"
</code></pre>


<p>And an object type that we can use to create any new custom types:</p>

<pre><code>&gt; var skull = {name: 'Skull of Dark Magic'}
&gt; typeof(skull)
// =&gt; object
</code></pre>


<p>In a little bit uncommon fashion, JavaScript has two different ways of representing the lack of something. Where C# has <code>null</code>, JavaScript has both <code>null</code> and <code>undefined</code>. Unlike in C#, the default value of anything that hasn't been yet defined is <code>undefined</code>, whereas <code>null</code> must be set explicitly.</p>

<pre><code>&gt; skull.description
// =&gt; undefined
&gt; typeof(skull.description)
// =&gt; undefined

&gt; skull.description = null;
&gt; typeof(skull.description)
// =&gt; object :) 
</code></pre>


<p>ECMAScript 6 brings a new primitive type, the symbol. Symbols can be seen as constant and immutable tokens that can be used as unique IDs.</p>

<pre><code>&gt; var crux = Symbol()
&gt; typeof(crux)
// =&gt; symbol
</code></pre>


<p>In future posts, we'll see how we can use Symbols to enable new patterns for hiding data in JavaScript.</p>

<h3>Everything Within JavaScript Behaves Like an Object</h3>

<p>In spite of JavaScript not having the concept of value types or reference types, numbers, strings and booleans behave like C# value types and objects behave like C# reference types. In practice, however, everything within JavaScript can be treated as an object.</p>

<p>Numbers for instance, provide several useful methods:</p>

<pre><code>&gt; (1).toString()
// =&gt; 1
&gt; (3.14159).toPrecision(3)
// =&gt; 3.141
&gt; (5000).toLocaleString('sv-SE')
// =&gt; 5 000
</code></pre>


<p>And so do strings:</p>

<pre><code>&gt; "a ghoul".toUppercase()
// "A GHOUL"
</code></pre>


<p>Interesting right? If a number is a primitive value type, how come it has methods? Well, what is happening is that, whenever we call a method on a number or other primitive type, the JavaScript runtime is wrapping the primitive value in a special wrapper object. So even though <code>1</code> is not an object itself, when JavaScript evaluates <code>(1).toPrecision(3)</code> it wraps the value within the <code>Number</code> object on-the-fly. You can test the reverse process and instantiate a number using the wrapper object directly:</p>

<pre><code>&gt; var number = new Number(1);
// =&gt; Number {}
&gt; typeof(number)
// =&gt; 'object'
</code></pre>


<p>Then unwrap the original value with <code>valueOf</code>:</p>

<pre><code>&gt; number.valueOf()
// =&gt; 1
</code></pre>


<p>Even more remarkable than numbers and strings, <strong>functions behave like objects</strong>. They have their own methods:</p>

<pre><code>&gt; var fireBall = function(){ world.spell('A blazing ball of fire materializes from the palm of your hand!');};
&gt; fireBall.apply
// =&gt; function apply(){}
</code></pre>


<p>And you can even add properties to a function:</p>

<pre><code>&gt; fireBall.maxNumberOfCharges = 5
// =&gt; 5;
&gt; fireBall.maxNumberOfCharges
// =&gt; 5;
</code></pre>


<p>Let's take a quick look at each one of these types and how they work in JavaScript.</p>

<h2>Strings in JavaScript</h2>

<p>Strings, like in C#, let you represent text literals.</p>

<pre><code>&gt; "hi there"
// =&gt; hi there
&gt; "creepy"
// =&gt; creepy
&gt; "stop repeating what I say"
// =&gt; stop repeating what I say
</code></pre>


<p>Unlike in C# you can use both single (<code>'</code>) and double quotes (<code>"</code>) to create a string. Oftentimes you will see one used to escape the other:</p>

<pre><code>&gt; "this ain't cool man"
// =&gt; this ain't cool man
&gt; 'you think you are so "funny"'
// =&gt; you think you are so "funny"
</code></pre>


<p>Any string has a number of useful methods:</p>

<pre><code>&gt; "I am tired of you devious REPL".split(' ');
// =&gt; ["I", "am", "tired", "of", "you", "devious", "REPL"]
&gt; "I am tired of you devious REPL".replace('tired', 'ecstatic');
// =&gt; I am ecstatic of you devious REPL
&gt; "I am tired of you devious REPL".indexOf('tired');
// =&gt; 5
</code></pre>


<p>ES6 also brings a number of new methods like <code>startsWith</code>, <code>endsWith</code>, <code>repeat</code>:</p>

<pre><code>&gt; "Stop REPL!".startWith("Stop");
// =&gt; true
&gt; "Stop REPL!".endsWith("REPL!");
// =&gt; true
&gt; "NaN".repeat(10) + " BatMan!!!"
// =&gt; NaNNaNNaNNaNNaNNaNNaNNaNNaNNaN BatMan!!!!
&gt; "ha! Now I beat you at your own game!"
// =&gt; "ha! Now I beat you at your own game!"
</code></pre>


<p>Until recently, there was no such thing as C# <code>String.format</code> nor <code>StringBuilder</code> so most injecting values in strings was done using the <code>+</code> operator or <code>string.concat</code>:</p>

<pre><code>&gt; var target = 'minion';
&gt; "obliterate " + target + " with hellfire!"
// =&gt; obliterate minion with hellfire!
&gt; "obliterate ".concat(target, " with hellfire!")
// =&gt; obliterate minion with hellfire!
</code></pre>


<p>Fortunately, ES6 brings <em>template strings</em> with much more elegant approach to string interpolation.</p>

<h3>Better String Interpolation ES6 Template Strings</h3>

<p>The new <strong>ES6 Template Strings</strong> improve greatly the way you can operate with strings. They allow string interpolation based on the variables that exist in the scope where the template is evaluated, thus providing a much cleaner and readable syntax.</p>

<p>In order to create a template string you surround the string literal with backticks <code>`` and use</code>${variable-in-scope}` to specify which variable to include within the resulting string:</p>

<pre><code>&gt; var spell = 'hellfire';
&gt; `obliterate ${target} with ${spell}!`
// =&gt; obliterate minion with hellfire!
</code></pre>


<p>Template strings also let you easily create multi-line strings. Whereas before you would be forced to make use of string concatenation and the new line character <code>\n</code>:</p>

<pre><code>&gt; "One ring to rull them all\n" +
  "One ring to find them;\n" +
  "One ring to bring them all\n" +
  "and in the darkness bind them"
// =&gt;  One ring to rull them all
       One ring to find them;
       One ring to bring them all
       and in the darkness bind them
</code></pre>


<p>ES6 Template strings let you write a multi-line string in a much more straightforward fashion:</p>

<pre><code>&gt; `One ring to rull them all
  One ring to find them
  One ring to bring them all
  and in the darkness bind them`
// =&gt;  One ring to rull them all
       One ring to find them;
       One ring to bring them all
       and in the darkness bind them
</code></pre>


<h2>Functions in JavaScript</h2>

<p>Functions are the most basic building component in JavaScript. As such, they can live more independent lives than methods in C# which are always tied to a class. So, you'll oftentimes see functions alone in the wild:</p>

<pre><code>&gt; function obliterate(target){
    console.log(`${target} is obliterated into tiny ashes`);
}
&gt; obliterate('rabid bunny')
// =&gt; rabid bunny is obliterated into tiny ashes
</code></pre>


<p>In JavaScript, in a radically different approach to C#, lets you call a function with any number of arguments, even if they are not defined in a functions signature:</p>

<pre><code>&gt; obliterate('rabid bunny', 'leprechaun', 'yeti')
// =&gt; rabid bunny is obliterated into tiny ashes
</code></pre>


<p>And even with no arguments at all, although depending on the function implementation it may cause some chaos and some mayhem:</p>

<pre><code>&gt; obliterate()
Uncaught ReferenceError: hello is not defined
</code></pre>


<p>You can use the very special <code>arguments</code> array-like object to get hold of the arguments being passed at runtime to a given function:</p>

<pre><code>&gt; function obliterateMany(){
    // ES6 method to convert arguments to an actual array
    var targets = Array.from(arguments).join(', ');
    console.log(`${targets} are obliterated into tiny ashes`);
}
&gt; obliterate('Rabid bunny', 'leprechaun', 'yeti')
// =&gt; Rabit bunny, leprechaun, yeti are obliterated into tiny ashes
</code></pre>


<p>Or the finer <strong>ES6 rest syntax</strong> reminescent of C# <code>params</code>:</p>

<pre><code>&gt; function obliterateMany(...targets){
    var targets = Array.from(arguments).join(', ');
    console.log(`${targets} are obliterated into tiny ashes`);
}
&gt; obliterate('Rabid bunny', 'leprechaun', 'yeti')
// =&gt; Rabit bunny, leprechaun, yeti are obliterated into tiny ashes
</code></pre>


<p>In addition to functions working as… well… functions, functions perform many other roles in JavaScript and are oftentimes used as building blocks to achieve higher-order abstractions: they are used as object constructors, to define modules, as a means to achieve data hiding and have many other uses.</p>

<p>ES6 changes this complete reliance in functions a little bit as it provides new higher level constructs that are native to the language, constructs like <strong>ES6 classes</strong> and <strong>ES6 modules</strong> which you'll be able to learn more about within future posts in this series. Indeed throughout this manuscript I'll show you both ES5 constructs, the present and the past, and ES6 ones, the present-ish and the future, so you can defend yourselve equally well in any JavaScript codebase you happen to work with.</p>

<h3>Functions as Values</h3>

<p>An interesting and very important aspect of functions in javascript is that they can be treated as values, this is what we mean when we say <strong>functions are first-class citizens</strong> of the language. It means that they are not some special construct that you can only use in certain places, with some special conditions and grammar. Functions are just like any other type in JavaScript, you can store them in variables, you can pass them as arguments to other functions and you can return them from a function.</p>

<p>For instance, let's say you want to create a very special logger that prepends your name to any message that you wish to log:</p>

<pre><code>&gt; var log = function(msg){ console.log(msg);}
&gt; var logByRandalf = function (msg, logFn){
    logFn(Randalf logs: `${msg}`);
}
&gt; logByRandalf('I am logging something, saving it to memory for ever', log);
// =&gt; Randalf logs: I am logging something, saving it to memory for ever
</code></pre>


<p>But that was a little bit awkward, what if we return a function with the new functionality that we desire:</p>

<pre><code>&gt; var createLogBySomeone = function (byWho){
    return function(msg){
        return console.log(Randalf logs: `${msg}`);
    };
}
&gt; var logByRandalf = createLogBySomeone('Randalf');
&gt; logByRandalf('I am logging something, saving it to memory for ever');
// =&gt; Randalf logs: I am logging something, saving it to memory for ever
</code></pre>


<p>If you feel a little bit confused by this don't worry, we will dive deeper into functional programming, closures, high-order functions later within the series and everything will become much clearer then. For now just realize that <strong>functions are values</strong> and you can use them as such.</p>

<h3>JavaScript Has Function Scope</h3>

<p>Another very interesting aspect of JavaScript that is diametrically opposed to how things work in C# is the scope of variables. JavaScript variables have <strong>function scope  and not block scope</strong>. This means that functions define new scopes for variables and not blocks of code (<em>if statements</em>, <em>for loops</em>, *code between <code>{}</code>, etc) which highlights once more the importance of functions in JavaScript.</p>

<p>You can appreciate function scope in all its glory in these examples. First if you declare a single function with an <code>if</code> block you can verify how the <code>if</code> block doesn't define a new scope as you would expect in C#:</p>

<pre><code>&gt; function scopeIsNuts(){ // new scope for scopeIsNuts
    console.log(x); // =&gt; undefined
    if (true){
        var x = 1;
    }
    console.log(x); // =&gt; 1
}
</code></pre>


<p>But if we replace the <code>if</code> block with a new function <code>inner</code>, then we have two scopes:</p>

<pre><code>&gt; function outer(){ // new scope for outer
    var x = 0;
    console.log(x); // =&gt; 0

    function inner(){ // new scope for inner
        var x = 1;
        console.log(x); // =&gt; 1
    }
    inner();

    console.log(x); // =&gt; 0
}
</code></pre>


<h3>ES6 let, ES6 const and Block Scope</h3>

<p>ES6 attemps to bring an end to the confussion of JavaScript having function scope with the <code>let</code> keyword that lets you create variables with block scope. With ES6 you can either use <code>var</code> for function scoped variables or <code>let</code> for block scoped ones.</p>

<p>If you rewrite the example we used to illustrate function scope with <code>let</code>, you'll obtain a very different result:</p>

<pre><code>&gt; function scopeIsNuts(){ // new scope for scopeIsNuts
    console.log(x); // =&gt; undefined
    if (true){
        let x = 1;
        console.log(x); // =&gt; 1
    }
    console.log(x); // =&gt; undefined
}
</code></pre>


<p>Now the <code>x</code> variable only exists within the <code>if</code> statement block. Additionally, you can use the <code>const</code> keyword to declare constant variables with block scope.</p>

<pre><code>&gt; function scopeIsNuts(){ // new scope for scopeIsNuts
    console.log(x); // =&gt; undefined
    if (true){
        const x = 1;
        console.log(x); // =&gt; 1
        x = 2; // =&gt; TypeError
    }
    console.log(x); // =&gt; undefined
}
</code></pre>


<h3>ES6 Default Arguments</h3>

<p>ES6 finally brings default arguments to JavaScript functions, and they work just like in C#:</p>

<pre><code>&gt; function fireBall(target, mana=10){
   var damage = 1.5*mana;
   console.log(`A huge fireball springs from your fingers and hits the ${target} with ${damage} damage`);
}
&gt; fireBall('troll')
// =&gt; A huge fireball springs from your fingers and hits the troll with 15 damage
&gt; fireBall('troll', /* mana */ 50)
// =&gt; A huge fireball springs from your fingers and hits the troll with 75 damage
</code></pre>


<h3>ES6 Destructuring</h3>

<p>Another nifty ES6 feature is destructuring. Destructuring lets you unwrap any given object into a number of properties and bind them to variables of your choice. You can take advantage of destructuring with any object:</p>

<pre><code>&gt; var {hp, defense} = {name: 'conan', description: 'cimmerian barbarian king of thieves', hp: {current: 9000, max: 9000}, defense: 100, attack: 400};
&gt; console.log(hp);
// =&gt; {current: 9000, max: 9000}
&gt; console.log(defense);
// =&gt; 100
</code></pre>


<p>Even when passing an object to a function:</p>

<pre><code>&gt; function calculateDamage({attack}, {hp, defense}){
    var effectiveAttackRating = attack - defense + getHpModifier(hp);
    var damage = attackRoll(effectiveAttackRating);
    return damage;

    function getHpModifier(hp){ return hp.current &lt; 0.1*hp.max ? 10 : 0;}
    function attackRoll(dice){ return dice; } // do some fancy dice rolling 
}
&gt; var troll = {name: 'Aaagghhhh', description: 'nasty troll', hp: {current: 20000, max: 20000}, defense: 40, attack: 100};
&gt; calculateDamage(troll, conan);
// =&gt; 0
// =&gt; no troll gonna damage conan
</code></pre>


<h3>ES6 Arrow Functions</h3>

<p>Another great feature brought by ES6 are arrow functions which resemble C# lambda expressions. Instead of writing the <code>obliterate</code> function as we did before, we can use the arrow function syntax:</p>

<pre><code>/* 
&gt; function obliterate(target){ 
    console.log(`${target} is obliterated into tiny ashes`);
}
*/
&gt; let obliterate = target =&gt; console.log(`${target} is obliterated`);
obliterate('minion');
&gt; obliterate('rabid bunny')
// =&gt; rabid bunny is obliterated into tiny ashes
</code></pre>


<p>And if you have a function with more arguments or statements, you can write it just like we do in C#:</p>

<pre><code>&gt; let obliterateMany = (...targets) =&gt; {
    let targets = targets.join(', ');
    console.log(`${targets} are obliterated into tiny ashes`);
};
&gt; obliterateMany('bunny', 'leprechaun', 'yeti');
// =&gt; Bunny, leprechaun, yeti are obliterated into tiny ashes
</code></pre>


<p>We will dive deeper into arrow functions later within the series and see how they not only provide a terser and more readable syntax but also serve a very important function in what regards to safekeeping the value of <code>this</code> in JavaScript. (We've got ourselves a very naughty <code>this</code> in JavaScript as you'll soon appreciate yourself)</p>

<h2>OOP and Objects in JavaScript</h2>

<p>JavaScript has great support for object-oriented programming with objects literals, constructor functions, prototypical inheritance, ES6 classes and less orthodox OOP paradigms like mixins and stamps.</p>

<p>Objects in JavaScript are just key/value pairs. The simplest way to create an object is using an object literal:</p>

<pre><code>&gt; var scepterOfDestruction = {
    description: 'Scepter of Destruction',
    toString: function() { return this.description; }
    destruct: function(target) { console.log(`${target} is instantly disintegrated`);}
}
&gt; scepterOfDestruction.destruct('apple');
// =&gt; apple is instantly disintegrated
</code></pre>


<p>ES6 makes easier to create object literals with syntactic sugar for functions:</p>

<pre><code>&gt; var scepterOfDestruction = {
    description: 'Scepter of Destruction',
    toString() { return this.description; },
    destruct(target) { console.log(`${target} is instantly disintegrated`);}
}
</code></pre>


<p>And for creating properties from existing variables:</p>

<pre><code>&gt; var damage = 10000;
&gt; var scepterOfDestruction = {
    description: 'Scepter of Destruction',
    damage, // as opposed to damage: damage
    toString() { return this.description; },
    destruct(target) { console.log(`${target} is instantly disintegrated`);}
}
&gt; scepterOfDestruction.damage;
// =&gt; 10000
</code></pre>


<p>This works great for one-off objects. When you want to reuse the same type of object more than once you can either use a vanilla factory method or a constructor function with the <code>new</code> keyword:</p>

<pre><code>// by convention constructor functions are capitalized
&gt; function Scepter(name, damage, spell){
    this.description = `Scepter of ${name}`,
    this.damage = damage;
    this.castSpell = spell;
    this.toString = () =&gt; return this.description;
}
&gt; var scepterOfFire = new Scepter('Fire', 100, (target) =&gt; console.log(`${target} is burnt to cinders`);
&gt; scepterOfFire.castSpell('grunt');
// =&gt; grunt is burnt to cinders
</code></pre>


<h3>Prototypical Inheritance</h3>

<p>Yet another big diffence between C# and JavaScript are their inheritance models. JavaScript exhibits what is know as prototypical inheritance. That means that objects inherit from other objects which therefore are called prototypes. These objects create what is know as a <em>prototypical chain</em> that is traversed when the JavaScript runtime tries to determine where in the chain a given method is defined.</p>

<p>Let's say that you have an object that represents an abstraction for any item that can exist in your inventory:</p>

<pre><code>&gt; var item = {
   durability: 100,
   sizeInSlots: 1,
   toString(){ return 'an undescriptive item';}
}
&gt; item.toString();
// =&gt; an undescriptive item
</code></pre>


<p>And a two handed iron sword that in addition to being an item (and an awesome item at that) has its own specific set of traits:</p>

<pre><code>&gt; var ironTwoHandedSword = {
    damage: 60,
    sizeInSlots: 2,
    wield() { console.log('you wield your iron sword crazily over your head');},
    material: 'iron',
    toString() {return 'A rusty two handed iron sword';}
};
</code></pre>


<p>You can take advantage of JavaScript prototypical inheritance to reuse the item properties across may items, by setting the <code>item</code> object as the prototype of the <code>ironTwoHandedSword</code> (and any other specific items that you create afterwards).</p>

<pre><code>&gt; ironTwoHandedSword.prototype = item;
</code></pre>


<p>This will establish a prototypical chain, so that, if we attempt to retrieve the sword <code>durability</code>, JavaScript runtime will traverse the chain and retrieve the property from the <code>item</code> prototype:</p>

<pre><code>&gt; ironTwoHandedSword.durability;
// =&gt; 100
</code></pre>


<p>If, on the other hand, you attemp to access a property that exists in both the prototype and the object itself, the nearest property in the chain will win:</p>

<pre><code>&gt; ironTwoHandedSword.toString();
// =&gt; A rusty two handed iron sword
</code></pre>


<p>ES6 exposes the <code>__proto__</code> property that lets you directly assign a prototype through an object literal:</p>

<pre><code>&gt; var ironTwoHandedSword = {
    __proto__: item
    damage: 60,
    // etc...
};
&gt; ironTwoHandedSword.prototype = item;
</code></pre>


<p>There's a lot more to prototypical inheritance and the many different OOP paradigms supported by JavaScript. But we'll look further into them later in the series.</p>

<h3>ES6 Classes</h3>

<p>A new addition to JavaScript you might have heard about and celebrated are ES6 classes. The existence of ES6 classes doesn't mean that JavaScript gets classes just like C# and we're not going to worry about constructor functions and prototypical inheritance anymore. <strong>ES6 classes are "just" syntactic sugar over the existing inheritance model and the way we craft objects in JavaScript</strong>. That being said, it is a great declarative way to represent constructor/prototype pairs.</p>

<p>A JavaScript class looks very similar to a C# class:</p>

<pre><code>&gt; class Item {
    constructor(durability = 100, sizeInSlots = 1){
      this.durability = durability;
      this.sizeInSlots = sizeInSlots;
    }
    toString(){
      return 'an undescriptive item';
    }
}
&gt; var item = new Item();
&gt; item.toString();
// =&gt; an undescriptive item
</code></pre>


<p>And so does inheritance:</p>

<pre><code>&gt; class Sword extends Item {
    constructor(durability = 500, sizeInSlots = 2, damage = 50, material = 'iron'){
      super(durability, sizeInSlots);
      this.damage = damage;
      this.material = material;
    }
    wield() {
      console.log(`you wield your ${this.material} sword crazily over your head`);
    }
    toString() {
      return `A ${this.material} sword`;
    }
};
&gt; var sword = new Sword();
&gt; sword.wield();
// =&gt; you wield your iron sword crazily over your head
</code></pre>


<h2>Arrays, Maps and Sets in JavaScript</h2>

<p>Up until recently JavaScript had only one single data structure, albeit very verstatile, to handle collections of items: the array. You can create an array using using square brackets <code>[]</code>:</p>

<pre><code>&gt; [1, 2, 3, 4 ,5]
// =&gt; [1,2,3,4,5]
</code></pre>


<p>You can mix and match the different elements of an array. There's no type restrictions so you can have numbers, strings, objects, functions, arrays, etc</p>

<pre><code>&gt; var aKendersPoach = [
    'jewel',
    '3 stones',
     1,
    {name: 'Orb of Power}, 
    function() { return 'trap!';}
    ];
</code></pre>


<p>You can access the items of an array via their indexes:</p>

<pre><code>&gt; aKendersPoach[0]
// =&gt; jewel
&gt; aKendersPoach[4]()
// =&gt; trap!
</code></pre>


<p>You can traverse the indexes of an array using the <code>for/in</code> loop:</p>

<pre><code>&gt; for (var idx in aKendersPoach) console.log(aKenderPoach[idx]);
// =&gt; jewel
// =&gt; 3 stones
// =&gt; ...etc
// =&gt; function() { return 'trap!';}
</code></pre>


<p>And even better the items of an array using ES6 <code>for/of</code> loop:</p>

<pre><code>&gt; for (var item of aKendersPoach) console.log(item);
// =&gt; jewel
// =&gt; 3 stones
// =&gt; ...etc
// =&gt; function() { return 'trap!';}
</code></pre>


<p>Arrays have a lot of cool and useful methods that you can use to add/remove or otherwise operate on the items within the array:</p>

<pre><code>&gt; aKendersPoach.length
// =&gt; 5
&gt; aKendersPoach.push('silver coin');  // add item at the end of the array
// =&gt; 6 (returns the current length of the array)
&gt; aKendersPoach.push('6 copper coins', 'dental floss');
// =&gt; 8
&gt; aKendersPoach.pop(); // pop item at the end of the array
// =&gt; dental floss
&gt; aKendersPoach.unshift('The three Musketeers'); // insert item in the beginning
// =&gt; 8
&gt; aKendersPoach.shift(); // extract item from the beginning of the array
// =&gt; 'The three musketeers'
</code></pre>


<p>And even LINQ-like methods to perform functional style transformations within an array:</p>

<pre><code>&gt; var goldCoins = aKendersPoach
                     .filter(isValuable) // ES6 analogous to LINQ Where
                     .map(toGoldCoins) // analogous to LINQ Select
                     .reduce(sumCoins); // analogous to LINQ Aggregate
// =&gt; 7
</code></pre>


<p>You will learn a ton more about arrays and JavaScript versions of LINQ later in the series.</p>

<h3>ES6 Spread Operator and Arrays</h3>

<p>The <strong>ES6 spread operator</strong> can also be used to merge an array within another array, or otherwise called, flatten an array inside another:</p>

<pre><code>&gt; var newRecruits = ['Sam', 'John', 'Connor'];
&gt; var merryBandits = ['Veteran Joe', 'Brave Krom', ...newRecruits];
&gt; merryBandits;
// =&gt; ["Veteran Joe", "Brave Krom", "Sam", "John", "Connor"]
</code></pre>


<h3>ES6 Maps and Sets</h3>

<p>ES6 gives us magicians two new data structures to work with: maps, a true key/value pair data structure and sets to handle collections of unique items.</p>

<p>You can create a new map using the <code>Map</code> constructor:</p>

<pre><code>&gt; var libraryOfWisdom = new Map();
&gt; libraryOfWisdom.set(A, ['A brief history of JavaScript-mancy', 'A Tale of Two Cities');
&gt; libraryOfWisdom.get('A')
// =&gt; ['A brief history of JavaScript-mancy', 'A Tale of Two Cities']; 
</code></pre>


<p>You can even seed a map with existing information by sending an array of key/value pairs<sup id="fnref:3"><a href="#fn:3" rel="footnote">3</a></sup>:</p>

<pre><code>&gt; var libraryOfWisdom = new Map([
    ['A', ['A brief history of JavaScript-mancy', 'A Tale of Two Cities']],
    ['B', ['Better Dead Than Powerless: Tome I of Nigromantics']]
]);
&gt; libraryOfWisdom.get('B');
// =&gt; ['Better Dead Than Powerless: Tome I of Nigromantics']
</code></pre>


<p>In a similar fashion, you create sets using the <code>Set</code> constructor:</p>

<pre><code>&gt; var powerElements = new Set(['earth', 'fire', 'water', 'wind']);
&gt; powerElements
// =&gt; Set {"earth", "fire", "water", "wind"}
</code></pre>


<p>Sets will ensure that you don't have duplicated data within a collection:</p>

<pre><code>&gt; powerElements.add('water').add('earth').add('iron');
&gt; console.log(powerElements);
// =&gt; Set {"earth", "fire", "water", "wind", "iron"}
</code></pre>


<h2>JavaScript Flow Control</h2>

<p>JavaScript gives you the classic flow control structures that you are accostumed to in C#: <code>if</code>, <code>for</code>, <code>while</code> loops behave much in the same way in JavaScript than in C# (bur for the function scope variables of course).</p>

<p>In addition to these, JavaScript has the <code>for/in</code> loop that lets you iterate over the properties of an object:</p>

<pre><code>&gt; var spellOfFarseeing = { name: 'Spell of Farseeing', manaCost: 10, description: 'The spell lets you see a limited portion of a far away location;'}
&gt; for (var prop in spellOfFarseeing) console.log(`${prop} : ${spellOfFarseeing[prop]}`);
// =&gt; name : Spell of Farseeing
// =&gt; manaCost : 10
// =&gt; description : The spell lets you see a limited portion of a far away location
</code></pre>


<p>And the ES6 <code>for/of</code> loop that lets you iterate over collections<sup id="fnref:4"><a href="#fn:4" rel="footnote">4</a></sup> (arrays, maps and sets):</p>

<pre><code>&gt; for (var element of powerElements) console.log(element);
// =&gt; earth
// =&gt; fire
// =&gt; water
// =&gt; etc...
</code></pre>


<h2>Logical Operators in JavaScript</h2>

<h3>Abstract Equality and Strict Equality</h3>

<p>JavaScript equality operators behave in a particular special way. The operators that you are accostumed to use in C# <code>==</code> and <code>!=</code> are called <strong>abstract equality operators</strong> and evaluate the equality of expressions in a loose way. If the two expressions being evaluated by one of this operators don't match in type, they'll be converted resulting to a matching type. For instance, in evaluating the abstract equality of <code>42</code> and <code>"42"</code>, the string will be converted to a number resulting in both values being equal:</p>

<pre><code>&gt; 42 == '42'
==&gt; true
</code></pre>


<p>Fortunately JavaScript also provides operators that performs strict equality ( <code>===</code> and <code>!==</code>) which is basically a comparison of two values without the implicit type conversion.</p>

<pre><code>&gt; 42 === '42'
==&gt; false
</code></pre>


<h3>Implicit Type Conversion Also Know As Type Coercion</h3>

<p>This implicit conversion that takes place in JavaScript gives birth to the concept of <strong>truthy<em> and </em>falsey</strong>. Since any value can be evaluated as a boolean, we say that some values like an array <code>[]</code> or an object <code>{}</code> are truthy, and some other values like empty string <code>''</code> or <em>undefined</em> are falsey. In the examples below we use the <code>!!</code> to explicitly convert values to boolean:</p>

<pre><code>&gt; !![]
// =&gt; true
&gt; !!{}
// =&gt; true
&gt; !!""
// =&gt; false
&gt; !!undefined
// =&gt; false
&gt; !!null
// =&gt; false
&gt; !!0
// =&gt; false
</code></pre>


<p>This allows for a terser way to write <code>if</code> statements</p>

<pre><code>&gt; if (troll) // as opposed to (troll != null &amp;&amp; troll != undefined)
</code></pre>


<h3>OR and AND</h3>

<p><strong>OR</strong> (<code>||</code>) and <strong>AND</strong> (<code>&amp;&amp;</code>) operations also behave in an interesting way. The <em>OR</em> operation will return the first truthy expression or the last falsey expression (if all expressions are falsey):</p>

<pre><code>// 0 falsey
// 'cucumber' truthy
// 42 truthy
&gt; 0 || 'cucumber' || 42
// =&gt; 'cucumber'
&gt; 0 || false || undefined
// =&gt; undefined
</code></pre>


<p>The <em>AND</em> operator will return the last truthy expression or the first falsey expression (if any falsey expression is encountered):</p>

<pre><code>// 0 falsey
// 'cucumber' truthy
// 42 truthy
&gt; 0 &amp;&amp; 'cucumber' &amp;&amp; 42
// =&gt; 0
&gt; true &amp;&amp; 'cucumber' &amp;&amp; 42
// =&gt; 42
</code></pre>


<h2>Exception Handling</h2>

<p>Exception handling works similar as in C#, you have your familiar <code>try/catch/finally</code> blocks:</p>

<pre><code>&gt; try { asdf; } catch (e) { console.log(e.message);} finally { console.log('done!');}
// =&gt; asdf is not defined
// =&gt; done!
</code></pre>


<p>And you can throw new exceptions with the <code>throw</code> keyword:</p>

<pre><code>&gt; throw new Error("We're all gonna die!");
// =&gt; Uncaught Error: We're all gonna die!
</code></pre>


<p>Additionally you can improve your error semantics and create custom errors by inheriting the <code>Error</code> prototype.</p>

<h2>Regular Expressions</h2>

<p>JavaScript also supports regular expressions. You can create a regular expression in two ways, either by wrapping the expression between slash <code>/</code>:</p>

<pre><code>&gt; var matchNumbers = /\d+/;
&gt; matchNumbers.test('40 gold coins');
// =&gt; true
&gt; matchNumbers.exec('40 gold coints');
// =&gt; ["40"]
</code></pre>


<p>Or by creating a <code>RegExp</code> object:</p>

<pre><code>&gt; var matchItems = new RegExp('\\D+');
&gt; matchItems.test('40 gold coins');
// =&gt; true
&gt; matchItems.exec('40 gold coints');
// =&gt; [" gold coins"]
</code></pre>


<p>Strings have built-in support for regular expressions as well with the <code>match</code> and <code>search</code> methods:</p>

<pre><code>&gt; var bagOfGold = '30 gold coins';
&gt; bagOfGold.match(/\d+/);
// =&gt; ['30']
&gt; bagOfGold.search(/\d+/);
// =&gt; 0 (index where first match is found)
</code></pre>


<h2>But Beware, JavaScript Can Be Weird and Dangerous</h2>

<p>So far you've seen the bests parts of JavaScript and nothing too weird or inconsistent. But sometimes you'll experience strange behaviors in some less visited corners of JavaScript like any of the following:</p>

<pre><code>&gt; x = 10;
// =&gt; added a variable to the global scope (window.x)
&gt; NaN == NaN
// =&gt; false
&gt; null == undefined
// =&gt; true
&gt; typeof(null)
// =&gt; object
&gt; [] + []
// =&gt; ''
&gt; [] + {}
// =&gt; {}
&gt; {} + []
// =&gt; 0
&gt; {} + {}
// =&gt; NaN
</code></pre>


<p>Oftentimes you won't run into this issues when building real web applicatins and my advice is that you ignore them. Be aware that they exist but just don't use them, or use patterns or conventions to avoid them.</p>

<h2>Summary</h2>

<p>And that was a summary of pretty much the whole JavaScript language. We've seen that JavaScript is a very flexible dynamic language with a lot of great features.</p>

<p>We have seen the many things you can do with strings and ES6 string templates. How functions are a very independent entities and a fundamental building block of applications in JavaScript, as well as arrow runctions that resemble lambdas in C#. We took a look at objects in JavaScript, protypical inheritance and ES6 classes. We saw the different data structures supported in JavaScript, the versatility of the array and an overview of the new ES6 Map and Set.</p>

<p>We also took a look at more general language features like the flow control structures and logical operators. We saw how JavaScript has similar flow control structures to C# and, in addition, the <code>for/in</code> for object properties and <code>for/of</code> loops analog to C#'s <code>foreach</code>. We saw the difference between abstract comparison and strict comparison in JavaScript, highlighted the implicit type conversion inherent to JavaScript, the existence of the concepts of <em>truthy</em> and <em>falsey</em> and the way the <em>OR</em> and <em>AND</em> operators work.</p>

<p>Finally we reviewed JavaScript exception handling and regular expressions, and we saw some of the weird and best-avoided behaviors in JavaScript.</p>

<div class="footnotes">
<hr>
<ol>
<li id="fn:1">
<p>This is a gross oversimplification. If you've read some traditional literature about static vs dynamic programming languages you'll be familiar with the idea that static programming languages like C++, Java, C# are compiled and then executed whereas dynamic programming languages like Ruby, Python or JavaScript are not compiled but interpreted on-the-fly as they are executed. The repercussions of this being that a compiled program cannot be changed at runtime (you would need to recompile it), whereas an interpreted one can since nothing is set in stone until it is run. In today's world however, JavaScript runtimes like V8(Chrome) or SpiderMonkey(Mozilla) compile JavaScript to machine code, optimize it, and re-optimize it based on heuristics on how the code is executed.<a href="#fnref:1" rev="footnote">↩</a></p></li>
<li id="fn:2">
<p>As an article of interest you can augment objects in C# if you use the <code>dynamic</code> keyword with <code>ExpandoObject</code>s<a href="#fnref:2" rev="footnote">↩</a></p></li>
<li id="fn:3">
<p>in reality, it does not need to be an array, but an iterable that produces key/value pairs <code>[&lt;key&gt;:&lt;value&gt;]</code><a href="#fnref:3" rev="footnote">↩</a></p></li>
<li id="fn:4">
<p>for the sake of correctness, you can use the for/of loop not only on arrays, maps and sets but on anything that implements the iterable protocol. We will discuss iterability later within the series.<a href="#fnref:4" rev="footnote">↩</a></p></li>
</ol>
</div>

</div>
					</div>
				</article>
				<!--================= END :: Tutorial =================-->
				
				<!--================= START :: Tutorial =================-->
				<article>
					<a id="t-84" name="t-84"></a><h1>84 : Mastering the Arcane Art of JavaScript-mancy for C# Developers - Chapter 1: The Many a One JavaScript Quirks</h1>
					<span class="ref-site">https://www.barbarianmeetscoding.com/blog/2015/05/03/mastering-the-arcane-art-of-javascript-mancy-for-c-sharp-developers-chapter-1-the-many-a-one-javascript-quirks/</span>
					<div class="tutorial__content">
<div class="entry-content">

<p>For many years has JavaScript been frown upon and look down on by many developers due to its quirky nature, obscure behaviors and many a one WTFs that populate its hairy APIs and operations.</p>

<p>Frown upon no more! For with modern design patterns, libraries, tools and the long awaited JavaScript 6 Harmony (ES6, ES2015) writing JavaScript is now a pleasure.</p>

<p>Join me at the school of JavaScript-mancy as we travel along the modern landscape of writing JavaScript in 2015 and beyond, as we discover the organic evolution of this beautiful language and its thriving ecosystem, and delve in the latest features/spells/incantations of the JavaScript Arcana.</p>

<!-- more -->


<p>You my friend, cannot ignore JavaScript no longer, JavaScript is the most deployed language on earth, a beautiful and expressive language that supports many paradigms and which has a thriving community that continuously expands and improves its ecosystem with patterns, libraries, frameworks and tools. You don't want to miss this train.</p>

<p>But JavaScript, though forgiving and specially conceived to be easy to learn, can be either daunting for us that have a strongly-typed mindset baggage and come from languages such as C# or Java or even more often laughed at as a toy.</p>

<p>For you who consider it daunting and hate working with it worry not! I will show you the most common missconceptions and all the patterns you need to know to become as fluent in JavaScript as you are in C#.</p>

<p>For you who consider it a toy language, something associated not with real programming but with copy-paste coding or scripting to add flare to websites, I will show you all the different patterns and programming paradigms that JavaScript supports and which make it just as good and powerful as C#.</p>

<p>Let's get started!</p>

<h2>JavaScript Quirks</h2>

<p><span class="pullquote-right" data-pullquote="JavaScript looks like a C-like language, it does not behave like one">
One of the main things that missguides C# developers when they come to JavaScript is that while JavaScript looks like a C-like language, it does not behave like one in many ways. Four examples of these are: the unbecoming/unexpected behavior of <code>this</code>, that variables have <em>function</em> and not <em>block</em> scope, the strange phenomenon know as <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/var#var_hoisting">variable hoisting</a> and the lack of explicit namespacing.
</span></p>

<p>In the next few sections I will dive deeper into each of these quirks and try to save you some frustration the next time you write some JavaScript. And before you continue, you <a href="http://jsfiddle.net/vintharas/x8a1puer/">can find all the examples I use in this blog post in this jsFiddle</a>, you can even play with the examples side by side with the article to get a better understanding of how JavaScript works.</p>

<h3>This and JavaScript</h3>

<p>One of the most common problems when a C# developer comes to JavaScript is that it expects <code>this</code> to work exactly as it does in C#. And She or He will write this code unaware of the dangers that lurk just an HTTP call away…</p>

<pre><code>function UsersCatalog(){
    this.users = [];
    getUsers()

    function getUsers(){
        $.getJSON('https://api.github.com/users')
        .success(function(users){
            this.users.push(users);
            // BOOOOOOOM!!!!!
            // =&gt; Uncaught TypeError: Cannot read property 'push' of undefined
        });
    }
}
var catalog = new UsersCatalog();
</code></pre>


<p>Let's see why this happens, how <code>this</code> works in JavaScript and we will round up and come back to this example at the conclusion once we have demystified <code>this</code> and become this-xperts.</p>

<p><span class="pullquote-right" data-pullquote="this depends on the context in which a function is invoked">
So <strong><code>this</code> in JavaScript is weird</strong>, and unlike other languages <strong>this depends on the context in which a function is invoked</strong>. This basically means that depending on how you call a function <code>this</code> will have a value or another:</span></p>

<ul>
<li><code>this</code> and objects</li>
<li><code>this</code> unbound</li>
<li><code>this</code> explicitly</li>
<li><code>this</code> bound
</li>
</ul>


<h4>This And Objects</h4>

<p>In the most common scenario for an OOP developer we call a function as a method, that is a function that is a property within an object (<em>using the dot notation as usual</em>). In this case and as we would expect <code>this</code> will take the value of the object itself:</p>

<pre><code>// #1. A function invoked in the context of an object (a method)
var hellHound = {
    attackWithFireBreath: function(){
        console.log(this + " jumps towards you and unleashes his terrible breath of fire! (-3 hp, +fear)");
    },
    toString: function (){ return 'Hellhound';}
}

hellHound.attackWithFireBreath();
// =&gt; Hellhound jumps towards you and unleashes his terrible breath of fire! (-3 hp, +fear)
// 'this' is the hellHound object
</code></pre>


<h4>This Unbound</h4>

<p>But you can also invoke a function without the context of its object:</p>

<pre><code>// #2. A function invoked without the context of its object
var attackWithFireBreath = hellHound.attackWithFireBreath;
attackWithFireBreath();
// =&gt; [object Window] jumps towards you and unleashes his terrible breath of fire! (-3 hp, +fear)
// ups, 'this' is no longer the hellHound object but the Window object. What?
// By default the context of execution of a function is the Window object
// if you use strict mode it will be undefined =&gt; use strict mode
</code></pre>


<p>Whenever you invoke a function without an object as context the <code>this</code> automatically becomes the <code>window object</code> unless you have set <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Strict_mode">strict mode</a> on in which case <code>this</code> will take the value of <code>undefined</code>.</p>

<p>We could even take that very same function and add it to another object different from the original:</p>

<pre><code>// we could add the same method to another object:
var jaime = {
    toString: function(){return 'jaime';}
};
jaime.attackWithFireBreath = attackWithFireBreath;

jaime.attackWithFireBreath();
// =&gt; jaime jumps towards you and unleashes his terrible breath of fire! (-3 hp, +fear)
// =&gt; 'this' is the jaime object
</code></pre>


<p>And again, when we invoke the original function in the context of an object, even another one different from the original one, <code>this</code> takes the value of that object.</p>

<h4>This Explicitly</h4>

<p>JavaScript <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function/prototype"><code>Function</code> prototype</a>, from which all functions within JavaScript descend, provides two helpful methods that allow you to explicitly set the context within which a function is executed. These methods are <code>call</code> and <code>apply</code> and they work by taking the context (<code>this</code>) as an argument:</p>

<pre><code>// #3. We can also explicitly set the context of execution of a function
// all functions have call and apply:
attackWithFireBreath.call(jaime /*, arg1, arg2, */);
// =&gt; jaime...
// =&gt; 'this' is jaime
attackWithFireBreath.apply(hellHound /*, [arg1, arg2, arg3...] */);
// =&gt; hell hound...
// =&gt; 'this' is hellHound
</code></pre>


<h4>This Bound</h4>

<p>And additionally, as of ECMAScript 5, the <code>Function</code> prototype also provides the <code>bind</code> function that lets us create new functions that <em>always have a fixed context</em>, that is, a fixed value for <code>this</code>.</p>

<p>It is important to note that <code>bind</code> will not alter the original function but will return a new function that is bound to the object given as an argument. Once a function is bound it is not possible to un-bound it nor re-bind it to another object (but you can always use the original unbound function):</p>

<pre><code>// #4. And as of ES5 we can bind the context of execution of a function FOR EVER
attackBound = attackWithFireBreath.bind(hellHound);
attackBound();
// =&gt; Hellhound jumps towards you and unleashes his terrible breath of fire! (-3 hp, +fear)
// `this` is Hellhound even though I am not using the dot notation

// even if I give the function to another object
jaime.attackBound = attackBound;
jaime.attackBound();
// =&gt; Hellhound ...
// `this` is Hellhound even though I am using the dot notation with another object

// You cannot rebind a function that is bound
var attackReBound = attackBound.bind(jaime);
attackReBound();
// =&gt; Hellhound ...
attackBound();
// =&gt; hellHound ...

// But you can still bind the original
var attackRebound = attackWithFireBreath.bind(jaime);
attackRebound();
// =&gt; jaime...
</code></pre>


<h4>Concluding This</h4>

<p>So in summary, <code>this</code> can take different values based on how a function is invoked. It can:</p>

<ul>
<li>Be an object if we call a function within an object with the dot notation</li>
<li>Be the <code>window object</code> or <code>undefined</code> (<em>strict mode</em>) if a function is invoked by itself</li>
<li>Be whichever object we pass as argument to <code>call</code> or <code>apply</code></li>
<li>Be whichever object we pass as argument to <code>bind</code>.</li>
</ul>


<p>And if now that you are a  <em>this-xperts</em> you go back to the original example you will be able to easily spot the problem. Since the <code>success</code> function is not invoked in the context of our object, the <code>UsersCatalog</code>, <code>this</code> is not our original object. In this particular case <code>this</code> is the jqXHR object which for sure does not have a <code>users</code> property and thus the <em>cannot read property of undefined</em> error.</p>

<pre><code>function UsersCatalog(type){
    this.users = [];
    getUsers()

    function getUsers(){
        $.getJSON('https://api.github.com/users')
        .success(function(users){
            this.users.push(users);
            // BOOOOOOOM!!!!!
            // =&gt; Uncaught TypeError: Cannot read property 'push' of undefined
            // 'this' in this context is the jqXHR object
            // not our original object
        });
    }
}
var catalog = new UsersCatalog();
</code></pre>


<p>You can solve this issue in either of two ways. You can take advantage of JavaScript support for closures, declare a <code>self</code> variable that "captures" the value of <code>this</code> and use it within the closure function as depicted below (very common practice in JavaScript):</p>

<pre><code>function UsersCatalogWithClosure(){
    "use strict";
    var self = this;

    self.users = [];
    getUsers()

    function getUsers(){
        $.getJSON('https://api.github.com/users')
        .success(function(users){
            self.users.push(users);
            console.log('success!');
        });
    }
}
var catalog = new UsersCatalogWithClosure();
</code></pre>


<p>Or you can use <code>bind</code> and ensure that the function that you use as callback is bound to the object that you want:</p>

<pre><code>//#2. Using bind
function UsersCatalogWithBind(){
    "use strict";

    this.users = [];
    getUsers.bind(this)();

    function getUsers(){
        $.getJSON('https://api.github.com/users')
        .success(updateUsers.bind(this));
    }

    function updateUsers(users){
        this.users.push(users);
        console.log('success with bind!');
    }
}
var catalog = new UsersCatalogWithBind();
</code></pre>


<h3>Function Scope and Variable Hoisting</h3>

<p><span class="pullquote-right" data-pullquote="variables in JavaScript have function scope">
Another interesting quirk about JavaScript is that, unlike many other languages, <strong>variables in JavaScript have function scope</strong> and not block scope. This can be better illustrated by the example below:
</span></p>

<pre><code>function aFunctiontoIllustrateFunctionScope(){

    if (true){
        var x = 10;
    }
    console.log(x);
}
aFunctiontoIllustrateFunctionScope();
// =&gt; 10 WAT
</code></pre>


<p>What happens in this example is that the JavaScript runtime <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/var#var_hoisting">hoists</a> all variables within a function definition to the beginning of the function body. This means that the function that you've seen above it actually works like this:</p>

<pre><code>function aFunctiontoIllustrateFunctionScope(){
    // hoisted variables
    var x = undefined;

    if (true){
        x = 10;
    }

    console.log(x);
    // =&gt; 10
}
</code></pre>


<p>And yet another example of hoisting:</p>

<pre><code>function aFunctionToIllustrateHoisting(){
    // in reality
    // var i = undefined
    console.log('before i =' + i);
    // =&gt; before i = undefined
    for(var i = 0; i &lt; 10; i++){
        // jara jara
    }
    console.log('after i = ' + i);
    // =&gt; after i = 10
}
</code></pre>


<p>And that's the reason why JavaScript developers usually write all variable declarations in the beginning of a function, to be more explicit about what happens in reality when a given function is evaluated by the JavaScript runtime and avoid unnecessary bugs. Take a look at <a href="https://github.com/jquery/jquery/blob/master/src/ajax/load.js">jQuery</a> for instace:</p>

<pre><code>/**
 * Load a url into a page
 */
jQuery.fn.load = function( url, params, callback ) {
    var selector, type, response,
        self = this,
        off = url.indexOf(" ");

    //... more codes
}
</code></pre>


<p>As a final note, you'll be happy to hear that the next version of JavaScript <a href="https://github.com/lukehoban/es6features#let--const">ECMAScript 2015</a> introduces the <code>let</code> keyword that brings block scope variables to JavaScript.</p>

<h3>Namespacing in JavaScript</h3>

<p>As you will come to appreciate by the end of the series, JavaScript has a minimalistic design and a limited number of primitive constructs that can be used and composed to achieve higher level abstractions and constructs that are native to other languages, one of these being namespaces.</p>

<p>Since we do not have namespaces in JavaScript and yet we want to avoid declaring all of our variables in the global "namespace" (where they would be visible to every single module):</p>

<pre><code>var dice = "d12";
dice;
// =&gt; d12
window.dice
// =&gt; d12
// ups... we are in the global scope/namespace
</code></pre>


<p>We use objects to emulate the construct of namespaces. A common pattern is depicted below where we use a <a href="http://en.wikipedia.org/wiki/Immediately-invoked_function_expression">IIFE</a> (immediately invoked function expression) to create/augment a namespace:</p>

<pre><code>// IIFE - we invoke the function expression as soon as we declare it
(function(armory){
    // armory being the namespace
    armory.sword = {damage: 10, speed: 15};
    armory.axe = {damage: 15, speed: 8};
    armory.mace = {damage: 16, speed: 7};
    armory.dagger = {damage: 5, speed: 20};

}(window.armory = window.armory || {} )); // either augment or create the armory namespace
console.log(armory.sword.damage);
// =&gt; 10
</code></pre>


<p>I will come back to namespacing and higher level code organization in JavaScript when we discuss JavaScript modules.</p>

<h2>Summary</h2>

<p>And that's that for the first chapter of the JavaScript-mancy series. Hope that you have enjoyed and learned something new about JavaScript and if you already knew all this stuff, don't worry, there are more exciting and interesting things coming like functional programming, cool OOP techniques and ES2015 (ES6), the next version of JavaScript.</p>

</div>
					</div>
				</article>
				<!--================= END :: Tutorial =================-->
				
				<!--================= START :: Tutorial =================-->
				<article>
					<a id="t-85" name="t-85"></a><h1>85 : Summoning Fundamentals: A Three Part Introduction to OOP in JavaScript - Encapsulation</h1>
					<span class="ref-site">https://www.barbarianmeetscoding.com/blog/2015/11/30/summoning-fundamentals-a-three-part-introduction-to-oop-in-javascript-encapsulation/</span>
					<div class="tutorial__content">
<div class="entry-content">

<p>In <a href="/blog/2015/11/23/an-introduction-to-object-oriented-programming-in-javascript-for-c-sharp-developers/">An Introduction to Object Oriented Programming in JavaScript for C# Developers</a> I gave you a ten thousand feet introduction to object oriented programming in JavaScript. Now it is time to get into the nitty-gritty! We will start with a three part introduction to the pillars of Object Oriented Programming applied to JavaScript: encapsulation, inheritance and polymorphism.</p>

<!-- more -->


<p></p>

<p>In this article we'll take a look at the principle of <em>encapsulation</em> and how to create objects through both <em>object initializers</em> and <em>constructor functions</em>. You'll also refresh the techniques you have at your disposal to achieve <em>information hiding</em>. We will wrap the article with a comparison between <em>object initializers</em>, <em>factories</em> and <em>constructor functions</em> in a attempt to understand their strengths and weaknesses.</p>

<p>In the coming articles you'll learn about JavaScript <em>prototypical inheritance</em> model and <em>polymorphism</em> and understand how both differ from what we are accustomed to in C#.</p>

<h2>Encapsulation: Creating Objects in JavaScript</h2>

<p>The <em>principle of encapsulation</em> consists in putting data and the functions that operate it together into a single component. In some definitions it includes the principle of <em>information hiding</em> (or <em>data hiding</em>), that is the ability to hide implementation details from consumers so as to define a clear boundary or interface that is safe to use from a consumer perspective. This in turn allows the author to change the hidden implementation details without breaking the contract with the consumer established by the public interface of a component. Thus both author and consumer can continue developing without getting in the way of each other, the author can tweak its implementation and the consumer can rest assured that the author won't break his code. In this article, I will separate <em>encapsulation</em> from <em>data hiding</em> because JavaScript uses different ways to solve each of these problems.</p>

<p>Let's start with <em>encapsulation</em>. JavaScript provides different strategies for achieving <em>encapsulation</em>: <em>object initializers</em>, <em>constructor functions</em> and <em>ES6 classes</em>. In this article we will take a look at the first two, and we will devote a whole article to <em>ES6 classes</em> later in these series.</p>

<h2>Object Initializers</h2>

<p><em>You can <a href="http://bit.ly/javascriptmancy-oop-fundamentals-encapsulation">experiment with all examples in this article directly within this jsBin</a></em></p>

<p>In <a href="/blog/2015/10/08/mastering-the-arcane-art-of-javascript-mancy-on-summoning-servants-and-critters-or-the-basics-of-objects/">Understanding The Basics of JavaScript Objects</a> you learned the intricacies of using <em>object initializers</em> (also known as <em>object literals</em>) to create new objects:</p>

<pre><code>// creating a simple object
let object = {};
console.log(object);
// =&gt; [object Object] { ... }
</code></pre>


<p>And you saw how you can define any number of properties and methods in your objects:</p>

<pre><code>// you can create objects with any number of properties and methods
let minion = {
  hp: 10,
  name: 'minion',
  toString(){ return this.name;}
};

console.log(minion);
// =&gt; [object Object] {
//  hp: 10,
//  name: "minion",
//  toString: function toString() {
//    return this.name;
//  }
// }
</code></pre>


<p>And even augment objects after they have been created:</p>

<pre><code>minion.armor = 'chain mail';
console.log(minion.armor);
// =&gt; chain mail
</code></pre>


<p>We also studied the use of <em>factory functions</em> that ease object creation:</p>

<pre><code>// we can use factories to ease object creation
function createMinion(name, hp=10){
  return {
    hp: hp,
    name: name,
    toString(){ return this.name;}
  };
}
</code></pre>


<p>You just call the <em>factory function</em> to create a new object and use it as you please:</p>

<pre><code>let orc = createMinion(/* name */ 'orc', /* hp */ 100);
console.log(orc);
// =&gt; [object Object] {
//  hp: 100,
//  name: "orc",
//  etc...
// }
</code></pre>


<p>Well there's another way to create objects in JavaScript that will feel much more familiar to a C# developer: Using the <code>new</code> operator and <strong>constructor functions</strong>.</p>

<h2>Constructor Functions and the New Operator</h2>

<p>In the previous section we saw how to create an object using an <em>object initializer</em>:</p>

<pre><code>let object = {};
</code></pre>


<p>We can achieve the same thing by applying the <code>new</code> operator to a <code>constructor function</code>. Using this approach we get the statement below which is completely equivalent to the previous example:</p>

<pre><code>let anotherObject = new Object();
console.log(anotherObject);
// =&gt; [object Object] { ... }
</code></pre>


<p>While the <code>Object</code> function let's you create empty objects, you can apply the <code>new</code> operator on any function in JavaScript to instantiate new objects of your own devise. Functions that are called with the <code>new</code> operator are known as <strong>constructor functions</strong>:</p>

<pre><code>function Minion(name='minion', hp=10){
  this.hp = hp;
  this.name = minion;
  this.toString = () =&gt; this.name;
};

let anotherMinion = new Minion();
console.log(anotherMinion);
// =&gt; [object Object] {
//  hp: 10,
//  name: "minion",
//  toString: () =&gt; this.name
// }
</code></pre>


<p>So first thing to highlight here, in C# we use the <code>new</code> operator on classes to instantiate new objects, in JavaScript however we use the <code>new</code> operator on <em>constructor functions</em> to instantiate these objects. The <em>constructor function</em> is, in a way, acting as a <em>custom type</em> and a <em>class definition</em> since it defines the properties and methods of the resulting object that will be created when we invoke it. To bring this point home even more, if we use the <code>instanceof</code> operator in JavaScript which tells us the type of an object we'll see that it is indeed <code>Minion</code>:</p>

<pre><code>console.log(`anotherMinion is a Minion: ${anotherMinion instanceof Minion}`);
// =&gt; anotherMinion is a Minion: true
console.log(`anotherMinion is an Object: ${anotherMinion instanceof Object}`);
// =&gt; anotherMinion is an Object: true
</code></pre>


<p>If you take a look at the <code>Minion</code> <em>constructor function</em> and compare it with the <em>factory function</em> from the previous section you'll notice that they are a little bit different. In the <em>factory function</em> we create an object via an <em>object initializer</em> and we return it. In this example however there is no object being created nor returned as far as we can see. <em>What is happening here?</em></p>

<p>It all comes down to the <code>new</code> operator. When you use the <code>new</code> operator on a function there are several things happening under the hood:</p>

<ol>
<li>First an empty object is created and set as <code>this</code> for the function being executed. <em>That is, in the example above, the <code>this</code> keyword refers to a new object that has just been created.</em></li>
<li>If the constructor function has a <em>prototype</em> the new object is given that prototype (more on this in the next section).</li>
<li>After that, the function body is invoked. <em>In the example above, we add a series of properties to the new object namely <code>hp</code>, <code>name</code> and <code>toString</code></em></li>
<li>Finally the value of <code>this</code> is returned (unless we return something explicitly). <em>As we see from the result of the <code>console.log</code> the object is created successfully.</em></li>
</ol>


<p>Let's see what happens if we return something explicitly from a <em>constructor function</em>.</p>

<pre><code>// if you try to return a primitive it is ignored
function MinionOrBanana(name='minion', hp=10){
  this.hp = hp;
  this.name = name;
  return 'banana';
}

let isItAMinionOrIsItABanana = new MinionOrBanana();
console.log(isItAMinionOrIsItABanana)
// =&gt; [object Object] {
//  hp: 10,
//  name: "minion"
//}
</code></pre>


<p>In this example above we can see how if we try to return a string explicitly the JavaScript runtime will completely ignore it an return the constructed object. This is also applicable to all primitive types. But <em>What happens if we return an object?</em></p>

<pre><code>// if you try to return an object it is returned instead of the `this` object
function MinionOrBanana(name='minion', hp=10){
  this.hp = hp;
  this.name = name;
  return {name: 'banana'};
}

let isItAMinionOrIsItABanana = new MinionOrBanana();
console.log(isItAMinionOrIsItABanana)
// =&gt; [object Object] {
//  name: "banana"
//}
</code></pre>


<p>Well if you try to return an object explicitly <code>{name: 'banana'}</code> this object will be returned and your original object (the one injected as <code>this</code> to the <em>constructor function</em>) will be completely ignored.</p>

<blockquote><h3>JavaScript Arcana: Returning Explicitly from Constructor Functions</h3>

<p>Returning expressions explicitly from <em>constructor functions</em> behaves in mysterious ways. If you return a primitive type such as a string or a number it will be ignored. If you return an object it will be returned from the <em>constructor function</em> and original object (the one injected as <code>this</code> in the function) will be lost in space and time.</p></blockquote>

<p>You may have noticed that I called the <em>constructor function</em> <code>Minion</code> with uppercase instead of the common JavaScript naming convention of using camel case with functions <code>minion</code>. And <em>Why?</em> you may be asking yourself. A popular convention int he JavaScript community is to use uppercase when naming <em>constructor functions</em> to differentiate them from other functions. This convention is a way to tell the consumers of an API that they should use the <code>new</code> operator when calling these functions. But <em>Why do we need to differentiate them? Aren't all of them functions anyway?</em></p>

<p>Well consider what happens if we call a <em>constructor function</em> without the <code>new</code> operator:</p>

<pre><code>let yetAnotherMinion = Minion();
console.log(yetAnotherMinion);
// =&gt; undefined
</code></pre>


<p><em>Hmm, no object is being returned… But Why?</em> Can you remember what happened with <code>this</code> when a function is called without a context? Yes! That's right! In <a href="/blog/2015/05/03/mastering-the-arcane-art-of-javascript-mancy-for-c-sharp-developers-chapter-1-the-many-a-one-javascript-quirks/">the Many JavaScripts Quirks</a> you learned that whenever we call a function without a context the value of <code>this</code> is set to the <code>Window object</code> (unless you are in <code>strict mode</code> in which case it will be <code>undefined</code>). <em>What is happening then?</em> By calling a <em>constructor function</em> without the <code>new</code> operator the function is evaluated in the context of the <code>Window object</code> and instead of creating a new object, we have just extended the <code>Window object</code> with two new properties <code>hp</code> and <code>name</code>:</p>

<pre><code>console.log(window.hp);
// =&gt; 10
console.log(window.name);
// =&gt; 'minion'
</code></pre>


<p>And if we had committed the same mistake in <em>strict mode</em> we would've immediately received an error that would've alerted us much faster:</p>

<pre><code>let yetAnotherMinion = Minion();
// =&gt; TypeError: Cannot set property 'hp' of undefined
</code></pre>


<blockquote><h3>JavaScript Arcana: Calling a Constructor Function Without The New Operator</h3>

<p>When you call a <em>constructor function</em> without the <code>new</code> operator you run the risk of evaluating it in the context of the <code>Window object</code> or <code>undefined</code> in the case of <em>strict mode</em>.</p></blockquote>

<p>So this is the cause why we usually use the uppercase notation when writing <em>constructor fuctions</em>. We want to avoid unsuspecting developers from forgetting the <code>new</code> operator and causing weird side-effects or errors in their programs. But conventions are not a very reliable thing are they. <em>Wouldn't it be better to have a foolproof way to protect our constructor functions so even if the <code>new</code> operator is not used they'll still work?</em></p>

<p>We can make our <em>constructor functions</em> more sturdy by following this pattern:</p>

<pre><code>function MinionSafe(name='minion', hp=10){
  'use strict';
  if (!this) return new MinionSafe(name, hp);

  this.name = name;
  this.hp = hp;
}
</code></pre>


<p>And now it doesn't matter how we call the <em>constructor function</em> it will work as expected in any case:</p>

<pre><code>console.log('using new operator: ', new MinionSafe());
// =&gt; [object Object] {
//  hp: 10,
//  name: "minion"
//}

console.log('using function call: ', MinionSafe());
// =&gt; [object Object] {
//  hp: 10,
//  name: "minion"
//}
</code></pre>


<p>Great! <em>But can we improve it? Wouldn't it be nice if we didn't have to write the guard clause for every single constructor function we create?</em> Functional programming to the rescue! We can define a <code>safeConstructor</code> function that represents an abstraction of the guard clause and which can be composed with any constructor function of our choosing:</p>

<pre><code>function safeConstructor(constructorFn){
  return function(){
    return new constructorFn(...arguments); // ES6
    // return new (constructorFn.bind.apply(null, arguments); // ES5
  }
}
</code></pre>


<p>The <code>safeConstructor</code> function takes a <code>constructorFn</code> <em>constructor function</em> as argument and returns a new function that wraps this <em>constructor function</em> and ensures that the <code>new</code> operator is always called regardless of the circumstances. From now on we can reuse this function to guard any of our <em>constructor functions</em>:</p>

<pre><code>// function Minion(name='minion', hp=10){
//    etc...
// }
let SafeMinion = safeConstructor(Minion);
</code></pre>


<p>By composing the <code>safeConstructor</code> function with the <code>Minion</code> <em>constructor function</em> we obtain a new function <code>SafeMinion</code> that will work even if we forget to use the <code>new</code> operator:</p>

<pre><code>console.log(`using function:`, ${SafeMinion('orc', 110)});
// =&gt; using function: [object Object] etc...
console.log(`using new operator:`, ${new SafeMinion('pirate', 50)}`);
// =&gt; "using new operator: [object Object] etc..."
</code></pre>


<h2>Data Hiding in JavaScript</h2>

<p>In <a href="/blog/2015/11/23/an-introduction-to-object-oriented-programming-in-javascript-for-c-sharp-developers/">Understanding The Basics of JavaScript Objects</a> you learned two patterns to achieve data hiding in JavaScript: <em>closures</em> and <em>ES6 symbols</em>, and how only <em>closures</em> provide real data privacy whilst <em>ES6 symbols</em> makes it harder to access "private" data.</p>

<p>Since <em>constructor functions</em> are just functions, you can use both <em>closures</em> and <em>ES6 symbols</em> to implement private properties and methods. Using <em>closures</em> is as easy as declaring variables in your <em>function constructor</em> body and referencing them from the methods that you want to expose:</p>

<pre><code>// just like with factory methods you can implement data privacy 
// using closures with constructor functions
function WalkingMinion(name='minion', hp=10){
  let position = {x: 0, y: 0};

  this.hp = hp;
  this.name = name;
  this.toString = () =&gt; this.name;

  this.walksTo = (x,y) =&gt; {
    console.log(`${this} walks from (${position.x}, ${position.y}) to (${x}, ${y})`);
    position.x = x;
    position.y = y;
  };

};
</code></pre>


<p>In this example we have a <code>WalkingMinion</code> <em>constructor function</em> that we can use to create many walking minions. These minions would effectively have a private property <code>position</code> and would expose a <code>walksTo</code> method that we could use to command each minion to walk without revealing the actual implementation of the positioning system which in this case is just an object.</p>

<p>Indeed if we instantiate a <code>walkingMinion</code> using the above constructor we can see how there's no way to access the <code>position</code> property:</p>

<pre><code>let walkingMinion = new WalkingMinion();
console.log(walkingMinion.position);
// =&gt; undefined
</code></pre>


<p>The <code>position</code> property is not really part of the object itself but it's effectively part of its internal state as the variable has been enclosed or captured by the <code>walksTo</code> function. This means that when we call the <code>walksTo</code> method can read of update the state of the <code>position</code> property as demonstrated below:</p>

<pre><code>walkingMinion.walksTo(2, 2)
// =&gt; minion walks from (0, 0) to (2, 2)
walkingMinion.walksTo(3,3)
// =&gt; minion walks from (2, 2) to (3, 3)
</code></pre>


<p>In addition to achieving data hiding with <em>closures</em> you can use <em>ES6 symbols</em>:</p>

<pre><code>function FlyingMinion(name='minion', hp=10){
  let position = Symbol('position');

  this.hp = hp;
  this.name = name;
  this.toString = () =&gt; this.name;

  this[position] = {x: 0, y: 0};
  this.fliesTo = (x,y) =&gt; {
    console.log(`${this} flies like the wind from (${this[position].x}, ${this[position].y}) to (${x}, ${y})`);
    this[position].x = x;
    this[position].y = y;
  };
};
</code></pre>


<p>And attain a similar behavior to that we saw with <em>closures</em>:</p>

<pre><code>// again you cannot access the position property (almost)
let flyingMinion = new FlyingMinion();
console.log(flyingMinion.position);
// =&gt; undefined

flyingMinion.fliesTo(1,1);
// =&gt; minion flies like the wind from (0, 0) to (1, 1)
flyingMinion.fliesTo(3,3);
// =&gt; minion flies like the wind from (1, 1) to (3, 3)
</code></pre>


<p>But you must remember how <a href="/blog/2015/11/23/an-introduction-to-object-oriented-programming-in-javascript-for-c-sharp-developers/"><em>ES6 symbols</em> don't offer true privacy since you can use <code>Object.getOwnPropertySymbols</code> to retrieve the symbols from an object and thus the "private" property</a>, so prefer using <em>closures</em> over <em>symbols</em>.</p>

<h2>Object Initializers vs Constructor Functions</h2>

<table class="table">
<thead>
<tr>
<th>object initializers</th>
<th>constructor functions</th>
</tr>
</thead>

<tbody>
<tr>
<td>
Easy to write, convenient and readable
</td>
<td>
Little bit more complicated. They look like normal functions but you need to implement them in a different way since the `new` will inject `this` as a new object
</td>
</tr>

<tr>
<td>
One-off creation of objects   
</td>
<td>
You can reuse them to create many objects                              
</td>
</tr>

<tr>
<td>
They only support information hiding via *ES6 symbols*      
</td>
<td>
They support information hiding via  ES6 symbols and closures             
</td>
</tr>

<tr>
<td>
Very simple syntax to define getters (read-only properties) and setters
</td>
<td>
The only way to define getters and setters is using low level Object methods like Object.defineProperty
</td>
</tr>

<tr>
<td>
You don't create subtypes and can't use `instanceof`, but it is much better to rely on polymorphism than checking types
</td>
<td>
Allows the creation of custom types  and enables the use of `instanceof`  
</td>
</tr>

<tr>
<td>
</td>
<td>
Calling a constructor function without the `new` operator can cause bugs and unwanted side effects if you don't take measures to allow it.
</td>
</tr>

</tbody>
</table>


<h2>Object Factories vs Constructor Functions</h2>

<p>When you combine <em>object initializers</em> with factories you get all the benefits from both <em>object initializers</em> and <em>constructor functions</em> with none of the weaknesses of <em>constructor functions</em>:</p>

<table class="table">

<thead>
<tr>
<th>Object initializers + factories</th>
<th>Constructor functions</th>
</tr>
</thead>

<tbody>

<tr>
<td>
Easy to write, convenient and readable. Factory functions really behave like any other other function, no need to worry about `this`            
</td>
<td>
Little bit more complicated. They look like normal functions but you need to implement them in a different way since the `new` will inject `this` as a new object   
</td>
</tr>

<tr>
<td>
You can reuse them to create many objects
</td>
<td>
You can reuse them to create many objects 
</td>
</tr>

<tr>
<td>
They support information hiding via *ES6 symbols* and closures
</td>
<td>
They support information hiding via *ES6 symbols* and closures
</td>
</tr>

<tr>
<td>
Very simple syntax to define getters (read-only properties) and setters
</td>
<td>
The only way to define getters and setters is using low level Object methods like Object.defineProperty
</td>
</tr>

<tr>
<td>
You don't create subtypes and can't use `instanceof`, but it is much better to rely on polymorphism than checking types
</td>
<td>
Allows the creation of custom types and enables the use of `instanceof`  
</td>
</tr>

<tr>
<td>
Factory functions works just like any other function. No need to use `new` and thus no need to remember to use it or guard from forgetting it. Very easy to compose with other functions
</td>
<td>
Calling a constructor function without the `new` operator can cause bugs and unwanted side effects if you don't take measures to allow it 
</td>
</tr>

</tbody><tbody>
</tbody></table>


<h2>Concluding</h2>

<p>In this article you learnt about the first piece of JavaScript Object Oriented Programming, <em>encapsulation</em>, and how you can achieve it using <em>object initializers</em>, <em>factory functions</em> and <em>constructor functions</em>.</p>

<p><em>Object initializers</em> resemble C# <em>object literals</em>. They are very straightforward to use and very readable, but you can only create one-off objects with them and they only allow for <em>information hiding</em> through ES6 symbols (which is just a step better from convention-based <em>information hiding</em>).</p>

<p>You can enhance your <em>object initializers</em> by wrapping them in <em>factory functions</em>. By doing that you gain the ability to create many objects of the same type and true <em>information hiding</em> via closures.</p>

<p>Finally you can also use <em>constructor functions</em> and the <code>new</code> operator as a method of <em>encapsulation</em> and to instantiate new objects. A <em>constructor function</em> lets you define the properties and methods of an object by augmenting <code>this</code> that is passed to the function as a new object when the function is called with the <code>new</code> operator. Because it is a function it supports <em>information hiding</em> with both ES6 symbols and closures. Although it is a function, it expects to be called with the <code>new</code> operator and have a <code>this</code> object to augment, so if it is called as a regular function it may cause bugs and have unexpected side-effects. We can guard against that problem by implementing a guard for when this happens.</p>

<p>In the next article you'll discover the next piece of JavaScript Object Oriented Programming: <em>prototypical inheritance</em>. See you then! Have a great day!</p>

</div>
					</div>
				</article>
				<!--================= END :: Tutorial =================-->
				
				<!--================= START :: Tutorial =================-->
				<article>
					<a id="t-86" name="t-86"></a><h1>86 : Summoning Fundamentals: A Three Part Introduction to OOP in JavaScript - II - Prototypical Inheritance</h1>
					<span class="ref-site">https://www.barbarianmeetscoding.com/blog/2015/12/07/summoning-fundamentals-a-three-part-introduction-to-oop-in-javascript-ii-inheritance/</span>
					<div class="tutorial__content">
<div class="entry-content">

<p>Thus far you've seen how we can achieve <em>encapsulation</em> in JavaScript by using either <em>object initializers</em> or <em>constructor functions</em> with the <code>new</code> operator. You have also learned how to attain <em>data hiding</em> through both <em>closures</em> and <em>ES6 symbols</em>. The next step is <strong>inheritance</strong> !</p>

<!-- more -->


<p>Inheritance in C#, either by deriving from an concrete class, an abstract class or by implementing an interface is a mechanism both of code reuse and of polymorphism. JavaScript however, being a dynamic language, achieves polymorphism by other means than inheritance, and keeps inheritance as just a means of code (or behavior) reuse and, in some cases, memory optimization.</p>

<p>Inheritance in JavaScript differs greatly from what you are accustomed to in C#. JavaScript supports a different flavor of inheritance that diverges very much from <em>traditional or class-based inheritance</em>.</p>

<p><strong>How does inheritance work in JavaScript?</strong></p>

<p>JavaScript exhibits what is known as <em>prototypical inheritance</em> where it is an object and not a class the one that acts as <em>blueprint</em>, <em>model</em> or <em>prototype</em> for other objects.</p>

<p><strong>Prototypical inheritance</strong> is all about objects being modeled after other objects, no room for classes here. Any object can be based on (or inherit from) a prototype and have additional specific properties and methods that build on top of that original prototype.</p>

<h2>Classical Inheritance vs Prototypical Inheritance</h2>

<p>At a high level, this is how C# classical inheritance compares to JavaScript prototypical inheritance:</p>

<table class="table">
<thead>
<tr>
<th>C# Classical Inheritance</th>
<th>JavaScript - Prototypical Inheritance</th>
</tr>
</thead>

<tbody>

<tr>
<td>
Focuses on classes
</td>
<td>
Focuses on objects
</td>
</tr>

<tr>
<td>
Classes cannot be modified at runtime: You define a class with a series of methods and properties and you cannot add new methods or properties, nor modify the existing ones at runtime.
</td>
<td>
Prototypes are more flexible and extensible than classes. They can be immutable but you can also extend them or modify them at runtime. When you do so you affect all objects that inherit that prototype.
</td>
</tr>

<tr>
<td>
You have classes, abstract classes, interfaces, override, virtual, sealed, etc
</td>
<td>
You mainly have objects. Depending on your preferences you have classes, constructor functions, etc. But overall it is simpler, it requires less elements and rules.
</td>
</tr>

<tr>
<td>
C# classes promote rigid taxonomies. This requires a lot of additional code and artifice to come to good designs
</td>
<td>
JavaScript prototypical inheritance is more flexible. Composing objects is very straightforward.
</td>
</tr>

<tr>
<td>
C# doesn't support multiple inheritance.
</td>
<td>
JavaScript lets you compose an object with as many prototypes as you want. (Concatenative inheritance)
</td>
</tr>

<tr>
<td>
C# has great support for information hiding
</td>
<td>
JavaScript achieves information hiding via closures and symbols.
</td>
</tr>

</tbody>
</table>


<p>Where C# focuses on classes and creating taxonomies, JavaScript focuses on objects and can achieve a class-free inheritance that is much more flexible and extensible than the C# counterpart. Where C# classes are immutable at runtime, JavaScript prototypes can be augmented or modified at runtime. Where C# provides a lot of keywords and constructs that let you be very thorough and explicit about how someone would interact or work with a class of your creation, JavaScript does away with these concepts in favor of a simpler inheritance model. Where C# provides a pretty clear path on how to do inheritance, JavaScript gives you so much freedom that it can be daunting at times.</p>

<p>Now that we've seen the differences between C# and JavaScript inheritance models, let's dive into <em>prototypical inheritance</em>.</p>

<h2>JavaScript Prototypical Inheritance</h2>

<p>We can distinguish between two types of <em>prototypical inheritance</em>:</p>

<p>The first one and most common is <em>delegation-based inheritance</em>. In <strong>delegation-based inheritance</strong> object and prototype establish what is known as a <em>prototypical chain</em> or <em>prototype chain</em> where property or method calls are dispatched or delegated from the object to the prototype.</p>

<p>The second is <strong>concatenative inheritance</strong> where an object is merged with a prototype and thus gains its properties and methods. The merge of object and prototype consists in copying or concatenating the properties of the prototype into the object.</p>

<p>But <em>what are object prototypes really</em>?</p>

<blockquote><h2>What About ES6 Classes? Don't They Bring Class-Based Inheritance to JavaScript?</h2>

<p>If you have had the opportunity to look at ES6 classes you may be wondering. <em>Well this looks like class-based inheritance, doesn't it?</em> Well the syntax is a little bit deceptive because although ES6 classes really look like C# classes the reality is very different: <strong>ES6 Classes are just syntactic sugar over the existing inheritance model</strong>.</p>

<p>We will dive deeper into ES6 classes later in these series and you'll be able to see the equivalent of a ES6 class in plain class-less JavaScript code.</p></blockquote>

<h2>Object Prototypes</h2>

<p>A prototype is, in essence, just an object. <em>How does an object become a prototype?</em> Well it depends if you use an <em>object initializer</em>, <em>Object.create</em> or a <em>constructor function</em> to create your objects. Let's take a look at all of these approaches.</p>

<p><em>You can <a href="http://bit.ly/javascriptmancy-oop-fundamentals-inheritance">experiment with all examples in this article directly within this jsBin</a>.</em></p>

<h3>Object Prototypes with Object Initializers</h3>

<p>If you use <em>object initializers</em> you can define a <em>prototype</em> by setting the <code>__proto__</code> property of an object to another object that will effectively become a <em>prototype</em>. For instance, if we have the <code>minion</code> from previous examples:</p>

<pre><code>let minion = {
  hp: 10,
  name: 'minion',
  toString(){ return this.name;}
};
</code></pre>


<p>And then we devise a new spell to summon a <code>giantScorpion</code>. We can set <code>minion</code> as a prototype of <code>giantScorpion</code> by using its <code>__proto__</code> property (<em>available from ES6</em> <sup id="fnref:1"><a href="#fn:1" rel="footnote">1</a></sup>).</p>

<pre><code>let giantScorpion = {
  '__proto__': minion, // here we set the minion as prototype
  name: 'scorpion',
  stings() {
    console.log(`${this} pierces your shoulder with its venomous sting`);
  }
}
</code></pre>


<p>And TaDa! Now <code>minion</code> is the prototype of <code>giantScorpion</code>, that is, there is a <em>prototypical inheritance</em> relationship between them. If we try to access properties that only exist in <code>minion</code> via <code>giantScorpion</code> we will be able to see the <em>prototypical chain</em> in action:</p>

<pre><code>// access a prototype property via prototype chain
console.log(`giant scorpion has ${giantScorpion.hp} hit points`);
// =&gt; giant scorpion has 10 hit points
</code></pre>


<p>Indeed we can see how <code>giantScorpion</code> which doesn't have an <code>hp</code> property itself is accessing the <code>hp</code> property of its prototype. And <em>what happens with the <code>name</code> property that is shared by both?</em></p>

<pre><code>// if a property is shared between an object and its prototype
// there's no need to traverse the prototype chain
// the nearest property wins
giantScorpion.stings();
// =&gt; scorpion pierces your shoulder with its venomous sting
</code></pre>


<p>In this example we call the <code>stings</code> method that in turn calls the <code>toString</code> method which returns <code>this.name</code>. Because the <code>name</code> variable exists in the <code>giantScorpion</code> object, there's no need to traverse the <em>prototypical chain</em>. As a result the property <code>giantScorpion.name</code> is used to generate the string representation of <code>giantScorpion</code> and we get <code>"scorpion pierces your shoulder..."</code> (instead of <code>"minion pierces your shoulder..."</code>).</p>

<p>From here on you have two options in regards to how to use your prototype, you can use one prototype instance per object instance or share a prototype across many objects. While there's nothing stopping you from one prototype per object, the real benefits of inheritance in terms of code reuse come from sharing the same prototype across several objects:</p>

<pre><code>let smallScorpion = {
  '__proto__': minion, // here we set the minion as prototype
  name: 'small scorpion',
  stings() {
    console.log(`${this} pierces your shoulder with its tiny venomous sting`); }
};
let giantSpider = {
  '__proto__': minion, // here we set the minion as prototype
  name: 'giant spider',
  launchWeb() {
    console.log(`${this} launches a sticky web and immobilizes you`); }
};
</code></pre>


<p>Where the properties and methods in <code>minion</code> are contained within a single object. Whereas if we ignored inheritance we would need to define and allocate them in each specific derived object (in this case <code>giantScorpion</code>, <code>smallScorpion</code> and <code>giantSpider</code>) with the additional memory footprint.</p>

<p>You may be wondering, <em>wait, the <code>minion</code> object had a property <code>hp</code>, doesn't that mean that all derived objects are coupled? That if I change <code>hp</code> in one object it will affect all others?</em></p>

<p>Well spotted! When you use the same prototype with several objects you want to avoid storing state in your prototype. While having properties with primitive values such as <code>numbers</code> and <code>strings</code> won't couple your objects, having properties with arrays or objects as values will definitely couple them. This can be better illustrated with an example.</p>

<p>First, if you try to set the value of a property located in your prototype you'll just create a new property in the derived object that will shadow that of the <em>prototype</em>. Properties with primitive values in <em>prototypes</em> act sort of as <em>initial or default values</em>:</p>

<pre><code>console.log(`Small scorpion has ${smallScorpion.hp} hp`);
// =&gt; Small scorpion has 10 hp
smallScorpion.hp = 22;

console.log(`Small scorpion has ${smallScorpion.hp} hp`);
// =&gt; Small scorpion has 22 hp

console.log(`Giant Spider *still* has ${giantSpider.hp}`);
// =&gt; Giant spider still has 10 hp
</code></pre>


<p>If you however try to interact with prototype properties holding objects or arrays, all objects that share that prototype will be affected (since they share the same prototype and the same reference to these properties):</p>

<pre><code>// Imagine that a minion had a stomach
// what a wonderful thing stomachs are
minion.stomach = [];

// if a giant scorpion eats an elf
giantScorpion.stomach.push('elf')
// we can verify that yeah, it has eaten an elf
console.log(`giant scorpion stomach: ${giantScorpion.stomach}`);
// =&gt; giant scorpion stomach: elf

// but so has the spider
console.log(`giant spider stomach: ${giantSpider.stomach}`);
// =&gt; giant spider stomach: elf
// Waaaat!?
</code></pre>


<p><strong>So the most common practice when you share a prototype across many objects is to only place methods in the prototype, and keep the state in the object itself</strong>.</p>

<p>By the by, <em>did you notice something special in the previous example?</em> I added a <code>stomach</code> property to <code>minion</code> and magically all objects with that prototype got access to that property.</p>

<p>Well a very interesting characteristic of <em>prototypical inheritance</em> is that it allows you to augment all objects that share a prototype at runtime by augmenting the <em>prototype</em> itself. This means that if we add a new method <code>eats</code> to <code>minion</code>:</p>

<pre><code>// A cool thing is that if you augment a prototype
// you automatically augment all its derived objects
minion.eats = function(food){
  console.log(`${this} eats ${food} and gains ${food.hp} health`);
  this.hp += food.hp;
};
</code></pre>


<p>All objects that have <code>minion</code> as prototype will automatically gain that method by virtue of the <em>prototype chain</em>:</p>

<pre><code>giantScorpion.eats({name: 'hamburger', hp: 10, toString(){return this.name}});
// =&gt; scorpion eats hamburger and gains 10 health 
smallScorpion.eats({name: 'ice cream', hp: 1, toString(){return this.name}});
// =&gt; scorpion eats ice cream and gains 11 health 
giantSpider.eats({name: 'goblin', hp: 100, toString(){return this.name}});
// =&gt; giant spider eats hamburger and gains 100 health 
</code></pre>


<p><em>Awesome right?</em></p>

<h2>Object Prototypes with Object.Create or OLOO</h2>

<p><code>__proto__</code> is in an Annex of the ECMA standard and only works in browsers. If you don't feel comfortable with this, or you are working with JavaScript in another environment like <em>node.js</em> then you can use <em>ES5</em> <code>Object.create</code>.</p>

<p><code>Object.create</code> let's you create a new object that will have as prototype another object of your choice. It works like a factory function for creating objects with a given <em>prototype</em>. For instance, if we adapt this example:</p>

<pre><code>let giantScorpion = {
  '__proto__': minion, // here we set the minion as prototype
  name: 'scorpion',
  stings() {
    console.log(`${this} pierces your shoulder with its venomous sting`);
  }
}
</code></pre>


<p>To use <code>Object.create</code> it would look like this:</p>

<pre><code>let newGiantScorpion = Object.create(minion);
newGiantScorpion.name = 'scorpion';
newGiantScorpion.stings = function(){
    console.log(`${this} pierces your shoulder with its venomous sting`);
};
</code></pre>


<p>Just like with <code>__proto__</code> the result of this snippet of code is a new object <code>newGiantScorpion</code> with a couple of properties (<code>name</code> and <code>strings</code>) that has the <code>minion</code> object as prototype.</p>

<p>You can achieve a more compact syntax if you use <em>ES6</em> <code>Object.assign</code>:</p>

<pre><code>let newGiantScorpion = Object.create(minion);
Object.assign(newGiantScorpion, /* new giant scorpion properties */{
    name: 'scorpion',
    stings(){
    console.log(`${this} pierces your shoulder with its venomous sting`);
    }
};
</code></pre>


<p><code>Object.assign</code> copies the properties from one (or several) objects into a target object of your choice (in this case <code>newGiantScorpion</code>).</p>

<h2>Defining Prototypes with Constructor Functions</h2>

<p>Defining objects as prototypes with <em>constructor functions</em> works in a slightly different way than with <em>object initializers</em> and <em>Object.create</em>. Imagine that we have a <code>TeleportingMinion</code> that can teletransport itself wherever it desires:</p>

<pre><code>//let minion = {
//  hp: 10,
//  name: 'minion',
//  toString(){ return this.name;}
//};

// prototype inheritance works slightly different with constructor functions
function TeleportingMinion(){
    let position = {x: 0, y: 0};
    this.teleportsTo = function(x, y){
  console.log(`${this} teleports from (${position.x}, ${position.y}) to (${x}, ${y})`);
      position.x = x;
      position.y = y;
    };
    this.healthReport = function(){
  console.log(`${this} has ${this.hp} health. It looks healthy.`);
    };
}
</code></pre>


<p>In this case where we have a <em>constructor function</em>, instead of using the <code>__proto__</code> property we assign the prototype to the <code>prototype</code> property of the <em>constructor function</em>, that is:</p>

<pre><code>TeleportingMinion.prototype = minion;
TeleportingMinion.prototype.constructor = TeleportingMinion;
</code></pre>


<p>From his point forward every object that we create with this <em>constructor function</em> will have the <code>minion</code> object as prototype:</p>

<pre><code>let oneCrazyTeleportingMinion = new TeleportingMinion();
oneCrazyTeleportingMinion.healthReport();
// =&gt; minion has 10 health. It looks healthy.

let anotherCrazyTeleportingMinion = new TeleportingMinion();
anotherCrazyTeleportingMinion.healthReport();
// =&gt; minion has 10 health. It looks healthy.
</code></pre>


<h2>Creating Longer Prototype Chains</h2>

<p>You are not limited to a one level deep <em>prototype chain</em> with just an object and a <em>prototype</em>, you can create big inheritance structures just like in C#.</p>

<p>Let's say that we want to create a <code>wizard</code>. We can make it inherit from the <code>TeleportingMinion</code>:</p>

<pre><code>let wizard = {
   '__proto__': new TeleportingMinion(),
   name: 'Evil wizard',
   castsFireballSpell(target){
     console.log(`${this} casts fireball spell and obliterates ${target}`);
   }
};
</code></pre>


<p>Effectively establishing a <em>prototype chain</em> that looks like <code>wizard =&gt; teleportingMinion =&gt; minion</code> where our new object <code>wizard</code> now inherits the behavior of a <code>teleportingMinion</code> and a <code>minion</code>:</p>

<pre><code>// the wizard can cast fireballs
wizard.castsFireballSpell('sandwich');
// =&gt; Evil wizard casts fireball spell and obliterates sandwich
// damn that was my last sandwich

// it can teleport
wizard.teleportsTo(1,2);
// =&gt; Evil wizard teleports from (0, 0) to (1, 2)

// and it has hit points
wizard.healthReport();
// =&gt; Evil wizard has 10 health. It looks healthy.
</code></pre>


<p>And we can do the same with <em>constructor functions</em>, this time with a <code>Druid</code>:</p>

<pre><code>// you can do the same with a constructor function
function Druid(){
  this.name = 'Druid of the Forest';
  this.changesSkinIntoA = function(skin){
    console.log(`${this} changes his skin into a ${skin}`);
  }
}
</code></pre>


<p>This time instead of using the <code>__proto__</code> property we use <code>Druid.prototype</code> and create a <em>prototype chain</em> like <code>Druid =&gt; teleportingMinion =&gt; minion</code>:</p>

<pre><code>Druid.prototype = new TeleportingMinion();
Druid.prototype.constructor = Druid;
</code></pre>


<p>And now any <code>druid</code> object that we instantiate using the <code>new</code> operator on the <code>Druid</code> constructor function will inherit all its mighty abilities from <code>teleportingMinion</code> and <code>minion</code>:</p>

<pre><code>let druid = new Druid();

// the druid can change skin
druid.changesSkinIntoA('wolf');
// =&gt; Druid of the Forest changes his skin into a wolf

// it can teleport
druid.teleportsTo(2,2);
// =&gt; Druid of the Forest teleports from (0, 0) to (2, 2)

// and has hit points
druid.healthReport();
// =&gt; Druid of the Forest has 10 health. It looks healthy.
</code></pre>


<h2>What About Concatenative Protypical Inheritance?</h2>

<p>In this first dive into OOP we are going to go from <em>prototypical</em> inheritance, to mimicking <em>classical inheritance</em> and to <em>ES6 classes</em>, the most natural path for a C# developer coming to JavaScript. The flavor of <em>prototypical inheritance</em> that enables having a similar inheritance flow to that of classes is the <em>delegation-based inheritance</em> and that's why we have focused on it first.</p>

<p>We will come back to <em>concatenative inheritance</em> and object composition after we've reviewed <em>ES6 classes</em>. Stay tuned!</p>

<h2>Object Initializers vs Object.create vs Constructor Functions</h2>

<table class="table">
<thead>
<tr>
<th>Object Initializers __proto__</th>
<th>Object.create OLOO</th>
<th>Constructor Functions</th>
</tr>
</thead>

<tbody>

<tr>
<td>
Very simple and readable way to setup prototypical inheritance.
</td>
<td>
Simple way to setup prototypical inheritance. Less terse than initializers. You can use `Object.assign` to make it more terse.
</td>
<td>
Less straightforward as you set the prototype of the *constructor function* and not an object.
</td>
</tr>

<tr>
<td>
Need to set it every time you create an object unless you use a factory function.
</td>
<td>
Need to set it every time you create an object unless you use a factory function.
</td>
<td>
Set it once on the *constructor function* and it is reused for all instances created afterwards.
</td>
</tr>


<tr>
<td>
It is only reliable in ES6 and on web browers.
</td>
<td>
Available from ES5 (on all modern browsers and other JS environments).j
</td>
<td>
Supported in any environment.
</td>
</tr>


<tr>
<td>
Simple syntax for defining getters and setters.
</td>
<td>
Can only define getters and setters via `Object.defineProperty`
</td>
<td>
Can only define getters and setters via `Object.defineProperty`
</td>
</tr>

</tbody>
</table>


<h2>Concluding</h2>

<p>Let's summarize what you've learned so far about <em>prototypical inheritance</em>. JavaScript doesn't have the concept of <em>traditional class-based inheritance</em> since it doesn't have real classes. Instead JavaScript <em>inheritance</em> revolves around objects, just simple objects. You can use any object as a <em>prototype</em> and create new objects that are based on this prototype and that can inherit properties and methods from it.</p>

<p>In order to establish an <em>inheritance relationship</em> between an object and a <em>prototype</em> you can either use the <code>__proto__</code> property within an <em>object initializer</em>, <code>Object.create</code> or the <code>prototype</code> property within a <em>constructor function</em>. The two first methods that completely prescind of functions are also called <em>OLOO</em> (Objects Linked to Other Objects) and provide a simpler approach to <em>prototypical inheritance</em> as there's one less element you need to think about (the <em>constructor function</em>). You can have an <em>inheritance tree</em> with many levels of depth where an object has a <em>prototype</em> which in turn has a <em>prototype</em>, and so on.</p>

<p>Whenever you try to access a property or method of an object that has a prototype the JavaScript runtime will try to find that property or method within the object itself, if it can't find it, it will continue down the <em>prototypical chain</em> until it finds it. This is known as <em>delegation-based inheritance</em> and is the most common flavor of <em>prototypical inheritance</em> in JavaScript. If you use the same prototype object for several objects in this delegating fashion you should avoid storing state in the <em>prototype</em> since it may couple all your "derived" objects.</p>

<p>There's also <em>concatenative inheritance</em> which consists on copying properties from a prototype to an object and which leads to object composition. We will take a look into that later within the series.</p>













<div class="footnotes">
<hr>
<ol>
<li id="fn:1">
<p>The <code>__proto__</code> property has been available in some browsers prior to ES6 but it wasn't part of the ECMA standard up until ES6. Because it not being part of any standard and thus not having a specific defined behavior it was very unreliable to use. With ES6 you can use it with your object initializers as it makes very easy to understand the prototype chain. <code>__proto__</code> only works on browsers, if you are working with node you can use Object.create and follow a very similar flow.<a href="#fnref:1" rev="footnote">↩</a></p></li>
</ol>
</div>

</div>
					</div>
				</article>
				<!--================= END :: Tutorial =================-->
				
				<!--================= START :: Tutorial =================-->
				<article>
					<a id="t-87" name="t-87"></a><h1>87 : Summoning Fundamentals: A Three Part Introduction to OOP in JavaScript for C# Developers - III - Polymorphism</h1>
					<span class="ref-site">https://www.barbarianmeetscoding.com/blog/2015/12/09/summoning-fundamentals-a-three-part-introduction-to-oop-in-javascript-for-csharp-developers-iii-polymorphism/</span>
					<div class="tutorial__content">
<div class="entry-content">

<p>In the last two chapters of these OOP mini-series we discussed the pillars of OOP in JavaScript – encapsulation, information hiding and inheritance – and how they differ from what we are accustomed to in C#. In this last chapter we discuss <em>polymorphism</em> and how JavaScript makes it dead simple with the concept of <strong>duck typing</strong>.</p>

<h2>Polymorphism in C#</h2>


<blockquote><p><em>Polymorphism</em> allows a function to be written to take an object of a certain type T, but also work correctly if passed an object that belongs to a type S that is a subtype of T</p></blockquote>

<p><em>Polymorphism</em> is a mechanism that we have in static and strongly typed languages to reuse algorithms or computation on different types. These  types must have a type in common by either deriving from a shared base class or by means of implementing the same interface.</p>

<p>Imagine that you are building an army to rule the known world. You have diverse types of minions in this army of the undead (they are cheaper to maintain, skeletons need no food, and ghouls are not really picky about their food):</p>

<p><em>You can <a href="http://bit.ly/javascriptmancy-oop-fundamentals-polymorphism">experiment with all examples in this article directly within this jsBin</a>.</em></p>

<pre><code>public class Skeleton{
  public int Health {get;set;}
  private Position position;
  
  public Skeleton(){
      Health = 50;
      position = new Position();
  }

  public void MovesTo(int x, int y){
      position.X = x;
      position.Y = y;
  }
}
</code></pre>


<p>An skeleton that can only move is not a very useful weapon, so you need to give it the ability to attack your enemies:</p>

<pre><code>public class Skeleton{
  public int Health {get;set;}
  private int damage;
  private Position position;
  
  public Skeleton(){
      Health = 50;
      damage = 10;
      position = new Position();
  }
  
  public void MovesTo(int x, int y){
      position.X = x;
      position.Y = y;
  }

    public void Attacks(Skeleton enemySkeleton){
        enemySkeleton.Health -= damage;
    }
}
</code></pre>


<p>Ok, now you have a skeleton that can attack other skeletons! Yippi! Let's image that your most bitter enemy has a vast army of goblins:</p>

<pre><code>public class Goblin{
    public int Hp {get;set;}

  public void MovesTo(int x, int y){
      position.X = x;
      position.Y = y;
  }
}
</code></pre>


<p>A <code>Goblin</code> is not a <code>Skeleton</code> and therefore your skeletons are going to have a hard time beating that army as of right now. You decide to teach them how to beat goblins up:</p>

<pre><code>public void Attacks(Skeleton enemySkeleton){
    enemySkeleton.Health -= damage;
}

public void Attacks(Goblin goblin){
    goblin.Health -= damage;
}
</code></pre>


<p>And then find out that not only has he goblins, but also orcs, trolls, wargs and wyrms.</p>

<pre><code>public void Attacks(Skeleton enemySkeleton){
    enemySkeleton.Health -= damage;
}

public void Attacks(Goblin goblin){
    goblin.Health -= damage;
}

public void Attacks(Orc orc){
    orc.Health -= damage;
}

public void Attacks(Troll troll){
    troll.Health -= damage;
}

public void Attacks(Warg warg){
    warg.Health -= damage;
}

public void Attacks(Wyrm wyrm){
    wyrm.Health -= damage;
}
</code></pre>


<p>And this got out of hand reaaaally fast. This is one scenario in which <em>polymorphism</em> could come in handy. We can take advantage of <em>polymorphism</em> by defining a common base class for all these creatures that would encapsulate the needed contract for <em>being attacked</em> which is the <code>Health</code> property:</p>

<pre><code>public class Monster{
   public int Health {get;set;}
}
public class Skeleton : Monster {}
public class Goblin : Monster {}
public class Orc : Monster {}
public class Troll: Monster {}
// etc
</code></pre>


<p>and redefining the <code>Attacks</code> method in term of that new type:</p>

<pre><code>public void Attacks(Monster monster){
    monster.Health -= damage;
}
</code></pre>


<p>Of course we would also like our minions to be able to attack defensive structures like towers, or walls, or fences which are most definitely not monsters. In which case it would perhaps be more appropriate to use an interface instead to represent that contract of something being attacked:</p>

<pre><code>public interface IAttackable {
   int Health {get;set;}
}
public class Monster : IAttackable{
   public int Health {get;set;}
}
public class Skeleton : Monster {}
public class Goblin : Monster {}
// etc
public class Tower: IAttackable {}
public class Fence: IAttackable {}
// etc
</code></pre>


<p>Again we redefine the <code>Attacks</code> method to be even more abstract and applicable to any type that implements the <code>IAttackable</code> interface be it a creature, a defensive structure, or a sandwich:</p>

<pre><code>public void Attacks(IAttackable target){
    target.Health -= damage;
}
</code></pre>


<p>In summary, in this example we rewrote the <code>Attacks</code> method to take advantage of <em>polymorphism</em> so that our <code>Skeleton</code> can attack anything that implements that <code>IAttackable</code> interface.</p>

<p>From being able to attack only Skeletons, we went to attacking many types of monsters implemented with many many functions, to reduce that to a single function thanks to <em>polymorphism</em>. The benefits don't come only from the fact that we have a single function instead of many, but from the increased extensibility of this new solution. Thanks to <em>polymorphism</em> this <code>Attacks</code> function will work with new creatures, defensive structures, and virtually anything that hasn't been thought of yet as long as it implements the contract defined by the <code>IAttackable</code> interface.</p>

<h2>Polymorphism in JavaScript</h2>

<p><em>Polymorphism</em> in JavaScript is much simpler than in C#. As a dynamically typed language, JavaScript exhibits what is known as <em><a href="http://en.wikipedia.org/wiki/Duck_typing">duck typing</a></em>, whereby an object's semantics are based on the object's own methods and properties and not on the inheritance chain or interface implementations (like in C#). This means that if an object has the interface required by a function it will just work. Let's see JavaScript <em>duck typing</em> with the same example from the previous section:</p>

<pre><code>let skeleton = {
    health: 50,
    damage: 10,
    position: {x: 0, y: 0},
    toString() {
      return 'Skeleton';
    },
    movesTo(x, y){
        this.position.x = x;
        this.position.y = y;
    },
    attacks(monster){
        monster.health -= this.damage;
        console.log(`${this} attacks ${monster} fiercely!`);
    }
}
</code></pre>


<p>When we define the <code>attacks</code> method as illustrated above, the only thing JavaScript cares about in what regards to <code>monster</code> is that it has a <code>health</code> property:</p>

<pre><code>let orc = { name: 'orc', health: 100, toString(){return this.name;}};
let goblin = {health: 10, toString(){return 'goblin';}};
let tower = {health: 1000, toString(){ return 'fortified tower';}};

skeleton.attacks(orc);
// =&gt;
skeleton.attacks(goblin);
// =&gt;
skeleton.attacks(tower);
</code></pre>


<p>JavaScript doesn't care about the type of <code>monster</code>, it only cares about it exposing a matching interface <code>monster.health</code>. We push this point even further in this example:</p>

<pre><code>skeleton.attacks.health = 50;
skeleton.attacks(skeleton.attacks);
// =&gt; Skeleton attacks function attacks(monster) { ...
// OMG that was so meta

console.log(skeleton.attacks.health);
// =&gt; 40
</code></pre>


<p>So, as long as an object has a <code>health</code> property, it will behave as something that can be attacked as defined by the <code>attacks</code> method regardless of inheritance. And thus the popular saying that you may have heard before regarding <em>duck typing</em>…</p>

<blockquote><p>If it walks like a duck, swims like a duck and quacks like a duck, I call it a duck.</p></blockquote>

<p>If it has a <code>health</code> property, then it is something that can be attacked. And this is why in previous articles I claimed that inheritance is not a means of <em>polymorphism</em> in JavaScript in the same way that it is in C#. Let's see a summary of the differences between C# <em>polymorphism</em> and JavaScript <em>duck tiping</em>:</p>

<table class="table">
<thead>
<tr>
<th>C# Polymorphism</th>
<th>JavaScript Duck Typing</th>
</tr>
</thead>
<tbody>

<tr>
<td>
Deriving from a base class or implementing an interface is going to determine whether or not you can use *polymorphism* with a particular type.
</td>
<td>
In JavaScript it all comes down to having the expected properties or methods when an object is evaluated.
</td>
</tr>

<tr>
<td>
In C# you establish an explicit expectation about which type can be used within a function in the function's signature.
</td>
<td>
In JavaScript the expectation is determined by how an object is used within a function implementation.
</td>
</tr>

<tr>
<td>
In order to take advantage of polymorphism you need to be very intentional about it since it requires a specific architecture in your application. In practice, it means that you'll need to create additional classes or interfaces.
</td>
<td>
JavaScript duck typing gives you the most granular level of polymorphism with no additional investment required. You don't need to create additional classes or equivalents.
</td>
</tr>


<tr>
<td>
The intent of the author of the code is very clear since polymorphism only works if the right structures are in place. The extensibility points are very explicit in C#.
</td>
<td>
In JavaScript any point is extensible.
</td>
</tr>

</tbody>
</table>


<h2>Concluding</h2>

<p>In this article we did a short review of the concept of <em>polymorphism</em> in C# and how you can use it as a mechanism of code reuse and as a means of creating extensible applications.</p>

<p>You learned how <em>polymorphism</em> works in JavaScript with the concept of <em>duck typing</em>, the idea that <strong>an object is not defined by what it is but by what it can do</strong>. Thus if something walks like a duck, swims like a duck and quacks like a duck then you treat it like a duck.</p>

<p>We wrapped the article with a brief comparison between C# <em>polymorphism</em> and JavaScript <em>duck typing</em> and how the latter can achieve everything C# can with far less code and a simpler design.</p>
</div>
					</div>
				</article>
				<!--================= END :: Tutorial =================-->
				
				<!--================= START :: Tutorial =================-->
				<article>
					<a id="t-88" name="t-88"></a><h1>88 : White Tower Summoning: Mimicking C# Classical Inheritance in JavaScript</h1>
					<span class="ref-site">https://www.barbarianmeetscoding.com/blog/2015/12/14/white-tower-summoning-mimicking-c-sharp-classical-inheritance-in-javascript/</span>
					<div class="tutorial__content">
<div class="entry-content">

<p>In this article we are going to take a deep-dive into how to emulate <em>classical inheritance</em> in JavaScript and get to the nearest equivalent to what you are accustomed to in C#. We will focus in the alternatives we had prior to <em>ES6 classes</em> so that you can work with <em>classes</em> even if you are stuck in <em>ES5</em> and so that you can understand the underlying implementation of <em>ES6 classes</em> which are just syntactic sugar over the JavaScript <em>prototypical inheritance</em> model.</p>

<!-- more -->


<p>We will start by emulating a single C# <em>class</em> in JavaScript and attempt to find equivalents to C# constructs like access modifiers, static classes and method overloading. We will then continue by expanding our knowledge from a single class to many, in order to arrive to something similar to C# <em>classical inheritance</em>. Something that will let you work in JavaScript just like you usually do in C#, building <em>class</em> taxonomies and working with instances of <em>classes</em>.</p>

<blockquote><h2>Can I Just Jump Over to ES6 Classes Directly?</h2>

<p>In this article we are going to focus completely in learning how you can implement <em>classes</em> and <em>classical inheritance</em> in JavaScript without using <em>ES6 classes</em>. This is important because it will teach you how to do a <em>class</em> equivalent in <em>ES5</em>, what lies behind <em>ES6 classes</em> and how <em>ES6 classes</em> relate to the rest of JavaScript.</p></blockquote>

<h2> Emulating a C# Class in JavaScript</h2>


<p>In order to create the equivalent of a <em>class</em> in JavaScript you need to combine a <em>constructor function</em> with a <em>prototype</em>. Let's do a quick review of each of these constructs and see how combining them results in something similar to a C# class.</p>

<blockquote><p>I am going to be using the word <em>class</em> a lot and I am going to be referring to a <em>constructor function</em> and <em>prototype</em> pair, the equivalent to C# <em>classes</em> in JavaScript prior to <em>ES6</em>.</p>

<p>I won't refer to <em>ES6 classes</em> unless I say <em>ES6 classes</em>.</p></blockquote>

<h3>Constructor Functions</h3>

<p><em>You can <a href="http://bit.ly/javascriptmancy-oop-classical-inheritance">experiment with all examples in this article directly within this jsBin</a>.</em></p>

<p><em>Constructor functions</em> allow us to create objects that share the same properties. They work as a recipe for object creation and represent a custom type:</p>

<pre><code>function Barbarian(name){
    this.name = name;
    this["character class"] = "barbarian";
    this.hp = 200;
    this.weapons = [];
    this.talks = function(){
        console.log("I am " + this.name + " !!!");
    };
    this.equipsWeapon = function(weapon){
        weapon.equipped = true;
        this.weapons.push(weapon);
    };
    this.toString = function(){
        return this.name;
    };
}
</code></pre>


<p>Notice how the <em>constructor</em>, not only initializes an object with a set of values like in C#, but it also determines which properties an object is going to have. This means that a <em>constructor function</em> works effectively as both a <em>constructor</em> and a <em>class</em> definition.</p>

<p>Having defined a <em>constructor function</em> you can create an instance by using the <code>new</code> keyword just like in C#:</p>

<pre><code>let conan = new Barbarian("Conan, the Barbarian");
conan.equipsWeapon({
        name: "two-handed sword",
        type: "sword",
        damage: "2d20+10",
        material: "cimmerian steel",
        status: "well maintained"
    });
</code></pre>


<p>This new instance is of type <code>Barbarian</code> and all its properties are publicly available:</p>

<pre><code>console.log(`Conan is a Barbarian: ${conan instanceof Barbarian}`);
// =&gt; Conan is a Barbarian: true
console.log(`Conan is an Object: ${conan instanceof Barbarian}`);
// =&gt; Conan is an Object: true
conan.talks();
// =&gt; I am Conan, the Barbarian!!!
console.log(conan.name);
// =&gt; Conan, The Barbarian"
console.log(`Conan has these weapons: ${conan.weapons}`);
// =&gt; Conan has these weapons: two-handed sword
</code></pre>


<h3>Prototypical Inheritance</h3>

<p>In previous articles of these series we saw how inheritance in JavaScript is slightly different than what we are accustomed to in C#. For one, there are no <em>classes</em>. Furthermore, inheritance doesn't play as big a part in polymorphism since JavaScript is a dynamically typed language that relies in <em>duck typing</em>.</p>

<p>JavaScript is all about objects, and achieves inheritance not via <em>class inheritance</em> but via <strong>prototypical inheritance</strong>, that is, objects that inherit from other objects which act as prototypes (a sort of blueprint).</p>

<h3>Prototypes</h3>

<p>Every <em>constructor function</em> (and every function) in JavaScript has a <code>prototype</code> property. This property holds an object that will act as a <em>prototype</em> – will provide shared properties – for all objects created by calling the <em>constructor function</em> with the <code>new</code> keyword. The <code>prototype</code> object also has a <code>constructor</code> property that points back to the <em>constructor</em> function:</p>

<pre><code>// every function has a prototype property
console.log(`Barbarian.prototype: ${Barbarian.prototype}`);
// =&gt; Barbarian.prototype: [object Object]

// and the prototype has a constructor property that points back to the function
console.log(`Barbarian.prototype.constructor: ${Barbarian.prototype.constructor}`);
// =&gt; Barbarian.prototype.constructor: function Barbarian(name) {...}
</code></pre>


<p>We can verify how all objects instantiated using that <em>constructor function</em> will inherit properties and methods from the <code>prototype</code> object. If we take the <em>prototype</em> from the previous example, we extend it with a simple <code>saysHi</code> function and we instantiate two rough barbarians like this:</p>

<pre><code>Barbarian.prototype.saysHi = function (){ console.log("Hi! I am " + this.name);}
var krull = new Barbarian("krull");
krull.saysHi();
// =&gt; Hi! I am krull
var conan = new Barbarian("Conan");
conan.saysHi();
// =&gt; Hi! I am Conan
</code></pre>


<p>We can appreciate how both objects <code>krull</code> and <code>conan</code> expose the <code>saysHi</code> method even though it wasn't part of the <code>Barbarian</code> <em>constructor function</em>. This is possible due to the <em>prototype chain</em> existing between object (<code>krull</code>) and <em>prototype</em> (<code>Barbarian.prototype</code>) which allows the object to delegate method calls to the <em>prototype</em>.</p>

<p>A common idiom to avoid the need to write the <code>Function.prototype.property</code> each time you want to augment the prototype is to assign the <em>prototype</em> to a new object:</p>

<pre><code>Barbarian.prototype = {
  constructor: Barbarian
  saysHi: function(){console.log("Hi! I am " + this.name);}
}
</code></pre>


<p>So this that you saw was the simplest JavaScript inheritance scenario. In this scenario you have an object (<code>krull</code>) that inherits properties from another object (<code>Barbarian.prototype</code>). In a more common scenario you may have several custom prototypes in your inheritance hierarchy:</p>

<pre><code>// Inheritance Hierarchy:
//   Barbarian -&gt; DrawableGameObject -&gt; GameObject -&gt; Object

function GameObject(){
    // common logic for a game object within a game engine
    // like being part of a game loop
}

function DrawableGameObject(){
    // common logic for a game object that can be drawn in a screen
}
DrawableGameObject.prototype = Object.create(GameObject.prototype);
DrawableGameObject.constructor = DrawableGameObject;

// function Barbarian(){}
// we change the prototype from the previous examples to now be a 
// new object that in turn has a DrawableGameObject prototype
Barbarian.prototype = Object.create(DrawableGameObject.prototype);
Barbarian.prototype.constructor = Barbarian;
</code></pre>


<p>In this example we use the <code>Object.create</code> function that we saw in previous articles to create a new object with a specific prototype. For instance, <code>Object.create(GameObject.prototype)</code> creates a new object that has <code>GameObject.prototype</code> as <em>prototype</em>, that is, the <em>prototype</em> of the <code>GameObject</code> custom type .</p>

<p>You can use the <code>instanceof</code> operator to verify that indeed <code>Barbarian</code> is a subtype of <code>DrawableGameObject</code> and <code>GameObject</code>:</p>

<pre><code>var krom = new Barbarian();
console.log(`krom is Barbarian: ${krom instanceof Barbarian}`);
// =&gt; krom is Barbarian: true
console.log(`krom is DrawableGameObject: ${krom instanceof DrawableGameObject}`);
// =&gt; krom is DrawableGameObject: true
console.log(`krom is GameObject: ${krom instanceof GameObject}`);
// =&gt; krom is GameObject: true
</code></pre>


<p>Additionally, if you need to know whether a property is part of the object itself or part of the prototype you can use the <code>hasOwnProperty</code> method:</p>

<pre><code>console.log(
  `conan has a property called name: ${conan.hasOwnProperty("name")}`);
// =&gt; conan has a property called name: true
console.log(
  `conan has a property called saysHi: ${conan.hasOwnProperty("saysHi")}`);
// =&gt; conan has a property called saysHi: false
</code></pre>


<p>Now that we have reviewed both <em>constructor functions</em> and <em>prototypes</em> let's see how putting them together brings us nearer to C# <em>inheritance model</em>.</p>

<h2>Constructor Function + Prototype = Class</h2>

<p>The nearest equivalent to a C# <em>class</em> in JavaScript is a <em>constructor function</em> and a <em>prototype</em> pair. Each carry out different tasks:</p>

<ul>
<li>The <em>constructor function</em> defines a custom type with a series of properties. It will determine which specific properties each instance of that custom type is going to have.</li>
<li>The <em>prototype</em> provides a series of methods that are shared across all instances of a given type. It is also the bridge between classes and the means to achieve <em>class</em> inheritance by connecting them through a <em>prototype chain</em>.</li>
</ul>


<p>Putting these two together we can define a <code>ClassyBarbarian</code> <em>class</em>:</p>

<pre><code>// the constructor function:
//   - defines the ClassyBarbarian type
//   - defines the properties a ClassyBarbarian instance is going to have
function ClassyBarbarian(name){
    this.name = name;
    this["character class"] = "barbarian";
    this.hp = 200;
    this.weapons = [];
}

// the prototype:
//   - defines the methods shared across all ClassyBarbarian instances
ClassyBarbarian.prototype = {
    constructor: ClassyBarbarian,
    talks: function(){
        console.log("I am " + this.name + " !!!");
    },
    equipsWeapon: function(weapon){
        weapon.equipped = true;
        this.weapons.push(weapon);
        console.log(`${this.name} grabs a ${weapon.name} from the cavern floor`);
    },
    toString: function(){
        return this.name;
    },
    saysHi: function (){
        console.log("Hi! I am " + this.name);
    }
};
</code></pre>


<p>And we can use it just like we would use a <em>class</em> in C#:</p>

<pre><code>var logen = new ClassyBarbarian('Logen Ninefingers');
logen.saysHi();
// =&gt; Hi! I am Logen Ninefingers
logen.talks();
// =&gt; I am Logen Ninefingers !!!
logen.equipsWeapon({name:'very large axe'});
// =&gt; Logen Ningefingers grabs a very large axe from the cavern floor
console.log(logen.weapons.map(w =&gt; w.name));
// =&gt; ["very large axe"]
</code></pre>


<h3>Access Modifiers</h3>

<p>We don't have access modifiers in JavaScript: <em>public</em>, <em>protected</em> and <em>private</em> do not exist. Every property that you add to an object is public and accessible by anyone that has access to that object. That being said there are two patterns that you can use to get something similar to private variables and methods and the benefits of <em>information hiding</em>. You've learned about them in previous articles:</p>

<ul>
<li><strong>Closures</strong>: You can use them to capture the value of variables from outer scopes (in this case the methods of a class are closures that capture variables defined within a <em>constructor function</em>). These variables are not part of the object itself, they are just captured by the object methods, and therefore are not accessible through the object.</li>
<li><strong>ES6 Symbols</strong>: When you use <em>symbols</em> to index properties and methods in your objects, because a symbol is unique, you can only access these properties or methods if you have access to the symbol. When using a <em>symbol</em> the object has a property indexed by that <em>symbol</em> that is public, but even if you have access to the object, because you don't have a reference to the symbol, you cannot access the property. <sup id="fnref:1"><a href="#fn:1" rel="footnote">1</a></sup></li>
</ul>


<p>Let's see how we can use each of these approaches with our JavaScript <em>classes</em> and the implications of either choice.</p>

<h4>Classes and Information Hiding with Closures</h4>

<p>In order to use <em>closures</em> to achieve data privacy you need to have a function that encloses a variable. This poses a small problem if we want to follow the <em>constructor function</em> for state plus <em>prototype</em> for behavior pattern. That's because the <em>prototype</em> methods are defined outside of the <em>constructor</em> function and therefore cannot enclose any of the variables defined within it.</p>

<p>As a result, if we want to use <em>closures</em> to manage <em>data privacy</em> we need to move our methods from the <em>prototype</em> into the <em>constructor function</em>:</p>

<pre><code>// constructor function
function PrivateBarbarian(name){
    // private members
    var weapons = [],
        hp = 200;

    // public members
    this.name = name;
    this["character class"] = "private barbarian";
    this.equipsWeapon = function(weapon){
        weapon.equipped = true;
        // this function encloses the weapons variable
        weapons.push(weapon);
        console.log(`${this.name} grabs a ${weapon.name} from the cavern floor`);
    };
    this.toString = function(){
      if (weapons.length &gt; 0)
        return `${this.name} looks angry and wields a ${weapons.find(w =&gt; w.equipped).name}`;
      else
        return `${this.name} looks peaceful`;
    }
}

// the prototype:
PrivateBarbarian.prototype = {
    constructor: PrivateBarbarian,
    talks: function(){
        console.log("I am " + this.name + " !!!");
    },
    saysHi: function (){
        console.log("Hi! I am " + this.name);
    }
};
</code></pre>


<p>In the example above we've done the following changes:</p>

<ul>
<li>We have modified the <em>constructor function</em> so that the <code>weapons</code> variable is not a property of the object that would be created with the function but a simple variable inside the function itself.</li>
<li>We have moved the <code>equipsWeapon</code> function from the <em>prototype</em> to the <em>constructor function</em> and updated its body so that it encloses the <code>weapons</code> variable.</li>
</ul>


<p>As a result, if we create a new <code>PrivateBarbarian</code> instance, it will not expose any <code>weapons</code> property to the outside world but this variable will still exist and act <em>as if</em> it was a private member of the object:</p>

<pre><code>// we cannot access the weapons of the barbarian because
// they are not part of the object
var privateBarbarian = new PrivateBarbarian('krox');
console.log(`private barbarian weapons: ${privateBarbarian.weapons}`);
// =&gt; private barbarian weapons: undefined
privateBarbarian.equipsWeapon({name:'Two-handed Hammer'});
// =&gt; krox grabs a Two-handed Hammer from the cavern floor
console.log(privateBarbarian.toString());
// =&gt; krox looks angry and wields a Two-handed Hammer
</code></pre>


<p>In the same way that you have private variables you can have private methods:</p>

<pre><code>function PrivateBarbarian(name){
    // unchanged code from previous example

    this.toString = function(){
      if (weapons.length &gt; 0) return formatWeaponizedBarbarian();
      else return formatPeacefulBarbarian();
    }

    function formatWeaponizedBarbarian(){
      return `${name} looks angry and wields
 a ${weapons.find(w =&gt; w.equipped).name}`;
    }

    function formatPeacefulBarbarian(){
      return `${name} looks peaceful`;
    }
}
</code></pre>


<p>In summary, if you want to use <em>closures</em> to manage <em>data privacy</em> with <em>classes</em> you are going to need to define your methods inside the <em>constructor function</em> and not the <em>prototype</em>. This means that each single instance will have its own method property, and therefore they won't be shared by all instances via the <em>prototype</em>. As a result this <em>information hiding</em> strategy will make you incur in a bigger memory footprint.</p>

<h4>Classes and Information Hiding With ES6 Symbols</h4>

<p>Using <em>ES6 symbols</em> allows you to achieve <em>data privacy</em> and keep your methods in the <em>prototype</em>. The trick is to keep your symbols private as well.</p>

<p>In order to do that we are going to define a very simple <em>module</em>. <em>Modules</em> in JavaScript let you wrap pieces of related functionality. We can create a simple <code>characters</code> module to store our characters using this pattern:</p>

<pre><code>// a simple module 
(function(characters){
    characters.SymbolicBarbarian = SymbolicBarbarian;
    // etc...
}(window.characters = window.characters || {}))

// outside world only has access to whatever we expose
// via the characters object
</code></pre>


<p>Where we use a function – a new variable scope – to represent the module itself. We pass a <code>characters</code> object to the <em>module</em> function that will augment it with functionality that can later be used by the rest of the application.</p>

<p>With the creation of this module we will achieve two things: we are going to have a place where to keep our symbols (the function scope) and we are going to expose a new <code>SymbolicBarbarian</code> <em>class</em> that is going to use these symbols to obtain <em>data privacy</em>:</p>

<pre><code>(function(characters){
  characters.SymbolicBarbarian = SymbolicBarbarian;

  let weapons = Symbol('weapons');

  // the constructor function:
  function SymbolicBarbarian(name){
      this.name = name;
      this["character class"] = "barbarian";
      this.hp = 200;
      this[weapons] = [];
  }

  // the prototype:
  SymbolicBarbarian.prototype = {
      constructor: SymbolicBarbarian,
      talks: function(){
          console.log("I am " + this.name + " !!!");
      },
      equipsWeapon: function(weapon){
          weapon.equipped = true;
          this[weapons].push(weapon);
              console.log(`${this.name} grabs a ${weapon.name}
from the cavern floor`);
      },
      saysHi: function (){
          console.log("Hi! I am " + this.name);
      },
      toString: function(){
      if (this[weapons].length &gt; 0)
        return `${this.name} looks angry and wields a
${this[weapons].find(w =&gt; w.equipped).name}`;
      else
        return `${this.name} looks peaceful`;
    }
};

}(window.characters = window.characters || {}))
</code></pre>


<p>Using the <code>weapons</code> symbol we can create a <code>weapons</code> property that can only be indexed if you have access to the symbol itself. Because the symbol is part of the <code>characters</code> module scope it's only accessible to that function scope and therefore the <code>SymbolicBarbarian</code> <em>class</em> that also lives in that same scope. As a result the <code>weapons</code> property behaves like a private property of the <code>SymbolicBarbarian</code> <em>class</em>:</p>

<pre><code>var symbolicBarbarian = new window.characters.SymbolicBarbarian('khaaarg');
symbolicBarbarian.equipsWeapon({name: 'katana sword'});
// =&gt; khaaarg grabs a katana sword from the cavern floor
console.log(`khaaarg weapons: ${symbolicBarbarian.weapons}`);
// =&gt; khaaarg weapons: undefined
console.log(symbolicBarbarian.toString());
// =&gt; khaaarg looks angry and wields a katana sword
</code></pre>


<h3>Closures vs Symbols with Classes</h3>

<table class="table">
<thead>
<tr>
<th>Closures</th>
<th>ES6 Symbols</th>
</tr>
</thead>
<tbody>

<tr>
<td>
Closures let you achieve true privacy.
</td>
<td>
You cannot achieve true privacy. A client can use the `getOwnPropertySymbols` method to get access to the symbols used within a class and therefore access to its private members.
</td>
</tr>

<tr>
<td>
Because you need to enclose variables with your methods, using closures forces you to move your methods from the prototype to the constructor function. This requires more memory since these methods are no longer shared by all instances.  
</td>
<td>
With symbols you can keep your methods in the prototype and therefore consume less memory.
</td>
</tr>

</tbody>
</table>


<h3>Static Classes, Members and Methods</h3>

<p>Static members and methods in C# are shared across all instances of a given class, can only access other static members and methods and are accessed by using the class name followed by the name of the member or method.</p>

<p>You can mimic static members and methods in JavaScript by augmenting the <em>constructor functions</em> with new properties. For instance:</p>

<pre><code>// we extend the ClassyBarbarian constructor function from previous examples
// with two new properties
ClassyBarbarian.default = function(){
  return new Barbarian('default barbarian');
};

ClassyBarbarian.swordWieldingBarbarian = function(){
  var barbarian = new Barbarian('sword wielding barbarian');
  barbarian.equipsWeapon({name: 'sword'});
  return barbarian;
};

var defaultBarbarian = ClassyBarbarian.default();
console.log(defaultBarbarian.name);
// =&gt; default barbarian
var swordWieldingBarbarian = ClassyBarbarian.swordWieldingBarbarian();
console.log(swordWieldingBarbarian.name);
// =&gt; sword wielding barbarian
</code></pre>


<p>Because these are properties of the <em>constructor function</em> and not of any instance in particular, they'll only be accessible by having a reference to the <em>constructor function</em>. Additionally these members of methods will only be able to access other <em>static</em> members and methods since they are not tied to any instance in particular.</p>

<p>A static class is that which has only static members and methods, is sealed and cannot be instantiated. In a similar way to what you've seen in these examples, you can define a <em>static class</em> as a <em>constructor function</em> that only has <em>"static" members and methods</em> – properties assigned to the <em>constructor function</em> itself. This is going to give you a similar feeling to using <em>static classes</em> in C# but it is a little bit of a stretch since you can still instantiate objects with that <em>constructor function</em> and have it be part of an inheritance chain. You can solve both these problems by throwing an error when the <em>constructor function</em> is called:</p>

<pre><code>function DateHelpers(){ throw Error('static class'); };
DateHelpers.ToJavaScriptMonth = function(month){
    // JavaScript months are 0 based
    return month - 1;
}
</code></pre>


<p>This may be trying to bring C# into JavaScript too far and you might have a simpler solution by just using an <em>object initalizer</em> with methods and properties.</p>

<h3>Method overloading</h3>

<p>In <a href="/blog/2015/05/26/mastering-the-arcane-art-of-javascript-mancy-for-c-sharp-developers-chapter-5-more-useful-function-patterns-function-overloading/">Useful Function Patterns: Function Overloading</a> we learned about several patterns to implement function overloading in JavaScript:</p>

<ul>
<li><strong>Argument inspection</strong>: Inspect how many arguments are passed to a function and which are their types then decide what to do.</li>
<li><strong>Options object</strong>: Provide an options object that contains the arguments to the method. You get the benefits of named parameters and high extensibility.</li>
<li><strong>ES6 defaults and destructuring</strong>: <em>Defaults</em> let you provide different signatures as default values will be used if some arguments are not passed into the function. <em>Destructuring</em> let's you unwrap options objects in a very straightforward fashion.</li>
<li><strong>Function Programming and Polymorphic Functions</strong>: You can define polymorphic functions by composing several functions that will be called in turn until you get a result from any of them.</li>
</ul>


<p>You can use any of these with the <em>classes</em> that we have defined in this article so take a look back if you need to refresh them.</p>

<h2>Mimicking Classical Inheritance in JavaScript</h2>

<p>This is what you've learned to this point:</p>

<ul>
<li>We can emulate a single C# <em>class</em> with a <em>constructor function</em> and <em>prototype pair</em></li>
<li>The <em>constructor function</em> defines the properties of each instance and the <em>prototype</em> its methods</li>
<li>We can take advantage of the <em>prototype chain</em> to create an <em>inheritance tree</em></li>
<li>There's no access modifiers but you can get <em>private members</em> by using closures and <em>ES6 symbols</em>. Closures force you to move methods from the <em>prototype</em> to the <em>constructor function</em> before you can use them</li>
<li>You can add static members and methods to a <em>class</em> by augmenting its <em>constructor function</em></li>
<li>You can use any function overloading technique that you've learned in these series to overload <em>class</em> methods.</li>
</ul>


<p>But <strong>How do you go from a single class to a inheritance tree and emulate classical inheritance in JavaScript?</strong></p>

<p>You can mimic classical inheritance as we know it in C# by following these two steps when creating your <em>classes</em>:</p>

<ol>
<li>Making sure that each <em>constructor function</em> calls its base type <em>constructor function</em> using <code>call</code> or <code>apply</code>. This will ensure that any instance of a <em>class</em> contains all properties defined in each and every base <em>class</em> (as they are defined in each <em>constructor function</em>)</li>
<li>Use <em>prototypical inheritance</em> to ensure that any instance of a <em>class</em> inherits methods from every base <em>class</em> (as they are contained within each <em>prototype</em>)</li>
</ol>


<p>Let's see how to achieve <em>classical inheritance</em> with an example:</p>

<pre><code>// Inheritance Hierarchy:
//   DrawableGameObject -&gt; MobileGameObject

function Position(x,y){
    this.x = x;
    this.y = y;
}
Position.prototype.toString = function(){
    return "[" + this.x + "," + this.y + "]";
}

function MobileGameObject(position){
    this.position = position;
}
MobileGameObject.prototype.movesTo = function(newPosition){
    console.log(`${this} moves to ${this.position}`);
    this.position = newPosition;
}

function DrawableGameObject(position, sprite){
    // call base type constructor function
    MobileGameObject.apply(this, position);
    this.sprite = sprite;
}
// establish prototypical inheritance 
// between DrawableGameObject and MobileGameObject
DrawableGameObject.prototype = Object.create(MobileGameObject.prototype);
DrawableGameObject.prototype.constructor = DrawableGameObject;
DrawableGameObject.prototype.draw = function(){
    console.log("drawing sprite: " + this.sprite);
    // draw sprite
};
</code></pre>


<p>In this example you have two <em>classes</em>, a <code>MobileGameObject</code> that represents some type of object that can move in a two-dimensional space and a <code>DrawableGameObject</code> which is some object that can be drawn in a screen via a <em>sprite</em> (an image). You can verify how:</p>

<ol>
<li>The <code>DrawableGameObject</code> <em>constructor function</em> calls the parent <em>class</em> <em>constructor</em> via <code>MobileGameObject.apply(this, position);</code>. This will ensure that a drawable game object will have both a <code>sprite</code> and <code>position</code> properties.</li>
<li>The <code>DrawableGameObject.prototype</code> object is a new object that in turn has a <code>MobileGameObject.prototype</code> as prototype. This will ensure that a drawable game object will have access to both <code>DrawableGameObject</code> and <code>MobileGameObject</code> <em>prototype</em> methods.</li>
</ol>


<p>We can extend our <em>inheritance tree</em> with yet another <em>class</em>, the <code>Shaman</code>:</p>

<pre><code>// Inheritance Hierarchy:
//   Shaman -&gt; DrawableGameObject -&gt; MobileGameObject

function Shaman(name, position, sprite){
    // call base type constructor function
    DrawableGameObject.call(this, position, sprite);
    this.name = name;
}
// establish prototypical inheritance 
// between Barbarian and DrawableGameObject
Shaman.prototype = Object.create(DrawableGameObject.prototype);
Shaman.prototype.constructor = Shaman;
Shaman.prototype.toString = function(){
    return this.name;
};
Shaman.prototype.heals = function(target){
    console.log(`${this} heals ${target} (+ 50hp)`);
    target.hp += 50;
}
</code></pre>


<p>And we can verify that indeed it works as expected by creating an instance of the <code>Shaman</code> <em>class</em>:</p>

<pre><code>var koloss = new Shaman("Koloss", new Position(0,0), "koloss.jpg");
koloss.movesTo(new Position(5,5))
// =&gt; Koloss moves to [5,5]
koloss.draw()
// =&gt; drawing sprite: koloss.jpg
koloss.heals(conan);
// =&gt; Koloss heals Conan, the Barbarian
</code></pre>


<h3>Method overriding</h3>

<p>You can follow a similar pattern to the one you used in the <em>constructor function</em> to override or extend any method defined in a base <em>class</em>.</p>

<p>Let's override the <code>heals</code> method:</p>

<pre><code>// constructor function
function WhiteShaman(name, position, sprite){
    // call base type constructor function
    Shaman.call(this, name, position, sprite);
}

// prototype
WhiteShaman.prototype = Object.create(Shaman.prototype);
WhiteShaman.prototype.constructor = WhiteShaman;
WhiteShaman.prototype.castsSlowCurse = function(target){
  console.log(`${this} casts slow on ${target}. ${target} seems to move slower`);
  if (target.curses) target.curses.push('slow');
  else target.curses = ['slow'];
};
WhiteShaman.prototype.heals = function(target){
    Shaman.prototype.heals.call(this, target);
    console.log(`${this} cleanses all negatives effects in ${target}`);
    target.curses = [];
    target.poisons = [];
    target.diseases = [];
}
</code></pre>


<p>In this case, the <code>heals</code> method overrides the <code>Shaman.prototype.heals</code> method and extends it with new functionality to remove curses, poisons and diseases:</p>

<pre><code>var khaaar = new WhiteShaman('Khaaar', new Position(0,0), "khaaar.png");
khaaar.castsSlowCurse(conan);
// =&gt; Khaaar casts slow on Conan, the Barbarian. Conan, the Barbarian seems to move slower
khaaar.heals(conan);
// =&gt; Khaaar cleanses all negatives effects in Conan, the Barbarian
</code></pre>


<p>Notice how you are not forced to extend a method. You can also overwrite it completely by merely shadowing it since the JavaScript runtime will not call a method in a prototype if it exists in the current object:</p>

<pre><code>// you don't need to overwrite and extend a method
// you can completely replace it
// the JavaScript runtime will make sure to call the right method:
WhiteShaman.prototype.toString = function(target){
    return `${this.name} the Shaman`;
}
</code></pre>


<p>Indeed you can appreciate how the <code>toString</code> method no longer returns <code>Khaaar</code> but <code>Khaaar the Shaman</code>:</p>

<pre><code>khaaar.castsSlowCurse(conan);
// =&gt; Khaaar the Shaman casts slow on Conan, the Barbarian. Conan, the Barbarian seems to move slower
</code></pre>


<h2>Simplifying Classical Inheritance in ES5</h2>

<p>Now that you've arrived at the end of this article you may be thinking that writing <em>classes</em> in JavaScript is a ton of work. And you are completely right. That's why it's helpful to write a helper to make things easier for you and remove the boilerplate code.</p>

<p>Ideally we would define a function that would let us create a <em>class</em> by providing:</p>

<ul>
<li>a <em>constructor function</em></li>
<li>a <em>prototype</em></li>
<li>optionally, a <em>class</em> to extend or derive from</li>
</ul>


<pre><code>function newClass({constructor, methods:prototype, extends:BaseClass=Object}){

  // helper function that creates a new constructor function
  // that calls the base class constructor function
  function extendConstructor(ctor, ctorToExtend){
     return function(...args){
        ctorToExtend.apply(this, args)
        ctor.apply(this, args);
        return this;
     };
  }

  // make sure constructor calls base class constructor
  let extendingConstructor = extendConstructor(constructor, BaseClass);

  // set the class prototype to an object that has
  // the base class prototype as prototype
  extendingConstructor.prototype = Object.create(BaseClass.prototype);
  extendingConstructor.prototype.constructor = extendingConstructor;
  // extend the prototype with the *class* methods
  Object.assign(extendingConstructor.prototype, prototype);

  return extendingConstructor;
}
</code></pre>


<p>The <code>newClass</code> function takes the three ingredients for a <em>class</em>: <em>constructor</em>, <em>prototype</em> and <em>base class</em> and assembles them all together for you. It will make sure to create a new <em>constructor function</em> that calls the base <em>constructor</em> before your own class <em>constructor</em>. It will also create an appropriate <em>prototype</em> by creating an object with the base <em>class</em> prototype and combining it with your own <em>class</em> prototype. If you don't provide a base <em>class</em> to extend it will use the <code>Object</code> <em>class</em> as default.</p>

<p>Let's see the <code>newClass</code> function in action and define a new <code>Berserker</code> <em>class</em>:</p>

<pre><code>var Berserker = newClass({
  constructor: function(name, position, sprite, animalSpirit){
    this.animalSpirit;
  },
  methods: {
    rageAttack: function(target){
      console.log(`${this} screams and hits ${target} with a terrible blow`);
      target.hp -= 100;
    }
  },
  extends: ClassyBarbarian
});
</code></pre>


<p><em>Much better right?</em> Now you can start using your <code>Berserker</code> <em>class</em> to fill your army ranks with bold (and crazy) warriors:</p>

<pre><code>var dwarfBerserker = new Berserker('Gloin', new Position(0,0), 'gloin.png', 'badger');
dwarfBerserker.rageAttack("conan");
// =&gt; Gloin screams and hits conan with a terrible blow
dwarfBerserker.equipsWeapon({name: 'Double bearded Axe'});
// =&gt; Gloin grabs a Double bearded Axe from the cavern floor
</code></pre>


<h2>Concluding</h2>

<p>In this article you learned how to mimic C# <em>classes</em> and <em>classical inheritance</em> in JavaScript.</p>

<p>You saw how combining a <em>constructor function</em> and a <em>prototype</em> object let's you create something comparable to a class, where the <em>constructor function</em> defines your <em>class members</em> and the <em>prototype</em> defines your <em>class methods</em>. You then learned about <em>data privacy</em> with closures and symbols and how to write <em>static members, methods and classes</em> in JavaScript.</p>

<p>We continued extending the scope from a single class to multiple classes and you discovered how to achieve an equivalent experience to <em>classical inheritance</em> in C#. We could achieve this by calling a base <em>class</em> <em>constructor function</em> for a derived <em>class constructor</em> and by establishing a <em>prototypical chain</em> between each <em>class</em> prototype. We wrapped the article discussing how to override and extend <em>class</em> methods, and how to simplify <em>class inheritance</em> in JavaScript using a helper.</p>

<p>If you reflect a little bit about what you've learned in this article you'll probably come to wonder: <em>Really? Does writing a class in JavaScript need to be this hard?</em>. Well that's exactly what <em>ES6 classes</em> are trying to remedy by providing a much more familiar, simple and nicer syntax to writing <em>classes</em> in JavaScript. And that's what you'll learn in the next article.</p>
<div class="footnotes">
<hr>
<ol>
<li id="fn:1">
<p>Remember that you can get access to all symbols used within an object via <code>getOwnPropertySymbols</code> and therefore <em>symbols</em> don't offer true privacy like <em>closures</em> do.<a href="#fnref:1" rev="footnote">↩</a></p></li>
</ol>
</div>

</div>
					</div>
				</article>
				<!--================= END :: Tutorial =================-->
				
				<!--================= START :: Tutorial =================-->
				<article>
					<a id="t-89" name="t-89"></a><h1>89 : White Tower Summoning Enhanced: The Marvels of ES6 Classes</h1>
					<span class="ref-site">https://www.barbarianmeetscoding.com/blog/2015/12/20/white-tower-summoning-enhanced-the-marvels-of-es6-classes/</span>
					<div class="tutorial__content">
<div class="entry-content">

<p>In the last article you learned how to implement <em>classes</em> in JavaScript without relying in <em>ES6 classes</em> which puts you in a prime position to learn <em>ES6 classes</em>:</p>

<ol>
<li>Now you have a deep understanding about the underlying implementation of <em>ES6 classes</em> which are just syntactic sugar over <em>constructor functions</em> and <em>prototypes</em>. This will not only help you understand how <em>ES6 classes</em> work but also how they relate to the rest of JavaScript.</li>
<li>You appreciated how you needed to write a lot of boilerplate code to achieve the equivalent of both <em>classes</em> and <em>classical inheritance</em>. With this context the value proposition of <em>ES6 classes</em> becomes very clear as they bring a much nicer syntax and developer experience to using <em>classes</em> and <em>classical inheritance</em> in JavaScript.</li>
</ol>


<p>In any case, <em>ES6 classes</em> are great for developers that are coming to JavaScript from a static typed language like C# because they offer a perfect entry point into the language. You can start using <em>classes</em> just like you'd do in C#, and little by little learn more about the specific capabilities of JavaScript.</p>

<p><strong>Behold! ES6 classes!</strong></p>

<!-- more -->


<p></p>

<h2>From ES5 "Classes" to ES6 Classes</h2>

<p><em>You can <a href="http://bit.ly/javascriptmancy-oop-es6-classes">experiment with all examples in this article directly within this jsBin</a>.</em></p>

<p>In the previous article you learned how to obtain a <em>class</em> equivalent by combining a <em>constructor function</em> and a <em>prototype</em>:</p>

<pre><code>// the constructor function:
//   - defines the ClassyBarbarian type
//   - defines the properties a ClassyBarbarian instance is going to have
function ClassyBarbarian(name){
    this.name = name;
    this["character class"] = "barbarian";
    this.hp = 200;
    this.weapons = [];
}

// the prototype:
//   - defines the methods shared across all ClassyBarbarian instances
ClassyBarbarian.prototype = {
    constructor: ClassyBarbarian,
    talks: function(){
        console.log("I am " + this.name + " !!!");
    },
    equipsWeapon: function(weapon){
        weapon.equipped = true;
        this.weapons.push(weapon);
        console.log(`${this.name} grabs a ${weapon.name} from the cavern floor`);
    },
    toString: function(){
        return this.name;
    },
    saysHi: function (){
        console.log("Hi! I am " + this.name);
    }
};
</code></pre>


<p>The translation from this <em>class</em> equivalent to a full blown <em>ES6 class</em> is very straightforward:</p>

<pre><code>class Barbarian {

    constructor(name){
        this.name = name;
        this["character class"] = "barbarian";
        this.hp = 200;
        this.weapons = [];
    }

    talks(){
        console.log("I am " + this.name + " !!!");
    }

    equipsWeapon(weapon){
        weapon.equipped = true;
        this.weapons.push(weapon);
        console.log(`${this.name} grabs a ${weapon.name} from the cavern floor`);
    }

    toString(){
        return this.name;
    }

    saysHi(){
        console.log("Hi! I am " + this.name);
    }

};
</code></pre>


<p>The <code>class</code> keyword followed by the <em>class</em> name now act as a container for the whole <em>class</em>. The syntax for the body is very reminescent of the <em>shorthand method syntax</em> of object initializers that you learned in <a href="/blog/2015/10/08/mastering-the-arcane-art-of-javascript-mancy-on-summoning-servants-and-critters-or-the-basics-of-objects/">the basics section of these series</a>.</p>

<p>Instead of writing a method with the <code>function</code> keyword as in <code>saysHi: function(){}</code> we use the shorthand version that is nearer to the C# method syntax <code>saysHi(){</code>. The <em>constructor function</em> becomes the <code>constructor</code> inside the <em>class</em> and <strong>the methods are separated by new lines and not by commas</strong>. In addition to methods you can also define <a href="/blog/2015/10/08/mastering-the-arcane-art-of-javascript-mancy-on-summoning-servants-and-critters-or-the-basics-of-objects/">getters and setters</a> just like you'd do within object literals.</p>

<p>Once defined, you can create <em>class</em> instances using the <code>new</code> keyword:</p>

<pre><code>var conan = new Barbarian('Conan');
console.log(`Conan is a barbarian: ${conan instanceof Barbarian}`);
// =&gt; Conan is a barbarian: true
conan.equipsWeapon('steel sword');
// =&gt; Conan grabs a undefined from the cavern floor
</code></pre>


<h2>Prototypical Inheritance via Extends</h2>

<p>Expressing inheritance is equally straightforward when you use <em>ES6 classes</em>. The <code>extends</code> keyword provides a more declarative approach than the equivalent in <em>ES5</em>. Where in <em>ES5</em> we would set the <code>prototype</code> property of a <em>constructor function</em> and would make sure to call the base class <em>constructor function</em>:</p>

<pre><code>function Berserker(name, animalSpirit){
    Barbarian.call(this, name); // call base class constructor
    this.animalSpirit;
};

Berserker.prototype = Object.create(Barbarian.prototype);
Berserker.prototype.constructor = Berserker;
Berserker.prototype.rageAttack = function(target){
  console.log(`${this} screams and hits ${target} with a terrible blow`);
  target.hp -= 100;
};
</code></pre>


<p>With <em>ES6 classes</em> we use the <code>extends</code> keyword in the class declaration:</p>

<pre><code>class Berserker extends Barbarian {

    constructor(name, animalSpirit){
        super(name);
        this.animalSpirit = animalSpirit;
    }

    rageAttack(target){
      console.log(`${this} screams and hits ${target} with a terrible blow`);
      target.hp -= 100;
    }
}
</code></pre>


<p>The <code>extends</code> keyword ensures that the <code>Berserker</code> class extends (inherits from) the <code>Barbarian</code> class. The <code>super</code> keyword within the <code>constructor</code> let's you call the base <em>class</em> <em>constructor</em>.</p>

<pre><code>var logen = new Berserker('Logen, the Bloody Nine', 'wolf');
console.log(`Logen is a barbarian: ${logen instanceof Barbarian}`);
// =&gt; Logen is a barbarian: true
console.log(`Logen is a berserker: ${logen instanceof Berserker}`);
// =&gt; Logen is a berserker: true
logen.equipsWeapon({name:'huge rusty sword'});
// =&gt; Logen, the Bloody Nine grabs a huge rusty sword from the cavern floor
logen.rageAttack(conan);
// =&gt; Logen, the Bloody Nine screams and hits Conan with a terrible blow
</code></pre>


<h2>Overriding Methods in ES6 Classes</h2>

<p>You can also use the <code>super</code> keyword to override and extend <em>class</em> methods. Here you have the <code>Shaman</code> and <code>WhiteShaman</code> we used in the previous article to illustrate method overriding. We have translated them into very concise <em>ES6 classes</em> and used the <code>super</code> keyword to override the <code>heals</code> method:</p>

<pre><code>class Shaman extends Barbarian{
  constructor(name){
    super(name);
  }

  heals(target){
    console.log(`${this} heals ${target} (+ 50hp)`);
    target.hp += 50;
  }
}

class WhiteShaman extends Shaman {
  constructor(name){
    super(name);
  }

  castsSlowCurse(target){
    console.log(`${this} casts slow on ${target}. ${target} seems to move slower`);
    if (target.curses) target.curses.push('slow');
    else target.curses = ['slow'];
  }

  heals(target){
    // instead of Shaman.prototype.heals.call(this, target);
    // you can use super
    super.heals(target);
    console.log(`${this} cleanses all negatives effects in ${target}`);
    target.curses = [];
    target.poisons = [];
  }
}
</code></pre>


<p>The <code>super</code> keyword provides a great improvement from the <em>ES5</em> approach where you were required to call the method on the base <em>class</em> <em>prototype</em> (<code>Barbarian.prototype.heals.call(this, target)</code>).</p>

<p>You can verify how the overridden <code>heals</code> method works as expected:</p>

<pre><code>var khaaar = new WhiteShaman('Khaaar');
khaaar.castsSlowCurse(conan);
// =&gt; Khaaar casts slow on Conan, the Barbarian. Conan seems to move slower
khaaar.heals(conan);
// =&gt; Khaaar cleanses all negatives effects in Conan
</code></pre>


<h2>Static Members and Methods</h2>

<p>In addition to per-instance methods, <em>ES6 classes</em> provide a syntax to declare static methods. Just prepend the <code>static</code> keyword to a method declaration inside a class:</p>

<pre><code>class Sword {
    constructor(material, damage, weight){
        this.material = material;
        this.damage = damage;
        this.weight = weight;
    }
    toString(){
        return `${this.material} sword (+${this.damage})`;
    }
    static getRandom(){
        let randomMaterial = 'iron',
            damage = Math.random(Math.random()*10),
            randomWeight = '5 stones';
        return new Sword(randomMaterial, damage, randomWeight);
    }
}
</code></pre>


<p>You can call a <em>static method</em> like you would in C# using the <em>class</em> name followed by the method <code>Sword.getRandom()</code>:</p>

<pre><code>let randomSword = Sword.getRandom();
console.log(randomSword.toString());
// =&gt; iron sword (+4)
</code></pre>


<p><em>ES6 classes</em> don't offer a syntax to declare <em>static members</em> but you can still use the approach you learned in the previous article. With <em>ES5 classes</em> we augmented the <em>contructor function</em> with the <em>static member</em>. With <em>ES6 classes</em> we can do the same:</p>

<pre><code>Sword.materials = ['wood', 'iron', 'steel'];
console.log(Sword.materials);
// =&gt; ['wood', 'iron', 'steel']
</code></pre>


<p>Now we could update the <code>getRandom</code> <em>static method</em> to use this list of allowed materials. Since they are both <em>static</em> they can freely access each other:</p>

<pre><code>static getRandom(){
    // super complex randomness algorithm to pick a material :)
    let randomMaterial = Sword.materials[0],
        damage = Math.random(Math.random()*10),
        randomWeight = '5 stones';
    return new Sword(randomMaterial, damage, randomWeight);
}
</code></pre>


<h2>ES6 Classes and Information Hiding</h2>

<p>When it comes to <em>ES6 classes</em> and <em>information hiding</em> we are in the same place as we were prior to <em>ES6</em>: Every property inside the <code>constructor</code> of a class and every method within the <code>class</code> declaration body is public. <strong>You need to rely on closures or <em>ES6 symbols</em> to achieve data privacy</strong>.</p>

<p>Just like with <em>ES5 classes</em>, if you want to use closures to declare private members or methods you'll need to move the method consuming these private members inside the <em>class</em> <code>constructor</code>. This will ensure that the method can enclose the private member or method. For instance:</p>

<pre><code>class PrivateBarbarian {

    constructor(name){
        // private members
        var weapons = [];
        // public members
        this.name = name;
        this["character class"] = "barbarian";
        this.hp = 200;
        this.equipsWeapon = function (weapon){
            weapon.equipped = true;
            // the equipsWeapon method encloses the weapons variable
            weapons.push(weapon);
            console.log(`${this.name} grabs a ${weapon.name} from the cavern floor`);
        };
        this.toString = function(){
          if (weapons.length &gt; 0) return `${this.name} wields a ${weapons.find(w =&gt; w.equipped).name}`;
          else return this.name
        };
    }

    talks(){
        console.log("I am " + this.name + " !!!");
    }

    saysHi(){
        console.log("Hi! I am " + this.name);
    }
};
</code></pre>


<p>After defining <code>weapons</code> as a normal variable inside the <code>constructor</code> scope, moving <code>equipsWeapon</code> and <code>toString</code> and making them enclose the <code>weapons</code> variable we can verify how it effectively becomes a private member of the <code>PrivateBarbarian</code> class:</p>

<pre><code>var privateBarbarian = new PrivateBarbarian('timido');
privateBarbarian.equipsWeapon({name: 'mace'});
// =&gt; timido grabs a mace from the cavern floor
console.log(`Barbarian weapons: ${privateBarbarian.weapons}`);
// =&gt; Barbarian weapons: undefined
console.log(privateBarbarian.toString())
// =&gt; timido wields a mace
</code></pre>


<p>Alternatively, you can use symbols just like with <em>ES5 classes</em>:</p>

<pre><code>// this should be placed inside a module
// so only the SymbolicBarbarian has access to it
let weapons = Symbol('weapons');

class SymbolicBarbarian {

    constructor(name){
        this.name = name;
        this["character class"] = "barbarian";
        this.hp = 200;
        this[weapons] = [];
    }

    talks(){
        console.log("I am " + this.name + " !!!");
    }

    equipsWeapon(weapon){
        weapon.equipped = true;
        this[weapons].push(weapon);
        console.log(`${this.name} grabs a ${weapon.name} from the cavern floor`);
    }

    toString(){
        if(this[weapons].length &gt; 0) return `${this.name} wields a ${this[weapons].find(w =&gt; w.equipped).name}`;
        else return this.name;
    }

    saysHi(){
        console.log("Hi! I am " + this.name);
    }
};
</code></pre>


<p>Which also results in <code>weapons</code> being private <sup id="fnref:1"><a href="#fn:1" rel="footnote">1</a></sup>:</p>

<pre><code>var symbolicBarbarian = new SymbolicBarbarian('simbolo');
symbolicBarbarian.equipsWeapon({name: 'morning star'});
// =&gt; timido grabs a mace from the cavern floor
console.log(`Barbarian weapons: ${symbolicBarbarian.weapons}`);
// =&gt; Barbarian weapons: undefined
console.log(symbolicBarbarian.toString())
// =&gt; timido wields a morning star
</code></pre>


<p><em>Which to choose?</em> That depends on what style you prefer. Just know that closures and <em>symbols</em> have the same trade-offs with <em>ES6 classes</em> than with <em>ES5 classes</em>:</p>

<table class="table">
    <thead>
        <tr>
            <th>Closures</th>
            <th>ES6 Symbols</th>
        </tr>
    </thead>
    <tbody>
    <tr>
        <td>
        Let's you achieve true privacy.
        </td>
        <td>
        You cannot achieve true privacy because a client could use getOwnPropertySymbols to obtain to your symbols and therefore your private variables.
        </td>
    </tr>
    <tr>
        <td>
        Because you need to enclose variables with your methods, closures forces you to move your methods from the prototype to the constructor.
        This requires more memory since these methods are no longer shared by all instances of a class.
        </td>
        <td>
        With symbols you can keep your methods in the prototype and therefore consume less memory.
        </td>
    </tr>
    </tbody>
</table>


<h2>ES6 Classes Behind the Curtain</h2>

<p>Throughout this article you've been able to see how, thanks to the fact that <em>ES6 classes</em> are just syntactic sugar over JavaScript existing OOP constructs, we can fill in the gaps when there are features lacking from <em>ES6 classes</em> like static members or data privacy.</p>

<p>This is a hint that we can use <em>ES6 classes</em> just like we could a <em>constructor function</em> and a <em>prototype</em> pair. For instance we can augment an <em>ES6 class</em> prototype at any time with new capabilities and all instances of that class will get instant access to those features (via the <em>prototype chain</em>):</p>

<pre><code>Barbarian.prototype.entersGodMode = function(){
  console.log(`${this} enters GOD MODE!!!!`);
  this.hp = 99999;
  this.damage = 99999;
  this.speed = 99999;
  this.attack = 99999;
};
</code></pre>


<p>So instances that we created earlier like <code>conan</code> the <em>Barbarian</em>, <code>logen</code> the <em>Berserker</em> and <code>khaaar</code> the <em>Shaman</em> all obtain the new ability to enter god mode:</p>

<pre><code>conan.entersGodMode();
// =&gt; Conan enters GOD MODE!!!!
logen.entersGodMode();
// =&gt; Logen, the Bloody Nine enters GOD MODE!!!!
khaaar.entersGodMode();
// =&gt; Khaaar enters GOD MODE!!!!
</code></pre>


<h2>Concluding</h2>

<p><em>ES6 classes</em> are a result of the natural evolution of JavaScript object oriented programming paradigm. The evolution from the rudimentary <em>class</em> support we had in <em>ES5</em> where we needed to write a lot of boilerplate code to the much better native support in <em>ES6</em>.</p>

<p>They resemble C# classes and can be created using the <code>class</code> keyword. They have a <code>constructor</code> function where you declare the <em>class</em> members and have a very similar syntax to that of shorthand object initializers.</p>

<p><em>ES6 classes</em> provide support for method overriding via the <code>super</code> keyword, static methods via the <code>static</code> keyword and they can easily express inheritance trees (prototype chains) in a declarative way by using the <code>extends</code> keyword.</p>

<p>It is important that you understand that <em>ES6</em> classes are just syntactic sugar over the existing inheritance model. As such you can take advantage of what you learned in previous article of these series to implement static members, data privacy via closures and symbols, augment a <em>class</em> prototype at runtime, and anything you can imagine.</p>

<p>Now that you know how to write OOP in JavaScript using a C# style it's time to move beyond <em>classical inheritance</em> and embrace JavaScript dynamic nature and flexibility. Up next! Mixins and Object Composition!</p>
<div class="footnotes">
<hr>
<ol>
<li id="fn:1">
<p>Remember that you can get access to all symbols used within an object via <code>getOwnPropertySymbols</code> and therefore <em>symbols</em> don't offer true privacy like <em>closures</em> do.<a href="#fnref:1" rev="footnote">↩</a></p></li>
</ol>
</div>

</div>
					</div>
				</article>
				<!--================= END :: Tutorial =================-->
				
				<!--================= START :: Tutorial =================-->
				<article>
					<a id="t-90" name="t-90"></a><h1>90 : Black Tower Summoning: Object Composition With Mixins</h1>
					<span class="ref-site">https://www.barbarianmeetscoding.com/blog/2015/12/28/black-tower-summoning-object-composition-with-mixins/</span>
					<div class="tutorial__content">
<div class="entry-content">

<p>In the previous articles of <a href="http://www.barbarianmeetscoding.com/blog/categories/javascriptmancy/">this series</a> you have dived into Object Oriented Programming in JavaScript. You've learned about object initializers, factory functions, about constructor functions, prototypical inheritance, polymorphism, how to mimick C# classes with ES5 and even about ES6 classes.</p>

<p>So far we've kept ourselves very close to techniques and concepts that you are accustomed to in C# so as to make you a comfortable inhabitant of the world of JavaScript. So! Now that you are almost a mighty JavaScript-mancer we're going to let go of C# for a little while and embrace the dynamic nature of JavaScript. Welcome to a world of flexibility and freedom! The realm of object composition!</p>

<p>This time by the hand of <strong>Mixins</strong>.</p>

<!-- more -->


<h2>The Problem With Classes and Classical Inheritance</h2>

<p>The world we live in is unbelievably complex. Creating software that handles this infinite degree of complexity and detail is a futile endeavor. Object Oriented Programming attempts to solve this problem by abstracting the world inside a problem space and creating representations of reality that are simplified and that let us solve very specific problems. Thus turning the impossible into something, if not simple, at least manageable.</p>

<p>These OOP representations are usually done with the aid of <em>classes</em> and <em>objects</em>. A class represents a blueprint of something, some entity in reality that we want to abstract and use in our programs. It determines which properties we are going to use to represent that entity and which actions it can perform. An <em>object</em> represents a particular instance of that blueprint, of that class, something that exists, has a particular state and can be operated on.</p>

<p>This is all well and good. We live in a complex world and OOP helps us manage that complexity through simplified versions of reality called <em>classes</em> and <em>objects</em>.</p>

<p>A side effect of using <em>classes</em> is that it creates a <em>taxonomy</em> or a <em>classification</em> of the entities in the world around us. This classification, because of the nature of classes and inheritance, tends to be a very rigid one that doesn't tolerate change very well. <em>Change</em> not strictly in the sense of adding a new property to a class but in accommodating the system of <em>classes</em> to new knowledge about the problem domain.</p>

<p>We saw an example of this particular problem in <a href="http://www.barbarianmeetscoding.com/blog/2015/11/23/an-introduction-to-object-oriented-programming-in-javascript-for-c-sharp-developers/">"Introduction to Object-Oriented Programming in JavaScript"</a> (<em>anoher article in the series</em>) where we defined these three classes <code>Minion</code>, <code>Wizard</code> and <code>Thief</code>:</p>

<pre><code>class Minion {
  constructor(name, hp){
    this.name = name;
    this.hp = hp;
  }
  toString(){
    return this.name;
  }
}

class Wizard extends Minion {
  constructor(element, mana, name, hp){
    super(name, hp);
    this.element = element;
    this.mana = mana;
  }
  toString(){
    return super.toString() + ", the " + this.element +" Wizard";
  }
  castsSpell(spell, target){
    console.log(this + ' casts ' + spell + ' on ' + target);
    this.mana -= spell.mana;
    spell(target);
  }
}

class Thief extends Minion {
  constructor(name, hp){
    super(name, hp);
  }
  toString(){
    return super.toString() + ", the Thief";
  }
  steals(target, item){
    console.log(`${this} steals ${item} from ${target}`);
  }
}
</code></pre>


<p>And a problem space in which we have a <code>Wizard</code> as someone who can cast spells, and a <code>Thief</code> as someone who can steal. In this context we learned something new about our domain, the existence of <em>Bards</em> as creatures of myth that could both casts spells, steal, and even play an instrument!</p>

<p>But the system of <em>classes</em> that we had created, our current taxonomy that represents our view of the world right now doesn't accommodate very well the idea of a <code>Bard</code>… is it a <code>Wizard</code>? Is it a <code>Thief</code>? Is it something else? It cannot be both! Can it!? And so in order to bring this knowledge into our system, we need to do a major redesign of our <em>classes</em>, redefine our whole taxonomy, or duplicate code and forsake the benefits that could come from polymorphism.</p>

<p>So <em>classes</em> create taxonomies. Taxonomies are rigid and don't tolerate change well. <em>Is there anything else?</em> Well there's also a problem with the <strong>when</strong>, when do we create these <em>classes</em> and <em>taxonomies</em>? And how does that affects how we work?</p>

<p>A very wise person, Douglas Crockford, reflected over this and realized that we build these taxonomies when we start a project, which is the moment when we least know about our domain and problem space. We are creating these very rigid systems to represent a domain we are usually not familiar with. Systems that will inevitably need to change as we find out more about the domain but that are not well suited to adapt to change.</p>

<p><strong>Is there a better way?</strong></p>

<p>Well, yes sir there is. It is <strong>class-free object oriented programming</strong> and Douglas calls it the single most important contribution of JavaScript to humanity <sup id="fnref:1"><a href="#fn:1" rel="footnote">1</a></sup>. In this article and the next we will focus in how you can achieve this approach to object oriented programming, where <em>classes</em> disappear and we just focus on <em>objects</em>. Sounds exciting, doesn't it?</p>

<h2>Free Yourself From Classes With Object Composition and Mixins</h2>

<p><em>You can <a href="http://bit.ly/javascriptmancy-oop-object-composition-mixins">experiment with all examples in this article directly within this jsBin</a>.</em></p>

<p>In <a href="http://www.barbarianmeetscoding.com/blog/2015/11/23/an-introduction-to-object-oriented-programming-in-javascript-for-c-sharp-developers/">Introduction to Object-Oriented Programming in JAvaScript</a> you had a taste of <em>class-free inheritance</em> when you learned how to compose objects with each other using <code>Object.assign</code>. In that particular implementation of <em>class-free</em> inheritance we defined behaviors as objects <code>canBeIdentifiedByName</code>, <code>canCastSpells</code>, <code>canSteal</code> and <code>canPlayMusic</code>:</p>

<pre><code>let canBeIdentifiedByName = {
  toString(){
    return this.name;
  }
};

let canCastSpells = {
  castsSpell(spell, target){
    console.log(this + ' casts ' + spell + ' on ' + target);
    this.mana -= spell.mana;
    spell(target);
  }
};

let canSteal = {
  steals(target, item){
    console.log(`${this} steals ${item} from ${target}`);
  }
};

let canPlayMusic = {
  playsMusic(){
    console.log(`${this} grabs his ${this.instrument} and starts playing music`);
  }
};
</code></pre>


<p>And we composed them together to build more complex objects:</p>

<pre><code>// and now we can create our objects by composing this behaviors together
function Wizard(element, mana, name, hp){
  let wizard = {element,
                mana,
                name,
                hp};
  Object.assign(wizard,
               canBeIdentifiedByName,
               canCastSpells);
  return wizard;
}

function Thief(name, hp){
  let thief = {name,
               hp};
  Object.assign(thief,
               canBeIdentifiedByName,
               canSteal);
  return thief;
}

function Bard(instrument, mana, name, hp){
  let bard = {instrument,
                mana,
                name,
                hp};
  Object.assign(bard,
               canBeIdentifiedByName,
               canCastSpells,
               canSteal,
               canPlayMusic);
  return bard;
}
</code></pre>


<p>That work just like you would expect of a <code>wizard</code>, a <code>thief</code> and a <code>bard</code>:</p>

<pre><code>var lightningSpell = function(target){
  console.log('A bolt of lightning electrifies ' + target + '(-10hp)');
  target.hp -= 10;
};
lightningSpell.mana = 5;
lightningSpell.toString = function(){ return 'lightning spell';};
var orc = {name: 'orc', hp: 100, toString(){return this.name}};

let wizard = Wizard('fire', 100, 'Randalf, the Red', 10);
wizard.castsSpell(lightningSpell, orc);
// =&gt; Randalf, the Red casts lightning spell on orc
// =&gt; A bolt of lightning electrifies orc(-10hp)

let thief = Thief('Locke Lamora', 100);
thief.steals('orc', /*item*/ 'gold coin');
// =&gt; Locke Lamora steals gold coin from orc

let bard = Bard('lute', 100, 'Kvothe', 100);
bard.playsMusic();
// =&gt; Kvothe grabs his lute and starts playing music
bard.steals('orc', /*item*/ 'sandwich');
// =&gt; Kvothe steals sandwich from orc
bard.castsSpell(lightningSpell, orc);
// =&gt; Kvothe casts lightning spell on orc
// =&gt;A bolt of lightning electrifies orc(-10hp)
</code></pre>


<p>The objects that encapsulate a bit of reusable behavior (<code>canSteal</code>, <code>canPlayMusic</code>, etc) is what we call <strong>mixins</strong>. We compose them, or mix them, with other objects to provide them with additional behavior. You don't need to use a <em>factory function</em> like in the previous examples, you can compose a simple object if so you wish:</p>

<pre><code>var orcMagician = Object.assign(
    {name: 'orcmag', hp: 100, mana: 50},
    canBeIdentifiedByName,
    canCastSpells);

orcMagician.castsSpell(lightningSpell, wizard);
// =&gt; orcmag casts lightning spell on Randalf, the Red
// =&gt; A bolt of lightning electrifies Randalf, the Red(-10hp)
// sweet vengeance muahahaha
</code></pre>


<p>The <em>factory function</em> just adds that extra level of convenience to create many objects.</p>

<p>Let's continue strengthening this idea of object composition and flexibility with a new example. Imagine that you want to be able to see your legions displayed on a map so you can take better strategic decisions in your path to ruling the known universe. Well, you can define a <code>canBePositioned</code> object that encapsulates this behavior that you need:</p>

<pre><code>var canBePositioned = {
    x : 0,
    y : 0,
    movesTo(x, y) {
        console.log(`${this} moves from (${this.x}, ${this.y}) to (${x}, ${y})`);
        this.x = x;
        this.y = y;
    }
};
</code></pre>


<p>And augment all of our minions with that functionality:</p>

<pre><code>Object.assign(wizard, canBePositioned);
Object.assign(thief, canBePositioned);
Object.assign(bard, canBePositioned);
Object.assign(orcMagician, canBePositioned);
</code></pre>


<p>All of the sudden we can position and move them to our heart's content. And if we define a very simple ASCII two-dimensional map like this one:</p>

<pre><code>function Map(width, height, creatures){

  function paintPoint(x,y){
    var creatureInPosition = creatures.find(c =&gt; c.x === x &amp;&amp; c.y === y);
    if (creatureInPosition) return creatureInPosition.name[0];
    return '_';
  }

  return {
    width,
    height,
    creatures,
    paint(){
      let map = '';
      for(let y = 0; y &lt; height; y++){
        for (let x = 0; x &lt; width; x++)
          map += paintPoint(x,y);
        map += '\n';
      }
      return map;
    }
  }
}
</code></pre>


<p>We can combine the <code>Map</code> capability of drawing stuff and the minions capability of positioning themselves and moving around to get a tactical representation of our army:</p>

<pre><code>wizard.movesTo(10,10);
// =&gt; Randalf, the Red moves from (0, 0) to (10, 10)
thief.movesTo(5,5);
// =&gt; Locke Lamora moves from (0, 0) to (5, 5)
bard.movesTo(15,15);
// =&gt; Kvothe moves from (0, 0) to (15, 15)

let worldMap = Map(50, 20, [wizard, thief, bard, orcMagician]);
console.log(worldMap.paint());

/* =&gt;
o_________________________________________________
__________________________________________________
__________________________________________________
__________________________________________________
__________________________________________________
_____L____________________________________________
__________________________________________________
__________________________________________________
__________________________________________________
__________________________________________________
__________R_______________________________________
__________________________________________________
__________________________________________________
__________________________________________________
__________________________________________________
_______________K__________________________________
__________________________________________________
__________________________________________________
__________________________________________________
__________________________________________________
*/
</code></pre>


<p>You may be thinking… <em>Well, I can do this with C# and classical inheritance any day</em>. And indeed you can, but some interesting ideas about the object composition approach are that:</p>

<ul>
<li><strong>We don't need any upfront design effort to make our application extensible</strong>. In C# you need to define the extensibility points of a system because you need to use the right artifacts like interfaces, composition over inheritance, design patterns like strategy, etc. In JavaScript we don't need to over-architect our solution, or carefully design our application for extensibility purposes. You get a new feature, you define a new behavior, compose it with your existing objects and start using it.</li>
<li><strong>Object composition happens at runtime</strong>. You have your program running, your objects doing whatever objects do and all of the sudden <em>BOOM!</em> Object composability and your objects get new features and can do new interesting things. New things like changing from a text representation to a 2D representation or a 3D representation and who knows what more.</li>
<li><strong>It doesn't need to affect the original objects at all</strong>. You can keep your objects as they are, clone them and apply the composition on the clones. This can enable interesting approaches like having different bounded contexts (like in DDD<sup id="fnref:2"><a href="#fn:2" rel="footnote">2</a></sup>) with slightly diverse domain models adapted to a particular context needs and goals.</li>
<li><strong>You can compose an object with many other objects representing different behaviors (like a multiple inheritance of sorts)</strong>. This tends to be harder to do in classical inheritance based languages like C# where you are limited to a single base class or to a flavor of composition that requires a lot of boilerplate code, forward planning and design.</li>
</ul>


<p>With object composition we achieve this true <em>plug and play</em> solution where you can combine domain objects with behaviors in very interesting and flexible ways. By the way, this type of <em>object composition</em> is another type of <em>prototypical inheritance</em> that we called <em>concatenative inheritance</em> <a href="http://www.barbarianmeetscoding.com/blog/2015/12/07/summoning-fundamentals-a-three-part-introduction-to-oop-in-javascript-ii-inheritance/">earlier in this part of the series.</a></p>

<h2>Limitations of Mixins as Objects</h2>

<p>As wonderful as <em>mixin</em> objects are they have some severe limitations:</p>

<ul>
<li>They don't support data privacy</li>
<li>They can create undesired coupling between objects</li>
<li>They are subject to name collisions</li>
</ul>


<p>Let's take a closer look at each of these.</p>

<p><em>Mixin</em> objects don't support true data privacy because they don't support closures. You can use <em>ES6 symbols</em> though and keep your symbols tucked away within a module where you define your <em>mixins</em>.</p>

<p>If you are not careful, <em>mixin</em> objects can create undesired coupling between disparate objects. For instance, if you use the same <em>mixin</em> to extend several other objects, because the <em>extending</em> consists it copying properties, you can end up having several objects that have a reference to the same object. This will result in undesired side-effects and a horrible source of bugs.</p>

<p>You can appreciate this problem when we change the <code>canBePositioned</code> example to use a <code>position</code> object instead of separate <code>x</code> and <code>y</code> properties:</p>

<pre><code>var canBePositionedWithGotcha = {
    position: {x: 0, y: 0},
    movesTo(x, y) {
        console.log(`${this} moves from (${this.position.x}, ${this.position.y}) to (${x}, ${y})`);
        this.position.x = x;
        this.position.y = y;
    }
};
</code></pre>


<p>When you compose the <code>wizardOfOz</code> and <code>tasselhof</code> with this <em>mixin</em> the <code>position</code> object is shared between them both. This results in any minion moving affecting the other, a characteristic that you definitely want to avoid:</p>

<pre><code>var wizardOfOz = Wizard('oz', 100, 'Wizard of Oz', 10);
var tasselhof = Thief('Tasshelhof B.', 20);
Object.assign(wizardOfOz, canBePositionedWithGotcha);
Object.assign(tasselhof, canBePositionedWithGotcha);

wizardOfOz.movesTo(2,2);
// =&gt; Wizard of Oz moves from (0, 0) to (2, 2)
tasselhof.movesTo(6,6);
// =&gt; Tasshelhof B. moves from (2, 2) to (6, 6)
// wait... from (2,2)?????
</code></pre>


<p>Object <em>mixins</em> are also subject to property name collisions. Trying to compose an object with two <em>mixins</em> with the same properties but different interfaces can lead to errors:</p>

<pre><code>var canBePositionedIn3Dimensions = {
    x: 0,
    y: 0,
    z: 0,
    movesTo(x, y, z) {
        console.log(`${this} moves from (${this.x}, ${this.y}, ${this.z}) to (${x}, ${y}, ${z})`);
        this.x = x;
        this.y = y;
        this.z = z;
    }
};

var raist = Wizard('death', /*mana*/ 1000, 'Raistlin', /*hp*/ 1);
Object.assign(raist, canBePositioned, canBePositionedIn3Dimensions);

// we used the movesTo method thinking about the canBePositioned mixin
// and we get an unexpected result z becomes undefined
raist.movesTo(10, 20);
// =&gt; Raistlin moves from (0, 0, 0) to (10, 20, undefined)
</code></pre>


<p><em>Is there a way to surpass these limitations?</em> Indeed there is! Behold! <strong>Functional mixins</strong>!</p>

<h2>Functional Mixins</h2>

<p><em>Functional mixins</em> are <em>mixins</em> implemented as functions instead of objects. They let you implement <em>data privacy</em> through closures and avoid undesired coupling between objects by working as a factory for <em>mixins</em>.</p>

<p>Let's see how we can turn our previously defined behaviors from <em>mixin</em> objects to <em>functional mixins</em>:</p>

<pre><code>let canCastSpellsFn = (state) =&gt; ({
  castsSpell(spell, target){
    console.log(`${state.name} casts ${spell} on ${target}`);
    state.mana -= spell.mana;
    spell(target);
  }
});

let canStealFn = (state) =&gt; ({
  steals(target, item){
    console.log(`${state.name} steals ${item} from ${target}`);
  }
});

let canPlayMusicFn = (state) =&gt; ({
  playsMusic(){
    console.log(`${state.name} grabs his ${state.instrument} and starts playing music`);
  }
});
</code></pre>


<p>In this example the <code>canCastSpell</code> <em>mixin</em> and its companions have been rewritten as functions. These functions take a <code>state</code> argument that represents the state of the object that the <em>mixins</em> are going to extend and use it to provide it with new functionality. This functional implementation comes with two advantages:</p>

<ul>
<li>Because the <code>state</code> object is passed as a argument to the <em>mixin</em> it can remain private between object and <em>mixin</em>.</li>
<li>Because each time the <em>functional mixin</em> object is called it returns a new object there's no problem with coupling state between objects (as it happened with <em>mixin</em> objects).</li>
</ul>


<p>Having redefined our behaviors we can redefine the wizards, thiefs and bards in terms of them:</p>

<pre><code>function TheWizard(element, mana, name, hp){
  let state = {element,
               mana,
               name,
               hp};

  return Object.assign({},
               canBeIdentifiedByNameFn(state),
               canCastSpellsFn(state));
}

function TheThief(name, hp){
  let state = {name,
               hp};

  return Object.assign({},
                       canBeIdentifiedByNameFn(state),
                       canStealFn(state));
}

function TheBard(instrument, mana, name, hp){
  let state = {instrument,
                mana,
                name,
                hp};

  return Object.assign({},
               canBeIdentifiedByNameFn(state),
               canCastSpellsFn(state),
               canStealFn(state),
               canPlayMusicFn(state));
}
</code></pre>


<p>And use them as we have done in previous examples:</p>

<pre><code>var landaf = TheWizard('light', 100, 'Landaf the light', 100);
landaf.castsSpell(lightningSpell, orc);
// =&gt; Landaf the light casts lightning spell on orc
// =&gt; A bolt of lightning electrifies orc(-10hp)

var lupen = TheThief('Lupen', 200);
lupen.steals(orc, 'rusty copper ring');
// =&gt; Lupen steals rusty copper ring from orc

var bart = TheBard('lute', 200, 'Bart', 100);
bart.playsMusic();
// =&gt; Bart grabs his lute and starts playing music
bart.steals(lupen, 'rusty copper ring');
// =&gt; Bart steals rusty copper ring from Lupen
bart.castsSpell(lightningSpell, landaf);
// =&gt; Bart casts lightning spell on Landaf the light
// =&gt; A bolt of lightning electrifies Landaf the light(-10hp)
// Wow Bart is mean!
</code></pre>


<p>In this example we have separated the internal state of every object, represented with the <code>state</code> object, from its public <em>API</em> which is returned by the factory function.</p>

<p>The internal state of the object is passed as an argument to the different <em>functional mixins</em> and therefore they gain access to it.</p>

<p>The public API is defined by extending an empty object with the objects resulting from applying the different <em>functional mixins</em> to the <code>state</code> object. This empty object could also include a subset or all of the variables contained in <code>state</code> and, in that case, they would become public:</p>

<pre><code>function TheBard(instrument, mana, name, hp){
  let state = {instrument,
                mana,
                name,
                hp};

  return Object.assign(state,
               canBeIdentifiedByNameFn(state),
               canCastSpellsFn(state),
               canStealFn(state),
               canPlayMusicFn(state));
}
</code></pre>


<p>As you've appreciated in these examples, <em>functional mixins</em> solve the limitations of <em>mixin</em> objects in terms of data privacy and coupling between extended objects.</p>

<p>There's still one limitation to contend with which are name collisions, that is, the possibility that two <em>mixins</em> provide behaviors with the same name. You can handle name collisions in two ways: live with them or use <em>namespacing</em>.</p>

<p>Since <code>Object.assign</code> works overwriting object properties from right to left you can embrace this feature and take advantage of it when you need to replace behaviors with new ones:</p>

<pre><code>let canCastSpellsOnMany = {
  castsSpell(spell, ...many){
    many.forEach(target =&gt; {
      console.log(this + ' casts ' + spell + ' on ' + target);
      this.mana -= spell.mana;
      spell(target);
    });
  }
}

Object.assign(bard, canCastSpellsOnMany);
bard.castsSpell(lightningSpell, orc, orcMagician, landaf);
// =&gt; Kvothe casts lightning spell on orc
// =&gt; A bolt of lightning electrifies orc (-10hp)
// =&gt; Kvothe casts ligtning spell on orcmag
// =&gt; A bolt of lightning electrifies orcmag (-10hp)
// =&gt; Kvothe casts lightning spell on Landaf the light
// =&gt; A bolt of lightning electrifies Landaf the light(-10hp)
</code></pre>


<p>Or prevent this from happening by namespacing each <em>mixin</em> that is composed with an object. This will result in a less natural and more verbose API for the resulting objects:</p>

<pre><code>var canEat = {
  food: {
    eats(foodItem) {
      console.log(`${this} eats ${foodItem}`);
      this.hp += foodItem.recoverHp;
    }
  }
};
// bard.food.eats({name: 'banana', recoverHp: 10, toString(){return this.name;}});

var canEatMany = {
  foods: {
    eats(...foodItems) {
      foodItems.forEach(f =&gt; {
        console.log(`${this} eats ${f}`);
        this.hp += f.recoverHp;
      });
    }
  }
};

// bard.foods.eats(
//    {name: 'banana', recoverHp: 10, toString(){return this.name;}}
//    {name: 'sandwich', recoverHp: 20, toString(){return this.name;}});
</code></pre>


<h2>Combining Mixins with ES6 Classes</h2>

<p>If you are still not convinced about the usefulness and simplicity of vanilla objects and <em>mixins</em> you can continue using <em>ES6 classes</em> and combine them with <em>mixins</em>. That way you get a comfortable path from C# into JavaScript, a familiar pattern for defining your domain model and additionally you gain a fantastic way to reuse code and behaviors via <em>mixins</em>.</p>

<p>You have two options when combining <em>ES6 classes</em> with <em>mixins</em>. You can either compose your already instantiated objects with a <em>mixin</em> on a <em>per-case</em> basis, or you can compose your <em>class</em> prototype with a <em>mixin</em> and automatically provide all existing and future instances of that <em>class</em> with new behaviors.</p>

<p>Let's imagine we have a <code>Warrior</code> class that will help us illustrate this with an example:</p>

<pre><code>class Warrior{

  constructor(name, hp=500){
    this.name = name;
    this.hp = hp;
    this.weapons = [];
  }

  equipsWeapon(weapon){
    weapon.isEquipped = true;
    this.weapons.push(weapon);
    console.log(`${this} picks ${weapon} from the ground and looks at it appreciatively`);
  }

  attacks(target){
    if (this.weapons.length === 0) {
      console.log(`${this} attacks ${target} with his bare arms`);
    } else {
      console.log(`${this} attacks ${target} with ${this.weapons.find(w =&gt; w.isEquipped)}`);
    }
  }

  toString(){
    return this.name;
  }

}
</code></pre>


<p>The first option is very straightforward because we are just composing an object with another object. We can instantiate a new fearful warrior <code>caramon</code>:</p>

<pre><code>let caramon = new Warrior('Caramon', 1000);
</code></pre>


<p>And now, if we want this specific warrior to be able to steal, we compose it with the <code>canSteal</code> <em>mixin</em> from previous examples:</p>

<pre><code>Object.assign(caramon, canSteal);
caramon.steals(bard, 'lute');
// =&gt; Caramon steals lute from Kvothe
</code></pre>


<p>Alternatively, we can compose the <code>Warrior</code> <em>class</em> prototype with a <em>mixin</em> and provide all existing and future instances of this class with new behavior. This is an excellent way to define a series of reusable behaviors and compose them with our domain model classes as we see fit.</p>

<p>For instance, let's make all warriors capable of being positioned in a map via the <code>canBePositioned</code> <em>mixin</em>:</p>

<pre><code>Object.assign(Warrior.prototype, canBePositioned);
</code></pre>


<p>We can easily verify how indeed both already define warriors like <code>caramon</code> and new warriors like <code>riverwind</code> can move around in a two dimensional space:</p>

<pre><code>// existing instances of Warrior now can be positioned
caramon.movesTo(10,10);
// =&gt; Caramon moves from (0, 0) to (10, 10)
// Crazy!

// and new ones as well
let riverwind = new Warrior('Riverwind', 300);
riverwind.movesTo(20,20);
// =&gt; Riverwind moves from (0, 0) to (20, 20)
</code></pre>


<h2>Object.assign in Depth</h2>

<p>We've used <code>Object.assign</code> a lot during this article and even in previous articles. We know that it copies properties from several source objects into a target object. <em>But does it copy all properties? What about the properties within an object prototype? Does it do a deep copy of the source objects? Or just a shallow copy?</em> That's what we'll answer to in this section.</p>

<p>The <code>Object.assign</code> method is a new <code>Object</code> static method in <em>ES6</em> that <strong>lets you copy all enumerable own properties</strong> from one or several <em>source</em> objects into a single <em>target</em> object.</p>

<pre><code>// copy properties from one object to another
var companyOfTheRing = { aHobbit: 'frodo'};
var companyPlusOne = Object.assign(/* target */ companyOfTheRing, /*source*/ { aWizard: 'Gandalf'});
console.log(companyOfTheRing);
// =&gt; [object Object] { aHobbit: "frodo", aWizard: "Gandalf" }

// merge serveral objects into one 
Object.assign(companyOfTheRing, {anElf: 'Legolas'}, {aDwarf: 'Gimli'});
console.log(companyOfTheRing);
// =&gt; [objetc Object] {aHobbit: "frodo", ... anElf: "Legolas", aDwarf: "Gimli"}
</code></pre>


<p>The <code>target</code> object is the first argument to <code>Object.assign</code> but it is also returned by it:</p>

<pre><code>// the returned object is the same as the target object
console.log(`companyPlusOne and companyOfTheRingt are the same: ${companyPlusOne === companyOfTheRing}`);
// =&gt; companyPlusOne and companyOfTheRingt are the same: true
</code></pre>


<p>If you don't want to mutate any of your existing objects, you can use a new object <code>{}</code> as <em>target</em>:</p>

<pre><code>// clone an object (shallow-copy)
var clonedCompany = Object.assign(/*target*/ {}, /*source*/ companyOfTheRing);
console.log(clonedCompany);
// =&gt; [objetc Object] {aHobbit: "frodo", ... anElf: "Legolas", aDwarf: "Gimli"}
</code></pre>


<p><code>Object.assign</code> only copies properties from the <em>source</em> object itself and not from its prototype:</p>

<pre><code>var newCompanyWithPrototype = Object.assign({
  '__proto__': {
    destroyTheRing(){
      console.log('The mighty company of the ring successfully' +
                  'destroys the ring and saves Middle Earth');
    }
  }}, companyOfTheRing);

var companyOfTheBracelet = Object.assign({}, newCompanyWithPrototype);
console.log(`companyOfTheBracelet.destroyTheRing: ${companyOfTheBracelet.destroyTheRing}`);
// =&gt; companyOfTheBracelet.destroyTheRing: undefined
</code></pre>


<p>It performs a shallow copy of the <em>source</em> object properties. That is, if your <em>source</em> object has a property that is an object, the <em>target</em> object will gain a new property that will point to that same object.</p>

<pre><code>// it does a shallow-copy of each property
companyOfTheRing.equipment = ['bread', 'rope', 'the one ring'];
var companyOfTheSash = Object.assign({}, companyOfTheRing);
companyOfTheSash.equipment.push('sash');
console.log(companyOfTheRing.equipment);
// =&gt; ["bread", "rope", "the one ring", "sash"]
// ups!
</code></pre>


<h3>Enumerable Properties?</h3>

<p>Enumerability is an internal characteristic of object properties in JavaScript. It determines whether or not an object property can be enumerated via the for/in loop. You'll learn more about enumerability in <em>Object Internals</em> and <em>Data Structures</em></p>

<p>When you create an object with an <em>object initializer</em> or a <em>constructor function</em> all properties are enumerable.</p>

<h2>Object.assign Alternatives for ES5 JavaScript-mancers</h2>

<p>This article has relied heavily in the use of <code>Object.assign</code>, a new method in <em>ES6</em> that lets you extend an target object with many other objects. <em>Does that mean that you cannot use mixins and object composition if you are not using ES6?</em> No! You can definitely use object composition and mixins if you haven't made the jump to <em>ES6</em> yet.</p>

<p>Chances are that you already are using a library that offers a similar functionality to <code>Object.assign</code>. For instance, <em>jQuery</em> has the <code>$.extend</code> method, <em>underscore</em> the <code>_.extend</code> and <code>_.assign</code> methods and so does <em>lodash</em>:</p>

<ul>
<li><strong>jQuery extend</strong> (<code>$.extend</code>): Copies all properties even from prototypes. It can perform deep-copy by using a flag (the source objects is traversed recursively and copied over the target object, this avoids coupling source and target objects)</li>
<li><strong>underscore extend (<code>_.extend</code>)</strong>: Copies all enumerable properties even from prototypes</li>
<li><strong>underscore assign (<code>_.assign</code>)</strong>: Copies only own enumerable properties (not properties inherited from prototypes)</li>
<li><strong>lodash extend and assign (<code>_.extend</code>, <code>_.assign</code>)</strong>: Copies only own enumerable properties</li>
</ul>


<p>If you are not using any of these libraries don't worry, you can also implement your own version of <code>Object.assign</code> using this code example below:</p>

<pre><code>function assign(){
  var args = Array.prototype.slice.call(arguments, 0),
      target = args[0],
      sources = args.slice(1);

  return sources.reduceRight(assignObject, target);

  function assignObject(target, source){
    for (var prop in source)
      if (source.hasOwnProperty(prop))
        target[prop] = source[prop];

    return target;
  }
}
</code></pre>


<p>Which works just like <code>Object.assign</code>:</p>

<pre><code>let thor = new Warrior('Thor', 2000);
assign(thor, canCastSpells);
thor.castsSpell(lightningSpell, orc);
// =&gt; Thor casts lightning spell on orc
// =&gt; A bolt of lightning electrifies orc (-10hp)
// poor orc
</code></pre>


<p>If you are not familiar with the <code>reduceRight</code> function don't worry, we will take a look at this method and others in the functional programming section of the series. The only thing you need to know right now is that it traverses the <code>sources</code> array from right to left, it applies the <code>assignObject</code> function to each item within the array, accumulates the results in the <code>target</code> object which is fed back into the <code>assignObject</code> function for the next item.</p>

<h2>Concluding</h2>

<p>Developing software is a complex trade. We try to model the world around us by creating abstractions and simplifications in which we only use the details that we need to solve the problem at hand. Object-Oriented Programming attempts to help reduce the complexities of developing software by defining well defined classes that represent simplified versions of real world entities. However, using classes result in rigid taxonomies that aren't well suited to absorbing change.</p>

<p><em>Class-free object oriented programming</em> appears as an alternative solution to classic OOP that is more adaptable to change and more flexible. An example of <em>class-free</em> OOP is object composability through <em>mixins</em>. <em>Mixins</em> are objects or functions that encapsulate a reusable piece of functionality or behavior. You can apply these <em>mixins</em> to your domain model objects by using <code>Object.assign</code> and what is known as <em>concatenative inheritance</em> (the second type of <em>prototypical inheritance</em> we discussed in earlier articles in this series).</p>

<p>You can represent <em>mixins</em> as objects or functions. Function <em>mixins</em> are better than object mixins because they support <em>data privacy</em> and prevent coupling via shared references. Both types of <em>mixins</em> have problems with name collisions because object composition consists in copying properties from one object to the next.</p>

<p><code>Object.assign</code> is a new <code>Object</code> method in <em>ES6</em> that lets you copy enumerable own properties from one or several <em>source</em> objects into a <em>target</em> object. If you are not using <em>ES6</em>, you can use alternatives from popular JavaScript libraries like <em>jQuery</em> or <em>underscore</em>, or write your own implementation of <code>Object.assign</code>.</p>

<p>In the next articles in the series we will look at other interesting approaches to achieving <em>class-free object oriented programming</em>: traits and stamps.</p>

<p>P.S. Last week <a href="http://justinfagnani.com/">Justin Fagnani</a> wrote a super interesting article about implementing <a href="http://justinfagnani.com/2015/12/21/real-mixins-with-javascript-classes/">"Real" mixins with ES6 classes</a>. Check it out if you want to learn yet another technique with Mixins!</p>

<div class="footnotes">
<hr>
<ol>
<li id="fn:1">
<p>Check this excellent talk at nordic.js regarding this very topic http://bit.ly/douglas-crockford-nordicjs<a href="#fnref:1" rev="footnote">↩</a></p></li>
<li id="fn:2">
<p>Domain Driven Design (http://bit.ly/wiki-ddd)<a href="#fnref:2" rev="footnote">↩</a></p></li>
</ol>
</div>

</div>
					</div>
				</article>
				<!--================= END :: Tutorial =================-->
				
				<!--================= START :: Tutorial =================-->
				<article>
					<a id="t-91" name="t-91"></a><h1>91 : Mastering the Arcane Art of JavaScript-Mancy for C# Developers - Chapter 2: The Basics of JavaScript Functions</h1>
					<span class="ref-site">https://www.barbarianmeetscoding.com/blog/2015/05/05/mastering-the-arcane-art-of-javascript-mancy-for-c-sharp-developers-chapter-2-the-basics-of-javascript-functions/</span>
					<div class="tutorial__content">
<div class="entry-content">

<p>Functions are the most foundational building block in JavaScript. Not only do they hold the logic of our applications, they also are the primitives upon which we build other programmatic constructs in JavaScript like classes and modules.</p>

<p>JavaScript provides different ways to declare and use functions, each with their own nuances and limitations, so given that they are such a fundamental part of the language it is important that you are aware of these characteristics when you are writing JavaScript applications.</p>

<p>Welcome to another step in your journey to JavaScript mastery! Let's get started!</p>



<!-- more -->


<h2>The Basics of Functions</h2>

<p><em>You can <a href="http://jsfiddle.net/vintharas/8oocg7Lx/">experiment with all examples in this blog post within this jsFiddle</a>.</em></p>

<p>There are two ways to write functions in JavaScript: <strong>function expressions</strong> and <strong>function declarations</strong>. It is important to know the implications of using either of these two styles since they work in a very different manner that will impact not only the readability of your code but also how easy/hard it is to debug.</p>

<p>This is a <strong>function expression</strong>:</p>

<pre><code>// anonymous function expression
var castFireballSpell = function(){
  // chaos and mayhem
};
</code></pre>


<p>And this is a <strong>function declaration</strong>:</p>

<pre><code>// function declaration
function castFireballSpell(){
  // it's getting hot in here...
}
</code></pre>


<p>As you can appreciate, in their most common incarnations function expressions and function declarations look very similar. That's why it is especially important to understand that they do are different, have different characteristics and behave in different ways from each other.</p>

<p>Let's examine them in greater detail.</p>

<h3>Function Expressions</h3>

<p>Function expressions result whenever we declare a function like an expression, either by assigning it to a variable, a property within an object or passing it as an argument to another function (like a lambda):</p>

<pre><code>// an anonymous function expression
var castFireballSpell = function(){
    console.log('...chaos and mayhem');
};

// another anonymous function expression as a property of an object
var magician = {
    castFireballSpell: function() {
        console.log('muahaha! Eat this fireball!');
    }
};

// yet another anonymous function expression passed as an argument
var castFireballSpell = function(){
    console.log('...chaos and mayhem');
};
</code></pre>


<p>There are a couple of important considerations you need to take into account when using function expressions like the ones described above: they are all <strong>anonymous functions</strong>, and if stored within a variable they are subjected to the same <a href="http://www.barbarianmeetscoding.com/blog/2015/05/03/mastering-the-arcane-art-of-javascript-mancy-for-c-sharp-developers-chapter-1-the-many-a-one-javascript-quirks/"><strong>hoisting</strong> rules that apply to any other variable</a>.</p>

<h4>Anonymous Function Expressions</h4>

<p>So even though you read:</p>

<pre><code>var castFireballSpell = function(){
    console.log('...chaos and mayhem');
};
</code></pre>


<p>and you may be tempted to think that the name of the function is <code>castFireballSpell</code>, it is not, <code>castFireballSpell</code> is just a variable we use to store an anonymous function. You can appreciate this anonymity by inspecting the <code>name</code> property of the function itself:</p>

<pre><code>var castFireballSpell = function(){
    console.log('...chaos and mayhem');
};
console.log(castFireballSpell.name);
// =&gt; ""
// no name!
</code></pre>


<p>Luckily for us, for as long as an anonymous function is bound to a variable the developer tools will use that variable when displaying errors in call stacks (<em>good when debugging</em>):</p>

<pre><code>console.log("you can however examine the call stack and see how an anonymous function that is bound to a variable shows the variable name");
var castFireballSpellWithError = function(){
    console.log('...chaos and mayhem');
    try {
        throw new Error();
    } catch (e) {
        console.log('stack: ', e.stack);
    }
};
castFireballSpellWithError();
//=&gt; stack:  Error
//     at castFireballSpellWithError (http://fiddle.jshell.net/_display/:53:15)
//     at window.onload (http://fiddle.jshell.net/_display/:58:1)
</code></pre>


<p>Even if we use this function as a lambda:</p>

<pre><code>console.log("if you use this function as a lambda the name is still shown in the call stack");
var functionCaller = function(f){ f(); }
functionCaller(castFireballSpellWithError);
// =&gt; stack:  Error
//    at castFireballSpellWithError (http://fiddle.jshell.net/_display/:56:15)
//    at functionCaller (http://fiddle.jshell.net/_display/:68:35)
//    at window.onload (http://fiddle.jshell.net/_display/:69:1)
</code></pre>


<p>However, <strong>an anonymous function not bound to a variable will show as completely anonymous within the call stack making it harder to debug possible errors</strong> (I will call these functions as <em>strict anonymous function</em> in the remainder of the article):</p>

<pre><code>console.log("it is only if you use a strict anonymous function that the name doesn't appear in the call stack");
functionCaller(function(){
    console.log('...chaos and mayhem');
    try {
        throw new Error();
    } catch (e) {
        console.log('stack: ', e.stack);
    }
});
//=&gt; stack:  Error
//    at http://fiddle.jshell.net/_display/:76:15
//    at functionCaller (http://fiddle.jshell.net/_display/:68:35)
//    at window.onload (http://fiddle.jshell.net/_display/:73:1)
</code></pre>


<p>This lack of name can also affect the ability to use recursion. Again, as long as we have the anonymous function bound to a variable we can use the closure to access the function and use recursion:</p>

<pre><code>console.log("you can use recursion when an anonymous function is bound to a variable");
var castManyFireballsSpell = function(n){
    console.log('... SHOOOOOOOOOSH ....');
    if (n &gt; 0)
        castManyFireballsSpell(n-1);
};
castManyFireballsSpell(3);
// =&gt; ... SHOOOOOOOOOSH ....
//    ... SHOOOOOOOOOSH ....
//    ... SHOOOOOOOOOSH ....
//    ... SHOOOOOOOOOSH ....
</code></pre>


<p>It is important to notice that in this example you are just using a closure to access a variable from within a function, and if you, at some point in time, set the variable <code>castManyFireballsSpell</code> to another function, you would get a subtle bug where the original function would call this new function instead of itself (so no recursion and weird stuff happening).</p>

<p>A strict anonymous function, on the other hand, has no way to refer to itself and thus you cannot use recursion:</p>

<pre><code>console.log("but there's no way for an anonymous function to call itself in any other way");
(function(n){
    console.log('... SHOOOOOOOOOSH ....');
    if (n &gt; 0) {
        // I cannot call myself... :(
    }
}(5));
// =&gt; ... SHOOOOOOOOOSH ....
</code></pre>


<p>So, in summary, <strong>the fact that common function expressions are anonymous affects negatively to their readability, debugging and the user of recursion</strong>. Let's see some ways to ameliorate these issues.</p>

<h4>Named Function expressions</h4>

<p>You can solve the problem of anonymity that we've seen thus far by using <strong>named function expressions</strong>. You can declare named function expressions by adding a name after the <code>function</code> keyword:</p>

<pre><code>// named function expression
var castFireballSpell = function castFireballSpell(){
  // mayhem and chaos
};
console.log("this function's name is: ", castFireballSpell.name);
// =&gt; this function's name is castFireballSpell
</code></pre>


<p>A named function expression always appears correctly represented in the call stacks even when used as a lambda (and not bound to a variable):</p>

<pre><code>console.log("A named function expression always appears in the call stack, even when used as a lambda not bound to a variable");
functionCaller(function spreadChaosAndMayhem(){
    console.log('...chaos and mayhem');
    try {
        throw new Error();
    } catch (e) {
        console.log('stack: ', e.stack);
    }
});
// stack:  Error
//     at spreadChaosAndMayhem (http://fiddle.jshell.net/_display/:134:15)
//     at functionCaller (http://fiddle.jshell.net/_display/:68:35)
//     at window.onload (http://fiddle.jshell.net/_display/:131:1)
</code></pre>


<p>This helps both while debugging and makes the code more readable – <em>you can read the name of the function and understand what it attempts to do without looking at the specific implementation</em>.</p>

<p>It is important to understand that the name of the function expression is only used internally, that is, you cannot call a function expression by its name from the outside:</p>

<pre><code>var castFireballSpell = function cucumber(){
    // cucumber?
};
cucumber();
// =&gt; ReferenceError: cucumber is not defined
</code></pre>


<p>But you can do it from the function body, which is very useful when working with recursion:</p>

<pre><code>console.log('but you can call it from the function body which is helpful for recursioon');
(function fireballSpellWithRecursion(n){
    console.log('... SHOOOOOOOOOSH ....');
    if (n &gt; 0) {
        fireballSpellWithRecursion(n-1);
    }
}(5));
// =&gt; ... SHOOOOOOOOOSH ....
//    ... SHOOOOOOOOOSH ....
//    ... SHOOOOOOOOOSH ....
//    ... SHOOOOOOOOOSH ..... etc..
</code></pre>


<p>In summary, <strong>named function expressions improve on anonymous function expressions increasing readability, improving the debugging process and allowing for a function to call itself</strong>.</p>

<h4>Function Expressions are Hoisted as Variables</h4>

<p>We still have a problem with hoisting though: Function expressions are <a href="http://www.barbarianmeetscoding.com/blog/2015/05/03/mastering-the-arcane-art-of-javascript-mancy-for-c-sharp-developers-chapter-1-the-many-a-one-javascript-quirks/">hoisted like variables</a> which means that <strong>you cannot use a function expression until after you have declared it</strong>. This affects readability (since you have to read your code from bottom to top instead of from top to bottom) and can lead to unexpected bugs.</p>

<p>The following example illustrates some of these problems and <a href="http://jsfiddle.net/vintharas/8oocg7Lx/">is also available in jsFiddle</a>:</p>

<pre><code>// if we recap hoisting of variables in JS quickly
// this example:
(function(magic){
    magic.enchant2 = enchant;
    var enchant = function(){ // something };
}(window.magic || (window.magic = {})))
// is equivalent to:
(function(magic){
    var enchant = undefined;
    magic.enchant2 = enchant;
    enchant = function(){ // something };
}(window.magic || (window.magic = {})))

// you cannot do this with function expressions
(function (magic){
    // illustrate how named function expressions help find errors

    magic.enchant2 = enchant;
    // =&gt; hoisting issue, enchant is undefined
    // so we are just exposing an undefined variable thinking it is a function

    // enchant();
    // =&gt; TypeError: enchant is not a function
    // =&gt; hoisting issue, enchant is undefined


    var enchant = function enchant(ingredients){
        var mixture = mix(ingredients),
            dough = work(mixture),
            cake = bake(dough);
        return cake;
    };

    // enchant();
    // =&gt; TypeError: mix is not a function
    // hoisting issue, mix is undefined, and so on...


    var mix = function mix(ingredients){
        console.log('mixin ingredients:', ingredients.join(''));
        return 'un-appetizing mixture';
    }

    var work = function work(mixture){
        console.log('working ' + mixture);
        return 'yet more un-appetizing dough';
    };

    var bake = function bake(dough){
        oven.open();
        oven.placeBaking(dough);
        oven.increaseTemperature(200);
        // insta-oven!
        return oven.claimVictory();
    };

    var oven = {
        open: function(){},
        placeBaking: function(){},
        increaseTemperature: function(){},
        claimVictory: function(){ return 'awesome cake';}
    };

}(window.magic || (window.magic = {})));

try{
    var cake = magic.enchant2(['flour', 'mandragora', 'dragon', 'chicken foot']);
    console.log(cake);
}catch (e){
    console.warn('ups!!!!!!', e);
    // =&gt; ups!!!!!! TypeError: magic.enchant2 is not a function
}
</code></pre>


<p>Recap! <strong>Both named and anonymous function expressions are hoisted as variables which affects readability and can cause bugs when we try to run a function or expose a function as part of the public API of a module before it has been defined</strong>.</p>

<h3>Function Declarations</h3>

<p>And finally we get to function declarations which have some advantages over function expressions:</p>

<ul>
<li>They are named, and you can use that name from the outside and the body of the function itself.</li>
<li>They are hoisted not as variables but completely together with their definition, this makes them impervious to hoisting problems.</li>
</ul>


<p>You write function declarations like this:</p>

<pre><code>// function declaration
function castFireballSpell(){
  // it's getting hot in here...
}
</code></pre>


<p>And they will enable you to write code more similar to the code you are accustomed to write as a C# developer when writing a class, where you declare the public API of a class at the top of the class definition and then you write the implementation of each method from top to bottom, from higher to lower levels of abstraction:</p>

<pre><code>// with function declarations you can write functions like this
// and not worry about hoisting issues
(function(magic){

    // public API of the magic module
    magic.enchant = enchant;

    // functions from higher to lower level of abstraction
    function enchant(ingredients){
        var mixture = mix(ingredients),
            dough = work(mixture),
            cake = bake(dough);
        return cake;
    }

    // these are private functions to this module
    function mix(ingredients){
        console.log('mixin ingredients:', ingredients.join(''));
        return 'un-appetizing mixture';
    }

    function work(mixture){
        console.log('working ' + mixture);
        return 'yet more un-appetizing dough';
    }

    function bake(dough){
        oven.open();
        oven.placeBaking(dough);
        oven.increaseTemperature(200);
        // insta-oven!
        return oven.claimVictory();
    }

    var oven = {
        open: function(){},
        placeBaking: function(){},
        increaseTemperature: function(){},
        claimVictory: function(){ return 'awesome cake';}
    };

}(window.magic || (window.magic = {})));

var cake = magic.enchant(['flour', 'mandragora', 'dragon', 'chicken foot']);
// =&gt; mixin ingredients:  flour mandragora dragon chicken foot
// =&gt; working un-appetizing mixture
console.log(cake);
// =&gt; awesome cake
</code></pre>


<p>You can also use function declarations as lambdas (function as value):</p>

<pre><code>var orc = {toString: function(){return 'a mighty evil orc';}};
var warg = {toString: function(){return 'a terrible warg';}};
var things = [1, orc, warg, false];

// using the disintegrate function declaration as a lambda
// nice and readable
things.forEach(disintegrate);

function disintegrate(thing){
    console.log(thing + ' suddenly disappears into nothingness...');
}

// =&gt; 1 suddenly disappears into nothingness...
// a mighty evil orc suddenly disappears into nothingness...
// a terrible warg suddenly disappears into nothingness...
// false suddenly disappears into nothingness...
</code></pre>


<p>Also notice how the following example, although it can look as a function declaration, is actually a named function expression:</p>

<pre><code>things.forEach(function disintegrate(thing){
    console.log(thing + ' suddenly disappears into nothingness...');
});
</code></pre>


<h2>Concluding: Prefer Function Declarations and Named Function Expressions</h2>

<p>Time to recap. <strong>Function expressions</strong> have some limitations:</p>

<ol>
<li>they are anonymous, which can make them less readable, harder to debug and use in recursion, and</li>
<li>they are hoisted as variables which can lead to bugs and forces you to declare them before you can use them</li>
</ol>


<p><strong>Named function expressions</strong> solve the problem of anonymity, they make your function expressions more readable, easier to debug and enable recursion.</p>

<p><strong>Function declarations</strong> solve both the problem of anonymity and hoisting (since they are completely hoisted), and allow you to write code from higher to lower levels of abstraction.</p>

<p>In summary, and based in these characteristics of functions in JavaScript, <strong>prefer named function expressions and function declarations over anonymous function expressions</strong>.</p>

<h2>Coming Next</h2>

<p>Hope you have enjoyed this article about the different ways you can write functions in JavaScript. Up next, I will discuss the most common patterns to achieve default values, multiple arguments, function overloading when writing JavaScript functions and I'll show you how some of the new features in ES 2015 provide native support for some of these.</p>


<pre>
// CODE EXAMPLES
// http://jsfiddle.net/vintharas/8oocg7Lx/
//=====================================================
	
'use strict'
// log stuff in the home-made console to the write in addition to
// logging it to the browser console
startWorld();

/*

JavaScript-mancy: Mastering the Arcane Art of Writing Awesome JavaScript
Chapter 02 - The Basics of JavaScript Functions

*/

/* 
 * ...In the previous chapter...
 * stranger.says('...err... who the hell are you? and whaaaat is a kender?!');
 *
 */

randalf.says(`Well... I am Randalf. Randalf the Red... JavaScriptmancer
 of the First Order... Guardian of the Sacred Flame... 
Freedom fighter and Poet...`);

stranger.says('uh?');

randalf.says(`Yes! And you are the Chosen one! The Child of Prophecy! 
The one that will bring balance to the force! Muad'Dib! The Dragon reborn!
Brought to this land in the twelfth moon of the twelfth month of the 
twelfth year of the Wyrm to save the world from certain destruction!`);

stranger.says(`I am Mooleen actually... 
and this is the weirdest dream I've ever had...`);
let mooleen = stranger;

randalf.says(`There's no time for this child. You need to learn how to 
defend yourself, it isn't safe here... It all starts with functions, 
functions are the key...`);

narrate("============= Function Are The Key... =============");

// there's two ways to write functions in javascript
// function expressions:

// anonymous function expression
var castFireballSpellExpression = function(){
  // chaos and mayhem
};

// and function declarations
function castFireballSpellDeclaration(){
  // it's getting hot in here...
}

narrate("======= Function Expresssions =============");

// We use the *function expression* style whenever we declare a function like an expression, either by assigning it to a variable:

// an anonymous function expression
var castFireballSpell = function(){
    console.log('...chaos and mayhem');
};
castFireballSpell();
// => ...chaos and mayhem

// another anonymous function expression as a property of an object
var magician = {
    castFireballSpell: function() {
        console.log('muahaha! Eat this fireball!');
    }
};
magician.castFireballSpell();
// => muahaha! Eat this fireball!

// yet another anonymous function expression passed as an argument
var castCombo = function(spellOne, spellTwo){
    console.log('Combo Magic!!!!');
    spellOne();
    spellTwo();
}
castCombo(function(){
    console.log('FireBalllllzzz!!');
}, function(){
    console.log('And Spectral Shield!!');
});
// => Combo Magic!!!!
// => FireBalllllzzz!!
// => And Spectral Shield!!

narrate("\n\n====== JavaScript Arcana: Function Scope and Hoisting ====");
narrate("A short digression about function scope and hoisting");

function openPandoraBox(){

    if (true){
        var x = 'mouse';
    }
    console.log('the pandora box holds a: **' + x + '**');
}
openPandoraBox();
// => the pandora box holds a: **mouse**
// WAT!? x is declared inside an if block. How can it be picked up by the console.log??
// one word: function-scope 

// in reality the variable definition is hoisted to the top of the function
function openPandoraBox(){
    // The variable definition is hoisted up here
    var x = undefined;
    if (true){
        x = 'mouse';
    }
    console.log('the pandora box holds a: **' + x + '**');
    // => the pandora box holds a: **mouse**
}

// and another example of hoisting
function aMagicFunctionToIllustrateHoisting(){
    // in reality
    // var i = undefined
    console.log('before i = ' + i);
    // => before i = undefined
    for(var i = 0; i < 10; i++){
        // jara jara
    }
    console.log('after i = ' + i);
    // => after i = 10
}
aMagicFunctionToIllustrateHoisting();

narrate("\n\n=== Functions cope and functions as structural elements of an application === ")
// Functions being the stewards of scope of an application is pretty interesting because, all of the sudden, a function is not only used for encapsulating and abstracting a piece of logic but also for structural reasons. That is, a way to organize and distribute bits and pieces of functionality and code.

// declaring a function inside a function?
// Ain't that weird????
function blessMany(many){
  many.forEach(bless);
  
  function bless(target){
    console.log('You bless ' + target + '. (+5 WillPower) ');
  }
}

blessMany(['john snow', 'sansa stark']);
// => You bless John Snow (+5 Willpower) 
// => You bless Sansa Stark (+5 Willpower)


narrate("\n\n====== ES6 brings block scope with let and const!");
function openPandoraBoxWithBlockScope(){
    // console.log(treasure); // => undefined
    if (true){
        let treasure = 'mouse';
        // console.log(treasure); // => mouse
    }
    try{
    console.log('the pandora box holds a: **' + treasure + '**');
    } catch (error){
        console.log(error);
    }
}
openPandoraBoxWithBlockScope();
// ReferenceError: treasure is not defined
// fiuuuu now everything makes sense again

function shallIPass(){ // new scope for youShallNotPass block
    let youShallPass = 'you Shall Pass!', 
        youShallNotPass = 'You Shall Not Pass!';
    // console.log(canIPass); // => ReferenceError

    if (true){ // new scope for if block
        let canIPass = youShallNotPass;
        // uncomment to test
        //const canIPass = youShallNotPass;
        console.log(canIPass); // => 'You Shall Not Pass!'
        try{
          canIPass = youShallPass; // => TypeError: Assignment to a constant variable
        } catch (e){
            console.log(e);
        }
    }

    try{
    console.log(canIPass); // => undefined
    } catch(e){
        console.log(e);
    }
    // ReferenceError: x is not defined
}
shallIPass();
// => you Sall not Pass!
// => TypeError: Assignment to a constant variable

console.log('let and const do not hoist variables');
function openPandoraBoxWithBlockScopeAndHoisting(){ // new scope for function block

    if (true){ // new scope for if block
        try{
        console.log('the pandora box holds a: **' + treasure + '**');
        }catch(e)
        {
            console.log(e);
        }
        // ReferenceError: treasure is not defined
        let treasure = 'mouse';
    }
}
openPandoraBoxWithBlockScopeAndHoisting();
// ReferenceError: treasure is not defined

narrate("\n\n====== All these functions are anonymous ====");
narrate("you can inspect the name property of a function and see it is an empty string");
var castFireballSpell = function(){
    console.log('...chaos and mayhem');
};
console.log('name of function stored in castFireballSpell: ', castFireballSpell.name);
// => 'name of function stored in castFireballSpell: <nothing>'



narrate("\nyou can however examine the call stack and see how an anonymous function that is bound to a variable shows the variable name");
var castFireballSpellWithError = function(){
    console.log('...chaos and mayhem');
    try {
        throw new Error();
    } catch (e) {
        console.log('stack: ', e.stack);
    }
};
castFireballSpellWithError();
//=> stack:  Error
//     at castFireballSpellWithError (http://fiddle.jshell.net/_display/:53:15)
//     at window.onload (http://fiddle.jshell.net/_display/:58:1)


narrate("\nif you use this function as a lambda the name is still shown in the call stack");
var spellLauncher = function(f){ f(); }
spellLauncher(castFireballSpellWithError);
// => stack:  Error
//    at castFireballSpellWithError (http://fiddle.jshell.net/_display/:56:15)
//    at spellLauncher (http://fiddle.jshell.net/_display/:68:35)
//    at window.onload (http://fiddle.jshell.net/_display/:69:1)

narrate("\nit is only if you use a strict anonymous function that the name doesn't appear in the call stack");
spellLauncher(function(){
    console.log('...chaos and mayhem');
    try {
        throw new Error();
    } catch (e) {
        console.log('stack: ', e.stack);
    }
});
//=> stack:  Error
//    at http://fiddle.jshell.net/_display/:76:15
//    at spellLauncher (http://fiddle.jshell.net/_display/:68:35)
//    at window.onload (http://fiddle.jshell.net/_display/:73:1)

narrate("\nyou can use recursion when an anonymous function is bound to a variable");
var castManyFireballsSpell = function(n){
    console.log('... SHOOOOOOOOOSH ....');
    if (n > 0) 
        castManyFireballsSpell(n-1);
};
castManyFireballsSpell(3);
// => ... SHOOOOOOOOOSH ....
//    ... SHOOOOOOOOOSH ....
//    ... SHOOOOOOOOOSH ....
//    ... SHOOOOOOOOOSH ....

narrate("\nbut there's no way for an anonymous function to call itself in any other way");
(function(n){
    console.log('... SHOOOOOOOOOSH ....');
    if (n > 0) {
        // I cannot call myself... :(
    }
}(5));

narrate("\n\n=========== Named Function Expressions ===========");
// named function expression
var castFireballSpell = function castFireballSpell(){
  // mayhem and chaos
};
console.log("this function's name is: ", castFireballSpell.name);
// => castFireballSpell

narrate("\nA named function expression always appears in the call stack, even when used as a lambda not bound to a variable");
spellLauncher(function spreadChaosAndMayhem(){
    console.log('...chaos and mayhem');
    try {
        throw new Error();
    } catch (e) {
        console.log('stack: ', e.stack);
    }
});
// stack:  Error
//     at spreadChaosAndMayhem (http://fiddle.jshell.net/_display/:134:15)
//     at functionCaller (http://fiddle.jshell.net/_display/:68:35)
//     at window.onload (http://fiddle.jshell.net/_display/:131:1)


narrate("\na function expression's name is only used internally, you cannot call a function expression by it's name from the outside");
var castFireballSpell = function cucumber(){
    // cucumber?
};
try{
  cucumber();
} catch (e)
{
  console.log(e);
}
// => ReferenceError: cucumber is not defined

narrate('\nbut you can call it from the function body which is helpful for recursioon');
(function fireballSpellWithRecursion(n){
    console.log('... SHOOOOOOOOOSH ....');
    if (n > 0) {
        fireballSpellWithRecursion(n-1);
    }
}(5));
// => ... SHOOOOOOOOOSH ....
//    ... SHOOOOOOOOOSH ....
//    ... SHOOOOOOOOOSH ....
//    ... SHOOOOOOOOOSH ..... etc..


narrate("\nfunction expressions and the problems of variable hoisting");
// you cannot do this with function expressions
(function (magic){
    // this function represents a module 'magic'
    // it's just a way to group like-minded pieces of code

    // exposing enchant as the API for the 'magic' module
    magic.enchant = enchant;
    // => hoisting issue, enchant is undefined at this point
    // so we are just exposing an undefined variable thinking it is a function

    // if uncommented this would cause an exception
    // enchant();
    // => TypeError: enchant is not a function
    // => hoisting issue, enchant is undefined at this point

    var enchant = function enchant(ingredients){
        var mixture = mix(ingredients),
            dough = work(mixture),
            cake = bake(dough);
        return cake;
    };

    // if uncommented this would cause an exception
    // enchant();
    // => TypeError: mix is not a function (it's undefined at this point)
    // hoisting issue, mix is undefined at this point

    var mix = function mix(ingredients){
        console.log('mixin ingredients:', ingredients.join(''));
        return 'un-appetizing mixture';
    }

    var work = function work(mixture){
        console.log('working ' + mixture);
        return 'yet more un-appetizing dough';
    };

    var bake = function bake(dough){
        oven.open();
        oven.placeBaking(dough);
        oven.increaseTemperature(200);
        // insta-oven!
        return oven.claimVictory();
    };

    var oven = {
        open: function(){},
        placeBaking: function(){},
        increaseTemperature: function(){},
        claimVictory: function(){ return 'awesome cake';}
    };

}(window.magic || (window.magic = {})));

try{
    var cake = magic.enchant(['flour', 'mandragora', 'dragon', 'chicken foot']);
    console.log(cake);
}catch (e){
    console.error('ups!!!!!! ', e);
    // => ups!!!!!! TypeError: magic.enchant2 is not a function
}



narrate("\n=========== Function Declaration ===============");
// function declaration
function castFireballSpell(){
  // it's getting hot in here...
}

// with function declarations you can write functions like this
// and not worry about hoisting issues
(function(magic){
    
    magic.enchant = enchant;
    
    function enchant(ingredients){
        var mixture = mix(ingredients),
            dough = work(mixture),
            cake = bake(dough);
        return cake;
    }
    
    function mix(ingredients){
        console.log('mixin ingredients: ', ingredients.join(' '));
        return 'un-appetizing mixture';
    }
    
    function work(mixture){
        console.log('working ' + mixture);
        return 'yet more un-appetizing dough';
    }
    
    function bake(dough){
        oven.open();
        oven.placeBaking(dough);
        oven.increaseTemperature(200);
        // insta-oven!
        return oven.claimVictory();
    }
    
    var oven = { 
        open: function(){}, 
        placeBaking: function(){}, 
        increaseTemperature: function(){}, 
        claimVictory: function(){ return 'awesome cake';}
    };


}(window.magic || (window.magic = {})));

var cake = magic.enchant(['flour', 'mandragora', 'dragon', 'chicken foot']);
console.log(cake);

narrate("\n===== we can also use function declarations as lambdas ====");

var orc = {toString: function(){return 'a mighty evil orc';}};
var warg = {toString: function(){return 'a terrible warg';}};
var things = [1, orc, warg, false];

things.forEach(disintegrate);

function disintegrate(thing){
    console.log(thing + ' suddenly disappears into nothingness...');
}

// => 1 suddenly disappears into nothingness...
// a mighty evil orc suddenly disappears into nothingness...
// a terrible warg suddenly disappears into nothingness...
// false suddenly disappears into nothingness...

/**** World interface *****/
function createWorld(){
    var world = createWorldAPI(console);
    window.addEventListener('error', function(e){
        world.error(e.message);
    });   
    return world;
    
    // *** World/Logger code ***
    function createWorldAPI(console){   
        var logFn = console.log,
            errorFn = console.error,
            infoFn = console.info;
        
        return { 
            log: function log(){
                var args = Array.prototype.slice.call(arguments),
                    message = formatLogMessage.apply(this, args);
                logFn.apply(console, args);
                addWorldEvent(message);
            },
            error: function error(){
                var args = Array.prototype.slice.call(arguments),
                    message = formatLogMessage.apply(this, arguments);
                errorFn.apply(console, args);
                addWorldEvent(message, 'error');
            },
            info: function info(){
                var args = Array.prototype.slice.call(arguments),
                    message = formatLogMessage.apply(this, arguments);
                infoFn.apply(console, args);
                addWorldEvent(message, 'info');
            },
            spell: function spell(){
                var args = Array.prototype.slice.call(arguments),
                    message = formatLogMessage.apply(this, arguments);
                logFn.apply(console, args);
                addWorldEvent(message, 'spell');
            }

        };
        
        function formatLogMessage(){
            var args = Array.prototype.slice.call(arguments), 
                message = args.reduce(function(acc, item){
                    if (item instanceof Array){
                        item = "[" + item.join(', ') + "]";
                    } else if (item instanceof Function) {
                        item = item.toString();
                    }
                    else if (item instanceof Object) {
                        var properties = [],
                            ctor = item.constructor.name;
                        for(prop in item) {
                            properties.push(prop + ': ' + item[prop]);
                        }
                        item = ctor + ' {' + properties.join(', ') + '}';
                    }
                    return acc + item;
                }, "");
            return message;
        }           
        
        function addWorldEvent(message, type){
            var theWorld = document.getElementById("theWorld"),
                span = document.createElement('span'),
                type = type || 'event';
            span.className = 'world world-' + type;
            span.innerHTML = message;
            theWorld.appendChild(span);
        }
    }
}


function startWorld(){
    /**** load logging ****/
    window.world = createWorld();
    // hijack logs
    console.log = world.log;
    console.info = world.info;
    console.error = world.error;
    
    /**** characters *****/
    window.stranger = {
        says: function(msg){ world.log('The stranger says: ' + msg + '\n\n');},
        weaves: function(spell){ 
            world.log('The stranger starts weaving a spell!'); 
            world.log('***' + spell + '***');
            eval(spell); 
        }
    }
    window.randalf = {
        says: function(msg){ world.log('Randalf the Red says: ' + msg + '\n\n');},
        weaves: function(spell){ 
            world.log('Randalf the Red starts weaving a spell!');
            world.log('***' + spell + '***');
            eval(spell); 
        }
    }
    
    function weaveSpell(spell){
        eval(spell);
    }
}

function narrate(){
    world.info.apply(console, arguments);
}	
</pre>
</div>
					</div>
				</article>
				<!--================= END :: Tutorial =================-->
				
				<!--================= START :: Tutorial =================-->
				<article>
					<a id="t-92" name="t-92"></a><h1>92 : Mastering the Arcane Art of JavaScript-mancy for C Sharp Developers - Chapter 3: Useful Function Patterns - Default Arguments</h1>
					<span class="ref-site">https://www.barbarianmeetscoding.com/blog/2015/05/11/mastering-the-arcane-art-of-javascript-mancy-for-c-sharp-developers-useful-function-patterns-default-arguments/</span>
					<div class="tutorial__content">
<div class="entry-content">

<p>In the next few articles of the <a href="http://www.barbarianmeetscoding.com/blog/categories/javascriptmancy/">javascript-mancy series</a> I will detail several patterns you can use in JavaScript to achieve default arguments, multiple arguments and function overloading.</p>

<p>We'll start with how to use default arguments and values in JavaScript both with the current version on JavaScript (ES5) and the upcoming ECMAScript 2015 that brings native support for defaults.</p>



<!-- more -->


<h2>Using default arguments in JavaScript</h2>

<h3>A Pattern For Using Default Arguments in JavaScript Today</h3>

<p>If you are new to javascript, you may have noticed the following statement and wondered what (the heck) it meant:</p>

<pre><code>// from jquery loads.js (https://github.com/jquery/jquery/blob/master/src/ajax/load.js)
type: type || "GET",

// or from yeoman yo router.js (https://github.com/yeoman/yo/blob/master/lib/router.js)
this.conf = conf || new Configstore(pkg.name, {
    generatorRunCount: {}
  });
</code></pre>


<p><em>These two examples have been taken from <a href="https://github.com/jquery/jquery/blob/master/src/ajax/load.js">jQuery</a> and <a href="https://github.com/yeoman/yo/blob/master/lib/router.js">yo</a> if you'd like to take a closer look</em></p>

<p>Well, that's how you declare defaults in JavaScript. Since there is no native support for default arguments (as of ES5), you make use of the <code>||</code> (OR) operator that returns the first <a href="https://developer.mozilla.org/en-US/docs/Glossary/Truthy">truthy</a> expression of those being evaluated or the last expression if none is truthy:</p>

<pre><code>// using any web dev tools in your browser
&gt; false || 42 || false
// =&gt; 42

&gt; "" || false
// =&gt; false

&gt; "" || {}
// =&gt; Object {}

&gt; var numberOfPotatos = undefined
&gt; numberOfPotatos || 3
// =&gt; 3

&gt; numberOfPotatos = 5
&gt; numberOfPotatos || 3
// =&gt; 5
</code></pre>


<p>Here you have a complete example:</p>

<pre><code>function castIceCone(mana, otherConsiderations){
    // we take advantage of the || operator to define defaults
    var mana = mana || 5,
        otherConsiderations = otherConsiderations || {},
        direction = otherConsiderations.direction || 'in front of you',
        caster = this || 'God almighty';

    console.log(format("${caster} spends ${mana} mana and casts a terrible ice cone ${direction}"));

    // an utility function to mimic ES6 templating xD
    function format(str){
        return str.split(' ')
        .map(function(token){
            if (/\$\{.*\}/.test(token))
                return eval(token.match(/\$\{(.*)\}/)[1]);
            return token;
        }).join(' ');
    };
}

castIceCone();
// =&gt; God almighty spends 5 mana and casts a terrible ice cone in front of you

var jaime = {
    toString: function(){return 'Jaime the Mighty';},
    castIceCone: castIceCone
};
jaime.castIceCone(10, { direction: 'towards Mordor'})
// =&gt; Jaime the Mighty spends 10 mana and casts a terrible ice cone towards Mordor
</code></pre>


<p>You can <a href="http://jsfiddle.net/vintharas/b2knom2d/">test run this example yourself at jsFiddle</a>.</p>

<h3>Native Default Arguments with ECMASCript 2015</h3>

<p><a href="https://github.com/lukehoban/es6features">ECMAScript 2015</a>, the latest version of JavaScript, makes it very easy to declare default arguments:</p>

<p><em>You <a href="http://jsfiddle.net/vintharas/yjkvLbhr/">can find these examples in this jsFiddle</a>, in order to run them and experiment with ES2015 I recommend you to head over to <a href="https://babeljs.io/repl/">https://babeljs.io/repl/</a> which has a very nice REPL that provides support for running ES2015 code.</em></p>

<pre><code>    // run on babel.js
    function castIceCone(mana=5){
        // we take advantage of the || operator to define defaults
        var caster = this || 'God almighty';

        // note this new ES2015 template strings btw
        console.log(`${caster} spends ${mana} mana and casts a terrible ice cone`);
    }

    castIceCone();
    // =&gt; God almighty spends 5 mana and casts a terrible ice cone

    var jaime = {
        toString: function(){return 'Jaime the Mighty';},
        castIceCone: castIceCone
    };
    jaime.castIceCone(10, { direction: 'towards Mordor'})
    // =&gt; Jaime the Mighty spends 10 mana and casts a terrible ice cone
</code></pre>


<p>Defaults in JavaScript are not limited to <a href="https://msdn.microsoft.com/en-us/library/dd264739.aspx">"constant" expressions like in C# <em>optional arguments</em></a>. In JavaScript you can use even objects and the new destructuring syntax to assign object properties to variables directly.</p>

<p>In the example below we use the object <code>{direction: 'in front of you'}</code> as a default value for the second argument and automatically declare a variable <code>direction</code> and assign the <code>'in front of you'</code> value to it:</p>

<pre><code>    // run on Babel
    // defaults are not limited to constant values, you can even use objects
    function castIceCone(mana=5, {direction='in front of you'}={}){
        var caster = this || 'God almighty';

        // new template strings
        console.log(`${caster} spends ${mana} mana and casts a terrible ice cone ${direction}`);
    }

    castIceCone();
    // =&gt; God almighty spends 5 mana and casts a terrible ice cone in front of you

    var jaime = {
        toString: function(){return 'Jaime the Mighty';},
        castIceConePro: castIceConePro
    };
    jaime.castIceConePro(10, { direction: 'towards Mordor'})
    // =&gt; Jaime the Mighty spends 10 mana and casts a terrible ice cone towards Mordor
</code></pre>


<p>And you are not limited to arbitrary objects either, you can use any expression, for instance, a function expression:</p>

<pre><code>// defaults are not limited to constant values
function castSpell(spell=function(){console.log('holy shit a callback!');}){
    spell();
}

 castSpell();
 // =&gt; holy shit a callback!
 castSpell(function(){console.log("balefire!!!! You've been wiped out of existence");});
 // =&gt; balefire!!!! You've been wiped out of existence
</code></pre>


<h2>Concluding</h2>

<p>In this article you learned how to use defaults in JavaScript up to ES5 and beyond with the new native support for defaults that is coming with ES2015. Up next, more function patterns with multiple arguments and the rest operator.</p>

</div>
					</div>
				</article>
				<!--================= END :: Tutorial =================-->
				
				<!--================= START :: Tutorial =================-->
				<article>
					<a id="t-93" name="t-93"></a><h1>93 : Mastering the Arcane Art of JavaScript-mancy for C# Developers - Chapter 4: More Useful Function Patterns - Multiple Arguments</h1>
					<span class="ref-site">https://www.barbarianmeetscoding.com/blog/2015/05/14/mastering-the-arcane-art-of-javascript-mancy-for-c-sharp-developers-chapter-4-more-useful-function-patterns-multiple-arguments/</span>
					<div class="tutorial__content">
<div class="entry-content">

<p>Time for some more useful function patterns in JavaScript!</p>

<p>In this article I'll show you how to handle multiple parameters – the equivalent to <code>params</code> in C# – in the current version on JavaScript (ES5) and in the upcoming ECMAScript 2015 that brings great support for multiple parameters with the <em>rest parameter syntax</em>.</p>


<h2>A Pattern For Using Multiple Arguments In Functions Today</h2>

<p><em>You can <a href="http://jsfiddle.net/vintharas/0ghtyebn/">experiment with all these examples in examples in JsFiddle</a>.</em></p>

<p>JavaScript gives you a lot of freedom when it comes to handling function parameters and arguments. For instance, you can declare a function with a specific number of parameters and call it without arguments:</p>

<pre><code>function heal(person, inchantation, modifier){
    var healedHp;
    modifier = modifier || 1;
    healedHp = modifier * 100;

    console.log('you heal ' + person + ' with ' + inchantation + ' spell (+' + healedHp + 'hp)' );
    person.hp += healedHp;
}
try{
    heal();
} catch (e) {
    console.log(e)
}
// =&gt; you heal undefined with undefined spell (+100hp)
// =&gt; typeError: cannot read property hp of undefined
</code></pre>


<p>Or with as many arguments you want:</p>

<pre><code>// or with as many arguments as you want
var JonSnow = {name: 'Jon Snow', hp: 5, toString: function(){return this.name;}};
heal(JonSnow);
// =&gt; you heal Jon Snow with undefined spell (+100hp)
heal(JonSnow, 'cure');
// =&gt; you heal Jon Snow with cure spell (+100hp)
heal(JonSnow, 'super heal', /* modifier */ 2);
// =&gt; you heal Jon Snow with super heal spell (+200hp)
</code></pre>


<p>Or even with more arguments than the parameters defined in the function:</p>

<pre><code>heal(JonSnow, 'heal', 1, 3, 2, 3, 'cucumber', {a: 1, b:2}, 'many arguments');
// =&gt; you heal Jon Snow with heal spell (+100hp)
</code></pre>


<p>It is up to you to implement the body of a function and handle each case as you see fit. But <strong>what happens when you want to write a function that takes an arbitrary number of arguments?</strong> In C# whenever we want to write such a function we use the <a href="https://msdn.microsoft.com/en-us/library/w5zay9db.aspx"><code>params</code> keyword</a>. In JavaScript on the other hand, and as of ES5, there's no keyword nor operator that allows us to declare that a function will take an arbitrary number of arguments and handle it within the function body in a seamless manner.</p>

<p>The only approach possible is to use <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Functions/arguments">the <code>arguments</code> object</a> that is present within every function in JavaScript and which provides access to the arguments used to call a function:</p>

<pre><code>// Taking a variable number of parameters in JavaScript:
// In C# we use params
// In JavaScript we take advantage of the arguments object
// available within every function
function obliterate(){
    // Unfortunately arguments is not an array :O
    // so we need to convert it ourselves
    var victims = Array.prototype.slice.call(arguments, /* startFromIndex */ 0);
    victims.forEach(function(victim){
        console.log(victim + " wiped out of the face of the earth");
    });
    console.log('*Everything* has been obliterated, oh great master of evil and deceit!');
}

obliterate("John Doe", getPuppy(), 1, new Minion('Willy', 'troll'));
/*
John Doe wiped out of the face of the earth
cute puppy wiped out of the face of the earth
1 wiped out of the face of the earth
Willy the troll wiped out of the face of the earth
*Everything* has been obliterated, oh great master of evil and deceit!
*/

function getPuppy(){
    return {
        cuteWoof: function(){console.log('wiii');},
        toString: function(){return 'cute puppy';}
    };
};

function Minion(name, type){
    this.name = name;
    this.type = type;
    this.toString = function(){ return name + " the " + type;};
}
</code></pre>


<p>There are a couple of specially interesting things to point out in this example.</p>

<p>The first one is the fact that we are sending arguments of different types to the function and they are all treated seamlessly. That's an example of <a href="http://en.wikipedia.org/wiki/Duck_typing">duck typing</a> in action where <em>an object is defined by what it can do and not by what the object type is</em>. As long as the values that we pass as arguments support the interface the function implementation expects – in this case the <code>toString</code> method – everything will work just fine.</p>

<p>The second thing to point out is the use of the <code>Array.prototype.slice</code> function to convert the <code>arguments</code> variable into a real array <code>victims</code>. While you could think that <code>arguments</code> is an array, it is not (this is another of JavaScript quirks right here), it is an <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Functions/arguments"><strong>array-like</strong> object</a> that you can index, <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Enumerability_and_ownership_of_properties">enumerate</a>, and that has a <code>length</code> property:</p>

<pre><code>function inspectArguments(){
    console.log("the first argument is ", arguments[0]);
    console.log("the second argument is ", arguments[1]);
    console.log("there are " + arguments.length + " arguments");

    // the arguments are enumerable like
    // any common array or object, and thus you could use
    // the for/in loop
    for (var idx in arguments) {
       console.log("item at position " + idx + " is " + arguments[idx]);
    }
}
inspectArguments("cucumber", "dried meat", "dagger", "rock");
// =&gt; the first argument is cucumber
// =&gt; the second argument is dried meat
// =&gt; there are 4 arguments
// =&gt; item at position 1 is cucumber
// =&gt; etc...
</code></pre>


<p>But that does not have any of the array functions that you would expect:</p>

<pre><code>function inspectArgumentsFunctions(){
    console.log("arguments.foreach is ", arguments.foreach);
    console.log("arguments.map is ", arguments.map);
    console.log("arguments.some is", arguments.some);
}
inspectArgumentsFunctions();
// =&gt; arguments.foreach is undefined
// =&gt; arguments.map is undefined
// =&gt; arguments.some is undefined
</code></pre>


<p>Using the <code>slice</code> function of <code>Array.prototype</code> allows you to convert <code>arguments</code> to an array and take advantage of all the nice array functions. This is what we did with the <code>obliterate</code> function within the first example:</p>

<pre><code>function obliterate(){
    //...
    var victims = Array.prototype.slice.call(arguments, /* startFromIndex */ 0);
    victims.forEach(function(victim){
        console.log(victim + " wiped out of the face of the earth");
    });
    //...
}
</code></pre>


<h2>Native Multiple Arguments with ECMASCript 2015 With Rest Parameters</h2>

<p><a href="http://wiki.ecmascript.org/doku.php?id=harmony:specification_drafts">ES2015</a> (ES6), the upcoming new version of JavaScript, comes with a native way to handle multiple arguments: <a href="https://developer.mozilla.org/en/docs/Web/JavaScript/Reference/Functions/rest_parameters"><strong>rest parameters</strong></a>.</p>

<p>All the complexities of using the <code>arguments</code> object in the previous examples can be substitued by rest parameters and handled in a much seamless fashion:</p>

<pre><code>function obliterate(...victims){
    victims.forEach(function(victim){
        console.log(victim + " wiped out of the face of the earth");
    });
    console.log('*Everything* has been obliterated, oh great master of evil and deceit!');
}
</code></pre>


<p>When using the rest parameters syntax, the <code>victims</code> parameter becomes an array so there's no need to perform additional conversions.</p>

<p><em>You can test <a href="http://jsfiddle.net/vintharas/1hj34wx8/">the example above on this jsFiddle snippet</a>.</em></p>

<h2>Concluding</h2>

<p>In this article you learned about the flexibility of handling parameters and arguments in JavaScript, how to implement functions that can handle an arbitrary number of arguments in JavaScript today (in a similar way to how <code>params</code> works in C#). You also learned that in the upcoming version of JavaScript – ES 2015 – you will be able to use the <em>rest parameters syntax</em> that works exactly like <code>params</code> in C#.</p>


<h2>A Sidenote on Using Array.prototype.slice On Arguments</h2>

<p>While I was writing this article I found out that there's a drawback when using <code>Array.prototype.slice</code> to convert <code>arguments</code> in a array: It prevents the browser JavaScript engine from performing optimizations.</p>

<p>The recommended approach is to use <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array#Array_generic_methods"><code>Array.slice</code> generic method</a> – Array generic methods are specially implemented to be used on other types – but it is not a part of the ECMAScript specification (not even of ES6/2015) and is only implemented in certain browsers (try testing <code>Array.slice</code> in the web developer console on Chrome, Firefox and Internet Explorer and you'll see that it only exists in Firefox).</p>

<p>You have two options:</p>

<ul>
<li>use a polyfill that falls back to <code>Array.prototype.slice</code> when there are no generic functions available</li>
<li>ignore the recommendation based on the fact that functions with an arbitrary of arguments are uncommon :)</li>
</ul>


<p>This problem will take care of itself when we start using the <em>rest parameter syntax</em>.</p>

</div>
					</div>
				</article>
				<!--================= END :: Tutorial =================-->
				
				<!--================= START :: Tutorial =================-->
				<article>
					<a id="t-94" name="t-94"></a><h1>94 : Mastering the Arcane Art of Javascript-mancy for C# Developers - Chapter 5: Even More Useful Function Patterns - Function Overloading</h1>
					<span class="ref-site">https://www.barbarianmeetscoding.com/blog/2015/05/26/mastering-the-arcane-art-of-javascript-mancy-for-c-sharp-developers-chapter-5-more-useful-function-patterns-function-overloading/</span>
					<div class="tutorial__content">
<div class="entry-content">

<p>In the last couple of articles we learned some useful patterns with functions in JavaScript that helped us achieve <a href="http://www.barbarianmeetscoding.com/blog/2015/05/11/mastering-the-arcane-art-of-javascript-mancy-for-c-sharp-developers-useful-function-patterns-default-arguments/">default arguments</a> and <a href="http://www.barbarianmeetscoding.com/blog/2015/05/14/mastering-the-arcane-art-of-javascript-mancy-for-c-sharp-developers-chapter-4-more-useful-function-patterns-multiple-arguments/">multiple arguments</a> and we saw how <a href="https://github.com/lukehoban/es6features">ECMAScript 2015</a> (ES6) can simplify the way we can incorporate either of these in our code.</p>

<p>Today I will close this section – useful function patterns – with some tips on how you can achieve function overloading in JavaScript. Hope you like it!</p>

<!-- more -->


<h2>The Problem with Function Overloading in JavaScript</h2>



<p>There's a slight problem when you attempt to do function overloading in JavaScript like you would in C#… <strong>you can't do it</strong>:</p>

<pre><code>// One does not simply overload functions in JavaScript willy nilly
console.log("one does not simply overload functions in JavaScript")
function raiseSkeleton(){
    console.log('raise skeleton!!!');
}

function raiseSkeleton(mana){
    console.log('raise skeleton has been overwritten!!!');
}

raiseSkeleton();
// =&gt; raise skeleton has been overwritten!!!
console.log("functions get overwritten if you declare them multiple times, even if they have different signatures");
</code></pre>


<p>In JavaScript, you cannot override a function by defining a new function with the same name and a different signature, if you try to do so, you'll just succeed in completely overwriting your original function with a new implementation.</p>

<h2>How Do We Achieve Function Overloading In JavaScript Then?</h2>

<p>Well, as with many things in JavaScript, you'll need to take advantage of the flexibility and freedom the language gives you to emulate function overloading yourself. One common pattern for achieving function overloading is to use the <code>arguments</code> object and <strong>inspect the arguments</strong> that are passed into a function:</p>

<pre><code>// Instead
// #1 you can do argument inspection, which sucks
// - less readable and maintainable
function raiseSkeletonWithArgumentInspecting(){
    if (typeof arguments[0] === "number"){
        raiseSkeletonsInNumber(arguments[0]);
    } else if (typeof arguments[0] === "string") {
        raiseSkeletonCreature(arguments[0]);
    } else {
        console.log('raise a skeleton');
    }

    function raiseSkeletonsInNumber(n){
        console.log('raise ' + n + ' skeletons');
    }
    function raiseSkeletonCreature(creature){
        console.log('raise a skeleton ' + creature);
    };
}
</code></pre>


<p>Following this pattern you inspect each argument being passed to the overloaded function (or even the number of arguments) and determine which internal implementation to execute:</p>

<pre><code>raiseSkeletonWithArgumentInspecting();
// =&gt; raise a skeleton
raiseSkeletonWithArgumentInspecting(4);
// =&gt; raise 4 skeletons
raiseSkeletonWithArgumentInspecting('king');
// =&gt; raise skeleton king
</code></pre>


<p>This approach can get very unwieldy, very fast. As the overloaded functions and their parameter increase in number, the function becomes harder and harder to read, maintain and extend.</p>

<p>At this point you may be thinking: <em>"…checking the type of the arguments being passed?? seriously?!?"</em> and I concur with you, that's why I like to use this next approach instead.</p>

<p>A better way to achieve function overloading is to use an <em>options</em> object that acts as a container for the different parameters a function can consume:</p>

<pre><code>// #2 or use an object to wrap parameters with rules
// - it gives you named arguments
// - and painless extension if more arguments are required
function raiseSkeletonWithOptions(spellOptions){
    spellOptions = spellOptions || {};
    var armySize = spellOptions.armySize || 1,
        creatureType = spellOptions.creatureType || '';

    if (creatureType){
        console.log('raise a skeleton ' + creatureType);
    } else {
        console.log('raise ' + armySize + ' skeletons ' + creatureType);
    }

}

raiseSkeletonWithOptions();
// =&gt; raise a skeleton
raiseSkeletonWithOptions({armySize: 4});
// =&gt; raise 4 skeletons
raiseSkeletonWithOptions({creatureType:'king'});
// =&gt; raise skeleton king
</code></pre>


<p>This is not strictly function overloading but it provides the same benefits, it gives you different APIs for a given function, and additionally, named arguments and easy extensibility (as you can add new options without breaking any clients).</p>

<p>Here is an example of the options object pattern in the wild, <a href="https://github.com/jquery/jquery/blob/master/src/ajax.js">the jQuery ajax function</a>:</p>

<pre><code>// Main method
    ajax: function( url, options ) {

        // If url is an object, simulate pre-1.5 signature
        if ( typeof url === "object" ) {
            options = url;
            url = undefined;
        }

        // Force options to be an object
        options = options || {};

        var transport,
            // URL without anti-cache param
            cacheURL,
            // Response headers
            responseHeadersString,
            responseHeaders,
            // timeout handle
            timeoutTimer,
        // etc lots of codes
    }
</code></pre>


<h2>ECMAScript 2015 Helps You Out with Function Overloading</h2>

<p>Although ES2015 doesn't come with classic function overloading it <a href="http://www.barbarianmeetscoding.com/blog/2015/05/11/mastering-the-arcane-art-of-javascript-mancy-for-c-sharp-developers-useful-function-patterns-default-arguments/">comes with default arguments</a> which give you better support for function overloading than what we've had so far:</p>

<pre><code>function castIceCone(mana=5, {direction='in front of you'}={}){
    var caster = this || 'God almighty';

    // new template strings
    console.log(`${caster} spends ${mana} mana and casts a terrible ice cone ${direction}`);
}

castIceCone();
// =&gt; God almighty spends 5 mana and casts a terrible ice cone in front of you

var jaime = {
    toString: function(){return 'Jaime the Mighty';},
    castIceConePro: castIceConePro
};
jaime.castIceConePro(10, { direction: 'towards Mordor'})
// =&gt; Jaime the Mighty spends 10 mana and casts a terrible ice cone towards Mordor
</code></pre>


<h2>A Glimpse Into Functional Programming and Polymorphic Functions</h2>

<p>Yet another interesting pattern for achieving function overloading in JavaScript is to rely on JavaScript great support for functional programming. In the world of functional programming there's the concept of <strong>polymorphic functions</strong>, that is, functions which exhibit different behaviors based on their arguments.</p>

<p>Let's start by decomposing the previous examples into smaller functions:</p>

<p><em>You can <a href="http://bit.ly/javascriptmancy-function-overload-functionally">experiment with this example directly within this jsBin</a> or downloading the source code from <a href="https://github.com/vintharas/javascriptmancy">GitHub</a>.</em></p>

<pre><code>function raiseSkeletons(number){
    if (Number.isInteger(number)){ return `raise ${number} skeletons`;}
}

function raiseSkeletonCreature(creature){
    if (creature) {return `raise a skeleton ${creature}`;}
}

function raiseSingleSkeleton(){
    return 'raise a skeleton';
}
</code></pre>


<p>And now we create an abstraction (functional programming likes abstraction) for a function that executes several functions in sequence until one returns a valid result (different from undefined):</p>

<pre><code>// this is a higher order function
// that returns a new function
// something like a function factory
// we could reuse it to our heart's content
function dispatch(...fns){

    return function(...args){
        for(let f of fns){
          let result = f.apply(null, args);
          if (exists(value)) {return result;}

        }
    };
}

function exists(value){
    return value !== undefined
}
</code></pre>


<p>Once we have defined the <code>dispatch</code> function, we can use it to create a <code>raiseSkeletonFunctionally</code> polymorphic function that behaves in different fashions based on the arguments it takes. The function will delegate to the each special raise skeleton function until a suitable result is obtained. The last <code>raiseSingleSkeleton</code> is a catch-all function that will return a result every time <code>raiseSkeletonFunctionally</code> is called.</p>

<pre><code>let raiseSkeletonFunctionally = dispatch(raiseSkeletons, raiseSkeletonCreature, raiseSingleSkeleton);

console.log(raiseSkeletonFunctionally());
// =&gt; raise a skeleton
console.log(raiseSkeletonFunctionally(4));
// =&gt; raise 4 skeletons
console.log(raiseSkeletonFunctionally('king'));
// =&gt; raise a skeleton king
</code></pre>


<p>A super duper mega cool thing that you may or may not have noticed is the awesome degree of composability of this approach. If we want to extend this function later own, we do it without modifying the original function. Take a look at this:</p>

<pre><code>// But wait! There is more!
// Let's extend our raise skeleton function!
function raiseOnSteroids({number=0, type='skeleton'}={}){
  if(number){return `raise ${number} ${type}s`;}
}

let raiseAdvanced = dispatch(raiseOnSteroids, raiseSkeletonFunctionally);

console.log(raiseAdvanced());
// =&gt; raise a skeleton
console.log(raiseAdvanced(4));
// =&gt; raise 4 skeletons
console.log(raiseAdvanced('king'));
// =&gt; raise a skeleton king
console.log(raiseAdvanced({number: 10, type: 'ghoul'}))
// =&gt; raise 10 ghouls

// AWESOME
</code></pre>


<p>This is the OCP (Open-Closed Principle)<sup id="fnref:1"><a href="#fn:1" rel="footnote">1</a></sup> in full glory. Functional programming is pretty awesome right? We will take a deeper dive into functional programmming later within the series and you'll get the chance to experiment a lot more with higher-order functions and function composition alike. But if you can't wait, don't let me stop you, by all means, jump on!</p>

<h2>Concluding</h2>

<p>Although JavaScript doesn't support function overloading you can achieve the same behavior by using different approaches.</p>

<p>You can either take advantage of the <code>arguments</code> object and <strong>inspect the arguments</strong> that are being passed to a function at runtime, solution that you should only use with the simplest of implementations as it becomes unwieldly and hard to maintain as parameters and overloads are added to a function.</p>

<p>Or you can use an <strong>options object</strong> as a wrapper for parameters, solution that is both more readable and maintanaible and which provides two additional benefits: named arguments and a lot of flexibility to extend the function with new arguments.</p>

<p>ES2015 brings improved support for function overloading with default arguments.</p>

<p>Finally, you can take advantage of functional programming,compose your functions from smaller functions and use a dispatching mechanism to select which function is called based on the arguments.</p>

<p>And that is that :). Hope you have enjoyed reading the article. Have a nice day! See you next time with functions in ECMAScript 2015 and JavaScript's version of LINQ.</p>

<div class="footnotes">
<hr>
<ol>
<li id="fn:1">
<p>Open for extension and closed for modification. http://bit.ly/ocp-wikipedia<a href="#fnref:1" rev="footnote">↩</a></p></li>
</ol>
</div>

</div>
					</div>
				</article>
				<!--================= END :: Tutorial =================-->
				
				<!--================= START :: Tutorial =================-->
				<article>
					<a id="t-95" name="t-95"></a><h1>95 : Object-Oriented JavaScript</h1>
					<h2>Advanced Techniques for Serious Web Applications</h2>
					<span class="ref-site">https://dzone.com/refcardz/object-oriented-javascript</span>
					<div class="tutorial__content">
<div>
    <div class="content">
        <div class="">
            <div>
                <div id="chapter-0" class="chapter-box">Section 1
                    <th-if-scroll relative-to="top" from="40" to="60" callback="activate($index)" class="ng-isolate-scope"></th-if-scroll>
                </div>
                <h2 class="chapter-title">Introduction</h2>
            </div>
            <div class="col-md-12 content-html" dz-code-container="" ng-non-bindable="">
                <p pid="38">As HTML5 standards mature, JavaScript has become the de-facto programming language of the web for client-side environments, and is gaining ground rapidly on the server-side. As JavaScript code-bases grow larger and more complex, the object-oriented capabilities of the language become increasingly crucial. Although JavaScript's object-oriented capabilities are not as powerful as those of static server-side languages like Java, its current object-oriented model can be utilized to write better code.</p><p pid="39">In this Refcard, you'll learn how to write object-oriented code in JavaScript. Code samples include some EcmaScript 5 (JavaScript's specification) features and have been tested in Firefox 17, Chrome 23 and Internet Explorer 9.</p>
            </div>

            <div class="col-md-12 col-sm-12 col-xs-12 background-striped"></div>
        </div>
    </div>
    <div class="content">
        <div class="">
            <div>
                <div id="chapter-1" class="chapter-box">Section 2
                    <th-if-scroll relative-to="top" from="40" to="60" callback="activate($index)" class="ng-isolate-scope"></th-if-scroll>
                </div>
                <h2 class="chapter-title">Comparison of Java and JavaScript</h2>
            </div>
            <div class="col-md-12 content-html" dz-code-container="" ng-non-bindable="">
                <table border="1" width="630">
 <thead>
  <tr class="left_th_colored">
   <td>Java</td>
   <td>JavaScript</td>
  </tr>
 </thead>
 <tbody>
  <tr>
   <td class="right_td_colored">Statically typed</td>
   <td class="right_td_colored">Dynamically typed</td>
  </tr>
  <tr>
   <td class="left_td_colored">Custom types are defined with class, interface or enum</td>
   <td class="left_td_colored">Custom types are defined with functions and prototypes</td>
  </tr>
  <tr>
   <td class="right_td_colored">Types cannot be changed at runtime</td>
   <td class="right_td_colored">Types can be changed at runtime</td>
  </tr>
  <tr>
   <td class="left_td_colored">Variables needs a type when declared (Strong typing)</td>
   <td class="left_td_colored">No type needed when variables are declared (Loose typing)</td>
  </tr>
  <tr>
   <td class="right_td_colored">Constructors are special methods</td>
   <td class="right_td_colored">Constructor is just a function;&nbsp; no distinction between function and constructor</td>
  </tr>
  <tr>
   <td class="left_td_colored">Class and instance are different entities</td>
   <td class="left_td_colored">Everything is object; constructor functions and prototypes are also object</td>
  </tr>
  <tr>
   <td class="right_td_colored">Static and instance members supported</td>
   <td class="right_td_colored">No direct static member support</td>
  </tr>
  <tr>
   <td class="left_td_colored">Abstract types supported with abstract classes and interfaces</td>
   <td class="left_td_colored">No direct abstract type support</td>
  </tr>
  <tr>
   <td class="right_td_colored">Good enough member scoping options; private, package, protected, public</td>
   <td class="right_td_colored">Only public members supported by language</td>
  </tr>
  <tr>
   <td class="left_td_colored">Rich inheritance mechanism</td>
   <td class="left_td_colored">Poor prototypal inheritance</td>
  </tr>
  <tr>
   <td class="right_td_colored">Method overloading and overriding possible</td>
   <td class="right_td_colored">No direct overloading and overriding support</td>
  </tr>
  <tr>
   <td class="left_td_colored">Rich reflection features</td>
   <td class="left_td_colored">Some reflection features</td>
  </tr>
  <tr>
   <td class="right_td_colored">Modularity with package support</td>
   <td class="right_td_colored">No direct package or module support</td>
  </tr>
 </tbody>
</table>
            </div>

            <div class="col-md-12 col-sm-12 col-xs-12 background-striped"></div>
        </div>
    </div>
    <div class="content">
        <div class="">
            <div>
                <div id="chapter-2" class="chapter-box">Section 3
                    <th-if-scroll relative-to="top" from="40" to="60" callback="activate($index)" class="ng-isolate-scope"></th-if-scroll>
                </div>
                <h2 class="chapter-title">Object Type Definition</h2>
            </div>
            <div class="col-md-12 content-html" dz-code-container="" ng-non-bindable="">
                <h3>Type Definition</h3><p pid="40">Every function is also a type, and new instances of these functions can be created with the "new" operator. Function declaration can behave like a constructor, and in this case is called a Constructor Function. In constructor functions, prototype methods and fields can be accessed.</p><pre><code>function MyType(){
   if (!(this instanceof MyType))
        throw new Error("Constructor can't be called as a function");
}
var myInstance = new MyType();
MyType(); // Error: Constructor can't be called as a function
</code></pre><p pid="41">In Eclipse, object types can be easily inspected in the JavaScript perspective. Constructor, instance members, static members and inner functions are all separated in Outline View.</p><p pid="42"><img alt="Inspecting Object Types" class="fr-dii fr-fil" src="/storage/rc-covers/12997-thumb.png"></p><h3>Instance Members</h3><p pid="43">Instance members are accessed from instance objects which are created with the "new" operator. Instance members are created via "this" keyword, prototype, constructor closure or Object.defineProperty method.</p><pre><code>function Cat(name){
        var voice = "Meow";
        this.name = name;
        this.say = function(){
                return voice;
}
}
Cat.prototype.eat = function(){
        return "Eating";
}
var cat = new Cat("Fluffy");
Object.defineProperty(cat, "numLegs",{value: 4,writable:true,enumerable:true,configurable:true});
console.log(cat.name); // Fluffy
console.log(cat.numLegs); // 4
console.log(cat.say()); // Meow
console.log(cat.eat()); // Eating
</code></pre><h3>Static Members</h3><p pid="44">There is no direct support for static members. Constructor functions are used to create static members. Static members can't be accessed with "this" keyword.</p><p pid="45"><strong>Public Static Members:</strong></p><pre><code>function Factory(){
}
// public static method
Factory.getType = function (){
return "Object Factory";
};
// public static field
Factory.versionId = "F2.0";
Factory.prototype.test = function(){
console.log(this.versionId); // undefined
console.log(Factory.versionId); // F2.0
console.log(Factory.getType()); // Object Factory
}
var factory = new Factory();
factory.test();
</code></pre><p pid="46"><strong>Private Static Members:</strong></p><pre><code>var Book = (function () {
        // private static field
        var numOfBooks = 0;
        // private static method
        function checkIsbn(isbn) {
                if (isbn.length != 10 &amp;&amp; isbn.length != 13) 
                        throw new Error("isbn is not valid!");
        }
        function Book(isbn, title) {
                checkIsbn(isbn);
                this.isbn = isbn;
                this.title = title;
                numOfBooks++;
                this.getNumOfBooks = function () {
                        return numOfBooks;
                }
        }
        return Book;
})();
var firstBook = new Book("0-943396-04-2", "First Title");
console.log(firstBook.title); // First Title
console.log(firstBook.getNumOfBooks()); // 1
var secondBook = new Book("0-85131-041-9", "Second Title");
console.log(firstBook.title); // First Title
console.log(secondBook.title); // Second Title
console.log(firstBook.getNumOfBooks()); // 2
console.log(secondBook.getNumOfBooks()); // 2
</code></pre><h3>Abstract Types</h3><p pid="47">JavaScript is a loosely typed language, so you don't have to specify the variable type of a variable when you declare it and pass as an argument. This reduces the need for abstract types like interfaces. But abstract types may be needed to collect common functionality when inheritance is used.</p><pre><code>(function(){
var abstractCreateLock = false;
// abstract type
function BaseForm(){
        if(abstractCreateLock)
                throw new Error("Can't instantiate BaseForm!");
}
BaseForm.prototype = {};
BaseForm.prototype.post = function(){
        throw new Error("Not implemented!");
}
function GridForm(){
}
GridForm.prototype = new BaseForm();
abstractCreateLock = true;
GridForm.prototype.post = function(){
        // ...
        return "Grid is posted.";
}
window.BaseForm = BaseForm;
window.GridForm = GridForm;
})();
var myGrid = new GridForm();
console.log(myGrid.post()); // Grid is posted.
var myForm = new BaseForm(); // Error: Can't instantiate BaseForm!
</code></pre><h3>Interfaces</h3><p pid="48">There is no direct interface or virtual class support in JavaScript. It can be mimicked as below, leaving a method signature check:</p><pre><code>var Interface = function (name, methods) {
        this.name = name;
        // copies array
        this.methods = methods.slice(0);
};
Interface.checkImplements = function (obj, interfaceObj) {
        for (var i = 0; i &lt; interfaceObj.methods.length; i++) {
                var method = interfaceObj.methods[i];
                if (!obj[method] || typeof obj[method] !== "function")
                        throw new Error("Interface not implemented! Interface: " + interfaceObj.name + " Method: " + method);
        }
};
var iMaterial = new Interface("IMaterial", ["getName", "getPrice"]);
function Product(name,price,type){ 
        Interface.checkImplements(this, iMaterial);
        this.name = name;
        this.price = price;
        this.type = type;
}
Product.prototype.getName = function(){
        return this.name;
};
Product.prototype.getPrice = function(){
        return this.price;
};
var firstCar = new Product("Super Car X11",20000,"Car");
console.log(firstCar.getName()); // Super Car X11
delete Product.prototype.getPrice;
var secondCar = new Product("Super Car X12",30000,"Car"); // Error: Interface not implemented! Interface: IMaterial Method: getPrice
</code></pre><h3>Singleton Objects</h3><pre><code>var Logger = {
        enabled:true,
        log: function(logText){
                if(!this.enabled)
                        return;
                if(console &amp;&amp; console.log)
                        console.log(logText);
                else
                        alert(logText);
        }
}
Or
function Logger(){
}
Logger.enabled = true;
Logger.log = function(logText){
        if(!Logger.enabled)
                return;
        if(console &amp;&amp; console.log)
                console.log(logText);
        else
                alert(logText);
};
Logger.log("test"); // test
Logger.enabled = false; 
Logger.log("test"); //
</code></pre>
            </div>

            <div class="col-md-12 col-sm-12 col-xs-12 background-striped"></div>
        </div>
    </div>
    <div class="content">
        <div class="">
            <div>
                <div id="chapter-3" class="chapter-box">Section 4
                    <th-if-scroll relative-to="top" from="40" to="60" callback="activate($index)" class="ng-isolate-scope"></th-if-scroll>
                </div>
                <h2 class="chapter-title">Object Creation</h2>
            </div>
            <div class="col-md-12 content-html" dz-code-container="" ng-non-bindable="">
                <h3>With "new" Operator</h3><p pid="49">Instances of built-in or user-defined object types can be created with the "new" operator. The "new" operator runs only with constructor functions. An already created object can't be used with "new" again. First, the "new" operator creates an empty object; then it calls the constructor function while assigning the newly created object as "this". The constructor function runs with the given arguments, performing its coded initializations.</p><pre><code>//or var dog = {};
//or var dog = new MyDogType();
var dog = new Object();
dog.field1 = "Scooby";
dog.owner = {};
dog.owner.name = "Mike";
dog.bark = function(){
        return "Woof";
};
console.log(dog.field1); // Scooby
console.log(dog.owner.name); // Mike 
console.log(dog.bark()); // Woof
</code></pre><h3>With Object Literal</h3><p pid="50">It is very easy to create objects with object literal. It is also possible to create nested objects.</p><pre><code>var dog = {
        name:"value1",
        owner:{
                name:"Mike"
        },
        bark:function(){
                return "Woof";
        }
};
console.log(dog.name); // Scooby
console.log(dog.owner.name); // Mike 
console.log(dog.bark()); // Woof
</code></pre>
            </div>

            <div class="col-md-12 col-sm-12 col-xs-12 background-striped"></div>
        </div>
    </div>
    <div class="content">
        <div class="">
            <div>
                <div id="chapter-4" class="chapter-box">Section 5
                    <th-if-scroll relative-to="top" from="40" to="60" callback="activate($index)" class="ng-isolate-scope"></th-if-scroll>
                </div>
                <h2 class="chapter-title">Member Scoping</h2>
            </div>
            <div class="col-md-12 content-html" dz-code-container="" ng-non-bindable="">
                <h3>Private Fields</h3><p pid="51">In JavaScript, there is no built-in private field support. But this support can be achieved with constructor closures. Variables defined within a constructor function can be used as private fields. Any methods using private fields should be declared in the constructor function (note that prototype methods can't be declared in the constructor function and used with private fields). Private setter and getter functions should be declared in the constructor function.</p><pre><code>function Customer(){
        // private field
        var risk = 0;
        this.getRisk = function(){
                return risk;
        };
        this.setRisk = function(newRisk){
                risk = newRisk;
        };
        this.checkRisk = function(){
                if(risk &gt; 1000)
                        return "Risk Warning";
                return "No Risk";
        };
}
Customer.prototype.addOrder = function(orderAmount){
        this.setRisk(orderAmount + this.getRisk());
        return this.getRisk();
};
var customer = new Customer();
console.log(customer.getRisk()); // 0
console.log(customer.addOrder(2000)); // 2000
console.log(customer.checkRisk()); // Risk Warning
</code></pre><h3>Private Methods</h3><p pid="52">Also called "Nested" or "Inner Functions". Private methods are defined within another function and can't be accessed from outside. Private methods can be declared in any part of a function.</p><pre><code>function Customer(name){
        var that = this;
        var risk = 0;
        this.name = name;
        this.type = findType();
        // private method
        function findType() {
                console.log(that.name);
                console.log(risk);
                return "GOLD";
        }
}
Or
function Customer(name){
        var that = this;
        var risk = 0; 
        this.name = name;
        // private method
        var findType = function() {
                console.log(that.name);
                console.log(risk);
                return "GOLD";
        };
        this.type = findType();
}
var customer = new Customer("ABC Customer"); // ABC Customer
                                       // 0
console.log(customer.type); // GOLD
console.log(customer.risk); // undefined
</code></pre><p pid="53">If a private inner function is returned outside, its methods can be called from outside:</p><pre><code>function Outer(){
        return new Inner();
        //private inner
        function Inner(){
                this.sayHello = function(){
                        console.log("Hello");
                }
        }
}
(new Outer()).sayHello(); // Hello
</code></pre><h3>Privileged Methods</h3><p pid="54">Prototype methods can't access private fields; everything attached to them is also "public". We need a way to declare methods so that (a) they are accessible publicly and (b) they can access private members, which means privileged or protected access. For this purpose, the following code can be used:</p><pre><code>function Customer(orderAmount){
        // private field
        var cost = orderAmount / 2;
        this.orderAmount = orderAmount;
        var that = this;
        // privileged method
        this.calculateProfit = function(){
                return that.orderAmount - cost; 
        };
}
Customer.prototype.report = function(){
        console.log(this.calculateProfit());
};
var customer = new Customer(3000);
customer.report(); // 1500
</code></pre><h3>Public Fields</h3><p pid="55">For public fields, prototype or instance can be used. Prototype fields and methods are shared by new instances. (Prototype objects are also shared). If a new instance changes the field or method in its object, the change is not reflected in other instances. To change all instances, we need to change it in the prototype object.</p><pre><code>function Customer(name,orderAmount){
        // public fields
        this.name = name;
        this.orderAmount = orderAmount;
}
Customer.prototype.type = "NORMAL";
Customer.prototype.report = function(){
        console.log(this.name);
        console.log(this.orderAmount);
        console.log(this.type);
        console.log(this.country);
};
Customer.prototype.promoteType = function(){
        this.type = "SILVER";
};
var customer1 = new Customer("Customer 1",10);
// public field
customer1.country = "A Country";
customer1.report(); // Customer 1
                    // 10
                    // NORMAL
                    // A Country
var customer2 = new Customer("Customer 2",20);
customer2.promoteType();
console.log(customer2.type); // SILVER
console.log(customer1.type); // NORMAL
Public Methods
Prototype methods are public. Any methods attached to "this" are also public.
function Customer(){
        // public method
        this.shipOrder = function(shipAmount){
                return shipAmount;
        };
}
// public method
Customer.prototype.addOrder = function (orderAmount) {
        var totalOrder = 0;
        for(var i = 0; i &lt; arguments.length; i++) {
                totalOrder += arguments[i];
        }
        return totalOrder;
};
var customer = new Customer();
// public method
customer.findType = function(){
        return "NORMAL";
};
console.log(customer.addOrder(25,75)); // 100
console.log(customer.shipOrder(50)); // 50
console.log(customer.findType()); // NORMAL
</code></pre>
            </div>

            <div class="col-md-12 col-sm-12 col-xs-12 background-striped"></div>
        </div>
    </div>
    <div class="content">
        <div class="">
            <div>
                <div id="chapter-5" class="chapter-box">Section 6
                    <th-if-scroll relative-to="top" from="40" to="60" callback="activate($index)" class="ng-isolate-scope"></th-if-scroll>
                </div>
                <h2 class="chapter-title">Inheritance</h2>
            </div>
            <div class="col-md-12 content-html" dz-code-container="" ng-non-bindable="">
                <p pid="56">There are different ways to implement inheritance in JavaScript. "Prototypal Inheritance" – using prototype as an inheritance mechanism – has many advantages. For example:</p><pre><code>function Parent(){
        var parentPrivate = "parent private data";
        var that = this;
        this.parentMethodForPrivate = function(){
                return parentPrivate;
        }; 
        console.log("parent");
}
Parent.prototype = {
        parentData: "parent data",
        parentMethod: function(arg){
                return "parent method"; 
        },
        overrideMethod: function(arg){
                return arg + " overriden parent method"; 
        }
}
function Child(){
// super constructor is not called, we have to invoke it
        Parent.call(this);
        console.log(this.parentData);
        var that = this;
        this.parentPrivate = function(){
                return that.parentMethodForPrivate();
        };
        console.log("child");
}
//inheritance
Child.prototype = new Parent();// parent
Child.prototype.constructor = Child;
//lets add extented functions
Child.prototype.extensionMethod = function(){
        return "child's " + this.parentData;
};
//override inherited functions
Child.prototype.overrideMethod = function(){
        //parent's method is called
        return "Invoking from child" + Parent.prototype.overrideMethod.call(this, " test");
}
var child = new Child();// parent
                // parent data 
                // child
console.log(child.extensionMethod()); //child's parent data
console.log(child.parentData); //parent data
console.log(child.parentMethod()); //parent method
console.log(child.overrideMethod()); //Invoking from child test overriden parent method
console.log(child.parentPrivate()); // parent private data
console.log(child instanceof Parent); //true
console.log(child instanceof Child); //true
</code></pre><p pid="57">When a member of child object is accessed, it is searched from the object's members. If it is not found there, then it is searched in its prototype object. If it is not found there, then it is searched in the parent object's members and prototype. It is searched up to the Object's prototype. This hierarchy is also called the "Prototype chain". The following diagram illustrates the chain:</p><p pid="58"><img alt="inheritance" class="fr-dii fr-fil" src="https://dzone.com/storage/rc-covers/12998-thumb.png" width="450px" /></p>
            </div>

            <div class="col-md-12 col-sm-12 col-xs-12 background-striped"></div>
        </div>
    </div>
    <div class="content">
        <div class="">
            <div>
                <div id="chapter-6" class="chapter-box">Section 7
                    <th-if-scroll relative-to="top" from="40" to="60" callback="activate($index)" class="ng-isolate-scope"></th-if-scroll>
                </div>
                <h2 class="chapter-title">Modularization</h2>
            </div>
            <div class="col-md-12 content-html" dz-code-container="" ng-non-bindable="">
                <p pid="59">Once we have many custom object types, we need to group them and manage their visibility, dependencies, and loading. "Namespace and Module Pattern" can be used to handle these tasks. (Note that EcmaScript version 6 (Harmony) is beginning to develop a full-fledged module system. Until it is implemented by browsers, there are some useful libraries to facilitate these features.)</p><h3>Namespaces</h3><p pid="60">There is no direct namespace support in JavaScript. We can create namespace via objects and fill our object types in object properties:</p><pre><code>//create namespace
var myLib = {};
myLib.myPackage = {};
//Register types to namespace
myLib.myPackage.MyType1 = MyType1;
myLib.myPackage.MyType2 = MyType2;
</code></pre><h3>Modules</h3><p pid="61">Modules are a way of dividing our JavaScript code-base into packages. Modules export some object type definitions and import other modules. The module system loads each module and its dependencies. First it runs the dependencies in appropriate order; then the module code is executed. Some libraries can be used for this purpose.</p><p pid="62">In modules, we define new types, import some types from other modules and export our public types. Here is an example of a module definition:</p><pre><code>Module.define("module1.js",["dependent_module1.js","dependent_module2.js",...], function(dependentMod1, dependentMod2) { //IMPORTS
//TYPE DEFINITIONS
function ExportedType1(){
        // use of dependent module's types
        var dependentType = new dependentMod1.DependentType1();
        ...
}
function ExportedType2(){
}
...
// EXPORTS
return { ExportedType1: ExportedType1, ExportedType2: ExportedType2,...};
});
</code></pre><p pid="63">To use a module (can work asynchronously or synchronously):</p><pre><code>Module.use(["module1.js"], function(aModule){
        console.log("Loaded aModule!");
        var AType = aModule.AnExportedType;
        var atype1Instance = new AType();
});
</code></pre>
            </div>

            <div class="col-md-12 col-sm-12 col-xs-12 background-striped"></div>
        </div>
    </div>
    <div class="content">
        <div class="">
            <div>
                <div id="chapter-7" class="chapter-box">Section 8
                    <th-if-scroll relative-to="top" from="40" to="60" callback="activate($index)" class="ng-isolate-scope"></th-if-scroll>
                </div>
                <h2 class="chapter-title">Custom Exceptions</h2>
            </div>
            <div class="col-md-12 content-html" dz-code-container="" ng-non-bindable="">
                <p pid="64">In JavaScript, there are built-in exceptions like Error, TypeError and SyntaxError which may be created and thrown during runtime. Every exception is "unchecked". An ordinary object can be used as an exception with throw statement. Thus, we can create our own custom exceptions and throw and catch them. It is good practice to write exceptions that extend JavaScript's standard Error object.</p><pre><code>function BaseException() {
}
BaseException.prototype = new Error();
BaseException.prototype.constructor = BaseException;
BaseException.prototype.toString = function(){
        // note that name and message are properties of Error
        return this.name + ": " + this.message;
};
function NegativeNumberException(value) {
        this.name = "NegativeNumberException";
        this.message = "Negative number! Value: " + value;
}
NegativeNumberException.prototype = new BaseException();
NegativeNumberException.prototype.constructor = NegativeNumberException;
function EmptyInputException() {
        this.name = "EmptyInputException";
        this.message = "Empty input!";
}
EmptyInputException.prototype = new BaseException();
EmptyInputException.prototype.constructor = EmptyInputException;
var InputValidator = (function(){
var InputValidator = {};
InputValidator.validate = function(data){
        var validations = [validateNotNegative,validateNotEmpty];
        for(var i = 0; i &lt; validations.length; i++){
                try {
                        validations[i](data);
                }
                catch (e) {
                        if (e instanceof NegativeNumberException) {
                                //re-throw
                                throw e;
                        }
                        else if (e instanceof EmptyInputException) {
                                // tolerate it
                                data = "0";
                        }
                }
        }
};
return InputValidator;
function validateNotNegative(data){
                if (data &lt; 0)
                        throw new NegativeNumberException(data);
}
function validateNotEmpty(data){
                if (data == "" || data.trim() == "")
                        throw new EmptyInputException();
}
})();
try{
        InputValidator.validate("-1");
}
catch(e){
        console.log(e.toString()); // NegativeNumberException: Negative number! Value: -1
}
finally{
        console.log("Validation is done."); // Validation is done.
}
</code></pre>
            </div>

            <div class="col-md-12 col-sm-12 col-xs-12 background-striped"></div>
        </div>
    </div>
    <div class="content">
        <div class="">
            <div>
                <div id="chapter-8" class="chapter-box">Section 9
                    <th-if-scroll relative-to="top" from="40" to="60" callback="activate($index)" class="ng-isolate-scope"></th-if-scroll>
                </div>
                <h2 class="chapter-title">Custom Events</h2>
            </div>
            <div class="col-md-12 content-html" dz-code-container="" ng-non-bindable="">
                <p pid="65">Custom events reduce code complexity and decrease coupling of objects. Here is a typical event pattern:</p><pre><code>function EventManager(){
}
var listeners = {};
EventManager.fireEvent = function(eventName, eventProperties) {
        if (!listeners[eventName]) 
                return;
        for (var i = 0; i &lt; listeners[eventName].length; i++) {
                listeners[eventName][i](eventProperties);
        }
};
EventManager.addListener = function(eventName, callback) {
        if (!listeners[eventName]) 
                listeners[eventName] = [];
        listeners[eventName].push(callback);
};
EventManager.removeListener = function(eventName, callback) {
        if (!listeners[eventName]) 
                return;
        for (var i = 0; i &lt; listeners[eventName].length; i++) {
                if (listeners[eventName][i] == callback) {
                        delete listeners[eventName][i];
                        return;
                }
        }
};
EventManager.addListener("popupSelected", function(props){
        console.log("Invoked popupSelected event: " + props.itemID);
});
EventManager.fireEvent("popupSelected", {itemID:"100"}); // Invoked popupSelected event: 100
</code></pre>
            </div>

            <div class="col-md-12 col-sm-12 col-xs-12 background-striped"></div>
        </div>
    </div>
    <div class="content">
        <div class="">
            <div>
                <div id="chapter-9" class="chapter-box">Section 10
                    <th-if-scroll relative-to="top" from="40" to="60" callback="activate($index)" class="ng-isolate-scope"></th-if-scroll>
                </div>
                <h2 class="chapter-title">Writing Components</h2>
            </div>
            <div class="col-md-12 content-html" dz-code-container="" ng-non-bindable="">
                <p pid="66">JavaScript lets developers add new behaviors to HTML elements. These enrichments can be combined in a component structure. There is a continuing specification work by the W3C on "Web Components". Here is a commonly used pattern to bind JavaScript objects to DOM objects. In this way, we can collect behaviors and manage their lifecycles.</p><p pid="67"><strong>1- Define JavaScript Component:</strong></p><pre><code>function InputTextNumberComponent(domElement){
        this.initialize(domElement);
}
InputTextNumberComponent.prototype.initialize = function(domElement){
        domElement.onchange = function(){
                //just a format
                domElement.value = "-" + domElement.value + "-";
        };
domElement.jsComponent = this; //Expando property
        this.domElement = domElement;
};
InputTextNumberComponent.prototype.resetValue = function(){
        this.domElement.value = "";
};
</code></pre><p pid="68"><strong>2- Define CSS Class to Correlate HTML Elements with JavaScript Components:</strong></p><pre><code>&lt;style type="text/css"&gt;
.inputTextNumber { text-align:right; }
&lt;/style&gt;
</code></pre><p pid="69">HTML element should be as follows:</p><pre><code>&lt;input type="text" class="inputTxtNumber" name="NumberField" size="10" value="Click me!" onClick="this.jsComponent.resetValue()"&gt;
</code></pre><p pid="70"><strong>3- When page is loaded (or DOM ready), detect HTML elements and create components:</strong></p><pre><code>window.onload = function(){
        var inputTextNumbers = document.getElementsByClassName("inputTextNumber");
        for(var i = 0; i &lt; inputTextNumbers.length; i++){
                var myComp = new InputTextNumberComponent(inputTextNumbers.item(i));
        }
};
</code></pre>
            </div>

            <div class="col-md-12 col-sm-12 col-xs-12 background-striped"></div>
        </div>
    </div>
<!-- ngRepeat: bumper in campaign.bumpers --></div>
					</div>
				</article>
				<!--================= END :: Tutorial =================-->
				
				<!--================= START :: Tutorial =================-->
				<article>
					<a id="t-96" name="t-96"></a><h1>96 : The Basics of Object-Oriented JavaScript</h1>
					<span class="ref-site">https://code.tutsplus.com/tutorials/the-basics-of-object-oriented-javascript--net-7670</span>
					<div class="tutorial__content">
<div class="post-body__content"><p>Over recent years, JavaScript has increasingly gained popularity, partly due to libraries that are developed to make JavaScript apps/effects easier to create for those who may not have fully grasped the core language yet. </p>

<p>While in the past it was a common argument that JavaScript was a basic language and was very 'slap dash' with no real foundation; this is no longer the case, especially with the introduction of high scale web applications and 'adaptations' such as JSON (JavaScript Object Notation). </p>

<p>JavaScript can have all that an Object-Orientated language has to offer, albeit with some extra effort outside of the scope of this article. </p>

<h3 class="nolinks">Let's Create an Object</h3>

<div><pre><code>function myObject(){
&nbsp;
};
</code></pre></div>

<p>Congratulations, you just created an object. There are two ways to create a JavaScript object: they are 'Constructor functions' and 'Literal notation'. The one above is a Constructor function, I'll explain what the difference is shortly, but before I do, here is what an Object definition looks like using literal notation.</p>

<div><pre><code>var myObject = {
&nbsp;
};
</code></pre></div>

<p>Literal is a preferred option for name spacing so that your JavaScript code doesn't interfere (or vice versa) with other scripts running on the page and also if you are using this object as a single object and not requiring more than one instance of the object, whereas Constructor function type notation is preferred if you need to do some initial work before the object is created or require multiple instances  of the object where each instance can be changed during the lifetime of the script. Let's continue to build on both our objects simultaneously so we can observe what the differences are.</p>

<h3 class="nolinks">Defining Methods and Properties</h3>

<h4 class="nolinks">Constructor version:</h4>

<div><pre><code>function myObject(){
&nbsp;&nbsp;&nbsp;&nbsp;this.iAm = 'an object';
&nbsp;&nbsp;&nbsp;&nbsp;this.whatAmI = function(){
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;alert('I am ' + this.iAm);
&nbsp;&nbsp;&nbsp;&nbsp;};
};
</code></pre></div>

<h4 class="nolinks">Literal version:</h4>

<div><pre><code>var myObject = {
&nbsp;&nbsp;&nbsp;&nbsp;iAm : 'an object',
&nbsp;&nbsp;&nbsp;&nbsp;whatAmI : function(){
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;alert('I am ' + this.iAm);
&nbsp;&nbsp;&nbsp;&nbsp;}
}
</code></pre></div>

<p>For each of the objects we have created a property 'iAm' which contains a string value that is used in our objects method 'whatAmI' which alerts a message. </p>

<blockquote>
<p>
Properties are variables created inside an object and methods are functions created inside an object.</p>

</blockquote>

<p>Now is probably as good a time as any to explain how to use properties and methods (although you would already have done so if you are familiar with a library).</p>

<p>To use a property first you type what object it belongs to - so in this case it's myObject - and then to reference its internal properties, you put a full stop and then the name of the property so it will eventually look like <span class="skimlinks-unlinked">myObject.iAm</span> (this will return 'an object').</p>

<p>For methods, it is the same except to execute the method, as with any function, you must put parenthesis after it; otherwise you will just be returning a reference to the function and not what the function actually returns. So it will look like myObject.whatAmI() (this will alert 'I am an object').</p>

<h4 class="nolinks">Now for the differences:</h4>

<ul>
<li>The constructor object has its properties and methods defined with the     keyword 'this' in front of it, whereas the literal version does not.</li>
<li>In the constructor object the properties/methods have their 'values'     defined after an equal sign '=' whereas in the literal version, they are     defined after a colon ':'.</li>
<li>The constructor function can have (optional) semi-colons ';' at the     end of each property/method declaration whereas in the literal version     if you have more than one property or method, they MUST be separated with     a comma ',', and they CANNOT have semi-colons after them, otherwise JavaScript will return an error.</li>
</ul>

<p>There is also a difference between the way these two types of object declarations are used.</p>

<p>To use a literally notated object, you simply use it by referencing its variable name, so wherever it is required you call it by typing;</p>

<div><pre><code>myObject.whatAmI();
</code></pre></div>

<p>With constructor functions you need to instantiate (create a new instance of) the object first; you do this by typing;</p>

<div><pre><code>var myNewObject = new myObject();
myNewObject.whatAmI();
</code></pre></div>

<h3 class="nolinks">Using a Constructor Function.</h3>

<p>Let's use our previous constructor function and build upon it so it performs some basic (but dynamic) operations when we instantiate it.</p>

<div><pre><code>function myObject(){
&nbsp;&nbsp;&nbsp;&nbsp;this.iAm = 'an object';
&nbsp;&nbsp;&nbsp;&nbsp;this.whatAmI = function(){
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;alert('I am ' + this.iAm);
&nbsp;&nbsp;&nbsp;&nbsp;};
};
</code></pre></div>

<p>Just like any JavaScript function, we can use arguments with our constructor function;</p>

<div><pre><code>function myObject(what){
&nbsp;&nbsp;&nbsp;&nbsp;this.iAm = what;
&nbsp;&nbsp;&nbsp;&nbsp;this.whatAmI = function(language){
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;alert('I am ' + this.iAm + ' of the ' + language + ' language');
&nbsp;&nbsp;&nbsp;&nbsp;};
};
</code></pre></div>

<p>Now let's instantiate our object and call its whatAmI method, filling in the required fields as we do so.</p>

<div><pre><code>var myNewObject = new myObject('an object');
myNewObject.whatAmI('JavaScript');
</code></pre></div>

<p>This will alert 'I am an object of the JavaScript language.'</p>

<h3 class="nolinks">To Instantiate or not to Instantiate</h3>

<p>I mentioned earlier about the differences between Object Constructors and Object Literals and that when a change is made to an Object Literal it affects that object across the entire script, whereas when a Constructor function is instantiated and then a change is made to that instance, it won't affect any other instances of that object. Let's try an example;</p>

<p>First we will create an Object literal;</p>

<div><pre><code>var myObjectLiteral = {
&nbsp;&nbsp;&nbsp;&nbsp;myProperty : 'this is a property'
}
&nbsp;
//alert current myProperty
alert(myObjectLiteral.myProperty); //this will alert 'this is a property'
&nbsp;
//change myProperty
myObjectLiteral.myProperty = 'this is a new property';
&nbsp;
//alert current myProperty
alert(myObjectLiteral.myProperty); //this will alert 'this is a new property', as expected
</code></pre></div>

<p>Even if you create a new variable and point it towards the object, it will have the same effect.</p>

<div><pre><code>var myObjectLiteral = {
&nbsp;&nbsp;&nbsp;&nbsp;myProperty : 'this is a property'
}
&nbsp;
//alert current myProperty
alert(myObjectLiteral.myProperty); //this will alert 'this is a property'
&nbsp;
//define new variable with object as value
var sameObject = myObjectLiteral;
&nbsp;
//change myProperty
myObjectLiteral.myProperty = 'this is a new property';
&nbsp;
//alert current myProperty
alert(sameObject.myProperty); //this will still alert 'this is a new property'
</code></pre></div>

<p>Now let's try a similar exercise with a Constructor function.</p>

<div><pre><code>//this is one other way of creating a Constructor function
var myObjectConstructor = function(){
&nbsp;&nbsp;&nbsp;&nbsp;this.myProperty = 'this is a property'
}
&nbsp;
//instantiate our Constructor
var constructorOne = new myObjectConstructor();
&nbsp;
//instantiate a second instance of our Constructor
var constructorTwo = new myObjectConstructor();
&nbsp;
//alert current myProperty of constructorOne instance
alert(constructorOne.myProperty); //this will alert 'this is a property'
&nbsp;&nbsp;
&nbsp;//alert current myProperty of constructorTwo instance
alert(constructorTwo.myProperty); //this will alert 'this is a property'
</code></pre></div>

<p>So as expected, both return the correct value, but let's change the myProperty for one of the instances.</p>

<div><pre><code>//this is one other way of creating a Constructor function
var myObjectConstructor = function(){
&nbsp;&nbsp;&nbsp;&nbsp;this.myProperty = 'this is a property'
}
&nbsp;
//instantiate our Constructor
var constructorOne = new myObjectConstructor();
&nbsp;
//change myProperty of the first instance
constructorOne.myProperty = 'this is a new property';
&nbsp;
//instantiate a second instance of our Constructor
var constructorTwo = new myObjectConstructor();
&nbsp;
//alert current myProperty of constructorOne instance
alert(constructorOne.myProperty); //this will alert 'this is a new property'
&nbsp;&nbsp;
&nbsp;//alert current myProperty of constructorTwo instance
alert(constructorTwo.myProperty); //this will still alert 'this is a property'
</code></pre></div>

<p>As you can see from this example, even though we changed the property of constructorOne it didn't affect myObjectConstructor and therefore didn't affect constructorTwo. Even if constructorTwo was instantiated before we changed the myProperty property of constructorOne, it would still not affect the myProperty property of constructorTwo as it is a completely different instance of the object within JavaScript's memory.</p>

<p>So which one should you use? Well it depends on the situation, if you only need one object of its kind for your script (as you will see in our example at the end of this article), then use an object literal, but if you need several instances of an object, where each instance is independent of the other and can have different properties or methods depending on the way it's constructed, then use a constructor function.</p>

<h3 class="nolinks">This and That</h3>

<p>While explaining constructor functions, there were a lot of 'this' keywords being thrown around and I figure what better time to talk about scope!</p>

<p>Now you might be asking 'what is this scope you speak of'?' Scope in JavaScript is function/object based, so that means if you're outside of a function, you can't use a variable that is defined inside a function (unless you use a closure).</p>

<p>There is however a scope chain, which means that a function inside another function can access a variable defined in its parent function. Let's take a look at some example code.</p>

<div><pre><code>&lt;script type="text/javascript"&gt;
&nbsp;
var var1 = 'this is global and is available to everyone';
&nbsp;
function function1(){
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;var var2 = 'this is only available inside function1 and function2'; 
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;function function2(){
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var var3 = 'this is only available inside function2';
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
}
&nbsp;
&lt;/script&gt;
</code></pre></div>

<p>As you can see in this example, <code>var1</code> is defined in the global object and is available to all functions and object, <code>var2</code> is defined inside function1 and is available to function1 and function2, but if you try to reference it from the global object it will give you the error 'var2 is undefined', <code>var3</code> is only accessible to function2.</p>

<p>So what does 'this' reference? Well in a browser, 'this' references the window object, so technically the window is our global object. If we're inside an object, 'this' will refer to the object itself however if you're inside a function, this will still refer to the window object and likewise if you're inside a method that is within an object, 'this' will refer to the object.</p>

<p>Due to our scope chain, if we're inside a sub-object (an object inside an object), 'this' will refer to the sub-object and not the parent object.</p>

<p>As a side note, it's also worth adding that when using functions like setInterval, setTimeout and eval, when you execute a function or method via one of these, 'this' refers to the window object as these are methods of window, so setInterval() and window.setInterval() are the same.</p>

<p>Ok now that we have that out of the way, let's do a real world example and create a form validation object!</p>

<h3 class="nolinks">Real world Usage: A Form Validation Object</h3>

<p>First I must introduce you to the addEvent function which we will create and is a combination of ECMAScript's (Firefox, Safari, etc.. ) addEventListener() function and Microsoft ActiveX Script's attachEvent() function.</p>

<div><pre><code>function addEvent(to, type, fn){
&nbsp;&nbsp;&nbsp;&nbsp;if(document.addEventListener){
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;to.addEventListener(type, fn, false);
&nbsp;&nbsp;&nbsp;&nbsp;} else if(document.attachEvent){
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;to.attachEvent('on'+type, fn);
&nbsp;&nbsp;&nbsp;&nbsp;} else {
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;to['on'+type] = fn;
&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp; 
};
</code></pre></div>

<p>This creates a new function with three arguments, <code>to</code> being the DOM object we are attaching the event to, <code>type</code> being the type of event and <code>fn</code> being the function run when the event is triggered. It first checks whether addEventListener is supported, if so it will use that, if not it will check for attachEvent and if all else fails you are probably using IE5 or something equally obsolete so we will add the event directly onto its event property (note: the third option will overwrite any existing function that may have been attached to the event property while the first two will add it as an additional function to its event property).</p>

<p>Now let's set up our document so it is similar to what you might see when you develop jQuery stuff.</p>

<p>In jQuery you would have;</p>

<div><pre><code>$(document).ready(function(){
&nbsp;&nbsp;&nbsp;&nbsp;//all our code that runs after the page is ready goes here
});
</code></pre></div>

<p>Using our addEvent function we have;</p>

<div><pre><code>addEvent(window, 'load', function(){
&nbsp;&nbsp;&nbsp;&nbsp;//all our code that runs after the page is ready goes here
});
</code></pre></div>

<p>Now for our Form object.</p>

<div><pre><code>var Form = {
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;validClass : 'valid',
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;fname : {
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;minLength : 1,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;maxLength : 15, 
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fieldName : 'First Name'
&nbsp;&nbsp;&nbsp;&nbsp;},
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;lname : {
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;minLength : 1,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;maxLength : 25,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fieldName : 'Last Name'
&nbsp;&nbsp;&nbsp;&nbsp;},
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;validateLength : function(formEl, type){
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(formEl.value.length &gt; type.maxLength || formEl.value.length &lt; type.minLength ){&nbsp;&nbsp;&nbsp; 
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;formEl.className = formEl.className.replace(' '+Form.validClass, '');
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return false;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} else {
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(formEl.className.indexOf(' '+Form.validClass) == -1)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;formEl.className += ' '+Form.validClass;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return true;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;&nbsp;&nbsp;},
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;validateEmail : function(formEl){
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var regEx = /^([0-9a-zA-Z]([-.\w]*[0-9a-zA-Z])*@([0-9a-zA-Z][-\w]*[0-9a-zA-Z]\.)+[a-zA-Z]{2,9})$/;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var emailTest = regEx.test(formEl.value);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (emailTest) {
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(formEl.className.indexOf(' '+Form.validClass) == -1)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;formEl.className += ' '+Form.validClass;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return true;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} else {
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;formEl.className = formEl.className.replace(' '+Form.validClass, '');
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return false;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
&nbsp;&nbsp;&nbsp;&nbsp;},&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;getSubmit : function(formID){&nbsp;&nbsp;&nbsp; 
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var inputs = document.getElementById(formID).getElementsByTagName('input');
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for(var i = 0; i &lt; inputs.length; i++){
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(inputs[i].type == 'submit'){
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return inputs[i];
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return false;
&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
};
</code></pre></div>

<p>So this is quite basic but can easily be expanded upon.</p>

<p>To break this down first we create a new property which is just the string name of our 'valid' css class that when applied to the form field, adds valid effects such as a green border. We also define our two sub-objects, <code>fname</code> and <code>lname</code>, so we can define their own properties that can be used by methods elsewhere, these properties are <code>minLength</code>  which is the minimum amount of characters these fields can have, <code>maxLength</code> which is the max characters  the field can have and <code>fieldName</code> which doesn't actually get used, but could be grabbed for  things like identifying the field with a user friendly string in an error message (eg. 'First Name field is required.').</p>

<p>Next we create a validateLength method that accepts two arguments: <code>formEl</code> the DOM element to validate and the <code>type</code> which refers to one of the sub-object to use (i.e. fname or lname). This function checks whether the length of the field is between the minLength and maxLength range, if it's not then we remove our valid class (if it exists) from the element and return false, otherwise if it is then we add the valid class and return true.</p>

<p>Then we have a validateEmail method which accepts a DOM element as an arguement, we then test this DOM elements value against an email type regular expression; again if it passes we add our class and return true and vice versa.</p>

<p>Finally we have a getSubmit method. This method is given the id of the form and then loops through all input elements inside the specified form to find which one has a type of submit (type="submit"). The reason for this method is to return the submit button so we can disable it until the form is ready to submit.</p>

<p>Let's put this validator object to work on a real form. First we need our HTML.</p>

<div><pre><code>&lt;body&gt;
&nbsp;
&lt;form id="ourForm"&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&lt;label&gt;First Name&lt;/label&gt;&lt;input type="text" /&gt;&lt;br /&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&lt;label&gt;Last Name&lt;/label&gt;&lt;input type="text" /&gt;&lt;br /&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&lt;label&gt;Email&lt;/label&gt;&lt;input type="text" /&gt;&lt;br /&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&lt;input type="submit" value="submit" /&gt;
&lt;/form&gt;
&nbsp;
&lt;/body&gt;
</code></pre></div>

<p>Now let's access these input objects using JavaScript and validate them when the form submits.</p>

<div><pre><code>addEvent(window, 'load', function(){
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;var ourForm = document.getElementById('ourForm');&nbsp;&nbsp; 
&nbsp;&nbsp;&nbsp;&nbsp;var submit_button = Form.getSubmit('ourForm');
&nbsp;&nbsp;&nbsp;&nbsp;submit_button.disabled = 'disabled';
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;function checkForm(){
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var inputs = ourForm.getElementsByTagName('input');
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(Form.validateLength(inputs[0], Form.fname)){
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(Form.validateLength(inputs[1], Form.lname)){
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(Form.validateEmail(inputs[2])){&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;submit_button.disabled = false;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return true;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;submit_button.disabled = 'disabled';
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return false;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;};
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;checkForm();&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
&nbsp;&nbsp;&nbsp;&nbsp;addEvent(ourForm, 'keyup', checkForm);
&nbsp;&nbsp;&nbsp;&nbsp;addEvent(ourForm, 'submit', checkForm);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
});
</code></pre></div>

<p>Let's break down this code.</p>

<p>We wrap our code in the addEvent function so when the window is loaded this script runs. Firstly we grab our form using its ID and put it in a variable named <code>ourForm</code>, then we grab our submit button (using our Form objects getSubmit method) and put it in a variable named <code>submit_button</code>, and then set the submit buttons disabled attribute to 'disabled'.</p>

<p>Next we define a checkForm function. This stores all the inputs inside the form field as an array and we attach it to a variable named.. you guessed it.. <code>inputs</code>! Then it defines some nested if statements which test each of the fields inside the inputs array against our Form methods. This is the reason we returned true or false in our methods, so if it returns true, we pass that if statement and continue onto the next, but if it returns false, we exit the if statements.</p>

<p>Following our function definition, we execute the checkForm function when the page initially loads and also attach the function to a keyup event and a submit event.</p>

<p>You might be asking, why attach to submit if we disabled the submit button. Well if you are focused on an input field and hit the enter key, it will attempt to submit the form and we need to test for this, hence the reason our checkForm function returns true (submits the form) or false (doesn't submit form).</p>

<h3 class="nolinks">Conclusion</h3>

<p>So we learned how to define the different object types within JavaScript and create properties and methods within them. We also learned a nifty addEvent function and got to use our object in a basic real world example.</p>

<p>This concludes the basics of JavaScript Object Orientation. Hopefully, this may start you on your way to building your own JavaScript library! If you liked this article and are interested in other JavaScript related topics, post them in the comments as I'd be happy to continue writing them. Thanks for reading.</p><p>Why not also check out the range of <a href="https://codecanyon.net/popular_item/by_category?category=javascript" target="_self">JavaScript items</a> on CodeCanyon. You can find scripts for creating&nbsp;<a href="https://codecanyon.net/search?category=javascript%2Fsliders" target="_self">sliders</a>, <a href="https://codecanyon.net/search?category=javascript%2Fcountdowns" target="_self">countdowns</a>, <a href="https://codecanyon.net/search?category=javascript%2Floaders-and-uploaders" target="_self">loaders and uploaders</a>,&nbsp;and much more.</p></div>
					</div>
				</article>
				<!--================= END :: Tutorial =================-->
				
				<!--================= START :: Tutorial =================-->
				<article>
					<a id="t-97" name="t-97"></a><h1>97 : Object-Oriented programming with JavaScript</h1>
					<span class="ref-site">http://viralpatel.net/blogs/object-oriented-programming-with-javascript/</span>
					<div class="tutorial__content">
<div class="entry-inner">
							<p><img src="http://img.viralpatel.net/2009/07/object-oriented-programming-cars.png" /><strong>Object-Oriented programming</strong> is one of the widely used programming paradigm that uses abstraction to create model based on real world. It is a model organized around "objects" rather than "actions" and data rather than logic. Historically, a program has been viewed as a logical procedure that takes input data, processes it, and produces output data. Object-oriented programming (OOP) uses <strong>"objects"</strong> – data structures consisting of <strong>datafields</strong> and <strong>methods</strong> – and their interactions to design applications and computer programs. Each object can be seen as a tiny machine which is responsible for the set of task assign to it.</p>
<p>Today, many popular programming languages (such as Java, JavaScript, C#, C++, Python, PHP etc) support <strong>object-oriented programming</strong> (OOP). </p>
<!-- Quick Adsense WordPress Plugin: http://quicksense.net/ -->


<p>JavaScript has strong object-oriented programming capabilities. Although there is differences in object-oriented capability of javascript compared to other languages.</p>
<h2>Terminology</h2>
<p>First let us see few terminologies that we use in object-oriented programming.</p>
<p><strong>Class</strong>: Defines the characteristics of the Object.<br>
<strong>Constructor</strong>: A method called at the moment of instantiation.<br>
<strong>Object</strong>: An Instance of a Class.<br>
<strong>Method</strong>: An Object capability as walk.<br>
<strong>Property</strong>: An Object characteristic, such as color.<br>
<strong>Inheritance</strong>: A Class can inherit characteristics from another Class.<br>
<strong>Encapsulation</strong>: A Class defines only the characteristics of the Object, a method defines only how the method executes.<br>
<strong>Abstraction</strong>: The conjunction of complex inheritance, methods, properties of an Object must be able to simulate a reality model.<br>
<strong>Polymorphism</strong>: Different Classes might define the same method or property.</p>
<h2>The Class in JavaScript</h2>
<p>Unlike Java, C++ etc, JavaScript does not contains class statement. JavaScript is a prototype-based language. JavaScript uses functions as classes. Defining a class is as easy as defining a function. In the example below we define a new class called Car. </p>
<pre><code>//Define the class Car
function Car() { }
</code></pre>
<h2>The Object (Class Instance) in JavaScript</h2>
<p>For creating instances of any class i.e. objects use <strong>new</strong> keyword. For example, in below code snippet we created two instances of class Car.</p>
<pre><code>//Define the class Car
function Car() { }

var car1 = new Car();
var car2 = new Car();
</code></pre>
<h2>The Constructor in JavaScript</h2>
<p>In object oriented methodology, a Constructor is a method that is used to initiate the properties of any class instance. Thus the constructor gets called when the class is instantiated.<br>
As in JavaScript there is no class keyword and the function serves as class definition, there is no need of defining constructor explicitly. The function defined for the class acts as constructor. For example, in following code snippet we have called an alert statement when class Car is instantiated.</p>
<pre><code>//Define the class Car
function Car() {
	alert("Class CAR Instantiated");
}

var car1 = new Car();
var car2 = new Car();
</code></pre>
<h2> The Property (object attribute) in JavaScript</h2>
<p>Properties are the variable that are member of an object and can define the state of any instance of Class. Property of a class can be accessed within the class using <code><strong>this</strong></code> keyword. For example, in following code snippet we have assign a property <em>speed</em> to Car.</p>
<pre><code>//Define the class Car
function Car(speed) {
	alert("Class CAR Instantiated");
	this.speed = speed;
}

var car1 = new Car(40);
var car2 = new Car(60);

alert("Car1 Speed: " + car1.speed);
alert("Car2 Speed: " + car2.speed);
</code></pre>
<p>One thing we should note here is that for inheritance works correctly, the Properties should be set in the prototype property of the class (function). The above example becomes:</p>
<pre><code>//Define the class Car
function Car(speed) {
	alert("Class CAR Instantiated");
	this.speed = speed;
}
Car.prototype.speed= 'Car Speed';

var car1 = new Car(40);
var car2 = new Car(60);

alert("Car1 Speed: " + car1.speed);
alert("Car2 Speed: " + car2.speed);
</code></pre>
<h2>The methods in JavaScript</h2>
<p>To define methods in a Class, all you have to do is just define a attribute and assign an function to it.  For example, in below code snippet we defined a method <code>setSpeed()</code> for class <code>Car</code>.</p>
<pre><code>//Define the class Car
function Car(speed) {
	alert("Class CAR Instantiated");
	this.speed = speed;
}
Car.prototype.speed= 'Car Speed';
Car.prototype.setSpeed = function(speed) {
	this.speed = speed;
	alert("Car speed changed");
}

var car1 = new Car(40);
var car2 = new Car(60);

car1.setSpeed(120);
car2.setSpeed(140);
</code></pre>
<h2>Inheritance in JavaScript</h2>
<p>JavaScript supports single class inheritance. To create a child class that inherit parent class, we create a Parent class object and assign it to the Child class. In following example we created a child class Ferrari from parent class Car.</p>
<pre><code>//Define the Car class
function Car() { }
Car.prototype.speed= 'Car Speed';
Car.prototype.setSpeed = function(speed) {
	this.speed = speed;
	alert("Car speed changed");
}


//Define the Ferrari class
function Ferrari() { }
Ferrari.prototype = new Car();


// correct the constructor pointer because it points to Car
Ferrari.prototype.constructor = Ferrari;

// replace the setSpeed method
Ferrari.prototype.setSpeed = function(speed) {
	this.speed = speed;
	alert("Ferrari speed changed");
}

var car = new Ferrari();
car.setSpeed();
</code></pre>
<h2>Encapsulation in JavaScript</h2>
<p>In JavaScript, encapsulation is achieved by the inheritance. The child class inherit all the properties and methods of parent class and needs to override the method only that needs to be changed. This encapsulation by which every class inherits the methods of its parent and only needs to define things it wishes to change. </p>
<p><strong>Update</strong>: A new tutorial cover these Javascript OOPs topics in details. Please refer: <a href="http://viralpatel.net/blogs/javascript-objects-functions/"><strong>JavaScript 101: Objects and Functions</strong></a></p>


													</div>
					</div>
				</article>
				<!--================= END :: Tutorial =================-->
				
				<!--================= START :: Tutorial =================-->
				<article>
					<a id="t-98" name="t-98"></a><h1>98 : JavaScript 101: Objects and Functions</h1>
					<span class="ref-site"></span>
					<div class="tutorial__content">
<div class="entry-inner">
							
<h2>JavaScript Object and their Prototypes</h2>
<p>Objects in JavaScript is nothing but collection of attributes (or properties to be more inline with ECMA definition). And a property is defined as a key-value pair. Object in JavaScript can be created using many ways, but for now we are gonna use a simple one.<br>
Lets create a Person called John:</p>
<!-- Quick Adsense WordPress Plugin: http://quicksense.net/ -->


<pre><code>var John = {
             'name'  : 'John Doe',
             'age'   : '25'
};
</code></pre>
<p>This object has two property 'name' and 'age'. Note that the value of a property is not at all limited to primitive types but can be any other javascript object. So for example 'John' may have another property 'address', whose value can be an Array of different address objects.  Apart from the properties defined in object, every JavaScript object has another secret internal property called '__proto__'. This property points to the prototype of the John. But what is the prototype of John? Well for John here, its JavaScript's parent of all objects, The Object. And what is the prototype of The Object? Its <i>null</i>.<br>
Below image might make this more clear:</p>
<p><img src="http://img.viralpatel.net/2014/01/javascript-object.png" /></p>
<h2>Prototype Chaining and Inheritance</h2>
<p>We now know that each object in JavaScript has another __proto__ property which refers to its prototype. If I am to create an object, and explicitly assign __proto__ another object… what would that mean?</p>
<pre><code>var Man = {
   gender: 'male'
};
var John = {
   name: 'John Doe',
   age: 25,
   __proto__: Man
}
</code></pre>
<p><img src="http://img.viralpatel.net/2014/01/javascript-prototype-chain.png" /></p>
<p>This would mean John <i>prototypically inherits</i> from Man. All properties of Man can be directly accessed through John, this is because whenever any property is accessed via John and if it is not found in John it will be looked in the prototype of John.</p>
<pre><code>console.log(John.name); // John Doe
console.log(John.age); // 25
console.log(John.gender); // male
</code></pre>
<p>Further, this prototypical inheritance is not limited to two levels and can be extended to any level. This sort of chaining is called <b>Prototype Chaining</b>.</p>
<p>The rule to resolve any property is: If a property is not found in an object, it is looked into the prototype chain of the object all the way to Object unless found earlier. If property is not found, we get a property undefined error.</p>
<h2>Function</h2>
<p>A function is a special type of Object which may be invoked as a routine. A function may have properties, and some lines of code which determines the behavior of the function. For example, we can have a function named isEven() which takes a number as parameter and tell us whether a number is even or not.</p>
<pre><code>function isEven(no){
   return no % 2 === 0;
}
</code></pre>
<p>Further functions can be used to create Objects acting as a Constructor for the class. All that is required is to use <code>new</code> operator when calling that function. For example, I can write following Person function to create different Person objects:</p>
<pre><code>function Person(name, age){
   this.name = name;
   this.age = age;
   this.shoutYourName = function(){
                              alert('My name is ' + name +'!');
                        };
}
//create Objects
var John = new Person('John'25);
var Donn = new Person('Donn'29);

console.log(John.name);  //John
console.log(John.age);  //25
John.shoutYourName();   //alerts 'My name is John!'
</code></pre>
<p>Now the question is what gets create and stored in memory above functions are created? What's the prototype of it? And how is it that same functions can act as Constructors to create new objects?</p>
<p>To answer these question,<br>
A function that is called using <i>new</i> operator for creation of new objects is called a Constructor Function.<br>
Creating a function creates an object of type <code>Function</code>. That means, any new function will have its __proto__ point to prototype of 'Function'.<br>
<b>As a side note:</b> <i>Function is a global internal Object, it doesn't have any properties of its own but inherits them from Function.prototype.</i><br>
Further, objects of type Function have another property called 'prototype' pointing to the prototype of the objects which will be created using this function.</p>
<p>In case of above example:<br>
1. Person is an object of type Function. And this also means Person has its __proto__ property pointed to Function.prototype<br>
2. Person has a property 'prototype' pointing to an object which will be assigned to  __proto__ property of objects created by Person, in our case, John and Donn. Lets call this prototype object Person.prototype. So this would mean any objects created using Person will be prototypically inherited from Person.</p>
<pre><code>console.log(John.__proto__ === Person.prototype)     //true
console.log(Donn.__proto__ === Person.prototype)     //true
console.log(Person.__proto__ === Function.prototype) //true
</code></pre>
<h3>Structure of Person.prototype</h3>
<p>As already mentioned above, all objects created using Person will have their __proto__ pointing to Person.prototype. This means, these objects will Prototypically inherit from Person.prototype</p>
<ol>
<li> __proto__ of Person.prototype points to Object. </li>
<li> And extra property added to Person.prototype will be prototypically available to objects created by calling new Person(). And using <code>this</code> reference inside properties of Person.prototype will refer to  properties of Person. So, after creating the objects John and Donn, if I am to add below code:
<pre><code>Person.prototype.getAllCapsName = function(){
return this.name.toUpperCase();
};
</code></pre>
<p>this property <code>getAllCapsName</code> will be immediately available in already created objects 'John' and 'Donn'. And that's because, saying it again, __proto__ of John and Donn is pointing to Person.prototype object,i.e, John and Donn prototypically-inherits from Person.</p>
<pre><code>console.log(John.getAllCapsName()) //JOHN
console.log(John.__proto__.getAllCapsName()) //Can't access property of John using this.
                                             //this refers to Person.prototype object
console.log(Person.prorotype.getAllCapsName()) //Can't access property using this.
</code></pre>
</li>
<li> Person.prototype has another special property called <code>constructor</code>, which points to the original function object Person. And due to above point:
<pre><code>console.log(Person.prototype.constructor===Person) //true
 console.log(John.constructor)// print Person function 
 console.log(Person.prototype.constructor)// print Person function 
 console.log(John.constructor===Person) //true
 console.log(John.__proto__.constructor===Person.prototype.constructor) //true
 console.log(John.__proto__.constructor===Person.prototype.constructor) //true
</code></pre>
</li>
</ol>
<p>In case things are still hazy, image below might help:</p>
<p><img src="http://img.viralpatel.net/2014/01/javascript-constructor-object.png" /></p>
<p>Now since behavior of all objects created using one Constructor Function will be same, it makes more sense to add the behavior in the prototype of Constructor Function than in the Constructor Function. I.e. to add functions properties inside Person.prototype than in Person. This is because any function-property in Person (say shoutYourName()) will be copied in John and Donn. But, any function-property in Person.prototype will be available to John and Donn through __proto__ reference.<br>
So if I am to change the definition of shoutYourName for John, behavior of Donn will not be affected. But it's not the case with getAllCapsName().</p>
<p>Let see this working:</p>
<pre><code>var Person = function(name, age){
    this.name = name;
    this.age = age;
    this.shoutYourName = function(){
        return 'SHOUTING '+ this.name;
    };
};

var John = new Person('John',25);
var Donn = new Person('Donn',25);

console.log(John.shoutYourName()) // SHOUTING John
console.log(Donn.shoutYourName()) // SHOUTING Donn

Person.prototype.shhhYourName = function(){
    return 'shhh ' + this.name;
};

console.log(John.shhhYourName()) // shhh John
console.log(Donn.shhhYourName()) // shhh Donn

//changing definition of only John
John.shoutYourName = function(){
    return 'SHOUTING ' + this.name + '!!!!!';
};

//changing definition in prototype
Person.prototype.shhhYourName = function(){
    return 'shhh ' + this.name + '!!!!!';
};

console.log(John.shoutYourName()) // SHOUTING John!!!!!
console.log(Donn.shoutYourName()) // SHOUTING Donn

console.log(John.shhhYourName()) // shhh John!!!!!
console.log(Donn.shhhYourName()) // shhh Donn!!!!!
</code></pre>

<p>Hope it helped to have a better understanding of Objects and Functions is JavaScript.<br>
and The End. :)</p>


													</div>
					</div>
				</article>
				<!--================= END :: Tutorial =================-->
				
				<!--================= START :: Tutorial =================-->
				<article>
					<a id="t-99" name="t-99"></a><h1>99 : Javascript Async Control Flow</h1>
					<span class="ref-site">https://kaye.us/javascript-async-control-flow/</span>
					<div class="tutorial__content">
<div class="post-content">
        <p>In this post we'll explore an enlightened approach to managing control flow in asynchronous javascript applications. We'll look at powerful new ES6 patterns and the happy future that <code>awaits</code> with ES7.</p>

<p>So we are all on the same page, when we discuss <a href="https://en.wikipedia.org/wiki/Control_flow">control flow</a> we mean the following:</p>

<blockquote>
  <p>Control flow refers to the specification of the order in which the individual statements, instructions or function calls of an imperative program are executed or evaluated.</p>
</blockquote>

<h2 id="whyitsanissue">Why it's an issue  </h2>

<p><em>Writing synchronous code in Javascript is a breeze.</em></p>

<p>The code executes in the order it is written. As long as you're aware of hoisting and a few other gotchas, what you see is what you get. Beautiful.</p>

<pre><code>var invitations,  
    newUser = createUser(name),
    friends = getFacebookFriends(name),

if (friends) {  
  invitations = inviteFacebookFriends(friends);
}
</code></pre>

<p>On the other hand, writing asynchronous code can be pretty tricky.</p>

<p>If you've worked with Javascript for any amount of time you likely remember when callbacks were the only tool in the javascript engineer's toolbox:</p>

<pre><code>createUser(name, function() {  
  getFacebookFriends(name, function(friends) {
    if (friends) {
      inviteFacebookFriends(friends, function(invitations) {
        // ad infinitum
      });
    };
  });
});
</code></pre>

<p>This pattern is aptly referred to as <em>Callback hell.</em> <mark>This is the antithesis of intuitive control flow</mark>. Not to mention, the bottom half of our code more closely resembles Scheme than Javascript.</p>

<p>Things improved significantly when promises hit the scene. With a bit of refactoring, our little example now looked like this:</p>

<pre><code>createUser(name)  
  .then(getFacebookFriends)
  .then(function(friends) {
    if (friends) {
      return inviteFacebookFriends(friends);
    } else {
      throw new AntiSocialError('No friends to invite');
    }
  })
  .catch(displayError);
</code></pre>

<p>Not bad, right? While it is worlds better than nested callbacks, it is not without its weaknesses. Imagine a scenario where each of those methods needed to implement complex conditional logic. We have two options on how to refactor: </p>

<ol>
<li>Sacrifice readability and push our complex logic into the promise chain.  </li>
<li>Reduce maintainability and wrap our logic in concrete methods which are consumed by the chain.</li>
</ol>

<p>In either case the promise chain pattern begins to fall short for anything that goes beyond simple decoration and linear sequences.</p>

<h2 id="anenlightenedapproach">An enlightened approach  </h2>

<p>With the recent approval of the <del>ES6</del> ES2015 standard, and the promising <code>async</code> feature in ES7, we have a whole set of exciting new tools in our toolbox. </p>

<p>Let's begin by looking at the brilliant new ES7 proposals, then we'll circle back to leveraging new powerful new ES2015 patterns today.</p>

<h3 id="es7asyncfunctions">ES7 Async Functions</h3>

<p><code>async</code> is an <a href="http://tc39.github.io/ecmascript-asyncawait/">ES7 proposal</a> which aims at reducing the complexity of working with asyncronous operations. The general gist is that one can <code>await</code> the resolution of a promise within an <code>async</code> function. Let's look at an example:</p>

<pre><code>async function setupNewUser(name) {  
  var invitations,
      newUser = await createUser(name),
      friends = await getFacebookFriends(name);

  if (friends) {
    invitations = await inviteFacebookFriends(friends);
  }

  // some more logic
}
</code></pre>

<p>Notice how similar it looks to our synchronous example above? The only hints that the functions we are calling perform asynchronous operations are the little <code>async</code> and <code>await</code> keywords. </p>

<p>What is happening is that we are awaiting the result of our asnyc functions. Once those promises resolve, they are assigned to our variables and execution continues. Our control flow is once again transparent.</p>

<p>However, <code>async</code> and <code>await</code> are still a ways off, so how do we leverage this powerful pattern today?</p>

<h3 id="es2015promisesandgenerators">ES2015 Promises and Generators</h3>

<p>You don't have to wait until ES7 is ratified to be an async rockstar. There are several feather-light utilities available which will give you much the same functionality, such as Mozilla's <a href="http://taskjs.org/">task.js</a> and TJ Holowaychuk's <a href="https://github.com/tj/co">co</a>, to name a few.</p>

<p>How do they work you ask? Simple! They use ES2015 generator functions and promises to achieve control flow nirvana.</p>

<p>You will recall that a generator is a special function whose execution can pause and be resumed at many points. It does so by evaluating a <code>yield</code> expression which can resume execution of the generator after some indeterminate amount of time.</p>

<p>We'll rewrite our example using task.js, but you could just as easily use another utility.</p>

<pre><code>function setupNewUser(name) {  
  return spawn(function*() {
    var invitations,
        newUser = yield createUser(name),
        friends = yield getFacebookFriends(name);

    if (friends) {
      invitations = yield inviteFacebookFriends(friends);
    }
  }
}
</code></pre>

<p>These small utilities work by yielding to a function which returns a <code>promise</code>. When that <code>promise</code> resolves, it calls the generator's <code>next()</code> function, resuming execution.</p>

<p>With those simple tools and an ES2015 transpiler in hand you are now empowered to write cleaner, simpler, more maintainable asynchronous javascript!</p>

<h2 id="futherreading">Futher reading  </h2>

<ul>
<li><a href="http://tc39.github.io/ecmascript-asyncawait/">Async Functions</a></li>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Iterators_and_Generators">Iterators and generators - JavaScript | MDN</a></li>
<li><a href="http://davidwalsh.name/async-generators">Going Async With ES6 Generators</a></li>
<li><a href="https://github.com/mozilla/task.js">Task.js: Beautiful Concurrency for JavaScript</a></li>
</ul>
    </div>
					</div>
				</article>
				<!--================= END :: Tutorial =================-->
				
				<!--================= START :: Tutorial =================-->
				<article style="display:none;">
					<a id="t-96" name="t-96"></a><h1>96 : The Basics of Object-Oriented JavaScript</h1>
					<span class="ref-site"></span>
					<div class="tutorial__content">
						
					</div>
				</article>
				<!--================= END :: Tutorial =================-->
				
			</section>
			
		</main>
	
			</body></html>